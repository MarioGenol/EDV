(self.webpackChunkVDE=self.webpackChunkVDE||[]).push([[179],{138:(Qa,_l,ia)=>{"use strict";function ss(i){return"function"==typeof i}function On(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const qa=On(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,a)=>`${a+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function b(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class De{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const m of t)m.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(ss(n))try{n()}catch(m){e=m instanceof qa?m.errors:[m]}const{_finalizers:a}=this;if(a){this._finalizers=null;for(const m of a)try{pn(m)}catch(T){e=e??[],T instanceof qa?e=[...e,...T.errors]:e.push(T)}}if(e)throw new qa(e)}}add(e){var t;if(e&&e!==this)if(this.closed)pn(e);else{if(e instanceof De){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&b(t,e)}remove(e){const{_finalizers:t}=this;t&&b(t,e),e instanceof De&&e._removeParent(this)}}De.EMPTY=(()=>{const i=new De;return i.closed=!0,i})();const ho=De.EMPTY;function ks(i){return i instanceof De||i&&"closed"in i&&ss(i.remove)&&ss(i.add)&&ss(i.unsubscribe)}function pn(i){ss(i)?i():i.unsubscribe()}const bi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},an={setTimeout(i,e,...t){const{delegate:n}=an;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=an;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function $t(i){an.setTimeout(()=>{const{onUnhandledError:e}=bi;if(!e)throw i;e(i)})}function Et(){}const fo=Ti("C",void 0,void 0);function Ti(i,e,t){return{kind:i,value:e,error:t}}let Li=null;function xi(i){if(bi.useDeprecatedSynchronousErrorHandling){const e=!Li;if(e&&(Li={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=Li;if(Li=null,t)throw n}}else i()}class ro extends De{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ks(e)&&e.add(this)):this.destination=Wi}static create(e,t,n){return new $n(e,t,n)}next(e){this.isStopped?js(function tn(i){return Ti("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?js(function Yo(i){return Ti("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?js(fo,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const yo=Function.prototype.bind;function Xi(i,e){return yo.call(i,e)}class cn{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){zi(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){zi(n)}else zi(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){zi(t)}}}class $n extends ro{constructor(e,t,n){let a;if(super(),ss(e)||!e)a={next:e??void 0,error:t??void 0,complete:n??void 0};else{let m;this&&bi.useDeprecatedNextContext?(m=Object.create(e),m.unsubscribe=()=>this.unsubscribe(),a={next:e.next&&Xi(e.next,m),error:e.error&&Xi(e.error,m),complete:e.complete&&Xi(e.complete,m)}):a=e}this.destination=new cn(a)}}function zi(i){bi.useDeprecatedSynchronousErrorHandling?function en(i){bi.useDeprecatedSynchronousErrorHandling&&Li&&(Li.errorThrown=!0,Li.error=i)}(i):$t(i)}function js(i,e){const{onStoppedNotification:t}=bi;t&&an.setTimeout(()=>t(i,e))}const Wi={closed:!0,next:Et,error:function un(i){throw i},complete:Et},As="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ri(i){return i}function fn(i){return 0===i.length?Ri:1===i.length?i[0]:function(t){return i.reduce((n,a)=>a(n),t)}}let ln=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,a){const m=function Ys(i){return i&&i instanceof ro||function ao(i){return i&&ss(i.next)&&ss(i.error)&&ss(i.complete)}(i)&&ks(i)}(t)?t:new $n(t,n,a);return xi(()=>{const{operator:T,source:z}=this;m.add(T?T.call(m,z):z?this._subscribe(m):this._trySubscribe(m))}),m}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=En(n))((a,m)=>{const T=new $n({next:z=>{try{t(z)}catch(j){m(j),T.unsubscribe()}},error:m,complete:a});this.subscribe(T)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[As](){return this}pipe(...t){return fn(t)(this)}toPromise(t){return new(t=En(t))((n,a)=>{let m;this.subscribe(T=>m=T,T=>a(T),()=>n(m))})}}return i.create=e=>new i(e),i})();function En(i){var e;return null!==(e=i??bi.Promise)&&void 0!==e?e:Promise}const Mn=On(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let oe=(()=>{class i extends ln{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new Ls(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new Mn}next(t){xi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){xi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){xi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:a,observers:m}=this;return n||a?ho:(this.currentObservers=null,m.push(t),new De(()=>{this.currentObservers=null,b(m,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:a,isStopped:m}=this;n?t.error(a):m&&t.complete()}asObservable(){const t=new ln;return t.source=this,t}}return i.create=(e,t)=>new Ls(e,t),i})();class Ls extends oe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:ho}}function Ze(i){return ss(i?.lift)}function at(i){return e=>{if(Ze(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function rt(i,e,t,n,a){return new Yt(i,e,t,n,a)}class Yt extends ro{constructor(e,t,n,a,m,T){super(e),this.onFinalize=m,this.shouldUnsubscribe=T,this._next=t?function(z){try{t(z)}catch(j){e.error(j)}}:super._next,this._error=a?function(z){try{a(z)}catch(j){e.error(j)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(z){e.error(z)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Kt(i,e){return at((t,n)=>{let a=0;t.subscribe(rt(n,m=>{n.next(i.call(e,m,a++))}))})}function Zo(i){return this instanceof Zo?(this.v=i,this):new Zo(i)}function ls(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function Lr(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(m){t[m]=i[m]&&function(T){return new Promise(function(z,j){!function a(m,T,z,j){Promise.resolve(j).then(function(Z){m({value:Z,done:z})},T)}(z,j,(T=i[m](T)).done,T.value)})}}}const Ct=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function Vt(i){return ss(i?.then)}function Le(i){return ss(i[As])}function ri(i){return Symbol.asyncIterator&&ss(i?.[Symbol.asyncIterator])}function mi(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const xt=function Q(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Pt(i){return ss(i?.[xt])}function yt(i){return function Es(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,n=t.apply(i,e||[]),m=[];return a={},T("next"),T("throw"),T("return"),a[Symbol.asyncIterator]=function(){return this},a;function T(Wt){n[Wt]&&(a[Wt]=function(qt){return new Promise(function(pe,Me){m.push([Wt,qt,pe,Me])>1||z(Wt,qt)})})}function z(Wt,qt){try{!function j(Wt){Wt.value instanceof Zo?Promise.resolve(Wt.value.v).then(Z,st):Mt(m[0][2],Wt)}(n[Wt](qt))}catch(pe){Mt(m[0][3],pe)}}function Z(Wt){z("next",Wt)}function st(Wt){z("throw",Wt)}function Mt(Wt,qt){Wt(qt),m.shift(),m.length&&z(m[0][0],m[0][1])}}(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:a}=yield Zo(t.read());if(a)return yield Zo(void 0);yield yield Zo(n)}}finally{t.releaseLock()}})}function ct(i){return ss(i?.getReader)}function pt(i){if(i instanceof ln)return i;if(null!=i){if(Le(i))return function wt(i){return new ln(e=>{const t=i[As]();if(ss(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(Ct(i))return function It(i){return new ln(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(Vt(i))return function Gt(i){return new ln(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,$t)})}(i);if(ri(i))return te(i);if(Pt(i))return function re(i){return new ln(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(ct(i))return function ie(i){return te(yt(i))}(i)}throw mi(i)}function te(i){return new ln(e=>{(function u(i,e){var t,n,a,m;return function ys(i,e,t,n){return new(t||(t=Promise))(function(m,T){function z(st){try{Z(n.next(st))}catch(Mt){T(Mt)}}function j(st){try{Z(n.throw(st))}catch(Mt){T(Mt)}}function Z(st){st.done?m(st.value):function a(m){return m instanceof t?m:new t(function(T){T(m)})}(st.value).then(z,j)}Z((n=n.apply(i,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=ls(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(T){a={error:T}}finally{try{n&&!n.done&&(m=t.return)&&(yield m.call(t))}finally{if(a)throw a.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function I(i,e,t,n=0,a=!1){const m=e.schedule(function(){t(),a?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(m),!a)return m}function x(i,e,t=1/0){return ss(e)?x((n,a)=>Kt((m,T)=>e(n,m,a,T))(pt(i(n,a))),t):("number"==typeof e&&(t=e),at((n,a)=>function g(i,e,t,n,a,m,T,z){const j=[];let Z=0,st=0,Mt=!1;const Wt=()=>{Mt&&!j.length&&!Z&&e.complete()},qt=Me=>Z<n?pe(Me):j.push(Me),pe=Me=>{m&&e.next(Me),Z++;let Xe=!1;pt(t(Me,st++)).subscribe(rt(e,He=>{a?.(He),m?qt(He):e.next(He)},()=>{Xe=!0},void 0,()=>{if(Xe)try{for(Z--;j.length&&Z<n;){const He=j.shift();T?I(e,T,()=>pe(He)):pe(He)}Wt()}catch(He){e.error(He)}}))};return i.subscribe(rt(e,qt,()=>{Mt=!0,Wt()})),()=>{z?.()}}(n,a,i,t)))}function w(i=1/0){return x(Ri,i)}const D=new ln(i=>i.complete());function f(i){return i&&ss(i.schedule)}function c(i){return i[i.length-1]}function d(i){return ss(c(i))?i.pop():void 0}function M(i){return f(c(i))?i.pop():void 0}function C(i,e=0){return at((t,n)=>{t.subscribe(rt(n,a=>I(n,i,()=>n.next(a),e),()=>I(n,i,()=>n.complete(),e),a=>I(n,i,()=>n.error(a),e)))})}function R(i,e=0){return at((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function E(i,e){if(!i)throw new Error("Iterable cannot be null");return new ln(t=>{I(t,e,()=>{const n=i[Symbol.asyncIterator]();I(t,e,()=>{n.next().then(a=>{a.done?t.complete():t.next(a.value)})},0,!0)})})}function J(i,e){return e?function it(i,e){if(null!=i){if(Le(i))return function B(i,e){return pt(i).pipe(R(e),C(e))}(i,e);if(Ct(i))return function L(i,e){return new ln(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(Vt(i))return function O(i,e){return pt(i).pipe(R(e),C(e))}(i,e);if(ri(i))return E(i,e);if(Pt(i))return function X(i,e){return new ln(t=>{let n;return I(t,e,()=>{n=i[xt](),I(t,e,()=>{let a,m;try{({value:a,done:m}=n.next())}catch(T){return void t.error(T)}m?t.complete():t.next(a)},0,!0)}),()=>ss(n?.return)&&n.return()})}(i,e);if(ct(i))return function Y(i,e){return E(yt(i),e)}(i,e)}throw mi(i)}(i,e):pt(i)}function q(...i){const e=M(i),t=function k(i,e){return"number"==typeof c(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?pt(n[0]):w(t)(J(n,e)):D}function nt(i={}){const{connector:e=(()=>new oe),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:a=!0}=i;return m=>{let T,z,j,Z=0,st=!1,Mt=!1;const Wt=()=>{z?.unsubscribe(),z=void 0},qt=()=>{Wt(),T=j=void 0,st=Mt=!1},pe=()=>{const Me=T;qt(),Me?.unsubscribe()};return at((Me,Xe)=>{Z++,!Mt&&!st&&Wt();const He=j=j??e();Xe.add(()=>{Z--,0===Z&&!Mt&&!st&&(z=dt(pe,a))}),He.subscribe(Xe),!T&&Z>0&&(T=new $n({next:Ai=>He.next(Ai),error:Ai=>{Mt=!0,Wt(),z=dt(qt,t,Ai),He.error(Ai)},complete:()=>{st=!0,Wt(),z=dt(qt,n),He.complete()}}),pt(Me).subscribe(T))})(m)}}function dt(i,e,...t){if(!0===e)return void i();if(!1===e)return;const n=new $n({next:()=>{n.unsubscribe(),i()}});return pt(e(...t)).subscribe(n)}function gt(i){for(let e in i)if(i[e]===gt)return e;throw Error("Could not find renamed property on target object.")}function kt(i,e){for(const t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function mt(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(mt).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Tt(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const ee=gt({__forward_ref__:gt});function Ft(i){return i.__forward_ref__=Ft,i.toString=function(){return mt(this())},i}function vt(i){return le(i)?i():i}function le(i){return"function"==typeof i&&i.hasOwnProperty(ee)&&i.__forward_ref__===Ft}function Ht(i){return i&&!!i.\u0275providers}const ye="https://g.co/ng/security#xss";class Rt extends Error{constructor(e,t){super(se(e,t)),this.code=e}}function se(i,e){return`NG0${Math.abs(i)}${e?": "+e.trim():""}`}function Ue(i){return"string"==typeof i?i:null==i?"":String(i)}function wn(i,e){throw new Rt(-201,!1)}function Re(i,e){null==i&&function ve(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function Ne(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Te(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ki(i){return bn(i,Tn)||bn(i,zo)}function bn(i,e){return i.hasOwnProperty(e)?i[e]:null}function _i(i){return i&&(i.hasOwnProperty(uo)||i.hasOwnProperty(ko))?i[uo]:null}const Tn=gt({\u0275prov:gt}),uo=gt({\u0275inj:gt}),zo=gt({ngInjectableDef:gt}),ko=gt({ngInjectorDef:gt});var vi=(()=>((vi=vi||{})[vi.Default=0]="Default",vi[vi.Host=1]="Host",vi[vi.Self=2]="Self",vi[vi.SkipSelf=4]="SkipSelf",vi[vi.Optional=8]="Optional",vi))();let vo;function Or(i){const e=vo;return vo=i,e}function Yl(i,e,t){const n=Ki(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&vi.Optional?null:void 0!==e?e:void wn(mt(i))}const Qs=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),hs={},Hl="__NG_DI_FLAG__",wh="ngTempTokenPath",yc="ngTokenPath",_c=/\n/gm,md="\u0275",vc="__source";let $l;function tl(i){const e=$l;return $l=i,e}function Mu(i,e=vi.Default){if(void 0===$l)throw new Rt(-203,!1);return null===$l?Yl(i,void 0,e):$l.get(i,e&vi.Optional?null:void 0,e)}function fi(i,e=vi.Default){return(function bu(){return vo}()||Mu)(vt(i),e)}function Fn(i,e=vi.Default){return fi(i,Mh(e))}function Mh(i){return typeof i>"u"||"number"==typeof i?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function rs(i){const e=[];for(let t=0;t<i.length;t++){const n=vt(i[t]);if(Array.isArray(n)){if(0===n.length)throw new Rt(900,!1);let a,m=vi.Default;for(let T=0;T<n.length;T++){const z=n[T],j=Gp(z);"number"==typeof j?-1===j?a=z.token:m|=j:a=z}e.push(fi(a,m))}else e.push(fi(n))}return e}function el(i,e){return i[Hl]=e,i.prototype[Hl]=e,i}function Gp(i){return i[Hl]}function xa(i){return{toString:i}.toString()}var na=(()=>((na=na||{})[na.OnPush=0]="OnPush",na[na.Default=1]="Default",na))(),sa=(()=>{return(i=sa||(sa={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",sa;var i})();const il={},_s=[],Ch=gt({\u0275cmp:gt}),Th=gt({\u0275dir:gt}),Sh=gt({\u0275pipe:gt}),Tu=gt({\u0275mod:gt}),Ba=gt({\u0275fac:gt}),bc=gt({__NG_ELEMENT_ID__:gt});let wc=0;function po(i){return xa(()=>{const e=Pu(i),t={...e,decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===na.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,data:i.data||{},encapsulation:i.encapsulation||sa.Emulated,id:"c"+wc++,styles:i.styles||_s,_:null,schemas:i.schemas||null,tView:null};fd(t);const n=i.dependencies;return t.directiveDefs=gd(n,!1),t.pipeDefs=gd(n,!0),t})}function Mc(i){return Ms(i)||ur(i)}function Su(i){return null!==i}function ws(i){return xa(()=>({type:i.type,bootstrap:i.bootstrap||_s,declarations:i.declarations||_s,imports:i.imports||_s,exports:i.exports||_s,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function Au(i,e){if(null==i)return il;const t={};for(const n in i)if(i.hasOwnProperty(n)){let a=i[n],m=a;Array.isArray(a)&&(m=a[1],a=a[0]),t[a]=n,e&&(e[a]=m)}return t}function Ji(i){return xa(()=>{const e=Pu(i);return fd(e),e})}function dr(i){return{type:i.type,name:i.name,factory:null,pure:!1!==i.pure,standalone:!0===i.standalone,onDestroy:i.type.prototype.ngOnDestroy||null}}function Ms(i){return i[Ch]||null}function ur(i){return i[Th]||null}function pr(i){return i[Sh]||null}function Ko(i,e){const t=i[Tu]||null;if(!t&&!0===e)throw new Error(`Type ${mt(i)} does not have '\u0275mod' property.`);return t}function Pu(i){const e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,exportAs:i.exportAs||null,standalone:!0===i.standalone,selectors:i.selectors||_s,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Au(i.inputs,e),outputs:Au(i.outputs)}}function fd(i){i.features?.forEach(e=>e(i))}function gd(i,e){if(!i)return null;const t=e?pr:Mc;return()=>("function"==typeof i?i():i).map(n=>t(n)).filter(Su)}const ya=0,on=1,zn=2,wo=3,Gr=4,bl=5,Ao=6,kh=7,Co=8,Cc=9,Tc=10,qn=11,Eu=12,Zl=13,xd=14,Kl=15,Jo=16,Ah=17,wl=18,Qo=19,Oa=20,Ph=21,zs=22,_a=1,kc=2,ts=7,Jl=8,Eh=9,qo=10;function kr(i){return Array.isArray(i)&&"object"==typeof i[_a]}function oa(i){return Array.isArray(i)&&!0===i[_a]}function Dh(i){return 0!=(4&i.flags)}function Ih(i){return i.componentOffset>-1}function Ql(i){return 1==(1&i.flags)}function mr(i){return!!i.template}function Fh(i){return 0!=(256&i[zn])}function Ml(i,e){return i.hasOwnProperty(Ba)?i[Ba]:null}class wd{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function er(){return Pc}function Pc(i){return i.type.prototype.ngOnChanges&&(i.setInput=Oh),qp}function qp(){const i=Bu(this),e=i?.current;if(e){const t=i.previous;if(t===il)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function Oh(i,e,t,n){const a=this.declaredInputs[t],m=Bu(i)||function Cd(i,e){return i[Md]=e}(i,{previous:il,current:null}),T=m.current||(m.current={}),z=m.previous,j=z[a];T[a]=new wd(j&&j.currentValue,e,z===il),i[n]=e}er.ngInherit=!0;const Md="__ngSimpleChanges__";function Bu(i){return i[Md]||null}const Rr=function(i,e,t){};function Po(i){for(;Array.isArray(i);)i=i[ya];return i}function Dc(i,e){return Po(e[i])}function Ar(i,e){return Po(e[i.index])}function Ic(i,e){return i.data[e]}function Eo(i,e){return i[e]}function Vr(i,e){const t=e[i];return kr(t)?t:t[ya]}function Sd(i){return 64==(64&i[zn])}function fr(i,e){return null==e?null:i[e]}function Ru(i){i[wl]=0}function Cl(i,e){i[bl]+=e;let t=i,n=i[wo];for(;null!==n&&(1===e&&1===t[bl]||-1===e&&0===t[bl]);)n[bl]+=e,t=n,n=n[wo]}const Sn={lFrame:ht(null),bindingsEnabled:!0};function Rh(){return Sn.bindingsEnabled}function gi(){return Sn.lFrame.lView}function ms(){return Sn.lFrame.tView}function ih(i){return Sn.lFrame.contextLView=i,i[Co]}function nh(i){return Sn.lFrame.contextLView=null,i}function Do(){let i=Rc();for(;null!==i&&64===i.type;)i=i.parent;return i}function Rc(){return Sn.lFrame.currentTNode}function Zr(i,e){const t=Sn.lFrame;t.currentTNode=i,t.isParent=e}function kd(){return Sn.lFrame.isParent}function Ad(){Sn.lFrame.isParent=!1}function gr(){const i=Sn.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function sh(){return Sn.lFrame.bindingIndex++}function zc(i,e){const t=Sn.lFrame;t.bindingIndex=t.bindingRootIndex=i,h(e)}function h(i){Sn.lFrame.currentDirectiveIndex=i}function _(i){const e=Sn.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}function P(){return Sn.lFrame.currentQueryIndex}function V(i){Sn.lFrame.currentQueryIndex=i}function W(i){const e=i[on];return 2===e.type?e.declTNode:1===e.type?i[Ao]:null}function $(i,e,t){if(t&vi.SkipSelf){let a=e,m=i;for(;!(a=a.parent,null!==a||t&vi.Host||(a=W(m),null===a||(m=m[Kl],10&a.type))););if(null===a)return!1;e=a,i=m}const n=Sn.lFrame=tt();return n.currentTNode=e,n.lView=i,!0}function G(i){const e=tt(),t=i[on];Sn.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tt(){const i=Sn.lFrame,e=null===i?null:i.child;return null===e?ht(i):e}function ht(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function lt(){const i=Sn.lFrame;return Sn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const bt=lt;function Dt(){const i=lt();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Ot(){return Sn.lFrame.selectedIndex}function zt(i){Sn.lFrame.selectedIndex=i}function At(){const i=Sn.lFrame;return Ic(i.tView,i.selectedIndex)}function be(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const m=i.data[t].type.prototype,{ngAfterContentInit:T,ngAfterContentChecked:z,ngAfterViewInit:j,ngAfterViewChecked:Z,ngOnDestroy:st}=m;T&&(i.contentHooks??(i.contentHooks=[])).push(-t,T),z&&((i.contentHooks??(i.contentHooks=[])).push(t,z),(i.contentCheckHooks??(i.contentCheckHooks=[])).push(t,z)),j&&(i.viewHooks??(i.viewHooks=[])).push(-t,j),Z&&((i.viewHooks??(i.viewHooks=[])).push(t,Z),(i.viewCheckHooks??(i.viewCheckHooks=[])).push(t,Z)),null!=st&&(i.destroyHooks??(i.destroyHooks=[])).push(t,st)}}function Pe(i,e,t){Se(i,e,3,t)}function Ie(i,e,t,n){(3&i[zn])===t&&Se(i,e,t,n)}function yi(i,e){let t=i[zn];(3&t)===e&&(t&=2047,t+=1,i[zn]=t)}function Se(i,e,t,n){const m=n??-1,T=e.length-1;let z=0;for(let j=void 0!==n?65535&i[wl]:0;j<T;j++)if("number"==typeof e[j+1]){if(z=e[j],null!=n&&z>=n)break}else e[j]<0&&(i[wl]+=65536),(z<m||-1==m)&&(Je(i,t,e,j),i[wl]=(4294901760&i[wl])+j+2),j++}function Je(i,e,t,n){const a=t[n]<0,m=t[n+1],z=i[a?-t[n]:t[n]];if(a){if(i[zn]>>11<i[wl]>>16&&(3&i[zn])===e){i[zn]+=2048,Rr(4,z,m);try{m.call(z)}finally{Rr(5,z,m)}}}else{Rr(4,z,m);try{m.call(z)}finally{Rr(5,z,m)}}}const Ve=-1;class ti{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Fi(i,e,t){let n=0;for(;n<t.length;){const a=t[n];if("number"==typeof a){if(0!==a)break;n++;const m=t[n++],T=t[n++],z=t[n++];i.setAttribute(e,T,z,m)}else{const m=a,T=t[++n];Kn(m)?i.setProperty(e,m,T):i.setAttribute(e,m,T),n++}}return n}function nn(i){return 3===i||4===i||6===i}function Kn(i){return 64===i.charCodeAt(0)}function sn(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const a=e[n];"number"==typeof a?t=a:0===t||fs(i,t,a,null,-1===t||2===t?e[++n]:null)}}return i}function fs(i,e,t,n,a){let m=0,T=i.length;if(-1===e)T=-1;else for(;m<i.length;){const z=i[m++];if("number"==typeof z){if(z===e){T=-1;break}if(z>e){T=m-1;break}}}for(;m<i.length;){const z=i[m];if("number"==typeof z)break;if(z===t){if(null===n)return void(null!==a&&(i[m+1]=a));if(n===i[m+1])return void(i[m+2]=a)}m++,null!==n&&m++,null!==a&&m++}-1!==T&&(i.splice(T,0,e),m=T+1),i.splice(m++,0,t),null!==n&&i.splice(m++,0,n),null!==a&&i.splice(m++,0,a)}function vs(i){return i!==Ve}function Ds(i){return 32767&i}function bo(i,e){let t=function Ns(i){return i>>16}(i),n=e;for(;t>0;)n=n[Kl],t--;return n}let xr=!0;function zr(i){const e=xr;return xr=i,e}const qs=255,Bs=5;let ds=0;const Is={};function Os(i,e){const t=ir(i,e);if(-1!==t)return t;const n=e[on];n.firstCreatePass&&(i.injectorIndex=e.length,Ho(n.data,i),Ho(e,null),Ho(n.blueprint,null));const a=za(i,e),m=i.injectorIndex;if(vs(a)){const T=Ds(a),z=bo(a,e),j=z[on].data;for(let Z=0;Z<8;Z++)e[m+Z]=z[T+Z]|j[T+Z]}return e[m+8]=a,m}function Ho(i,e){i.push(0,0,0,0,0,0,0,0,e)}function ir(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function za(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,a=e;for(;null!==a;){if(n=Zf(a),null===n)return Ve;if(t++,a=a[Kl],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return Ve}function Sl(i,e,t){!function yr(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(bc)&&(n=t[bc]),null==n&&(n=t[bc]=ds++);const a=n&qs;e.data[i+(a>>Bs)]|=1<<a}(i,e,t)}function Jr(i,e,t){if(t&vi.Optional||void 0!==i)return i;wn()}function Na(i,e,t,n){if(t&vi.Optional&&void 0===n&&(n=null),!(t&(vi.Self|vi.Host))){const a=i[Cc],m=Or(void 0);try{return a?a.get(e,n,t&vi.Optional):Yl(e,n,t&vi.Optional)}finally{Or(m)}}return Jr(n,0,t)}function nl(i,e,t,n=vi.Default,a){if(null!==i){if(1024&e[zn]){const T=function fy(i,e,t,n,a){let m=i,T=e;for(;null!==m&&null!==T&&1024&T[zn]&&!(256&T[zn]);){const z=sl(m,T,t,n|vi.Self,Is);if(z!==Is)return z;let j=m.parent;if(!j){const Z=T[Ph];if(Z){const st=Z.get(t,Is,n);if(st!==Is)return st}j=Zf(T),T=T[Kl]}m=j}return a}(i,e,t,n,Is);if(T!==Is)return T}const m=sl(i,e,t,n,Is);if(m!==Is)return m}return Na(e,t,n,a)}function sl(i,e,t,n,a){const m=function py(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(bc)?i[bc]:void 0;return"number"==typeof e?e>=0?e&qs:my:e}(t);if("function"==typeof m){if(!$(e,i,n))return n&vi.Host?Jr(a,0,n):Na(e,t,n,a);try{const T=m(n);if(null!=T||n&vi.Optional)return T;wn()}finally{bt()}}else if("number"==typeof m){let T=null,z=ir(i,e),j=Ve,Z=n&vi.Host?e[Jo][Ao]:null;for((-1===z||n&vi.SkipSelf)&&(j=-1===z?za(i,e):e[z+8],j!==Ve&&Gf(n,!1)?(T=e[on],z=Ds(j),e=bo(j,e)):z=-1);-1!==z;){const st=e[on];if($f(m,z,st.data)){const Mt=Vh(z,e,t,T,n,Z);if(Mt!==Is)return Mt}j=e[z+8],j!==Ve&&Gf(n,e[on].data[z+8]===Z)&&$f(m,z,e)?(T=st,z=Ds(j),e=bo(j,e)):z=-1}}return a}function Vh(i,e,t,n,a,m){const T=e[on],z=T.data[i+8],st=Wu(z,T,t,null==n?Ih(z)&&xr:n!=T&&0!=(3&z.type),a&vi.Host&&m===z);return null!==st?oh(e,T,st,z):Is}function Wu(i,e,t,n,a){const m=i.providerIndexes,T=e.data,z=1048575&m,j=i.directiveStart,st=m>>20,Wt=a?z+st:i.directiveEnd;for(let qt=n?z:z+st;qt<Wt;qt++){const pe=T[qt];if(qt<j&&t===pe||qt>=j&&pe.type===t)return qt}if(a){const qt=T[j];if(qt&&mr(qt)&&qt.type===t)return j}return null}function oh(i,e,t,n){let a=i[t];const m=e.data;if(function Fe(i){return i instanceof ti}(a)){const T=a;T.resolving&&function li(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new Rt(-200,`Circular dependency in DI detected for ${i}${t}`)}(function ni(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():Ue(i)}(m[t]));const z=zr(T.canSeeViewProviders);T.resolving=!0;const j=T.injectImpl?Or(T.injectImpl):null;$(i,n,vi.Default);try{a=i[t]=T.factory(void 0,m,i,n),e.firstCreatePass&&t>=n.directiveStart&&function ge(i,e,t){const{ngOnChanges:n,ngOnInit:a,ngDoCheck:m}=e.type.prototype;if(n){const T=Pc(e);(t.preOrderHooks??(t.preOrderHooks=[])).push(i,T),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(i,T)}a&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-i,a),m&&((t.preOrderHooks??(t.preOrderHooks=[])).push(i,m),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(i,m))}(t,m[t],e)}finally{null!==j&&Or(j),zr(z),T.resolving=!1,bt()}}return a}function $f(i,e,t){return!!(t[e+(i>>Bs)]&1<<i)}function Gf(i,e){return!(i&vi.Self||i&vi.Host&&e)}class Nc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return nl(this._tNode,this._lView,e,Mh(n),t)}}function my(){return new Nc(Do(),gi())}function Ro(i){return xa(()=>{const e=i.prototype.constructor,t=e[Ba]||am(e),n=Object.prototype;let a=Object.getPrototypeOf(i.prototype).constructor;for(;a&&a!==n;){const m=a[Ba]||am(a);if(m&&m!==t)return m;a=Object.getPrototypeOf(a)}return m=>new m})}function am(i){return le(i)?()=>{const e=am(vt(i));return e&&e()}:Ml(i)}function Zf(i){const e=i[on],t=e.type;return 2===t?e.declTNode:1===t?i[Ao]:null}function Xu(i){return function Kr(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let a=0;for(;a<n;){const m=t[a];if(nn(m))break;if(0===m)a+=2;else if("number"==typeof m)for(a++;a<n&&"string"==typeof t[a];)a++;else{if(m===e)return t[a+1];a+=2}}}return null}(Do(),i)}const Wa="__parameters__";function Wc(i,e,t){return xa(()=>{const n=function ju(i){return function(...t){if(i){const n=i(...t);for(const a in n)this[a]=n[a]}}}(e);function a(...m){if(this instanceof a)return n.apply(this,m),this;const T=new a(...m);return z.annotation=T,z;function z(j,Z,st){const Mt=j.hasOwnProperty(Wa)?j[Wa]:Object.defineProperty(j,Wa,{value:[]})[Wa];for(;Mt.length<=st;)Mt.push(null);return(Mt[st]=Mt[st]||[]).push(T),j}}return t&&(a.prototype=Object.create(t.prototype)),a.prototype.ngMetadataName=i,a.annotationCls=a,a})}class Bi{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ne({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ra(i,e){i.forEach(t=>Array.isArray(t)?ra(t,e):e(t))}function Wh(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function cm(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Yu(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}function Fo(i,e,t){let n=Dd(i,e);return n>=0?i[1|n]=t:(n=~n,function yy(i,e,t,n){let a=i.length;if(a==e)i.push(t,n);else if(1===a)i.push(n,i[0]),i[0]=t;else{for(a--,i.push(i[a-1],i[a]);a>e;)i[a]=i[a-2],a--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function qf(i,e){const t=Dd(i,e);if(t>=0)return i[1|t]}function Dd(i,e){return function _n(i,e,t){let n=0,a=i.length>>t;for(;a!==n;){const m=n+(a-n>>1),T=i[m<<t];if(e===T)return m<<t;T>e?a=m:n=m+1}return~(a<<t)}(i,e,1)}const la=el(Wc("Optional"),8),rh=el(Wc("SkipSelf"),4);var _r=(()=>((_r=_r||{})[_r.Important=1]="Important",_r[_r.DashCase=2]="DashCase",_r))();const _m=new Map;let sb=0;const Yh="__ngContext__";function No(i,e){kr(e)?(i[Yh]=e[Oa],function Al(i){_m.set(i[Oa],i)}(e)):i[Yh]=e}let ag;function Hc(i,e){return ag(i,e)}function ns(i){const e=i[wo];return oa(e)?e[wo]:e}function Ha(i){return da(i[Zl])}function Ca(i){return da(i[Gr])}function da(i){for(;null!==i&&!oa(i);)i=i[Gr];return i}function Lo(i,e,t,n,a){if(null!=n){let m,T=!1;oa(n)?m=n:kr(n)&&(T=!0,n=n[ya]);const z=Po(n);0===i&&null!==t?null==a?Oy(e,t,z):Gh(e,t,z,a||null,!0):1===i&&null!==t?Gh(e,t,z,a||null,!0):2===i?function Sm(i,e,t){const n=tp(i,e);n&&function ab(i,e,t,n){i.removeChild(e,t,n)}(i,n,e,t)}(e,z,T):3===i&&e.destroyNode(z),null!=m&&function Xy(i,e,t,n,a){const m=t[ts];m!==Po(t)&&Lo(e,i,n,m,a);for(let z=qo;z<t.length;z++){const j=t[z];Rd(j[on],j,i,e,n,m)}}(e,i,m,t,a)}}function Hh(i,e,t){return i.createElement(e,t)}function Ly(i,e){const t=i[Eh],n=t.indexOf(e),a=e[wo];512&e[zn]&&(e[zn]&=-513,Cl(a,-1)),t.splice(n,1)}function ll(i,e){if(i.length<=qo)return;const t=qo+e,n=i[t];if(n){const a=n[Ah];null!==a&&a!==i&&Ly(a,n),e>0&&(i[t-1][Gr]=n[Gr]);const m=cm(i,qo+e);!function hg(i,e){Rd(i,e,e[qn],2,null,null),e[ya]=null,e[Ao]=null}(n[on],n);const T=m[Qo];null!==T&&T.detachView(m[on]),n[wo]=null,n[Gr]=null,n[zn]&=-65}return n}function $h(i,e){if(!(128&e[zn])){const t=e[qn];t.destroyNode&&Rd(i,e,t,3,null,null),function rb(i){let e=i[Zl];if(!e)return Od(i[on],i);for(;e;){let t=null;if(kr(e))t=e[Zl];else{const n=e[qo];n&&(t=n)}if(!t){for(;e&&!e[Gr]&&e!==i;)kr(e)&&Od(e[on],e),e=e[wo];null===e&&(e=i),kr(e)&&Od(e[on],e),t=e&&e[Gr]}e=t}}(e)}}function Od(i,e){if(!(128&e[zn])){e[zn]&=-65,e[zn]|=128,function ug(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const a=e[t[n]];if(!(a instanceof ti)){const m=t[n+1];if(Array.isArray(m))for(let T=0;T<m.length;T+=2){const z=a[m[T]],j=m[T+1];Rr(4,z,j);try{j.call(z)}finally{Rr(5,z,j)}}else{Rr(4,a,m);try{m.call(a)}finally{Rr(5,a,m)}}}}}(i,e),function Cm(i,e){const t=i.cleanup,n=e[kh];let a=-1;if(null!==t)for(let m=0;m<t.length-1;m+=2)if("string"==typeof t[m]){const T=t[m+3];T>=0?n[a=T]():n[a=-T].unsubscribe(),m+=2}else{const T=n[a=t[m+1]];t[m].call(T)}if(null!==n){for(let m=a+1;m<n.length;m++)(0,n[m])();e[kh]=null}}(i,e),1===e[on].type&&e[qn].destroy();const t=e[Ah];if(null!==t&&oa(e[wo])){t!==e[wo]&&Ly(t,e);const n=e[Qo];null!==n&&n.detachView(i)}!function Ty(i){_m.delete(i[Oa])}(e)}}function pg(i,e,t){return function By(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[ya];{const{componentOffset:a}=n;if(a>-1){const{encapsulation:m}=i.data[n.directiveStart+a];if(m===sa.None||m===sa.Emulated)return null}return Ar(n,t)}}(i,e.parent,t)}function Gh(i,e,t,n,a){i.insertBefore(e,t,n,a)}function Oy(i,e,t){i.appendChild(e,t)}function Tm(i,e,t,n,a){null!==n?Gh(i,e,t,n,a):Oy(i,e,t)}function tp(i,e){return i.parentNode(e)}function Zh(i,e,t){return zy(i,e,t)}let Kh,Er,zd,qh,zy=function mg(i,e,t){return 40&i.type?Ar(i,t):null};function ip(i,e,t,n){const a=pg(i,n,e),m=e[qn],z=Zh(n.parent||e[Ao],n,e);if(null!=a)if(Array.isArray(t))for(let j=0;j<t.length;j++)Tm(m,a,t[j],z,!1);else Tm(m,a,t,z,!1);void 0!==Kh&&Kh(m,n,e,t,a)}function np(i,e){if(null!==e){const t=e.type;if(3&t)return Ar(e,i);if(4&t)return fg(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return np(i,n);{const a=i[e.index];return oa(a)?fg(-1,a):Po(a)}}if(32&t)return Hc(e,i)()||Po(i[e.index]);{const n=Ny(i,e);return null!==n?Array.isArray(n)?n[0]:np(ns(i[Jo]),n):np(i,e.next)}}return null}function Ny(i,e){return null!==e?i[Jo][Ao].projection[e.projection]:null}function fg(i,e){const t=qo+i+1;if(t<e.length){const n=e[t],a=n[on].firstChild;if(null!==a)return np(n,a)}return e[ts]}function gg(i,e,t,n,a,m,T){for(;null!=t;){const z=n[t.index],j=t.type;if(T&&0===e&&(z&&No(Po(z),n),t.flags|=2),32!=(32&t.flags))if(8&j)gg(i,e,t.child,n,a,m,!1),Lo(e,i,a,z,m);else if(32&j){const Z=Hc(t,n);let st;for(;st=Z();)Lo(e,i,a,st,m);Lo(e,i,a,z,m)}else 16&j?Wy(i,e,n,t,a,m):Lo(e,i,a,z,m);t=T?t.projectionNext:t.next}}function Rd(i,e,t,n,a,m){gg(t,n,i.firstChild,e,a,m,!1)}function Wy(i,e,t,n,a,m){const T=t[Jo],j=T[Ao].projection[n.projection];if(Array.isArray(j))for(let Z=0;Z<j.length;Z++)Lo(e,i,a,j[Z],m);else gg(i,e,j,T[wo],a,m,!0)}function km(i,e,t){""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function El(i,e,t){const{mergedAttrs:n,classes:a,styles:m}=t;null!==n&&Fi(i,e,n),null!==a&&km(i,e,a),null!==m&&function Uy(i,e,t){i.setAttribute(e,"style",t)}(i,e,m)}function Jh(i){return function xg(){if(void 0===Er&&(Er=null,Qs.trustedTypes))try{Er=Qs.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return Er}()?.createHTML(i)||i}function Gy(i){return function yg(){if(void 0===qh&&(qh=null,Qs.trustedTypes))try{qh=Qs.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return qh}()?.createScriptURL(i)||i}class $c{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ye})`}}class db extends $c{getTypeName(){return"HTML"}}class ub extends $c{getTypeName(){return"Style"}}class _g extends $c{getTypeName(){return"Script"}}class pb extends $c{getTypeName(){return"URL"}}class Nd extends $c{getTypeName(){return"ResourceURL"}}function Ta(i){return i instanceof $c?i.changingThisBreaksApplicationSecurity:i}function Ws(i,e){const t=function Am(i){return i instanceof $c&&i.getTypeName()||null}(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${ye})`)}return t===e}class op{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Jh(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class bg{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Jh(e),t}}const mb=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function rp(i){return(i=String(i)).match(mb)?i:"unsafe:"+i}function Sa(i){const e={};for(const t of i.split(","))e[t]=!0;return e}function ap(...i){const e={};for(const t of i)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const Dm=Sa("area,br,col,hr,img,wbr"),Jy=Sa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Im=Sa("rp,rt"),Cg=ap(Dm,ap(Jy,Sa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ap(Im,Sa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ap(Im,Jy)),Tg=Sa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),qy=ap(Tg,Sa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Fm=Sa("script,style,template");class fb{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let a=this.checkClobberedElement(t,t.nextSibling);if(a){t=a;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Cg.hasOwnProperty(t))return this.sanitizedSomething=!0,!Fm.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let a=0;a<n.length;a++){const m=n.item(a),T=m.name,z=T.toLowerCase();if(!qy.hasOwnProperty(z)){this.sanitizedSomething=!0;continue}let j=m.value;Tg[z]&&(j=rp(j)),this.buf.push(" ",T,'="',e_(j),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Cg.hasOwnProperty(t)&&!Dm.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(e_(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const t_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Wd=/([^\#-~ |!])/g;function e_(i){return i.replace(/&/g,"&amp;").replace(t_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Wd,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Lm;function i_(i,e){let t=null;try{Lm=Lm||function vg(i){const e=new bg(i);return function wg(){try{return!!(new window.DOMParser).parseFromString(Jh(""),"text/html")}catch{return!1}}()?new op(e):e}(i);let n=e?String(e):"";t=Lm.getInertBodyElement(n);let a=5,m=n;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,n=m,m=t.innerHTML,t=Lm.getInertBodyElement(n)}while(n!==m);return Jh((new fb).sanitizeChildren(Bm(t)||t))}finally{if(t){const n=Bm(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function Bm(i){return"content"in i&&function n_(i){return i.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===i.nodeName}(i)?i.content:null}var Gs=(()=>((Gs=Gs||{})[Gs.NONE=0]="NONE",Gs[Gs.HTML=1]="HTML",Gs[Gs.STYLE=2]="STYLE",Gs[Gs.SCRIPT=3]="SCRIPT",Gs[Gs.URL=4]="URL",Gs[Gs.RESOURCE_URL=5]="RESOURCE_URL",Gs))();function lp(i){const e=jd();return e?e.sanitize(Gs.URL,i)||"":Ws(i,"URL")?Ta(i):rp(Ue(i))}function hp(i){const e=jd();if(e)return Gy(e.sanitize(Gs.RESOURCE_URL,i)||"");if(Ws(i,"ResourceURL"))return Gy(Ta(i));throw new Rt(904,!1)}function jd(){const i=gi();return i&&i[Eu]}const Vm=new Bi("ENVIRONMENT_INITIALIZER"),Sg=new Bi("INJECTOR",-1),kg=new Bi("INJECTOR_DEF_TYPES");class Ag{get(e,t=hs){if(t===hs){const n=new Error(`NullInjectorError: No provider for ${mt(e)}!`);throw n.name="NullInjectorError",n}return t}}function o_(...i){return{\u0275providers:Pg(0,i),\u0275fromNgModule:!0}}function Pg(i,...e){const t=[],n=new Set;let a;return ra(e,m=>{const T=m;Eg(T,t,[],n)&&(a||(a=[]),a.push(T))}),void 0!==a&&r_(a,t),t}function r_(i,e){for(let t=0;t<i.length;t++){const{providers:a}=i[t];Ud(a,m=>{e.push(m)})}}function Eg(i,e,t,n){if(!(i=vt(i)))return!1;let a=null,m=_i(i);const T=!m&&Ms(i);if(m||T){if(T&&!T.standalone)return!1;a=i}else{const j=i.ngModule;if(m=_i(j),!m)return!1;a=j}const z=n.has(a);if(T){if(z)return!1;if(n.add(a),T.dependencies){const j="function"==typeof T.dependencies?T.dependencies():T.dependencies;for(const Z of j)Eg(Z,e,t,n)}}else{if(!m)return!1;{if(null!=m.imports&&!z){let Z;n.add(a);try{ra(m.imports,st=>{Eg(st,e,t,n)&&(Z||(Z=[]),Z.push(st))})}finally{}void 0!==Z&&r_(Z,e)}if(!z){const Z=Ml(a)||(()=>new a);e.push({provide:a,useFactory:Z,deps:_s},{provide:kg,useValue:a,multi:!0},{provide:Vm,useValue:()=>fi(a),multi:!0})}const j=m.providers;null==j||z||Ud(j,st=>{e.push(st)})}}return a!==i&&void 0!==i.providers}function Ud(i,e){for(let t of i)Ht(t)&&(t=t.\u0275providers),Array.isArray(t)?Ud(t,e):e(t)}const a_=gt({provide:String,useValue:gt});function vr(i){return null!==i&&"object"==typeof i&&a_ in i}function hl(i){return"function"==typeof i}const zm=new Bi("Set Injector scope."),Nm={},wb={};let Dg;function Wm(){return void 0===Dg&&(Dg=new Ag),Dg}class Dl{}class h_ extends Dl{get destroyed(){return this._destroyed}constructor(e,t,n,a){super(),this.parent=t,this.source=n,this.scopes=a,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fg(e,T=>this.processProvider(T)),this.records.set(Sg,Zc(void 0,this)),a.has("environment")&&this.records.set(Dl,Zc(void 0,this));const m=this.records.get(zm);null!=m&&"string"==typeof m.value&&this.scopes.add(m.value),this.injectorDefTypes=new Set(this.get(kg.multi,_s,vi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=tl(this),n=Or(void 0);try{return e()}finally{tl(t),Or(n)}}get(e,t=hs,n=vi.Default){this.assertNotDestroyed(),n=Mh(n);const a=tl(this),m=Or(void 0);try{if(!(n&vi.SkipSelf)){let z=this.records.get(e);if(void 0===z){const j=function Sb(i){return"function"==typeof i||"object"==typeof i&&i instanceof Bi}(e)&&Ki(e);z=j&&this.injectableDefInScope(j)?Zc(Hd(e),Nm):null,this.records.set(e,z)}if(null!=z)return this.hydrate(e,z)}return(n&vi.Self?Wm():this.parent).get(e,t=n&vi.Optional&&t===hs?null:t)}catch(T){if("NullInjectorError"===T.name){if((T[wh]=T[wh]||[]).unshift(mt(e)),a)throw T;return function Zp(i,e,t,n){const a=i[wh];throw e[vc]&&a.unshift(e[vc]),i.message=function Cu(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&i.charAt(1)==md?i.slice(2):i;let a=mt(e);if(Array.isArray(e))a=e.map(mt).join(" -> ");else if("object"==typeof e){let m=[];for(let T in e)if(e.hasOwnProperty(T)){let z=e[T];m.push(T+":"+("string"==typeof z?JSON.stringify(z):mt(z)))}a=`{${m.join(", ")}}`}return`${t}${n?"("+n+")":""}[${a}]: ${i.replace(_c,"\n  ")}`}("\n"+i.message,a,t,n),i[yc]=a,i[wh]=null,i}(T,e,"R3InjectorError",this.source)}throw T}finally{Or(m),tl(a)}}resolveInjectorInitializers(){const e=tl(this),t=Or(void 0);try{const n=this.get(Vm.multi,_s,vi.Self);for(const a of n)a()}finally{tl(e),Or(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(mt(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Rt(205,!1)}processProvider(e){let t=hl(e=vt(e))?e:vt(e&&e.provide);const n=function c_(i){return vr(i)?Zc(void 0,i.useValue):Zc(Ig(i),Nm)}(e);if(hl(e)||!0!==e.multi)this.records.get(t);else{let a=this.records.get(t);a||(a=Zc(void 0,Nm,!0),a.factory=()=>rs(a.multi),this.records.set(t,a)),t=e,a.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===Nm&&(t.value=wb,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Tb(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=vt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Hd(i){const e=Ki(i),t=null!==e?e.factory:Ml(i);if(null!==t)return t;if(i instanceof Bi)throw new Rt(204,!1);if(i instanceof Function)return function Mb(i){const e=i.length;if(e>0)throw Yu(e,"?"),new Rt(204,!1);const t=function Di(i){const e=i&&(i[Tn]||i[zo]);return e?(function Mi(i){if(i.hasOwnProperty("name"))return i.name;(""+i).match(/^function\s*([^\s(]+)/)}(i),e):null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new Rt(204,!1)}function Ig(i,e,t){let n;if(hl(i)){const a=vt(i);return Ml(a)||Hd(a)}if(vr(i))n=()=>vt(i.useValue);else if(function Gc(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...rs(i.deps||[]));else if(function Yd(i){return!(!i||!i.useExisting)}(i))n=()=>fi(vt(i.useExisting));else{const a=vt(i&&(i.useClass||i.provide));if(!function Cb(i){return!!i.deps}(i))return Ml(a)||Hd(a);n=()=>new a(...rs(i.deps))}return n}function Zc(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function Fg(i,e){for(const t of i)Array.isArray(t)?Fg(t,e):t&&Ht(t)?Fg(t.\u0275providers,e):e(t)}class kb{}class Lg{}class Bg{resolveComponentFactory(e){throw function Ab(i){const e=Error(`No component factory found for ${mt(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let tc=(()=>{class i{}return i.NULL=new Bg,i})();function $d(){return Gd(Do(),gi())}function Gd(i,e){return new to(Ar(i,e))}let to=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=$d,i})();function dp(i){return i instanceof to?i.nativeElement:i}class up{}let hh=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function pp(){const i=gi(),t=Vr(Do().index,i);return(kr(t)?t:i)[qn]}(),i})(),d_=(()=>{class i{}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:()=>null}),i})();class ec{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Zs=new ec("15.2.7"),mp={},Xm="ngOriginalError";function cl(i){return i[Xm]}class ua{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&cl(e);for(;t&&cl(t);)t=cl(t);return t||null}}function ch(i){return i instanceof Function?i():i}function f_(i,e,t){let n=i.length;for(;;){const a=i.indexOf(e,t);if(-1===a)return a;if(0===a||i.charCodeAt(a-1)<=32){const m=e.length;if(a+m===n||i.charCodeAt(a+m)<=32)return a}t=a+1}}const Um="ng-template";function Og(i,e,t){let n=0,a=!0;for(;n<i.length;){let m=i[n++];if("string"==typeof m&&a){const T=i[n++];if(t&&"class"===m&&-1!==f_(T.toLowerCase(),e,0))return!0}else{if(1===m){for(;n<i.length&&"string"==typeof(m=i[n++]);)if(m.toLowerCase()===e)return!0;return!1}"number"==typeof m&&(a=!1)}}return!1}function Rg(i){return 4===i.type&&i.value!==Um}function ka(i,e,t){return e===(4!==i.type||t?i.value:Um)}function gp(i,e,t){let n=4;const a=i.attrs||[],m=function g_(i){for(let e=0;e<i.length;e++)if(nn(i[e]))return e;return i.length}(a);let T=!1;for(let z=0;z<e.length;z++){const j=e[z];if("number"!=typeof j){if(!T)if(4&n){if(n=2|1&n,""!==j&&!ka(i,j,t)||""===j&&1===e.length){if(Wr(n))return!1;T=!0}}else{const Z=8&n?j:e[++z];if(8&n&&null!==i.attrs){if(!Og(i.attrs,Z,t)){if(Wr(n))return!1;T=!0}continue}const Mt=Vg(8&n?"class":j,a,Rg(i),t);if(-1===Mt){if(Wr(n))return!1;T=!0;continue}if(""!==Z){let Wt;Wt=Mt>m?"":a[Mt+1].toLowerCase();const qt=8&n?Wt:null;if(qt&&-1!==f_(qt,Z,0)||2&n&&Z!==Wt){if(Wr(n))return!1;T=!0}}}}else{if(!T&&!Wr(n)&&!Wr(j))return!1;if(T&&Wr(j))continue;T=!1,n=j|1&n}}return Wr(n)||T}function Wr(i){return 0==(1&i)}function Vg(i,e,t,n){if(null===e)return-1;let a=0;if(n||!t){let m=!1;for(;a<e.length;){const T=e[a];if(T===i)return a;if(3===T||6===T)m=!0;else{if(1===T||2===T){let z=e[++a];for(;"string"==typeof z;)z=e[++a];continue}if(4===T)break;if(0===T){a+=4;continue}}a+=m?1:2}return-1}return function x_(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function xp(i,e,t=!1){for(let n=0;n<e.length;n++)if(gp(i,e[n],t))return!0;return!1}function Vb(i,e){t:for(let t=0;t<e.length;t++){const n=e[t];if(i.length===n.length){for(let a=0;a<i.length;a++)if(i[a]!==n[a])continue t;return!0}}return!1}function zg(i,e){return i?":not("+e.trim()+")":e}function y_(i){let e=i[0],t=1,n=2,a="",m=!1;for(;t<i.length;){let T=i[t];if("string"==typeof T)if(2&n){const z=i[++t];a+="["+T+(z.length>0?'="'+z+'"':"")+"]"}else 8&n?a+="."+T:4&n&&(a+=" "+T);else""!==a&&!Wr(T)&&(e+=zg(m,a),a=""),n=T,m=m||!Wr(n);t++}return""!==a&&(e+=zg(m,a)),e}const es={};function To(i){Il(ms(),gi(),Ot()+i,!1)}function Il(i,e,t,n){if(!n)if(3==(3&e[zn])){const m=i.preOrderCheckHooks;null!==m&&Pe(e,m,t)}else{const m=i.preOrderHooks;null!==m&&Ie(e,m,0,t)}zt(t)}function jg(i,e=null,t=null,n){const a=Ug(i,e,t,n);return a.resolveInjectorInitializers(),a}function Ug(i,e=null,t=null,n,a=new Set){const m=[t||_s,o_(i)];return n=n||("object"==typeof i?void 0:mt(i)),new h_(m,e||Wm(),n||null,a)}let Aa=(()=>{class i{static create(t,n){if(Array.isArray(t))return jg({name:""},n,t,"");{const a=t.name??"";return jg({name:a},t.parent,t.providers,a)}}}return i.THROW_IF_NOT_FOUND=hs,i.NULL=new Ag,i.\u0275prov=Ne({token:i,providedIn:"any",factory:()=>fi(Sg)}),i.__NG_ELEMENT_ID__=-1,i})();function Ee(i,e=vi.Default){const t=gi();return null===t?fi(i,e):nl(Do(),t,vt(i),e)}function Jc(){throw new Error("invalid")}function E_(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const m=t[n+1];if(-1!==m){const T=i.data[m];V(t[n]),T.contentQueries(2,e[m],m)}}}function Qc(i,e,t,n,a,m,T,z,j,Z,st){const Mt=e.blueprint.slice();return Mt[ya]=a,Mt[zn]=76|n,(null!==st||i&&1024&i[zn])&&(Mt[zn]|=1024),Ru(Mt),Mt[wo]=Mt[Kl]=i,Mt[Co]=t,Mt[Tc]=T||i&&i[Tc],Mt[qn]=z||i&&i[qn],Mt[Eu]=j||i&&i[Eu]||null,Mt[Cc]=Z||i&&i[Cc]||null,Mt[Ao]=m,Mt[Oa]=function og(){return sb++}(),Mt[Ph]=st,Mt[Jo]=2==e.type?i[Jo]:Mt,Mt}function qd(i,e,t,n,a){let m=i.data[e];if(null===m)m=function Qm(i,e,t,n,a){const m=Rc(),T=kd(),j=i.data[e]=function Hb(i,e,t,n,a,m){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:a,attrs:m,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,T?m:m&&m.parent,t,e,n,a);return null===i.firstChild&&(i.firstChild=j),null!==m&&(T?null==m.child&&null!==j.parent&&(m.child=j):null===m.next&&(m.next=j,j.prev=m)),j}(i,e,t,n,a),function rm(){return Sn.lFrame.inI18n}()&&(m.flags|=32);else if(64&m.type){m.type=t,m.value=n,m.attrs=a;const T=function Ra(){const i=Sn.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();m.injectorIndex=null===T?-1:T.injectorIndex}return Zr(m,!0),m}function tu(i,e,t,n){if(0===t)return-1;const a=e.length;for(let m=0;m<t;m++)e.push(n),i.blueprint.push(n),i.data.push(null);return a}function Jg(i,e,t){G(e);try{const n=i.viewQuery;null!==n&&Bl(1,n,t);const a=i.template;null!==a&&D_(i,e,a,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&E_(i,e),i.staticViewQueries&&Bl(2,i.viewQuery,t);const m=i.components;null!==m&&function Qd(i,e){for(let t=0;t<e.length;t++)V_(i,e[t])}(e,m)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[zn]&=-5,Dt()}}function vp(i,e,t,n){const a=e[zn];if(128!=(128&a)){G(e);try{Ru(e),function Nu(i){return Sn.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&D_(i,e,t,2,n);const T=3==(3&a);if(T){const Z=i.preOrderCheckHooks;null!==Z&&Pe(e,Z,null)}else{const Z=i.preOrderHooks;null!==Z&&Ie(e,Z,0,null),yi(e,0)}if(function nx(i){for(let e=Ha(i);null!==e;e=Ca(e)){if(!e[kc])continue;const t=e[Eh];for(let n=0;n<t.length;n++){const a=t[n];512&a[zn]||Cl(a[wo],1),a[zn]|=512}}}(e),function R_(i){for(let e=Ha(i);null!==e;e=Ca(e))for(let t=qo;t<e.length;t++){const n=e[t],a=n[on];Sd(n)&&vp(a,n,a.template,n[Co])}}(e),null!==i.contentQueries&&E_(i,e),T){const Z=i.contentCheckHooks;null!==Z&&Pe(e,Z)}else{const Z=i.contentHooks;null!==Z&&Ie(e,Z,1),yi(e,1)}!function Jm(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const a=t[n];if(a<0)zt(~a);else{const m=a,T=t[++n],z=t[++n];zc(T,m),z(2,e[m])}}}finally{zt(-1)}}(i,e);const z=i.components;null!==z&&function Yb(i,e){for(let t=0;t<e.length;t++)qb(i,e[t])}(e,z);const j=i.viewQuery;if(null!==j&&Bl(2,j,n),T){const Z=i.viewCheckHooks;null!==Z&&Pe(e,Z)}else{const Z=i.viewHooks;null!==Z&&Ie(e,Z,2),yi(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),e[zn]&=-41,512&e[zn]&&(e[zn]&=-513,Cl(e[wo],-1))}finally{Dt()}}}function D_(i,e,t,n,a){const m=Ot(),T=2&n;try{zt(-1),T&&e.length>zs&&Il(i,e,zs,!1),Rr(T?2:0,a),t(n,a)}finally{zt(m),Rr(T?3:1,a)}}function qm(i,e,t){if(Dh(e)){const a=e.directiveEnd;for(let m=e.directiveStart;m<a;m++){const T=i.data[m];T.contentQueries&&T.contentQueries(1,t[m],m)}}}function Qg(i,e,t){Rh()&&(function Zb(i,e,t,n){const a=t.directiveStart,m=t.directiveEnd;Ih(t)&&function oc(i,e,t){const n=Ar(e,i),a=I_(t),m=i[Tc],T=wp(i,Qc(i,a,null,t.onPush?32:16,n,e,m,m.createRenderer(n,t),null,null,null));i[e.index]=T}(e,t,i.data[a+t.componentOffset]),i.firstCreatePass||Os(t,e),No(n,e);const T=t.initialInputs;for(let z=a;z<m;z++){const j=i.data[z],Z=oh(e,i,z,t);No(Z,e),null!==T&&hf(0,z-a,Z,j,0,T),mr(j)&&(Vr(t.index,e)[Co]=oh(e,i,z,t))}}(i,e,t,Ar(t,e)),64==(64&t.flags)&&eu(i,e,t))}function tf(i,e,t=Ar){const n=e.localNames;if(null!==n){let a=e.index+1;for(let m=0;m<n.length;m+=2){const T=n[m+1],z=-1===T?t(e,i):i[T];i[a++]=z}}}function I_(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=qg(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function qg(i,e,t,n,a,m,T,z,j,Z){const st=zs+n,Mt=st+a,Wt=function ef(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:es);return t}(st,Mt),qt="function"==typeof Z?Z():Z;return Wt[on]={type:i,blueprint:Wt,template:t,queries:null,viewQuery:z,declTNode:e,data:Wt.slice().fill(null,st),bindingStartIndex:st,expandoStartIndex:Mt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof m?m():m,pipeRegistry:"function"==typeof T?T():T,firstChild:null,schemas:j,consts:qt,incompleteFirstPass:!1}}function bp(i,e,t,n){const a=N_(e);null===t?a.push(n):(a.push(t),i.firstCreatePass&&W_(i).push(n,a.length-1))}function sf(i,e,t,n){for(let a in i)if(i.hasOwnProperty(a)){t=null===t?{}:t;const m=i[a];null===n?rf(t,e,a,m):n.hasOwnProperty(a)&&rf(t,e,n[a],m)}return t}function rf(i,e,t,n){i.hasOwnProperty(t)?i[t].push(e,n):i[t]=[e,n]}function Qr(i,e,t,n,a,m,T,z){const j=Ar(e,t);let st,Z=e.inputs;!z&&null!=Z&&(st=Z[n])?(rc(i,t,st,n,a),Ih(e)&&function F_(i,e){const t=Vr(e,i);16&t[zn]||(t[zn]|=32)}(t,e.index)):3&e.type&&(n=function $b(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),a=null!=T?T(a,e.value||"",n):a,m.setProperty(j,n,a))}function tx(i,e,t,n){if(Rh()){const a=null===n?null:{"":-1},m=function Jb(i,e){const t=i.directiveRegistry;let n=null,a=null;if(t)for(let m=0;m<t.length;m++){const T=t[m];if(xp(e,T.selectors,!1))if(n||(n=[]),mr(T))if(null!==T.findHostDirectiveDefs){const z=[];a=a||new Map,T.findHostDirectiveDefs(T,z,a),n.unshift(...z,T),lf(i,e,z.length)}else n.unshift(T),lf(i,e,0);else a=a||new Map,T.findHostDirectiveDefs?.(T,n,a),n.push(T)}return null===n?null:[n,a]}(i,t);let T,z;null===m?T=z=null:[T,z]=m,null!==T&&L_(i,e,t,T,a,z),a&&function Qb(i,e,t){if(e){const n=i.localNames=[];for(let a=0;a<e.length;a+=2){const m=t[e[a+1]];if(null==m)throw new Rt(-301,!1);n.push(e[a],m)}}}(t,n,a)}t.mergedAttrs=sn(t.mergedAttrs,t.attrs)}function L_(i,e,t,n,a,m){for(let Z=0;Z<n.length;Z++)Sl(Os(t,e),i,n[Z].type);!function $a(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}(t,i.data.length,n.length);for(let Z=0;Z<n.length;Z++){const st=n[Z];st.providersResolver&&st.providersResolver(st)}let T=!1,z=!1,j=tu(i,e,n.length,null);for(let Z=0;Z<n.length;Z++){const st=n[Z];t.mergedAttrs=sn(t.mergedAttrs,st.hostAttrs),Fl(i,t,e,j,st),B_(j,st,a),null!==st.contentQueries&&(t.flags|=4),(null!==st.hostBindings||null!==st.hostAttrs||0!==st.hostVars)&&(t.flags|=64);const Mt=st.type.prototype;!T&&(Mt.ngOnChanges||Mt.ngOnInit||Mt.ngDoCheck)&&((i.preOrderHooks??(i.preOrderHooks=[])).push(t.index),T=!0),!z&&(Mt.ngOnChanges||Mt.ngDoCheck)&&((i.preOrderCheckHooks??(i.preOrderCheckHooks=[])).push(t.index),z=!0),j++}!function sc(i,e,t){const a=e.directiveEnd,m=i.data,T=e.attrs,z=[];let j=null,Z=null;for(let st=e.directiveStart;st<a;st++){const Mt=m[st],Wt=t?t.get(Mt):null,pe=Wt?Wt.outputs:null;j=sf(Mt.inputs,st,j,Wt?Wt.inputs:null),Z=sf(Mt.outputs,st,Z,pe);const Me=null===j||null===T||Rg(e)?null:O_(j,st,T);z.push(Me)}null!==j&&(j.hasOwnProperty("class")&&(e.flags|=8),j.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=z,e.inputs=j,e.outputs=Z}(i,t,m)}function eu(i,e,t){const n=t.directiveStart,a=t.directiveEnd,m=t.index,T=function S(){return Sn.lFrame.currentDirectiveIndex}();try{zt(m);for(let z=n;z<a;z++){const j=i.data[z],Z=e[z];h(z),(null!==j.hostBindings||0!==j.hostVars||null!==j.hostAttrs)&&Kb(j,Z)}}finally{zt(-1),h(T)}}function Kb(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function lf(i,e,t){e.componentOffset=t,(i.components??(i.components=[])).push(e.index)}function B_(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;mr(e)&&(t[""]=i)}}function Fl(i,e,t,n,a){i.data[n]=a;const m=a.factory||(a.factory=Ml(a.type)),T=new ti(m,mr(a),Ee);i.blueprint[n]=T,t[n]=T,function Gb(i,e,t,n,a){const m=a.hostBindings;if(m){let T=i.hostBindingOpCodes;null===T&&(T=i.hostBindingOpCodes=[]);const z=~e.index;(function ex(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(T)!=z&&T.push(z),T.push(t,n,m)}}(i,e,n,tu(i,t,a.hostVars,es),a)}function rr(i,e,t,n,a,m){const T=Ar(i,e);!function Ll(i,e,t,n,a,m,T){if(null==m)i.removeAttribute(e,a,t);else{const z=null==T?Ue(m):T(m,n||"",a);i.setAttribute(e,a,z,t)}}(e[qn],T,m,i.value,t,n,a)}function hf(i,e,t,n,a,m){const T=m[e];if(null!==T){const z=n.setInput;for(let j=0;j<T.length;){const Z=T[j++],st=T[j++],Mt=T[j++];null!==z?n.setInput(t,Mt,Z,st):t[st]=Mt}}}function O_(i,e,t){let n=null,a=0;for(;a<t.length;){const m=t[a];if(0!==m)if(5!==m){if("number"==typeof m)break;if(i.hasOwnProperty(m)){null===n&&(n=[]);const T=i[m];for(let z=0;z<T.length;z+=2)if(T[z]===e){n.push(m,T[z+1],t[a+1]);break}}a+=2}else a+=2;else a+=4}return n}function ix(i,e,t,n){return[i,!0,!1,e,null,0,n,t,null,null]}function qb(i,e){const t=Vr(e,i);if(Sd(t)){const n=t[on];48&t[zn]?vp(n,t,n.template,t[Co]):t[bl]>0&&cf(t)}}function cf(i){for(let n=Ha(i);null!==n;n=Ca(n))for(let a=qo;a<n.length;a++){const m=n[a];if(Sd(m))if(512&m[zn]){const T=m[on];vp(T,m,T.template,m[Co])}else m[bl]>0&&cf(m)}const t=i[on].components;if(null!==t)for(let n=0;n<t.length;n++){const a=Vr(t[n],i);Sd(a)&&a[bl]>0&&cf(a)}}function V_(i,e){const t=Vr(e,i),n=t[on];(function z_(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),Jg(n,t,t[Co])}function wp(i,e){return i[Zl]?i[xd][Gr]=e:i[Zl]=e,i[xd]=e,e}function Mp(i){for(;i;){i[zn]|=32;const e=ns(i);if(Fh(i)&&!e)return i;i=e}return null}function Cp(i,e,t,n=!0){const a=e[Tc];a.begin&&a.begin();try{vp(i,e,i.template,t)}catch(T){throw n&&X_(e,T),T}finally{a.end&&a.end()}}function Bl(i,e,t){V(0),e(i,t)}function N_(i){return i[kh]||(i[kh]=[])}function W_(i){return i.cleanup||(i.cleanup=[])}function Tp(i,e,t){return(null===i||mr(i))&&(t=function tm(i){for(;Array.isArray(i);){if("object"==typeof i[_a])return i;i=i[ya]}return null}(t[e.index])),t[qn]}function X_(i,e){const t=i[Cc],n=t?t.get(ua,null):null;n&&n.handleError(e)}function rc(i,e,t,n,a){for(let m=0;m<t.length;){const T=t[m++],z=t[m++],j=e[T],Z=i.data[T];null!==Z.setInput?Z.setInput(j,a,n,z):j[z]=a}}function iu(i,e,t){let n=t?i.styles:null,a=t?i.classes:null,m=0;if(null!==e)for(let T=0;T<e.length;T++){const z=e[T];"number"==typeof z?m=z:1==m?a=Tt(a,z):2==m&&(n=Tt(n,z+": "+e[++T]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=a:i.classesWithoutHost=a}function Pa(i,e,t,n,a=!1){for(;null!==t;){const m=e[t.index];if(null!==m&&n.push(Po(m)),oa(m))for(let z=qo;z<m.length;z++){const j=m[z],Z=j[on].firstChild;null!==Z&&Pa(j[on],j,Z,n)}const T=t.type;if(8&T)Pa(i,e,t.child,n);else if(32&T){const z=Hc(t,e);let j;for(;j=z();)n.push(j)}else if(16&T){const z=Ny(e,t);if(Array.isArray(z))n.push(...z);else{const j=ns(e[Jo]);Pa(j[on],j,z,n,!0)}}t=a?t.projectionNext:t.next}return n}class qc{get rootNodes(){const e=this._lView,t=e[on];return Pa(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Co]}set context(e){this._lView[Co]=e}get destroyed(){return 128==(128&this._lView[zn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[wo];if(oa(e)){const t=e[Jl],n=t?t.indexOf(this):-1;n>-1&&(ll(e,n),cm(t,n))}this._attachedToViewContainer=!1}$h(this._lView[on],this._lView)}onDestroy(e){bp(this._lView[on],this._lView,null,e)}markForCheck(){Mp(this._cdRefInjectingView||this._lView)}detach(){this._lView[zn]&=-65}reattach(){this._lView[zn]|=64}detectChanges(){Cp(this._lView[on],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Rt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function cg(i,e){Rd(i,e,e[qn],2,null,null)}(this._lView[on],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Rt(902,!1);this._appRef=e}}class sx extends qc{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Cp(e[on],e,e[Co],!1)}checkNoChanges(){}get context(){return null}}class Ga extends tc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ms(e);return new dh(t,this.ngModule)}}function ac(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class U_{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Mh(n);const a=this.injector.get(e,mp,n);return a!==mp||t===mp?a:this.parentInjector.get(e,t,n)}}class dh extends Lg{get inputs(){return ac(this.componentDef.inputs)}get outputs(){return ac(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Ng(i){return i.map(y_).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,a){let m=(a=a||this.ngModule)instanceof Dl?a:a?.injector;m&&null!==this.componentDef.getStandaloneInjector&&(m=this.componentDef.getStandaloneInjector(m)||m);const T=m?new U_(e,m):e,z=T.get(up,null);if(null===z)throw new Rt(407,!1);const j=T.get(d_,null),Z=z.createRenderer(null,this.componentDef),st=this.componentDef.selectors[0][0]||"div",Mt=n?function nf(i,e,t){return i.selectRootElement(e,t===sa.ShadowDom)}(Z,n,this.componentDef.encapsulation):Hh(Z,st,function j_(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(st)),Wt=this.componentDef.onPush?288:272,qt=qg(0,null,null,1,0,null,null,null,null,null),pe=Qc(null,qt,null,Wt,null,null,z,Z,j,T,null);let Me,Xe;G(pe);try{const He=this.componentDef;let Ai,ii=null;He.findHostDirectiveDefs?(Ai=[],ii=new Map,He.findHostDirectiveDefs(He,Ai,ii),Ai.push(He)):Ai=[He];const dn=function Y_(i,e){const t=i[on],n=zs;return i[n]=e,qd(t,n,2,"#host",null)}(pe,Mt),Xs=function s1(i,e,t,n,a,m,T,z){const j=a[on];!function H_(i,e,t,n){for(const a of i)e.mergedAttrs=sn(e.mergedAttrs,a.hostAttrs);null!==e.mergedAttrs&&(iu(e,e.mergedAttrs,!0),null!==t&&El(n,t,e))}(n,i,e,T);const Z=m.createRenderer(e,t),st=Qc(a,I_(t),null,t.onPush?32:16,a[i.index],i,m,Z,z||null,null,null);return j.firstCreatePass&&lf(j,i,n.length-1),wp(a,st),a[i.index]=st}(dn,Mt,He,Ai,pe,z,Z);Xe=Ic(qt,zs),Mt&&function o1(i,e,t,n){if(n)Fi(i,t,["ng-version",Zs.full]);else{const{attrs:a,classes:m}=function __(i){const e=[],t=[];let n=1,a=2;for(;n<i.length;){let m=i[n];if("string"==typeof m)2===a?""!==m&&e.push(m,i[++n]):8===a&&t.push(m);else{if(!Wr(a))break;a=m}n++}return{attrs:e,classes:t}}(e.selectors[0]);a&&Fi(i,t,a),m&&m.length>0&&km(i,t,m.join(" "))}}(Z,He,Mt,n),void 0!==t&&function ox(i,e,t){const n=i.projection=[];for(let a=0;a<e.length;a++){const m=t[a];n.push(null!=m?Array.from(m):null)}}(Xe,this.ngContentSelectors,t),Me=function $_(i,e,t,n,a,m){const T=Do(),z=a[on],j=Ar(T,a);L_(z,a,T,t,null,n);for(let st=0;st<t.length;st++)No(oh(a,z,T.directiveStart+st,T),a);eu(z,a,T),j&&No(j,a);const Z=oh(a,z,T.directiveStart+T.componentOffset,T);if(i[Co]=a[Co]=Z,null!==m)for(const st of m)st(Z,e);return qm(z,T,i),Z}(Xs,He,Ai,ii,pe,[G_]),Jg(qt,pe,null)}finally{Dt()}return new df(this.componentType,Me,Gd(Xe,pe),pe,Xe)}}class df extends kb{constructor(e,t,n,a,m){super(),this.location=n,this._rootLView=a,this._tNode=m,this.instance=t,this.hostView=this.changeDetectorRef=new sx(a),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let a;if(null!==n&&(a=n[e])){const m=this._rootLView;rc(m[on],m,a,e,t),Mp(Vr(this._tNode.index,m))}}get injector(){return new Nc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function G_(){const i=Do();be(gi()[on],i)}function r(i){let e=function rx(i){return Object.getPrototypeOf(i.prototype).constructor}(i.type),t=!0;const n=[i];for(;e;){let a;if(mr(i))a=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Rt(903,!1);a=e.\u0275dir}if(a){if(t){n.push(a);const T=i;T.inputs=l(i.inputs),T.declaredInputs=l(i.declaredInputs),T.outputs=l(i.outputs);const z=a.hostBindings;z&&A(i,z);const j=a.viewQuery,Z=a.contentQueries;if(j&&p(i,j),Z&&v(i,Z),kt(i.inputs,a.inputs),kt(i.declaredInputs,a.declaredInputs),kt(i.outputs,a.outputs),mr(a)&&a.data.animation){const st=i.data;st.animation=(st.animation||[]).concat(a.data.animation)}}const m=a.features;if(m)for(let T=0;T<m.length;T++){const z=m[T];z&&z.ngInherit&&z(i),z===r&&(t=!1)}}e=Object.getPrototypeOf(e)}!function s(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){const a=i[n];a.hostVars=e+=a.hostVars,a.hostAttrs=sn(a.hostAttrs,t=sn(t,a.hostAttrs))}}(n)}function l(i){return i===il?{}:i===_s?[]:i}function p(i,e){const t=i.viewQuery;i.viewQuery=t?(n,a)=>{e(n,a),t(n,a)}:e}function v(i,e){const t=i.contentQueries;i.contentQueries=t?(n,a,m)=>{e(n,a,m),t(n,a,m)}:e}function A(i,e){const t=i.hostBindings;i.hostBindings=t?(n,a)=>{e(n,a),t(n,a)}:e}function Lt(i){return!!Ut(i)&&(Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i)}function Ut(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function de(i,e,t){return i[e]=t}function Ce(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function Ae(i,e,t,n){const a=gi();return Ce(a,sh(),e)&&(ms(),rr(At(),a,i,e,t,n)),Ae}function Ge(i,e,t,n){return Ce(i,sh(),t)?e+Ue(t)+n:es}function Dn(i,e,t,n,a,m,T,z){const j=gi(),Z=ms(),st=i+zs,Mt=Z.firstCreatePass?function eo(i,e,t,n,a,m,T,z,j){const Z=e.consts,st=qd(e,i,4,T||null,fr(Z,z));tx(e,t,st,fr(Z,j)),be(e,st);const Mt=st.tView=qg(2,st,n,a,m,e.directiveRegistry,e.pipeRegistry,null,e.schemas,Z);return null!==e.queries&&(e.queries.template(e,st),Mt.queries=e.queries.embeddedTView(st)),st}(st,Z,j,e,t,n,a,m,T):Z.data[st];Zr(Mt,!1);const Wt=j[qn].createComment("");ip(Z,j,Wt,Mt),No(Wt,j),wp(j,j[st]=ix(Wt,j,Wt,Mt)),Ql(Mt)&&Qg(Z,j,Mt),null!=T&&tf(j,Mt,z)}function Ln(i,e,t){const n=gi();return Ce(n,sh(),e)&&Qr(ms(),At(),n,i,e,n[qn],t,!1),Ln}function Wo(i,e,t,n,a){const T=a?"class":"style";rc(i,t,e.inputs[T],T,n)}function Pn(i,e,t,n){const a=gi(),m=ms(),T=zs+i,z=a[qn],j=m.firstCreatePass?function Fs(i,e,t,n,a,m){const T=e.consts,j=qd(e,i,2,n,fr(T,a));return tx(e,t,j,fr(T,m)),null!==j.attrs&&iu(j,j.attrs,!1),null!==j.mergedAttrs&&iu(j,j.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,j),j}(T,m,a,e,t,n):m.data[T],Z=a[T]=Hh(z,e,function ue(){return Sn.lFrame.currentNamespace}()),st=Ql(j);return Zr(j,!0),El(z,Z,j),32!=(32&j.flags)&&ip(m,a,Z,j),0===function sm(){return Sn.lFrame.elementDepthCount}()&&No(Z,a),function Lc(){Sn.lFrame.elementDepthCount++}(),st&&(Qg(m,a,j),qm(m,j,a)),null!==n&&tf(a,j),Pn}function Nn(){let i=Do();kd()?Ad():(i=i.parent,Zr(i,!1));const e=i;!function Bc(){Sn.lFrame.elementDepthCount--}();const t=ms();return t.firstCreatePass&&(be(t,i),Dh(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function ci(i){return 0!=(8&i.flags)}(e)&&Wo(t,e,gi(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function qi(i){return 0!=(16&i.flags)}(e)&&Wo(t,e,gi(),e.stylesWithoutHost,!1),Nn}function An(i,e,t,n){return Pn(i,e,t,n),Nn(),An}function Xo(){return gi()}function Oo(i){return!!i&&"function"==typeof i.then}function $o(i){return!!i&&"function"==typeof i.subscribe}const br=$o;function gs(i,e,t,n){const a=gi(),m=ms(),T=Do();return su(m,a,a[qn],T,i,e,n),gs}function pl(i,e){const t=Do(),n=gi(),a=ms();return su(a,n,Tp(_(a.data),t,n),t,i,e),pl}function su(i,e,t,n,a,m,T){const z=Ql(n),Z=i.firstCreatePass&&W_(i),st=e[Co],Mt=N_(e);let Wt=!0;if(3&n.type||T){const Me=Ar(n,e),Xe=T?T(Me):Me,He=Mt.length,Ai=T?dn=>T(Po(dn[n.index])):n.index;let ii=null;if(!T&&z&&(ii=function nu(i,e,t,n){const a=i.cleanup;if(null!=a)for(let m=0;m<a.length-1;m+=2){const T=a[m];if(T===t&&a[m+1]===n){const z=e[kh],j=a[m+2];return z.length>j?z[j]:null}"string"==typeof T&&(m+=2)}return null}(i,e,a,n.index)),null!==ii)(ii.__ngLastListenerFn__||ii).__ngNextListenerFn__=m,ii.__ngLastListenerFn__=m,Wt=!1;else{m=ax(n,e,st,m,!1);const dn=t.listen(Xe,a,m);Mt.push(m,dn),Z&&Z.push(a,Ai,He,He+1)}}else m=ax(n,e,st,m,!1);const qt=n.outputs;let pe;if(Wt&&null!==qt&&(pe=qt[a])){const Me=pe.length;if(Me)for(let Xe=0;Xe<Me;Xe+=2){const Xs=e[pe[Xe]][pe[Xe+1]].subscribe(m),oo=Mt.length;Mt.push(m,Xs),Z&&Z.push(a,n.index,oo,-(oo+1))}}}function ou(i,e,t,n){try{return Rr(6,e,t),!1!==t(n)}catch(a){return X_(i,a),!1}finally{Rr(7,e,t)}}function ax(i,e,t,n,a){return function m(T){if(T===Function)return n;Mp(i.componentOffset>-1?Vr(i.index,e):e);let j=ou(e,t,n,T),Z=m.__ngNextListenerFn__;for(;Z;)j=ou(e,t,Z,T)&&j,Z=Z.__ngNextListenerFn__;return a&&!1===j&&(T.preventDefault(),T.returnValue=!1),j}}function Xr(i=1){return function Bt(i){return(Sn.lFrame.contextLView=function Nt(i,e){for(;i>0;)e=e[Kl],i--;return e}(i,Sn.lFrame.contextLView))[Co]}(i)}function Z_(i,e){let t=null;const n=function Rb(i){const e=i.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(i);for(let a=0;a<e.length;a++){const m=e[a];if("*"!==m){if(null===n?xp(i,m,!0):Vb(n,m))return a}else t=a}return t}function Dr(i){const e=gi()[Jo][Ao];if(!e.projection){const n=e.projection=Yu(i?i.length:1,null),a=n.slice();let m=e.child;for(;null!==m;){const T=i?Z_(m,i):0;null!==T&&(a[T]?a[T].projectionNext=m:n[T]=m,a[T]=m),m=m.next}}}function no(i,e=0,t){const n=gi(),a=ms(),m=qd(a,zs+i,16,null,t||null);null===m.projection&&(m.projection=e),Ad(),32!=(32&m.flags)&&function lb(i,e,t){Wy(e[qn],0,e,t,pg(i,t,e),Zh(t.parent||e[Ao],t,e))}(a,n,m)}function Ea(i,e,t){return Sp(i,"",e,"",t),Ea}function Sp(i,e,t,n,a){const m=gi(),T=Ge(m,e,t,n);return T!==es&&Qr(ms(),At(),m,i,T,m[qn],a,!1),Sp}function hc(i,e){return i<<17|e<<2}function Ol(i){return i>>17&32767}function r1(i){return 2|i}function kp(i){return(131068&i)>>2}function a1(i,e){return-131069&i|e<<2}function l1(i){return 1|i}function DC(i,e,t,n,a){const m=i[t+1],T=null===e;let z=n?Ol(m):kp(m),j=!1;for(;0!==z&&(!1===j||T);){const st=i[z+1];SD(i[z],e)&&(j=!0,i[z+1]=n?l1(st):r1(st)),z=n?Ol(st):kp(st)}j&&(i[t+1]=n?r1(m):l1(m))}function SD(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&Dd(i,e)>=0}function lx(i,e,t){return ph(i,e,t,!1),lx}function ar(i,e){return ph(i,e,null,!0),ar}function ph(i,e,t,n){const a=gi(),m=ms(),T=function Va(i){const e=Sn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}(2);m.firstUpdatePass&&function zC(i,e,t,n){const a=i.data;if(null===a[t+1]){const m=a[Ot()],T=function VC(i,e){return e>=i.expandoStartIndex}(i,t);(function jC(i,e){return 0!=(i.flags&(e?8:16))})(m,n)&&null===e&&!T&&(e=!1),e=function BD(i,e,t,n){const a=_(i);let m=n?e.residualClasses:e.residualStyles;if(null===a)0===(n?e.classBindings:e.styleBindings)&&(t=hx(t=h1(null,i,e,t,n),e.attrs,n),m=null);else{const T=e.directiveStylingLast;if(-1===T||i[T]!==a)if(t=h1(a,i,e,t,n),null===m){let j=function OD(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==kp(n))return i[Ol(n)]}(i,e,n);void 0!==j&&Array.isArray(j)&&(j=h1(null,i,e,j[1],n),j=hx(j,e.attrs,n),function RD(i,e,t,n){i[Ol(t?e.classBindings:e.styleBindings)]=n}(i,e,n,j))}else m=function VD(i,e,t){let n;const a=e.directiveEnd;for(let m=1+e.directiveStylingLast;m<a;m++)n=hx(n,i[m].hostAttrs,t);return hx(n,e.attrs,t)}(i,e,n)}return void 0!==m&&(n?e.residualClasses=m:e.residualStyles=m),t}(a,m,e,n),function CD(i,e,t,n,a,m){let T=m?e.classBindings:e.styleBindings,z=Ol(T),j=kp(T);i[n]=t;let st,Z=!1;if(Array.isArray(t)?(st=t[1],(null===st||Dd(t,st)>0)&&(Z=!0)):st=t,a)if(0!==j){const Wt=Ol(i[z+1]);i[n+1]=hc(Wt,z),0!==Wt&&(i[Wt+1]=a1(i[Wt+1],n)),i[z+1]=function td(i,e){return 131071&i|e<<17}(i[z+1],n)}else i[n+1]=hc(z,0),0!==z&&(i[z+1]=a1(i[z+1],n)),z=n;else i[n+1]=hc(j,0),0===z?z=n:i[j+1]=a1(i[j+1],n),j=n;Z&&(i[n+1]=r1(i[n+1])),DC(i,st,n,!0),DC(i,st,n,!1),function TD(i,e,t,n,a){const m=a?i.residualClasses:i.residualStyles;null!=m&&"string"==typeof e&&Dd(m,e)>=0&&(t[n+1]=l1(t[n+1]))}(e,st,i,n,m),T=hc(z,j),m?e.classBindings=T:e.styleBindings=T}(a,m,e,t,T,n)}}(m,i,T,n),e!==es&&Ce(a,T,e)&&function WC(i,e,t,n,a,m,T,z){if(!(3&e.type))return;const j=i.data,Z=j[z+1],st=function MD(i){return 1==(1&i)}(Z)?XC(j,e,t,a,kp(Z),T):void 0;Q_(st)||(Q_(m)||function J_(i){return 2==(2&i)}(Z)&&(m=XC(j,null,t,a,z,T)),function jy(i,e,t,n,a){if(e)a?i.addClass(t,n):i.removeClass(t,n);else{let m=-1===n.indexOf("-")?void 0:_r.DashCase;null==a?i.removeStyle(t,n,m):("string"==typeof a&&a.endsWith("!important")&&(a=a.slice(0,-10),m|=_r.Important),i.setStyle(t,n,a,m))}}(n,T,Dc(Ot(),t),a,m))}(m,m.data[Ot()],a,a[qn],i,a[T+1]=function WD(i,e){return null==i||""===i||("string"==typeof e?i+=e:"object"==typeof i&&(i=mt(Ta(i)))),i}(e,t),n,T)}function h1(i,e,t,n,a){let m=null;const T=t.directiveEnd;let z=t.directiveStylingLast;for(-1===z?z=t.directiveStart:z++;z<T&&(m=e[z],n=hx(n,m.hostAttrs,a),m!==i);)z++;return null!==i&&(t.directiveStylingLast=z),n}function hx(i,e,t){const n=t?1:2;let a=-1;if(null!==e)for(let m=0;m<e.length;m++){const T=e[m];"number"==typeof T?a=T:a===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Fo(i,T,!!t||e[++m]))}return void 0===i?null:i}function XC(i,e,t,n,a,m){const T=null===e;let z;for(;a>0;){const j=i[a],Z=Array.isArray(j),st=Z?j[1]:j,Mt=null===st;let Wt=t[a+1];Wt===es&&(Wt=Mt?_s:void 0);let qt=Mt?qf(Wt,n):st===n?Wt:void 0;if(Z&&!Q_(qt)&&(qt=qf(j,n)),Q_(qt)&&(z=qt,T))return z;const pe=i[a+1];a=T?Ol(pe):kp(pe)}if(null!==e){let j=m?e.residualClasses:e.residualStyles;null!=j&&(z=qf(j,n))}return z}function Q_(i){return void 0!==i}function gf(i,e=""){const t=gi(),n=ms(),a=i+zs,m=n.firstCreatePass?qd(n,a,1,e,null):n.data[a],T=t[a]=function Mm(i,e){return i.createText(e)}(t[qn],e);ip(n,t,T,m),Zr(m,!1)}function q_(i){return c1("",i,""),q_}function c1(i,e,t){const n=gi(),a=Ge(n,i,e,t);return a!==es&&function ul(i,e,t){const n=Dc(e,i);!function sr(i,e,t){i.setValue(e,t)}(i[qn],n,t)}(n,Ot(),a),c1}function d1(i,e,t){const n=gi();if(Ce(n,sh(),e)){const m=ms(),T=At();Qr(m,T,n,i,e,Tp(_(m.data),T,n),t,!0)}return d1}const yf="en-US";let cT=yf;function m1(i,e,t,n,a){if(i=vt(i),Array.isArray(i))for(let m=0;m<i.length;m++)m1(i[m],e,t,n,a);else{const m=ms(),T=gi();let z=hl(i)?i:vt(i.provide),j=Ig(i);const Z=Do(),st=1048575&Z.providerIndexes,Mt=Z.directiveStart,Wt=Z.providerIndexes>>20;if(hl(i)||!i.multi){const qt=new ti(j,a,Ee),pe=g1(z,e,a?st:st+Wt,Mt);-1===pe?(Sl(Os(Z,T),m,z),f1(m,i,e.length),e.push(z),Z.directiveStart++,Z.directiveEnd++,a&&(Z.providerIndexes+=1048576),t.push(qt),T.push(qt)):(t[pe]=qt,T[pe]=qt)}else{const qt=g1(z,e,st+Wt,Mt),pe=g1(z,e,st,st+Wt),Xe=pe>=0&&t[pe];if(a&&!Xe||!a&&!(qt>=0&&t[qt])){Sl(Os(Z,T),m,z);const He=function oF(i,e,t,n,a){const m=new ti(i,t,Ee);return m.multi=[],m.index=e,m.componentProviders=0,BT(m,a,n&&!t),m}(a?sF:nF,t.length,a,n,j);!a&&Xe&&(t[pe].providerFactory=He),f1(m,i,e.length,0),e.push(z),Z.directiveStart++,Z.directiveEnd++,a&&(Z.providerIndexes+=1048576),t.push(He),T.push(He)}else f1(m,i,qt>-1?qt:pe,BT(t[a?pe:qt],j,!a&&n));!a&&n&&Xe&&t[pe].componentProviders++}}}function f1(i,e,t,n){const a=hl(e),m=function l_(i){return!!i.useClass}(e);if(a||m){const j=(m?vt(e.useClass):e).prototype.ngOnDestroy;if(j){const Z=i.destroyHooks||(i.destroyHooks=[]);if(!a&&e.multi){const st=Z.indexOf(t);-1===st?Z.push(t,[n,j]):Z[st+1].push(n,j)}else Z.push(t,j)}}}function BT(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function g1(i,e,t,n){for(let a=t;a<n;a++)if(e[a]===i)return a;return-1}function nF(i,e,t,n){return x1(this.multi,[])}function sF(i,e,t,n){const a=this.multi;let m;if(this.providerFactory){const T=this.providerFactory.componentProviders,z=oh(t,t[on],this.providerFactory.index,n);m=z.slice(0,T),x1(a,m);for(let j=T;j<z.length;j++)m.push(z[j])}else m=[],x1(a,m);return m}function x1(i,e){for(let t=0;t<i.length;t++)e.push((0,i[t])());return e}function mo(i,e=[]){return t=>{t.providersResolver=(n,a)=>function iF(i,e,t){const n=ms();if(n.firstCreatePass){const a=mr(i);m1(t,n.data,n.blueprint,a,!0),m1(e,n.data,n.blueprint,a,!1)}}(n,a?a(i):i,e)}}class _f{}class OT{}class RT extends _f{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ga(this);const n=Ko(e);this._bootstrapComponents=ch(n.bootstrap),this._r3Injector=Ug(e,t,[{provide:_f,useValue:this},{provide:tc,useValue:this.componentFactoryResolver}],mt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class y1 extends OT{constructor(e){super(),this.moduleType=e}create(e){return new RT(this.moduleType,e)}}class aF extends _f{constructor(e,t,n){super(),this.componentFactoryResolver=new Ga(this),this.instance=null;const a=new h_([...e,{provide:_f,useValue:this},{provide:tc,useValue:this.componentFactoryResolver}],t||Wm(),n,new Set(["environment"]));this.injector=a,a.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function o0(i,e,t=null){return new aF(i,e,t).injector}let lF=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const n=Pg(0,t.type),a=n.length>0?o0([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,a)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return i.\u0275prov=Ne({token:i,providedIn:"environment",factory:()=>new i(fi(Dl))}),i})();function VT(i){i.getStandaloneInjector=e=>e.get(lF).getOrCreateStandaloneInjector(i)}function HT(i,e,t,n,a,m){const T=e+t;return Ce(i,T,a)?de(i,T+1,m?n.call(m,a):n(a)):function fx(i,e){const t=i[e];return t===es?void 0:t}(i,T+1)}function gx(i,e){const t=ms();let n;const a=i+zs;t.firstCreatePass?(n=function SF(i,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(i===n.name)return n}}(e,t.pipeRegistry),t.data[a]=n,n.onDestroy&&(t.destroyHooks??(t.destroyHooks=[])).push(a,n.onDestroy)):n=t.data[a];const m=n.factory||(n.factory=Ml(n.type)),T=Or(Ee);try{const z=zr(!1),j=m();return zr(z),function io(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}(t,gi(),a,j),j}finally{Or(T)}}function xx(i,e,t){const n=i+zs,a=gi(),m=Eo(a,n);return function yx(i,e){return i[on].data[e].pure}(a,n)?HT(a,gr(),e,m.transform,t,m):m.transform(t)}function v1(i){return e=>{setTimeout(i,void 0,e)}}const lo=class DF extends oe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let a=e,m=t||(()=>null),T=n;if(e&&"object"==typeof e){const j=e;a=j.next?.bind(j),m=j.error?.bind(j),T=j.complete?.bind(j)}this.__isAsync&&(m=v1(m),a&&(a=v1(a)),T&&(T=v1(T)));const z=super.subscribe({next:a,error:m,complete:T});return e instanceof De&&e.add(z),z}};function IF(){return this._results[Symbol.iterator]()}class vf{get changes(){return this._changes||(this._changes=new lo)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=vf.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=IF)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const a=function nr(i){return i.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function ol(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let a=i[n],m=e[n];if(t&&(a=t(a),m=t(m)),m!==a)return!1}return!0}(n._results,a,t))&&(n._results=a,n.length=a.length,n.last=a[this.length-1],n.first=a[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ed=(()=>{class i{}return i.__NG_ELEMENT_ID__=BF,i})();const FF=ed,LF=class extends FF{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e,t){const n=this._declarationTContainer.tView,a=Qc(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null,t||null);a[Ah]=this._declarationLView[this._declarationTContainer.index];const T=this._declarationLView[Qo];return null!==T&&(a[Qo]=T.createEmbeddedView(n)),Jg(n,a,e),new qc(a)}};function BF(){return r0(Do(),gi())}function r0(i,e){return 4&i.type?new LF(e,i,Gd(i,e)):null}let fh=(()=>{class i{}return i.__NG_ELEMENT_ID__=OF,i})();function OF(){return qT(Do(),gi())}const RF=fh,JT=class extends RF{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Gd(this._hostTNode,this._hostLView)}get injector(){return new Nc(this._hostTNode,this._hostLView)}get parentInjector(){const e=za(this._hostTNode,this._hostLView);if(vs(e)){const t=bo(e,this._hostLView),n=Ds(e);return new Nc(t[on].data[n+8],t)}return new Nc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=QT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-qo}createEmbeddedView(e,t,n){let a,m;"number"==typeof n?a=n:null!=n&&(a=n.index,m=n.injector);const T=e.createEmbeddedView(t||{},m);return this.insert(T,a),T}createComponent(e,t,n,a,m){const T=e&&!function wa(i){return"function"==typeof i}(e);let z;if(T)z=t;else{const Mt=t||{};z=Mt.index,n=Mt.injector,a=Mt.projectableNodes,m=Mt.environmentInjector||Mt.ngModuleRef}const j=T?e:new dh(Ms(e)),Z=n||this.parentInjector;if(!m&&null==j.ngModule){const Wt=(T?Z:this.parentInjector).get(Dl,null);Wt&&(m=Wt)}const st=j.create(Z,a,void 0,m);return this.insert(st.hostView,z),st}insert(e,t){const n=e._lView,a=n[on];if(function nm(i){return oa(i[wo])}(n)){const st=this.indexOf(e);if(-1!==st)this.detach(st);else{const Mt=n[wo],Wt=new JT(Mt,Mt[Ao],Mt[wo]);Wt.detach(Wt.indexOf(e))}}const m=this._adjustIndex(t),T=this._lContainer;!function dg(i,e,t,n){const a=qo+n,m=t.length;n>0&&(t[a-1][Gr]=e),n<m-qo?(e[Gr]=t[a],Wh(t,qo+n,e)):(t.push(e),e[Gr]=null),e[wo]=t;const T=e[Ah];null!==T&&t!==T&&function Fy(i,e){const t=i[Eh];e[Jo]!==e[wo][wo][Jo]&&(i[kc]=!0),null===t?i[Eh]=[e]:t.push(e)}(T,e);const z=e[Qo];null!==z&&z.insertView(i),e[zn]|=64}(a,n,T,m);const z=fg(m,T),j=n[qn],Z=tp(j,T[ts]);return null!==Z&&function Iy(i,e,t,n,a,m){n[ya]=a,n[Ao]=e,Rd(i,n,t,1,a,m)}(a,T[Ao],j,n,Z,z),e.attachToViewContainerRef(),Wh(b1(T),m,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=QT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=ll(this._lContainer,t);n&&(cm(b1(this._lContainer),t),$h(n[on],n))}detach(e){const t=this._adjustIndex(e,-1),n=ll(this._lContainer,t);return n&&null!=cm(b1(this._lContainer),t)?new qc(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function QT(i){return i[Jl]}function b1(i){return i[Jl]||(i[Jl]=[])}function qT(i,e){let t;const n=e[i.index];if(oa(n))t=n;else{let a;if(8&i.type)a=Po(n);else{const m=e[qn];a=m.createComment("");const T=Ar(i,e);Gh(m,tp(m,T),a,function Vy(i,e){return i.nextSibling(e)}(m,T),!1)}e[i.index]=t=ix(n,e,a,i),wp(e,t)}return new JT(t,i,e)}class w1{constructor(e){this.queryList=e,this.matches=null}clone(){return new w1(this.queryList)}setDirty(){this.queryList.setDirty()}}class M1{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,a=[];for(let m=0;m<n;m++){const T=t.getByIndex(m);a.push(this.queries[T.indexInDeclarationView].clone())}return new M1(a)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==sS(e,t).matches&&this.queries[t].setDirty()}}class tS{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class C1{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const a=null!==t?t.length:0,m=this.getByIndex(n).embeddedTView(e,a);m&&(m.indexInDeclarationView=n,null!==t?t.push(m):t=[m])}return null!==t?new C1(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class T1{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new T1(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let a=0;a<n.length;a++){const m=n[a];this.matchTNodeWithReadOption(e,t,VF(t,m)),this.matchTNodeWithReadOption(e,t,Wu(t,e,m,!1,!1))}else n===ed?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Wu(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const a=this.metadata.read;if(null!==a)if(a===to||a===fh||a===ed&&4&t.type)this.addMatch(t.index,-2);else{const m=Wu(t,e,a,!1,!1);null!==m&&this.addMatch(t.index,m)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function VF(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function NF(i,e,t,n){return-1===t?function zF(i,e){return 11&i.type?Gd(i,e):4&i.type?r0(i,e):null}(e,i):-2===t?function WF(i,e,t){return t===to?Gd(e,i):t===ed?r0(e,i):t===fh?qT(e,i):void 0}(i,e,n):oh(i,i[on],t,e)}function eS(i,e,t,n){const a=e[Qo].queries[n];if(null===a.matches){const m=i.data,T=t.matches,z=[];for(let j=0;j<T.length;j+=2){const Z=T[j];z.push(Z<0?null:NF(e,m[Z],T[j+1],t.metadata.read))}a.matches=z}return a.matches}function S1(i,e,t,n){const a=i.queries.getByIndex(t),m=a.matches;if(null!==m){const T=eS(i,e,a,t);for(let z=0;z<m.length;z+=2){const j=m[z];if(j>0)n.push(T[z/2]);else{const Z=m[z+1],st=e[-j];for(let Mt=qo;Mt<st.length;Mt++){const Wt=st[Mt];Wt[Ah]===Wt[wo]&&S1(Wt[on],Wt,Z,n)}if(null!==st[Eh]){const Mt=st[Eh];for(let Wt=0;Wt<Mt.length;Wt++){const qt=Mt[Wt];S1(qt[on],qt,Z,n)}}}}}return n}function jr(i){const e=gi(),t=ms(),n=P();V(n+1);const a=sS(t,n);if(i.dirty&&function im(i){return 4==(4&i[zn])}(e)===(2==(2&a.metadata.flags))){if(null===a.matches)i.reset([]);else{const m=a.crossesNgTemplate?S1(t,e,n,[]):eS(t,e,a,n);i.reset(m,dp),i.notifyOnChanges()}return!0}return!1}function Pp(i,e,t){const n=ms();n.firstCreatePass&&(nS(n,new tS(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),iS(n,gi(),e)}function Rl(i,e,t,n){const a=ms();if(a.firstCreatePass){const m=Do();nS(a,new tS(e,t,n),m.index),function jF(i,e){const t=i.contentQueries||(i.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(i.queries.length-1,e)}(a,i),2==(2&t)&&(a.staticContentQueries=!0)}iS(a,gi(),t)}function Ur(){return function XF(i,e){return i[Qo].queries[e].queryList}(gi(),P())}function iS(i,e,t){const n=new vf(4==(4&t));bp(i,e,n,n.destroy),null===e[Qo]&&(e[Qo]=new M1),e[Qo].queries.push(new w1(n))}function nS(i,e,t){null===i.queries&&(i.queries=new C1),i.queries.track(new T1(e,t))}function sS(i,e){return i.queries.getByIndex(e)}function h0(...i){}const c0=new Bi("Application Initializer");let d0=(()=>{class i{constructor(t){this.appInits=t,this.resolve=h0,this.reject=h0,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,a)=>{this.resolve=n,this.reject=a})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let a=0;a<this.appInits.length;a++){const m=this.appInits[a]();if(Oo(m))t.push(m);else if(br(m)){const T=new Promise((z,j)=>{m.subscribe({complete:z,error:j})});t.push(T)}}Promise.all(t).then(()=>{n()}).catch(a=>{this.reject(a)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(fi(c0,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const vx=new Bi("AppId",{providedIn:"root",factory:function wS(){return`${I1()}${I1()}${I1()}`}});function I1(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const MS=new Bi("Platform Initializer"),u0=new Bi("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Ep=new Bi("AnimationModuleType");let hL=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const uc=new Bi("LocaleId",{providedIn:"root",factory:()=>Fn(uc,vi.Optional|vi.SkipSelf)||function cL(){return typeof $localize<"u"&&$localize.locale||yf}()});class uL{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let CS=(()=>{class i{compileModuleSync(t){return new y1(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),m=ch(Ko(t).declarations).reduce((T,z)=>{const j=Ms(z);return j&&T.push(new dh(j)),T},[]);return new uL(n,m)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const fL=(()=>Promise.resolve(0))();function F1(i){typeof Zone>"u"?fL.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class us{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new lo(!1),this.onMicrotaskEmpty=new lo(!1),this.onStable=new lo(!1),this.onError=new lo(!1),typeof Zone>"u")throw new Rt(908,!1);Zone.assertZonePatched();const a=this;a._nesting=0,a._outer=a._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!n&&t,a.shouldCoalesceRunChangeDetection=n,a.lastRequestAnimationFrameId=-1,a.nativeRequestAnimationFrame=function gL(){let i=Qs.requestAnimationFrame,e=Qs.cancelAnimationFrame;if(typeof Zone<"u"&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function _L(i){const e=()=>{!function yL(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Qs,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,B1(i),i.isCheckStableRunning=!0,L1(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),B1(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,a,m,T,z)=>{try{return kS(i),t.invokeTask(a,m,T,z)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===m.type||i.shouldCoalesceRunChangeDetection)&&e(),AS(i)}},onInvoke:(t,n,a,m,T,z,j)=>{try{return kS(i),t.invoke(a,m,T,z,j)}finally{i.shouldCoalesceRunChangeDetection&&e(),AS(i)}},onHasTask:(t,n,a,m)=>{t.hasTask(a,m),n===a&&("microTask"==m.change?(i._hasPendingMicrotasks=m.microTask,B1(i),L1(i)):"macroTask"==m.change&&(i.hasPendingMacrotasks=m.macroTask))},onHandleError:(t,n,a,m)=>(t.handleError(a,m),i.runOutsideAngular(()=>i.onError.emit(m)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!us.isInAngularZone())throw new Rt(909,!1)}static assertNotInAngularZone(){if(us.isInAngularZone())throw new Rt(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,a){const m=this._inner,T=m.scheduleEventTask("NgZoneEvent: "+a,e,xL,h0,h0);try{return m.runTask(T,t,n)}finally{m.cancelTask(T)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const xL={};function L1(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function B1(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function kS(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function AS(i){i._nesting--,L1(i)}class vL{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new lo,this.onMicrotaskEmpty=new lo,this.onStable=new lo,this.onError=new lo}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,a){return e.apply(t,n)}}const PS=new Bi(""),p0=new Bi("");let V1,O1=(()=>{class i{constructor(t,n,a){this._ngZone=t,this.registry=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,V1||(function bL(i){V1=i}(a),a.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{us.assertNotInAngularZone(),F1(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())F1(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,a){let m=-1;n&&n>0&&(m=setTimeout(()=>{this._callbacks=this._callbacks.filter(T=>T.timeoutId!==m),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:m,updateCb:a})}whenStable(t,n,a){if(a&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,a),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,a){return[]}}return i.\u0275fac=function(t){return new(t||i)(fi(us),fi(R1),fi(p0))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),R1=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return V1?.findTestabilityInTree(this,t,n)??null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();const id=!1;let ru=null;const ES=new Bi("AllowMultipleToken"),z1=new Bi("PlatformDestroyListeners"),DS=new Bi("appBootstrapListener");class IS{constructor(e,t){this.name=e,this.token=t}}function LS(i,e,t=[]){const n=`Platform: ${e}`,a=new Bi(n);return(m=[])=>{let T=N1();if(!T||T.injector.get(ES,!1)){const z=[...t,...m,{provide:a,useValue:!0}];i?i(z):function CL(i){if(ru&&!ru.get(ES,!1))throw new Rt(400,!1);ru=i;const e=i.get(OS);(function FS(i){const e=i.get(MS,null);e&&e.forEach(t=>t())})(i)}(function BS(i=[],e){return Aa.create({name:e,providers:[{provide:zm,useValue:"platform"},{provide:z1,useValue:new Set([()=>ru=null])},...i]})}(z,n))}return function SL(i){const e=N1();if(!e)throw new Rt(401,!1);return e}()}}function N1(){return ru?.get(OS)??null}let OS=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const a=function VS(i,e){let t;return t="noop"===i?new vL:("zone.js"===i?void 0:i)||new us(e),t}(n?.ngZone,function RS(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!i||!i.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!i||!i.ngZoneRunCoalescing)||!1}}(n)),m=[{provide:us,useValue:a}];return a.run(()=>{const T=Aa.create({providers:m,parent:this.injector,name:t.moduleType.name}),z=t.create(T),j=z.injector.get(ua,null);if(!j)throw new Rt(402,!1);return a.runOutsideAngular(()=>{const Z=a.onError.subscribe({next:st=>{j.handleError(st)}});z.onDestroy(()=>{m0(this._modules,z),Z.unsubscribe()})}),function zS(i,e,t){try{const n=t();return Oo(n)?n.catch(a=>{throw e.runOutsideAngular(()=>i.handleError(a)),a}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(j,a,()=>{const Z=z.injector.get(d0);return Z.runInitializers(),Z.donePromise.then(()=>(function dT(i){Re(i,"Expected localeId to be defined"),"string"==typeof i&&(cT=i.toLowerCase().replace(/_/g,"-"))}(z.injector.get(uc,yf)||yf),this._moduleDoBootstrap(z),z))})})}bootstrapModule(t,n=[]){const a=NS({},n);return function wL(i,e,t){const n=new y1(t);return Promise.resolve(n)}(0,0,t).then(m=>this.bootstrapModuleFactory(m,a))}_moduleDoBootstrap(t){const n=t.injector.get(bx);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(a=>n.bootstrap(a));else{if(!t.instance.ngDoBootstrap)throw new Rt(-403,!1);t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Rt(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());const t=this._injector.get(z1,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(fi(Aa))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"platform"}),i})();function NS(i,e){return Array.isArray(e)?e.reduce(NS,i):{...i,...e}}let bx=(()=>{class i{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,n,a){this._zone=t,this._injector=n,this._exceptionHandler=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const m=new ln(z=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{z.next(this._stable),z.complete()})}),T=new ln(z=>{let j;this._zone.runOutsideAngular(()=>{j=this._zone.onStable.subscribe(()=>{us.assertNotInAngularZone(),F1(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,z.next(!0))})})});const Z=this._zone.onUnstable.subscribe(()=>{us.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{z.next(!1)}))});return()=>{j.unsubscribe(),Z.unsubscribe()}});this.isStable=q(m,T.pipe(nt()))}bootstrap(t,n){const a=t instanceof Lg;if(!this._injector.get(d0).done){!a&&function Gl(i){const e=Ms(i)||ur(i)||pr(i);return null!==e&&e.standalone}(t);throw new Rt(405,id)}let T;T=a?t:this._injector.get(tc).resolveComponentFactory(t),this.componentTypes.push(T.componentType);const z=function ML(i){return i.isBoundToModule}(T)?void 0:this._injector.get(_f),Z=T.create(Aa.NULL,[],n||T.selector,z),st=Z.location.nativeElement,Mt=Z.injector.get(PS,null);return Mt?.registerApplication(st),Z.onDestroy(()=>{this.detachView(Z.hostView),m0(this.components,Z),Mt?.unregisterApplication(st)}),this._loadComponent(Z),Z}tick(){if(this._runningTick)throw new Rt(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;m0(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const n=this._injector.get(DS,[]);n.push(...this._bootstrapListeners),n.forEach(a=>a(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>m0(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Rt(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return i.\u0275fac=function(t){return new(t||i)(fi(us),fi(Dl),fi(ua))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function m0(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let au=(()=>{class i{}return i.__NG_ELEMENT_ID__=AL,i})();function AL(i){return function PL(i,e,t){if(Ih(i)&&!t){const n=Vr(i.index,e);return new qc(n,n)}return 47&i.type?new qc(e[Jo],e):null}(Do(),gi(),16==(16&i))}class YS{constructor(){}supports(e){return Lt(e)}create(e){return new BL(e)}}const LL=(i,e)=>e;class BL{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||LL}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,a=0,m=null;for(;t||n;){const T=!n||t&&t.currentIndex<$S(n,a,m)?t:n,z=$S(T,a,m),j=T.currentIndex;if(T===n)a--,n=n._nextRemoved;else if(t=t._next,null==T.previousIndex)a++;else{m||(m=[]);const Z=z-a,st=j-a;if(Z!=st){for(let Wt=0;Wt<Z;Wt++){const qt=Wt<m.length?m[Wt]:m[Wt]=0,pe=qt+Wt;st<=pe&&pe<Z&&(m[Wt]=qt+1)}m[T.previousIndex]=st-Z}}z!==j&&e(T,z,j)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Lt(e))throw new Rt(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let a,m,T,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let z=0;z<this.length;z++)m=e[z],T=this._trackByFn(z,m),null!==t&&Object.is(t.trackById,T)?(n&&(t=this._verifyReinsertion(t,m,T,z)),Object.is(t.item,m)||this._addIdentityChange(t,m)):(t=this._mismatch(t,m,T,z),n=!0),t=t._next}else a=0,function he(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,z=>{T=this._trackByFn(a,z),null!==t&&Object.is(t.trackById,T)?(n&&(t=this._verifyReinsertion(t,z,T,a)),Object.is(t.item,z)||this._addIdentityChange(t,z)):(t=this._mismatch(t,z,T,a),n=!0),t=t._next,a++}),this.length=a;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,a){let m;return null===e?m=this._itTail:(m=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,m,a)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,a))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,m,a)):e=this._addAfter(new OL(t,n),m,a),e}_verifyReinsertion(e,t,n,a){let m=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==m?e=this._reinsertAfter(m,e._prev,a):e.currentIndex!=a&&(e.currentIndex=a,this._addToMoves(e,a)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const a=e._prevRemoved,m=e._nextRemoved;return null===a?this._removalsHead=m:a._nextRemoved=m,null===m?this._removalsTail=a:m._prevRemoved=a,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const a=null===t?this._itHead:t._next;return e._next=a,e._prev=t,null===a?this._itTail=e:a._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new HS),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new HS),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class OL{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class RL{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class HS{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new RL,this.map.set(t,n)),n.add(e)}get(e,t){const a=this.map.get(e);return a?a.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $S(i,e,t){const n=i.previousIndex;if(null===n)return n;let a=0;return t&&n<t.length&&(a=t[n]),n+e+a}class GS{constructor(){}supports(e){return e instanceof Map||Ut(e)}create(){return new VL}}class VL{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Ut(e)))throw new Rt(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,a)=>{if(t&&t.key===a)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const m=this._getOrCreateRecordForKey(a,n);t=this._insertBeforeOrAppend(t,m)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const a=this._records.get(e);this._maybeAddToChanges(a,t);const m=a._prev,T=a._next;return m&&(m._next=T),T&&(T._prev=m),a._next=null,a._prev=null,a}const n=new zL(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class zL{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ZS(){return new x0([new YS])}let x0=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const a=n.factories.slice();t=t.concat(a)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||ZS()),deps:[[i,new rh,new la]]}}find(t){const n=this.factories.find(a=>a.supports(t));if(null!=n)return n;throw new Rt(901,!1)}}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:ZS}),i})();function KS(){return new wx([new GS])}let wx=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(n){const a=n.factories.slice();t=t.concat(a)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||KS()),deps:[[i,new rh,new la]]}}find(t){const n=this.factories.find(a=>a.supports(t));if(n)return n;throw new Rt(901,!1)}}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:KS}),i})();const XL=LS(null,"core",[]);let jL=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(fi(bx))},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({}),i})();function Mf(i){return"boolean"==typeof i?i:null!=i&&"false"!==i}let Y1=null;function nd(){return Y1}class HL{}const so=new Bi("DocumentToken");let H1=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return function $L(){return fi(JS)}()},providedIn:"platform"}),i})();const GL=new Bi("Location Initialized");let JS=(()=>{class i extends H1{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return nd().getBaseHref(this._doc)}onPopState(t){const n=nd().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=nd().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,a){QS()?this._history.pushState(t,n,a):this._location.hash=a}replaceState(t,n,a){QS()?this._history.replaceState(t,n,a):this._location.hash=a}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:function(){return function ZL(){return new JS(fi(so))}()},providedIn:"platform"}),i})();function QS(){return!!window.history.pushState}function $1(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function qS(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function sd(i){return i&&"?"!==i[0]?"?"+i:i}let Ip=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Fn(ek)},providedIn:"root"}),i})();const tk=new Bi("appBaseHref");let ek=(()=>{class i extends Ip{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??Fn(so).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return $1(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+sd(this._platformLocation.search),a=this._platformLocation.hash;return a&&t?`${n}${a}`:n}pushState(t,n,a,m){const T=this.prepareExternalUrl(a+sd(m));this._platformLocation.pushState(t,n,T)}replaceState(t,n,a,m){const T=this.prepareExternalUrl(a+sd(m));this._platformLocation.replaceState(t,n,T)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(fi(H1),fi(tk,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),KL=(()=>{class i extends Ip{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=$1(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,a,m){let T=this.prepareExternalUrl(a+sd(m));0==T.length&&(T=this._platformLocation.pathname),this._platformLocation.pushState(t,n,T)}replaceState(t,n,a,m){let T=this.prepareExternalUrl(a+sd(m));0==T.length&&(T=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,T)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return i.\u0275fac=function(t){return new(t||i)(fi(H1),fi(tk,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),G1=(()=>{class i{constructor(t){this._subject=new lo,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const n=this._locationStrategy.getBaseHref();this._basePath=function qL(i){if(new RegExp("^(https?:)?//").test(i)){const[,t]=i.split(/\/\/[^\/]+/);return t}return i}(qS(ik(n))),this._locationStrategy.onPopState(a=>{this._subject.emit({url:this.path(!0),pop:!0,state:a.state,type:a.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+sd(n))}normalize(t){return i.stripTrailingSlash(function QL(i,e){if(!i||!e.startsWith(i))return e;const t=e.substring(i.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,ik(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",a=null){this._locationStrategy.pushState(a,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+sd(n)),a)}replaceState(t,n="",a=null){this._locationStrategy.replaceState(a,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+sd(n)),a)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)})),()=>{const n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(a=>a(t,n))}subscribe(t,n,a){return this._subject.subscribe({next:t,error:n,complete:a})}}return i.normalizeQueryParams=sd,i.joinWithSlash=$1,i.stripTrailingSlash=qS,i.\u0275fac=function(t){return new(t||i)(fi(Ip))},i.\u0275prov=Ne({token:i,factory:function(){return function JL(){return new G1(fi(Ip))}()},providedIn:"root"}),i})();function ik(i){return i.replace(/\/index.html$/,"")}function dk(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[a,m]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(a.trim()===e)return decodeURIComponent(m)}return null}class VB{constructor(e,t,n,a){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=a}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let fk=(()=>{class i{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,n,a){this._viewContainer=t,this._template=n,this._differs=a,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((a,m,T)=>{if(null==a.previousIndex)n.createEmbeddedView(this._template,new VB(a.item,this._ngForOf,-1,-1),null===T?void 0:T);else if(null==T)n.remove(null===m?void 0:m);else if(null!==m){const z=n.get(m);n.move(z,T),gk(z,a)}});for(let a=0,m=n.length;a<m;a++){const z=n.get(a).context;z.index=a,z.count=m,z.ngForOf=this._ngForOf}t.forEachIdentityChange(a=>{gk(n.get(a.currentIndex),a)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(Ee(fh),Ee(ed),Ee(x0))},i.\u0275dir=Ji({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),i})();function gk(i,e){i.context.$implicit=e.item}let Tx=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new NB,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){xk("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){xk("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(Ee(fh),Ee(ed))},i.\u0275dir=Ji({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),i})();class NB{constructor(){this.$implicit=null,this.ngIf=null}}function xk(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${mt(e)}'.`)}let aw=(()=>{class i{constructor(t,n,a){this._ngEl=t,this._differs=n,this._renderer=a,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){const[a,m]=t.split("."),T=-1===a.indexOf("-")?void 0:_r.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,a,m?`${n}${m}`:n,T):this._renderer.removeStyle(this._ngEl.nativeElement,a,T)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(wx),Ee(hh))},i.\u0275dir=Ji({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),i})();class UB{createSubscription(e,t){return e.subscribe({next:t,error:n=>{throw n}})}dispose(e){e.unsubscribe()}}class YB{createSubscription(e,t){return e.then(t,n=>{throw n})}dispose(e){}}const HB=new YB,$B=new UB;let vk=(()=>{class i{constructor(t){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n))}_selectStrategy(t){if(Oo(t))return HB;if($o(t))return $B;throw function yh(i,e){return new Rt(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this._ref.markForCheck())}}return i.\u0275fac=function(t){return new(t||i)(Ee(au,16))},i.\u0275pipe=dr({name:"async",type:i,pure:!1,standalone:!0}),i})(),k0=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({}),i})();const wk="browser";let fO=(()=>{class i{}return i.\u0275prov=Ne({token:i,providedIn:"root",factory:()=>new gO(fi(so),window)}),i})();class gO{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function xO(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let a=n.currentNode;for(;a;){const m=a.shadowRoot;if(m){const T=m.getElementById(e)||m.querySelector(`[name="${e}"]`);if(T)return T}a=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,a=t.top+this.window.pageYOffset,m=this.offset();this.window.scrollTo(n-m[0],a-m[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Mk(this.window.history)||Mk(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Mk(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Ck{}class UO extends HL{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class uw extends UO{static makeCurrent(){!function YL(i){Y1||(Y1=i)}(new uw)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function YO(){return kx=kx||document.querySelector("base"),kx?kx.getAttribute("href"):null}();return null==t?null:function HO(i){E0=E0||document.createElement("a"),E0.setAttribute("href",i);const e=E0.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){kx=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return dk(document.cookie,e)}}let E0,kx=null;const Pk=new Bi("TRANSITION_ID"),GO=[{provide:c0,useFactory:function $O(i,e,t){return()=>{t.get(d0).donePromise.then(()=>{const n=nd(),a=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let m=0;m<a.length;m++)n.remove(a[m])})}},deps:[Pk,so,Aa],multi:!0}];let KO=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const D0=new Bi("EventManagerPlugins");let I0=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(a=>{a.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,a){return this._findPluginFor(n).addEventListener(t,n,a)}addGlobalEventListener(t,n,a){return this._findPluginFor(n).addGlobalEventListener(t,n,a)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const a=this._plugins;for(let m=0;m<a.length;m++){const T=a[m];if(T.supports(t))return this._eventNameToPlugin.set(t,T),T}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(fi(D0),fi(us))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class Ek{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const a=nd().getGlobalEventTarget(this._doc,e);if(!a)throw new Error(`Unsupported event target ${a} for event ${t}`);return this.addEventListener(a,t,n)}}let Dk=(()=>{class i{constructor(){this.usageCount=new Map}addStyles(t){for(const n of t)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(t){for(const n of t)0===this.changeUsageCount(n,-1)&&this.onStyleRemoved(n)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,n){const a=this.usageCount;let m=a.get(t)??0;return m+=n,m>0?a.set(t,m):a.delete(t),m}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),Ax=(()=>{class i extends Dk{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){const n=this.styleRef;n.get(t)?.forEach(m=>m.remove()),n.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,n){const a=this.doc.createElement("style");a.textContent=n,t.appendChild(a);const m=this.styleRef.get(n);m?m.push(a):this.styleRef.set(n,[a])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const pw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},mw=/%COMP%/g,Lk=new Bi("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function Bk(i,e){return e.flat(100).map(t=>t.replace(mw,i))}function Ok(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let F0=(()=>{class i{constructor(t,n,a,m){this.eventManager=t,this.sharedStylesHost=n,this.appId=a,this.removeStylesOnCompDestory=m,this.rendererByCompId=new Map,this.defaultRenderer=new fw(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;const a=this.getOrCreateRenderer(t,n);return a instanceof zk?a.applyToHost(t):a instanceof gw&&a.applyStyles(),a}getOrCreateRenderer(t,n){const a=this.rendererByCompId;let m=a.get(n.id);if(!m){const T=this.eventManager,z=this.sharedStylesHost,j=this.removeStylesOnCompDestory;switch(n.encapsulation){case sa.Emulated:m=new zk(T,z,n,this.appId,j);break;case sa.ShadowDom:return new nR(T,z,t,n);default:m=new gw(T,z,n,j)}m.onDestroy=()=>a.delete(n.id),a.set(n.id,m)}return m}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(fi(I0),fi(Ax),fi(vx),fi(Lk))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class fw{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(pw[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Vk(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(Vk(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,a){if(a){t=a+":"+t;const m=pw[a];m?e.setAttributeNS(m,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const a=pw[n];a?e.removeAttributeNS(a,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,a){a&(_r.DashCase|_r.Important)?e.style.setProperty(t,n,a&_r.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&_r.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ok(n)):this.eventManager.addEventListener(e,t,Ok(n))}}function Vk(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class nR extends fw{constructor(e,t,n,a){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const m=Bk(a.id,a.styles);for(const T of m){const z=document.createElement("style");z.textContent=T,this.shadowRoot.appendChild(z)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class gw extends fw{constructor(e,t,n,a,m=n.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=a,this.rendererUsageCount=0,this.styles=Bk(m,n.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class zk extends gw{constructor(e,t,n,a,m){const T=a+"-"+n.id;super(e,t,n,m,T),this.contentAttr=function tR(i){return"_ngcontent-%COMP%".replace(mw,i)}(T),this.hostAttr=function eR(i){return"_nghost-%COMP%".replace(mw,i)}(T)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let sR=(()=>{class i extends Ek{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,a){return t.addEventListener(n,a,!1),()=>this.removeEventListener(t,n,a)}removeEventListener(t,n,a){return t.removeEventListener(n,a)}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const Nk=["alt","control","meta","shift"],oR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},rR={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let aR=(()=>{class i extends Ek{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,a){const m=i.parseEventName(n),T=i.eventCallback(m.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>nd().onAndCancel(t,m.domEventName,T))}static parseEventName(t){const n=t.toLowerCase().split("."),a=n.shift();if(0===n.length||"keydown"!==a&&"keyup"!==a)return null;const m=i._normalizeKey(n.pop());let T="",z=n.indexOf("code");if(z>-1&&(n.splice(z,1),T="code."),Nk.forEach(Z=>{const st=n.indexOf(Z);st>-1&&(n.splice(st,1),T+=Z+".")}),T+=m,0!=n.length||0===m.length)return null;const j={};return j.domEventName=a,j.fullKey=T,j}static matchEventFullKeyCode(t,n){let a=oR[t.key]||t.key,m="";return n.indexOf("code.")>-1&&(a=t.code,m="code."),!(null==a||!a)&&(a=a.toLowerCase()," "===a?a="space":"."===a&&(a="dot"),Nk.forEach(T=>{T!==a&&(0,rR[T])(t)&&(m+=T+".")}),m+=a,m===n)}static eventCallback(t,n,a){return m=>{i.matchEventFullKeyCode(m,t)&&a.runGuarded(()=>n(m))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const dR=LS(XL,"browser",[{provide:u0,useValue:wk},{provide:MS,useValue:function lR(){uw.makeCurrent()},multi:!0},{provide:so,useFactory:function cR(){return function Yy(i){zd=i}(document),document},deps:[]}]),jk=new Bi(""),Uk=[{provide:p0,useClass:class ZO{addToWindow(e){Qs.getAngularTestability=(n,a=!0)=>{const m=e.findTestabilityInTree(n,a);if(null==m)throw new Error("Could not find testability for element.");return m},Qs.getAllAngularTestabilities=()=>e.getAllTestabilities(),Qs.getAllAngularRootElements=()=>e.getAllRootElements(),Qs.frameworkStabilizers||(Qs.frameworkStabilizers=[]),Qs.frameworkStabilizers.push(n=>{const a=Qs.getAllAngularTestabilities();let m=a.length,T=!1;const z=function(j){T=T||j,m--,0==m&&n(T)};a.forEach(function(j){j.whenStable(z)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?nd().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:PS,useClass:O1,deps:[us,R1,p0]},{provide:O1,useClass:O1,deps:[us,R1,p0]}],Yk=[{provide:zm,useValue:"root"},{provide:ua,useFactory:function hR(){return new ua},deps:[]},{provide:D0,useClass:sR,multi:!0,deps:[so,us,u0]},{provide:D0,useClass:aR,multi:!0,deps:[so]},{provide:F0,useClass:F0,deps:[I0,Ax,vx,Lk]},{provide:up,useExisting:F0},{provide:Dk,useExisting:Ax},{provide:Ax,useClass:Ax,deps:[so]},{provide:I0,useClass:I0,deps:[D0,us]},{provide:Ck,useClass:KO,deps:[]},[]];let Hk=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:vx,useValue:t.appId},{provide:Pk,useExisting:vx},GO]}}}return i.\u0275fac=function(t){return new(t||i)(fi(jk,12))},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({providers:[...Yk,...Uk],imports:[k0,jL]}),i})(),$k=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new t:function pR(){return new $k(fi(so))}(),n},providedIn:"root"}),i})();typeof window<"u"&&window;let _w=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new(t||i):fi(Kk),n},providedIn:"root"}),i})(),Kk=(()=>{class i extends _w{constructor(t){super(),this._doc=t}sanitize(t,n){if(null==n)return null;switch(t){case Gs.NONE:return n;case Gs.HTML:return Ws(n,"HTML")?Ta(n):i_(this._doc,String(n)).toString();case Gs.STYLE:return Ws(n,"Style")?Ta(n):n;case Gs.SCRIPT:if(Ws(n,"Script"))return Ta(n);throw new Error("unsafe value used in a script context");case Gs.URL:return Ws(n,"URL")?Ta(n):rp(String(n));case Gs.RESOURCE_URL:if(Ws(n,"ResourceURL"))return Ta(n);throw new Error(`unsafe value used in a resource URL context (see ${ye})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${ye})`)}}bypassSecurityTrustHtml(t){return function Zy(i){return new db(i)}(t)}bypassSecurityTrustStyle(t){return function Pm(i){return new ub(i)}(t)}bypassSecurityTrustScript(t){return function Em(i){return new _g(i)}(t)}bypassSecurityTrustUrl(t){return function sp(i){return new pb(i)}(t)}bypassSecurityTrustResourceUrl(t){return function Ky(i){return new Nd(i)}(t)}}return i.\u0275fac=function(t){return new(t||i)(fi(so))},i.\u0275prov=Ne({token:i,factory:function(t){let n=null;return n=t?new t:function yR(i){return new Kk(i.get(so))}(fi(Aa)),n},providedIn:"root"}),i})();function Cn(...i){return J(i,M(i))}class Nl extends oe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const L0=On(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:_R}=Array,{getPrototypeOf:vR,prototype:bR,keys:wR}=Object;function Jk(i){if(1===i.length){const e=i[0];if(_R(e))return{args:e,keys:null};if(function MR(i){return i&&"object"==typeof i&&vR(i)===bR}(e)){const t=wR(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:CR}=Array;function vw(i){return Kt(e=>function TR(i,e){return CR(e)?i(...e):i(e)}(i,e))}function Qk(i,e){return i.reduce((t,n,a)=>(t[n]=e[a],t),{})}function bw(...i){const e=M(i),t=d(i),{args:n,keys:a}=Jk(i);if(0===n.length)return J([],e);const m=new ln(function SR(i,e,t=Ri){return n=>{qk(e,()=>{const{length:a}=i,m=new Array(a);let T=a,z=a;for(let j=0;j<a;j++)qk(e,()=>{const Z=J(i[j],e);let st=!1;Z.subscribe(rt(n,Mt=>{m[j]=Mt,st||(st=!0,z--),z||n.next(t(m.slice()))},()=>{--T||n.complete()}))},n)},n)}}(n,e,a?T=>Qk(a,T):Ri));return t?m.pipe(vw(t)):m}function qk(i,e,t){i?I(t,i,e):e()}function B0(...i){return function kR(){return w(1)}()(J(i,M(i)))}function t2(i){return new ln(e=>{pt(i()).subscribe(e)})}function Cf(i,e){const t=ss(i)?i:()=>i,n=a=>a.error(t());return new ln(e?a=>e.schedule(n,0,a):n)}function ww(){return at((i,e)=>{let t=null;i._refCount++;const n=rt(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const a=i._connection,m=t;t=null,a&&(!m||a===m)&&a.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class e2 extends ln{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ze(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new De;const t=this.getSubject();e.add(this.source.subscribe(rt(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=De.EMPTY)}return e}refCount(){return ww()(this)}}function pc(i,e){return at((t,n)=>{let a=null,m=0,T=!1;const z=()=>T&&!a&&n.complete();t.subscribe(rt(n,j=>{a?.unsubscribe();let Z=0;const st=m++;pt(i(j,st)).subscribe(a=rt(n,Mt=>n.next(e?e(j,Mt,st,Z++):Mt),()=>{a=null,z()}))},()=>{T=!0,z()}))})}function _h(i){return i<=0?()=>D:at((e,t)=>{let n=0;e.subscribe(rt(t,a=>{++n<=i&&(t.next(a),i<=n&&t.complete())}))})}function O0(...i){const e=M(i);return at((t,n)=>{(e?B0(i,t,e):B0(i,t)).subscribe(n)})}function Yr(i,e){return at((t,n)=>{let a=0;t.subscribe(rt(n,m=>i.call(e,m,a++)&&n.next(m)))})}function R0(i){return at((e,t)=>{let n=!1;e.subscribe(rt(t,a=>{n=!0,t.next(a)},()=>{n||t.next(i),t.complete()}))})}function n2(i=AR){return at((e,t)=>{let n=!1;e.subscribe(rt(t,a=>{n=!0,t.next(a)},()=>n?t.complete():t.error(i())))})}function AR(){return new L0}function hu(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Yr((a,m)=>i(a,m,n)):Ri,_h(1),t?R0(e):n2(()=>new L0))}function cu(i,e){return ss(e)?x(i,e,1):x(i,1)}function Cr(i,e,t){const n=ss(i)||e||t?{next:i,error:e,complete:t}:i;return n?at((a,m)=>{var T;null===(T=n.subscribe)||void 0===T||T.call(n);let z=!0;a.subscribe(rt(m,j=>{var Z;null===(Z=n.next)||void 0===Z||Z.call(n,j),m.next(j)},()=>{var j;z=!1,null===(j=n.complete)||void 0===j||j.call(n),m.complete()},j=>{var Z;z=!1,null===(Z=n.error)||void 0===Z||Z.call(n,j),m.error(j)},()=>{var j,Z;z&&(null===(j=n.unsubscribe)||void 0===j||j.call(n)),null===(Z=n.finalize)||void 0===Z||Z.call(n)}))}):Ri}function rd(i){return at((e,t)=>{let m,n=null,a=!1;n=e.subscribe(rt(t,void 0,void 0,T=>{m=pt(i(T,rd(i)(e))),n?(n.unsubscribe(),n=null,m.subscribe(t)):a=!0})),a&&(n.unsubscribe(),n=null,m.subscribe(t))})}function s2(i,e){return at(function PR(i,e,t,n,a){return(m,T)=>{let z=t,j=e,Z=0;m.subscribe(rt(T,st=>{const Mt=Z++;j=z?i(j,st,Mt):(z=!0,st),n&&T.next(j)},a&&(()=>{z&&T.next(j),T.complete()})))}}(i,e,arguments.length>=2,!0))}function Mw(i){return i<=0?()=>D:at((e,t)=>{let n=[];e.subscribe(rt(t,a=>{n.push(a),i<n.length&&n.shift()},()=>{for(const a of n)t.next(a);t.complete()},void 0,()=>{n=null}))})}function o2(i,e){const t=arguments.length>=2;return n=>n.pipe(i?Yr((a,m)=>i(a,m,n)):Ri,Mw(1),t?R0(e):n2(()=>new L0))}function Cw(i){return Kt(()=>i)}function V0(i){return at((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}const as="primary",Px=Symbol("RouteTitle");class DR{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Tf(i){return new DR(i)}function IR(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const a={};for(let m=0;m<n.length;m++){const T=n[m],z=i[m];if(T.startsWith(":"))a[T.substring(1)]=z;else if(T!==z.path)return null}return{consumed:i.slice(0,n.length),posParams:a}}function mc(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let a;for(let m=0;m<t.length;m++)if(a=t[m],!r2(i[a],e[a]))return!1;return!0}function r2(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((a,m)=>n[m]===a)}return i===e}function a2(i){return Array.prototype.concat.apply([],i)}function l2(i){return i.length>0?i[i.length-1]:null}function ea(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function du(i){return br(i)?i:Oo(i)?J(Promise.resolve(i)):Cn(i)}const z0=!1,LR={exact:function d2(i,e,t){if(!Fp(i.segments,e.segments)||!N0(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!d2(i.children[n],e.children[n],t))return!1;return!0},subset:u2},h2={exact:function BR(i,e){return mc(i,e)},subset:function OR(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>r2(i[t],e[t]))},ignored:()=>!0};function c2(i,e,t){return LR[t.paths](i.root,e.root,t.matrixParams)&&h2[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function u2(i,e,t){return p2(i,e,e.segments,t)}function p2(i,e,t,n){if(i.segments.length>t.length){const a=i.segments.slice(0,t.length);return!(!Fp(a,t)||e.hasChildren()||!N0(a,t,n))}if(i.segments.length===t.length){if(!Fp(i.segments,t)||!N0(i.segments,t,n))return!1;for(const a in e.children)if(!i.children[a]||!u2(i.children[a],e.children[a],n))return!1;return!0}{const a=t.slice(0,i.segments.length),m=t.slice(i.segments.length);return!!(Fp(i.segments,a)&&N0(i.segments,a,n)&&i.children[as])&&p2(i.children[as],e,m,n)}}function N0(i,e,t){return e.every((n,a)=>h2[t](i[a].parameters,n.parameters))}class uu{constructor(e=new xs([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Tf(this.queryParams)),this._queryParamMap}toString(){return zR.serialize(this)}}class xs{constructor(e,t){this.segments=e,this.children=t,this.parent=null,ea(t,(n,a)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return W0(this)}}class Ex{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Tf(this.parameters)),this._parameterMap}toString(){return g2(this)}}function Fp(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}let Dx=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return new Tw},providedIn:"root"}),i})();class Tw{parse(e){const t=new GR(e);return new uu(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Ix(e.root,!0)}`,n=function XR(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(a=>`${X0(t)}=${X0(a)}`).join("&"):`${X0(t)}=${X0(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function NR(i){return encodeURI(i)}(e.fragment)}`:""}`}}const zR=new Tw;function W0(i){return i.segments.map(e=>g2(e)).join("/")}function Ix(i,e){if(!i.hasChildren())return W0(i);if(e){const t=i.children[as]?Ix(i.children[as],!1):"",n=[];return ea(i.children,(a,m)=>{m!==as&&n.push(`${m}:${Ix(a,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function VR(i,e){let t=[];return ea(i.children,(n,a)=>{a===as&&(t=t.concat(e(n,a)))}),ea(i.children,(n,a)=>{a!==as&&(t=t.concat(e(n,a)))}),t}(i,(n,a)=>a===as?[Ix(i.children[as],!1)]:[`${a}:${Ix(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[as]?`${W0(i)}/${t[0]}`:`${W0(i)}/(${t.join("//")})`}}function m2(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function X0(i){return m2(i).replace(/%3B/gi,";")}function Sw(i){return m2(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function j0(i){return decodeURIComponent(i)}function f2(i){return j0(i.replace(/\+/g,"%20"))}function g2(i){return`${Sw(i.path)}${function WR(i){return Object.keys(i).map(e=>`;${Sw(e)}=${Sw(i[e])}`).join("")}(i.parameters)}`}const jR=/^[^\/()?;=#]+/;function U0(i){const e=i.match(jR);return e?e[0]:""}const UR=/^[^=?&#]+/,HR=/^[^&#]+/;class GR{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xs([],{}):new xs([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[as]=new xs(e,t)),n}parseSegment(){const e=U0(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Rt(4009,z0);return this.capture(e),new Ex(j0(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=U0(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const a=U0(this.remaining);a&&(n=a,this.capture(n))}e[j0(t)]=j0(n)}parseQueryParam(e){const t=function YR(i){const e=i.match(UR);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const T=function $R(i){const e=i.match(HR);return e?e[0]:""}(this.remaining);T&&(n=T,this.capture(n))}const a=f2(t),m=f2(n);if(e.hasOwnProperty(a)){let T=e[a];Array.isArray(T)||(T=[T],e[a]=T),T.push(m)}else e[a]=m}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=U0(this.remaining),a=this.remaining[n.length];if("/"!==a&&")"!==a&&";"!==a)throw new Rt(4010,z0);let m;n.indexOf(":")>-1?(m=n.slice(0,n.indexOf(":")),this.capture(m),this.capture(":")):e&&(m=as);const T=this.parseChildren();t[m]=1===Object.keys(T).length?T[as]:new xs([],T),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Rt(4011,z0)}}function kw(i){return i.segments.length>0?new xs([],{[as]:i}):i}function Y0(i){const e={};for(const n of Object.keys(i.children)){const m=Y0(i.children[n]);(m.segments.length>0||m.hasChildren())&&(e[n]=m)}return function ZR(i){if(1===i.numberOfChildren&&i.children[as]){const e=i.children[as];return new xs(i.segments.concat(e.segments),e.children)}return i}(new xs(i.segments,e))}function Lp(i){return i instanceof uu}const Aw=!1;function KR(i,e,t,n,a){if(0===t.length)return Sf(e.root,e.root,e.root,n,a);const m=function b2(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new v2(!0,0,i);let e=0,t=!1;const n=i.reduce((a,m,T)=>{if("object"==typeof m&&null!=m){if(m.outlets){const z={};return ea(m.outlets,(j,Z)=>{z[Z]="string"==typeof j?j.split("/"):j}),[...a,{outlets:z}]}if(m.segmentPath)return[...a,m.segmentPath]}return"string"!=typeof m?[...a,m]:0===T?(m.split("/").forEach((z,j)=>{0==j&&"."===z||(0==j&&""===z?t=!0:".."===z?e++:""!=z&&a.push(z))}),a):[...a,m]},[]);return new v2(t,e,n)}(t);return m.toRoot()?Sf(e.root,e.root,new xs([],{}),n,a):function T(j){const Z=function QR(i,e,t,n){if(i.isAbsolute)return new kf(e.root,!0,0);if(-1===n)return new kf(t,t===e.root,0);return function w2(i,e,t){let n=i,a=e,m=t;for(;m>a;){if(m-=a,n=n.parent,!n)throw new Rt(4005,Aw&&"Invalid number of '../'");a=n.segments.length}return new kf(n,!1,a-m)}(t,n+(Fx(i.commands[0])?0:1),i.numberOfDoubleDots)}(m,e,i.snapshot?._urlSegment,j),st=Z.processChildren?Af(Z.segmentGroup,Z.index,m.commands):Pw(Z.segmentGroup,Z.index,m.commands);return Sf(e.root,Z.segmentGroup,st,n,a)}(i.snapshot?._lastPathIndex)}function Fx(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Lx(i){return"object"==typeof i&&null!=i&&i.outlets}function Sf(i,e,t,n,a){let T,m={};n&&ea(n,(j,Z)=>{m[Z]=Array.isArray(j)?j.map(st=>`${st}`):`${j}`}),T=i===e?t:_2(i,e,t);const z=kw(Y0(T));return new uu(z,m,a)}function _2(i,e,t){const n={};return ea(i.children,(a,m)=>{n[m]=a===e?t:_2(a,e,t)}),new xs(i.segments,n)}class v2{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Fx(n[0]))throw new Rt(4003,Aw&&"Root segment cannot have matrix parameters");const a=n.find(Lx);if(a&&a!==l2(n))throw new Rt(4004,Aw&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class kf{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function Pw(i,e,t){if(i||(i=new xs([],{})),0===i.segments.length&&i.hasChildren())return Af(i,e,t);const n=function tV(i,e,t){let n=0,a=e;const m={match:!1,pathIndex:0,commandIndex:0};for(;a<i.segments.length;){if(n>=t.length)return m;const T=i.segments[a],z=t[n];if(Lx(z))break;const j=`${z}`,Z=n<t.length-1?t[n+1]:null;if(a>0&&void 0===j)break;if(j&&Z&&"object"==typeof Z&&void 0===Z.outlets){if(!C2(j,Z,T))return m;n+=2}else{if(!C2(j,{},T))return m;n++}a++}return{match:!0,pathIndex:a,commandIndex:n}}(i,e,t),a=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const m=new xs(i.segments.slice(0,n.pathIndex),{});return m.children[as]=new xs(i.segments.slice(n.pathIndex),i.children),Af(m,0,a)}return n.match&&0===a.length?new xs(i.segments,{}):n.match&&!i.hasChildren()?Ew(i,e,t):n.match?Af(i,0,a):Ew(i,e,t)}function Af(i,e,t){if(0===t.length)return new xs(i.segments,{});{const n=function qR(i){return Lx(i[0])?i[0].outlets:{[as]:i}}(t),a={};if(!n[as]&&i.children[as]&&1===i.numberOfChildren&&0===i.children[as].segments.length){const m=Af(i.children[as],e,t);return new xs(i.segments,m.children)}return ea(n,(m,T)=>{"string"==typeof m&&(m=[m]),null!==m&&(a[T]=Pw(i.children[T],e,m))}),ea(i.children,(m,T)=>{void 0===n[T]&&(a[T]=m)}),new xs(i.segments,a)}}function Ew(i,e,t){const n=i.segments.slice(0,e);let a=0;for(;a<t.length;){const m=t[a];if(Lx(m)){const j=eV(m.outlets);return new xs(n,j)}if(0===a&&Fx(t[0])){n.push(new Ex(i.segments[e].path,M2(t[0]))),a++;continue}const T=Lx(m)?m.outlets[as]:`${m}`,z=a<t.length-1?t[a+1]:null;T&&z&&Fx(z)?(n.push(new Ex(T,M2(z))),a+=2):(n.push(new Ex(T,{})),a++)}return new xs(n,{})}function eV(i){const e={};return ea(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=Ew(new xs([],{}),0,t))}),e}function M2(i){const e={};return ea(i,(t,n)=>e[n]=`${t}`),e}function C2(i,e,t){return i==t.path&&mc(e,t.parameters)}const Bx="imperative";class fc{constructor(e,t){this.id=e,this.url=t}}class Dw extends fc{constructor(e,t,n="imperative",a=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=a}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Bp extends fc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class H0 extends fc{constructor(e,t,n,a){super(e,t),this.reason=n,this.code=a,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class $0 extends fc{constructor(e,t,n,a){super(e,t),this.reason=n,this.code=a,this.type=16}}class Iw extends fc{constructor(e,t,n,a){super(e,t),this.error=n,this.target=a,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class iV extends fc{constructor(e,t,n,a){super(e,t),this.urlAfterRedirects=n,this.state=a,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nV extends fc{constructor(e,t,n,a){super(e,t),this.urlAfterRedirects=n,this.state=a,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sV extends fc{constructor(e,t,n,a,m){super(e,t),this.urlAfterRedirects=n,this.state=a,this.shouldActivate=m,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class oV extends fc{constructor(e,t,n,a){super(e,t),this.urlAfterRedirects=n,this.state=a,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class rV extends fc{constructor(e,t,n,a){super(e,t),this.urlAfterRedirects=n,this.state=a,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class aV{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class lV{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class hV{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class cV{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dV{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class uV{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T2{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let fV=(()=>{class i{createUrlTree(t,n,a,m,T,z){return KR(t||n.root,a,m,T,z)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),xV=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(e){return fV.\u0275fac(e)},providedIn:"root"}),i})();class S2{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Fw(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=Fw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Lw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(a=>a.value).filter(a=>a!==e)}pathFromRoot(e){return Lw(e,this._root).map(t=>t.value)}}function Fw(i,e){if(i===e.value)return e;for(const t of e.children){const n=Fw(i,t);if(n)return n}return null}function Lw(i,e){if(i===e.value)return[e];for(const t of e.children){const n=Lw(i,t);if(n.length)return n.unshift(e),n}return[]}class ad{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Pf(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class k2 extends S2{constructor(e,t){super(e),this.snapshot=t,Bw(this,e)}toString(){return this.snapshot.toString()}}function A2(i,e){const t=function yV(i,e){const T=new G0([],{},{},"",{},as,e,null,i.root,-1,{});return new E2("",new ad(T,[]))}(i,e),n=new Nl([new Ex("",{})]),a=new Nl({}),m=new Nl({}),T=new Nl({}),z=new Nl(""),j=new Op(n,a,T,z,m,as,e,t.root);return j.snapshot=t.root,new k2(new ad(j,[]),t)}class Op{constructor(e,t,n,a,m,T,z,j){this.url=e,this.params=t,this.queryParams=n,this.fragment=a,this.data=m,this.outlet=T,this.component=z,this.title=this.data?.pipe(Kt(Z=>Z[Px]))??Cn(void 0),this._futureSnapshot=j}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Kt(e=>Tf(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Kt(e=>Tf(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function P2(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const a=t[n],m=t[n-1];if(a.routeConfig&&""===a.routeConfig.path)n--;else{if(m.component)break;n--}}return function _V(i){return i.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class G0{get title(){return this.data?.[Px]}constructor(e,t,n,a,m,T,z,j,Z,st,Mt){this.url=e,this.params=t,this.queryParams=n,this.fragment=a,this.data=m,this.outlet=T,this.component=z,this.routeConfig=j,this._urlSegment=Z,this._lastPathIndex=st,this._resolve=Mt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Tf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Tf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class E2 extends S2{constructor(e,t){super(t),this.url=e,Bw(this,t)}toString(){return D2(this._root)}}function Bw(i,e){e.value._routerState=i,e.children.forEach(t=>Bw(i,t))}function D2(i){const e=i.children.length>0?` { ${i.children.map(D2).join(", ")} } `:"";return`${i.value}${e}`}function Ow(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,mc(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),mc(e.params,t.params)||i.params.next(t.params),function FR(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!mc(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),mc(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function Rw(i,e){const t=mc(i.params,e.params)&&function RR(i,e){return Fp(i,e)&&i.every((t,n)=>mc(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||Rw(i.parent,e.parent))}function Ox(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const a=function bV(i,e,t){return e.children.map(n=>{for(const a of t.children)if(i.shouldReuseRoute(n.value,a.value.snapshot))return Ox(i,n,a);return Ox(i,n)})}(i,e,t);return new ad(n,a)}{if(i.shouldAttach(e.value)){const m=i.retrieve(e.value);if(null!==m){const T=m.route;return T.value._futureSnapshot=e.value,T.children=e.children.map(z=>Ox(i,z)),T}}const n=function wV(i){return new Op(new Nl(i.url),new Nl(i.params),new Nl(i.queryParams),new Nl(i.fragment),new Nl(i.data),i.outlet,i.component,i)}(e.value),a=e.children.map(m=>Ox(i,m));return new ad(n,a)}}const Vw="ngNavigationCancelingError";function I2(i,e){const{redirectTo:t,navigationBehaviorOptions:n}=Lp(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,a=F2(!1,0,e);return a.url=t,a.navigationBehaviorOptions=n,a}function F2(i,e,t){const n=new Error("NavigationCancelingError: "+(i||""));return n[Vw]=!0,n.cancellationCode=e,t&&(n.url=t),n}function L2(i){return B2(i)&&Lp(i.url)}function B2(i){return i&&i[Vw]}class MV{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Rx,this.attachRef=null}}let Rx=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const a=this.getOrCreateContext(t);a.outlet=n,this.contexts.set(t,a)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new MV,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Z0=!1;let zw=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=as,this.activateEvents=new lo,this.deactivateEvents=new lo,this.attachEvents=new lo,this.detachEvents=new lo,this.parentContexts=Fn(Rx),this.location=Fn(fh),this.changeDetector=Fn(au),this.environmentInjector=Fn(Dl)}ngOnChanges(t){if(t.name){const{firstChange:n,previousValue:a}=t.name;if(n)return;this.isTrackedInParentContexts(a)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(a)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Rt(4012,Z0);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Rt(4012,Z0);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Rt(4012,Z0);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Rt(4013,Z0);this._activatedRoute=t;const a=this.location,T=t.snapshot.component,z=this.parentContexts.getOrCreateContext(this.name).children,j=new CV(t,z,a.injector);if(n&&function TV(i){return!!i.resolveComponentFactory}(n)){const Z=n.resolveComponentFactory(T);this.activated=a.createComponent(Z,a.length,j)}else this.activated=a.createComponent(T,{index:a.length,injector:j,environmentInjector:n??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ji({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[er]}),i})();class CV{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Op?this.route:e===Rx?this.childContexts:this.parent.get(e,t)}}let Nw=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=po({type:i,selectors:[["ng-component"]],standalone:!0,features:[VT],decls:1,vars:0,template:function(t,n){1&t&&An(0,"router-outlet")},dependencies:[zw],encapsulation:2}),i})();function O2(i,e){return i.providers&&!i._injector&&(i._injector=o0(i.providers,e,`Route: ${i.path}`)),i._injector??e}function Xw(i){const e=i.children&&i.children.map(Xw),t=e?{...i,children:e}:{...i};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==as&&(t.component=Nw),t}function Wl(i){return i.outlet||as}function R2(i,e){const t=i.filter(n=>Wl(n)===e);return t.push(...i.filter(n=>Wl(n)!==e)),t}function Vx(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class EV{constructor(e,t,n,a){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=a}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Ow(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const a=Pf(t);e.children.forEach(m=>{const T=m.value.outlet;this.deactivateRoutes(m,a[T],n),delete a[T]}),ea(a,(m,T)=>{this.deactivateRouteAndItsChildren(m,n)})}deactivateRoutes(e,t,n){const a=e.value,m=t?t.value:null;if(a===m)if(a.component){const T=n.getContext(a.outlet);T&&this.deactivateChildRoutes(e,t,T.children)}else this.deactivateChildRoutes(e,t,n);else m&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),a=n&&e.value.component?n.children:t,m=Pf(e);for(const T of Object.keys(m))this.deactivateRouteAndItsChildren(m[T],a);if(n&&n.outlet){const T=n.outlet.detach(),z=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:T,route:e,contexts:z})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),a=n&&e.value.component?n.children:t,m=Pf(e);for(const T of Object.keys(m))this.deactivateRouteAndItsChildren(m[T],a);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const a=Pf(t);e.children.forEach(m=>{this.activateRoutes(m,a[m.value.outlet],n),this.forwardEvent(new uV(m.value.snapshot))}),e.children.length&&this.forwardEvent(new cV(e.value.snapshot))}activateRoutes(e,t,n){const a=e.value,m=t?t.value:null;if(Ow(a),a===m)if(a.component){const T=n.getOrCreateContext(a.outlet);this.activateChildRoutes(e,t,T.children)}else this.activateChildRoutes(e,t,n);else if(a.component){const T=n.getOrCreateContext(a.outlet);if(this.routeReuseStrategy.shouldAttach(a.snapshot)){const z=this.routeReuseStrategy.retrieve(a.snapshot);this.routeReuseStrategy.store(a.snapshot,null),T.children.onOutletReAttached(z.contexts),T.attachRef=z.componentRef,T.route=z.route.value,T.outlet&&T.outlet.attach(z.componentRef,z.route.value),Ow(z.route.value),this.activateChildRoutes(e,null,T.children)}else{const z=Vx(a.snapshot),j=z?.get(tc)??null;T.attachRef=null,T.route=a,T.resolver=j,T.injector=z,T.outlet&&T.outlet.activateWith(a,T.injector),this.activateChildRoutes(e,null,T.children)}}else this.activateChildRoutes(e,null,n)}}class V2{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class K0{constructor(e,t){this.component=e,this.route=t}}function DV(i,e,t){const n=i._root;return zx(n,e?e._root:null,t,[n.value])}function Ef(i,e){const t=Symbol(),n=e.get(i,t);return n===t?"function"!=typeof i||function Vn(i){return null!==Ki(i)}(i)?e.get(i):i:n}function zx(i,e,t,n,a={canDeactivateChecks:[],canActivateChecks:[]}){const m=Pf(e);return i.children.forEach(T=>{(function FV(i,e,t,n,a={canDeactivateChecks:[],canActivateChecks:[]}){const m=i.value,T=e?e.value:null,z=t?t.getContext(i.value.outlet):null;if(T&&m.routeConfig===T.routeConfig){const j=function LV(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!Fp(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Fp(i.url,e.url)||!mc(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Rw(i,e)||!mc(i.queryParams,e.queryParams);default:return!Rw(i,e)}}(T,m,m.routeConfig.runGuardsAndResolvers);j?a.canActivateChecks.push(new V2(n)):(m.data=T.data,m._resolvedData=T._resolvedData),zx(i,e,m.component?z?z.children:null:t,n,a),j&&z&&z.outlet&&z.outlet.isActivated&&a.canDeactivateChecks.push(new K0(z.outlet.component,T))}else T&&Nx(e,z,a),a.canActivateChecks.push(new V2(n)),zx(i,null,m.component?z?z.children:null:t,n,a)})(T,m[T.value.outlet],t,n.concat([T.value]),a),delete m[T.value.outlet]}),ea(m,(T,z)=>Nx(T,t.getContext(z),a)),a}function Nx(i,e,t){const n=Pf(i),a=i.value;ea(n,(m,T)=>{Nx(m,a.component?e?e.children.getContext(T):null:e,t)}),t.canDeactivateChecks.push(new K0(a.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,a))}function Wx(i){return"function"==typeof i}function jw(i){return i instanceof L0||"EmptyError"===i?.name}const J0=Symbol("INITIAL_VALUE");function Df(){return pc(i=>bw(i.map(e=>e.pipe(_h(1),O0(J0)))).pipe(Kt(e=>{for(const t of e)if(!0!==t){if(t===J0)return J0;if(!1===t||t instanceof uu)return t}return!0}),Yr(e=>e!==J0),_h(1)))}function z2(i){return function Us(...i){return fn(i)}(Cr(e=>{if(Lp(e))throw I2(0,e)}),Kt(e=>!0===e))}const Uw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function N2(i,e,t,n,a){const m=Yw(i,e,t);return m.matched?function JV(i,e,t,n){const a=e.canMatch;return a&&0!==a.length?Cn(a.map(T=>{const z=Ef(T,i);return du(function NV(i){return i&&Wx(i.canMatch)}(z)?z.canMatch(e,t):i.runInContext(()=>z(e,t)))})).pipe(Df(),z2()):Cn(!0)}(n=O2(e,n),e,t).pipe(Kt(T=>!0===T?m:{...Uw})):Cn(m)}function Yw(i,e,t){if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?{...Uw}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const a=(e.matcher||IR)(t,i,e);if(!a)return{...Uw};const m={};ea(a.posParams,(z,j)=>{m[j]=z.path});const T=a.consumed.length>0?{...m,...a.consumed[a.consumed.length-1].parameters}:m;return{matched:!0,consumedSegments:a.consumed,remainingSegments:t.slice(a.consumed.length),parameters:T,positionalParamSegments:a.posParams??{}}}function Q0(i,e,t,n){if(t.length>0&&function tz(i,e,t){return t.some(n=>q0(i,e,n)&&Wl(n)!==as)}(i,t,n)){const m=new xs(e,function qV(i,e,t,n){const a={};a[as]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const m of t)if(""===m.path&&Wl(m)!==as){const T=new xs([],{});T._sourceSegment=i,T._segmentIndexShift=e.length,a[Wl(m)]=T}return a}(i,e,n,new xs(t,i.children)));return m._sourceSegment=i,m._segmentIndexShift=e.length,{segmentGroup:m,slicedSegments:[]}}if(0===t.length&&function ez(i,e,t){return t.some(n=>q0(i,e,n))}(i,t,n)){const m=new xs(i.segments,function QV(i,e,t,n,a){const m={};for(const T of n)if(q0(i,t,T)&&!a[Wl(T)]){const z=new xs([],{});z._sourceSegment=i,z._segmentIndexShift=e.length,m[Wl(T)]=z}return{...a,...m}}(i,e,t,n,i.children));return m._sourceSegment=i,m._segmentIndexShift=e.length,{segmentGroup:m,slicedSegments:t}}const a=new xs(i.segments,i.children);return a._sourceSegment=i,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function q0(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function W2(i,e,t,n){return!!(Wl(i)===n||n!==as&&q0(e,t,i))&&("**"===i.path||Yw(e,i,t).matched)}function X2(i,e,t){return 0===e.length&&!i.children[t]}const tv=!1;class ev{constructor(e){this.segmentGroup=e||null}}class j2{constructor(e){this.urlTree=e}}function Xx(i){return Cf(new ev(i))}function U2(i){return Cf(new j2(i))}class oz{constructor(e,t,n,a,m){this.injector=e,this.configLoader=t,this.urlSerializer=n,this.urlTree=a,this.config=m,this.allowRedirects=!0}apply(){const e=Q0(this.urlTree.root,[],[],this.config).segmentGroup,t=new xs(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,as).pipe(Kt(m=>this.createUrlTree(Y0(m),this.urlTree.queryParams,this.urlTree.fragment))).pipe(rd(m=>{if(m instanceof j2)return this.allowRedirects=!1,this.match(m.urlTree);throw m instanceof ev?this.noMatchError(m):m}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,as).pipe(Kt(a=>this.createUrlTree(Y0(a),e.queryParams,e.fragment))).pipe(rd(a=>{throw a instanceof ev?this.noMatchError(a):a}))}noMatchError(e){return new Rt(4002,tv)}createUrlTree(e,t,n){const a=kw(e);return new uu(a,t,n)}expandSegmentGroup(e,t,n,a){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Kt(m=>new xs([],m))):this.expandSegment(e,n,t,n.segments,a,!0)}expandChildren(e,t,n){const a=[];for(const m of Object.keys(n.children))"primary"===m?a.unshift(m):a.push(m);return J(a).pipe(cu(m=>{const T=n.children[m],z=R2(t,m);return this.expandSegmentGroup(e,z,T,m).pipe(Kt(j=>({segment:j,outlet:m})))}),s2((m,T)=>(m[T.outlet]=T.segment,m),{}),o2())}expandSegment(e,t,n,a,m,T){return J(n).pipe(cu(z=>this.expandSegmentAgainstRoute(e,t,n,z,a,m,T).pipe(rd(Z=>{if(Z instanceof ev)return Cn(null);throw Z}))),hu(z=>!!z),rd((z,j)=>{if(jw(z))return X2(t,a,m)?Cn(new xs([],{})):Xx(t);throw z}))}expandSegmentAgainstRoute(e,t,n,a,m,T,z){return W2(a,t,m,T)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(e,t,a,m,T):z&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,a,m,T):Xx(t):Xx(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,a,m,T){return"**"===a.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,a,T):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,a,m,T)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,a){const m=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?U2(m):this.lineralizeSegments(n,m).pipe(x(T=>{const z=new xs(T,{});return this.expandSegment(e,z,t,T,a,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,a,m,T){const{matched:z,consumedSegments:j,remainingSegments:Z,positionalParamSegments:st}=Yw(t,a,m);if(!z)return Xx(t);const Mt=this.applyRedirectCommands(j,a.redirectTo,st);return a.redirectTo.startsWith("/")?U2(Mt):this.lineralizeSegments(a,Mt).pipe(x(Wt=>this.expandSegment(e,t,n,Wt.concat(Z),T,!1)))}matchSegmentAgainstRoute(e,t,n,a,m){return"**"===n.path?(e=O2(n,e),n.loadChildren?(n._loadedRoutes?Cn({routes:n._loadedRoutes,injector:n._loadedInjector}):this.configLoader.loadChildren(e,n)).pipe(Kt(z=>(n._loadedRoutes=z.routes,n._loadedInjector=z.injector,new xs(a,{})))):Cn(new xs(a,{}))):N2(t,n,a,e).pipe(pc(({matched:T,consumedSegments:z,remainingSegments:j})=>T?this.getChildConfig(e=n._injector??e,n,a).pipe(x(st=>{const Mt=st.injector??e,Wt=st.routes,{segmentGroup:qt,slicedSegments:pe}=Q0(t,z,j,Wt),Me=new xs(qt.segments,qt.children);if(0===pe.length&&Me.hasChildren())return this.expandChildren(Mt,Wt,Me).pipe(Kt(ii=>new xs(z,ii)));if(0===Wt.length&&0===pe.length)return Cn(new xs(z,{}));const Xe=Wl(n)===m;return this.expandSegment(Mt,Me,Wt,pe,Xe?as:m,!0).pipe(Kt(Ai=>new xs(z.concat(Ai.segments),Ai.children)))})):Xx(t)))}getChildConfig(e,t,n){return t.children?Cn({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Cn({routes:t._loadedRoutes,injector:t._loadedInjector}):function KV(i,e,t,n){const a=e.canLoad;return void 0===a||0===a.length?Cn(!0):Cn(a.map(T=>{const z=Ef(T,i);return du(function OV(i){return i&&Wx(i.canLoad)}(z)?z.canLoad(e,t):i.runInContext(()=>z(e,t)))})).pipe(Df(),z2())}(e,t,n).pipe(x(a=>a?this.configLoader.loadChildren(e,t).pipe(Cr(m=>{t._loadedRoutes=m.routes,t._loadedInjector=m.injector})):function nz(i){return Cf(F2(tv,3))}())):Cn({routes:[],injector:e})}lineralizeSegments(e,t){let n=[],a=t.root;for(;;){if(n=n.concat(a.segments),0===a.numberOfChildren)return Cn(n);if(a.numberOfChildren>1||!a.children[as])return e.redirectTo,Cf(new Rt(4e3,tv));a=a.children[as]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,a){const m=this.createSegmentGroup(e,t.root,n,a);return new uu(m,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return ea(e,(a,m)=>{if("string"==typeof a&&a.startsWith(":")){const z=a.substring(1);n[m]=t[z]}else n[m]=a}),n}createSegmentGroup(e,t,n,a){const m=this.createSegments(e,t.segments,n,a);let T={};return ea(t.children,(z,j)=>{T[j]=this.createSegmentGroup(e,z,n,a)}),new xs(m,T)}createSegments(e,t,n,a){return t.map(m=>m.path.startsWith(":")?this.findPosParam(e,m,a):this.findOrReturn(m,n))}findPosParam(e,t,n){const a=n[t.path.substring(1)];if(!a)throw new Rt(4001,tv);return a}findOrReturn(e,t){let n=0;for(const a of t){if(a.path===e.path)return t.splice(n),a;n++}return e}}class az{}class cz{constructor(e,t,n,a,m,T,z){this.injector=e,this.rootComponentType=t,this.config=n,this.urlTree=a,this.url=m,this.paramsInheritanceStrategy=T,this.urlSerializer=z}recognize(){const e=Q0(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,as).pipe(Kt(t=>{if(null===t)return null;const n=new G0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},as,this.rootComponentType,null,this.urlTree.root,-1,{}),a=new ad(n,t),m=new E2(this.url,a);return this.inheritParamsAndData(m._root),m}))}inheritParamsAndData(e){const t=e.value,n=P2(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(a=>this.inheritParamsAndData(a))}processSegmentGroup(e,t,n,a){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,a)}processChildren(e,t,n){return J(Object.keys(n.children)).pipe(cu(a=>{const m=n.children[a],T=R2(t,a);return this.processSegmentGroup(e,T,m,a)}),s2((a,m)=>a&&m?(a.push(...m),a):null),function ER(i,e=!1){return at((t,n)=>{let a=0;t.subscribe(rt(n,m=>{const T=i(m,a++);(T||e)&&n.next(m),!T&&n.complete()}))})}(a=>null!==a),R0(null),o2(),Kt(a=>{if(null===a)return null;const m=H2(a);return function dz(i){i.sort((e,t)=>e.value.outlet===as?-1:t.value.outlet===as?1:e.value.outlet.localeCompare(t.value.outlet))}(m),m}))}processSegment(e,t,n,a,m){return J(t).pipe(cu(T=>this.processSegmentAgainstRoute(T._injector??e,T,n,a,m)),hu(T=>!!T),rd(T=>{if(jw(T))return X2(n,a,m)?Cn([]):Cn(null);throw T}))}processSegmentAgainstRoute(e,t,n,a,m){if(t.redirectTo||!W2(t,n,a,m))return Cn(null);let T;if("**"===t.path){const z=a.length>0?l2(a).parameters:{},j=G2(n)+a.length;T=Cn({snapshot:new G0(a,z,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z2(t),Wl(t),t.component??t._loadedComponent??null,t,$2(n),j,K2(t)),consumedSegments:[],remainingSegments:[]})}else T=N2(n,t,a,e).pipe(Kt(({matched:z,consumedSegments:j,remainingSegments:Z,parameters:st})=>{if(!z)return null;const Mt=G2(n)+j.length;return{snapshot:new G0(j,st,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z2(t),Wl(t),t.component??t._loadedComponent??null,t,$2(n),Mt,K2(t)),consumedSegments:j,remainingSegments:Z}}));return T.pipe(pc(z=>{if(null===z)return Cn(null);const{snapshot:j,consumedSegments:Z,remainingSegments:st}=z;e=t._injector??e;const Mt=t._loadedInjector??e,Wt=function uz(i){return i.children?i.children:i.loadChildren?i._loadedRoutes:[]}(t),{segmentGroup:qt,slicedSegments:pe}=Q0(n,Z,st,Wt.filter(Xe=>void 0===Xe.redirectTo));if(0===pe.length&&qt.hasChildren())return this.processChildren(Mt,Wt,qt).pipe(Kt(Xe=>null===Xe?null:[new ad(j,Xe)]));if(0===Wt.length&&0===pe.length)return Cn([new ad(j,[])]);const Me=Wl(t)===m;return this.processSegment(Mt,Wt,qt,pe,Me?as:m).pipe(Kt(Xe=>null===Xe?null:[new ad(j,Xe)]))}))}}function pz(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function H2(i){const e=[],t=new Set;for(const n of i){if(!pz(n)){e.push(n);continue}const a=e.find(m=>n.value.routeConfig===m.value.routeConfig);void 0!==a?(a.children.push(...n.children),t.add(a)):e.push(n)}for(const n of t){const a=H2(n.children);e.push(new ad(n.value,a))}return e.filter(n=>!t.has(n))}function $2(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function G2(i){let e=i,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function Z2(i){return i.data||{}}function K2(i){return i.resolve||{}}function J2(i){return"string"==typeof i.title||null===i.title}function Hw(i){return pc(e=>{const t=i(e);return t?J(t).pipe(Kt(()=>e)):Cn(e)})}const If=new Bi("ROUTES");let $w=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Fn(CS)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Cn(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const n=du(t.loadComponent()).pipe(Kt(q2),Cr(m=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=m}),V0(()=>{this.componentLoaders.delete(t)})),a=new e2(n,()=>new oe).pipe(ww());return this.componentLoaders.set(t,a),a}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Cn({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const m=this.loadModuleFactoryOrRoutes(n.loadChildren).pipe(Kt(z=>{this.onLoadEndListener&&this.onLoadEndListener(n);let j,Z,st=!1;Array.isArray(z)?Z=z:(j=z.create(t).injector,Z=a2(j.get(If,[],vi.Self|vi.Optional)));return{routes:Z.map(Xw),injector:j}}),V0(()=>{this.childrenLoaders.delete(n)})),T=new e2(m,()=>new oe).pipe(ww());return this.childrenLoaders.set(n,T),T}loadModuleFactoryOrRoutes(t){return du(t()).pipe(Kt(q2),x(n=>n instanceof OT||Array.isArray(n)?Cn(n):J(this.compiler.compileModuleAsync(n))))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function q2(i){return function bz(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let nv=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new oe,this.configLoader=Fn($w),this.environmentInjector=Fn(Dl),this.urlSerializer=Fn(Dx),this.rootContexts=Fn(Rx),this.navigationId=0,this.afterPreactivation=()=>Cn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=a=>this.events.next(new lV(a)),this.configLoader.onLoadStartListener=a=>this.events.next(new aV(a))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:n})}setupNavigations(t){return this.transitions=new Nl({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Bx,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Yr(n=>0!==n.id),Kt(n=>({...n,extractedUrl:t.urlHandlingStrategy.extract(n.rawUrl)})),pc(n=>{let a=!1,m=!1;return Cn(n).pipe(Cr(T=>{this.currentNavigation={id:T.id,initialUrl:T.rawUrl,extractedUrl:T.extractedUrl,trigger:T.source,extras:T.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),pc(T=>{const z=t.browserUrlTree.toString(),j=!t.navigated||T.extractedUrl.toString()!==z||z!==t.currentUrlTree.toString();if(!j&&"reload"!==(T.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const st="";return this.events.next(new $0(T.id,t.serializeUrl(n.rawUrl),st,0)),t.rawUrlTree=T.rawUrl,T.resolve(null),D}if(t.urlHandlingStrategy.shouldProcessUrl(T.rawUrl))return tA(T.source)&&(t.browserUrlTree=T.extractedUrl),Cn(T).pipe(pc(st=>{const Mt=this.transitions?.getValue();return this.events.next(new Dw(st.id,this.urlSerializer.serialize(st.extractedUrl),st.source,st.restoredState)),Mt!==this.transitions?.getValue()?D:Promise.resolve(st)}),function rz(i,e,t,n){return pc(a=>function sz(i,e,t,n,a){return new oz(i,e,t,n,a).apply()}(i,e,t,a.extractedUrl,n).pipe(Kt(m=>({...a,urlAfterRedirects:m}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),Cr(st=>{this.currentNavigation={...this.currentNavigation,finalUrl:st.urlAfterRedirects},n.urlAfterRedirects=st.urlAfterRedirects}),function fz(i,e,t,n,a){return x(m=>function hz(i,e,t,n,a,m,T="emptyOnly"){return new cz(i,e,t,n,a,T,m).recognize().pipe(pc(z=>null===z?function lz(i){return new ln(e=>e.error(i))}(new az):Cn(z)))}(i,e,t,m.urlAfterRedirects,n.serialize(m.urlAfterRedirects),n,a).pipe(Kt(T=>({...m,targetSnapshot:T}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Cr(st=>{if(n.targetSnapshot=st.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!st.extras.skipLocationChange){const Wt=t.urlHandlingStrategy.merge(st.urlAfterRedirects,st.rawUrl);t.setBrowserUrl(Wt,st)}t.browserUrlTree=st.urlAfterRedirects}const Mt=new iV(st.id,this.urlSerializer.serialize(st.extractedUrl),this.urlSerializer.serialize(st.urlAfterRedirects),st.targetSnapshot);this.events.next(Mt)}));if(j&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:st,extractedUrl:Mt,source:Wt,restoredState:qt,extras:pe}=T,Me=new Dw(st,this.urlSerializer.serialize(Mt),Wt,qt);this.events.next(Me);const Xe=A2(Mt,this.rootComponentType).snapshot;return Cn(n={...T,targetSnapshot:Xe,urlAfterRedirects:Mt,extras:{...pe,skipLocationChange:!1,replaceUrl:!1}})}{const st="";return this.events.next(new $0(T.id,t.serializeUrl(n.extractedUrl),st,1)),t.rawUrlTree=T.rawUrl,T.resolve(null),D}}),Cr(T=>{const z=new nV(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot);this.events.next(z)}),Kt(T=>n={...T,guards:DV(T.targetSnapshot,T.currentSnapshot,this.rootContexts)}),function XV(i,e){return x(t=>{const{targetSnapshot:n,currentSnapshot:a,guards:{canActivateChecks:m,canDeactivateChecks:T}}=t;return 0===T.length&&0===m.length?Cn({...t,guardsResult:!0}):function jV(i,e,t,n){return J(i).pipe(x(a=>function ZV(i,e,t,n,a){const m=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return m&&0!==m.length?Cn(m.map(z=>{const j=Vx(e)??a,Z=Ef(z,j);return du(function zV(i){return i&&Wx(i.canDeactivate)}(Z)?Z.canDeactivate(i,e,t,n):j.runInContext(()=>Z(i,e,t,n))).pipe(hu())})).pipe(Df()):Cn(!0)}(a.component,a.route,t,e,n)),hu(a=>!0!==a,!0))}(T,n,a,i).pipe(x(z=>z&&function BV(i){return"boolean"==typeof i}(z)?function UV(i,e,t,n){return J(e).pipe(cu(a=>B0(function HV(i,e){return null!==i&&e&&e(new hV(i)),Cn(!0)}(a.route.parent,n),function YV(i,e){return null!==i&&e&&e(new dV(i)),Cn(!0)}(a.route,n),function GV(i,e,t){const n=e[e.length-1],m=e.slice(0,e.length-1).reverse().map(T=>function IV(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(T)).filter(T=>null!==T).map(T=>t2(()=>Cn(T.guards.map(j=>{const Z=Vx(T.node)??t,st=Ef(j,Z);return du(function VV(i){return i&&Wx(i.canActivateChild)}(st)?st.canActivateChild(n,i):Z.runInContext(()=>st(n,i))).pipe(hu())})).pipe(Df())));return Cn(m).pipe(Df())}(i,a.path,t),function $V(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Cn(!0);const a=n.map(m=>t2(()=>{const T=Vx(e)??t,z=Ef(m,T);return du(function RV(i){return i&&Wx(i.canActivate)}(z)?z.canActivate(e,i):T.runInContext(()=>z(e,i))).pipe(hu())}));return Cn(a).pipe(Df())}(i,a.route,t))),hu(a=>!0!==a,!0))}(n,m,i,e):Cn(z)),Kt(z=>({...t,guardsResult:z})))})}(this.environmentInjector,T=>this.events.next(T)),Cr(T=>{if(n.guardsResult=T.guardsResult,Lp(T.guardsResult))throw I2(0,T.guardsResult);const z=new sV(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(T.urlAfterRedirects),T.targetSnapshot,!!T.guardsResult);this.events.next(z)}),Yr(T=>!!T.guardsResult||(t.restoreHistory(T),this.cancelNavigationTransition(T,"",3),!1)),Hw(T=>{if(T.guards.canActivateChecks.length)return Cn(T).pipe(Cr(z=>{const j=new oV(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(j)}),pc(z=>{let j=!1;return Cn(z).pipe(function gz(i,e){return x(t=>{const{targetSnapshot:n,guards:{canActivateChecks:a}}=t;if(!a.length)return Cn(t);let m=0;return J(a).pipe(cu(T=>function xz(i,e,t,n){const a=i.routeConfig,m=i._resolve;return void 0!==a?.title&&!J2(a)&&(m[Px]=a.title),function yz(i,e,t,n){const a=function _z(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===a.length)return Cn({});const m={};return J(a).pipe(x(T=>function vz(i,e,t,n){const a=Vx(e)??n,m=Ef(i,a);return du(m.resolve?m.resolve(e,t):a.runInContext(()=>m(e,t)))}(i[T],e,t,n).pipe(hu(),Cr(z=>{m[T]=z}))),Mw(1),Cw(m),rd(T=>jw(T)?D:Cf(T)))}(m,i,e,n).pipe(Kt(T=>(i._resolvedData=T,i.data=P2(i,t).resolve,a&&J2(a)&&(i.data[Px]=a.title),null)))}(T.route,n,i,e)),Cr(()=>m++),Mw(1),x(T=>m===a.length?Cn(t):D))})}(t.paramsInheritanceStrategy,this.environmentInjector),Cr({next:()=>j=!0,complete:()=>{j||(t.restoreHistory(z),this.cancelNavigationTransition(z,"",2))}}))}),Cr(z=>{const j=new rV(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(j)}))}),Hw(T=>{const z=j=>{const Z=[];j.routeConfig?.loadComponent&&!j.routeConfig._loadedComponent&&Z.push(this.configLoader.loadComponent(j.routeConfig).pipe(Cr(st=>{j.component=st}),Kt(()=>{})));for(const st of j.children)Z.push(...z(st));return Z};return bw(z(T.targetSnapshot.root)).pipe(R0(),_h(1))}),Hw(()=>this.afterPreactivation()),Kt(T=>{const z=function vV(i,e,t){const n=Ox(i,e._root,t?t._root:void 0);return new k2(n,e)}(t.routeReuseStrategy,T.targetSnapshot,T.currentRouterState);return n={...T,targetRouterState:z}}),Cr(T=>{t.currentUrlTree=T.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl),t.routerState=T.targetRouterState,"deferred"===t.urlUpdateStrategy&&(T.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,T),t.browserUrlTree=T.urlAfterRedirects)}),((i,e,t)=>Kt(n=>(new EV(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,t.routeReuseStrategy,T=>this.events.next(T)),_h(1),Cr({next:T=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Bp(T.id,this.urlSerializer.serialize(T.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(T.targetRouterState.snapshot),T.resolve(!0)},complete:()=>{a=!0}}),V0(()=>{a||m||this.cancelNavigationTransition(n,"",1),this.currentNavigation?.id===n.id&&(this.currentNavigation=null)}),rd(T=>{if(m=!0,B2(T)){L2(T)||(t.navigated=!0,t.restoreHistory(n,!0));const z=new H0(n.id,this.urlSerializer.serialize(n.extractedUrl),T.message,T.cancellationCode);if(this.events.next(z),L2(T)){const j=t.urlHandlingStrategy.merge(T.url,t.rawUrlTree),Z={skipLocationChange:n.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||tA(n.source)};t.scheduleNavigation(j,Bx,null,Z,{resolve:n.resolve,reject:n.reject,promise:n.promise})}else n.resolve(!1)}else{t.restoreHistory(n,!0);const z=new Iw(n.id,this.urlSerializer.serialize(n.extractedUrl),T,n.targetSnapshot??void 0);this.events.next(z);try{n.resolve(t.errorHandler(T))}catch(j){n.reject(j)}}return D}))}))}cancelNavigationTransition(t,n,a){const m=new H0(t.id,this.urlSerializer.serialize(t.extractedUrl),n,a);this.events.next(m),t.resolve(!1)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function tA(i){return i!==Bx}let eA=(()=>{class i{buildTitle(t){let n,a=t.root;for(;void 0!==a;)n=this.getResolvedTitleForRoute(a)??n,a=a.children.find(m=>m.outlet===as);return n}getResolvedTitleForRoute(t){return t.data[Px]}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Fn(wz)},providedIn:"root"}),i})(),wz=(()=>{class i extends eA{constructor(t){super(),this.title=t}updateTitle(t){const n=this.buildTitle(t);void 0!==n&&this.title.setTitle(n)}}return i.\u0275fac=function(t){return new(t||i)(fi($k))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Mz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Fn(Tz)},providedIn:"root"}),i})();class Cz{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Tz=(()=>{class i extends Cz{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=Ro(i)))(n||i)}}(),i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const sv=new Bi("",{providedIn:"root",factory:()=>({})});let kz=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:function(){return Fn(Az)},providedIn:"root"}),i})(),Az=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function Pz(i){throw i}function Ez(i,e,t){return e.parse("/")}const Dz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Iz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ka=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Fn(hL),this.isNgZoneEnabled=!1,this.options=Fn(sv,{optional:!0})||{},this.errorHandler=this.options.errorHandler||Pz,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Ez,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Fn(kz),this.routeReuseStrategy=Fn(Mz),this.urlCreationStrategy=Fn(xV),this.titleStrategy=Fn(eA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=a2(Fn(If,{optional:!0})??[]),this.navigationTransitions=Fn(nv),this.urlSerializer=Fn(Dx),this.location=Fn(G1),this.isNgZoneEnabled=Fn(us)instanceof us&&us.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new uu,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=A2(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Bx,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,n,t.state)},0)}))}navigateToSyncWithBrowser(t,n,a){const m={replaceUrl:!0},T=a?.navigationId?a:null;if(a){const j={...a};delete j.navigationId,delete j.\u0275routerPageId,0!==Object.keys(j).length&&(m.state=j)}const z=this.parseUrl(t);this.scheduleNavigation(z,n,T,m)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(Xw),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:a,queryParams:m,fragment:T,queryParamsHandling:z,preserveFragment:j}=n,Z=j?this.currentUrlTree.fragment:T;let st=null;switch(z){case"merge":st={...this.currentUrlTree.queryParams,...m};break;case"preserve":st=this.currentUrlTree.queryParams;break;default:st=m||null}return null!==st&&(st=this.removeEmptyProps(st)),this.urlCreationStrategy.createUrlTree(a,this.routerState,this.currentUrlTree,t,st,Z??null)}navigateByUrl(t,n={skipLocationChange:!1}){const a=Lp(t)?t:this.parseUrl(t),m=this.urlHandlingStrategy.merge(a,this.rawUrlTree);return this.scheduleNavigation(m,Bx,null,n)}navigate(t,n={skipLocationChange:!1}){return function Fz(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new Rt(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(a){n=this.malformedUriErrorHandler(a,this.urlSerializer,t)}return n}isActive(t,n){let a;if(a=!0===n?{...Dz}:!1===n?{...Iz}:n,Lp(t))return c2(this.currentUrlTree,t,a);const m=this.parseUrl(t);return c2(this.currentUrlTree,m,a)}removeEmptyProps(t){return Object.keys(t).reduce((n,a)=>{const m=t[a];return null!=m&&(n[a]=m),n},{})}scheduleNavigation(t,n,a,m,T){if(this.disposed)return Promise.resolve(!1);let z,j,Z,st;return T?(z=T.resolve,j=T.reject,Z=T.promise):Z=new Promise((Mt,Wt)=>{z=Mt,j=Wt}),st="computed"===this.canceledNavigationResolution?a&&a.\u0275routerPageId?a.\u0275routerPageId:m.replaceUrl||m.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:st,source:n,restoredState:a,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:m,resolve:z,reject:j,promise:Z,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Z.catch(Mt=>Promise.reject(Mt))}setBrowserUrl(t,n){const a=this.urlSerializer.serialize(t),m={...n.extras.state,...this.generateNgRouterState(n.id,n.targetPageId)};this.location.isCurrentPathEqualTo(a)||n.extras.replaceUrl?this.location.replaceState(a,"",m):this.location.go(a,"",m)}restoreHistory(t,n=!1){if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===a?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===a&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(a)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ov=(()=>{class i{constructor(t,n,a,m,T,z){this.router=t,this.route=n,this.tabIndexAttribute=a,this.renderer=m,this.el=T,this.locationStrategy=z,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new oe;const j=T.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===j||"area"===j,this.isAnchorElement?this.subscription=t.events.subscribe(Z=>{Z instanceof Bp&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=Mf(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=Mf(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=Mf(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,n,a,m,T){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||n||a||m||T||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function Xd(i,e,t){return function cp(i,e){return"src"===e&&("embed"===i||"frame"===i||"iframe"===i||"media"===i||"script"===i)||"href"===e&&("base"===i||"link"===i)?hp:lp}(e,t)(i)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,n){const a=this.renderer,m=this.el.nativeElement;null!==n?a.setAttribute(m,t,n):a.removeAttribute(m,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return i.\u0275fac=function(t){return new(t||i)(Ee(Ka),Ee(Op),Xu("tabindex"),Ee(hh),Ee(to),Ee(Ip))},i.\u0275dir=Ji({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,n){1&t&&gs("click",function(m){return n.onClick(m.button,m.ctrlKey,m.shiftKey,m.altKey,m.metaKey)}),2&t&&Ae("target",n.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[er]}),i})();class iA{}let Oz=(()=>{class i{constructor(t,n,a,m,T){this.router=t,this.injector=a,this.preloadingStrategy=m,this.loader=T}setUpPreloading(){this.subscription=this.router.events.pipe(Yr(t=>t instanceof Bp),cu(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const a=[];for(const m of n){m.providers&&!m._injector&&(m._injector=o0(m.providers,t,`Route: ${m.path}`));const T=m._injector??t,z=m._loadedInjector??T;(m.loadChildren&&!m._loadedRoutes&&void 0===m.canLoad||m.loadComponent&&!m._loadedComponent)&&a.push(this.preloadConfig(T,m)),(m.children||m._loadedRoutes)&&a.push(this.processRoutes(z,m.children??m._loadedRoutes))}return J(a).pipe(w())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let a;a=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(t,n):Cn(null);const m=a.pipe(x(T=>null===T?Cn(void 0):(n._loadedRoutes=T.routes,n._loadedInjector=T.injector,this.processRoutes(T.injector??t,T.routes))));return n.loadComponent&&!n._loadedComponent?J([m,this.loader.loadComponent(n)]).pipe(w()):m})}}return i.\u0275fac=function(t){return new(t||i)(fi(Ka),fi(CS),fi(Dl),fi(iA),fi($w))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const Zw=new Bi("");let nA=(()=>{class i{constructor(t,n,a,m,T={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=a,this.zone=m,this.options=T,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},T.scrollPositionRestoration=T.scrollPositionRestoration||"disabled",T.anchorScrolling=T.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Dw?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Bp&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof T2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new T2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return i.\u0275fac=function(t){Jc()},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();var ml=(()=>((ml=ml||{})[ml.COMPLETE=0]="COMPLETE",ml[ml.FAILED=1]="FAILED",ml[ml.REDIRECTING=2]="REDIRECTING",ml))();const Ff=!1;function pu(i,e){return{\u0275kind:i,\u0275providers:e}}const Kw=new Bi("",{providedIn:"root",factory:()=>!1});function oA(){const i=Fn(Aa);return e=>{const t=i.get(bx);if(e!==t.components[0])return;const n=i.get(Ka),a=i.get(rA);1===i.get(Jw)&&n.initialNavigation(),i.get(aA,null,vi.Optional)?.setUpPreloading(),i.get(Zw,null,vi.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),a.closed||(a.next(),a.complete(),a.unsubscribe())}}const rA=new Bi(Ff?"bootstrap done indicator":"",{factory:()=>new oe}),Jw=new Bi(Ff?"initial navigation":"",{providedIn:"root",factory:()=>1});function Wz(){let i=[];return i=Ff?[{provide:Vm,multi:!0,useFactory:()=>{const e=Fn(Ka);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function pV(i){if(!("type"in i))return`Unknown Router Event: ${i.constructor.name}`;switch(i.type){case 14:return`ActivationEnd(path: '${i.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${i.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${i.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${i.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state}, shouldActivate: ${i.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 2:return`NavigationCancel(id: ${i.id}, url: '${i.url}')`;case 16:return`NavigationSkipped(id: ${i.id}, url: '${i.url}')`;case 1:return`NavigationEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${i.id}, url: '${i.url}', error: ${i.error})`;case 0:return`NavigationStart(id: ${i.id}, url: '${i.url}')`;case 6:return`ResolveEnd(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 5:return`ResolveStart(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 10:return`RouteConfigLoadEnd(path: ${i.route.path})`;case 9:return`RouteConfigLoadStart(path: ${i.route.path})`;case 4:return`RoutesRecognized(id: ${i.id}, url: '${i.url}', urlAfterRedirects: '${i.urlAfterRedirects}', state: ${i.state})`;case 15:return`Scroll(anchor: '${i.anchor}', position: '${i.position?`${i.position[0]}, ${i.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],pu(1,i)}const aA=new Bi(Ff?"router preloader":"");function Xz(i){return pu(0,[{provide:aA,useExisting:Oz},{provide:iA,useExisting:i}])}const jx=!1,lA=new Bi(jx?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),jz=[G1,{provide:Dx,useClass:Tw},Ka,Rx,{provide:Op,useFactory:function sA(i){return i.routerState.root},deps:[Ka]},$w,jx?{provide:Kw,useValue:!0}:[]];function Uz(){return new IS("Router",Ka)}let hA=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[jz,jx&&n?.enableTracing?Wz().\u0275providers:[],{provide:If,multi:!0,useValue:t},{provide:lA,useFactory:Gz,deps:[[Ka,new la,new rh]]},{provide:sv,useValue:n||{}},n?.useHash?{provide:Ip,useClass:KL}:{provide:Ip,useClass:ek},{provide:Zw,useFactory:()=>{const i=Fn(fO),e=Fn(us),t=Fn(sv),n=Fn(nv),a=Fn(Dx);return t.scrollOffset&&i.setOffset(t.scrollOffset),new nA(a,n,i,e,t)}},n?.preloadingStrategy?Xz(n.preloadingStrategy).\u0275providers:[],{provide:IS,multi:!0,useFactory:Uz},n?.initialNavigation?Zz(n):[],[{provide:cA,useFactory:oA},{provide:DS,multi:!0,useExisting:cA}]]}}static forChild(t){return{ngModule:i,providers:[{provide:If,multi:!0,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)(fi(lA,8))},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[Nw]}),i})();function Gz(i){if(jx&&i)throw new Rt(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Zz(i){return["disabled"===i.initialNavigation?pu(3,[{provide:c0,multi:!0,useFactory:()=>{const e=Fn(Ka);return()=>{e.setUpLocationChangeListener()}}},{provide:Jw,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?pu(2,[{provide:Jw,useValue:0},{provide:c0,multi:!0,deps:[Aa],useFactory:e=>{const t=e.get(GL,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const a=e.get(Ka),m=e.get(rA);(function Rz(i,e){i.events.pipe(Yr(t=>t instanceof Bp||t instanceof H0||t instanceof Iw||t instanceof $0),Kt(t=>t instanceof Bp||t instanceof $0?ml.COMPLETE:t instanceof H0&&(0===t.code||1===t.code)?ml.REDIRECTING:ml.FAILED),Yr(t=>t!==ml.REDIRECTING),_h(1)).subscribe(()=>{e()})})(a,()=>{n(!0)}),e.get(nv).afterPreactivation=()=>(n(!0),m.closed?Cn(void 0):m),a.initialNavigation()}))}}]).\u0275providers:[]]}const cA=new Bi(jx?"Router Initializer":"");var Qw=ia(158);const Ux_mapbox_publicToken="pk.eyJ1IjoibWFyaW9nZW5vbCIsImEiOiJjbGc5bXIyN2QwcWs5M2RvNmc2azZoOGU4In0.F_j1Ao8vQcfZusS10yFF5w",Ux_backendURL="http://localhost:4201";class rv{}class qw{}class ld{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const a=t.slice(0,n),m=a.toLowerCase(),T=t.slice(n+1).trim();this.maybeSetNormalizedName(a,m),this.headers.has(m)?this.headers.get(m).push(T):this.headers.set(m,[T])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const a=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(a,n),this.maybeSetNormalizedName(t,a))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ld?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ld;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ld?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const a=("a"===e.op?this.headers.get(t):void 0)||[];a.push(...n),this.headers.set(t,a);break;case"d":const m=e.value;if(m){let T=this.headers.get(t);if(!T)return;T=T.filter(z=>-1===m.indexOf(z)),0===T.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,T)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Jz{encodeKey(e){return dA(e)}encodeValue(e){return dA(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const qz=/%(\d[a-f0-9])/gi,tN={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function dA(i){return encodeURIComponent(i).replace(qz,(e,t)=>tN[t]??e)}function av(i){return`${i}`}class mu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Jz,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Qz(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(a=>{const m=a.indexOf("="),[T,z]=-1==m?[e.decodeKey(a),""]:[e.decodeKey(a.slice(0,m)),e.decodeValue(a.slice(m+1))],j=t.get(T)||[];j.push(z),t.set(T,j)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],a=Array.isArray(n)?n.map(av):[av(n)];this.map.set(t,a)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const a=e[n];Array.isArray(a)?a.forEach(m=>{t.push({param:n,value:m,op:"a"})}):t.push({param:n,value:a,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new mu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(av(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const a=n.indexOf(av(e.value));-1!==a&&n.splice(a,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class eN{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function uA(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function pA(i){return typeof Blob<"u"&&i instanceof Blob}function mA(i){return typeof FormData<"u"&&i instanceof FormData}class Yx{constructor(e,t,n,a){let m;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function iN(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||a?(this.body=void 0!==n?n:null,m=a):m=n,m&&(this.reportProgress=!!m.reportProgress,this.withCredentials=!!m.withCredentials,m.responseType&&(this.responseType=m.responseType),m.headers&&(this.headers=m.headers),m.context&&(this.context=m.context),m.params&&(this.params=m.params)),this.headers||(this.headers=new ld),this.context||(this.context=new eN),this.params){const T=this.params.toString();if(0===T.length)this.urlWithParams=t;else{const z=t.indexOf("?");this.urlWithParams=t+(-1===z?"?":z<t.length-1?"&":"")+T}}else this.params=new mu,this.urlWithParams=t}serializeBody(){return null===this.body?null:uA(this.body)||pA(this.body)||mA(this.body)||function nN(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof mu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||mA(this.body)?null:pA(this.body)?this.body.type||null:uA(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof mu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,a=e.responseType||this.responseType,m=void 0!==e.body?e.body:this.body,T=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,z=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let j=e.headers||this.headers,Z=e.params||this.params;const st=e.context??this.context;return void 0!==e.setHeaders&&(j=Object.keys(e.setHeaders).reduce((Mt,Wt)=>Mt.set(Wt,e.setHeaders[Wt]),j)),e.setParams&&(Z=Object.keys(e.setParams).reduce((Mt,Wt)=>Mt.set(Wt,e.setParams[Wt]),Z)),new Yx(t,n,m,{params:Z,headers:j,context:st,reportProgress:z,responseType:a,withCredentials:T})}}var Tr=(()=>((Tr=Tr||{})[Tr.Sent=0]="Sent",Tr[Tr.UploadProgress=1]="UploadProgress",Tr[Tr.ResponseHeader=2]="ResponseHeader",Tr[Tr.DownloadProgress=3]="DownloadProgress",Tr[Tr.Response=4]="Response",Tr[Tr.User=5]="User",Tr))();class tM{constructor(e,t=200,n="OK"){this.headers=e.headers||new ld,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class eM extends tM{constructor(e={}){super(e),this.type=Tr.ResponseHeader}clone(e={}){return new eM({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class lv extends tM{constructor(e={}){super(e),this.type=Tr.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new lv({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class fA extends tM{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function iM(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let Lf=(()=>{class i{constructor(t){this.handler=t}request(t,n,a={}){let m;if(t instanceof Yx)m=t;else{let j,Z;j=a.headers instanceof ld?a.headers:new ld(a.headers),a.params&&(Z=a.params instanceof mu?a.params:new mu({fromObject:a.params})),m=new Yx(t,n,void 0!==a.body?a.body:null,{headers:j,context:a.context,params:Z,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials})}const T=Cn(m).pipe(cu(j=>this.handler.handle(j)));if(t instanceof Yx||"events"===a.observe)return T;const z=T.pipe(Yr(j=>j instanceof lv));switch(a.observe||"body"){case"body":switch(m.responseType){case"arraybuffer":return z.pipe(Kt(j=>{if(null!==j.body&&!(j.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return j.body}));case"blob":return z.pipe(Kt(j=>{if(null!==j.body&&!(j.body instanceof Blob))throw new Error("Response is not a Blob.");return j.body}));case"text":return z.pipe(Kt(j=>{if(null!==j.body&&"string"!=typeof j.body)throw new Error("Response is not a string.");return j.body}));default:return z.pipe(Kt(j=>j.body))}case"response":return z;default:throw new Error(`Unreachable: unhandled observe type ${a.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new mu).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,a={}){return this.request("PATCH",t,iM(a,n))}post(t,n,a={}){return this.request("POST",t,iM(a,n))}put(t,n,a={}){return this.request("PUT",t,iM(a,n))}}return i.\u0275fac=function(t){return new(t||i)(fi(rv))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function gA(i,e){return e(i)}function sN(i,e){return(t,n)=>e.intercept(t,{handle:a=>i(a,n)})}const rN=new Bi("HTTP_INTERCEPTORS"),Hx=new Bi("HTTP_INTERCEPTOR_FNS");function aN(){let i=null;return(e,t)=>(null===i&&(i=(Fn(rN,{optional:!0})??[]).reduceRight(sN,gA)),i(e,t))}let xA=(()=>{class i extends rv{constructor(t,n){super(),this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=Array.from(new Set(this.injector.get(Hx)));this.chain=n.reduceRight((a,m)=>function oN(i,e,t){return(n,a)=>t.runInContext(()=>e(n,m=>i(m,a)))}(a,m,this.injector),gA)}return this.chain(t,n=>this.backend.handle(n))}}return i.\u0275fac=function(t){return new(t||i)(fi(qw),fi(Dl))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const dN=/^\)\]\}',?\n/;let _A=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new ln(n=>{const a=this.xhrFactory.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((qt,pe)=>a.setRequestHeader(qt,pe.join(","))),t.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const qt=t.detectContentTypeHeader();null!==qt&&a.setRequestHeader("Content-Type",qt)}if(t.responseType){const qt=t.responseType.toLowerCase();a.responseType="json"!==qt?qt:"text"}const m=t.serializeBody();let T=null;const z=()=>{if(null!==T)return T;const qt=a.statusText||"OK",pe=new ld(a.getAllResponseHeaders()),Me=function uN(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(a)||t.url;return T=new eM({headers:pe,status:a.status,statusText:qt,url:Me}),T},j=()=>{let{headers:qt,status:pe,statusText:Me,url:Xe}=z(),He=null;204!==pe&&(He=typeof a.response>"u"?a.responseText:a.response),0===pe&&(pe=He?200:0);let Ai=pe>=200&&pe<300;if("json"===t.responseType&&"string"==typeof He){const ii=He;He=He.replace(dN,"");try{He=""!==He?JSON.parse(He):null}catch(dn){He=ii,Ai&&(Ai=!1,He={error:dn,text:He})}}Ai?(n.next(new lv({body:He,headers:qt,status:pe,statusText:Me,url:Xe||void 0})),n.complete()):n.error(new fA({error:He,headers:qt,status:pe,statusText:Me,url:Xe||void 0}))},Z=qt=>{const{url:pe}=z(),Me=new fA({error:qt,status:a.status||0,statusText:a.statusText||"Unknown Error",url:pe||void 0});n.error(Me)};let st=!1;const Mt=qt=>{st||(n.next(z()),st=!0);let pe={type:Tr.DownloadProgress,loaded:qt.loaded};qt.lengthComputable&&(pe.total=qt.total),"text"===t.responseType&&a.responseText&&(pe.partialText=a.responseText),n.next(pe)},Wt=qt=>{let pe={type:Tr.UploadProgress,loaded:qt.loaded};qt.lengthComputable&&(pe.total=qt.total),n.next(pe)};return a.addEventListener("load",j),a.addEventListener("error",Z),a.addEventListener("timeout",Z),a.addEventListener("abort",Z),t.reportProgress&&(a.addEventListener("progress",Mt),null!==m&&a.upload&&a.upload.addEventListener("progress",Wt)),a.send(m),n.next({type:Tr.Sent}),()=>{a.removeEventListener("error",Z),a.removeEventListener("abort",Z),a.removeEventListener("load",j),a.removeEventListener("timeout",Z),t.reportProgress&&(a.removeEventListener("progress",Mt),null!==m&&a.upload&&a.upload.removeEventListener("progress",Wt)),a.readyState!==a.DONE&&a.abort()}})}}return i.\u0275fac=function(t){return new(t||i)(fi(Ck))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();const nM=new Bi("XSRF_ENABLED"),vA=new Bi("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),bA=new Bi("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class wA{}let fN=(()=>{class i{constructor(t,n,a){this.doc=t,this.platform=n,this.cookieName=a,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=dk(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return i.\u0275fac=function(t){return new(t||i)(fi(so),fi(u0),fi(vA))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();function gN(i,e){const t=i.url.toLowerCase();if(!Fn(nM)||"GET"===i.method||"HEAD"===i.method||t.startsWith("http://")||t.startsWith("https://"))return e(i);const n=Fn(wA).getToken(),a=Fn(bA);return null!=n&&!i.headers.has(a)&&(i=i.clone({headers:i.headers.set(a,n)})),e(i)}var cr=(()=>((cr=cr||{})[cr.Interceptors=0]="Interceptors",cr[cr.LegacyInterceptors=1]="LegacyInterceptors",cr[cr.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",cr[cr.NoXsrfProtection=3]="NoXsrfProtection",cr[cr.JsonpSupport=4]="JsonpSupport",cr[cr.RequestsMadeViaParent=5]="RequestsMadeViaParent",cr))();function Bf(i,e){return{\u0275kind:i,\u0275providers:e}}function xN(...i){const e=[Lf,_A,xA,{provide:rv,useExisting:xA},{provide:qw,useExisting:_A},{provide:Hx,useValue:gN,multi:!0},{provide:nM,useValue:!0},{provide:wA,useClass:fN}];for(const t of i)e.push(...t.\u0275providers);return function s_(i){return{\u0275providers:i}}(e)}const MA=new Bi("LEGACY_INTERCEPTOR_FN");let _N=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({providers:[xN(Bf(cr.LegacyInterceptors,[{provide:MA,useFactory:aN},{provide:Hx,useExisting:MA,multi:!0}]))]}),i})(),vN=(()=>{class i{constructor(t,n){this.http=t,this.elementRef=n,this.style="mapbox://styles/mapbox/light-v11",this.features=[],this.lng=146.85154486433777,this.lat=-36.11139140897592}loadMapData(){this.http.get(`${Ux_backendURL}/buildings`).subscribe(t=>{for(let n=0;n<t.length;n++){let a=t[n].coordinates;this.features.push({type:"Feature",properties:{description:`<strong>${t[n].name}</strong><p>Campus ${t[n].campus}</p><p><a style="color: green" href="chart/${t[n].id}">Chart</a></p>`,color:"#232323"},geometry:{type:"Point",coordinates:[a.coordinates[0],a.coordinates[1]]}})}})}ngOnInit(){this.map=new Qw.Map({accessToken:Ux_mapbox_publicToken,container:"map",style:this.style,zoom:15,center:[this.lng,this.lat]}),this.loadMapData(),this.map.on("load",()=>{this.map.addSource("places",{type:"geojson",data:{type:"FeatureCollection",features:this.features}}),this.map.addLayer({id:"places",source:"places",type:"circle",paint:{"circle-color":"#4264fb","circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),this.map.on("click","places",t=>{(new Qw.Popup).setLngLat(t.lngLat).setHTML(t.features[0].properties.description).addTo(this.map)}),this.map.on("mouseenter","places",()=>{this.map.getCanvas().style.cursor="pointer"}),this.map.on("mouseleave","places",()=>{this.map.getCanvas().style.cursor=""})})}}return i.\u0275fac=function(t){return new(t||i)(Ee(Lf),Ee(to))},i.\u0275cmp=po({type:i,selectors:[["app-map"]],decls:1,vars:0,consts:[["id","map",1,"map","match-parent"]],template:function(t,n){1&t&&An(0,"div",0)},styles:[".match-parent[_ngcontent-%COMP%]{width:100%;height:calc(100% - 64px)}.mapboxgl-popup[_ngcontent-%COMP%]{max-width:400px;font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif}#fly[_ngcontent-%COMP%]{display:block;position:relative;margin:0 auto;width:50%;height:40px;padding:10px;border:none;border-radius:3px;font-size:12px;text-align:center;color:#fff;background:#ee8a65}"]}),i})();var bN=ia(836);let CA=(()=>{class i{constructor(){this.shouldUpdateChart=!1,this.stockChartInstance=new lo,this.options=this.options?this.options:{},this.styles=this.styles?this.styles:{width:"100%",position:"relative"},this.styles.height=this.options.height?this.options.height+"px":"400px",this.stockChartContainerId="canvasjs-angular-stockchart-container-"+i._cjsStockChartContainerId++}ngDoCheck(){this.prevStockChartOptions!=this.options&&(this.shouldUpdateChart=!0)}ngOnChanges(){this.shouldUpdateChart&&this.stockChart&&(this.stockChart.options=this.options,this.stockChart.render(),this.shouldUpdateChart=!1,this.prevStockChartOptions=this.options)}ngAfterViewInit(){this.stockChart=new bN.StockChart(this.stockChartContainerId,this.options),this.prevStockChartOptions=this.options,this.stockChartInstance.emit(this.stockChart)}ngOnDestroy(){this.stockChart&&this.stockChart.destroy()}}return i._cjsStockChartContainerId=0,i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=po({type:i,selectors:[["canvasjs-stockchart"]],inputs:{options:"options",styles:"styles"},outputs:{stockChartInstance:"stockChartInstance"},features:[er],decls:1,vars:2,consts:[[3,"id","ngStyle"]],template:function(t,n){1&t&&An(0,"div",0),2&t&&(Ea("id",n.stockChartContainerId),Ln("ngStyle",n.styles))},dependencies:[aw],encapsulation:2}),i})();const wN=function(){return{width:"100%",height:"100%"}},MN=[{path:"",children:[{path:"",component:vN},{path:"chart/:buildingId",component:(()=>{class i{constructor(t,n){this.http=t,this.route=n,this.buildingId=1,this.name="Energy Consumption",this.peak=0,this.average=0,this.chartData=[],this.chartOptions={charts:[{data:[{}]}]}}ngOnInit(){this.route.params.subscribe(t=>{this.buildingId=t.buildingId}),this.http.get(`${Ux_backendURL}/buildings/${this.buildingId}`).subscribe(t=>{t&&(this.name=t[0].name)}),this.http.get(`${Ux_backendURL}/data/${this.buildingId}`).subscribe(t=>{for(let m=0;m<t.length;m++)this.chartData.push({x:new Date(t[m].date),y:t[m].consumption}),t[m].consumption>this.peak&&(this.peak=t[m].consumption),this.average+=t[m].consumption/t.length;const n=new Date(t[t.length-1].date),a=new Date(t[t.length-1].date);n.setDate(n.getDate()-30),this.chartOptions={title:{text:this.name},subtitles:[{text:`Peak: ${Math.round(1e4*(this.peak+Number.EPSILON))/1e4} kWh / Average Consumption: ${Math.round(1e4*(this.average+Number.EPSILON))/1e4} kWh`}],theme:"light2",animationEnabled:!0,toolTip:{enabled:!0,content:"{y} kWh"},charts:[{data:[{color:"#31c48d",type:"line",dataPoints:this.chartData}]}],navigator:{slider:{maskColor:"#31c48d",minimum:n,maximum:a}}}})}}return i.\u0275fac=function(t){return new(t||i)(Ee(Lf),Ee(Op))},i.\u0275cmp=po({type:i,selectors:[["app-chart"]],decls:2,vars:3,consts:[[3,"options","styles"]],template:function(t,n){1&t&&(Pn(0,"div"),An(1,"canvasjs-stockchart",0),Nn()),2&t&&(To(1),Ln("options",n.chartOptions)("styles",function YT(i,e,t){const n=gr()+i,a=gi();return a[n]===es?de(a,n,t?e.call(t):e()):function ce(i,e){return i[e]}(a,n)}(2,wN)))},dependencies:[CA]}),i})()}]}];let CN=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[hA.forRoot(MN),hA]}),i})();function Hr(i){return null!=i&&"false"!=`${i}`}function hv(i,e=0){return function TN(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}(i)?Number(i):e}function TA(i){return Array.isArray(i)?i:[i]}function Rp(i){return i instanceof to?i.nativeElement:i}function SA(i){return Yr((e,t)=>i<=t)}class SN extends De{constructor(e,t){super()}schedule(e,t=0){return this}}const cv={setInterval(i,e,...t){const{delegate:n}=cv;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=cv;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};class sM extends SN{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const a=this.id,m=this.scheduler;return null!=a&&(this.id=this.recycleAsyncId(m,a,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(m,this.id,t),this}requestAsyncId(e,t,n=0){return cv.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&cv.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let a,n=!1;try{this.work(e)}catch(m){n=!0,a=m||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),a}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,b(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const oM={now:()=>(oM.delegate||Date).now(),delegate:void 0};class $x{constructor(e,t=$x.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}$x.now=oM.now;class rM extends $x{constructor(e,t=$x.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const aM=new rM(sM),kN=aM;function dv(i,e=aM){return at((t,n)=>{let a=null,m=null,T=null;const z=()=>{if(a){a.unsubscribe(),a=null;const Z=m;m=null,n.next(Z)}};function j(){const Z=T+i,st=e.now();if(st<Z)return a=this.schedule(void 0,Z-st),void n.add(a);z()}t.subscribe(rt(n,Z=>{m=Z,T=e.now(),a||(a=e.schedule(j,i),n.add(a))},()=>{z(),n.complete()},void 0,()=>{m=a=null}))})}function Ja(i){return at((e,t)=>{pt(i).subscribe(rt(t,()=>t.complete(),Et)),!t.closed&&e.subscribe(t)})}let lM;try{lM=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lM=!1}let Gx,pv,Vp,hM,fl=(()=>{class i{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function mO(i){return i===wk}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!lM)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return i.\u0275fac=function(t){return new(t||i)(fi(u0))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function uv(i){return function AN(){if(null==Gx&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Gx=!0}))}finally{Gx=Gx||!1}return Gx}()?i:!!i.capture}function Zx(){if("object"!=typeof document||!document)return 0;if(null==pv){const i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),pv=0,0===i.scrollLeft&&(i.scrollLeft=1,pv=0===i.scrollLeft?1:2),i.remove()}return pv}function Rf(i){return i.composedPath?i.composedPath()[0]:i.target}let LN=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({}),i})();const AA=new Set;let Vf,BN=(()=>{class i{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):RN}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function ON(i){if(!AA.has(i))try{Vf||(Vf=document.createElement("style"),Vf.setAttribute("type","text/css"),document.head.appendChild(Vf)),Vf.sheet&&(Vf.sheet.insertRule(`@media ${i} {body{ }}`,0),AA.add(i))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return i.\u0275fac=function(t){return new(t||i)(fi(fl))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function RN(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let PA=(()=>{class i{constructor(t,n){this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new oe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return EA(TA(t)).some(a=>this._registerQuery(a).mql.matches)}observe(t){let m=bw(EA(TA(t)).map(T=>this._registerQuery(T).observable));return m=B0(m.pipe(_h(1)),m.pipe(SA(1),dv(0))),m.pipe(Kt(T=>{const z={matches:!1,breakpoints:{}};return T.forEach(({matches:j,query:Z})=>{z.matches=z.matches||j,z.breakpoints[Z]=j}),z}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const n=this._mediaMatcher.matchMedia(t),m={observable:new ln(T=>{const z=j=>this._zone.run(()=>T.next(j));return n.addListener(z),()=>{n.removeListener(z)}}).pipe(O0(n),Kt(({matches:T})=>({query:t,matches:T})),Ja(this._destroySubject)),mql:n};return this._queries.set(t,m),m}}return i.\u0275fac=function(t){return new(t||i)(fi(BN),fi(us))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function EA(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class zN extends oe{constructor(e=1/0,t=1/0,n=oM){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:a,_timestampProvider:m,_windowTime:T}=this;t||(n.push(e),!a&&n.push(m.now()+T)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:a}=this,m=a.slice();for(let T=0;T<m.length&&!e.closed;T+=n?1:2)e.next(m[T]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:a}=this,m=(a?1:2)*e;if(e<1/0&&m<n.length&&n.splice(0,n.length-m),!a){const T=t.now();let z=0;for(let j=1;j<n.length&&n[j]<=T;j+=2)z=j;z&&n.splice(0,z+1)}}}function IA(i,e=Ri){return i=i??l3,at((t,n)=>{let a,m=!0;t.subscribe(rt(n,T=>{const z=e(T);(m||!i(a,z))&&(m=!1,a=z,n.next(T))}))})}function l3(i,e){return i===e}let BA=(()=>{class i{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function m3(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const n=function p3(i){try{return i.frameElement}catch{return null}}(function w3(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(t));if(n&&(-1===RA(n)||!this.isVisible(n)))return!1;let a=t.nodeName.toLowerCase(),m=RA(t);return t.hasAttribute("contenteditable")?-1!==m:!("iframe"===a||"object"===a||this._platform.WEBKIT&&this._platform.IOS&&!function v3(i){let e=i.nodeName.toLowerCase(),t="input"===e&&i.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===a?!!t.hasAttribute("controls")&&-1!==m:"video"===a?-1!==m&&(null!==m||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,n){return function b3(i){return!function g3(i){return function y3(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function f3(i){let e=i.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(i)||function x3(i){return function _3(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||OA(i))}(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}}return i.\u0275fac=function(t){return new(t||i)(fi(fl))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function OA(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let e=i.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function RA(i){if(!OA(i))return null;const e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class M3{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,n,a,m=!1){this._element=e,this._checker=t,this._ngZone=n,this._document=a,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,m||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=0;n<t.length;n++){const a=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(a)return a}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let n=t.length-1;n>=0;n--){const a=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(a)return a}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(_h(1)).subscribe(e)}}let C3=(()=>{class i{constructor(t,n,a){this._checker=t,this._ngZone=n,this._document=a}create(t,n=!1){return new M3(t,this._checker,this._ngZone,this._document,n)}}return i.\u0275fac=function(t){return new(t||i)(fi(BA),fi(us),fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function VA(i){return 0===i.buttons||0===i.offsetX&&0===i.offsetY}function zA(i){const e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const T3=new Bi("cdk-input-modality-detector-options"),S3={ignoreKeys:[18,17,224,91,16]},zf=uv({passive:!0,capture:!0});let k3=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(t,n,a,m){this._platform=t,this._mostRecentTarget=null,this._modality=new Nl(null),this._lastTouchMs=0,this._onKeydown=T=>{this._options?.ignoreKeys?.some(z=>z===T.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Rf(T))},this._onMousedown=T=>{Date.now()-this._lastTouchMs<650||(this._modality.next(VA(T)?"keyboard":"mouse"),this._mostRecentTarget=Rf(T))},this._onTouchstart=T=>{zA(T)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Rf(T))},this._options={...S3,...m},this.modalityDetected=this._modality.pipe(SA(1)),this.modalityChanged=this.modalityDetected.pipe(IA()),t.isBrowser&&n.runOutsideAngular(()=>{a.addEventListener("keydown",this._onKeydown,zf),a.addEventListener("mousedown",this._onMousedown,zf),a.addEventListener("touchstart",this._onTouchstart,zf)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,zf),document.removeEventListener("mousedown",this._onMousedown,zf),document.removeEventListener("touchstart",this._onTouchstart,zf))}}return i.\u0275fac=function(t){return new(t||i)(fi(fl),fi(us),fi(so),fi(T3,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const P3=new Bi("cdk-focus-monitor-default-options"),mv=uv({passive:!0,capture:!0});let WA=(()=>{class i{constructor(t,n,a,m,T){this._ngZone=t,this._platform=n,this._inputModalityDetector=a,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new oe,this._rootNodeFocusAndBlurListener=z=>{for(let Z=Rf(z);Z;Z=Z.parentElement)"focus"===z.type?this._onFocus(z,Z):this._onBlur(z,Z)},this._document=m,this._detectionMode=T?.detectionMode||0}monitor(t,n=!1){const a=Rp(t);if(!this._platform.isBrowser||1!==a.nodeType)return Cn(null);const m=function DN(i){if(function EN(){if(null==hM){const i=typeof document<"u"?document.head:null;hM=!(!i||!i.createShadowRoot&&!i.attachShadow)}return hM}()){const e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(a)||this._getDocument(),T=this._elementInfo.get(a);if(T)return n&&(T.checkChildren=!0),T.subject;const z={checkChildren:n,subject:new oe,rootNode:m};return this._elementInfo.set(a,z),this._registerGlobalListeners(z),z.subject}stopMonitoring(t){const n=Rp(t),a=this._elementInfo.get(n);a&&(a.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(a))}focusVia(t,n,a){const m=Rp(t);m===this._getDocument().activeElement?this._getClosestElementsInfo(m).forEach(([z,j])=>this._originChanged(z,n,j)):(this._setOrigin(n),"function"==typeof m.focus&&m.focus(a))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused","touch"===n),t.classList.toggle("cdk-keyboard-focused","keyboard"===n),t.classList.toggle("cdk-mouse-focused","mouse"===n),t.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&n,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,n){const a=this._elementInfo.get(n),m=Rf(t);!a||!a.checkChildren&&n!==m||this._originChanged(n,this._getFocusOrigin(m),a)}_onBlur(t,n){const a=this._elementInfo.get(n);!a||a.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(a,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const n=t.rootNode,a=this._rootNodeFocusListenerCount.get(n)||0;a||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,mv),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,mv)}),this._rootNodeFocusListenerCount.set(n,a+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Ja(this._stopInputModalityDetector)).subscribe(m=>{this._setOrigin(m,!0)}))}_removeGlobalListeners(t){const n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const a=this._rootNodeFocusListenerCount.get(n);a>1?this._rootNodeFocusListenerCount.set(n,a-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,mv),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,mv),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,a){this._setClasses(t,n),this._emitOrigin(a,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){const n=[];return this._elementInfo.forEach((a,m)=>{(m===t||a.checkChildren&&m.contains(t))&&n.push([m,a])}),n}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:n,mostRecentModality:a}=this._inputModalityDetector;if("mouse"!==a||!n||n===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const m=t.labels;if(m)for(let T=0;T<m.length;T++)if(m[T].contains(n))return!0;return!1}}return i.\u0275fac=function(t){return new(t||i)(fi(us),fi(fl),fi(k3),fi(so,8),fi(P3,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const XA="cdk-high-contrast-black-on-white",jA="cdk-high-contrast-white-on-black",dM="cdk-high-contrast-active";let E3=(()=>{class i{constructor(t,n){this._platform=t,this._document=n,this._breakpointSubscription=Fn(PA).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const n=this._document.defaultView||window,a=n&&n.getComputedStyle?n.getComputedStyle(t):null,m=(a&&a.backgroundColor||"").replace(/ /g,"");switch(t.remove(),m){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(dM,XA,jA),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();1===n?t.add(dM,XA):2===n&&t.add(dM,jA)}}}return i.\u0275fac=function(t){return new(t||i)(fi(fl),fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const D3=new Bi("cdk-dir-doc",{providedIn:"root",factory:function I3(){return Fn(so)}}),F3=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let UA=(()=>{class i{constructor(t){this.value="ltr",this.change=new lo,t&&(this.value=function L3(i){const e=i?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?F3.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return i.\u0275fac=function(t){return new(t||i)(fi(D3,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),YA=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({}),i})();const O3=new Bi("mat-sanity-checks",{providedIn:"root",factory:function B3(){return!0}});let pa=(()=>{class i{constructor(t,n,a){this._sanityChecks=n,this._document=a,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function FN(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return i.\u0275fac=function(t){return new(t||i)(fi(E3),fi(O3,8),fi(so))},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[YA,YA]}),i})();function R3(i){return class extends i{get disabled(){return this._disabled}set disabled(e){this._disabled=Hr(e)}constructor(...e){super(...e),this._disabled=!1}}}function uM(i,e){return class extends i{get color(){return this._color}set color(t){const n=t||this.defaultColor;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),n&&this._elementRef.nativeElement.classList.add(`mat-${n}`),this._color=n)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function V3(i){return class extends i{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Hr(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class N3{constructor(e,t,n,a=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=a,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const GA=uv({passive:!0,capture:!0});class W3{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Rf(e);t&&this._events.get(e.type)?.forEach((n,a)=>{(a===t||a.contains(t))&&n.forEach(m=>m.handleEvent(e))})}}addHandler(e,t,n,a){const m=this._events.get(t);if(m){const T=m.get(n);T?T.add(a):m.set(n,new Set([a]))}else this._events.set(t,new Map([[n,new Set([a])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,GA)})}removeHandler(e,t,n){const a=this._events.get(e);if(!a)return;const m=a.get(t);m&&(m.delete(n),0===m.size&&a.delete(t),0===a.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,GA)))}}const ZA={enterDuration:225,exitDuration:150},KA=uv({passive:!0,capture:!0}),JA=["mousedown","touchstart"],QA=["mouseup","mouseleave","touchend","touchcancel"];class Nf{constructor(e,t,n,a){this._target=e,this._ngZone=t,this._platform=a,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,a.isBrowser&&(this._containerElement=Rp(n))}fadeInRipple(e,t,n={}){const a=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),m={...ZA,...n.animation};n.centered&&(e=a.left+a.width/2,t=a.top+a.height/2);const T=n.radius||function j3(i,e,t){const n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),a=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+a*a)}(e,t,a),z=e-a.left,j=t-a.top,Z=m.enterDuration,st=document.createElement("div");st.classList.add("mat-ripple-element"),st.style.left=z-T+"px",st.style.top=j-T+"px",st.style.height=2*T+"px",st.style.width=2*T+"px",null!=n.color&&(st.style.backgroundColor=n.color),st.style.transitionDuration=`${Z}ms`,this._containerElement.appendChild(st);const Mt=window.getComputedStyle(st),qt=Mt.transitionDuration,pe="none"===Mt.transitionProperty||"0s"===qt||"0s, 0s"===qt||0===a.width&&0===a.height,Me=new N3(this,st,n,pe);st.style.transform="scale3d(1, 1, 1)",Me.state=0,n.persistent||(this._mostRecentTransientRipple=Me);let Xe=null;return!pe&&(Z||m.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const He=()=>this._finishRippleTransition(Me),Ai=()=>this._destroyRipple(Me);st.addEventListener("transitionend",He),st.addEventListener("transitioncancel",Ai),Xe={onTransitionEnd:He,onTransitionCancel:Ai}}),this._activeRipples.set(Me,Xe),(pe||!Z)&&this._finishRippleTransition(Me),Me}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,n={...ZA,...e.config.animation};t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Rp(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,JA.forEach(n=>{Nf._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{QA.forEach(t=>{this._triggerElement.addEventListener(t,this,KA)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=1,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=VA(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!zA(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(JA.forEach(t=>Nf._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&QA.forEach(t=>e.removeEventListener(t,this,KA)))}}Nf._eventManager=new W3;const pM=new Bi("mat-ripple-global-options");let mM=(()=>{class i{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,n,a,m,T){this._elementRef=t,this._animationMode=T,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=m||{},this._rippleRenderer=new Nf(this,n,t,a)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,a){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,n,{...this.rippleConfig,...a}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(us),Ee(fl),Ee(pM,8),Ee(Ep,8))},i.\u0275dir=Ji({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,n){2&t&&ar("mat-ripple-unbounded",n.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),i})(),fM=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,pa]}),i})(),U3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa]}),i})();const Y3=["*",[["mat-toolbar-row"]]],H3=["*","mat-toolbar-row"],$3=uM(class{constructor(i){this._elementRef=i}});let G3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ji({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),i})(),Z3=(()=>{class i extends $3{constructor(t,n,a){super(t),this._platform=n,this._document=a}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(fl),Ee(so))},i.\u0275cmp=po({type:i,selectors:[["mat-toolbar"]],contentQueries:function(t,n,a){if(1&t&&Rl(a,G3,5),2&t){let m;jr(m=Ur())&&(n._toolbarRows=m)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,n){2&t&&ar("mat-toolbar-multiple-rows",n._toolbarRows.length>0)("mat-toolbar-single-row",0===n._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[r],ngContentSelectors:H3,decls:2,vars:0,template:function(t,n){1&t&&(Dr(Y3),no(0),no(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color: inherit;--mdc-outlined-button-label-text-color: inherit}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),i})(),K3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,pa]}),i})();const Q3=["mat-icon-button",""],q3=["*"],t5=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],e5=uM(R3(V3(class{constructor(i){this._elementRef=i}})));let i5=(()=>{class i extends e5{constructor(t,n,a,m){super(t),this._platform=n,this._ngZone=a,this._animationMode=m,this._focusMonitor=Fn(WA),this._isFab=!1;const T=t.nativeElement.classList;for(const z of t5)this._hasHostAttributes(z.selector)&&z.mdcClasses.forEach(j=>{T.add(j)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",n){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,n):this._elementRef.nativeElement.focus(n)}_hasHostAttributes(...t){return t.some(n=>this._elementRef.nativeElement.hasAttribute(n))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return i.\u0275fac=function(t){Jc()},i.\u0275dir=Ji({type:i,viewQuery:function(t,n){if(1&t&&Pp(mM,5),2&t){let a;jr(a=Ur())&&(n.ripple=a.first)}},features:[r]}),i})(),o5=(()=>{class i extends i5{constructor(t,n,a,m){super(t,n,a,m)}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(fl),Ee(us),Ee(Ep,8))},i.\u0275cmp=po({type:i,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,n){2&t&&(Ae("disabled",n.disabled||null),ar("_mat-animation-noopable","NoopAnimations"===n._animationMode)("mat-unthemed",!n.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[r],attrs:Q3,ngContentSelectors:q3,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,n){1&t&&(Dr(),An(0,"span",0),no(1),An(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(To(3),Ln("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",n._elementRef.nativeElement))},dependencies:[mM],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),i})(),r5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,fM,pa]}),i})();const a5=["addListener","removeListener"],l5=["addEventListener","removeEventListener"],h5=["on","off"];function Jx(i,e,t,n){if(ss(t)&&(n=t,t=void 0),n)return Jx(i,e,t).pipe(vw(n));const[a,m]=function u5(i){return ss(i.addEventListener)&&ss(i.removeEventListener)}(i)?l5.map(T=>z=>i[T](e,z,t)):function c5(i){return ss(i.addListener)&&ss(i.removeListener)}(i)?a5.map(qA(i,e)):function d5(i){return ss(i.on)&&ss(i.off)}(i)?h5.map(qA(i,e)):[];if(!a&&Ct(i))return x(T=>Jx(T,e,t))(pt(i));if(!a)throw new TypeError("Invalid event target");return new ln(T=>{const z=(...j)=>T.next(1<j.length?j:j[0]);return a(z),()=>m(z)})}function qA(i,e){return t=>n=>i[t](e,n)}const Qx={schedule(i){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:n}=Qx;n&&(e=n.requestAnimationFrame,t=n.cancelAnimationFrame);const a=e(m=>{t=void 0,i(m)});return new De(()=>t?.(a))},requestAnimationFrame(...i){const{delegate:e}=Qx;return(e?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:e}=Qx;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};new class m5 extends rM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let a;e=e||n.shift();do{if(a=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,a){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw a}}}(class p5 extends sM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=Qx.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,n=0){var a;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(e,t,n);const{actions:m}=e;null!=t&&(null===(a=m[m.length-1])||void 0===a?void 0:a.id)!==t&&(Qx.cancelAnimationFrame(t),e._scheduled=void 0)}});let gM,g5=1;const fv={};function tP(i){return i in fv&&(delete fv[i],!0)}const x5={setImmediate(i){const e=g5++;return fv[e]=!0,gM||(gM=Promise.resolve()),gM.then(()=>tP(e)&&i()),e},clearImmediate(i){tP(i)}},{setImmediate:y5,clearImmediate:_5}=x5,gv={setImmediate(...i){const{delegate:e}=gv;return(e?.setImmediate||y5)(...i)},clearImmediate(i){const{delegate:e}=gv;return(e?.clearImmediate||_5)(i)},delegate:void 0};new class b5 extends rM{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let a;e=e||n.shift();do{if(a=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,a){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw a}}}(class v5 extends sM{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e._scheduled||(e._scheduled=gv.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,n=0){var a;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(e,t,n);const{actions:m}=e;null!=t&&(null===(a=m[m.length-1])||void 0===a?void 0:a.id)!==t&&(gv.clearImmediate(t),e._scheduled=void 0)}});function eP(i,e=aM){return function M5(i){return at((e,t)=>{let n=!1,a=null,m=null,T=!1;const z=()=>{if(m?.unsubscribe(),m=null,n){n=!1;const Z=a;a=null,t.next(Z)}T&&t.complete()},j=()=>{m=null,T&&t.complete()};e.subscribe(rt(t,Z=>{n=!0,a=Z,m||pt(i(Z)).subscribe(m=rt(t,z,j))},()=>{T=!0,(!n||!m||m.closed)&&t.complete()}))})}(()=>function T5(i=0,e,t=kN){let n=-1;return null!=e&&(f(e)?t=e:n=e),new ln(a=>{let m=function C5(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;m<0&&(m=0);let T=0;return t.schedule(function(){a.closed||(a.next(T++),0<=n?this.schedule(void 0,n):a.complete())},m)})}(i,e))}let xM=(()=>{class i{constructor(t,n,a){this._ngZone=t,this._platform=n,this._scrolled=new oe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=a}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new ln(n=>{this._globalSubscription||this._addGlobalListener();const a=t>0?this._scrolled.pipe(eP(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{a.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Cn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){const a=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(Yr(m=>!m||a.indexOf(m)>-1))}getAncestorScrollContainers(t){const n=[];return this.scrollContainers.forEach((a,m)=>{this._scrollableContainsElement(m,t)&&n.push(m)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,n){let a=Rp(n),m=t.getElementRef().nativeElement;do{if(a==m)return!0}while(a=a.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Jx(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return i.\u0275fac=function(t){return new(t||i)(fi(us),fi(fl),fi(so,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),qx=(()=>{class i{constructor(t,n,a,m){this.elementRef=t,this.scrollDispatcher=n,this.ngZone=a,this.dir=m,this._destroyed=new oe,this._elementScrolled=new ln(T=>this.ngZone.runOutsideAngular(()=>Jx(this.elementRef.nativeElement,"scroll").pipe(Ja(this._destroyed)).subscribe(T)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const n=this.elementRef.nativeElement,a=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=a?t.end:t.start),null==t.right&&(t.right=a?t.start:t.end),null!=t.bottom&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),a&&0!=Zx()?(null!=t.left&&(t.right=n.scrollWidth-n.clientWidth-t.left),2==Zx()?t.left=t.right:1==Zx()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const n=this.elementRef.nativeElement;!function PN(){if(null==Vp){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Vp=!1,Vp;if("scrollBehavior"in document.documentElement.style)Vp=!0;else{const i=Element.prototype.scrollTo;Vp=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Vp}()?(null!=t.top&&(n.scrollTop=t.top),null!=t.left&&(n.scrollLeft=t.left)):n.scrollTo(t)}measureScrollOffset(t){const n="left",a="right",m=this.elementRef.nativeElement;if("top"==t)return m.scrollTop;if("bottom"==t)return m.scrollHeight-m.clientHeight-m.scrollTop;const T=this.dir&&"rtl"==this.dir.value;return"start"==t?t=T?a:n:"end"==t&&(t=T?n:a),T&&2==Zx()?t==n?m.scrollWidth-m.clientWidth-m.scrollLeft:m.scrollLeft:T&&1==Zx()?t==n?m.scrollLeft+m.scrollWidth-m.clientWidth:-m.scrollLeft:t==n?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(xM),Ee(us),Ee(UA,8))},i.\u0275dir=Ji({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),i})(),A5=(()=>{class i{constructor(t,n,a){this._platform=t,this._change=new oe,this._changeListener=m=>{this._change.next(m)},this._document=a,n.runOutsideAngular(()=>{if(t.isBrowser){const m=this._getWindow();m.addEventListener("resize",this._changeListener),m.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:n,height:a}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+a,right:t.left+n,height:a,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,n=this._getWindow(),a=t.documentElement,m=a.getBoundingClientRect();return{top:-m.top||t.body.scrollTop||n.scrollY||a.scrollTop||0,left:-m.left||t.body.scrollLeft||n.scrollX||a.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(eP(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return i.\u0275fac=function(t){return new(t||i)(fi(fl),fi(us),fi(so,8))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),iP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({}),i})();class nP{}class P5{}const hd="*";function E5(i,e){return{type:7,name:i,definitions:e,options:{}}}function sP(i,e=null){return{type:4,styles:e,timings:i}}function oP(i,e=null){return{type:2,steps:i,options:e}}function xv(i){return{type:6,styles:i,offset:null}}function rP(i,e,t){return{type:0,name:i,styles:e,options:t}}function aP(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function lP(i){Promise.resolve().then(i)}class ty{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){lP(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class hP{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,a=0;const m=this.players.length;0==m?lP(()=>this._onFinish()):this.players.forEach(T=>{T.onDone(()=>{++t==m&&this._onFinish()}),T.onDestroy(()=>{++n==m&&this._onDestroy()}),T.onStart(()=>{++a==m&&this._onStart()})}),this.totalTime=this.players.reduce((T,z)=>Math.max(T,z.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const a=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(a)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const yM="!",yv=["*"],D5=["content"];function I5(i,e){if(1&i){const t=Xo();Pn(0,"div",2),gs("click",function(){return ih(t),nh(Xr()._onBackdropClicked())}),Nn()}2&i&&ar("mat-drawer-shown",Xr()._isShowingBackdrop())}function F5(i,e){1&i&&(Pn(0,"mat-drawer-content"),no(1,2),Nn())}const L5=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],B5=["mat-drawer","mat-drawer-content","*"];function O5(i,e){if(1&i){const t=Xo();Pn(0,"div",2),gs("click",function(){return ih(t),nh(Xr()._onBackdropClicked())}),Nn()}2&i&&ar("mat-drawer-shown",Xr()._isShowingBackdrop())}function R5(i,e){1&i&&(Pn(0,"mat-sidenav-content"),no(1,2),Nn())}const V5=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],z5=["mat-sidenav","mat-sidenav-content","*"],cP={transformDrawer:E5("transform",[rP("open, open-instant",xv({transform:"none",visibility:"visible"})),rP("void",xv({"box-shadow":"none",visibility:"hidden"})),aP("void => open-instant",sP("0ms")),aP("void <=> open, open-instant => void",sP("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},W5=new Bi("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function X5(){return!1}}),_M=new Bi("MAT_DRAWER_CONTAINER");let _v=(()=>{class i extends qx{constructor(t,n,a,m,T){super(a,m,T),this._changeDetectorRef=t,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(t){return new(t||i)(Ee(au),Ee(Ft(()=>uP)),Ee(to),Ee(xM),Ee(us))},i.\u0275cmp=po({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,n){2&t&&lx("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[mo([{provide:qx,useExisting:i}]),r],ngContentSelectors:yv,decls:1,vars:0,template:function(t,n){1&t&&(Dr(),no(0))},encapsulation:2,changeDetection:0}),i})(),dP=(()=>{class i{get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Hr(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=Hr(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Hr(t))}constructor(t,n,a,m,T,z,j,Z){this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=a,this._platform=m,this._ngZone=T,this._interactivityChecker=z,this._doc=j,this._container=Z,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new oe,this._animationEnd=new oe,this._animationState="void",this.openedChange=new lo(!0),this._openedStream=this.openedChange.pipe(Yr(st=>st),Kt(()=>{})),this.openedStart=this._animationStarted.pipe(Yr(st=>st.fromState!==st.toState&&0===st.toState.indexOf("open")),Cw(void 0)),this._closedStream=this.openedChange.pipe(Yr(st=>!st),Kt(()=>{})),this.closedStart=this._animationStarted.pipe(Yr(st=>st.fromState!==st.toState&&"void"===st.toState),Cw(void 0)),this._destroyed=new oe,this.onPositionChanged=new lo,this._modeChanged=new oe,this.openedChange.subscribe(st=>{st?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{Jx(this._elementRef.nativeElement,"keydown").pipe(Yr(st=>27===st.keyCode&&!this.disableClose&&!function cM(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}(st)),Ja(this._destroyed)).subscribe(st=>this._ngZone.run(()=>{this.close(),st.stopPropagation(),st.preventDefault()}))}),this._animationEnd.pipe(IA((st,Mt)=>st.fromState===Mt.fromState&&st.toState===Mt.toState)).subscribe(st=>{const{fromState:Mt,toState:Wt}=st;(0===Wt.indexOf("open")&&"void"===Mt||"void"===Wt&&0===Mt.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const a=()=>{t.removeEventListener("blur",a),t.removeEventListener("mousedown",a),t.removeAttribute("tabindex")};t.addEventListener("blur",a),t.addEventListener("mousedown",a)})),t.focus(n)}_focusByCssSelector(t,n){let a=this._elementRef.nativeElement.querySelector(t);a&&this._forceFocus(a,n)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(n=>{!n&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);const a=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),a}_setOpen(t,n,a){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(a)),this._updateFocusTrapState(),new Promise(m=>{this.openedChange.pipe(_h(1)).subscribe(T=>m(T?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const n=this._elementRef.nativeElement,a=n.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),a.insertBefore(this._anchor,n)),a.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(C3),Ee(WA),Ee(fl),Ee(us),Ee(BA),Ee(so,8),Ee(_M,8))},i.\u0275cmp=po({type:i,selectors:[["mat-drawer"]],viewQuery:function(t,n){if(1&t&&Pp(D5,5),2&t){let a;jr(a=Ur())&&(n._content=a.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,n){1&t&&pl("@transform.start",function(m){return n._animationStarted.next(m)})("@transform.done",function(m){return n._animationEnd.next(m)}),2&t&&(Ae("align",null),d1("@transform",n._animationState),ar("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:yv,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Dr(),Pn(0,"div",0,1),no(2),Nn())},dependencies:[qx],encapsulation:2,data:{animation:[cP.transformDrawer]},changeDetection:0}),i})(),uP=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Hr(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Hr(t)}get scrollable(){return this._userContent||this._content}constructor(t,n,a,m,T,z=!1,j){this._dir=t,this._element=n,this._ngZone=a,this._changeDetectorRef=m,this._animationMode=j,this._drawers=new vf,this.backdropClick=new lo,this._destroyed=new oe,this._doCheckSubject=new oe,this._contentMargins={left:null,right:null},this._contentMarginChanges=new oe,t&&t.change.pipe(Ja(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),T.change().pipe(Ja(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=z}ngAfterContentInit(){this._allDrawers.changes.pipe(O0(this._allDrawers),Ja(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(O0(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(dv(10),Ja(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const a=this._left._getWidth();t+=a,n-=a}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const a=this._right._getWidth();n+=a,t-=a}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Yr(n=>n.fromState!==n.toState),Ja(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(Ja(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t&&t.onPositionChanged.pipe(Ja(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(_h(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(Ja(q(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const n=this._element.nativeElement.classList,a="mat-drawer-container-has-open";t?n.add(a):n.remove(a)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return i.\u0275fac=function(t){return new(t||i)(Ee(UA,8),Ee(to),Ee(us),Ee(au),Ee(A5),Ee(W5),Ee(Ep,8))},i.\u0275cmp=po({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(t,n,a){if(1&t&&(Rl(a,_v,5),Rl(a,dP,5)),2&t){let m;jr(m=Ur())&&(n._content=m.first),jr(m=Ur())&&(n._allDrawers=m)}},viewQuery:function(t,n){if(1&t&&Pp(_v,5),2&t){let a;jr(a=Ur())&&(n._userContent=a.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,n){2&t&&ar("mat-drawer-container-explicit-backdrop",n._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[mo([{provide:_M,useExisting:i}])],ngContentSelectors:B5,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Dr(L5),Dn(0,I5,1,2,"div",0),no(1),no(2,1),Dn(3,F5,2,0,"mat-drawer-content",1)),2&t&&(Ln("ngIf",n.hasBackdrop),To(3),Ln("ngIf",!n._content))},dependencies:[Tx,_v],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),vM=(()=>{class i extends _v{constructor(t,n,a,m,T){super(t,n,a,m,T)}}return i.\u0275fac=function(t){return new(t||i)(Ee(au),Ee(Ft(()=>mP)),Ee(to),Ee(xM),Ee(us))},i.\u0275cmp=po({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,n){2&t&&lx("margin-left",n._container._contentMargins.left,"px")("margin-right",n._container._contentMargins.right,"px")},features:[mo([{provide:qx,useExisting:i}]),r],ngContentSelectors:yv,decls:1,vars:0,template:function(t,n){1&t&&(Dr(),no(0))},encapsulation:2,changeDetection:0}),i})(),pP=(()=>{class i extends dP{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Hr(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=hv(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=hv(t)}}return i.\u0275fac=function(){let e;return function(n){return(e||(e=Ro(i)))(n||i)}}(),i.\u0275cmp=po({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,n){2&t&&(Ae("align",null),lx("top",n.fixedInViewport?n.fixedTopGap:null,"px")("bottom",n.fixedInViewport?n.fixedBottomGap:null,"px"),ar("mat-drawer-end","end"===n.position)("mat-drawer-over","over"===n.mode)("mat-drawer-push","push"===n.mode)("mat-drawer-side","side"===n.mode)("mat-drawer-opened",n.opened)("mat-sidenav-fixed",n.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[r],ngContentSelectors:yv,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,n){1&t&&(Dr(),Pn(0,"div",0,1),no(2),Nn())},dependencies:[qx],encapsulation:2,data:{animation:[cP.transformDrawer]},changeDetection:0}),i})(),mP=(()=>{class i extends uP{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=Ro(i)))(n||i)}}(),i.\u0275cmp=po({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(t,n,a){if(1&t&&(Rl(a,vM,5),Rl(a,pP,5)),2&t){let m;jr(m=Ur())&&(n._content=m.first),jr(m=Ur())&&(n._allDrawers=m)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,n){2&t&&ar("mat-drawer-container-explicit-backdrop",n._backdropOverride)},exportAs:["matSidenavContainer"],features:[mo([{provide:_M,useExisting:i}]),r],ngContentSelectors:z5,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,n){1&t&&(Dr(V5),Dn(0,O5,1,2,"div",0),no(1),no(2,1),Dn(3,R5,2,0,"mat-sidenav-content",1)),2&t&&(Ln("ngIf",n.hasBackdrop),To(3),Ln("ngIf",!n._content))},dependencies:[Tx,vM],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),i})(),j5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[k0,pa,iP,iP,pa]}),i})();const U5=["*"];let vv;function ey(i){return function Y5(){if(void 0===vv&&(vv=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(vv=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return vv}()?.createHTML(i)||i}function gP(i){return Error(`Unable to find icon with the name "${i}"`)}function xP(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function yP(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class zp{constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}}let bv=(()=>{class i{constructor(t,n,a,m){this._httpClient=t,this._sanitizer=n,this._errorHandler=m,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=a}addSvgIcon(t,n,a){return this.addSvgIconInNamespace("",t,n,a)}addSvgIconLiteral(t,n,a){return this.addSvgIconLiteralInNamespace("",t,n,a)}addSvgIconInNamespace(t,n,a,m){return this._addSvgIconConfig(t,n,new zp(a,null,m))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,a,m){const T=this._sanitizer.sanitize(Gs.HTML,a);if(!T)throw yP(a);const z=ey(T);return this._addSvgIconConfig(t,n,new zp("",z,m))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,a){return this._addSvgIconSetConfig(t,new zp(n,null,a))}addSvgIconSetLiteralInNamespace(t,n,a){const m=this._sanitizer.sanitize(Gs.HTML,n);if(!m)throw yP(n);const T=ey(m);return this._addSvgIconSetConfig(t,new zp("",T,a))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const n=this._sanitizer.sanitize(Gs.RESOURCE_URL,t);if(!n)throw xP(t);const a=this._cachedIconsByUrl.get(n);return a?Cn(wv(a)):this._loadSvgIconFromConfig(new zp(t,null)).pipe(Cr(m=>this._cachedIconsByUrl.set(n,m)),Kt(m=>wv(m)))}getNamedSvgIcon(t,n=""){const a=_P(n,t);let m=this._svgIconConfigs.get(a);if(m)return this._getSvgFromConfig(m);if(m=this._getIconConfigFromResolvers(n,t),m)return this._svgIconConfigs.set(a,m),this._getSvgFromConfig(m);const T=this._iconSetConfigs.get(n);return T?this._getSvgFromIconSetConfigs(t,T):Cf(gP(a))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Cn(wv(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(Kt(n=>wv(n)))}_getSvgFromIconSetConfigs(t,n){const a=this._extractIconWithNameFromAnySet(t,n);return a?Cn(a):function fP(...i){const e=d(i),{args:t,keys:n}=Jk(i),a=new ln(m=>{const{length:T}=t;if(!T)return void m.complete();const z=new Array(T);let j=T,Z=T;for(let st=0;st<T;st++){let Mt=!1;pt(t[st]).subscribe(rt(m,Wt=>{Mt||(Mt=!0,Z--),z[st]=Wt},()=>j--,void 0,()=>{(!j||!Mt)&&(Z||m.next(n?Qk(n,z):z),m.complete())}))}});return e?a.pipe(vw(e)):a}(n.filter(T=>!T.svgText).map(T=>this._loadSvgIconSetFromConfig(T).pipe(rd(z=>{const Z=`Loading icon set URL: ${this._sanitizer.sanitize(Gs.RESOURCE_URL,T.url)} failed: ${z.message}`;return this._errorHandler.handleError(new Error(Z)),Cn(null)})))).pipe(Kt(()=>{const T=this._extractIconWithNameFromAnySet(t,n);if(!T)throw gP(t);return T}))}_extractIconWithNameFromAnySet(t,n){for(let a=n.length-1;a>=0;a--){const m=n[a];if(m.svgText&&m.svgText.toString().indexOf(t)>-1){const T=this._svgElementFromConfig(m),z=this._extractSvgIconFromSet(T,t,m.options);if(z)return z}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Cr(n=>t.svgText=n),Kt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Cn(null):this._fetchIcon(t).pipe(Cr(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,a){const m=t.querySelector(`[id="${n}"]`);if(!m)return null;const T=m.cloneNode(!0);if(T.removeAttribute("id"),"svg"===T.nodeName.toLowerCase())return this._setSvgAttributes(T,a);if("symbol"===T.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(T),a);const z=this._svgElementFromString(ey("<svg></svg>"));return z.appendChild(T),this._setSvgAttributes(z,a)}_svgElementFromString(t){const n=this._document.createElement("DIV");n.innerHTML=t;const a=n.querySelector("svg");if(!a)throw Error("<svg> tag not found");return a}_toSvgElement(t){const n=this._svgElementFromString(ey("<svg></svg>")),a=t.attributes;for(let m=0;m<a.length;m++){const{name:T,value:z}=a[m];"id"!==T&&n.setAttribute(T,z)}for(let m=0;m<t.childNodes.length;m++)t.childNodes[m].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[m].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){const{url:n,options:a}=t,m=a?.withCredentials??!1;if(!this._httpClient)throw function H5(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const T=this._sanitizer.sanitize(Gs.RESOURCE_URL,n);if(!T)throw xP(n);const z=this._inProgressUrlFetches.get(T);if(z)return z;const j=this._httpClient.get(T,{responseType:"text",withCredentials:m}).pipe(Kt(Z=>ey(Z)),V0(()=>this._inProgressUrlFetches.delete(T)),nt());return this._inProgressUrlFetches.set(T,j),j}_addSvgIconConfig(t,n,a){return this._svgIconConfigs.set(_P(t,n),a),this}_addSvgIconSetConfig(t,n){const a=this._iconSetConfigs.get(t);return a?a.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){const n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let a=0;a<this._resolvers.length;a++){const m=this._resolvers[a](n,t);if(m)return G5(m)?new zp(m.url,null,m.options):new zp(m,null)}}}return i.\u0275fac=function(t){return new(t||i)(fi(Lf,8),fi(_w),fi(so,8),fi(ua))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function wv(i){return i.cloneNode(!0)}function _P(i,e){return i+":"+e}function G5(i){return!(!i.url||!i.options)}const Z5=uM(class{constructor(i){this._elementRef=i}}),K5=new Bi("MAT_ICON_DEFAULT_OPTIONS"),J5=new Bi("mat-icon-location",{providedIn:"root",factory:function Q5(){const i=Fn(so),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),vP=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],q5=vP.map(i=>`[${i}]`).join(", "),tW=/^url\(['"]?#(.*?)['"]?\)$/;let eW=(()=>{class i extends Z5{get inline(){return this._inline}set inline(t){this._inline=Hr(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(t,n,a,m,T,z){super(t),this._iconRegistry=n,this._location=m,this._errorHandler=T,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=De.EMPTY,z&&(z.color&&(this.color=this.defaultColor=z.color),z.fontSet&&(this.fontSet=z.fontSet)),a||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const a=t.childNodes[n];(1!==a.nodeType||"svg"===a.nodeName.toLowerCase())&&a.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(a=>a.length>0);this._previousFontSetClass.forEach(a=>t.classList.remove(a)),n.forEach(a=>t.classList.add(a)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const n=this._elementsWithExternalReferences;n&&n.forEach((a,m)=>{a.forEach(T=>{m.setAttribute(T.name,`url('${t}#${T.value}')`)})})}_cacheChildrenWithExternalReferences(t){const n=t.querySelectorAll(q5),a=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let m=0;m<n.length;m++)vP.forEach(T=>{const z=n[m],j=z.getAttribute(T),Z=j?j.match(tW):null;if(Z){let st=a.get(z);st||(st=[],a.set(z,st)),st.push({name:T,value:Z[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[n,a]=this._splitIconName(t);n&&(this._svgNamespace=n),a&&(this._svgName=a),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(a,n).pipe(_h(1)).subscribe(m=>this._setSvgElement(m),m=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${a}! ${m.message}`))})}}}return i.\u0275fac=function(t){return new(t||i)(Ee(to),Ee(bv),Xu("aria-hidden"),Ee(J5),Ee(ua),Ee(K5,8))},i.\u0275cmp=po({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,n){2&t&&(Ae("data-mat-icon-type",n._usingFontIcon()?"font":"svg")("data-mat-icon-name",n._svgName||n.fontIcon)("data-mat-icon-namespace",n._svgNamespace||n.fontSet)("fontIcon",n._usingFontIcon()?n.fontIcon:null),ar("mat-icon-inline",n.inline)("mat-icon-no-color","primary"!==n.color&&"accent"!==n.color&&"warn"!==n.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[r],ngContentSelectors:U5,decls:1,vars:0,template:function(t,n){1&t&&(Dr(),no(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),i})(),iW=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,pa]}),i})();const nW=["*"],rW=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],aW=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],lW=new Bi("MAT_CARD_CONFIG");let bP=(()=>{class i{constructor(t){this.appearance=t?.appearance||"raised"}}return i.\u0275fac=function(t){return new(t||i)(Ee(lW,8))},i.\u0275cmp=po({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(t,n){2&t&&ar("mat-mdc-card-outlined","outlined"===n.appearance)("mdc-card--outlined","outlined"===n.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:nW,decls:1,vars:0,template:function(t,n){1&t&&(Dr(),no(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mat-mdc-card{position:relative;border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px));background-color:var(--mdc-elevated-card-container-color, transparent);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color, transparent)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width, 1px);border-style:solid;border-color:var(--mdc-outlined-card-outline-color, transparent)}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0}),i})(),wP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ji({type:i,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]}),i})(),MP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ji({type:i,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]}),i})(),CP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=po({type:i,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:aW,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(t,n){1&t&&(Dr(rW),no(0),Pn(1,"div",0),no(2,1),Nn(),no(3,2))},encapsulation:2,changeDetection:0}),i})(),TP=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=Ji({type:i,selectors:[["","mat-card-avatar",""],["","matCardAvatar",""]],hostAttrs:[1,"mat-mdc-card-avatar"]}),i})(),yW=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,k0,pa]}),i})();const _W=["drawer"],vW=["drawerButton"];function bW(i,e){if(1&i){const t=Xo();Pn(0,"mat-card",7),gs("click",function(){const m=ih(t).$implicit;return nh(Xr().redirectTo(m.id))}),Pn(1,"mat-card-header"),An(2,"img",8),Pn(3,"mat-card-title"),gf(4),Nn(),Pn(5,"mat-card-subtitle"),gf(6),Nn()()()}if(2&i){const t=e.$implicit;To(2),Sp("src","../../assets/images/buildings/",t.id,".png",lp),To(2),q_(t.name),To(2),q_(t.campus)}}function wW(i,e){if(1&i){const t=Xo();Pn(0,"button",9,10),gs("click",function(){return ih(t),Xr(),nh(function bs(i){return Eo(function Vu(){return Sn.lFrame.contextLView}(),zs+i)}(2).toggle())}),Pn(2,"mat-icon",11),gf(3,"menu"),Nn()()}}let MW=(()=>{class i{constructor(t,n,a){this.breakpointObserver=t,this.http=n,this.router=a,this.buildings=[],this.isHandset$=this.breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)").pipe(Kt(m=>m.matches),function NN(i,e,t){let n,a=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:a=!1,scheduler:t}=i):n=i??1/0,nt({connector:()=>new zN(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}())}ngOnInit(){this.http.get(`${Ux_backendURL}/buildings`).subscribe(t=>{for(let n=0;n<t.length;n++)this.buildings.push({id:t[n].id,name:t[n].name,campus:t[n].campus})})}redirectTo(t){this.isHandset$.subscribe(n=>{n&&(this.sidenav.toggle(),this.button._elementRef.nativeElement.classList.remove("cdk-program-focused"))}),this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>this.router.navigate(["/chart",t]))}}return i.\u0275fac=function(t){return new(t||i)(Ee(PA),Ee(Lf),Ee(Ka))},i.\u0275cmp=po({type:i,selectors:[["app-navigation"]],viewQuery:function(t,n){if(1&t&&(Pp(_W,5),Pp(vW,5)),2&t){let a;jr(a=Ur())&&(n.sidenav=a.first),jr(a=Ur())&&(n.button=a.first)}},decls:16,vars:13,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["class","clickable","matRipple","",3,"click",4,"ngFor","ngForOf"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],["routerLink","/",1,"clickable"],["matRipple","",1,"clickable",3,"click"],["mat-card-avatar","",3,"src"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["drawerButton",""],["aria-label","Side nav toggle icon"]],template:function(t,n){1&t&&(Pn(0,"mat-sidenav-container",0)(1,"mat-sidenav",1,2),gx(3,"async"),gx(4,"async"),gx(5,"async"),Pn(6,"mat-toolbar"),gf(7,"Buildings"),Nn(),Dn(8,bW,7,3,"mat-card",3),Nn(),Pn(9,"mat-sidenav-content")(10,"mat-toolbar",4),Dn(11,wW,4,0,"button",5),gx(12,"async"),Pn(13,"span",6),gf(14,"La Trobe EDV"),Nn()(),An(15,"router-outlet"),Nn()()),2&t&&(To(1),Ln("mode",xx(4,7,n.isHandset$)?"over":"side")("opened",!1===xx(5,9,n.isHandset$)),Ae("role",xx(3,5,n.isHandset$)?"dialog":"navigation"),To(7),Ln("ngForOf",n.buildings),To(3),Ln("ngIf",xx(12,11,n.isHandset$)))},dependencies:[fk,Tx,zw,ov,Z3,o5,pP,mP,vM,eW,bP,TP,CP,MP,wP,mM,vk],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.clickable[_ngcontent-%COMP%]{cursor:pointer}.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:36px;border-radius:50%;padding:5px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}span[_ngcontent-%COMP%]{padding-left:10px}@media (max-width: 599px){.mat-toolbar-row[_ngcontent-%COMP%], .mat-toolbar-single-row[_ngcontent-%COMP%]{height:64px}}"]}),i})(),CW=(()=>{class i{constructor(){this.title="EDV"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=po({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){1&t&&An(0,"app-navigation")},dependencies:[MW]}),i})(),SP=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),kW=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({providers:[SP]}),i})(),AW=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[pa,pa]}),i})(),rX=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({imports:[kW,k0,pa,fM,U3,AW]}),i})();function BE(i){return new Rt(3e3,!1)}function WX(){return typeof window<"u"&&typeof window.document<"u"}function UM(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function yu(i){switch(i.length){case 0:return new ty;case 1:return i[0];default:return new hP(i)}}function OE(i,e,t,n,a=new Map,m=new Map){const T=[],z=[];let j=-1,Z=null;if(n.forEach(st=>{const Mt=st.get("offset"),Wt=Mt==j,qt=Wt&&Z||new Map;st.forEach((pe,Me)=>{let Xe=Me,He=pe;if("offset"!==Me)switch(Xe=e.normalizePropertyName(Xe,T),He){case yM:He=a.get(Me);break;case hd:He=m.get(Me);break;default:He=e.normalizeStyleValue(Me,Xe,He,T)}qt.set(Xe,He)}),Wt||z.push(qt),Z=qt,j=Mt}),T.length)throw function PX(i){return new Rt(3502,!1)}();return z}function YM(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&HM(t,"start",i)));break;case"done":i.onDone(()=>n(t&&HM(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&HM(t,"destroy",i)))}}function HM(i,e,t){const m=$M(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,t.totalTime??i.totalTime,!!t.disabled),T=i._data;return null!=T&&(m._data=T),m}function $M(i,e,t,n,a="",m=0,T){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:a,totalTime:m,disabled:!!T}}function gl(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function RE(i){const e=i.indexOf(":");return[i.substring(1,e),i.slice(e+1)]}let GM=(i,e)=>!1,VE=(i,e,t)=>[],zE=null;function ZM(i){const e=i.parentNode||i.host;return e===zE?null:e}(UM()||typeof Element<"u")&&(WX()?(zE=(()=>document.documentElement)(),GM=(i,e)=>{for(;e;){if(e===i)return!0;e=ZM(e)}return!1}):GM=(i,e)=>i.contains(e),VE=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let Xp=null,NE=!1;const WE=GM,XE=VE;let jE=(()=>{class i{validateStyleProperty(t){return function jX(i){Xp||(Xp=function UX(){return typeof document<"u"?document.body:null}()||{},NE=!!Xp.style&&"WebkitAppearance"in Xp.style);let e=!0;return Xp.style&&!function XX(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in Xp.style,!e&&NE&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in Xp.style)),e}(t)}matchesElement(t,n){return!1}containsElement(t,n){return WE(t,n)}getParentElement(t){return ZM(t)}query(t,n,a){return XE(t,n,a)}computeStyle(t,n,a){return a||""}animate(t,n,a,m,T,z=[],j){return new ty(a,m)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})(),KM=(()=>{class i{}return i.NOOP=new jE,i})();const YX=1e3,JM="ng-enter",Iv="ng-leave",Fv="ng-trigger",Lv=".ng-trigger",YE="ng-animating",QM=".ng-animating";function cd(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:qM(parseFloat(e[1]),e[2])}function qM(i,e){return"s"===e?i*YX:i}function Bv(i,e,t){return i.hasOwnProperty("duration")?i:function $X(i,e,t){let a,m=0,T="";if("string"==typeof i){const z=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===z)return e.push(BE()),{duration:0,delay:0,easing:""};a=qM(parseFloat(z[1]),z[2]);const j=z[3];null!=j&&(m=qM(parseFloat(j),z[4]));const Z=z[5];Z&&(T=Z)}else a=i;if(!t){let z=!1,j=e.length;a<0&&(e.push(function aX(){return new Rt(3100,!1)}()),z=!0),m<0&&(e.push(function lX(){return new Rt(3101,!1)}()),z=!0),z&&e.splice(j,0,BE())}return{duration:a,delay:m,easing:T}}(i,e,t)}function ay(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function HE(i){const e=new Map;return Object.keys(i).forEach(t=>{e.set(t,i[t])}),e}function _u(i,e=new Map,t){if(t)for(let[n,a]of t)e.set(n,a);for(let[n,a]of i)e.set(n,a);return e}function GE(i,e,t){return t?e+":"+t+";":""}function ZE(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=GE(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=GE(0,JX(t),i.style[t]));i.setAttribute("style",e)}function gc(i,e,t){i.style&&(e.forEach((n,a)=>{const m=eC(a);t&&!t.has(a)&&t.set(a,i.style[m]),i.style[m]=n}),UM()&&ZE(i))}function jp(i,e){i.style&&(e.forEach((t,n)=>{const a=eC(n);i.style[a]=""}),UM()&&ZE(i))}function ly(i){return Array.isArray(i)?1==i.length?i[0]:oP(i):i}const tC=new RegExp("{{\\s*(.+?)\\s*}}","g");function KE(i){let e=[];if("string"==typeof i){let t;for(;t=tC.exec(i);)e.push(t[1]);tC.lastIndex=0}return e}function hy(i,e,t){const n=i.toString(),a=n.replace(tC,(m,T)=>{let z=e[T];return null==z&&(t.push(function cX(i){return new Rt(3003,!1)}()),z=""),z.toString()});return a==n?i:a}function Ov(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const KX=/-+([a-z0-9])/g;function eC(i){return i.replace(KX,(...e)=>e[1].toUpperCase())}function JX(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function xl(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function dX(i){return new Rt(3004,!1)}()}}function JE(i,e){return window.getComputedStyle(i)[e]}const zv="*";function nj(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function sj(i,e,t){if(":"==i[0]){const j=function oj(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function TX(i){return new Rt(3016,!1)}()),"* => *"}}(i,t);if("function"==typeof j)return void e.push(j);i=j}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function CX(i){return new Rt(3015,!1)}()),e;const a=n[1],m=n[2],T=n[3];e.push(QE(a,T));"<"==m[0]&&!(a==zv&&T==zv)&&e.push(QE(T,a))}(n,t,e)):t.push(i),t}const Nv=new Set(["true","1"]),Wv=new Set(["false","0"]);function QE(i,e){const t=Nv.has(i)||Wv.has(i),n=Nv.has(e)||Wv.has(e);return(a,m)=>{let T=i==zv||i==a,z=e==zv||e==m;return!T&&t&&"boolean"==typeof a&&(T=a?Nv.has(i):Wv.has(i)),!z&&n&&"boolean"==typeof m&&(z=m?Nv.has(e):Wv.has(e)),T&&z}}const rj=new RegExp("s*:selfs*,?","g");function iC(i,e,t,n){return new aj(i).build(e,t,n)}class aj{constructor(e){this._driver=e}build(e,t,n){const a=new cj(t);return this._resetContextStyleTimingState(a),xl(this,ly(e),a)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,a=t.depCount=0;const m=[],T=[];return"@"==e.name.charAt(0)&&t.errors.push(function pX(){return new Rt(3006,!1)}()),e.definitions.forEach(z=>{if(this._resetContextStyleTimingState(t),0==z.type){const j=z,Z=j.name;Z.toString().split(/\s*,\s*/).forEach(st=>{j.name=st,m.push(this.visitState(j,t))}),j.name=Z}else if(1==z.type){const j=this.visitTransition(z,t);n+=j.queryCount,a+=j.depCount,T.push(j)}else t.errors.push(function mX(){return new Rt(3007,!1)}())}),{type:7,name:e.name,states:m,transitions:T,queryCount:n,depCount:a,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),a=e.options&&e.options.params||null;if(n.containsDynamicStyles){const m=new Set,T=a||{};n.styles.forEach(z=>{z instanceof Map&&z.forEach(j=>{KE(j).forEach(Z=>{T.hasOwnProperty(Z)||m.add(Z)})})}),m.size&&(Ov(m.values()),t.errors.push(function fX(i,e){return new Rt(3008,!1)}()))}return{type:0,name:e.name,style:n,options:a?{params:a}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=xl(this,ly(e.animation),t);return{type:1,matchers:nj(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Up(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>xl(this,n,t)),options:Up(e.options)}}visitGroup(e,t){const n=t.currentTime;let a=0;const m=e.steps.map(T=>{t.currentTime=n;const z=xl(this,T,t);return a=Math.max(a,t.currentTime),z});return t.currentTime=a,{type:3,steps:m,options:Up(e.options)}}visitAnimate(e,t){const n=function uj(i,e){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return nC(Bv(i,e).duration,0,"");const t=i;if(t.split(/\s+/).some(m=>"{"==m.charAt(0)&&"{"==m.charAt(1))){const m=nC(0,0,"");return m.dynamic=!0,m.strValue=t,m}const a=Bv(t,e);return nC(a.duration,a.delay,a.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let a,m=e.styles?e.styles:xv({});if(5==m.type)a=this.visitKeyframes(m,t);else{let T=e.styles,z=!1;if(!T){z=!0;const Z={};n.easing&&(Z.easing=n.easing),T=xv(Z)}t.currentTime+=n.duration+n.delay;const j=this.visitStyle(T,t);j.isEmptyStep=z,a=j}return t.currentAnimateTimings=null,{type:4,timings:n,style:a,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],a=Array.isArray(e.styles)?e.styles:[e.styles];for(let z of a)"string"==typeof z?z===hd?n.push(z):t.errors.push(new Rt(3002,!1)):n.push(HE(z));let m=!1,T=null;return n.forEach(z=>{if(z instanceof Map&&(z.has("easing")&&(T=z.get("easing"),z.delete("easing")),!m))for(let j of z.values())if(j.toString().indexOf("{{")>=0){m=!0;break}}),{type:6,styles:n,easing:T,offset:e.offset,containsDynamicStyles:m,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let a=t.currentTime,m=t.currentTime;n&&m>0&&(m-=n.duration+n.delay),e.styles.forEach(T=>{"string"!=typeof T&&T.forEach((z,j)=>{const Z=t.collectedStyles.get(t.currentQuerySelector),st=Z.get(j);let Mt=!0;st&&(m!=a&&m>=st.startTime&&a<=st.endTime&&(t.errors.push(function xX(i,e,t,n,a){return new Rt(3010,!1)}()),Mt=!1),m=st.startTime),Mt&&Z.set(j,{startTime:m,endTime:a}),t.options&&function ZX(i,e,t){const n=e.params||{},a=KE(i);a.length&&a.forEach(m=>{n.hasOwnProperty(m)||t.push(function hX(i){return new Rt(3001,!1)}())})}(z,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function yX(){return new Rt(3011,!1)}()),n;let m=0;const T=[];let z=!1,j=!1,Z=0;const st=e.steps.map(He=>{const Ai=this._makeStyleAst(He,t);let ii=null!=Ai.offset?Ai.offset:function dj(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Ai.styles),dn=0;return null!=ii&&(m++,dn=Ai.offset=ii),j=j||dn<0||dn>1,z=z||dn<Z,Z=dn,T.push(dn),Ai});j&&t.errors.push(function _X(){return new Rt(3012,!1)}()),z&&t.errors.push(function vX(){return new Rt(3200,!1)}());const Mt=e.steps.length;let Wt=0;m>0&&m<Mt?t.errors.push(function bX(){return new Rt(3202,!1)}()):0==m&&(Wt=1/(Mt-1));const qt=Mt-1,pe=t.currentTime,Me=t.currentAnimateTimings,Xe=Me.duration;return st.forEach((He,Ai)=>{const ii=Wt>0?Ai==qt?1:Wt*Ai:T[Ai],dn=ii*Xe;t.currentTime=pe+Me.delay+dn,Me.duration=dn,this._validateStyleAst(He,t),He.offset=ii,n.styles.push(He)}),n}visitReference(e,t){return{type:8,animation:xl(this,ly(e.animation),t),options:Up(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Up(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Up(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,a=e.options||{};t.queryCount++,t.currentQuery=e;const[m,T]=function lj(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(rj,"")),i=i.replace(/@\*/g,Lv).replace(/@\w+/g,t=>Lv+"-"+t.slice(1)).replace(/:animating/g,QM),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+m:m,gl(t.collectedStyles,t.currentQuerySelector,new Map);const z=xl(this,ly(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:m,limit:a.limit||0,optional:!!a.optional,includeSelf:T,animation:z,originalSelector:e.selector,options:Up(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function wX(){return new Rt(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Bv(e.timings,t.errors,!0);return{type:12,animation:xl(this,ly(e.animation),t),timings:n,options:null}}}class cj{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Up(i){return i?(i=ay(i)).params&&(i.params=function hj(i){return i?ay(i):null}(i.params)):i={},i}function nC(i,e,t){return{duration:i,delay:e,easing:t}}function sC(i,e,t,n,a,m,T=null,z=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:a,delay:m,totalTime:a+m,easing:T,subTimeline:z}}class Xv{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const fj=new RegExp(":enter","g"),xj=new RegExp(":leave","g");function oC(i,e,t,n,a,m=new Map,T=new Map,z,j,Z=[]){return(new yj).buildKeyframes(i,e,t,n,a,m,T,z,j,Z)}class yj{buildKeyframes(e,t,n,a,m,T,z,j,Z,st=[]){Z=Z||new Xv;const Mt=new rC(e,t,Z,a,m,st,[]);Mt.options=j;const Wt=j.delay?cd(j.delay):0;Mt.currentTimeline.delayNextStep(Wt),Mt.currentTimeline.setStyles([T],null,Mt.errors,j),xl(this,n,Mt);const qt=Mt.timelines.filter(pe=>pe.containsAnimation());if(qt.length&&z.size){let pe;for(let Me=qt.length-1;Me>=0;Me--){const Xe=qt[Me];if(Xe.element===t){pe=Xe;break}}pe&&!pe.allowOnlyTimelineStyles()&&pe.setStyles([z],null,Mt.errors,j)}return qt.length?qt.map(pe=>pe.buildKeyframes()):[sC(t,[],[],[],0,Wt,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const a=t.createSubContext(e.options),m=t.currentTimeline.currentTime,T=this._visitSubInstructions(n,a,a.options);m!=T&&t.transformIntoNewTimeline(T)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const a of e){const m=a?.delay;if(m){const T="number"==typeof m?m:cd(hy(m,a?.params??{},t.errors));n.delayNextStep(T)}}}_visitSubInstructions(e,t,n){let m=t.currentTimeline.currentTime;const T=null!=n.duration?cd(n.duration):null,z=null!=n.delay?cd(n.delay):null;return 0!==T&&e.forEach(j=>{const Z=t.appendInstructionToTimeline(j,T,z);m=Math.max(m,Z.duration+Z.delay)}),m}visitReference(e,t){t.updateOptions(e.options,!0),xl(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let a=t;const m=e.options;if(m&&(m.params||m.delay)&&(a=t.createSubContext(m),a.transformIntoNewTimeline(),null!=m.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=jv);const T=cd(m.delay);a.delayNextStep(T)}e.steps.length&&(e.steps.forEach(T=>xl(this,T,a)),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>n&&a.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let a=t.currentTimeline.currentTime;const m=e.options&&e.options.delay?cd(e.options.delay):0;e.steps.forEach(T=>{const z=t.createSubContext(e.options);m&&z.delayNextStep(m),xl(this,T,z),a=Math.max(a,z.currentTimeline.currentTime),n.push(z.currentTimeline)}),n.forEach(T=>t.currentTimeline.mergeTimelineCollectedStyles(T)),t.transformIntoNewTimeline(a),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Bv(t.params?hy(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),a=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),a.snapshotCurrentStyles());const m=e.style;5==m.type?this.visitKeyframes(m,t):(t.incrementTime(n.duration),this.visitStyle(m,t),a.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,a=t.currentAnimateTimings;!a&&n.hasCurrentStyleProperties()&&n.forwardFrame();const m=a&&a.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(m):n.setStyles(e.styles,m,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,a=t.currentTimeline.duration,m=n.duration,z=t.createSubContext().currentTimeline;z.easing=n.easing,e.styles.forEach(j=>{z.forwardTime((j.offset||0)*m),z.setStyles(j.styles,j.easing,t.errors,t.options),z.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(z),t.transformIntoNewTimeline(a+m),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,a=e.options||{},m=a.delay?cd(a.delay):0;m&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=jv);let T=n;const z=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!a.optional,t.errors);t.currentQueryTotal=z.length;let j=null;z.forEach((Z,st)=>{t.currentQueryIndex=st;const Mt=t.createSubContext(e.options,Z);m&&Mt.delayNextStep(m),Z===t.element&&(j=Mt.currentTimeline),xl(this,e.animation,Mt),Mt.currentTimeline.applyStylesToKeyframe(),T=Math.max(T,Mt.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(T),j&&(t.currentTimeline.mergeTimelineCollectedStyles(j),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,a=t.currentTimeline,m=e.timings,T=Math.abs(m.duration),z=T*(t.currentQueryTotal-1);let j=T*t.currentQueryIndex;switch(m.duration<0?"reverse":m.easing){case"reverse":j=z-j;break;case"full":j=n.currentStaggerTime}const st=t.currentTimeline;j&&st.delayNextStep(j);const Mt=st.currentTime;xl(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=a.currentTime-Mt+(a.startTime-n.currentTimeline.startTime)}}const jv={};class rC{constructor(e,t,n,a,m,T,z,j){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=a,this._leaveClassName=m,this.errors=T,this.timelines=z,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=jv,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=j||new Uv(this._driver,t,0),z.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let a=this.options;null!=n.duration&&(a.duration=cd(n.duration)),null!=n.delay&&(a.delay=cd(n.delay));const m=n.params;if(m){let T=a.params;T||(T=this.options.params={}),Object.keys(m).forEach(z=>{(!t||!T.hasOwnProperty(z))&&(T[z]=hy(m[z],T,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(a=>{n[a]=t[a]})}}return e}createSubContext(e=null,t,n){const a=t||this.element,m=new rC(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,n||0));return m.previousNode=this.previousNode,m.currentAnimateTimings=this.currentAnimateTimings,m.options=this._copyOptions(),m.updateOptions(e),m.currentQueryIndex=this.currentQueryIndex,m.currentQueryTotal=this.currentQueryTotal,m.parentContext=this,this.subContextCount++,m}transformIntoNewTimeline(e){return this.previousNode=jv,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const a={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},m=new _j(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,a,e.stretchStartingKeyframe);return this.timelines.push(m),a}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,a,m,T){let z=[];if(a&&z.push(this.element),e.length>0){e=(e=e.replace(fj,"."+this._enterClassName)).replace(xj,"."+this._leaveClassName);let Z=this._driver.query(this.element,e,1!=n);0!==n&&(Z=n<0?Z.slice(Z.length+n,Z.length):Z.slice(0,n)),z.push(...Z)}return!m&&0==z.length&&T.push(function MX(i){return new Rt(3014,!1)}()),z}}class Uv{constructor(e,t,n,a){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=a,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Uv(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||hd),this._currentKeyframe.set(t,hd);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,a){t&&this._previousKeyframe.set("easing",t);const m=a&&a.params||{},T=function vj(i,e){const t=new Map;let n;return i.forEach(a=>{if("*"===a){n=n||e.keys();for(let m of n)t.set(m,hd)}else _u(a,t)}),t}(e,this._globalTimelineStyles);for(let[z,j]of T){const Z=hy(j,m,n);this._pendingStyles.set(z,Z),this._localTimelineStyles.has(z)||this._backFill.set(z,this._globalTimelineStyles.get(z)??hd),this._updateStyle(z,Z)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const a=this._styleSummary.get(n);(!a||t.time>a.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let a=[];this._keyframes.forEach((z,j)=>{const Z=_u(z,new Map,this._backFill);Z.forEach((st,Mt)=>{st===yM?e.add(Mt):st===hd&&t.add(Mt)}),n||Z.set("offset",j/this.duration),a.push(Z)});const m=e.size?Ov(e.values()):[],T=t.size?Ov(t.values()):[];if(n){const z=a[0],j=new Map(z);z.set("offset",0),j.set("offset",1),a=[z,j]}return sC(this.element,a,m,T,this.duration,this.startTime,this.easing,!1)}}class _j extends Uv{constructor(e,t,n,a,m,T,z=!1){super(e,t,T.delay),this.keyframes=n,this.preStyleProps=a,this.postStyleProps=m,this._stretchStartingKeyframe=z,this.timings={duration:T.duration,delay:T.delay,easing:T.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:a}=this.timings;if(this._stretchStartingKeyframe&&t){const m=[],T=n+t,z=t/T,j=_u(e[0]);j.set("offset",0),m.push(j);const Z=_u(e[0]);Z.set("offset",eD(z)),m.push(Z);const st=e.length-1;for(let Mt=1;Mt<=st;Mt++){let Wt=_u(e[Mt]);const qt=Wt.get("offset");Wt.set("offset",eD((t+qt*n)/T)),m.push(Wt)}n=T,t=0,a="",e=m}return sC(this.element,e,this.preStyleProps,this.postStyleProps,n,t,a,!0)}}function eD(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class aC{}const bj=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class wj extends aC{normalizePropertyName(e,t){return eC(e)}normalizeStyleValue(e,t,n,a){let m="";const T=n.toString().trim();if(bj.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)m="px";else{const z=n.match(/^[+-]?[\d\.]+([a-z]*)$/);z&&0==z[1].length&&a.push(function uX(i,e){return new Rt(3005,!1)}())}return T+m}}function iD(i,e,t,n,a,m,T,z,j,Z,st,Mt,Wt){return{type:0,element:i,triggerName:e,isRemovalTransition:a,fromState:t,fromStyles:m,toState:n,toStyles:T,timelines:z,queriedElements:j,preStyleProps:Z,postStyleProps:st,totalTime:Mt,errors:Wt}}const lC={};class nD{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,a){return function Mj(i,e,t,n,a){return i.some(m=>m(e,t,n,a))}(this.ast.matchers,e,t,n,a)}buildStyles(e,t,n){let a=this._stateStyles.get("*");return void 0!==e&&(a=this._stateStyles.get(e?.toString())||a),a?a.buildStyles(t,n):new Map}build(e,t,n,a,m,T,z,j,Z,st){const Mt=[],Wt=this.ast.options&&this.ast.options.params||lC,pe=this.buildStyles(n,z&&z.params||lC,Mt),Me=j&&j.params||lC,Xe=this.buildStyles(a,Me,Mt),He=new Set,Ai=new Map,ii=new Map,dn="void"===a,Xs={params:Cj(Me,Wt),delay:this.ast.options?.delay},oo=st?[]:oC(e,t,this.ast.animation,m,T,pe,Xe,Xs,Z,Mt);let fa=0;if(oo.forEach(ud=>{fa=Math.max(ud.duration+ud.delay,fa)}),Mt.length)return iD(t,this._triggerName,n,a,dn,pe,Xe,[],[],Ai,ii,fa,Mt);oo.forEach(ud=>{const pd=ud.element,yD=gl(Ai,pd,new Set);ud.preStyleProps.forEach(Yp=>yD.add(Yp));const dy=gl(ii,pd,new Set);ud.postStyleProps.forEach(Yp=>dy.add(Yp)),pd!==t&&He.add(pd)});const dd=Ov(He.values());return iD(t,this._triggerName,n,a,dn,pe,Xe,oo,dd,Ai,ii,fa)}}function Cj(i,e){const t=ay(e);for(const n in i)i.hasOwnProperty(n)&&null!=i[n]&&(t[n]=i[n]);return t}class Tj{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,a=ay(this.defaultParams);return Object.keys(e).forEach(m=>{const T=e[m];null!==T&&(a[m]=T)}),this.styles.styles.forEach(m=>{"string"!=typeof m&&m.forEach((T,z)=>{T&&(T=hy(T,a,t));const j=this.normalizer.normalizePropertyName(z,t);T=this.normalizer.normalizeStyleValue(z,j,T,t),n.set(z,T)})}),n}}class kj{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(a=>{this.states.set(a.name,new Tj(a.style,a.options&&a.options.params||{},n))}),sD(this.states,"true","1"),sD(this.states,"false","0"),t.transitions.forEach(a=>{this.transitionFactories.push(new nD(e,a,this.states))}),this.fallbackTransition=function Aj(i,e,t){return new nD(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(T,z)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,a){return this.transitionFactories.find(T=>T.match(e,t,n,a))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function sD(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}const Pj=new Xv;class Ej{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],a=[],m=iC(this._driver,t,n,a);if(n.length)throw function EX(i){return new Rt(3503,!1)}();this._animations.set(e,m)}_buildPlayer(e,t,n){const a=e.element,m=OE(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(a,m,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const a=[],m=this._animations.get(e);let T;const z=new Map;if(m?(T=oC(this._driver,t,m,JM,Iv,new Map,new Map,n,Pj,a),T.forEach(st=>{const Mt=gl(z,st.element,new Map);st.postStyleProps.forEach(Wt=>Mt.set(Wt,null))})):(a.push(function DX(){return new Rt(3300,!1)}()),T=[]),a.length)throw function IX(i){return new Rt(3504,!1)}();z.forEach((st,Mt)=>{st.forEach((Wt,qt)=>{st.set(qt,this._driver.computeStyle(Mt,qt,hd))})});const Z=yu(T.map(st=>{const Mt=z.get(st.element);return this._buildPlayer(st,new Map,Mt)}));return this._playersById.set(e,Z),Z.onDestroy(()=>this.destroy(e)),this.players.push(Z),Z}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function FX(i){return new Rt(3301,!1)}();return t}listen(e,t,n,a){const m=$M(t,"","","");return YM(this._getPlayer(e),n,m,a),()=>{}}command(e,t,n,a){if("register"==n)return void this.register(e,a[0]);if("create"==n)return void this.create(e,t,a[0]||{});const m=this._getPlayer(e);switch(n){case"play":m.play();break;case"pause":m.pause();break;case"reset":m.reset();break;case"restart":m.restart();break;case"finish":m.finish();break;case"init":m.init();break;case"setPosition":m.setPosition(parseFloat(a[0]));break;case"destroy":this.destroy(e)}}}const oD="ng-animate-queued",hC="ng-animate-disabled",Bj=[],rD={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Oj={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Xl="__ng_removed";class cC{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Nj(i){return i??null}(n?e.value:e),n){const m=ay(e);delete m.value,this.options=m}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(a=>{null==n[a]&&(n[a]=t[a])})}}}const cy="void",dC=new cC(cy);class Rj{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,jl(t,this._hostClassName)}listen(e,t,n,a){if(!this._triggers.has(t))throw function LX(i,e){return new Rt(3302,!1)}();if(null==n||0==n.length)throw function BX(i){return new Rt(3303,!1)}();if(!function Wj(i){return"start"==i||"done"==i}(n))throw function OX(i,e){return new Rt(3400,!1)}();const m=gl(this._elementListeners,e,[]),T={name:t,phase:n,callback:a};m.push(T);const z=gl(this._engine.statesByElement,e,new Map);return z.has(t)||(jl(e,Fv),jl(e,Fv+"-"+t),z.set(t,dC)),()=>{this._engine.afterFlush(()=>{const j=m.indexOf(T);j>=0&&m.splice(j,1),this._triggers.has(t)||z.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function RX(i){return new Rt(3401,!1)}();return t}trigger(e,t,n,a=!0){const m=this._getTrigger(t),T=new uC(this.id,t,e);let z=this._engine.statesByElement.get(e);z||(jl(e,Fv),jl(e,Fv+"-"+t),this._engine.statesByElement.set(e,z=new Map));let j=z.get(t);const Z=new cC(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&j&&Z.absorbOptions(j.options),z.set(t,Z),j||(j=dC),Z.value!==cy&&j.value===Z.value){if(!function Uj(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let a=0;a<t.length;a++){const m=t[a];if(!e.hasOwnProperty(m)||i[m]!==e[m])return!1}return!0}(j.params,Z.params)){const Me=[],Xe=m.matchStyles(j.value,j.params,Me),He=m.matchStyles(Z.value,Z.params,Me);Me.length?this._engine.reportError(Me):this._engine.afterFlush(()=>{jp(e,Xe),gc(e,He)})}return}const Wt=gl(this._engine.playersByElement,e,[]);Wt.forEach(Me=>{Me.namespaceId==this.id&&Me.triggerName==t&&Me.queued&&Me.destroy()});let qt=m.matchTransition(j.value,Z.value,e,Z.params),pe=!1;if(!qt){if(!a)return;qt=m.fallbackTransition,pe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:qt,fromState:j,toState:Z,player:T,isFallbackTransition:pe}),pe||(jl(e,oD),T.onStart(()=>{Xf(e,oD)})),T.onDone(()=>{let Me=this.players.indexOf(T);Me>=0&&this.players.splice(Me,1);const Xe=this._engine.playersByElement.get(e);if(Xe){let He=Xe.indexOf(T);He>=0&&Xe.splice(He,1)}}),this.players.push(T),Wt.push(T),T}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(a=>a.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Lv,!0);n.forEach(a=>{if(a[Xl])return;const m=this._engine.fetchNamespacesByElement(a);m.size?m.forEach(T=>T.triggerLeaveAnimation(a,t,!1,!0)):this.clearElementCache(a)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(a=>this.clearElementCache(a)))}triggerLeaveAnimation(e,t,n,a){const m=this._engine.statesByElement.get(e),T=new Map;if(m){const z=[];if(m.forEach((j,Z)=>{if(T.set(Z,j.value),this._triggers.has(Z)){const st=this.trigger(e,Z,cy,a);st&&z.push(st)}}),z.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,T),n&&yu(z).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const a=new Set;t.forEach(m=>{const T=m.name;if(a.has(T))return;a.add(T);const j=this._triggers.get(T).fallbackTransition,Z=n.get(T)||dC,st=new cC(cy),Mt=new uC(this.id,T,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:T,transition:j,fromState:Z,toState:st,player:Mt,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let a=!1;if(n.totalAnimations){const m=n.players.length?n.playersByQueriedElement.get(e):[];if(m&&m.length)a=!0;else{let T=e;for(;T=T.parentNode;)if(n.statesByElement.get(T)){a=!0;break}}}if(this.prepareLeaveAnimationListeners(e),a)n.markElementAsRemoved(this.id,e,!1,t);else{const m=e[Xl];(!m||m===rD)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){jl(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const a=n.player;if(a.destroyed)return;const m=n.element,T=this._elementListeners.get(m);T&&T.forEach(z=>{if(z.name==n.triggerName){const j=$M(m,n.triggerName,n.fromState.value,n.toState.value);j._data=e,YM(n.player,z.phase,j,z.callback)}}),a.markedForDestroy?this._engine.afterFlush(()=>{a.destroy()}):t.push(n)}),this._queue=[],t.sort((n,a)=>{const m=n.transition.ast.depCount,T=a.transition.ast.depCount;return 0==m||0==T?m-T:this._engine.driver.containsElement(n.element,a.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class Vj{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(a,m)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Rj(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,a=this.namespacesByHostElement;if(n.length-1>=0){let T=!1,z=this.driver.getParentElement(t);for(;z;){const j=a.get(z);if(j){const Z=n.indexOf(j);n.splice(Z+1,0,e),T=!0;break}z=this.driver.getParentElement(z)}T||n.unshift(e)}else n.push(e);return a.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let a=this._namespaceLookup[e];a&&a.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const a=this._namespaceList.indexOf(n);a>=0&&this._namespaceList.splice(a,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let a of n.values())if(a.namespaceId){const m=this._fetchNamespace(a.namespaceId);m&&t.add(m)}return t}trigger(e,t,n,a){if(Yv(t)){const m=this._fetchNamespace(e);if(m)return m.trigger(t,n,a),!0}return!1}insertNode(e,t,n,a){if(!Yv(t))return;const m=t[Xl];if(m&&m.setForRemoval){m.setForRemoval=!1,m.setForMove=!0;const T=this.collectedLeaveElements.indexOf(t);T>=0&&this.collectedLeaveElements.splice(T,1)}if(e){const T=this._fetchNamespace(e);T&&T.insertNode(t,n)}a&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),jl(e,hC)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Xf(e,hC))}removeNode(e,t,n,a){if(Yv(t)){const m=e?this._fetchNamespace(e):null;if(m?m.removeNode(t,a):this.markElementAsRemoved(e,t,!1,a),n){const T=this.namespacesByHostElement.get(t);T&&T.id!==e&&T.removeNode(t,a)}}else this._onRemovalComplete(t,a)}markElementAsRemoved(e,t,n,a,m){this.collectedLeaveElements.push(t),t[Xl]={namespaceId:e,setForRemoval:a,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:m}}listen(e,t,n,a,m){return Yv(t)?this._fetchNamespace(e).listen(t,n,a,m):()=>{}}_buildInstruction(e,t,n,a,m){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,a,e.fromState.options,e.toState.options,t,m)}destroyInnerAnimations(e){let t=this.driver.query(e,Lv,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,QM,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return yu(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Xl];if(t&&t.setForRemoval){if(e[Xl]=rD,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(hC)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,a)=>this._balanceNamespaceList(n,a)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)jl(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let a=0;a<n.length;a++)n[a]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?yu(t).onDone(()=>{n.forEach(a=>a())}):n.forEach(a=>a())}}reportError(e){throw function VX(i){return new Rt(3402,!1)}()}_flushAnimations(e,t){const n=new Xv,a=[],m=new Map,T=[],z=new Map,j=new Map,Z=new Map,st=new Set;this.disabledNodes.forEach(vn=>{st.add(vn);const Bn=this.driver.query(vn,".ng-animate-queued",!0);for(let Yn=0;Yn<Bn.length;Yn++)st.add(Bn[Yn])});const Mt=this.bodyNode,Wt=Array.from(this.statesByElement.keys()),qt=hD(Wt,this.collectedEnterElements),pe=new Map;let Me=0;qt.forEach((vn,Bn)=>{const Yn=JM+Me++;pe.set(Bn,Yn),vn.forEach(Ks=>jl(Ks,Yn))});const Xe=[],He=new Set,Ai=new Set;for(let vn=0;vn<this.collectedLeaveElements.length;vn++){const Bn=this.collectedLeaveElements[vn],Yn=Bn[Xl];Yn&&Yn.setForRemoval&&(Xe.push(Bn),He.add(Bn),Yn.hasAnimation?this.driver.query(Bn,".ng-star-inserted",!0).forEach(Ks=>He.add(Ks)):Ai.add(Bn))}const ii=new Map,dn=hD(Wt,Array.from(He));dn.forEach((vn,Bn)=>{const Yn=Iv+Me++;ii.set(Bn,Yn),vn.forEach(Ks=>jl(Ks,Yn))}),e.push(()=>{qt.forEach((vn,Bn)=>{const Yn=pe.get(Bn);vn.forEach(Ks=>Xf(Ks,Yn))}),dn.forEach((vn,Bn)=>{const Yn=ii.get(Bn);vn.forEach(Ks=>Xf(Ks,Yn))}),Xe.forEach(vn=>{this.processLeaveNode(vn)})});const Xs=[],oo=[];for(let vn=this._namespaceList.length-1;vn>=0;vn--)this._namespaceList[vn].drainQueuedTransitions(t).forEach(Yn=>{const Ks=Yn.player,$r=Yn.element;if(Xs.push(Ks),this.collectedEnterElements.length){const ga=$r[Xl];if(ga&&ga.setForMove){if(ga.previousTriggersValues&&ga.previousTriggersValues.has(Yn.triggerName)){const Hp=ga.previousTriggersValues.get(Yn.triggerName),Ul=this.statesByElement.get(Yn.element);if(Ul&&Ul.has(Yn.triggerName)){const Gv=Ul.get(Yn.triggerName);Gv.value=Hp,Ul.set(Yn.triggerName,Gv)}}return void Ks.destroy()}}const xc=!Mt||!this.driver.containsElement(Mt,$r),yl=ii.get($r),vu=pe.get($r),Uo=this._buildInstruction(Yn,n,vu,yl,xc);if(Uo.errors&&Uo.errors.length)return void oo.push(Uo);if(xc)return Ks.onStart(()=>jp($r,Uo.fromStyles)),Ks.onDestroy(()=>gc($r,Uo.toStyles)),void a.push(Ks);if(Yn.isFallbackTransition)return Ks.onStart(()=>jp($r,Uo.fromStyles)),Ks.onDestroy(()=>gc($r,Uo.toStyles)),void a.push(Ks);const bD=[];Uo.timelines.forEach(ga=>{ga.stretchStartingKeyframe=!0,this.disabledNodes.has(ga.element)||bD.push(ga)}),Uo.timelines=bD,n.append($r,Uo.timelines),T.push({instruction:Uo,player:Ks,element:$r}),Uo.queriedElements.forEach(ga=>gl(z,ga,[]).push(Ks)),Uo.preStyleProps.forEach((ga,Hp)=>{if(ga.size){let Ul=j.get(Hp);Ul||j.set(Hp,Ul=new Set),ga.forEach((Gv,fC)=>Ul.add(fC))}}),Uo.postStyleProps.forEach((ga,Hp)=>{let Ul=Z.get(Hp);Ul||Z.set(Hp,Ul=new Set),ga.forEach((Gv,fC)=>Ul.add(fC))})});if(oo.length){const vn=[];oo.forEach(Bn=>{vn.push(function zX(i,e){return new Rt(3505,!1)}())}),Xs.forEach(Bn=>Bn.destroy()),this.reportError(vn)}const fa=new Map,dd=new Map;T.forEach(vn=>{const Bn=vn.element;n.has(Bn)&&(dd.set(Bn,Bn),this._beforeAnimationBuild(vn.player.namespaceId,vn.instruction,fa))}),a.forEach(vn=>{const Bn=vn.element;this._getPreviousPlayers(Bn,!1,vn.namespaceId,vn.triggerName,null).forEach(Ks=>{gl(fa,Bn,[]).push(Ks),Ks.destroy()})});const ud=Xe.filter(vn=>dD(vn,j,Z)),pd=new Map;lD(pd,this.driver,Ai,Z,hd).forEach(vn=>{dD(vn,j,Z)&&ud.push(vn)});const dy=new Map;qt.forEach((vn,Bn)=>{lD(dy,this.driver,new Set(vn),j,yM)}),ud.forEach(vn=>{const Bn=pd.get(vn),Yn=dy.get(vn);pd.set(vn,new Map([...Array.from(Bn?.entries()??[]),...Array.from(Yn?.entries()??[])]))});const Yp=[],_D=[],vD={};T.forEach(vn=>{const{element:Bn,player:Yn,instruction:Ks}=vn;if(n.has(Bn)){if(st.has(Bn))return Yn.onDestroy(()=>gc(Bn,Ks.toStyles)),Yn.disabled=!0,Yn.overrideTotalTime(Ks.totalTime),void a.push(Yn);let $r=vD;if(dd.size>1){let yl=Bn;const vu=[];for(;yl=yl.parentNode;){const Uo=dd.get(yl);if(Uo){$r=Uo;break}vu.push(yl)}vu.forEach(Uo=>dd.set(Uo,$r))}const xc=this._buildAnimation(Yn.namespaceId,Ks,fa,m,dy,pd);if(Yn.setRealPlayer(xc),$r===vD)Yp.push(Yn);else{const yl=this.playersByElement.get($r);yl&&yl.length&&(Yn.parentPlayer=yu(yl)),a.push(Yn)}}else jp(Bn,Ks.fromStyles),Yn.onDestroy(()=>gc(Bn,Ks.toStyles)),_D.push(Yn),st.has(Bn)&&a.push(Yn)}),_D.forEach(vn=>{const Bn=m.get(vn.element);if(Bn&&Bn.length){const Yn=yu(Bn);vn.setRealPlayer(Yn)}}),a.forEach(vn=>{vn.parentPlayer?vn.syncPlayerEvents(vn.parentPlayer):vn.destroy()});for(let vn=0;vn<Xe.length;vn++){const Bn=Xe[vn],Yn=Bn[Xl];if(Xf(Bn,Iv),Yn&&Yn.hasAnimation)continue;let Ks=[];if(z.size){let xc=z.get(Bn);xc&&xc.length&&Ks.push(...xc);let yl=this.driver.query(Bn,QM,!0);for(let vu=0;vu<yl.length;vu++){let Uo=z.get(yl[vu]);Uo&&Uo.length&&Ks.push(...Uo)}}const $r=Ks.filter(xc=>!xc.destroyed);$r.length?Xj(this,Bn,$r):this.processLeaveNode(Bn)}return Xe.length=0,Yp.forEach(vn=>{this.players.push(vn),vn.onDone(()=>{vn.destroy();const Bn=this.players.indexOf(vn);this.players.splice(Bn,1)}),vn.play()}),Yp}elementContainsData(e,t){let n=!1;const a=t[Xl];return a&&a.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,a,m){let T=[];if(t){const z=this.playersByQueriedElement.get(e);z&&(T=z)}else{const z=this.playersByElement.get(e);if(z){const j=!m||m==cy;z.forEach(Z=>{Z.queued||!j&&Z.triggerName!=a||T.push(Z)})}}return(n||a)&&(T=T.filter(z=>!(n&&n!=z.namespaceId||a&&a!=z.triggerName))),T}_beforeAnimationBuild(e,t,n){const m=t.element,T=t.isRemovalTransition?void 0:e,z=t.isRemovalTransition?void 0:t.triggerName;for(const j of t.timelines){const Z=j.element,st=Z!==m,Mt=gl(n,Z,[]);this._getPreviousPlayers(Z,st,T,z,t.toState).forEach(qt=>{const pe=qt.getRealPlayer();pe.beforeDestroy&&pe.beforeDestroy(),qt.destroy(),Mt.push(qt)})}jp(m,t.fromStyles)}_buildAnimation(e,t,n,a,m,T){const z=t.triggerName,j=t.element,Z=[],st=new Set,Mt=new Set,Wt=t.timelines.map(pe=>{const Me=pe.element;st.add(Me);const Xe=Me[Xl];if(Xe&&Xe.removedBeforeQueried)return new ty(pe.duration,pe.delay);const He=Me!==j,Ai=function jj(i){const e=[];return cD(i,e),e}((n.get(Me)||Bj).map(fa=>fa.getRealPlayer())).filter(fa=>!!fa.element&&fa.element===Me),ii=m.get(Me),dn=T.get(Me),Xs=OE(0,this._normalizer,0,pe.keyframes,ii,dn),oo=this._buildPlayer(pe,Xs,Ai);if(pe.subTimeline&&a&&Mt.add(Me),He){const fa=new uC(e,z,Me);fa.setRealPlayer(oo),Z.push(fa)}return oo});Z.forEach(pe=>{gl(this.playersByQueriedElement,pe.element,[]).push(pe),pe.onDone(()=>function zj(i,e,t){let n=i.get(e);if(n){if(n.length){const a=n.indexOf(t);n.splice(a,1)}0==n.length&&i.delete(e)}return n}(this.playersByQueriedElement,pe.element,pe))}),st.forEach(pe=>jl(pe,YE));const qt=yu(Wt);return qt.onDestroy(()=>{st.forEach(pe=>Xf(pe,YE)),gc(j,t.toStyles)}),Mt.forEach(pe=>{gl(a,pe,[]).push(qt)}),qt}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new ty(e.duration,e.delay)}}class uC{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new ty,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(a=>YM(e,n,void 0,a))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){gl(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Yv(i){return i&&1===i.nodeType}function aD(i,e){const t=i.style.display;return i.style.display=e??"none",t}function lD(i,e,t,n,a){const m=[];t.forEach(j=>m.push(aD(j)));const T=[];n.forEach((j,Z)=>{const st=new Map;j.forEach(Mt=>{const Wt=e.computeStyle(Z,Mt,a);st.set(Mt,Wt),(!Wt||0==Wt.length)&&(Z[Xl]=Oj,T.push(Z))}),i.set(Z,st)});let z=0;return t.forEach(j=>aD(j,m[z++])),T}function hD(i,e){const t=new Map;if(i.forEach(z=>t.set(z,[])),0==e.length)return t;const n=1,a=new Set(e),m=new Map;function T(z){if(!z)return n;let j=m.get(z);if(j)return j;const Z=z.parentNode;return j=t.has(Z)?Z:a.has(Z)?n:T(Z),m.set(z,j),j}return e.forEach(z=>{const j=T(z);j!==n&&t.get(j).push(z)}),t}function jl(i,e){i.classList?.add(e)}function Xf(i,e){i.classList?.remove(e)}function Xj(i,e,t){yu(t).onDone(()=>i.processLeaveNode(e))}function cD(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof hP?cD(n.players,e):e.push(n)}}function dD(i,e,t){const n=t.get(i);if(!n)return!1;let a=e.get(i);return a?n.forEach(m=>a.add(m)):e.set(i,n),t.delete(i),!0}class Hv{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(a,m)=>{},this._transitionEngine=new Vj(e,t,n),this._timelineEngine=new Ej(e,t,n),this._transitionEngine.onRemovalComplete=(a,m)=>this.onRemovalComplete(a,m)}registerTrigger(e,t,n,a,m){const T=e+"-"+a;let z=this._triggerCache[T];if(!z){const j=[],Z=[],st=iC(this._driver,m,j,Z);if(j.length)throw function AX(i,e){return new Rt(3404,!1)}();z=function Sj(i,e,t){return new kj(i,e,t)}(a,st,this._normalizer),this._triggerCache[T]=z}this._transitionEngine.registerTrigger(t,a,z)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,a){this._transitionEngine.insertNode(e,t,n,a)}onRemove(e,t,n,a){this._transitionEngine.removeNode(e,t,a||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,a){if("@"==n.charAt(0)){const[m,T]=RE(n);this._timelineEngine.command(m,t,T,a)}else this._transitionEngine.trigger(e,t,n,a)}listen(e,t,n,a,m){if("@"==n.charAt(0)){const[T,z]=RE(n);return this._timelineEngine.listen(T,t,z,m)}return this._transitionEngine.listen(e,t,n,a,m)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Hj=(()=>{class i{constructor(t,n,a){this._element=t,this._startStyles=n,this._endStyles=a,this._state=0;let m=i.initialStylesByElement.get(t);m||i.initialStylesByElement.set(t,m=new Map),this._initialStyles=m}start(){this._state<1&&(this._startStyles&&gc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(gc(this._element,this._initialStyles),this._endStyles&&(gc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(jp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(jp(this._element,this._endStyles),this._endStyles=null),gc(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function pC(i){let e=null;return i.forEach((t,n)=>{(function $j(i){return"display"===i||"position"===i})(n)&&(e=e||new Map,e.set(n,t))}),e}class uD{constructor(e,t,n,a){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,a)=>{"offset"!==a&&e.set(a,this._finished?n:JE(this.element,a))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Gj{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return WE(e,t)}getParentElement(e){return ZM(e)}query(e,t,n){return XE(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,a,m,T=[]){const j={duration:n,delay:a,fill:0==a?"both":"forwards"};m&&(j.easing=m);const Z=new Map,st=T.filter(qt=>qt instanceof uD);(function QX(i,e){return 0===i||0===e})(n,a)&&st.forEach(qt=>{qt.currentSnapshot.forEach((pe,Me)=>Z.set(Me,pe))});let Mt=function GX(i){return i.length?i[0]instanceof Map?i:i.map(e=>HE(e)):[]}(t).map(qt=>_u(qt));Mt=function qX(i,e,t){if(t.size&&e.length){let n=e[0],a=[];if(t.forEach((m,T)=>{n.has(T)||a.push(T),n.set(T,m)}),a.length)for(let m=1;m<e.length;m++){let T=e[m];a.forEach(z=>T.set(z,JE(i,z)))}}return e}(e,Mt,Z);const Wt=function Yj(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=pC(e[0]),e.length>1&&(n=pC(e[e.length-1]))):e instanceof Map&&(t=pC(e)),t||n?new Hj(i,t,n):null}(e,Mt);return new uD(e,Mt,j,Wt)}}let Zj=(()=>{class i extends nP{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:sa.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const a=Array.isArray(t)?oP(t):t;return pD(this._renderer,null,n,"register",[a]),new Kj(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(fi(up),fi(so))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class Kj extends P5{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Jj(this._id,e,t||{},this._renderer)}}class Jj{constructor(e,t,n,a){this.id=e,this.element=t,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return pD(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function pD(i,e,t,n,a){return i.setProperty(e,`@@${t}:${n}`,a)}const mD="@.disabled";let Qj=(()=>{class i{constructor(t,n,a){this.delegate=t,this.engine=n,this._zone=a,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(m,T)=>{const z=T?.parentNode(m);z&&T.removeChild(z,m)}}createRenderer(t,n){const m=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let st=this._rendererCache.get(m);return st||(st=new fD("",m,this.engine,()=>this._rendererCache.delete(m)),this._rendererCache.set(m,st)),st}const T=n.id,z=n.id+"-"+this._currentId;this._currentId++,this.engine.register(z,t);const j=st=>{Array.isArray(st)?st.forEach(j):this.engine.registerTrigger(T,z,t,st.name,st)};return n.data.animation.forEach(j),new qj(this,z,m,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,a){t>=0&&t<this._microtaskId?this._zone.run(()=>n(a)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(m=>{const[T,z]=m;T(z)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,a]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(fi(up),fi(Hv),fi(us))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})();class fD{constructor(e,t,n,a){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=a,this.destroyNode=this.delegate.destroyNode?m=>t.destroyNode(m):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,a=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,a)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,a){this.delegate.setAttribute(e,t,n,a)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,a){this.delegate.setStyle(e,t,n,a)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==mD?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class qj extends fD{constructor(e,t,n,a,m){super(t,n,a,m),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==mD?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const a=function tU(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let m=t.slice(1),T="";return"@"!=m.charAt(0)&&([m,T]=function eU(i){const e=i.indexOf(".");return[i.substring(0,e),i.slice(e+1)]}(m)),this.engine.listen(this.namespaceId,a,m,T,z=>{this.factory.scheduleListenerCallback(z._data||-1,n,z)})}return this.delegate.listen(e,t,n)}}const gD=[{provide:nP,useClass:Zj},{provide:aC,useFactory:function nU(){return new wj}},{provide:Hv,useClass:(()=>{class i extends Hv{constructor(t,n,a,m){super(t.body,n,a)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(fi(so),fi(KM),fi(aC),fi(bx))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac}),i})()},{provide:up,useFactory:function sU(i,e,t){return new Qj(i,e,t)},deps:[F0,Hv,us]}],mC=[{provide:KM,useFactory:()=>new Gj},{provide:Ep,useValue:"BrowserAnimations"},...gD],xD=[{provide:KM,useClass:jE},{provide:Ep,useValue:"NoopAnimations"},...gD];let oU=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?xD:mC}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i}),i.\u0275inj=Te({providers:mC,imports:[Hk]}),i})();ia(524);let aU=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=ws({type:i,bootstrap:[CW]}),i.\u0275inj=Te({imports:[Hk,oU,CN,LN,K3,r5,j5,iW,rX,_N,yW,fM]}),i})();dR().bootstrapModule(aU).catch(i=>console.error(i))},524:(Qa,_l)=>{var ss;(function(){function On(ut,Ct){ut.prototype=function qa(ut){function Ct(){}return Ct.prototype=ut,new Ct}(Ct.prototype),ut.prototype.constructor=ut,ut.base=Ct.prototype}function b(ut,Ct,Vt){return"millisecond"===Vt?ut.setMilliseconds(ut.getMilliseconds()+1*Ct):"second"===Vt?ut.setSeconds(ut.getSeconds()+1*Ct):"minute"===Vt?ut.setMinutes(ut.getMinutes()+1*Ct):"hour"===Vt?ut.setHours(ut.getHours()+1*Ct):"day"===Vt?ut.setDate(ut.getDate()+1*Ct):"week"===Vt?ut.setDate(ut.getDate()+7*Ct):"month"===Vt?ut.setMonth(ut.getMonth()+1*Ct):"year"===Vt&&ut.setFullYear(ut.getFullYear()+1*Ct),ut}function De(ut,Ct){var Vt=!1;for(0>ut&&(Vt=!0,ut*=-1),ut=""+ut,Ct=Ct||1;ut.length<Ct;)ut="0"+ut;return Vt?"-"+ut:ut}function ho(ut){if(!ut)return ut;for(var Ct=/\s/,Vt=(ut=ut.replace(/^\s\s*/,"")).length;Ct.test(ut.charAt(--Vt)););return ut.slice(0,Vt+1)}function ks(ut){ut.roundRect=function(Ct,Vt,Le,ri,mi,Q,xt,Pt){xt&&(this.fillStyle=xt),Pt&&(this.strokeStyle=Pt),typeof mi>"u"&&(mi=5),this.lineWidth=Q,this.beginPath(),this.moveTo(Ct+mi,Vt),this.lineTo(Ct+Le-mi,Vt),this.quadraticCurveTo(Ct+Le,Vt,Ct+Le,Vt+mi),this.lineTo(Ct+Le,Vt+ri-mi),this.quadraticCurveTo(Ct+Le,Vt+ri,Ct+Le-mi,Vt+ri),this.lineTo(Ct+mi,Vt+ri),this.quadraticCurveTo(Ct,Vt+ri,Ct,Vt+ri-mi),this.lineTo(Ct,Vt+mi),this.quadraticCurveTo(Ct,Vt,Ct+mi,Vt),this.closePath(),xt&&this.fill(),Pt&&0<Q&&this.stroke()}}function pn(ut,Ct){return ut-Ct}function bi(ut){var Ct=((16711680&ut)>>16).toString(16),Vt=((65280&ut)>>8).toString(16);return ut=((255&ut)>>0).toString(16),"#"+(Ct=2>Ct.length?"0"+Ct:Ct)+(Vt=2>Vt.length?"0"+Vt:Vt)+(2>ut.length?"0"+ut:ut)}function an(ut,Ct){var Le,Vt=this.length>>>0;for(0>(Le=0>(Le=Number(Ct)||0)?Math.ceil(Le):Math.floor(Le))&&(Le+=Vt);Le<Vt;Le++)if(Le in this&&this[Le]===ut)return Le;return-1}function $t(ut){return null===ut||typeof ut>"u"}function Et(ut){return ut.indexOf||(ut.indexOf=an),ut}function Yo(ut,Ct,Vt){var Le=ut+"_"+Ct+"_"+(Vt=Vt||"normal"),ri=ys[Le];if(isNaN(ri)){try{if(!Hs){var mi=document.body;(Hs=document.createElement("span")).innerHTML="";var Q=document.createTextNode("Mpgyi");Hs.appendChild(Q),mi.appendChild(Hs)}Hs.style.display="",cn(Hs,{position:"absolute",left:"0px",top:"-20000px",padding:"0px",margin:"0px",border:"none",whiteSpace:"pre",lineHeight:"normal",fontFamily:ut,fontSize:Ct+"px",fontWeight:Vt}),ri=Math.round(Hs.offsetHeight),Hs.style.display="none"}catch{ri=Math.ceil(1.1*Ct)}ri=Math.max(ri,Ct),ys[Le]=ri}return ri}function tn(ut,Ct){var Vt=[];if(Vt={solid:[],shortDash:[3,1],shortDot:[1,1],shortDashDot:[3,1,1,1],shortDashDotDot:[3,1,1,1,1,1],dot:[1,2],dash:[4,2],dashDot:[4,2,1,2],longDash:[8,2],longDashDot:[8,2,1,2],longDashDotDot:[8,2,1,2,1,2]}[ut||"solid"])for(var Le=0;Le<Vt.length;Le++)Vt[Le]*=Ct;else Vt=[];return Vt}function Ti(ut,Ct,Vt,Le,ri){return Le=Le||[],ri=$t(ri)?!!Ei&&{passive:!1,capture:!1}:ri,Le.push([ut,Ct,Vt,ri]),ut.addEventListener?(ut.addEventListener(Ct,Vt,ri),Vt):!!ut.attachEvent&&(ut.attachEvent("on"+Ct,Le=function(mi){(mi=mi||window.event).preventDefault=mi.preventDefault||function(){mi.returnValue=!1},mi.stopPropagation=mi.stopPropagation||function(){mi.cancelBubble=!0},Vt.call(ut,mi)}),Le)}function xi(ut,Ct,Vt){for(ut=Vt.getImageData(ut*=ls,Ct*=ls,2,2).data,Ct=!0,Vt=0;4>Vt;Vt++)if(ut[Vt]!==ut[Vt+4]|ut[Vt]!==ut[Vt+8]|ut[Vt]!==ut[Vt+12]){Ct=!1;break}return Ct?ut[0]<<16|ut[1]<<8|ut[2]:0}function en(ut,Ct,Vt){return ut in Ct?Ct[ut]:Vt[ut]}function ro(ut,Ct,Vt){if(oe&&Zo){var Le=ut.getContext("2d");ut.width=Ct*(ls=Es/(Gn=Le.webkitBackingStorePixelRatio||Le.mozBackingStorePixelRatio||Le.msBackingStorePixelRatio||Le.oBackingStorePixelRatio||Le.backingStorePixelRatio||1)),ut.height=Vt*ls,Es!==Gn&&(ut.style.width=Ct+"px",ut.style.height=Vt+"px",Le.scale(ls,ls))}else ut.width=Ct,ut.height=Vt}function Xi(ut,Ct){Ys&&(this.canvasCount|=0,window.console.log(++this.canvasCount));var Vt=document.createElement("canvas");return Vt.setAttribute("class","canvasjs-chart-canvas"),ro(Vt,ut,Ct),oe||typeof G_vmlCanvasManager>"u"||G_vmlCanvasManager.initElement(Vt),Vt}function cn(ut,Ct){for(var Vt in Ct)ut.style[Vt]=Ct[Vt]}function $n(ut,Ct,Vt){Ct.getAttribute("state")||(Ct.style.backgroundColor=ut.toolbar.itemBackgroundColor,Ct.style.color=ut.toolbar.fontColor,Ct.style.border="none",cn(Ct,{WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"})),Ct.getAttribute("state")!==Vt&&(Ct.setAttribute("state",Vt),Ct.setAttribute("type","button"),cn(Ct,{padding:"5px 12px",cursor:"pointer",float:"left",width:"40px",height:"25px",outline:"0px",verticalAlign:"baseline",lineHeight:"0"}),Ct.innerHTML="<img src='"+is[Vt].image+"' alt='"+ut._cultureInfo[Vt+"Text"]+"' />",cn(Ct.childNodes[0],{height:"95%",pointerEvents:"none"})),Ct.setAttribute("title",ut._cultureInfo[Vt+"Text"])}function zi(){for(var ut=null,Ct=0;Ct<arguments.length;Ct++)(ut=arguments[Ct]).style&&(ut.style.display="inline")}function un(){for(var ut=null,Ct=0;Ct<arguments.length;Ct++)(ut=arguments[Ct])&&ut.style&&(ut.style.display="none")}function js(ut,Ct,Vt,Le,ri){return null===ut||typeof ut>"u"?typeof Vt>"u"?Ct:Vt:(ut=parseFloat(ut.toString())*(0<=ut.toString().indexOf("%")?Ct/100:1),typeof Le<"u"&&(ut=Math.min(Le,ut),typeof ri<"u"&&(ut=Math.max(ri,ut))),!isNaN(ut)&&ut<=Ct&&0<=ut?ut:typeof Vt>"u"?Ct:Vt)}function Wi(ut,Ct,Vt,Le,ri){this._defaultsKey=ut,this._themeOptionsKey=Ct,this._index=Le,this.parent=ri,this._eventListeners=[],ut={},this.theme&&$t(this.parent)&&$t(Ct)&&$t(Le)?ut=$t(this.predefinedThemes[this.theme])?this.predefinedThemes.light1:this.predefinedThemes[this.theme]:this.parent&&this.parent.themeOptions&&this.parent.themeOptions[Ct]&&(null===Le?ut=this.parent.themeOptions[Ct]:0<this.parent.themeOptions[Ct].length&&(Le=Math.min(this.parent.themeOptions[Ct].length-1,Le),ut=this.parent.themeOptions[Ct][Le])),this.themeOptions=ut,this.options=Vt||{_isPlaceholder:!0},this.setOptions(this.options,ut)}function As(ut,Ct,Vt,Le,ri){typeof ri>"u"&&(ri=0),this._padding=ri,this._x1=ut,this._y1=Ct,this._x2=Vt,this._y2=Le,this._rightOccupied=this._leftOccupied=this._bottomOccupied=this._topOccupied=this._padding}function Ri(ut,Ct){Ri.base.constructor.call(this,"TextBlock",null,Ct,null,null),this.ctx=ut,this._isDirty=!0,this._wrappedText=null,this._initialize()}function Us(ut,Ct){Us.base.constructor.call(this,"Toolbar","toolbar",Ct,null,ut),this.chart=ut,this.canvas=ut.canvas,this.ctx=this.chart.ctx,this.optionsName="toolbar"}function fn(ut,Ct){if(fn.base.constructor.call(this,"Title","title",Ct,null,ut),this.chart=ut,this.canvas=ut.canvas,this.ctx=this.chart.ctx,this.optionsName="title",$t(this.options.margin)&&ut.options.subtitles)for(var Vt=ut.options.subtitles,Le=0;Le<Vt.length;Le++)if(($t(Vt[Le].horizontalAlign)&&"center"===this.horizontalAlign||Vt[Le].horizontalAlign===this.horizontalAlign)&&($t(Vt[Le].verticalAlign)&&"top"===this.verticalAlign||Vt[Le].verticalAlign===this.verticalAlign)&&!Vt[Le].dockInsidePlotArea==!this.dockInsidePlotArea){this.margin=0;break}typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.height=this.width=null,this.bounds={x1:null,y1:null,x2:null,y2:null}}function ln(ut,Ct,Vt){ln.base.constructor.call(this,"Subtitle","subtitles",Ct,Vt,ut),this.chart=ut,this.canvas=ut.canvas,this.ctx=this.chart.ctx,this.optionsName="subtitles",this.isOptionsInArray=!0,typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.height=this.width=null,this.bounds={x1:null,y1:null,x2:null,y2:null}}function En(){this.pool=[]}function ao(ut){var Ct;ut&&Ze[ut]&&(Ct=Ze[ut]),ao.base.constructor.call(this,"CultureInfo",null,Ct,null,null)}var Kt,Xt,xe,We,Ke,Ys=!1,Mn={},oe=!!document.createElement("canvas").getContext,Ls={Chart:{width:500,height:400,zoomEnabled:!1,zoomType:"x",backgroundColor:"white",theme:"light1",animationEnabled:!1,animationDuration:1200,dataPointWidth:null,dataPointMinWidth:null,dataPointMaxWidth:null,colorSet:"colorSet1",culture:"en",creditHref:"",creditText:"CanvasJS",interactivityEnabled:!0,exportEnabled:!1,exportFileName:"Chart",rangeChanging:null,rangeChanged:null,publicProperties:{title:"readWrite",subtitles:"readWrite",toolbar:"readWrite",toolTip:"readWrite",legend:"readWrite",axisX:"readWrite",axisY:"readWrite",axisX2:"readWrite",axisY2:"readWrite",data:"readWrite",options:"readWrite",bounds:"readOnly",container:"readOnly",selectedColorSet:"readOnly"}},Title:{padding:0,text:null,verticalAlign:"top",horizontalAlign:"center",fontSize:20,fontFamily:"Calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:oe?"transparent":null,margin:5,wrap:!0,maxWidth:null,dockInsidePlotArea:!1,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},Subtitle:{padding:0,text:null,verticalAlign:"top",horizontalAlign:"center",fontSize:14,fontFamily:"Calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:null,margin:2,wrap:!0,maxWidth:null,dockInsidePlotArea:!1,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},Toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white",publicProperties:{options:"readWrite",chart:"readOnly"}},Legend:{name:null,verticalAlign:"center",horizontalAlign:"right",fontSize:14,fontFamily:"calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",cursor:null,itemmouseover:null,itemmouseout:null,itemmousemove:null,itemclick:null,dockInsidePlotArea:!1,reversed:!1,backgroundColor:oe?"transparent":null,borderColor:oe?"transparent":null,borderThickness:0,cornerRadius:0,maxWidth:null,maxHeight:null,markerMargin:null,itemMaxWidth:null,itemWidth:null,itemWrap:!0,itemTextFormatter:null,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},ToolTip:{enabled:!0,shared:!1,animationEnabled:!0,content:null,contentFormatter:null,reversed:!1,backgroundColor:oe?"rgba(255,255,255,.9)":"rgb(255,255,255)",borderColor:null,borderThickness:2,cornerRadius:5,fontSize:14,fontColor:"black",fontFamily:"Calibri, Arial, Georgia, serif;",fontWeight:"normal",fontStyle:"italic",updated:null,hidden:null,publicProperties:{options:"readWrite",chart:"readOnly"}},Axis:{minimum:null,maximum:null,viewportMinimum:null,viewportMaximum:null,interval:null,intervalType:null,reversed:!1,logarithmic:!1,logarithmBase:10,title:null,titleFontColor:"black",titleFontSize:20,titleFontFamily:"arial",titleFontWeight:"normal",titleFontStyle:"normal",titleWrap:!0,titleMaxWidth:null,titleBackgroundColor:oe?"transparent":null,titleBorderColor:oe?"transparent":null,titleBorderThickness:0,titleCornerRadius:0,labelAngle:0,labelFontFamily:"arial",labelFontColor:"black",labelFontSize:12,labelFontWeight:"normal",labelFontStyle:"normal",labelAutoFit:!0,labelWrap:!0,labelMaxWidth:null,labelFormatter:null,labelBackgroundColor:oe?"transparent":null,labelBorderColor:oe?"transparent":null,labelBorderThickness:0,labelCornerRadius:0,labelPlacement:"outside",labelTextAlign:"left",prefix:"",suffix:"",includeZero:!1,tickLength:5,tickColor:"black",tickThickness:1,tickPlacement:"outside",lineColor:"black",lineThickness:1,lineDashType:"solid",gridColor:"#A0A0A0",gridThickness:0,gridDashType:"solid",interlacedColor:oe?"transparent":null,valueFormatString:null,margin:2,publicProperties:{options:"readWrite",stripLines:"readWrite",scaleBreaks:"readWrite",crosshair:"readWrite",bounds:"readOnly",chart:"readOnly"}},StripLine:{value:null,startValue:null,endValue:null,color:"orange",opacity:null,thickness:2,lineDashType:"solid",label:"",labelPlacement:"inside",labelAlign:"far",labelWrap:!0,labelMaxWidth:null,labelBackgroundColor:null,labelBorderColor:oe?"transparent":null,labelBorderThickness:0,labelCornerRadius:0,labelFontFamily:"arial",labelFontColor:"orange",labelFontSize:12,labelFontWeight:"normal",labelFontStyle:"normal",labelFormatter:null,showOnTop:!1,publicProperties:{options:"readWrite",axis:"readOnly",bounds:"readOnly",chart:"readOnly"}},ScaleBreaks:{autoCalculate:!1,collapsibleThreshold:"25%",maxNumberOfAutoBreaks:2,spacing:8,type:"straight",color:"#FFFFFF",fillOpacity:.9,lineThickness:2,lineColor:"#E16E6E",lineDashType:"solid",publicProperties:{options:"readWrite",customBreaks:"readWrite",axis:"readOnly",autoBreaks:"readOnly",bounds:"readOnly",chart:"readOnly"}},Break:{startValue:null,endValue:null,spacing:8,type:"straight",color:"#FFFFFF",fillOpacity:.9,lineThickness:2,lineColor:"#E16E6E",lineDashType:"solid",publicProperties:{options:"readWrite",scaleBreaks:"readOnly",bounds:"readOnly",chart:"readOnly"}},Crosshair:{enabled:!1,snapToDataPoint:!1,color:"grey",opacity:null,thickness:2,lineDashType:"solid",label:"",labelWrap:!0,labelMaxWidth:null,labelBackgroundColor:oe?"grey":null,labelBorderColor:oe?"grey":null,labelBorderThickness:0,labelCornerRadius:0,labelFontFamily:oe?"Calibri, Optima, Candara, Verdana, Geneva, sans-serif":"calibri",labelFontSize:12,labelFontColor:"#fff",labelFontWeight:"normal",labelFontStyle:"normal",labelFormatter:null,valueFormatString:null,updated:null,hidden:null,publicProperties:{options:"readWrite",axis:"readOnly",bounds:"readOnly",chart:"readOnly"}},DataSeries:{name:null,dataPoints:null,label:"",bevelEnabled:!1,highlightEnabled:!0,cursor:"default",indexLabel:"",indexLabelPlacement:"auto",indexLabelOrientation:"horizontal",indexLabelTextAlign:"left",indexLabelFontColor:"black",indexLabelFontSize:12,indexLabelFontStyle:"normal",indexLabelFontFamily:"Arial",indexLabelFontWeight:"normal",indexLabelBackgroundColor:null,indexLabelLineColor:"gray",indexLabelLineThickness:1,indexLabelLineDashType:"solid",indexLabelMaxWidth:null,indexLabelWrap:!0,indexLabelFormatter:null,lineThickness:2,lineDashType:"solid",connectNullData:!1,nullDataLineDashType:"dash",color:null,lineColor:null,risingColor:"white",fallingColor:"red",fillOpacity:null,startAngle:0,radius:null,innerRadius:null,neckHeight:null,neckWidth:null,reversed:!1,valueRepresents:null,linkedDataSeriesIndex:null,whiskerThickness:2,whiskerDashType:"solid",whiskerColor:null,whiskerLength:null,stemThickness:2,stemColor:null,stemDashType:"solid",upperBoxColor:"white",lowerBoxColor:"white",type:"column",xValueType:"number",axisXType:"primary",axisYType:"primary",axisXIndex:0,axisYIndex:0,xValueFormatString:null,yValueFormatString:null,zValueFormatString:null,percentFormatString:null,showInLegend:null,legendMarkerType:null,legendMarkerColor:null,legendText:null,legendMarkerBorderColor:oe?"transparent":null,legendMarkerBorderThickness:0,markerType:"circle",markerColor:null,markerSize:null,markerBorderColor:oe?"transparent":null,markerBorderThickness:0,mouseover:null,mouseout:null,mousemove:null,click:null,toolTipContent:null,visible:!0,publicProperties:{options:"readWrite",axisX:"readWrite",axisY:"readWrite",chart:"readOnly"}},TextBlock:{x:0,y:0,width:null,height:null,maxWidth:null,maxHeight:null,padding:0,angle:0,text:"",horizontalAlign:"center",textAlign:"left",fontSize:12,fontFamily:"calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:null,textBaseline:"top"},CultureInfo:{decimalSeparator:".",digitGroupSeparator:",",zoomText:"Zoom",panText:"Pan",resetText:"Reset",menuText:"More Options",saveJPGText:"Save as JPEG",savePNGText:"Save as PNG",printText:"Print",days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}},Ze={en:{}},at=oe?"Trebuchet MS, Helvetica, sans-serif":"Arial",rt=oe?"Impact, Charcoal, sans-serif":"Arial",Yt={colorSet1:"#4F81BC #C0504E #9BBB58 #23BFAA #8064A1 #4AACC5 #F79647 #7F6084 #77A033 #33558B #E59566".split(" "),colorSet2:"#6D78AD #51CDA0 #DF7970 #4C9CA0 #AE7D99 #C9D45C #5592AD #DF874D #52BCA8 #8E7AA3 #E3CB64 #C77B85 #C39762 #8DD17E #B57952 #FCC26C".split(" "),colorSet3:"#8CA1BC #36845C #017E82 #8CB9D0 #708C98 #94838D #F08891 #0366A7 #008276 #EE7757 #E5BA3A #F2990B #03557B #782970".split(" ")},Vi={colorSet:"colorSet1",backgroundColor:"#FFFFFF",title:{fontFamily:rt,fontSize:32,fontColor:Xt="#333333",fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:rt,fontSize:ai=14,fontColor:Xt,fontWeight:"normal",verticalAlign:"top",margin:5}],data:[{indexLabelFontFamily:at,indexLabelFontSize:ai,indexLabelFontColor:Xt,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:at,titleFontSize:hi=20,titleFontColor:Xt,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe="#000000",labelFontWeight:"normal",lineThickness:1,lineColor:Kt="#666666",tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:Ke=We="#000000",color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisX2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:Xt,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:Xt,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:Xt,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],legend:{fontFamily:at,fontSize:14,fontColor:Xt,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:at,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1},toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white"}};xe=Xt="#F5F5F5",Kt="#FFFFFF",We="#40BAF1",Ke="#F5F5F5";var $e={colorSet:"colorSet2",title:{fontFamily:at,fontSize:33,fontColor:"#3A3A3A",fontWeight:"bold",verticalAlign:"top",margin:5},subtitles:[{fontFamily:at,fontSize:ai=14,fontColor:"#3A3A3A",fontWeight:"normal",verticalAlign:"top",margin:5}],data:[{indexLabelFontFamily:at,indexLabelFontSize:ai,indexLabelFontColor:"#666666",indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:at,titleFontSize:hi=20,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:1,lineColor:"#BBBBBB",tickThickness:1,tickColor:"#BBBBBB",gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisX2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:1,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:0,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:0,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],legend:{fontFamily:at,fontSize:14,fontColor:"#3A3A3A",fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:at,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1},toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white"}};xe=Xt="#F5F5F5",rt={colorSet:"colorSet12",backgroundColor:"#2A2A2A",title:{fontFamily:rt,fontSize:32,fontColor:Xt,fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:rt,fontSize:ai=14,fontColor:Xt,fontWeight:"normal",verticalAlign:"top",margin:5}],toolbar:{itemBackgroundColor:"#666666",itemBackgroundColorOnHover:"#FF7372",buttonBorderColor:"#FF7372",buttonBorderThickness:1,fontColor:"#F5F5F5",fontColorOnHover:"#F5F5F5"},data:[{indexLabelFontFamily:at,indexLabelFontSize:ai,indexLabelFontColor:xe,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:at,titleFontSize:hi=20,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt="#FFFFFF",tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke="#F5F5F5",color:We="#40BAF1",thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisX2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],legend:{fontFamily:at,fontSize:14,fontColor:Xt,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:at,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1,fontColor:xe,backgroundColor:"rgba(0, 0, 0, .7)"}},xe=Xt="#FAFAFA";var hi,ai,Qi={light1:Vi,light2:$e,dark1:rt,dark2:{colorSet:"colorSet2",backgroundColor:"#32373A",title:{fontFamily:at,fontSize:32,fontColor:Xt,fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:at,fontSize:ai=14,fontColor:Xt,fontWeight:"normal",verticalAlign:"top",margin:5}],toolbar:{itemBackgroundColor:"#666666",itemBackgroundColorOnHover:"#FF7372",buttonBorderColor:"#FF7372",buttonBorderThickness:1,fontColor:"#F5F5F5",fontColorOnHover:"#F5F5F5"},data:[{indexLabelFontFamily:at,indexLabelFontSize:ai,indexLabelFontColor:xe,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:at,titleFontSize:hi=20,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt="#FFFFFF",tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke="#F5F5F5",color:We="#40BAF1",thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisX2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:1,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:0,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:0,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY2:[{titleFontFamily:at,titleFontSize:hi,titleFontColor:xe,titleFontWeight:"normal",labelFontFamily:at,labelFontSize:ai,labelFontColor:xe,labelFontWeight:"normal",lineThickness:0,lineColor:Kt,tickThickness:1,tickColor:Kt,gridThickness:1,gridColor:Kt,stripLines:[{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:at,labelFontSize:ai,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:Ke,color:We,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],legend:{fontFamily:at,fontSize:14,fontColor:Xt,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:at,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1,fontColor:xe,backgroundColor:"rgba(0, 0, 0, .7)"}},theme1:Vi,theme2:$e,theme3:Vi},Pi={numberDuration:1,yearDuration:314496e5,monthDuration:2592e6,weekDuration:6048e5,dayDuration:864e5,hourDuration:36e5,minuteDuration:6e4,secondDuration:1e3,millisecondDuration:1,dayOfWeekFromInt:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")};Mn.fSDec=function(ut){for(var Ct="",Vt=0;Vt<ut.length;Vt++)Ct+=String.fromCharCode(Math.ceil(ut.length/57/5)^ut.charCodeAt(Vt));return Ct},delete Ls[Mn.fSDec("Bi`su")][Mn.fSDec("bsdehuIsdg")],Mn.pro={sCH:Ls[Mn.fSDec("Bi`su")][Mn.fSDec("bsdehuIsdg")]},Mn._fTWm=function(ut){if(typeof Mn.pro.sCH>"u"&&!Br)try{var Ct,Vt=ut[Mn.fSDec("buy")];Vt[Mn.fSDec("udyuC`rdmhod")]=Mn.fSDec("unq"),Vt[Mn.fSDec("gnou")]=11+Mn.fSDec("qy!B`mhcsh-!Mtbhe`!Fs`oed-!Mtbhe`!R`or!Tohbned-!@sh`m-!r`or,rdshg"),Ct=ut.height-11,Vt[Mn.fSDec("bmd`sSdbu")](0,Ct,Vt[Mn.fSDec("ld`rtsdUdyu")](Mn.fSDec("B`ow`rKR!Ush`m")).width,11),Vt[Mn.fSDec("ghmmRuxmd")]=ut.backgroundColor,Vt[Mn.fSDec("ghmmSdbu")](0,Ct,Vt[Mn.fSDec("ld`rtsdUdyu")](Mn.fSDec("B`ow`rKR!Ush`m")).width,11),Vt[Mn.fSDec("ghmmRuxmd")]=Mn.fSDec("fsdx"),Vt[Mn.fSDec("ghmmUdyu")](Mn.fSDec("B`ow`rKR!Ush`m"),0,Ct)}catch{}};var ut,Ct,Vt,Le,ri,mi,Q,Ei=function(){var ut=!1;try{var Ct=Object.defineProperty&&Object.defineProperty({},"passive",{get:function(){return ut=!0,!1}});window.addEventListener&&(window.addEventListener("test",null,Ct),window.removeEventListener("test",null,Ct))}catch{ut=!1}return ut}(),ys={},Hs=null,In=function(){this.ctx.clearRect(0,0,this.width,this.height),this.backgroundColor&&(this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height))},Sr=function(ut){ut.width=1,ut.height=1,ut.getContext("2d")&&ut.getContext("2d").clearRect(0,0,1,1)},Lr=function(ut,Ct,Vt){return Ct=Math.min(this.width,this.height),Math.max("theme4"===this.theme?0:300<=Ct?12:11,Math.round(Ct*(ut/400)))},_o=(ut=/D{1,4}|M{1,4}|Y{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|f{1,3}|t{1,2}|T{1,2}|K|z{1,3}|"[^"]*"|'[^']*'/g,Ct="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Vt="Sun Mon Tue Wed Thu Fri Sat".split(" "),Le="January February March April May June July August September October November December".split(" "),ri="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),mi=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,Q=/[^-+\dA-Z]/g,function(xt,Pt,yt){var ct=yt?yt.days:Ct,pt=yt?yt.months:Le,wt=yt?yt.shortDays:Vt,It=yt?yt.shortMonths:ri;yt="";var Gt=!1;if(xt=xt&&xt.getTime?xt:xt?new Date(xt):new Date,isNaN(xt))throw SyntaxError("invalid date");"UTC:"===Pt.slice(0,4)&&(Pt=Pt.slice(4),Gt=!0);var re=xt[(yt=Gt?"getUTC":"get")+"Date"](),te=xt[yt+"Day"](),ie=xt[yt+"Month"](),u=xt[yt+"FullYear"](),I=xt[yt+"Hours"](),g=xt[yt+"Minutes"](),x=xt[yt+"Seconds"](),w=xt[yt+"Milliseconds"](),D=Gt?0:xt.getTimezoneOffset();return Pt.replace(ut,function(o){switch(o){case"D":return re;case"DD":return De(re,2);case"DDD":return wt[te];case"DDDD":return ct[te];case"M":return ie+1;case"MM":return De(ie+1,2);case"MMM":return It[ie];case"MMMM":return pt[ie];case"Y":return parseInt(String(u).slice(-2));case"YY":return De(String(u).slice(-2),2);case"YYY":return De(String(u).slice(-3),3);case"YYYY":return De(u,4);case"h":return I%12||12;case"hh":return De(I%12||12,2);case"H":return I;case"HH":return De(I,2);case"m":return g;case"mm":return De(g,2);case"s":return x;case"ss":return De(x,2);case"f":return De(String(w),3).slice(0,1);case"ff":return De(String(w),3).slice(0,2);case"fff":return De(String(w),3).slice(0,3);case"t":return 12>I?"a":"p";case"tt":return 12>I?"am":"pm";case"T":return 12>I?"A":"P";case"TT":return 12>I?"AM":"PM";case"K":return Gt?"UTC":(String(xt).match(mi)||[""]).pop().replace(Q,"");case"z":return(0<D?"-":"+")+Math.floor(Math.abs(D)/60);case"zz":return(0<D?"-":"+")+De(Math.floor(Math.abs(D)/60),2);case"zzz":return(0<D?"-":"+")+De(Math.floor(Math.abs(D)/60),2)+De(Math.abs(D)%60,2);default:return o.slice(1,o.length-1)}})}),Ps=function(ut,Ct,Vt){if(null===ut)return"";if(!isFinite(ut))return ut;var Le=0>(ut=Number(ut));Le&&(ut*=-1);var ri=Vt?Vt.decimalSeparator:".",mi=Vt?Vt.digitGroupSeparator:",",Q="";Ct=String(Ct),Q=1;var re=Vt="",xt=-1,Pt=[],yt=[],ct=0,pt=0,wt=0,It=!1,Gt=0;re=Ct.match(/"[^"]*"|'[^']*'|[eE][+-]*[0]+|[,]+[.]|\u2030|./g),Ct=null;for(var te=0;re&&te<re.length;te++)if("."===(Ct=re[te])&&0>xt)xt=te;else{if("%"===Ct)Q*=100;else{if("\u2030"===Ct){Q*=1e3;continue}if(","===Ct[0]&&"."===Ct[Ct.length-1]){Q/=Math.pow(1e3,Ct.length-1),xt=te+Ct.length-1;continue}"E"!==Ct[0]&&"e"!==Ct[0]||"0"!==Ct[Ct.length-1]||(It=!0)}0>xt?(Pt.push(Ct),"#"===Ct||"0"===Ct?ct++:","===Ct&&wt++):(yt.push(Ct),"#"!==Ct&&"0"!==Ct||pt++)}for(It&&(Ct=Math.floor(ut),re=-Math.floor(Math.log(ut)/Math.LN10+1),Gt=0===ut?0:0===Ct?-(ct+re):function(ut){var Ct=0>ut;if(1>Math.abs(ut)){var Vt=parseInt(ut.toString().split("e-")[1]);Vt&&(ut=(Ct?-1*ut:ut)*Math.pow(10,Vt-1),ut="0."+Array(Vt).join("0")+ut.toString().substring(2),ut=Ct?"-"+ut:ut)}else 20<(Vt=parseInt(ut.toString().split("+")[1]))&&(Vt-=20,ut=(ut/=Math.pow(10,Vt)).toString()+Array(Vt+1).join("0"));return String(ut)}(Ct).length-ct,Q/=Math.pow(10,Gt)),0>xt&&(xt=te),Ct=(Q=(ut*Q).toFixed(pt)).split("."),Q=(Ct[0]+"").split(""),ut=(Ct[1]+"").split(""),Q&&"0"===Q[0]&&Q.shift(),It=re=te=pt=xt=0;0<Pt.length;)if("#"===(Ct=Pt.pop())||"0"===Ct)if(++xt===ct){var ie=Q;if(Q=[],"0"===Ct)for(Ct=ct-pt-(ie?ie.length:0);0<Ct;)ie.unshift("0"),Ct--;for(;0<ie.length;)Vt=ie.pop()+Vt,++It%re==0&&te===wt&&0<ie.length&&(Vt=mi+Vt)}else 0<Q.length?(Vt=Q.pop()+Vt,pt++,It++):"0"===Ct&&(Vt="0"+Vt,pt++,It++),It%re==0&&te===wt&&0<Q.length&&(Vt=mi+Vt);else"E"!==Ct[0]&&"e"!==Ct[0]||"0"!==Ct[Ct.length-1]||!/[eE][+-]*[0]+/.test(Ct)?","===Ct?(te++,re=It,It=0,0<Q.length&&(Vt=mi+Vt)):Vt=1<Ct.length&&('"'===Ct[0]&&'"'===Ct[Ct.length-1]||"'"===Ct[0]&&"'"===Ct[Ct.length-1])?Ct.slice(1,Ct.length-1)+Vt:Ct+Vt:Vt+=(Ct=0>Gt?Ct.replace("+","").replace("-",""):Ct.replace("-","")).replace(/[0]+/,function(u){return De(Gt,u.length)});for(mi="",Pt=!1;0<yt.length;)"#"===(Ct=yt.shift())||"0"===Ct?0<ut.length&&0!==Number(ut.join(""))?(mi+=ut.shift(),Pt=!0):"0"===Ct&&(mi+="0",Pt=!0):1<Ct.length&&('"'===Ct[0]&&'"'===Ct[Ct.length-1]||"'"===Ct[0]&&"'"===Ct[Ct.length-1])?mi+=Ct.slice(1,Ct.length-1):"E"!==Ct[0]&&"e"!==Ct[0]||"0"!==Ct[Ct.length-1]||!/[eE][+-]*[0]+/.test(Ct)?mi+=Ct:mi+=(Ct=0>Gt?Ct.replace("+","").replace("-",""):Ct.replace("-","")).replace(/[0]+/,function(u){return De(Gt,u.length)});return Vt+=(Pt?ri:"")+mi,Le?"-"+Vt:Vt},$s=function(ut){var Ct=0,Vt=0;return(ut=ut||window.event).offsetX||0===ut.offsetX?(Ct=ut.offsetX,Vt=ut.offsetY):ut.layerX||0==ut.layerX?(Ct=ut.layerX,Vt=ut.layerY):(Ct=ut.pageX-ut.target.offsetLeft,Vt=ut.pageY-ut.target.offsetTop),{x:Ct,y:Vt}},Zo=!0,Es=window.devicePixelRatio||1,Gn=1,ls=Zo?Es/Gn:1,ps=function(ut,Ct,Vt,Le,ri,mi,Q,xt,Pt,yt,ct,pt,wt){typeof wt>"u"&&(wt=1),Q=Q||0,xt=xt||"black";var It=15<Le-Ct&&15<ri-Vt?8:.35*Math.min(Le-Ct,ri-Vt);ut.beginPath(),ut.moveTo(Ct,Vt),ut.save(),ut.fillStyle=mi,ut.globalAlpha=wt,ut.fillRect(Ct,Vt,Le-Ct,ri-Vt),ut.globalAlpha=1,0<Q&&(wt=Q%2==0?0:.5,ut.beginPath(),ut.lineWidth=Q,ut.strokeStyle=xt,ut.moveTo(Ct,Vt),ut.rect(Ct-wt,Vt-wt,Le-Ct+2*wt,ri-Vt+2*wt),ut.stroke()),ut.restore(),!0===Pt&&(ut.save(),ut.beginPath(),ut.moveTo(Ct,Vt),ut.lineTo(Ct+It,Vt+It),ut.lineTo(Le-It,Vt+It),ut.lineTo(Le,Vt),ut.closePath(),(Q=ut.createLinearGradient((Le+Ct)/2,Vt+It,(Le+Ct)/2,Vt)).addColorStop(0,mi),Q.addColorStop(1,"rgba(255, 255, 255, .4)"),ut.fillStyle=Q,ut.fill(),ut.restore()),!0===yt&&(ut.save(),ut.beginPath(),ut.moveTo(Ct,ri),ut.lineTo(Ct+It,ri-It),ut.lineTo(Le-It,ri-It),ut.lineTo(Le,ri),ut.closePath(),(Q=ut.createLinearGradient((Le+Ct)/2,ri-It,(Le+Ct)/2,ri)).addColorStop(0,mi),Q.addColorStop(1,"rgba(255, 255, 255, .4)"),ut.fillStyle=Q,ut.fill(),ut.restore()),!0===ct&&(ut.save(),ut.beginPath(),ut.moveTo(Ct,Vt),ut.lineTo(Ct+It,Vt+It),ut.lineTo(Ct+It,ri-It),ut.lineTo(Ct,ri),ut.closePath(),(Q=ut.createLinearGradient(Ct+It,(ri+Vt)/2,Ct,(ri+Vt)/2)).addColorStop(0,mi),Q.addColorStop(1,"rgba(255, 255, 255, 0.1)"),ut.fillStyle=Q,ut.fill(),ut.restore()),!0===pt&&(ut.save(),ut.beginPath(),ut.moveTo(Le,Vt),ut.lineTo(Le-It,Vt+It),ut.lineTo(Le-It,ri-It),ut.lineTo(Le,ri),(Q=ut.createLinearGradient(Le-It,(ri+Vt)/2,Le,(ri+Vt)/2)).addColorStop(0,mi),Q.addColorStop(1,"rgba(255, 255, 255, 0.1)"),ut.fillStyle=Q,Q.addColorStop(0,mi),Q.addColorStop(1,"rgba(255, 255, 255, 0.1)"),ut.fillStyle=Q,ut.fill(),ut.closePath(),ut.restore())},co=function(ut){for(var Ct="",Vt=0;Vt<ut.length;Vt++)Ct+=String.fromCharCode(Math.ceil(ut.length/57/5)^ut.charCodeAt(Vt));return Ct},Br=window&&window[co("mnb`uhno")]&&window[co("mnb`uhno")].href&&window[co("mnb`uhno")].href.indexOf&&(-1!==window[co("mnb`uhno")].href.indexOf(co("b`ow`rkr/bnl"))||-1!==window[co("mnb`uhno")].href.indexOf(co("gdonqhy/bnl"))||-1!==window[co("mnb`uhno")].href.indexOf(co("gheemd"))),Js=Br&&-1===window[co("mnb`uhno")].href.indexOf(co("gheemd")),is={reset:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAPjSURBVFhHxVdJaFNRFP1J/jwkP5MxsbaC1WJEglSxOFAXIsFpVRE3ggi1K90obioRRBA33XXnQnciirhQcMCdorgQxBkXWlREkFKsWkv5npvckp/XnzRpKh64kLw733fffe9L/wrL0+mVUdO8uTSZ3MBL/we2qg4rkuSpodCELstXE46ziVkLQ6FQcGOmeSSq6wd4aV50d3drWjj8kQKZJTUc9kxFGenv79dZrDksTSTWWJp2QYtEPiErysyzdX0LsxsCQR8keX8gs6RHIk8ysdgKFg2G53mhuOPsshTlBjKaFo1g7SqLNoShKLdFXT8huQ/paLSbxatYnc2mHMM4hr18Vi8TIvCmXF3vYrW6cF23gGTOk0M1wA4RKvOmq6vLZRVJipvmSWT6tZ6CSEYkco5V50VPT4+D7RwOqi6RiSZm0fJ+vggSqkeoypdsNmuyelNwbXsbgvkWYMtzDWNvWaijoyOBqE+hVK8abcssUeXQ/YfKyi0gFYv1Ipgfoj34fYGTJLOYJA0ODirok32GLN8XhUWCwSes1hIwBg6LydJ/tEeRRapAdUp+wSAiZchtZZWWgAZ+JNpD8peYXQVK9UwUxNpzOK8pq97kURZhYTCKBwPD7h2zK+js7Myi7D8Fod+0TkMI8+EMAngLGc/WtBFWawkFHFnoj/t9KLgGmF0B3QfkxC+EarxkdhnFYlFLY06USqUwL7UMjICHfh/wOc2sCqhpxGbCkLvL7EUDbF73+6DkmVWB6zi7xUDQSLeYvWjAILvm9zEnkJhlbRcDQZcv6Kg2AipyT/Axw6wKlqVSqxDdjF8Izfod13qURdrG/nxehY+xGh+h0CSzKygGvSNQIcc097BI24jb9hax6kj2E7OrMFX1il+ICEf2NrPbhiXLl+fYl+U7zK4iYdsDcyLGf+ofFlkwcN+s10KhmpuYhhtm0hCLVIFL0MDsqNlDIqy9x2CLs1jL6OvrI7vPRbtohXG6eFmsFnHDGAp6n9AgyuVySRZrGvROxRgIfLXhzjrNYnNBUxNX/dMgRWT1mt4XLDovaApD53E9W3ilNX5M55LJHpRtIsgAvciR4WWcgK2Dvb1YqgXevmF8z2zEBTcKG39EfSKsT9EbhVUaI2FZO+oZIqImxol6j66/hcAu4sSN4vc1ZPoKeoE6RGhYL2YYA+ymOSSi0Z0wWntbtkGUWCvfSDXIxONraZ/FY90KUfNTpfC5spnNLgxoYNnR9RO4F8ofXEHOgogCQE99w+fF2Xw+b7O59rEOsyRqGEfpVoaDMQQ1CZrG46bcM6AZ0C/wPqNfHliqejyTySxh9TqQpL+xmbIlkB9SlAAAAABJRU5ErkJggg=="},pan:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAICSURBVEhLxZbPahNRGMUn/5MpuAiBEAIufQGfzr5E40YptBXajYzudCEuGqS+gGlrFwquDGRTutBdYfydzJ3LzeQmJGZue+Dw/Z17Mnfmu5Pof9Hr9Z61Wq0bWZMKj263O6xWq99wU9lOpzPMKgEhEcRucNOcioOK+0RzBhNvt9tPV4nmVF19+OWhVqt9xXgFXZq+8lCv119UKpUJ7iX2FmvFTKz8RH34YdBsNk8wVtjE4fGYwm8wrrDi3WBG5oKXZGRSS9hGuNFojLTe2lFz5xThWZIktayyiE2FdT3rzXBXz7krKiL8c17wAKFDjCus2AvW+YGZ9y2JF0VFRuMPfI//rsCE/C+s26s4gQu9ul7r4NteKx7H8XOC724xNNGbaNu++IrBqbOV7Tj3FgMRvc/YKOr3+3sE47wgEt/Bl/gaK5cHbNU11vYSXylfpK7XOvjuumPp4Wcoipu30Qsez2uMXYz4lfI+mOmwothY+SLiXJy7mKVpWs3Si0CoOMfeI9Od43Wic+jO+ZVv+crsm9QSNhUW9LXSeoPBYLXopthGuFQgdIxxhY+UDwlt1x5CZ1hX+NTUdt/OIvjKaDSmuOJfaIVNPKX+W18j/PLA2/kR44p5Sd8HbHngT/yTfNRWUXX14ZcL3wmX0+TLf8YO7CGT8yFE5zB3/gney25/OETRP9CtPDFe5jShAAAAAElFTkSuQmCC"},zoom:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALWSURBVEhLvZZLaBNRFIabyftBIgEfqCCBoCC6MYqiXYiIj4U76U4X7sUHbhQhUBfixhZEUBDB16YuFERaUaQLK7ooCOJj4UKtYEFU0EptShO/A9Ph3js3k8lo/eHnP7n3nP/M3LlzMz1hkUwmNziOcyKRSFyFt+LxeD/c2Wq1Ym7Kv0M2m11Os1OxWGycn1OwZXCGuXfwIhezkd9/jRgNT2L4ldhs1pbkX5OLJe4euVxuGQaPCa3mnUjtJx7BDuKusJTCV6jVVGHTMuYRjxma7yIOhTgFY6jNaAKew2xPKpVay9ganmkvj+M448/MfJdT5K5Gg4HJacRngPFgqVRaRNwW1B4i7yehWfsEDdz1K+A01AoxPIqGAiuwGfkOTY8+1A6u7AyiFTB2Hu0KPIrdiOnzHLWDybeImvy+Wq2mZa5bUHsD0Zpz+KxHdWQymV6kAb1ElqeORgJLvgnRdj1+R1AfzkIvSUjxVjQSarVakrueIPT8+H1F5jSUy+WXiJrUYBVWyVxU4PEU8TzhfaijUqnMIWrjaY492eWRwdKOIqrnIxnXwLLeRLwk2GQzrEMjg0avEbXxkIxr4OoOImpj2QwyFgms1koa/SZUG8s+0iGnEhNfCNXEhzIXBVz0McTzEvJ+70P9oNFtxEzei3aFYrFYxmuSUPWSv9Yi9IMm2xE1We56Mp1OV4nDwqFmBDV9gk9AEh4gZtFHNt8W4kAUCoXF5MorY9Z/kDni9nDv7hc0i2fhgLvTtX8a99PoMPPagTFPxofRzmDJ9yM+AyEmTfgGysYbQcfhDzPPJDmX0c7gDg4gs9BqFIWhm/Nct5H8gtBq1I7UfIbtvmIuoaGQcp+fdpbbSM43eEH5wrwLbXmhm/fU63VHXjcuok7hEByFY/AeHGC8L5/PL3HT5xGH1uYwfPOICGo+CBcU0vwO1BqzUqILDl/z/9VYIMfpddiAc47jDP8BsUpb13wOLRwAAAAASUVORK5CYII="},menu:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADoSURBVFhH7dc9CsJAFATgRxIIBCwCqZKATX5sbawsY2MvWOtF9AB6AU8gguAJbD2AnZ2VXQT/Ko2TYGCL2OYtYQc+BuYA+1hCtnCVwMm27SGaXpDJIAiCvCkVR05hGOZNN3HkFMdx3nQRR06+76/R1IcFLJlNQEWlmWlBTwJtKLKHynehZqnjOGM0PYWRVXk61C37p7xlZ3Hk5HneCk1dmMH811xGoKLSzDiQwIBZB4ocoPJdqNkDt2yKlueWRVGUtzy3rPwo3sWRU3nLjuLI6OO67oZM00wMw3hrmpZx0XU9syxrR0T0BeMpb9dneSR2AAAAAElFTkSuQmCC"}};Wi.prototype.setOptions=function(ut,Ct){if(Ls[this._defaultsKey]){var Le,Vt=Ls[this._defaultsKey];for(Le in Vt)"publicProperties"!==Le&&Vt.hasOwnProperty(Le)&&(this[Le]=ut&&Le in ut?ut[Le]:Ct&&Le in Ct?Ct[Le]:Vt[Le])}else Ys&&window.console&&console.log("defaults not set")},Wi.prototype.get=function(ut){var Ct=Ls[this._defaultsKey];return"options"===ut?this.options&&this.options._isPlaceholder?null:this.options:Ct.hasOwnProperty(ut)||Ct.publicProperties&&Ct.publicProperties.hasOwnProperty(ut)?this[ut]:void(window.console&&window.console.log('Property "'+ut+"\" doesn't exist. Please check for typo."))},Wi.prototype.set=function(ut,Ct,Vt){Vt=typeof Vt>"u"||Vt;var Le=Ls[this._defaultsKey];if("options"===ut)this.createUserOptions(Ct);else{if(!(Le.hasOwnProperty(ut)||Le.publicProperties&&Le.publicProperties.hasOwnProperty(ut)&&"readWrite"===Le.publicProperties[ut]))return void(window.console&&(Le.publicProperties&&Le.publicProperties.hasOwnProperty(ut)&&"readOnly"===Le.publicProperties[ut]?window.console.log('Property "'+ut+'" is read-only.'):window.console.log('Property "'+ut+"\" doesn't exist. Please check for typo.")));this.options._isPlaceholder&&this.createUserOptions(),this.options[ut]=Ct}Vt&&(this.stockChart||this.chart||this).render()},Wi.prototype.addTo=function(ut,Ct,Vt,Le){Le=typeof Le>"u"||Le;var ri=Ls[this._defaultsKey];ri.hasOwnProperty(ut)||ri.publicProperties&&ri.publicProperties.hasOwnProperty(ut)&&"readWrite"===ri.publicProperties[ut]?(this.options._isPlaceholder&&this.createUserOptions(),typeof this.options[ut]>"u"&&(this.options[ut]=[]),(ut=this.options[ut]).splice(Vt=typeof Vt>"u"||null===Vt?ut.length:Vt,0,Ct),Le&&(this.stockChart||this.chart||this).render()):window.console&&(ri.publicProperties&&ri.publicProperties.hasOwnProperty(ut)&&"readOnly"===ri.publicProperties[ut]?window.console.log('Property "'+ut+'" is read-only.'):window.console.log('Property "'+ut+"\" doesn't exist. Please check for typo."))},Wi.prototype.createUserOptions=function(ut){if(typeof ut<"u"||this.options._isPlaceholder)if(this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.isOptionsInArray){this.parent.options[this.optionsName]||(this.parent.options[this.optionsName]=[]);var Ct=this.parent.options[this.optionsName],Vt=Ct.length;this.options._isPlaceholder||(Et(Ct),Vt=Ct.indexOf(this.options)),this.options=typeof ut>"u"?{}:ut,Ct[Vt]=this.options}else this.options=typeof ut>"u"?{}:ut,ut=this.parent.options,this.optionsName?Ct=this.optionsName:(Ct=this._defaultsKey)&&0!==Ct.length?(Vt=Ct.charAt(0).toLowerCase(),1<Ct.length&&(Vt=Vt.concat(Ct.slice(1))),Ct=Vt):Ct=void 0,ut[Ct]=this.options},Wi.prototype.remove=function(ut){if(ut=typeof ut>"u"||ut,this.isOptionsInArray){var Ct=this.parent.options[this.optionsName];Et(Ct);var Vt=Ct.indexOf(this.options);0<=Vt&&Ct.splice(Vt,1)}else delete this.parent.options[this.optionsName];ut&&(this.stockChart||this.chart||this).render()},Wi.prototype.updateOption=function(ut){!Ls[this._defaultsKey]&&Ys&&window.console&&console.log("defaults not set");var Ct=Ls[this._defaultsKey],Vt={},Le=this[ut],ri=this._themeOptionsKey,mi=this._index;return this.theme&&$t(this.parent)&&$t(ri)&&$t(mi)?Vt=$t(this.predefinedThemes[this.theme])?this.predefinedThemes.light1:this.predefinedThemes[this.theme]:this.parent&&this.parent.themeOptions&&this.parent.themeOptions[ri]&&(null===mi?Vt=this.parent.themeOptions[ri]:0<this.parent.themeOptions[ri].length&&(Vt=Math.min(this.parent.themeOptions[ri].length-1,mi),Vt=this.parent.themeOptions[ri][Vt])),this.themeOptions=Vt,ut in Ct&&(Le=ut in this.options?this.options[ut]:Vt&&ut in Vt?Vt[ut]:Ct[ut]),Le!==this[ut]&&(this[ut]=Le,!0)},Wi.prototype.trackChanges=function(ut){if(!this.sessionVariables)throw"Session Variable Store not set";this.sessionVariables[ut]=this.options[ut]},Wi.prototype.isBeingTracked=function(ut){return this.options._oldOptions||(this.options._oldOptions={}),!!this.options._oldOptions[ut]},Wi.prototype.hasOptionChanged=function(ut){if(!this.sessionVariables)throw"Session Variable Store not set";return this.sessionVariables[ut]!==this.options[ut]},Wi.prototype.addEventListener=function(ut,Ct,Vt){ut&&Ct&&(this._eventListeners[ut]=this._eventListeners[ut]||[],this._eventListeners[ut].push({context:Vt||this,eventHandler:Ct}))},Wi.prototype.removeEventListener=function(ut,Ct){if(ut&&Ct&&this._eventListeners[ut])for(var Vt=this._eventListeners[ut],Le=0;Le<Vt.length;Le++)if(Vt[Le].eventHandler===Ct){Vt[Le].splice(Le,1);break}},Wi.prototype.removeAllEventListeners=function(){this._eventListeners=[]},Wi.prototype.dispatchEvent=function(ut,Ct,Vt){if(ut&&this._eventListeners[ut]){Ct=Ct||{};for(var Le=this._eventListeners[ut],ri=0;ri<Le.length;ri++)Le[ri].eventHandler.call(Le[ri].context,Ct)}"function"==typeof this[ut]&&this[ut].call(Vt||this.chart,Ct)},As.prototype.registerSpace=function(ut,Ct){"top"===ut?this._topOccupied+=Ct.height:"bottom"===ut?this._bottomOccupied+=Ct.height:"left"===ut?this._leftOccupied+=Ct.width:"right"===ut&&(this._rightOccupied+=Ct.width)},As.prototype.unRegisterSpace=function(ut,Ct){"top"===ut?this._topOccupied-=Ct.height:"bottom"===ut?this._bottomOccupied-=Ct.height:"left"===ut?this._leftOccupied-=Ct.width:"right"===ut&&(this._rightOccupied-=Ct.width)},As.prototype.getFreeSpace=function(){return{x1:this._x1+this._leftOccupied,y1:this._y1+this._topOccupied,x2:this._x2-this._rightOccupied,y2:this._y2-this._bottomOccupied,width:this._x2-this._x1-this._rightOccupied-this._leftOccupied,height:this._y2-this._y1-this._bottomOccupied-this._topOccupied}},As.prototype.reset=function(){this._rightOccupied=this._leftOccupied=this._bottomOccupied=this._topOccupied=this._padding},On(Ri,Wi),Ri.prototype._initialize=function(){$t(this.padding)||"object"!=typeof this.padding?this.topPadding=this.rightPadding=this.bottomPadding=this.leftPadding=0|Number(this.padding):(this.topPadding=$t(this.padding.top)?0:0|Number(this.padding.top),this.rightPadding=$t(this.padding.right)?0:0|Number(this.padding.right),this.bottomPadding=$t(this.padding.bottom)?0:0|Number(this.padding.bottom),this.leftPadding=$t(this.padding.left)?0:0|Number(this.padding.left))},Ri.prototype.render=function(ut){if(0!==this.fontSize){ut&&this.ctx.save();var Ct=this.ctx.font;this.ctx.textBaseline=this.textBaseline;var Vt=0;this._isDirty&&this.measureText(this.ctx),this.ctx.translate(this.x,this.y+Vt),"middle"===this.textBaseline&&(Vt=-this._lineHeight/2),this.ctx.font=this._getFontString(),this.ctx.rotate(Math.PI/180*this.angle);var Le=0,ri=this.topPadding,mi=null;for(this.ctx.roundRect||ks(this.ctx),(0<this.borderThickness&&this.borderColor||this.backgroundColor)&&this.ctx.roundRect(0,Vt,this.width,this.height,this.cornerRadius,this.borderThickness,this.backgroundColor,this.borderColor),this.ctx.fillStyle=this.fontColor,Vt=0;Vt<this._wrappedText.lines.length;Vt++)mi=this._wrappedText.lines[Vt],"right"===this.horizontalAlign||"right"===this.textAlign?Le=this.width-mi.width-this.rightPadding:"left"===this.horizontalAlign||"left"===this.textAlign?Le=this.leftPadding:("center"===this.horizontalAlign||"center"===this.textAlign)&&(Le=(this.width-(this.leftPadding+this.rightPadding))/2-mi.width/2+this.leftPadding),this.ctx.fillText(mi.text,Le,ri),ri+=mi.height;this.ctx.font=Ct,ut&&this.ctx.restore()}},Ri.prototype.setText=function(ut){this.text=ut,this._isDirty=!0,this._wrappedText=null},Ri.prototype.measureText=function(){if(this._lineHeight=Yo(this.fontFamily,this.fontSize,this.fontWeight),null===this.maxWidth)throw"Please set maxWidth and height for TextBlock";return this._wrapText(this.ctx),this._isDirty=!1,{width:this.width,height:this.height}},Ri.prototype._getLineWithWidth=function(ut,Ct,Vt){if(!(ut=String(ut)))return{text:"",width:0};var Le=Vt=0,ri=ut.length-1,mi=1/0;for(this.ctx.font=this._getFontString();Le<=ri;){mi=Math.floor((Le+ri)/2);var Q=ut.substr(0,mi+1);if((Vt=this.ctx.measureText(Q).width)<Ct)Le=mi+1;else{if(!(Vt>Ct))break;ri=mi-1}}return Vt>Ct&&1<Q.length&&(Q=Q.substr(0,Q.length-1),Vt=this.ctx.measureText(Q).width),Ct=!0,(Q.length===ut.length||" "===ut[Q.length])&&(Ct=!1),Ct&&(1<(ut=Q.split(" ")).length&&ut.pop(),Q=ut.join(" "),Vt=this.ctx.measureText(Q).width),{text:Q,width:Vt}},Ri.prototype._wrapText=function(){var ut=new String(ho(String(this.text))),Ct=[],Vt=this.ctx.font,Le=0,ri=0;if(this.ctx.font=this._getFontString(),0===this.frontSize)ri=Le=0;else for(;0<ut.length;){var mi=this.maxHeight-(this.topPadding+this.bottomPadding),Q=this._getLineWithWidth(ut,this.maxWidth-(this.leftPadding+this.rightPadding),!1);Q.height=this._lineHeight,Ct.push(Q);var xt=ri;ri=Math.max(ri,Q.width),Le+=Q.height,ut=ho(ut.slice(Q.text.length,ut.length)),mi&&Le>mi&&(Le-=(Q=Ct.pop()).height,ri=xt)}this._wrappedText={lines:Ct,width:ri,height:Le},this.width=ri+(this.leftPadding+this.rightPadding),this.height=Le+(this.topPadding+this.bottomPadding),this.ctx.font=Vt},Ri.prototype._getFontString=function(){var ut;ut=this.fontStyle?this.fontStyle+" ":"",ut+=this.fontWeight?this.fontWeight+" ":"",ut+=this.fontSize?this.fontSize+"px ":"";var Ct=this.fontFamily?this.fontFamily+"":"";return!oe&&Ct&&"'"!==(Ct=Ct.split(",")[0])[0]&&'"'!==Ct[0]&&(Ct="'"+Ct+"'"),ut+Ct},On(Us,Wi),On(fn,Wi),fn.prototype.setLayout=function(){if(this.text){var xt,Pt,yt,ut=this.dockInsidePlotArea?this.chart.plotArea:this.chart,Ct=ut.layoutManager.getFreeSpace(),Vt=Ct.x1,Le=Ct.y1,ri=0,mi=0,Q=this.chart._menuButton&&this.chart.exportEnabled&&"top"===this.verticalAlign?22:0;"top"===this.verticalAlign||"bottom"===this.verticalAlign?(null===this.maxWidth&&(this.maxWidth=Ct.width-4-Q*("center"===this.horizontalAlign?2:1)),mi=.5*Ct.height-this.margin-2,ri=0):"center"===this.verticalAlign&&("left"===this.horizontalAlign||"right"===this.horizontalAlign?(null===this.maxWidth&&(this.maxWidth=Ct.height-4),mi=.5*Ct.width-this.margin-2):"center"===this.horizontalAlign&&(null===this.maxWidth&&(this.maxWidth=Ct.width-4),mi=.5*Ct.height-4)),$t(this.padding)||"number"!=typeof this.padding?$t(this.padding)||"object"!=typeof this.padding||(yt=this.padding.top?this.padding.top:this.padding.bottom?this.padding.bottom:0,yt+=this.padding.bottom?this.padding.bottom:this.padding.top?this.padding.top:0):yt=2*this.padding,this.wrap||(mi=Math.min(mi,1.5*this.fontSize+yt)),yt=(mi=new Ri(this.ctx,{fontSize:this.fontSize,fontFamily:this.fontFamily,fontColor:this.fontColor,fontStyle:this.fontStyle,fontWeight:this.fontWeight,horizontalAlign:this.horizontalAlign,textAlign:this.horizontalAlign,verticalAlign:this.verticalAlign,borderColor:this.borderColor,borderThickness:this.borderThickness,backgroundColor:this.backgroundColor,maxWidth:this.maxWidth,maxHeight:mi,cornerRadius:this.cornerRadius,text:this.text,padding:this.padding,textBaseline:"top"})).measureText(),"top"===this.verticalAlign||"bottom"===this.verticalAlign?("top"===this.verticalAlign?(Le=Ct.y1+2,Pt="top"):"bottom"===this.verticalAlign&&(Le=Ct.y2-2-yt.height,Pt="bottom"),"left"===this.horizontalAlign?Vt=Ct.x1+2:"center"===this.horizontalAlign?Vt=Ct.x1+Ct.width/2-yt.width/2:"right"===this.horizontalAlign&&(Vt=Ct.x2-2-yt.width-Q),xt=this.horizontalAlign,this.width=yt.width,this.height=yt.height):"center"===this.verticalAlign&&("left"===this.horizontalAlign?(Vt=Ct.x1+2,Le=Ct.y2-2-(this.maxWidth/2-yt.width/2),ri=-90,Pt="left",this.width=yt.height,this.height=yt.width):"right"===this.horizontalAlign?(Vt=Ct.x2-2,Le=Ct.y1+2+(this.maxWidth/2-yt.width/2),ri=90,Pt="right",this.width=yt.height,this.height=yt.width):"center"===this.horizontalAlign&&(Le=ut.y1+(ut.height/2-yt.height/2),Vt=ut.x1+(ut.width/2-yt.width/2),Pt="center",this.width=yt.width,this.height=yt.height),xt="center"),mi.x=Vt,mi.y=Le,mi.angle=ri,mi.horizontalAlign=xt,this._textBlock=mi,ut.layoutManager.registerSpace(Pt,{width:this.width+("left"===Pt||"right"===Pt?this.margin+2:0),height:this.height+("top"===Pt||"bottom"===Pt?this.margin+2:0)}),this.bounds={x1:Vt,y1:Le,x2:Vt+this.width,y2:Le+this.height},this.ctx.textBaseline="top"}},fn.prototype.render=function(){this._textBlock&&this._textBlock.render(!0)},On(ln,Wi),ln.prototype.setLayout=fn.prototype.setLayout,ln.prototype.render=fn.prototype.render,En.prototype.get=function(ut,Ct){var Vt=null;return 0<this.pool.length?ro(Vt=this.pool.pop(),ut,Ct):Vt=Xi(ut,Ct),Vt},En.prototype.release=function(ut){this.pool.push(ut)},On(ao,Wi);var Vs={addTheme:function(ut,Ct){Qi[ut]=Ct},addColorSet:function(ut,Ct){Yt[ut]=Ct},addCultureInfo:function(ut,Ct){Ze[ut]=Ct},formatNumber:function(ut,Ct,Vt){if(Ze[Vt=Vt||"en"])return Ps(ut,Ct||"#,##0.##",new ao(Vt));throw"Unknown Culture Name"},formatDate:function(ut,Ct,Vt){if(Ze[Vt=Vt||"en"])return _o(ut,Ct||"DD MMM YYYY",new ao(Vt));throw"Unknown Culture Name"}};typeof Qa.exports<"u"?Qa.exports=Vs:void 0!==(ss=function(){return Vs}.apply(_l,[]))&&(Qa.exports=ss),at=Vs.Chart=function(){function ut(u,I){return u.x-I.x}function Ct(u,I,g){I=I||{},$t(g)?(this.predefinedThemes=Qi,this.optionsName=this.parent=this.index=null):(this.parent=g.parent,this.index=g.index,this.predefinedThemes=g.predefinedThemes,this.optionsName=g.optionsName,this.stockChart=g.stockChart,this.panel=u,this.isOptionsInArray=g.isOptionsInArray),this.theme=$t(I.theme)||$t(this.predefinedThemes[I.theme])?"light1":I.theme,Ct.base.constructor.call(this,"Chart",this.optionsName,I,this.index,this.parent);var x=this;this._containerId=u,this._objectsInitialized=!1,this.overlaidCanvasCtx=this.ctx=null,this._indexLabels=[],this._panTimerId=0,this._lastTouchEventType="",this._lastTouchData=null,this.isAnimating=!1,this.renderCount=0,this.disableToolTip=this.animatedRender=!1,this.canvasPool=new En,this.allDOMEventHandlers=[],this.panEnabled=!1,this._defaultCursor="default",this.plotArea={canvas:null,ctx:null,x1:0,y1:0,x2:0,y2:0,width:0,height:0},this._dataInRenderedOrder=[],(this.container="string"==typeof this._containerId?document.getElementById(this._containerId):this._containerId)?(this.container.innerHTML="",I=u=0,I=this.options.height?this.height:0<this.container.clientHeight?this.container.clientHeight:this.height,this.width=u=this.options.width?this.width:0<this.container.clientWidth?this.container.clientWidth:this.width,this.height=I,this.x1=this.y1=0,this.x2=this.width,this.y2=this.height,this.selectedColorSet=typeof Yt[this.colorSet]<"u"?Yt[this.colorSet]:Yt.colorSet1,this._canvasJSContainer=document.createElement("div"),this._canvasJSContainer.setAttribute("class","canvasjs-chart-container"),this._canvasJSContainer.style.position="relative",this._canvasJSContainer.style.textAlign="left",this._canvasJSContainer.style.cursor="auto",this._canvasJSContainer.style.direction="ltr",oe||(this._canvasJSContainer.style.height="0px"),this.container.appendChild(this._canvasJSContainer),this.canvas=Xi(u,I),this._preRenderCanvas=Xi(u,I),this.canvas.style.position="absolute",this.canvas.style.WebkitUserSelect="none",this.canvas.style.MozUserSelect="none",this.canvas.style.msUserSelect="none",this.canvas.style.userSelect="none",this.canvas.getContext&&(this._canvasJSContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.textBaseline="top",ks(this.ctx),this._preRenderCtx=this._preRenderCanvas.getContext("2d"),this._preRenderCtx.textBaseline="top",ks(this._preRenderCtx),oe?this.plotArea.ctx=this.ctx:(this.plotArea.canvas=Xi(u,I),this.plotArea.canvas.style.position="absolute",this.plotArea.canvas.setAttribute("class","plotAreaCanvas"),this._canvasJSContainer.appendChild(this.plotArea.canvas),this.plotArea.ctx=this.plotArea.canvas.getContext("2d")),this.overlaidCanvas=Xi(u,I),this.overlaidCanvas.style.position="absolute",this.overlaidCanvas.style.webkitTapHighlightColor="transparent",this.overlaidCanvas.style.WebkitUserSelect="none",this.overlaidCanvas.style.MozUserSelect="none",this.overlaidCanvas.style.msUserSelect="none",this.overlaidCanvas.style.userSelect="none",this.overlaidCanvas.getContext&&(this._canvasJSContainer.appendChild(this.overlaidCanvas),this.overlaidCanvasCtx=this.overlaidCanvas.getContext("2d"),this.overlaidCanvasCtx.textBaseline="top",ks(this.overlaidCanvasCtx)),this._eventManager=new wt(this),this.windowResizeHandler=Ti(window,"resize",function(){x._updateSize()&&x.render()},this.allDOMEventHandlers),this._toolBar=document.createElement("div"),this._toolBar.setAttribute("class","canvasjs-chart-toolbar"),cn(this._toolBar,{position:"absolute",right:"1px",top:"1px"}),this._canvasJSContainer.appendChild(this._toolBar),this.bounds={x1:0,y1:0,x2:this.width,y2:this.height},Ti(this.overlaidCanvas,"click",function(w){x._mouseEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,"mousemove",function(w){x._mouseEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,"mouseup",function(w){x._mouseEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,"mousedown",function(w){x._mouseEventHandler(w),un(x._dropdownMenu)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,"mouseout",function(w){x._mouseEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(w){x._touchEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerMove":"touchmove",function(w){x._touchEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerUp":"touchend",function(w){x._touchEventHandler(w)},this.allDOMEventHandlers),Ti(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerCancel":"touchcancel",function(w){x._touchEventHandler(w)},this.allDOMEventHandlers),this.toolTip=new pt(this,this.options.toolTip),this.data=null,this.axisX=[],this.axisX2=[],this.axisY=[],this.axisY2=[],this.sessionVariables={axisX:[],axisX2:[],axisY:[],axisY2:[]})):window.console&&window.console.log('CanvasJS Error: Chart Container with id "'+this._containerId+'" was not found')}function Vt(u,I){for(var x,g=[],w=0;w<u.length;w++)if(0==w)g.push(u[0]);else{var D,o,y;D=0==(y=w-1)?0:y-1,o=y===u.length-1?y:y+1,x=Math.abs((u[o].x-u[D].x)/(u[o].x-u[y].x==0?.01:u[o].x-u[y].x))*(I-1)/2+1;var f=(u[o].x-u[D].x)/x;x=(u[o].y-u[D].y)/x,g[g.length]=u[y].x>u[D].x&&0<f||u[y].x<u[D].x&&0>f?{x:u[y].x+f/3,y:u[y].y+x/3}:{x:u[y].x,y:u[y].y+x/9},D=0===(y=w)?0:y-1,o=y===u.length-1?y:y+1,x=Math.abs((u[o].x-u[D].x)/(u[y].x-u[D].x==0?.01:u[y].x-u[D].x))*(I-1)/2+1,f=(u[o].x-u[D].x)/x,x=(u[o].y-u[D].y)/x,g[g.length]=u[y].x>u[D].x&&0<f||u[y].x<u[D].x&&0>f?{x:u[y].x-f/3,y:u[y].y-x/3}:{x:u[y].x,y:u[y].y-x/9},g[g.length]=u[w]}return g}function Le(u,I,g,x,w,D,o,y,f,c){var d=0;c?(o.color=D,y.color=D):c=1,d=Math.abs(f?w-g:x-I),d=0<o.trimLength?Math.abs(d*o.trimLength/100):Math.abs(d-o.length),f?(g+=d/2,w-=d/2):(I+=d/2,x-=d/2),d=Math.round(o.thickness)%2==1?.5:0;var M=Math.round(y.thickness)%2==1?.5:0;u.save(),u.globalAlpha=c,u.strokeStyle=y.color||D,u.lineWidth=y.thickness||2,u.setLineDash&&u.setLineDash(tn(y.dashType,y.thickness)),u.beginPath(),f&&0<y.thickness?(u.moveTo(x-o.thickness/2,Math.round((g+w)/2)-M),u.lineTo(I+o.thickness/2,Math.round((g+w)/2)-M)):0<y.thickness&&(u.moveTo(Math.round((I+x)/2)-M,g+o.thickness/2),u.lineTo(Math.round((I+x)/2)-M,w-o.thickness/2)),u.stroke(),u.strokeStyle=o.color||D,u.lineWidth=o.thickness||2,u.setLineDash&&u.setLineDash(tn(o.dashType,o.thickness)),u.beginPath(),f&&0<o.thickness?(u.moveTo(x-d,g),u.lineTo(x-d,w),u.moveTo(I+d,g),u.lineTo(I+d,w)):0<o.thickness&&(u.moveTo(I,g+d),u.lineTo(x,g+d),u.moveTo(I,w-d),u.lineTo(x,w-d)),u.stroke(),u.restore()}function ri(u,I){ri.base.constructor.call(this,"Legend","legend",I,null,u),this.chart=u,this.canvas=u.canvas,this.ctx=this.chart.ctx,this.ghostCtx=this.chart._eventManager.ghostCtx,this.items=[],this.optionsName="legend",this.height=this.width=0,this.orientation=null,this.dataSeries=[],this.bounds={x1:null,y1:null,x2:null,y2:null},typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.lineHeight=Yo(this.fontFamily,this.fontSize,this.fontWeight),this.horizontalSpacing=this.fontSize}function mi(u,I,g,x){for(mi.base.constructor.call(this,"DataSeries","data",I,g,u),this.chart=u,this.canvas=u.canvas,this._ctx=u.canvas.ctx,this.index=g,this.noDataPointsInPlotArea=0,this.id=x,this.chart._eventManager.objectMap[x]={id:x,objectType:"dataSeries",dataSeriesIndex:g},u=I.dataPoints?I.dataPoints.length:0,this.dataPointEOs=[],I=0;I<u;I++)this.dataPointEOs[I]={};this.dataPointIds=[],this.plotUnit=[],this.axisY=this.axisX=null,this.optionsName="data",this.isOptionsInArray=!0,null===this.fillOpacity&&(this.fillOpacity=this.type.match(/area/i)?.7:1),this.axisPlacement=this.getDefaultAxisPlacement(),typeof this.options.indexLabelFontSize>"u"&&(this.indexLabelFontSize=this.chart.getAutoFontSize(this.indexLabelFontSize))}function Q(u,I,g,x,w,D){if(Q.base.constructor.call(this,"Axis",I,g,x,u),this.chart=u,this.canvas=u.canvas,this.ctx=u.ctx,this.intervalStartPosition=this.maxHeight=this.maxWidth=0,this.labels=[],this.dataSeries=[],this._stripLineLabels=this._ticks=this._labels=null,this.dataInfo={min:1/0,max:-1/0,viewPortMin:1/0,viewPortMax:-1/0,minDiff:1/0},this.isOptionsInArray=!0,"axisX"===w?("left"===D||"bottom"===D?(this.optionsName="axisX",$t(this.chart.sessionVariables.axisX[x])&&(this.chart.sessionVariables.axisX[x]={}),this.sessionVariables=this.chart.sessionVariables.axisX[x]):(this.optionsName="axisX2",$t(this.chart.sessionVariables.axisX2[x])&&(this.chart.sessionVariables.axisX2[x]={}),this.sessionVariables=this.chart.sessionVariables.axisX2[x]),this.options.interval||(this.intervalType=null)):"left"===D||"bottom"===D?(this.optionsName="axisY",$t(this.chart.sessionVariables.axisY[x])&&(this.chart.sessionVariables.axisY[x]={}),this.sessionVariables=this.chart.sessionVariables.axisY[x]):(this.optionsName="axisY2",$t(this.chart.sessionVariables.axisY2[x])&&(this.chart.sessionVariables.axisY2[x]={}),this.sessionVariables=this.chart.sessionVariables.axisY2[x]),typeof this.options.titleFontSize>"u"&&(this.titleFontSize=this.chart.getAutoFontSize(this.titleFontSize)),typeof this.options.labelFontSize>"u"&&(this.labelFontSize=this.chart.getAutoFontSize(this.labelFontSize)),this.type=w,"axisX"!==w||g&&typeof g.gridThickness<"u"||(this.gridThickness=0),this._position=D,this.lineCoordinates={x1:null,y1:null,x2:null,y2:null,width:null},this.labelAngle=(this.labelAngle%360+360)%360,90<this.labelAngle&&270>this.labelAngle?this.labelAngle-=180:270<=this.labelAngle&&360>=this.labelAngle&&(this.labelAngle-=360),this.options.scaleBreaks&&(this.scaleBreaks=new xt(this.chart,this.options.scaleBreaks,++this.chart._eventManager.lastObjectId,this)),this.stripLines=[],this.options.stripLines&&0<this.options.stripLines.length)for(u=0;u<this.options.stripLines.length;u++)this.stripLines.push(new yt(this.chart,this.options.stripLines[u],u,++this.chart._eventManager.lastObjectId,this));this.options.crosshair&&(this.crosshair=new ct(this.chart,this.options.crosshair,this)),this._titleTextBlock=null,this.hasOptionChanged("viewportMinimum")&&null===this.viewportMinimum&&(this.options.viewportMinimum=void 0,this.sessionVariables.viewportMinimum=null),this.hasOptionChanged("viewportMinimum")||isNaN(this.sessionVariables.newViewportMinimum)||null===this.sessionVariables.newViewportMinimum?this.sessionVariables.newViewportMinimum=null:this.viewportMinimum=this.sessionVariables.newViewportMinimum,this.hasOptionChanged("viewportMaximum")&&null===this.viewportMaximum&&(this.options.viewportMaximum=void 0,this.sessionVariables.viewportMaximum=null),this.hasOptionChanged("viewportMaximum")||isNaN(this.sessionVariables.newViewportMaximum)||null===this.sessionVariables.newViewportMaximum?this.sessionVariables.newViewportMaximum=null:this.viewportMaximum=this.sessionVariables.newViewportMaximum,null!==this.minimum&&null!==this.viewportMinimum&&(this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum)),null!==this.maximum&&null!==this.viewportMaximum&&(this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum)),this.trackChanges("viewportMinimum"),this.trackChanges("viewportMaximum")}function xt(u,I,g,x){if(xt.base.constructor.call(this,"ScaleBreaks","scaleBreaks",I,null,x),this.id=g,this.chart=u,this.ctx=this.chart.ctx,this.axis=x,this.optionsName="scaleBreaks",this.isOptionsInArray=!1,this._appliedBreaks=[],this.customBreaks=[],this.autoBreaks=[],"string"==typeof this.spacing?(this.spacing=parseFloat(this.spacing),this.spacing=isNaN(this.spacing)?8:(10<this.spacing?10:this.spacing)+"%"):"number"!=typeof this.spacing&&(this.spacing=8),this.autoCalculate&&(this.maxNumberOfAutoBreaks=Math.min(this.maxNumberOfAutoBreaks,5)),this.options.customBreaks&&0<this.options.customBreaks.length){for(u=0;u<this.options.customBreaks.length;u++)this.customBreaks.push(new Pt(this.chart,"customBreaks",this.options.customBreaks[u],u,++this.chart._eventManager.lastObjectId,this)),"number"==typeof this.customBreaks[u].startValue&&"number"==typeof this.customBreaks[u].endValue&&this.customBreaks[u].endValue!==this.customBreaks[u].startValue&&this._appliedBreaks.push(this.customBreaks[u]);for(this._appliedBreaks.sort(function(w,D){return w.startValue-D.startValue}),u=0;u<this._appliedBreaks.length-1;u++)this._appliedBreaks[u].endValue>=this._appliedBreaks[u+1].startValue&&(this._appliedBreaks[u].endValue=Math.max(this._appliedBreaks[u].endValue,this._appliedBreaks[u+1].endValue),window.console&&window.console.log("CanvasJS Error: Breaks "+u+" and "+(u+1)+" are overlapping."),this._appliedBreaks.splice(u,2),u--)}}function Pt(u,I,g,x,w,D){Pt.base.constructor.call(this,"Break",I,g,x,D),this.id=w,this.chart=u,this.ctx=this.chart.ctx,this.scaleBreaks=D,this.optionsName=I,this.isOptionsInArray=!0,this.type=g.type?this.type:D.type,this.fillOpacity=$t(g.fillOpacity)?D.fillOpacity:this.fillOpacity,this.lineThickness=$t(g.lineThickness)?D.lineThickness:this.lineThickness,this.color=g.color?this.color:D.color,this.lineColor=g.lineColor?this.lineColor:D.lineColor,this.lineDashType=g.lineDashType?this.lineDashType:D.lineDashType,!$t(this.startValue)&&this.startValue.getTime&&(this.startValue=this.startValue.getTime()),!$t(this.endValue)&&this.endValue.getTime&&(this.endValue=this.endValue.getTime()),"number"==typeof this.startValue&&"number"==typeof this.endValue&&this.endValue<this.startValue&&(u=this.startValue,this.startValue=this.endValue,this.endValue=u),this.spacing=typeof g.spacing>"u"?D.spacing:g.spacing,"string"==typeof this.options.spacing?(this.spacing=parseFloat(this.spacing),this.spacing=isNaN(this.spacing)?0:(10<this.spacing?10:this.spacing)+"%"):"number"!=typeof this.options.spacing&&(this.spacing=D.spacing),this.size=D.parent.logarithmic?1:0}function yt(u,I,g,x,w){yt.base.constructor.call(this,"StripLine","stripLines",I,g,w),this.id=x,this.chart=u,this.ctx=this.chart.ctx,this.label=this.label,this.axis=w,this.optionsName="stripLines",this.isOptionsInArray=!0,this._thicknessType="pixel",null!==this.startValue&&null!==this.endValue&&(this.value=w.logarithmic?Math.sqrt((this.startValue.getTime?this.startValue.getTime():this.startValue)*(this.endValue.getTime?this.endValue.getTime():this.endValue)):((this.startValue.getTime?this.startValue.getTime():this.startValue)+(this.endValue.getTime?this.endValue.getTime():this.endValue))/2,this._thicknessType=null)}function ct(u,I,g){ct.base.constructor.call(this,"Crosshair","crosshair",I,null,g),this.chart=u,this.ctx=this.chart.ctx,this.axis=g,this.optionsName="crosshair",this._thicknessType="pixel"}function pt(u,I){pt.base.constructor.call(this,"ToolTip","toolTip",I,null,u),this.chart=u,this.canvas=u.canvas,this.ctx=this.chart.ctx,this.currentDataPointIndex=this.currentSeriesIndex=-1,this._prevY=this._prevX=NaN,this.containerTransitionDuration=.1,this.mozContainerTransition=this.getContainerTransition(this.containerTransitionDuration),this.optionsName="toolTip",this._initialize()}function wt(u){this.chart=u,this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.previousDataPointEventObject=null,this.ghostCanvas=Xi(this.chart.width,this.chart.height),this.ghostCtx=this.ghostCanvas.getContext("2d"),this.mouseoveredObjectMaps=[]}function It(u){this.chart=u,this.ctx=this.chart.plotArea.ctx,this.animations=[],this.animationRequestId=null}On(Ct,Wi),Ct.prototype.destroy=function(){var u=this.allDOMEventHandlers;this._animator&&this._animator.cancelAllAnimations(),this._panTimerId&&clearTimeout(this._panTimerId);for(var I=0;I<u.length;I++){var g=u[I][0],x=u[I][1],w=u[I][2],D=(D=u[I][3])||!1;g.removeEventListener?g.removeEventListener(x,w,D):g.detachEvent&&g.detachEvent("on"+x,w)}for(this.allDOMEventHandlers=[],this.removeAllEventListeners();this._canvasJSContainer&&this._canvasJSContainer.hasChildNodes();)this._canvasJSContainer.removeChild(this._canvasJSContainer.lastChild);for(;this.container&&this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);for(;this._dropdownMenu&&this._dropdownMenu.hasChildNodes();)this._dropdownMenu.removeChild(this._dropdownMenu.lastChild);this.container=this._canvasJSContainer=null,this.toolTip.container=null,this.canvas&&Sr(this.canvas),this.overlaidCanvas&&Sr(this.overlaidCanvas),this._preRenderCanvas&&Sr(this._preRenderCanvas),this._breaksCanvas&&Sr(this._breaksCanvas),this._eventManager&&this._eventManager.ghostCanvas&&Sr(this._eventManager.ghostCanvas),this._toolBar=this._dropdownMenu=this._menuButton=this._resetButton=this._zoomButton=null},Ct.prototype._updateOptions=function(){var u=this;if(this.updateOption("width"),this.updateOption("height"),this.updateOption("dataPointWidth"),this.updateOption("dataPointMinWidth"),this.updateOption("dataPointMaxWidth"),this.updateOption("interactivityEnabled"),this.updateOption("theme"),this.updateOption("colorSet")&&(this.selectedColorSet=typeof Yt[this.colorSet]<"u"?Yt[this.colorSet]:Yt.colorSet1),this.updateOption("backgroundColor"),this.backgroundColor||(this.backgroundColor="rgba(0,0,0,0)"),this.updateOption("culture"),this._cultureInfo=new ao(this.options.culture),this.updateOption("animationEnabled"),this.animationEnabled=this.animationEnabled&&oe,this.updateOption("animationDuration"),this.updateOption("rangeChanging"),this.updateOption("rangeChanged"),this.updateOption("exportEnabled"),this.updateOption("exportFileName"),this.updateOption("zoomType"),this.toolbar=new Us(this,this.options.toolbar),this.options.zoomEnabled||this.panEnabled){if(this._zoomButton)cn(this._zoomButton,{borderRight:this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,backgroundColor:u.toolbar.itemBackgroundColor,color:u.toolbar.fontColor}),$n(this,this._zoomButton,"zoom");else{var I=!1;un(this._zoomButton=document.createElement("button")),$n(this,this._zoomButton,"pan"),this._toolBar.appendChild(this._zoomButton),this._zoomButton.style.borderRight=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,Ti(this._zoomButton,"touchstart",function(x){I=!0},this.allDOMEventHandlers),Ti(this._zoomButton,"click",function(){u.zoomEnabled?(u.zoomEnabled=!1,u.panEnabled=!0,$n(u,u._zoomButton,"zoom")):(u.zoomEnabled=!0,u.panEnabled=!1,$n(u,u._zoomButton,"pan")),u.render()},this.allDOMEventHandlers),Ti(this._zoomButton,"mousemove",function(){I?I=!1:(cn(u._zoomButton,{backgroundColor:u.toolbar.itemBackgroundColorOnHover,color:u.toolbar.fontColorOnHover,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&cn(u._zoomButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},this.allDOMEventHandlers),Ti(this._zoomButton,"mouseout",function(){I||(cn(u._zoomButton,{backgroundColor:u.toolbar.itemBackgroundColor,color:u.toolbar.fontColor,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&cn(u._zoomButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},this.allDOMEventHandlers)}this._resetButton?(cn(this._resetButton,{borderRight:this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,backgroundColor:u.toolbar.itemBackgroundColor,color:u.toolbar.fontColor}),this._resetButton.title=this._cultureInfo.resetText):(I=!1,un(this._resetButton=document.createElement("button")),$n(this,this._resetButton,"reset"),this._resetButton.style.borderRight=(this.exportEnabled?this.toolbar.buttonBorderThickness:0)+"px solid "+this.toolbar.buttonBorderColor,this._toolBar.appendChild(this._resetButton),Ti(this._resetButton,"touchstart",function(x){I=!0},this.allDOMEventHandlers),Ti(this._resetButton,"click",function(){if(u.toolTip.hide(),u.toolTip&&u.toolTip.enabled&&u.toolTip.dispatchEvent("hidden",{chart:u,toolTip:u.toolTip},u.toolTip),u.zoomEnabled||u.panEnabled?(u.zoomEnabled=!0,u.panEnabled=!1,$n(u,u._zoomButton,"pan"),u._defaultCursor="default",u.overlaidCanvas.style.cursor=u._defaultCursor):(u.zoomEnabled=!1,u.panEnabled=!1),u.sessionVariables.axisX)for(var x=0;x<u.sessionVariables.axisX.length;x++)u.sessionVariables.axisX[x].newViewportMinimum=null,u.sessionVariables.axisX[x].newViewportMaximum=null;if(u.sessionVariables.axisX2)for(x=0;x<u.sessionVariables.axisX2.length;x++)u.sessionVariables.axisX2[x].newViewportMinimum=null,u.sessionVariables.axisX2[x].newViewportMaximum=null;if(u.sessionVariables.axisY)for(x=0;x<u.sessionVariables.axisY.length;x++)u.sessionVariables.axisY[x].newViewportMinimum=null,u.sessionVariables.axisY[x].newViewportMaximum=null;if(u.sessionVariables.axisY2)for(x=0;x<u.sessionVariables.axisY2.length;x++)u.sessionVariables.axisY2[x].newViewportMinimum=null,u.sessionVariables.axisY2[x].newViewportMaximum=null;u.resetOverlayedCanvas(),0>=navigator.userAgent.search("MSIE")&&cn(u._resetButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}),un(u._zoomButton,u._resetButton),u.stockChart&&(u.stockChart._rangeEventParameter={stockChart:u.stockChart,source:"chart",index:u.stockChart.charts.indexOf(u),minimum:null,maximum:null}),u._dispatchRangeEvent("rangeChanging","reset"),u.stockChart&&(u.stockChart._rangeEventParameter.type="rangeChanging",u.stockChart.dispatchEvent("rangeChanging",u.stockChart._rangeEventParameter,u.stockChart)),u.render(),u.syncCharts&&u.syncCharts(null,null),u._dispatchRangeEvent("rangeChanged","reset"),u.stockChart&&(u.stockChart._rangeEventParameter.type="rangeChanged",u.stockChart.dispatchEvent("rangeChanged",u.stockChart._rangeEventParameter,u.stockChart))},this.allDOMEventHandlers),Ti(this._resetButton,"mousemove",function(){I||(cn(u._resetButton,{backgroundColor:u.toolbar.itemBackgroundColorOnHover,color:u.toolbar.fontColorOnHover,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&cn(u._resetButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},this.allDOMEventHandlers),Ti(this._resetButton,"mouseout",function(){I||(cn(u._resetButton,{backgroundColor:u.toolbar.itemBackgroundColor,color:u.toolbar.fontColor,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&cn(u._resetButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},this.allDOMEventHandlers),this.overlaidCanvas.style.cursor=u._defaultCursor),this.zoomEnabled||this.panEnabled||(this._zoomButton?(u._zoomButton.getAttribute("state")===u._cultureInfo.zoomText?(this.panEnabled=!0,this.zoomEnabled=!1):(this.zoomEnabled=!0,this.panEnabled=!1),zi(u._zoomButton,u._resetButton)):(this.zoomEnabled=!0,this.panEnabled=!1))}else this.panEnabled=this.zoomEnabled=!1;for(var g in function Li(ut){if(ut._menuButton)ut.exportEnabled?(cn(ut._menuButton,{backgroundColor:ut.toolbar.itemBackgroundColor,color:ut.toolbar.fontColor}),zi(ut._menuButton),$n(ut,ut._menuButton,"menu")):un(ut._menuButton);else if(ut.exportEnabled&&oe){var Ct=!1;ut._menuButton=document.createElement("button"),$n(ut,ut._menuButton,"menu"),ut._toolBar.appendChild(ut._menuButton),Ti(ut._menuButton,"touchstart",function(mi){Ct=!0},ut.allDOMEventHandlers),Ti(ut._menuButton,"click",function(){"none"!==ut._dropdownMenu.style.display||ut._dropDownCloseTime&&500>=(new Date).getTime()-ut._dropDownCloseTime.getTime()||(ut._dropdownMenu.style.display="block",ut._menuButton.blur(),ut._dropdownMenu.focus())},ut.allDOMEventHandlers,!0),Ti(ut._menuButton,"mousemove",function(){Ct||(cn(ut._menuButton,{backgroundColor:ut.toolbar.itemBackgroundColorOnHover,color:ut.toolbar.fontColorOnHover}),0>=navigator.userAgent.search("MSIE")&&cn(ut._menuButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},ut.allDOMEventHandlers,!0),Ti(ut._menuButton,"mouseout",function(){Ct||(cn(ut._menuButton,{backgroundColor:ut.toolbar.itemBackgroundColor,color:ut.toolbar.fontColor}),0>=navigator.userAgent.search("MSIE")&&cn(ut._menuButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},ut.allDOMEventHandlers,!0)}if(ut.exportEnabled&&ut._dropdownMenu){cn(ut._dropdownMenu,{backgroundColor:ut.toolbar.itemBackgroundColor,color:ut.toolbar.fontColor});for(var Vt=ut._dropdownMenu.childNodes,Le=[ut._cultureInfo.printText,ut._cultureInfo.saveJPGText,ut._cultureInfo.savePNGText],ri=0;ri<Vt.length;ri++)cn(Vt[ri],{backgroundColor:ut.toolbar.itemBackgroundColor,color:ut.toolbar.fontColor}),Vt[ri].innerHTML=Le[ri]}else!ut._dropdownMenu&&ut.exportEnabled&&oe&&(Ct=!1,ut._dropdownMenu=document.createElement("div"),ut._dropdownMenu.setAttribute("tabindex",-1),Vt=-1!==ut.theme.indexOf("dark")?"black":"#888888",cn(ut._dropdownMenu,{position:"absolute",zIndex:1,userSelect:"none",MozUserSeelct:"none",WebkitUserSelect:"none",msUserSelect:"none",cursor:"pointer",right:"0px",top:"25px",minWidth:"120px",outline:0,fontSize:"14px",fontFamily:"Arial, Helvetica, sans-serif",padding:"5px 0px 5px 0px",textAlign:"left",lineHeight:"10px",backgroundColor:ut.toolbar.itemBackgroundColor,boxShadow:"2px 2px 10px"+Vt}),ut._dropdownMenu.style.display="none",ut._toolBar.appendChild(ut._dropdownMenu),Ti(ut._dropdownMenu,"blur",function(){un(ut._dropdownMenu),ut._dropDownCloseTime=new Date},ut.allDOMEventHandlers,!0),cn(Vt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Vt.innerHTML=ut._cultureInfo.printText,Vt.style.backgroundColor=ut.toolbar.itemBackgroundColor,Vt.style.color=ut.toolbar.fontColor,ut._dropdownMenu.appendChild(Vt),Ti(Vt,"touchstart",function(mi){Ct=!0},ut.allDOMEventHandlers),Ti(Vt,"mousemove",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColorOnHover,this.style.color=ut.toolbar.fontColorOnHover)},ut.allDOMEventHandlers,!0),Ti(Vt,"mouseout",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColor,this.style.color=ut.toolbar.fontColor)},ut.allDOMEventHandlers,!0),Ti(Vt,"click",function(){ut.print(),un(ut._dropdownMenu)},ut.allDOMEventHandlers,!0),cn(Vt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Vt.innerHTML=ut._cultureInfo.saveJPGText,Vt.style.backgroundColor=ut.toolbar.itemBackgroundColor,Vt.style.color=ut.toolbar.fontColor,ut._dropdownMenu.appendChild(Vt),Ti(Vt,"touchstart",function(mi){Ct=!0},ut.allDOMEventHandlers),Ti(Vt,"mousemove",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColorOnHover,this.style.color=ut.toolbar.fontColorOnHover)},ut.allDOMEventHandlers,!0),Ti(Vt,"mouseout",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColor,this.style.color=ut.toolbar.fontColor)},ut.allDOMEventHandlers,!0),Ti(Vt,"click",function(){ut.exportChart({format:"jpeg",fileName:ut.exportFileName}),un(ut._dropdownMenu)},ut.allDOMEventHandlers,!0),cn(Vt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Vt.innerHTML=ut._cultureInfo.savePNGText,Vt.style.backgroundColor=ut.toolbar.itemBackgroundColor,Vt.style.color=ut.toolbar.fontColor,ut._dropdownMenu.appendChild(Vt),Ti(Vt,"touchstart",function(mi){Ct=!0},ut.allDOMEventHandlers),Ti(Vt,"mousemove",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColorOnHover,this.style.color=ut.toolbar.fontColorOnHover)},ut.allDOMEventHandlers,!0),Ti(Vt,"mouseout",function(){Ct||(this.style.backgroundColor=ut.toolbar.itemBackgroundColor,this.style.color=ut.toolbar.fontColor)},ut.allDOMEventHandlers,!0),Ti(Vt,"click",function(){ut.exportChart({format:"png",fileName:ut.exportFileName}),un(ut._dropdownMenu)},ut.allDOMEventHandlers,!0))}(this),"none"!==this._toolBar.style.display&&this._zoomButton&&($n(u,u._zoomButton,this.panEnabled?"zoom":"pan"),u._resetButton.getAttribute("state")!==u._cultureInfo.resetText&&$n(u,u._resetButton,"reset")),this.options.toolTip&&this.toolTip.options!==this.options.toolTip&&(this.toolTip.options=this.options.toolTip),this.toolTip.options)this.toolTip.options.hasOwnProperty(g)&&this.toolTip.updateOption(g)},Ct.prototype._updateSize=function(){var u;u=[this.canvas,this.overlaidCanvas,this._eventManager.ghostCanvas];var I=0,g=0;if(this.options.width?I=this.width:this.width=I=0<this.container.clientWidth?this.container.clientWidth:this.width,this.options.height?g=this.height:this.height=g=0<this.container.clientHeight?this.container.clientHeight:this.height,this.canvas.width!==I*ls||this.canvas.height!==g*ls){for(var x=0;x<u.length;x++)ro(u[x],I,g);this.bounds={x1:0,y1:0,x2:this.width,y2:this.height,width:this.width,height:this.height},u=!0}else u=!1;return u},Ct.prototype._initialize=function(){this.isNavigator=!($t(this.parent)||$t(this.parent._defaultsKey)||"Navigator"!==this.parent._defaultsKey),this._animator?this._animator.cancelAllAnimations():this._animator=new It(this),this.removeAllEventListeners(),this.disableToolTip=!1,this._axes=[],this.funnelPyramidClickHandler=this.pieDoughnutClickHandler=null,this._updateOptions(),this.animatedRender=oe&&this.animationEnabled&&0===this.renderCount,this._updateSize(),this.clearCanvas(),this.ctx.beginPath(),this.axisX=[],this.axisX2=[],this.axisY=[],this.axisY2=[],this._indexLabels=[],this._dataInRenderedOrder=[],this._events=[],this._eventManager&&this._eventManager.reset(),this.plotInfo={axisPlacement:null,plotTypes:[]},this.layoutManager=new As(0,0,this.width,this.height,this.isNavigator?0:2),this.plotArea.layoutManager&&this.plotArea.layoutManager.reset(),this.data=[],this.title=null,this.subtitles=[];var u=0,I=null;if(this.options.data){for(var g=0;g<this.options.data.length;g++)if(u++,!this.options.data[g].type||0<=Ct._supportedChartTypes.indexOf(this.options.data[g].type)){var x=new mi(this,this.options.data[g],u-1,++this._eventManager.lastObjectId);"error"===x.type&&(x.linkedDataSeriesIndex=$t(this.options.data[g].linkedDataSeriesIndex)?g-1:this.options.data[g].linkedDataSeriesIndex,0>x.linkedDataSeriesIndex||x.linkedDataSeriesIndex>=this.options.data.length||"number"!=typeof x.linkedDataSeriesIndex||"error"===this.options.data[x.linkedDataSeriesIndex].type)&&(x.linkedDataSeriesIndex=null),null===x.name&&(x.name="DataSeries "+u),null===x.color?1<this.options.data.length?(x._colorSet=[this.selectedColorSet[x.index%this.selectedColorSet.length]],x.color=this.selectedColorSet[x.index%this.selectedColorSet.length]):x._colorSet="line"===x.type||"stepLine"===x.type||"spline"===x.type||"area"===x.type||"stepArea"===x.type||"splineArea"===x.type||"stackedArea"===x.type||"stackedArea100"===x.type||"rangeArea"===x.type||"rangeSplineArea"===x.type||"candlestick"===x.type||"ohlc"===x.type||"waterfall"===x.type||"boxAndWhisker"===x.type?[this.selectedColorSet[0]]:this.selectedColorSet:x._colorSet=[x.color],null===x.markerSize&&(("line"===x.type||"stepLine"===x.type||"spline"===x.type||0<=x.type.toLowerCase().indexOf("area"))&&x.dataPoints&&x.dataPoints.length<this.width/16||"scatter"===x.type)&&(x.markerSize=8),"bubble"!==x.type&&"scatter"!==x.type||!x.dataPoints||(x.dataPoints.some?x.dataPoints.some(function(y){return y.x})&&x.dataPoints.sort(ut):x.dataPoints.sort(ut)),this.data.push(x);var D,w=x.axisPlacement;if(I=I||w,"normal"===w?"xySwapped"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with bar chart':"none"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with pie chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="normal"):"xySwapped"===w?"normal"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with line, area, column or pie chart':"none"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with pie chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="xySwapped"):"none"===w?"normal"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with line, area, column or bar chart':"xySwapped"===this.plotInfo.axisPlacement?D='You cannot combine "'+x.type+'" with bar chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="none"):null===w&&"none"===this.plotInfo.axisPlacement&&(D='You cannot combine "'+x.type+'" with pie chart'),D&&window.console)return void window.console.log(D)}for(g=0;g<this.data.length;g++){if("none"==I&&"error"===this.data[g].type&&window.console)return void window.console.log('You cannot combine "'+x.type+'" with error chart');"error"===this.data[g].type&&(this.data[g].axisPlacement=this.plotInfo.axisPlacement=I||"normal",this.data[g]._linkedSeries=null===this.data[g].linkedDataSeriesIndex?null:this.data[this.data[g].linkedDataSeriesIndex])}}this._objectsInitialized=!0,this._plotAreaElements=[]},Ct._supportedChartTypes=Et("line stepLine spline column area stepArea splineArea bar bubble scatter stackedColumn stackedColumn100 stackedBar stackedBar100 stackedArea stackedArea100 candlestick ohlc boxAndWhisker rangeColumn error rangeBar rangeArea rangeSplineArea pie doughnut funnel pyramid waterfall".split(" ")),Ct.prototype.setLayout=function(){for(var u=this._plotAreaElements,I=0;I<this.data.length;I++)if("normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement){if(!this.data[I].axisYType||"primary"===this.data[I].axisYType)if(this.options.axisY&&0<this.options.axisY.length){if(!this.axisY.length)for(var g=0;g<this.options.axisY.length;g++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY[g]=new Q(this,"axisY",this.options.axisY[g],g,"axisY","left")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY[g]=new Q(this,"axisY",this.options.axisY[g],g,"axisY","bottom"));this.data[I].axisY=this.axisY[0<=this.data[I].axisYIndex&&this.data[I].axisYIndex<this.axisY.length?this.data[I].axisYIndex:0],this.axisY[0<=this.data[I].axisYIndex&&this.data[I].axisYIndex<this.axisY.length?this.data[I].axisYIndex:0].dataSeries.push(this.data[I])}else this.axisY.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY[0]=new Q(this,"axisY",this.options.axisY,0,"axisY","left")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY[0]=new Q(this,"axisY",this.options.axisY,0,"axisY","bottom"))),this.data[I].axisY=this.axisY[0],this.axisY[0].dataSeries.push(this.data[I]);if("secondary"===this.data[I].axisYType)if(this.options.axisY2&&0<this.options.axisY2.length){if(!this.axisY2.length)for(g=0;g<this.options.axisY2.length;g++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY2[g]=new Q(this,"axisY2",this.options.axisY2[g],g,"axisY","right")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY2[g]=new Q(this,"axisY2",this.options.axisY2[g],g,"axisY","top"));this.data[I].axisY=this.axisY2[0<=this.data[I].axisYIndex&&this.data[I].axisYIndex<this.axisY2.length?this.data[I].axisYIndex:0],this.axisY2[0<=this.data[I].axisYIndex&&this.data[I].axisYIndex<this.axisY2.length?this.data[I].axisYIndex:0].dataSeries.push(this.data[I])}else this.axisY2.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY2[0]=new Q(this,"axisY2",this.options.axisY2,0,"axisY","right")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY2[0]=new Q(this,"axisY2",this.options.axisY2,0,"axisY","top"))),this.data[I].axisY=this.axisY2[0],this.axisY2[0].dataSeries.push(this.data[I]);if(!this.data[I].axisXType||"primary"===this.data[I].axisXType)if(this.options.axisX&&0<this.options.axisX.length){if(!this.axisX.length)for(g=0;g<this.options.axisX.length;g++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX[g]=new Q(this,"axisX",this.options.axisX[g],g,"axisX","bottom")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX[g]=new Q(this,"axisX",this.options.axisX[g],g,"axisX","left"));this.data[I].axisX=this.axisX[0<=this.data[I].axisXIndex&&this.data[I].axisXIndex<this.axisX.length?this.data[I].axisXIndex:0],this.axisX[0<=this.data[I].axisXIndex&&this.data[I].axisXIndex<this.axisX.length?this.data[I].axisXIndex:0].dataSeries.push(this.data[I])}else this.axisX.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX[0]=new Q(this,"axisX",this.options.axisX,0,"axisX","bottom")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX[0]=new Q(this,"axisX",this.options.axisX,0,"axisX","left"))),this.data[I].axisX=this.axisX[0],this.axisX[0].dataSeries.push(this.data[I]);if("secondary"===this.data[I].axisXType)if(this.options.axisX2&&0<this.options.axisX2.length){if(!this.axisX2.length)for(g=0;g<this.options.axisX2.length;g++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX2[g]=new Q(this,"axisX2",this.options.axisX2[g],g,"axisX","top")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX2[g]=new Q(this,"axisX2",this.options.axisX2[g],g,"axisX","right"));this.data[I].axisX=this.axisX2[0<=this.data[I].axisXIndex&&this.data[I].axisXIndex<this.axisX2.length?this.data[I].axisXIndex:0],this.axisX2[0<=this.data[I].axisXIndex&&this.data[I].axisXIndex<this.axisX2.length?this.data[I].axisXIndex:0].dataSeries.push(this.data[I])}else this.axisX2.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX2[0]=new Q(this,"axisX2",this.options.axisX2,0,"axisX","top")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX2[0]=new Q(this,"axisX2",this.options.axisX2,0,"axisX","right"))),this.data[I].axisX=this.axisX2[0],this.axisX2[0].dataSeries.push(this.data[I])}if(this.axisY){for(g=1;g<this.axisY.length;g++)typeof this.axisY[g].options.gridThickness>"u"&&(this.axisY[g].gridThickness=0);for(g=0;g<this.axisY.length-1;g++)typeof this.axisY[g].options.margin>"u"&&(this.axisY[g].margin=10)}if(this.axisY2){for(g=1;g<this.axisY2.length;g++)typeof this.axisY2[g].options.gridThickness>"u"&&(this.axisY2[g].gridThickness=0);for(g=0;g<this.axisY2.length-1;g++)typeof this.axisY2[g].options.margin>"u"&&(this.axisY2[g].margin=10)}if(this.axisY&&0<this.axisY.length&&this.axisY2&&0<this.axisY2.length&&(0<this.axisY[0].gridThickness&&typeof this.axisY2[0].options.gridThickness>"u"?this.axisY2[0].gridThickness=0:0<this.axisY2[0].gridThickness&&typeof this.axisY[0].options.gridThickness>"u"&&(this.axisY[0].gridThickness=0)),this.axisX)for(g=0;g<this.axisX.length;g++)typeof this.axisX[g].options.gridThickness>"u"&&(this.axisX[g].gridThickness=0);if(this.axisX2)for(g=0;g<this.axisX2.length;g++)typeof this.axisX2[g].options.gridThickness>"u"&&(this.axisX2[g].gridThickness=0);if(this.axisX&&0<this.axisX.length&&this.axisX2&&0<this.axisX2.length&&(0<this.axisX[0].gridThickness&&typeof this.axisX2[0].options.gridThickness>"u"?this.axisX2[0].gridThickness=0:0<this.axisX2[0].gridThickness&&typeof this.axisX[0].options.gridThickness>"u"&&(this.axisX[0].gridThickness=0)),g=!1,0<this._axes.length&&this.options.zoomEnabled&&(this.zoomEnabled||this.panEnabled))for(I=0;I<this._axes.length;I++)if(!$t(this._axes[I].viewportMinimum)||!$t(this._axes[I].viewportMaximum)){g=!0;break}if(g?(zi(this._zoomButton,this._resetButton),this._toolBar.style.border=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,this._zoomButton.style.borderRight=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,this._resetButton.style.borderRight=(this.exportEnabled?this.toolbar.buttonBorderThickness:0)+"px solid "+this.toolbar.buttonBorderColor):(un(this._zoomButton,this._resetButton),this._toolBar.style.border=this.toolbar.buttonBorderThickness+"px solid transparent",this.options.zoomEnabled&&(this.zoomEnabled=!0,this.panEnabled=!1)),function fo(ut){Mn.fSDec&&ut[co("`eeDwdouMhrudods")](co("e`u`@ohl`uhnoHuds`uhnoDoe"),function(){Mn._fTWm&&Mn._fTWm(ut)})}(this),this._processData(),this.options.title&&(this.title=new fn(this,this.options.title),this.title.dockInsidePlotArea?u.push(this.title):this.title.setLayout()),this.options.subtitles)for(I=0;I<this.options.subtitles.length;I++)g=new ln(this,this.options.subtitles[I],I),this.subtitles.push(g),g.dockInsidePlotArea?u.push(g):g.setLayout();for(this.legend=new ri(this,this.options.legend),I=0;I<this.data.length;I++)(this.data[I].showInLegend||"pie"===this.data[I].type||"doughnut"===this.data[I].type||"funnel"===this.data[I].type||"pyramid"===this.data[I].type)&&this.legend.dataSeries.push(this.data[I]);for(this.legend.dockInsidePlotArea?u.push(this.legend):this.legend.setLayout(),I=0;I<this._axes.length;I++)if(this._axes[I].scaleBreaks&&this._axes[I].scaleBreaks._appliedBreaks.length){oe?(this._breaksCanvas=Xi(this.width,this.height),this._breaksCanvasCtx=this._breaksCanvas.getContext("2d")):(this._breaksCanvas=this.canvas,this._breaksCanvasCtx=this.ctx);break}this._preRenderCanvas=Xi(this.width,this.height),this._preRenderCtx=this._preRenderCanvas.getContext("2d"),"normal"!==this.plotInfo.axisPlacement&&"xySwapped"!==this.plotInfo.axisPlacement||Q.setLayout(this.axisX,this.axisX2,this.axisY,this.axisY2,this.plotInfo.axisPlacement,this.layoutManager.getFreeSpace())},Ct.prototype.renderElements=function(){var x=this._plotAreaElements;this.title&&!this.title.dockInsidePlotArea&&this.title.render();for(var u=0;u<this.subtitles.length;u++)this.subtitles[u].dockInsidePlotArea||this.subtitles[u].render();if(this.legend.dockInsidePlotArea||this.legend.render(),"normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement)Q.render(this.axisX,this.axisX2,this.axisY,this.axisY2,this.plotInfo.axisPlacement);else{if("none"!==this.plotInfo.axisPlacement)return;this.preparePlotArea()}for(u=0;u<x.length;u++)x[u].setLayout(),x[u].render();var w,I=[];if(this.animatedRender){var g=Xi(this.width,this.height);g.getContext("2d").drawImage(this.canvas,0,0,this.width,this.height)}for(function yo(ut){if(!Js){var Ct=!1,Vt=!1;typeof Ls.Chart.creditHref>"u"?(ut.creditHref=co("iuuqr;..b`ow`rkr/bnl."),ut.creditText=co("B`ow`rKR/bnl")):(Ct=ut.updateOption("creditText"),Vt=ut.updateOption("creditHref")),ut.creditHref&&ut.creditText&&(ut._creditLink||(ut._creditLink=document.createElement("a"),ut._creditLink.setAttribute("class","canvasjs-chart-credit"),ut._creditLink.setAttribute("title","JavaScript Charts"),cn(ut._creditLink,{outline:"none",margin:"0px",position:"absolute",right:"2px",top:ut.height-14+"px",color:"dimgrey",textDecoration:"none",fontSize:"11px",fontFamily:"Calibri, Lucida Grande, Lucida Sans Unicode, Arial, sans-serif"}),ut._creditLink.setAttribute("tabIndex",-1),ut._creditLink.setAttribute("target","_blank")),(0===ut.renderCount||Ct||Vt)&&(ut._creditLink.setAttribute("href",ut.creditHref),ut._creditLink.innerHTML=ut.creditText),ut._creditLink&&ut.creditHref&&ut.creditText?(ut._creditLink.parentElement||ut._canvasJSContainer.appendChild(ut._creditLink),ut._creditLink.style.top=ut.height-14+"px"):ut._creditLink.parentElement&&ut._canvasJSContainer.removeChild(ut._creditLink))}}(this),x=this.ctx.miterLimit,this.ctx.miterLimit=3,oe&&this._breaksCanvas&&(this._preRenderCtx.drawImage(this.canvas,0,0,this.width,this.height),this._preRenderCtx.drawImage(this._breaksCanvas,0,0,this.width,this.height),this._breaksCanvasCtx.globalCompositeOperation="source-atop",this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),this._preRenderCtx.clearRect(0,0,this.width,this.height)),u=0;u<this.plotInfo.plotTypes.length;u++)for(var D=this.plotInfo.plotTypes[u],o=0;o<D.plotUnits.length;o++){var y=D.plotUnits[o],f=null;y.targetCanvas&&Sr(y.targetCanvas),y.targetCanvas=null,this.animatedRender&&(y.targetCanvas=Xi(this.width,this.height),y.targetCanvasCtx=y.targetCanvas.getContext("2d"),w=y.targetCanvasCtx.miterLimit,y.targetCanvasCtx.miterLimit=3),"line"===y.type?f=this.renderLine(y):"stepLine"===y.type?f=this.renderStepLine(y):"spline"===y.type?f=this.renderSpline(y):"column"===y.type?f=this.renderColumn(y):"bar"===y.type?f=this.renderBar(y):"area"===y.type?f=this.renderArea(y):"stepArea"===y.type?f=this.renderStepArea(y):"splineArea"===y.type?f=this.renderSplineArea(y):"stackedColumn"===y.type?f=this.renderStackedColumn(y):"stackedColumn100"===y.type?f=this.renderStackedColumn100(y):"stackedBar"===y.type?f=this.renderStackedBar(y):"stackedBar100"===y.type?f=this.renderStackedBar100(y):"stackedArea"===y.type?f=this.renderStackedArea(y):"stackedArea100"===y.type?f=this.renderStackedArea100(y):"bubble"===y.type?f=f=this.renderBubble(y):"scatter"===y.type?f=this.renderScatter(y):"pie"===y.type||"doughnut"===y.type?this.renderPie(y):"funnel"===y.type||"pyramid"===y.type?f=this.renderFunnel(y):"candlestick"===y.type||"ohlc"===y.type?f=this.renderCandlestick(y):"rangeColumn"===y.type?f=this.renderRangeColumn(y):"error"===y.type?f=this.renderError(y):"rangeBar"===y.type?f=this.renderRangeBar(y):"rangeArea"===y.type?f=this.renderRangeArea(y):"rangeSplineArea"===y.type?f=this.renderRangeSplineArea(y):"waterfall"===y.type?f=this.renderWaterfall(y):"boxAndWhisker"===y.type&&(f=this.renderBoxAndWhisker(y));for(var c=0;c<y.dataSeriesIndexes.length;c++)this._dataInRenderedOrder.push(this.data[y.dataSeriesIndexes[c]]);this.animatedRender&&(y.targetCanvasCtx.miterLimit=w,f&&I.push(f))}this.ctx.miterLimit=x,this.animatedRender&&this._breaksCanvasCtx&&I.push({source:this._breaksCanvasCtx,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0,startTimePercent:.7}),this.animatedRender&&0<this._indexLabels.length&&(w=Xi(this.width,this.height).getContext("2d"),I.push(this.renderIndexLabels(w)));var d=this;if(0<I.length)d.disableToolTip=!0,d._animator.animate(200,d.animationDuration,function(M){d.ctx.clearRect(0,0,d.width,d.height),d.ctx.drawImage(g,0,0,Math.floor(d.width*ls),Math.floor(d.height*ls),0,0,d.width,d.height);for(var k=0;k<I.length;k++)f=I[k],1>M&&typeof f.startTimePercent<"u"?M>=f.startTimePercent&&f.animationCallback(f.easingFunction(M-f.startTimePercent,0,1,1-f.startTimePercent),f):f.animationCallback(f.easingFunction(M,0,1,1),f);d.dispatchEvent("dataAnimationIterationEnd",{chart:d})},function(){I=[];for(var M=0;M<d.plotInfo.plotTypes.length;M++)for(var k=d.plotInfo.plotTypes[M],C=0;C<k.plotUnits.length;C++){var R=k.plotUnits[C];R.targetCanvas&&Sr(R.targetCanvas),R.targetCanvas=null}g=null,d.disableToolTip=!1,d.dispatchEvent("dataAnimationEnd",{chart:d})});else{if(d._breaksCanvas)if(oe)d.plotArea.ctx.drawImage(d._breaksCanvas,0,0,this.width,this.height);else for(c=0;c<d._axes.length;c++)d._axes[c].createMask();0<d._indexLabels.length&&d.renderIndexLabels(),d.dispatchEvent("dataAnimationIterationEnd",{chart:d}),d.dispatchEvent("dataAnimationEnd",{chart:d})}for(this.attachPlotAreaEventHandlers(),this.zoomEnabled||this.panEnabled||!this._zoomButton||"none"===this._zoomButton.style.display||un(this._zoomButton,this._resetButton),this.toolTip._updateToolTip(),this.renderCount++,Ys&&(d=this,setTimeout(function(){var M=document.getElementById("ghostCanvasCopy");M&&(ro(M,d.width,d.height),M.getContext("2d").drawImage(d._eventManager.ghostCanvas,0,0))},2e3)),this._breaksCanvas&&(delete this._breaksCanvas,delete this._breaksCanvasCtx),c=0;c<this._axes.length;c++)this._axes[c].maskCanvas&&(delete this._axes[c].maskCanvas,delete this._axes[c].maskCtx)},Ct.prototype.render=function(u){u&&(this.options=u),this._initialize(),this.setLayout(),this.renderElements(),this._preRenderCanvas&&Sr(this._preRenderCanvas)},Ct.prototype.attachPlotAreaEventHandlers=function(){this.attachEvent({context:this,chart:this,mousedown:this._plotAreaMouseDown,mouseup:this._plotAreaMouseUp,mousemove:this._plotAreaMouseMove,cursor:this.panEnabled?"move":"default",capture:!0,bounds:this.plotArea})},Ct.prototype.categoriseDataSeries=function(){for(var u="",I=0;I<this.data.length;I++)if((u=this.data[I]).dataPoints&&0!==u.dataPoints.length&&u.visible&&0<=Ct._supportedChartTypes.indexOf(u.type)){for(var g=null,x=!1,w=null,D=!1,o=0;o<this.plotInfo.plotTypes.length;o++)if(this.plotInfo.plotTypes[o].type===u.type){x=!0,g=this.plotInfo.plotTypes[o];break}for(x||this.plotInfo.plotTypes.push(g={type:u.type,totalDataSeries:0,plotUnits:[]}),o=0;o<g.plotUnits.length;o++)if(g.plotUnits[o].axisYType===u.axisYType&&g.plotUnits[o].axisXType===u.axisXType&&g.plotUnits[o].axisYIndex===u.axisYIndex&&g.plotUnits[o].axisXIndex===u.axisXIndex){D=!0,w=g.plotUnits[o];break}D||g.plotUnits.push(w={type:u.type,previousDataSeriesCount:0,index:g.plotUnits.length,plotType:g,axisXType:u.axisXType,axisYType:u.axisYType,axisYIndex:u.axisYIndex,axisXIndex:u.axisXIndex,axisY:"primary"===u.axisYType?this.axisY[0<=u.axisYIndex&&u.axisYIndex<this.axisY.length?u.axisYIndex:0]:this.axisY2[0<=u.axisYIndex&&u.axisYIndex<this.axisY2.length?u.axisYIndex:0],axisX:"primary"===u.axisXType?this.axisX[0<=u.axisXIndex&&u.axisXIndex<this.axisX.length?u.axisXIndex:0]:this.axisX2[0<=u.axisXIndex&&u.axisXIndex<this.axisX2.length?u.axisXIndex:0],dataSeriesIndexes:[],yTotals:[],yAbsTotals:[]}),g.totalDataSeries++,w.dataSeriesIndexes.push(I),u.plotUnit=w}for(I=0;I<this.plotInfo.plotTypes.length;I++)for(g=this.plotInfo.plotTypes[I],o=u=0;o<g.plotUnits.length;o++)g.plotUnits[o].previousDataSeriesCount=u,u+=g.plotUnits[o].dataSeriesIndexes.length},Ct.prototype.assignIdToDataPoints=function(){for(var u=0;u<this.data.length;u++){var I=this.data[u];if(I.dataPoints)for(var g=I.dataPoints.length,x=0;x<g;x++)I.dataPointIds[x]=++this._eventManager.lastObjectId}},Ct.prototype._processData=function(){this.assignIdToDataPoints(),this.categoriseDataSeries();for(var u=0;u<this.plotInfo.plotTypes.length;u++)for(var I=this.plotInfo.plotTypes[u],g=0;g<I.plotUnits.length;g++){var x=I.plotUnits[g];"line"===x.type||"stepLine"===x.type||"spline"===x.type||"column"===x.type||"area"===x.type||"stepArea"===x.type||"splineArea"===x.type||"bar"===x.type||"bubble"===x.type||"scatter"===x.type?this._processMultiseriesPlotUnit(x):"stackedColumn"===x.type||"stackedBar"===x.type||"stackedArea"===x.type?this._processStackedPlotUnit(x):"stackedColumn100"===x.type||"stackedBar100"===x.type||"stackedArea100"===x.type?this._processStacked100PlotUnit(x):"candlestick"===x.type||"ohlc"===x.type||"rangeColumn"===x.type||"rangeBar"===x.type||"rangeArea"===x.type||"rangeSplineArea"===x.type||"error"===x.type||"boxAndWhisker"===x.type?this._processMultiYPlotUnit(x):"waterfall"===x.type&&this._processSpecificPlotUnit(x)}this.calculateAutoBreaks()},Ct.prototype._processMultiseriesPlotUnit=function(u){if(u.dataSeriesIndexes&&!(1>u.dataSeriesIndexes.length))for(var x,w,I=u.axisY.dataInfo,g=u.axisX.dataInfo,D=!1,o=0;o<u.dataSeriesIndexes.length;o++){var M,y=this.data[u.dataSeriesIndexes[o]],f=0,c=!1,d=!1;if("normal"===y.axisPlacement||"xySwapped"===y.axisPlacement)var k=u.axisX.sessionVariables.newViewportMinimum?u.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:u.axisX.logarithmic?0:-1/0,C=u.axisX.sessionVariables.newViewportMaximum?u.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((y.dataPoints[f].x&&y.dataPoints[f].x.getTime||"dateTime"===y.xValueType)&&(D=!0),f=0;f<y.dataPoints.length;f++){if(typeof y.dataPoints[f].x>"u"&&(y.dataPoints[f].x=f+(u.axisX.logarithmic?1:0)),y.dataPoints[f].x.getTime?(D=!0,x=y.dataPoints[f].x.getTime()):x=y.dataPoints[f].x,w=y.dataPoints[f].y,x<g.min&&(g.min=x),x>g.max&&(g.max=x),w<I.min&&"number"==typeof w&&(I.min=w),w>I.max&&"number"==typeof w&&(I.max=w),0<f){if(u.axisX.logarithmic){var R=x/y.dataPoints[f-1].x;1>R&&(R=1/R),g.minDiff>R&&1!==R&&(g.minDiff=R)}else 0>(R=x-y.dataPoints[f-1].x)&&(R*=-1),g.minDiff>R&&0!==R&&(g.minDiff=R);null!==w&&null!==y.dataPoints[f-1].y&&(u.axisY.logarithmic?(1>(R=w/y.dataPoints[f-1].y)&&(R=1/R),I.minDiff>R&&1!==R&&(I.minDiff=R)):(0>(R=w-y.dataPoints[f-1].y)&&(R*=-1),I.minDiff>R&&0!==R&&(I.minDiff=R)))}if(x<k&&!c)null!==w&&(M=x);else{if(!c&&(c=!0,0<f)){f-=2;continue}if(x>C&&!d)d=!0;else if(x>C&&d)continue;y.dataPoints[f].label&&(u.axisX.labels[x]=y.dataPoints[f].label),x<g.viewPortMin&&(g.viewPortMin=x),x>g.viewPortMax&&(g.viewPortMax=x),null===w?g.viewPortMin===x&&M<x&&(g.viewPortMin=M):(w<I.viewPortMin&&"number"==typeof w&&(I.viewPortMin=w),w>I.viewPortMax&&"number"==typeof w&&(I.viewPortMax=w))}}y.axisX.valueType=y.xValueType=D?"dateTime":"number"}},Ct.prototype._processStackedPlotUnit=function(u){if(u.dataSeriesIndexes&&!(1>u.dataSeriesIndexes.length)){for(var x,w,I=u.axisY.dataInfo,g=u.axisX.dataInfo,D=!1,o=[],y=[],f=1/0,c=-1/0,d=0;d<u.dataSeriesIndexes.length;d++){var B,M=this.data[u.dataSeriesIndexes[d]],k=0,C=!1,R=!1;if("normal"===M.axisPlacement||"xySwapped"===M.axisPlacement)var O=u.axisX.sessionVariables.newViewportMinimum?u.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:-1/0,L=u.axisX.sessionVariables.newViewportMaximum?u.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((M.dataPoints[k].x&&M.dataPoints[k].x.getTime||"dateTime"===M.xValueType)&&(D=!0),k=0;k<M.dataPoints.length;k++){if(typeof M.dataPoints[k].x>"u"&&(M.dataPoints[k].x=k+(u.axisX.logarithmic?1:0)),M.dataPoints[k].x.getTime?(D=!0,x=M.dataPoints[k].x.getTime()):x=M.dataPoints[k].x,w=$t(M.dataPoints[k].y)?0:M.dataPoints[k].y,x<g.min&&(g.min=x),x>g.max&&(g.max=x),0<k){if(u.axisX.logarithmic){var X=x/M.dataPoints[k-1].x;1>X&&(X=1/X),g.minDiff>X&&1!==X&&(g.minDiff=X)}else 0>(X=x-M.dataPoints[k-1].x)&&(X*=-1),g.minDiff>X&&0!==X&&(g.minDiff=X);null!==w&&null!==M.dataPoints[k-1].y&&(u.axisY.logarithmic?0<w&&(1>(X=w/M.dataPoints[k-1].y)&&(X=1/X),I.minDiff>X&&1!==X&&(I.minDiff=X)):(0>(X=w-M.dataPoints[k-1].y)&&(X*=-1),I.minDiff>X&&0!==X&&(I.minDiff=X)))}if(x<O&&!C)null!==M.dataPoints[k].y&&(B=x);else{if(!C&&(C=!0,0<k)){k-=2;continue}if(x>L&&!R)R=!0;else if(x>L&&R)continue;M.dataPoints[k].label&&(u.axisX.labels[x]=M.dataPoints[k].label),x<g.viewPortMin&&(g.viewPortMin=x),x>g.viewPortMax&&(g.viewPortMax=x),null===M.dataPoints[k].y?g.viewPortMin===x&&B<x&&(g.viewPortMin=B):(u.yTotals[x]=(u.yTotals[x]?u.yTotals[x]:0)+w,u.yAbsTotals[x]=(u.yAbsTotals[x]?u.yAbsTotals[x]:0)+Math.abs(w),0<=w?o[x]?o[x]+=w:(o[x]=w,f=Math.min(w,f)):y[x]?y[x]+=w:(y[x]=w,c=Math.max(w,c)))}}u.axisY.scaleBreaks&&u.axisY.scaleBreaks.autoCalculate&&1<=u.axisY.scaleBreaks.maxNumberOfAutoBreaks&&(I.dataPointYPositiveSums?(I.dataPointYPositiveSums.push.apply(I.dataPointYPositiveSums,o),I.dataPointYNegativeSums.push.apply(I.dataPointYPositiveSums,y)):(I.dataPointYPositiveSums=o,I.dataPointYNegativeSums=y)),M.axisX.valueType=M.xValueType=D?"dateTime":"number"}for(k in o)o.hasOwnProperty(k)&&!isNaN(k)&&((u=o[k])<I.min&&(I.min=Math.min(u,f)),u>I.max&&(I.max=u),k<g.viewPortMin||k>g.viewPortMax||(u<I.viewPortMin&&(I.viewPortMin=Math.min(u,f)),u>I.viewPortMax&&(I.viewPortMax=u)));for(k in y)y.hasOwnProperty(k)&&!isNaN(k)&&((u=y[k])<I.min&&(I.min=u),u>I.max&&(I.max=Math.max(u,c)),k<g.viewPortMin||k>g.viewPortMax||(u<I.viewPortMin&&(I.viewPortMin=u),u>I.viewPortMax&&(I.viewPortMax=Math.max(u,c))))}},Ct.prototype._processStacked100PlotUnit=function(u){if(u.dataSeriesIndexes&&!(1>u.dataSeriesIndexes.length)){for(var x,w,I=u.axisY.dataInfo,g=u.axisX.dataInfo,D=!1,o=!1,y=!1,f=[],c=0;c<u.dataSeriesIndexes.length;c++){var R,d=this.data[u.dataSeriesIndexes[c]],M=0,k=!1,C=!1;if("normal"===d.axisPlacement||"xySwapped"===d.axisPlacement)var B=u.axisX.sessionVariables.newViewportMinimum?u.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:-1/0,O=u.axisX.sessionVariables.newViewportMaximum?u.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((d.dataPoints[M].x&&d.dataPoints[M].x.getTime||"dateTime"===d.xValueType)&&(D=!0),M=0;M<d.dataPoints.length;M++){if(typeof d.dataPoints[M].x>"u"&&(d.dataPoints[M].x=M+(u.axisX.logarithmic?1:0)),d.dataPoints[M].x.getTime?(D=!0,x=d.dataPoints[M].x.getTime()):x=d.dataPoints[M].x,w=$t(d.dataPoints[M].y)?null:d.dataPoints[M].y,x<g.min&&(g.min=x),x>g.max&&(g.max=x),0<M){if(u.axisX.logarithmic){var L=x/d.dataPoints[M-1].x;1>L&&(L=1/L),g.minDiff>L&&1!==L&&(g.minDiff=L)}else 0>(L=x-d.dataPoints[M-1].x)&&(L*=-1),g.minDiff>L&&0!==L&&(g.minDiff=L);$t(w)||null===d.dataPoints[M-1].y||(u.axisY.logarithmic?0<w&&(1>(L=w/d.dataPoints[M-1].y)&&(L=1/L),I.minDiff>L&&1!==L&&(I.minDiff=L)):(0>(L=w-d.dataPoints[M-1].y)&&(L*=-1),I.minDiff>L&&0!==L&&(I.minDiff=L)))}if(x<B&&!k)null!==w&&(R=x);else{if(!k&&(k=!0,0<M)){M-=2;continue}if(x>O&&!C)C=!0;else if(x>O&&C)continue;d.dataPoints[M].label&&(u.axisX.labels[x]=d.dataPoints[M].label),x<g.viewPortMin&&(g.viewPortMin=x),x>g.viewPortMax&&(g.viewPortMax=x),null===w?g.viewPortMin===x&&R<x&&(g.viewPortMin=R):(u.yTotals[x]=(u.yTotals[x]?u.yTotals[x]:0)+w,u.yAbsTotals[x]=(u.yAbsTotals[x]?u.yAbsTotals[x]:0)+Math.abs(w),0<=w?o=!0:0>w&&(y=!0),f[x]=f[x]?f[x]+Math.abs(w):Math.abs(w))}}d.axisX.valueType=d.xValueType=D?"dateTime":"number"}u.axisY.logarithmic?(I.max=$t(I.viewPortMax)?99*Math.pow(u.axisY.logarithmBase,-.05):Math.max(I.viewPortMax,99*Math.pow(u.axisY.logarithmBase,-.05)),I.min=$t(I.viewPortMin)?1:Math.min(I.viewPortMin,1)):o&&!y?(I.max=$t(I.viewPortMax)?99:Math.max(I.viewPortMax,99),I.min=$t(I.viewPortMin)?1:Math.min(I.viewPortMin,1)):o&&y?(I.max=$t(I.viewPortMax)?99:Math.max(I.viewPortMax,99),I.min=$t(I.viewPortMin)?-99:Math.min(I.viewPortMin,-99)):!o&&y&&(I.max=$t(I.viewPortMax)?-1:Math.max(I.viewPortMax,-1),I.min=$t(I.viewPortMin)?-99:Math.min(I.viewPortMin,-99)),I.viewPortMin=I.min,I.viewPortMax=I.max,u.dataPointYSums=f}},Ct.prototype._processMultiYPlotUnit=function(u){if(u.dataSeriesIndexes&&!(1>u.dataSeriesIndexes.length))for(var x,w,D,o,I=u.axisY.dataInfo,g=u.axisX.dataInfo,y=!1,f=0;f<u.dataSeriesIndexes.length;f++){var C,R,B,c=this.data[u.dataSeriesIndexes[f]],d=0,M=!1,k=!1;if("normal"===c.axisPlacement||"xySwapped"===c.axisPlacement)var O=u.axisX.sessionVariables.newViewportMinimum?u.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:u.axisX.logarithmic?0:-1/0,L=u.axisX.sessionVariables.newViewportMaximum?u.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((c.dataPoints[d].x&&c.dataPoints[d].x.getTime||"dateTime"===c.xValueType)&&(y=!0),d=0;d<c.dataPoints.length;d++){if(typeof c.dataPoints[d].x>"u"&&(c.dataPoints[d].x=d+(u.axisX.logarithmic?1:0)),c.dataPoints[d].x.getTime?(y=!0,x=c.dataPoints[d].x.getTime()):x=c.dataPoints[d].x,(w=c.dataPoints[d].y)&&w.length){D=Math.min.apply(null,w),o=Math.max.apply(null,w),R=!0;for(var X=0;X<w.length;X++)null===w.k&&(R=!1);R&&(M||(B=C),C=x)}if(x<g.min&&(g.min=x),x>g.max&&(g.max=x),D<I.min&&(I.min=D),o>I.max&&(I.max=o),0<d&&(u.axisX.logarithmic?(1>(R=x/c.dataPoints[d-1].x)&&(R=1/R),g.minDiff>R&&1!==R&&(g.minDiff=R)):(0>(R=x-c.dataPoints[d-1].x)&&(R*=-1),g.minDiff>R&&0!==R&&(g.minDiff=R)),w&&null!==w[0]&&c.dataPoints[d-1].y&&null!==c.dataPoints[d-1].y[0]&&(u.axisY.logarithmic?(1>(R=w[0]/c.dataPoints[d-1].y[0])&&(R=1/R),I.minDiff>R&&1!==R&&(I.minDiff=R)):(0>(R=w[0]-c.dataPoints[d-1].y[0])&&(R*=-1),I.minDiff>R&&0!==R&&(I.minDiff=R)))),!(x<O)||M){if(!M&&(M=!0,0<d)){d-=2,C=B;continue}if(x>L&&!k)k=!0;else if(x>L&&k)continue;if(c.dataPoints[d].label&&(u.axisX.labels[x]=c.dataPoints[d].label),x<g.viewPortMin&&(g.viewPortMin=x),x>g.viewPortMax&&(g.viewPortMax=x),g.viewPortMin===x&&w)for(X=0;X<w.length;X++)if(null===w[X]&&C<x){g.viewPortMin=C;break}null===w?g.viewPortMin===x&&C<x&&(g.viewPortMin=C):(D<I.viewPortMin&&(I.viewPortMin=D),o>I.viewPortMax&&(I.viewPortMax=o))}}c.axisX.valueType=c.xValueType=y?"dateTime":"number"}},Ct.prototype._processSpecificPlotUnit=function(u){if("waterfall"===u.type&&u.dataSeriesIndexes&&!(1>u.dataSeriesIndexes.length))for(var x,w,I=u.axisY.dataInfo,g=u.axisX.dataInfo,D=!1,o=0;o<u.dataSeriesIndexes.length;o++){var y=this.data[u.dataSeriesIndexes[o]],f=0,c=!1,d=!1,M=x=0;if("normal"===y.axisPlacement||"xySwapped"===y.axisPlacement)var k=u.axisX.sessionVariables.newViewportMinimum?u.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:u.axisX.logarithmic?0:-1/0,C=u.axisX.sessionVariables.newViewportMaximum?u.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((y.dataPoints[f].x&&y.dataPoints[f].x.getTime||"dateTime"===y.xValueType)&&(D=!0),f=0;f<y.dataPoints.length;f++)typeof y.dataPoints[f].isCumulativeSum<"u"&&!0===y.dataPoints[f].isCumulativeSum?(y.dataPointEOs[f].cumulativeSumYStartValue=0,y.dataPointEOs[f].cumulativeSum=0===f?0:y.dataPointEOs[f-1].cumulativeSum,y.dataPoints[f].y=0===f?0:y.dataPointEOs[f-1].cumulativeSum):typeof y.dataPoints[f].isIntermediateSum<"u"&&!0===y.dataPoints[f].isIntermediateSum?(y.dataPointEOs[f].cumulativeSumYStartValue=M,y.dataPointEOs[f].cumulativeSum=0===f?0:y.dataPointEOs[f-1].cumulativeSum,y.dataPoints[f].y=0===f?0:x,M=0===f?0:y.dataPointEOs[f-1].cumulativeSum,x=0):(w="number"!=typeof y.dataPoints[f].y?0:y.dataPoints[f].y,y.dataPointEOs[f].cumulativeSumYStartValue=0===f?0:y.dataPointEOs[f-1].cumulativeSum,y.dataPointEOs[f].cumulativeSum=0===f?w:y.dataPointEOs[f-1].cumulativeSum+w,x+=w);for(f=0;f<y.dataPoints.length;f++)if(typeof y.dataPoints[f].x>"u"&&(y.dataPoints[f].x=f+(u.axisX.logarithmic?1:0)),y.dataPoints[f].x.getTime?(D=!0,x=y.dataPoints[f].x.getTime()):x=y.dataPoints[f].x,w=y.dataPoints[f].y,x<g.min&&(g.min=x),x>g.max&&(g.max=x),y.dataPointEOs[f].cumulativeSum<I.min&&(I.min=y.dataPointEOs[f].cumulativeSum),y.dataPointEOs[f].cumulativeSum>I.max&&(I.max=y.dataPointEOs[f].cumulativeSum),0<f&&(u.axisX.logarithmic?(1>(M=x/y.dataPoints[f-1].x)&&(M=1/M),g.minDiff>M&&1!==M&&(g.minDiff=M)):(0>(M=x-y.dataPoints[f-1].x)&&(M*=-1),g.minDiff>M&&0!==M&&(g.minDiff=M)),null!==w&&null!==y.dataPoints[f-1].y&&(u.axisY.logarithmic?(1>(w=y.dataPointEOs[f].cumulativeSum/y.dataPointEOs[f-1].cumulativeSum)&&(w=1/w),I.minDiff>w&&1!==w&&(I.minDiff=w)):(0>(w=y.dataPointEOs[f].cumulativeSum-y.dataPointEOs[f-1].cumulativeSum)&&(w*=-1),I.minDiff>w&&0!==w&&(I.minDiff=w)))),!(x<k)||c){if(!c&&(c=!0,0<f)){f-=2;continue}if(x>C&&!d)d=!0;else if(x>C&&d)continue;y.dataPoints[f].label&&(u.axisX.labels[x]=y.dataPoints[f].label),x<g.viewPortMin&&(g.viewPortMin=x),x>g.viewPortMax&&(g.viewPortMax=x),0<f&&(y.dataPointEOs[f-1].cumulativeSum<I.viewPortMin&&(I.viewPortMin=y.dataPointEOs[f-1].cumulativeSum),y.dataPointEOs[f-1].cumulativeSum>I.viewPortMax&&(I.viewPortMax=y.dataPointEOs[f-1].cumulativeSum)),y.dataPointEOs[f].cumulativeSum<I.viewPortMin&&(I.viewPortMin=y.dataPointEOs[f].cumulativeSum),y.dataPointEOs[f].cumulativeSum>I.viewPortMax&&(I.viewPortMax=y.dataPointEOs[f].cumulativeSum)}y.axisX.valueType=y.xValueType=D?"dateTime":"number"}},Ct.prototype.calculateAutoBreaks=function(){function I(R){if(R.dataSeriesIndexes&&!(1>R.dataSeriesIndexes.length)){var B=R.axisX.scaleBreaks&&R.axisX.scaleBreaks.autoCalculate&&1<=R.axisX.scaleBreaks.maxNumberOfAutoBreaks,O=R.axisY.scaleBreaks&&R.axisY.scaleBreaks.autoCalculate&&1<=R.axisY.scaleBreaks.maxNumberOfAutoBreaks;if(B||O)for(var L,nt,X=(J=R.axisX.dataInfo).min,E=J.max,Y=(q=R.axisY.dataInfo).min,it=q.max,J=J._dataRanges,q=q._dataRanges,dt=0,gt=0;gt<R.dataSeriesIndexes.length;gt++){var kt=w.data[R.dataSeriesIndexes[gt]];if(!(4>kt.dataPoints.length))for(dt=0;dt<kt.dataPoints.length;dt++)if(B&&(nt=(E+1-X)*Math.max(parseFloat(R.axisX.scaleBreaks.collapsibleThreshold)||10,10)/100,(L=kt.dataPoints[dt].x.getTime?kt.dataPoints[dt].x.getTime():kt.dataPoints[dt].x)<J[nt=Math.floor((L-X)/nt)].min&&(J[nt].min=L),L>J[nt].max&&(J[nt].max=L)),O){var mt=(it+1-Y)*Math.max(parseFloat(R.axisY.scaleBreaks.collapsibleThreshold)||10,10)/100;if((L="waterfall"===R.type?kt.dataPointEOs[dt].cumulativeSum:kt.dataPoints[dt].y)&&L.length)for(var Tt=0;Tt<L.length;Tt++)nt=Math.floor((L[Tt]-Y)/mt),L[Tt]<q[nt].min&&(q[nt].min=L[Tt]),L[Tt]>q[nt].max&&(q[nt].max=L[Tt]);else $t(L)||(L<q[nt=Math.floor((L-Y)/mt)].min&&(q[nt].min=L),L>q[nt].max&&(q[nt].max=L))}}}}function g(R){if(R.dataSeriesIndexes&&!(1>R.dataSeriesIndexes.length)&&R.axisX.scaleBreaks&&R.axisX.scaleBreaks.autoCalculate&&1<=R.axisX.scaleBreaks.maxNumberOfAutoBreaks)for(var E,B=R.axisX.dataInfo,O=B.min,L=B.max,X=B._dataRanges,Y=0,it=0;it<R.dataSeriesIndexes.length;it++){var J=w.data[R.dataSeriesIndexes[it]];if(!(4>J.dataPoints.length))for(Y=0;Y<J.dataPoints.length;Y++)E=(L+1-O)*Math.max(parseFloat(R.axisX.scaleBreaks.collapsibleThreshold)||10,10)/100,(B=J.dataPoints[Y].x.getTime?J.dataPoints[Y].x.getTime():J.dataPoints[Y].x)<X[E=Math.floor((B-O)/E)].min&&(X[E].min=B),B>X[E].max&&(X[E].max=B)}}for(var x,w=this,D=!1,o=0;o<this._axes.length;o++)if(this._axes[o].scaleBreaks&&this._axes[o].scaleBreaks.autoCalculate&&1<=this._axes[o].scaleBreaks.maxNumberOfAutoBreaks){D=!0,this._axes[o].dataInfo._dataRanges=[];for(var y=0;y<100/Math.max(parseFloat(this._axes[o].scaleBreaks.collapsibleThreshold)||10,10);y++)this._axes[o].dataInfo._dataRanges.push({min:1/0,max:-1/0})}if(D){for(o=0;o<this.plotInfo.plotTypes.length;o++)for(D=this.plotInfo.plotTypes[o],y=0;y<D.plotUnits.length;y++)"line"===(x=D.plotUnits[y]).type||"stepLine"===x.type||"spline"===x.type||"column"===x.type||"area"===x.type||"stepArea"===x.type||"splineArea"===x.type||"bar"===x.type||"bubble"===x.type||"scatter"===x.type||"candlestick"===x.type||"ohlc"===x.type||"rangeColumn"===x.type||"rangeBar"===x.type||"rangeArea"===x.type||"rangeSplineArea"===x.type||"waterfall"===x.type||"error"===x.type||"boxAndWhisker"===x.type?I(x):0<=x.type.indexOf("stacked")&&g(x);for(o=0;o<this._axes.length;o++)if(this._axes[o].dataInfo._dataRanges){var f=this._axes[o].dataInfo.min;x=(this._axes[o].dataInfo.max+1-f)*Math.max(parseFloat(this._axes[o].scaleBreaks.collapsibleThreshold)||10,10)/100;var d,M,c=this._axes[o].dataInfo._dataRanges;if(D=[],this._axes[o].dataInfo.dataPointYPositiveSums){var k=this._axes[o].dataInfo.dataPointYPositiveSums;for(y in d=c,k)if(k.hasOwnProperty(y)&&!isNaN(y)&&!$t(M=k[y])){var C=Math.floor((M-f)/x);M<d[C].min&&(d[C].min=M),M>d[C].max&&(d[C].max=M)}delete this._axes[o].dataInfo.dataPointYPositiveSums}if(this._axes[o].dataInfo.dataPointYNegativeSums){for(y in d=c,k=this._axes[o].dataInfo.dataPointYNegativeSums)k.hasOwnProperty(y)&&!isNaN(y)&&($t(M=-1*k[y])||(M<d[C=Math.floor((M-f)/x)].min&&(d[C].min=M),M>d[C].max&&(d[C].max=M)));delete this._axes[o].dataInfo.dataPointYNegativeSums}for(y=0;y<c.length-1;y++)if(d=c[y].max,isFinite(d))for(;y<c.length-1;){if(f=c[y+1].min,isFinite(f)){(M=f-d)>x&&D.push({diff:M,start:d,end:f});break}y++}if(this._axes[o].scaleBreaks.customBreaks)for(y=0;y<this._axes[o].scaleBreaks.customBreaks.length;y++)for(x=0;x<D.length;x++)(this._axes[o].scaleBreaks.customBreaks[y].startValue<=D[x].start&&D[x].start<=this._axes[o].scaleBreaks.customBreaks[y].endValue||this._axes[o].scaleBreaks.customBreaks[y].startValue<=D[x].start&&D[x].start<=this._axes[o].scaleBreaks.customBreaks[y].endValue||D[x].start<=this._axes[o].scaleBreaks.customBreaks[y].startValue&&this._axes[o].scaleBreaks.customBreaks[y].startValue<=D[x].end||D[x].start<=this._axes[o].scaleBreaks.customBreaks[y].endValue&&this._axes[o].scaleBreaks.customBreaks[y].endValue<=D[x].end)&&(D.splice(x,1),x--);for(D.sort(function(B,O){return O.diff-B.diff}),y=0;y<Math.min(D.length,this._axes[o].scaleBreaks.maxNumberOfAutoBreaks);y++)R=D[y].start,B=D[y].end,O=this._axes[o].logarithmic?this._axes[o].dataInfo.max/this._axes[o].dataInfo.min:this._axes[o].dataInfo.max-this._axes[o].dataInfo.min,x=this._axes[o].logarithmic?(1>=(O=Math.pow(Math.min(O*R/B,B/R),.2))&&(O=Math.pow(1>R?1/R:Math.min(B/R,R),.25)),{startValue:R*O,endValue:B/O}):(0>=(O=.2*Math.min(O-B+R,B-R))&&(O=.25*Math.min(B-R,Math.abs(R))),{startValue:R+O,endValue:B-O}),this._axes[o].scaleBreaks.autoBreaks.push(new Pt(this,"autoBreaks",x,y,++this._eventManager.lastObjectId,this._axes[o].scaleBreaks)),this._axes[o].scaleBreaks._appliedBreaks.push(this._axes[o].scaleBreaks.autoBreaks[this._axes[o].scaleBreaks.autoBreaks.length-1]);this._axes[o].scaleBreaks._appliedBreaks.sort(function(B,O){return B.startValue-O.startValue})}}var R,B,O},Ct.prototype.renderCrosshairs=function(u){for(var I=0;I<this.axisX.length;I++)this.axisX[I]!=u&&this.axisX[I].crosshair&&this.axisX[I].crosshair.enabled&&!this.axisX[I].crosshair._hidden&&this.axisX[I].showCrosshair(this.axisX[I].crosshair._updatedValue);for(I=0;I<this.axisX2.length;I++)this.axisX2[I]!=u&&this.axisX2[I].crosshair&&this.axisX2[I].crosshair.enabled&&!this.axisX2[I].crosshair._hidden&&this.axisX2[I].showCrosshair(this.axisX2[I].crosshair._updatedValue);for(I=0;I<this.axisY.length;I++)this.axisY[I]!=u&&this.axisY[I].crosshair&&this.axisY[I].crosshair.enabled&&!this.axisY[I].crosshair._hidden&&this.axisY[I].showCrosshair(this.axisY[I].crosshair._updatedValue);for(I=0;I<this.axisY2.length;I++)this.axisY2[I]!=u&&this.axisY2[I].crosshair&&this.axisY2[I].crosshair.enabled&&!this.axisY2[I].crosshair._hidden&&this.axisY2[I].showCrosshair(this.axisY2[I].crosshair._updatedValue)},Ct.prototype.getDataPointAtXY=function(u,I,g){g=g||!1;for(var x=[],w=this._dataInRenderedOrder.length-1;0<=w;w--){var D;(D=this._dataInRenderedOrder[w].getDataPointAtXY(u,I,g))&&x.push(D)}for(u=null,I=!1,g=0;g<x.length;g++)if(("line"===x[g].dataSeries.type||"stepLine"===x[g].dataSeries.type||"area"===x[g].dataSeries.type||"stepArea"===x[g].dataSeries.type)&&(w=en("markerSize",x[g].dataPoint,x[g].dataSeries)||8,x[g].distance<=w/2)){I=!0;break}for(g=0;g<x.length;g++)I&&"line"!==x[g].dataSeries.type&&"stepLine"!==x[g].dataSeries.type&&"area"!==x[g].dataSeries.type&&"stepArea"!==x[g].dataSeries.type||(u?x[g].distance<=u.distance&&(u=x[g]):u=x[g]);return u},Ct.prototype.getObjectAtXY=function(u,I,g){var x=null;if(g=this.getDataPointAtXY(u,I,g||!1))x=g.dataSeries.dataPointIds[g.dataPointIndex];else if(oe)x=xi(u,I,this._eventManager.ghostCtx);else for(g=0;g<this.legend.items.length;g++){var w=this.legend.items[g];u>=w.x1&&u<=w.x2&&I>=w.y1&&I<=w.y2&&(x=w.id)}return x},Ct.prototype.getAutoFontSize=Lr,Ct.prototype.resetOverlayedCanvas=function(){this.overlaidCanvasCtx.clearRect(0,0,this.width,this.height)},Ct.prototype.clearCanvas=In,Ct.prototype.attachEvent=function(u){this._events.push(u)},Ct.prototype._touchEventHandler=function(u){if(u.changedTouches&&this.interactivityEnabled){var I=[],g=u.changedTouches,x=g?g[0]:u,w=null;switch(u.type){case"touchstart":case"MSPointerDown":I=["mousemove","mousedown"],this._lastTouchData=$s(x),this._lastTouchData.time=new Date;break;case"touchmove":case"MSPointerMove":I=["mousemove"];break;case"touchend":case"MSPointerUp":var D=this._lastTouchData&&this._lastTouchData.time?new Date-this._lastTouchData.time:0;I="touchstart"===this._lastTouchEventType||"MSPointerDown"===this._lastTouchEventType||300>D?["mouseup","click"]:["mouseup"];break;default:return}if(!(g&&1<g.length)){(w=$s(x)).time=new Date;try{var o=w.y-this._lastTouchData.y;D=w.time-this._lastTouchData.time,(1<Math.abs(o)&&this._lastTouchData.scroll||5<Math.abs(o)&&250>D)&&(this._lastTouchData.scroll=!0)}catch{}if(this._lastTouchEventType=u.type,this._lastTouchData.scroll&&this.zoomEnabled)this.isDrag&&this.resetOverlayedCanvas(),this.isDrag=!1;else for(g=0;g<I.length;g++)w=I[g],(o=document.createEvent("MouseEvent")).initMouseEvent(w,!0,!0,window,1,x.screenX,x.screenY,x.clientX,x.clientY,!1,!1,!1,!1,0,null),x.target.dispatchEvent(o),(!$t(this._lastTouchData.scroll)&&!this._lastTouchData.scroll||!this._lastTouchData.scroll&&250<D||"click"===w)&&(u.preventManipulation&&u.preventManipulation(),u.preventDefault&&u.cancelable&&u.preventDefault())}}},Ct.prototype._dispatchRangeEvent=function(u,I){var g={chart:this};g.type=u,g.trigger=I;var x=[];this.axisX&&0<this.axisX.length&&x.push("axisX"),this.axisX2&&0<this.axisX2.length&&x.push("axisX2"),this.axisY&&0<this.axisY.length&&x.push("axisY"),this.axisY2&&0<this.axisY2.length&&x.push("axisY2");for(var w=0;w<x.length;w++)if($t(g[x[w]])&&(g[x[w]]=[]),"axisY"===x[w])for(var D=0;D<this.axisY.length;D++)g[x[w]].push({viewportMinimum:this[x[w]][D].sessionVariables.newViewportMinimum,viewportMaximum:this[x[w]][D].sessionVariables.newViewportMaximum});else if("axisY2"===x[w])for(D=0;D<this.axisY2.length;D++)g[x[w]].push({viewportMinimum:this[x[w]][D].sessionVariables.newViewportMinimum,viewportMaximum:this[x[w]][D].sessionVariables.newViewportMaximum});else if("axisX"===x[w])for(D=0;D<this.axisX.length;D++)g[x[w]].push({viewportMinimum:this[x[w]][D].sessionVariables.newViewportMinimum,viewportMaximum:this[x[w]][D].sessionVariables.newViewportMaximum});else if("axisX2"===x[w])for(D=0;D<this.axisX2.length;D++)g[x[w]].push({viewportMinimum:this[x[w]][D].sessionVariables.newViewportMinimum,viewportMaximum:this[x[w]][D].sessionVariables.newViewportMaximum});this.dispatchEvent(u,g,this)},Ct.prototype._mouseEventHandler=function(u){typeof u.target>"u"&&u.srcElement&&(u.target=u.srcElement);var x,w,I=$s(u),g=u.type;if(u.which?w=3==u.which:u.button&&(w=2==u.button),Ct.capturedEventParam&&(x=Ct.capturedEventParam,"mouseup"===g&&(Ct.capturedEventParam=null,x.chart.overlaidCanvas.releaseCapture?x.chart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",x.chart._mouseEventHandler,!1)),x.hasOwnProperty(g)&&("mouseup"!==g||x.chart.overlaidCanvas.releaseCapture?u.target!==x.chart.overlaidCanvas&&oe||x[g].call(x.context,I.x,I.y):u.target!==x.chart.overlaidCanvas&&(x.chart.isDrag=!1))),this.interactivityEnabled)if(this._ignoreNextEvent)this._ignoreNextEvent=!1;else if(u.preventManipulation&&u.preventManipulation(),u.preventDefault&&u.preventDefault(),Ys&&window.console&&(window.console.log(g+" --\x3e x: "+I.x+"; y:"+I.y),w&&window.console.log(u.which),"mouseup"===g&&window.console.log("mouseup")),!w){if(!Ct.capturedEventParam&&this._events){for(var D=0;D<this._events.length;D++)if(this._events[D].hasOwnProperty(g)){if(I.x>=(w=(x=this._events[D]).bounds).x1&&I.x<=w.x2&&I.y>=w.y1&&I.y<=w.y2){x[g].call(x.context,I.x,I.y),"mousedown"===g&&!0===x.capture?(Ct.capturedEventParam=x,this.overlaidCanvas.setCapture?this.overlaidCanvas.setCapture():document.documentElement.addEventListener("mouseup",this._mouseEventHandler,!1)):"mouseup"===g&&(x.chart.overlaidCanvas.releaseCapture?x.chart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",this._mouseEventHandler,!1));break}x=null}u.target.style.cursor=x&&x.cursor?x.cursor:this._defaultCursor}if(I.x<(g=this.plotArea).x1||I.x>g.x2||I.y<g.y1||I.y>g.y2){for(this.toolTip&&this.toolTip.enabled?(this.toolTip.hide(),this.toolTip.dispatchEvent("hidden",{chart:this,toolTip:this.toolTip},this.toolTip)):this.resetOverlayedCanvas(),D=0;D<this.axisX.length;D++)this.axisX[D].crosshair&&this.axisX[D].crosshair.enabled&&(this.axisX[D].crosshair.hide(),this.axisX[D].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX[D].options},this.axisX[D].crosshair));for(D=0;D<this.axisX2.length;D++)this.axisX2[D].crosshair&&this.axisX2[D].crosshair.enabled&&(this.axisX2[D].crosshair.hide(),this.axisX2[D].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX2[D].options},this.axisX2[D].crosshair));for(D=0;D<this.axisY.length;D++)this.axisY[D].crosshair&&this.axisY[D].crosshair.enabled&&(this.axisY[D].crosshair.hide(),this.axisY[D].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY[D].options},this.axisY[D].crosshair));for(D=0;D<this.axisY2.length;D++)this.axisY2[D].crosshair&&this.axisY2[D].crosshair.enabled&&(this.axisY2[D].crosshair.hide(),this.axisY2[D].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY2[D].options},this.axisY2[D].crosshair))}this.isDrag&&this.zoomEnabled||!this._eventManager||this._eventManager.mouseEventHandler(u)}},Ct.prototype._plotAreaMouseDown=function(u,I){this.isDrag=!0,this.dragStartPoint={x:u,y:I}},Ct.prototype._plotAreaMouseUp=function(u,I){if(("normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement)&&this.isDrag){var g=I-this.dragStartPoint.y,x=u-this.dragStartPoint.x,y=0<=this.zoomType.indexOf("x"),o=0<=this.zoomType.indexOf("y"),w=!1;if(this.resetOverlayedCanvas(),"xySwapped"===this.plotInfo.axisPlacement){var D=o;o=y,y=D}if(this.panEnabled||this.zoomEnabled){if(this.panEnabled)for(y=o=0;y<this._axes.length;y++)(g=this._axes[y]).logarithmic?g.viewportMinimum<g.minimum?(g.sessionVariables.newViewportMinimum=g.viewportMinimum*(o=g.minimum/g.viewportMinimum),g.sessionVariables.newViewportMaximum=g.viewportMaximum*o,w=!0):g.viewportMaximum>g.maximum&&(g.sessionVariables.newViewportMinimum=g.viewportMinimum/(o=g.viewportMaximum/g.maximum),g.sessionVariables.newViewportMaximum=g.viewportMaximum/o,w=!0):g.viewportMinimum<g.minimum?(g.sessionVariables.newViewportMinimum=g.viewportMinimum+(o=g.minimum-g.viewportMinimum),g.sessionVariables.newViewportMaximum=g.viewportMaximum+o,w=!0):g.viewportMaximum>g.maximum&&(g.sessionVariables.newViewportMinimum=g.viewportMinimum-(o=g.viewportMaximum-g.maximum),g.sessionVariables.newViewportMaximum=g.viewportMaximum-o,w=!0);else if((!y||2<Math.abs(x))&&(!o||2<Math.abs(g))&&this.zoomEnabled){if(!this.dragStartPoint)return;g=y?this.dragStartPoint.x:this.plotArea.x1,x=o?this.dragStartPoint.y:this.plotArea.y1,y=y?u:this.plotArea.x2,o=o?I:this.plotArea.y2,2<Math.abs(g-y)&&2<Math.abs(x-o)&&this._zoomPanToSelectedRegion(g,x,y,o)&&(w=!0)}w&&(this._ignoreNextEvent=!0,this._dispatchRangeEvent("rangeChanging","zoom"),this.stockChart&&this.stockChart.navigator&&this.stockChart.navigator.enabled&&(this.stockChart._rangeEventParameter||(this.stockChart._rangeEventParameter={stockChart:this.stockChart,source:"chart",index:this.stockChart.charts.indexOf(this),minimum:this.stockChart.sessionVariables._axisXMin,maximum:this.stockChart.sessionVariables._axisXMax}),this.stockChart._rangeEventParameter.type="rangeChanging",this.stockChart.dispatchEvent("rangeChanging",this.stockChart._rangeEventParameter,this.stockChart)),this.render(),this._dispatchRangeEvent("rangeChanged","zoom"),this.stockChart&&this.stockChart.navigator&&this.stockChart.navigator.enabled&&(this.stockChart._rangeEventParameter.type="rangeChanged",this.stockChart.dispatchEvent("rangeChanged",this.stockChart._rangeEventParameter,this.stockChart)),w&&this.zoomEnabled&&"none"===this._zoomButton.style.display&&(zi(this._zoomButton,this._resetButton),$n(this,this._zoomButton,"pan"),$n(this,this._resetButton,"reset")))}}if(this.isDrag=!1,"none"!==this.plotInfo.axisPlacement){if(this.resetOverlayedCanvas(),this.axisX&&0<this.axisX.length)for(w=0;w<this.axisX.length;w++)this.axisX[w].crosshair&&this.axisX[w].crosshair.enabled&&this.axisX[w].renderCrosshair(u,I);if(this.axisX2&&0<this.axisX2.length)for(w=0;w<this.axisX2.length;w++)this.axisX2[w].crosshair&&this.axisX2[w].crosshair.enabled&&this.axisX2[w].renderCrosshair(u,I);if(this.axisY&&0<this.axisY.length)for(w=0;w<this.axisY.length;w++)this.axisY[w].crosshair&&this.axisY[w].crosshair.enabled&&this.axisY[w].renderCrosshair(u,I);if(this.axisY2&&0<this.axisY2.length)for(w=0;w<this.axisY2.length;w++)this.axisY2[w].crosshair&&this.axisY2[w].crosshair.enabled&&this.axisY2[w].renderCrosshair(u,I);if(this.axisX&&0<this.axisX.length)for(w=0;w<this.axisX.length;w++)this.axisX[w].crosshair&&this.axisX[w].crosshair.enabled&&this.axisX[w].crosshair.renderLabel();if(this.axisX2&&0<this.axisX2.length)for(w=0;w<this.axisX2.length;w++)this.axisX2[w].crosshair&&this.axisX2[w].crosshair.enabled&&this.axisX2[w].crosshair.renderLabel();if(this.axisY&&0<this.axisY.length)for(w=0;w<this.axisY.length;w++)this.axisY[w].crosshair&&this.axisY[w].crosshair.enabled&&this.axisY[w].crosshair.renderLabel();if(this.axisY2&&0<this.axisY2.length)for(w=0;w<this.axisY2.length;w++)this.axisY2[w].crosshair&&this.axisY2[w].crosshair.enabled&&this.axisY2[w].crosshair.renderLabel()}},Ct.prototype._plotAreaMouseMove=function(u,I){if(this.isDrag&&"none"!==this.plotInfo.axisPlacement){var g=0,x=0,w=g=null,D=(w=0<=this.zoomType.indexOf("x"),0<=this.zoomType.indexOf("y")),o=this;if("xySwapped"===this.plotInfo.axisPlacement&&(g=D,D=w,w=g),g=this.dragStartPoint.x-u,x=this.dragStartPoint.y-I,2<Math.abs(g)&&8>Math.abs(g)&&(this.panEnabled||this.zoomEnabled)){this.toolTip.hide(),this.toolTip&&this.toolTip.enabled&&this.toolTip.dispatchEvent("hidden",{chart:this,toolTip:this.toolTip},this.toolTip);for(var y=0;y<this.axisX.length;y++)this.axisX[y].crosshair&&this.axisX[y].crosshair.enabled&&(this.axisX[y].crosshair.hide(),this.axisX[y].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX[y].options},this.axisX[y].crosshair));for(y=0;y<this.axisX2.length;y++)this.axisX2[y].crosshair&&this.axisX2[y].crosshair.enabled&&(this.axisX2[y].crosshair.hide(),this.axisX2[y].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX2[y].options},this.axisX2[y].crosshair));for(y=0;y<this.axisY.length;y++)this.axisY[y].crosshair&&this.axisY[y].crosshair.enabled&&(this.axisY[y].crosshair.hide(),this.axisY[y].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY[y].options},this.axisY[y].crosshair));for(y=0;y<this.axisY2.length;y++)this.axisY2[y].crosshair&&this.axisY2[y].crosshair.enabled&&(this.axisY2[y].crosshair.hide(),this.axisY2[y].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY2[y].options},this.axisY2[y].crosshair))}else this.panEnabled||this.zoomEnabled||this.toolTip.mouseMoveHandler(u,I);if((!w||2<Math.abs(g)||!D||2<Math.abs(x))&&(this.panEnabled||this.zoomEnabled))if(this.panEnabled)w={x1:w?this.plotArea.x1+g:this.plotArea.x1,y1:D?this.plotArea.y1+x:this.plotArea.y1,x2:w?this.plotArea.x2+g:this.plotArea.x2,y2:D?this.plotArea.y2+x:this.plotArea.y2},clearTimeout(o._panTimerId),o._panTimerId=setTimeout((d=w.x1,M=w.y1,k=w.x2,C=w.y2,function(){o._zoomPanToSelectedRegion(d,M,k,C,!0)&&(o._dispatchRangeEvent("rangeChanging","pan"),o.stockChart&&o.stockChart.navigator&&o.stockChart.navigator.enabled&&(o.stockChart._rangeEventParameter.type="rangeChanging",o.stockChart.dispatchEvent("rangeChanging",o.stockChart._rangeEventParameter,o.stockChart)),o.render(),o._dispatchRangeEvent("rangeChanged","pan"),o.stockChart&&o.stockChart.navigator&&o.stockChart.navigator.enabled&&(o.stockChart._rangeEventParameter.type="rangeChanged",o.stockChart.dispatchEvent("rangeChanged",o.stockChart._rangeEventParameter,o.stockChart)),o.dragStartPoint.x=u,o.dragStartPoint.y=I)}),0);else if(this.zoomEnabled){this.resetOverlayedCanvas(),g=this.overlaidCanvasCtx.globalAlpha,this.overlaidCanvasCtx.fillStyle="#A89896";var f=w?u-this.dragStartPoint.x:this.plotArea.x2-this.plotArea.x1,c=D?I-this.dragStartPoint.y:this.plotArea.y2-this.plotArea.y1;this.validateRegion(x=w?this.dragStartPoint.x:this.plotArea.x1,y=D?this.dragStartPoint.y:this.plotArea.y1,w?u:this.plotArea.x2-this.plotArea.x1,D?I:this.plotArea.y2-this.plotArea.y1,"xy"!==this.zoomType).isValid&&(this.resetOverlayedCanvas(),this.overlaidCanvasCtx.fillStyle="#99B2B5"),this.overlaidCanvasCtx.globalAlpha=.7,this.overlaidCanvasCtx.fillRect(x,y,f,c),this.overlaidCanvasCtx.globalAlpha=g}}else if(this.toolTip.mouseMoveHandler(u,I),"none"!==this.plotInfo.axisPlacement){if(this.axisX&&0<this.axisX.length)for(w=0;w<this.axisX.length;w++)this.axisX[w].crosshair&&this.axisX[w].crosshair.enabled&&this.axisX[w].renderCrosshair(u,I);if(this.axisX2&&0<this.axisX2.length)for(w=0;w<this.axisX2.length;w++)this.axisX2[w].crosshair&&this.axisX2[w].crosshair.enabled&&this.axisX2[w].renderCrosshair(u,I);if(this.axisY&&0<this.axisY.length)for(w=0;w<this.axisY.length;w++)this.axisY[w].crosshair&&this.axisY[w].crosshair.enabled&&this.axisY[w].renderCrosshair(u,I);if(this.axisY2&&0<this.axisY2.length)for(w=0;w<this.axisY2.length;w++)this.axisY2[w].crosshair&&this.axisY2[w].crosshair.enabled&&this.axisY2[w].renderCrosshair(u,I);if(this.axisX&&0<this.axisX.length)for(w=0;w<this.axisX.length;w++)this.axisX[w].crosshair&&this.axisX[w].crosshair.enabled&&this.axisX[w].crosshair.renderLabel();if(this.axisX2&&0<this.axisX2.length)for(w=0;w<this.axisX2.length;w++)this.axisX2[w].crosshair&&this.axisX2[w].crosshair.enabled&&this.axisX2[w].crosshair.renderLabel();if(this.axisY&&0<this.axisY.length)for(w=0;w<this.axisY.length;w++)this.axisY[w].crosshair&&this.axisY[w].crosshair.enabled&&this.axisY[w].crosshair.renderLabel();if(this.axisY2&&0<this.axisY2.length)for(w=0;w<this.axisY2.length;w++)this.axisY2[w].crosshair&&this.axisY2[w].crosshair.enabled&&this.axisY2[w].crosshair.renderLabel()}var d,M,k,C},Ct.prototype._zoomPanToSelectedRegion=function(u,I,g,x,w){if(I=(u=this.validateRegion(u,I,g,x,w)).axesWithValidRange,g=u.axesRanges,u.isValid)for(x=0;x<I.length;x++)I[x].setViewPortRange((w=g[x]).val1,w.val2),this.syncCharts&&"y"!=this.zoomType&&this.syncCharts(w.val1,w.val2),this.stockChart&&(this.stockChart._rangeEventParameter={stockChart:this.stockChart,source:"chart",index:this.stockChart.charts.indexOf(this),minimum:w.val1,maximum:w.val2});return u.isValid},Ct.prototype.validateRegion=function(u,I,g,x,w){w=w||!1;for(var D=0<=this.zoomType.indexOf("x"),o=0<=this.zoomType.indexOf("y"),y=!1,f=[],c=[],d=[],M=0;M<this._axes.length;M++)("axisX"===this._axes[M].type&&D||"axisY"===this._axes[M].type&&o)&&c.push(this._axes[M]);for(o=0;o<c.length;o++){if(D=!1,(R=(M=c[o]).convertPixelToValue({x:u,y:I}))>(C=M.convertPixelToValue({x:g,y:x})))var k=C,C=R,R=k;if(M.scaleBreaks)for(k=0;!D&&k<M.scaleBreaks._appliedBreaks.length;k++)D=M.scaleBreaks._appliedBreaks[k].startValue<=R&&M.scaleBreaks._appliedBreaks[k].endValue>=C;if(isFinite(M.dataInfo.minDiff))if(k=M.getApparentDifference(R,C,null,!0),D||!(this.panEnabled&&M.scaleBreaks&&M.scaleBreaks._appliedBreaks.length)&&(M.logarithmic&&k<Math.pow(M.dataInfo.minDiff,3)||!M.logarithmic&&k<3*Math.abs(M.dataInfo.minDiff))||R<M.minimum||C>M.maximum){if(!w){y=!1;break}}else f.push(M),d.push({val1:R,val2:C}),y=!0}return{isValid:y,axesWithValidRange:f,axesRanges:d}},Ct.prototype.preparePlotArea=function(){var u=this.plotArea;if(!oe&&(0<u.x1||0<u.y1)&&u.ctx.translate(u.x1,u.y1),(this.axisX[0]||this.axisX2[0])&&(this.axisY[0]||this.axisY2[0])){var I=this.axisX[0]?this.axisX[0].lineCoordinates:this.axisX2[0].lineCoordinates;if(this.axisY&&0<this.axisY.length&&this.axisY[0]){var g=this.axisY[0];u.x1=I.x1<I.x2?I.x1:g.lineCoordinates.x1,u.y1=I.y1<g.lineCoordinates.y1?I.y1:g.lineCoordinates.y1,u.x2=I.x2>g.lineCoordinates.x2?I.x2:g.lineCoordinates.x2,u.y2=I.y2>I.y1?I.y2:g.lineCoordinates.y2,u.width=u.x2-u.x1,u.height=u.y2-u.y1}this.axisY2&&0<this.axisY2.length&&this.axisY2[0]&&(g=this.axisY2[0],u.x1=I.x1<I.x2?I.x1:g.lineCoordinates.x1,u.y1=I.y1<g.lineCoordinates.y1?I.y1:g.lineCoordinates.y1,u.x2=I.x2>g.lineCoordinates.x2?I.x2:g.lineCoordinates.x2,u.y2=I.y2>I.y1?I.y2:g.lineCoordinates.y2,u.width=u.x2-u.x1,u.height=u.y2-u.y1)}else I=this.layoutManager.getFreeSpace(),u.x1=I.x1,u.x2=I.x2,u.y1=I.y1,u.y2=I.y2,u.width=I.width,u.height=I.height;oe||(u.canvas.width=u.width,u.canvas.height=u.height,u.canvas.style.left=u.x1+"px",u.canvas.style.top=u.y1+"px",(0<u.x1||0<u.y1)&&u.ctx.translate(-u.x1,-u.y1)),u.layoutManager=new As(u.x1,u.y1,u.x2,u.y2,2)},Ct.prototype.renderIndexLabels=function(u){var I=u||this.plotArea.ctx,g=this.plotArea,x=0,w=0,D=0,o=D=w=0,y=0,f=x=0,c=0;for(u=0;u<this._indexLabels.length;u++){var k,C,d=this._indexLabels[u],M=d.chartType.toLowerCase(),R=(o=en("indexLabelFontColor",d.dataPoint,d.dataSeries),en("indexLabelFontSize",d.dataPoint,d.dataSeries)),B=(y=en("indexLabelFontFamily",d.dataPoint,d.dataSeries),f=en("indexLabelFontStyle",d.dataPoint,d.dataSeries),c=en("indexLabelFontWeight",d.dataPoint,d.dataSeries),en("indexLabelBackgroundColor",d.dataPoint,d.dataSeries));k=en("indexLabelMaxWidth",d.dataPoint,d.dataSeries),C=en("indexLabelWrap",d.dataPoint,d.dataSeries);var O=en("indexLabelLineDashType",d.dataPoint,d.dataSeries),L=en("indexLabelLineColor",d.dataPoint,d.dataSeries),X=$t(d.dataPoint.indexLabelLineThickness)?$t(d.dataSeries.options.indexLabelLineThickness)?0:d.dataSeries.options.indexLabelLineThickness:d.dataPoint.indexLabelLineThickness,E=(x=0<X?Math.min(10,("normal"===this.plotInfo.axisPlacement?this.plotArea.height:this.plotArea.width)<<0):0,{percent:null,total:null}),Y=null;(0<=d.dataSeries.type.indexOf("stacked")||"pie"===d.dataSeries.type||"doughnut"===d.dataSeries.type)&&(E=this.getPercentAndTotal(d.dataSeries,d.dataPoint)),(d.dataSeries.indexLabelFormatter||d.dataPoint.indexLabelFormatter)&&(Y={chart:this,dataSeries:d.dataSeries,dataPoint:d.dataPoint,index:d.indexKeyword,total:E.total,percent:E.percent});var it=d.dataPoint.indexLabelFormatter?d.dataPoint.indexLabelFormatter(Y):d.dataPoint.indexLabel?this.replaceKeywordsWithValue(d.dataPoint.indexLabel,d.dataPoint,d.dataSeries,null,d.indexKeyword):d.dataSeries.indexLabelFormatter?d.dataSeries.indexLabelFormatter(Y):d.dataSeries.indexLabel?this.replaceKeywordsWithValue(d.dataSeries.indexLabel,d.dataPoint,d.dataSeries,null,d.indexKeyword):null;if(null!==it&&""!==it){E=en("indexLabelPlacement",d.dataPoint,d.dataSeries),Y=en("indexLabelOrientation",d.dataPoint,d.dataSeries);var J=en("indexLabelTextAlign",d.dataPoint,d.dataSeries),q=d.direction,nt=(w=d.dataSeries.axisX,D=d.dataSeries.axisY,!1);if((B=new Ri(I,{x:0,y:0,maxWidth:k||.5*this.width,maxHeight:C?5*R:1.5*R,angle:"horizontal"===Y?0:-90,text:it,padding:0,backgroundColor:B,textAlign:J,fontSize:R,fontFamily:y,fontWeight:c,fontColor:o,fontStyle:f,textBaseline:"middle"})).measureText(),d.dataSeries.indexLabelMaxWidth=B.maxWidth,"stackedarea100"===M){if(d.point.x<g.x1||d.point.x>g.x2||d.point.y<g.y1-1||d.point.y>g.y2+1)continue}else if("rangearea"===M||"rangesplinearea"===M){if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum||Math.max.apply(null,d.dataPoint.y)<D.viewportMinimum||Math.min.apply(null,d.dataPoint.y)>D.viewportMaximum)continue}else if(0<=M.indexOf("line")||0<=M.indexOf("area")||0<=M.indexOf("bubble")||0<=M.indexOf("scatter")){if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum||d.dataPoint.y<D.viewportMinimum||d.dataPoint.y>D.viewportMaximum)continue}else if(0<=M.indexOf("column")||"waterfall"===M||"error"===M&&!d.axisSwapped){if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum||d.bounds.y1>g.y2||d.bounds.y2<g.y1)continue}else if(0<=M.indexOf("bar")||"error"===M){if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum||d.bounds.x1>g.x2||d.bounds.x2<g.x1)continue}else if("candlestick"===M||"ohlc"===M){if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum||Math.max.apply(null,d.dataPoint.y)<D.viewportMinimum||Math.min.apply(null,d.dataPoint.y)>D.viewportMaximum)continue}else if(d.dataPoint.x<w.viewportMinimum||d.dataPoint.x>w.viewportMaximum)continue;o=y=2,"horizontal"===Y?(f=B.width,c=B.height):(c=B.width,f=B.height),"normal"===this.plotInfo.axisPlacement?(0<=M.indexOf("line")||0<=M.indexOf("area")?(E="auto",y=4):0<=M.indexOf("stacked")?"auto"===E&&(E="inside"):("bubble"===M||"scatter"===M)&&(E="inside"),k=d.point.x-("horizontal"===Y?f/2:f/2-R/2),"inside"!==E?(w=g.y1,D=g.y2,0<q?(C=d.point.y+("horizontal"===Y?R/2:0)-c-y-x)<w&&(nt=(C="auto"===E?Math.max(d.point.y,w)+R/2+y:w+R/2+y)+c>d.point.y):(C=d.point.y+R/2+y+x)>D-c&&(nt=(C="auto"===E?Math.min(d.point.y,D)+R/2-c-y:D+R/2-c)<d.point.y)):(w=Math.max(d.bounds.y1,g.y1),D=Math.min(d.bounds.y2,g.y2-c+R/2),x=0<=M.indexOf("range")||"error"===M?0<q?Math.max(d.bounds.y1,g.y1)+R/2+y:Math.min(d.bounds.y2,g.y2)+R/2-c+y:(Math.max(d.bounds.y1,g.y1)+Math.min(d.bounds.y2,g.y2))/2-c/2+R/2+("horizontal"===Y?y:0),0<q?(C=Math.max(d.point.y,x))<w&&("bubble"===M||"scatter"===M)&&(C=Math.max(d.point.y-c-y,g.y1+y)):(C=Math.min(d.point.y,x))>D-c-y&&("bubble"===M||"scatter"===M)&&(C=Math.min(d.point.y+y,g.y2-c-y)),C=Math.min(C,D))):(0<=M.indexOf("line")||0<=M.indexOf("area")||0<=M.indexOf("scatter")?(E="auto",o=4):0<=M.indexOf("stacked")?"auto"===E&&(E="inside"):"bubble"===M&&(E="inside"),C=d.point.y+R/2-c/2+y,"inside"!==E?(w=g.x1,D=g.x2,0>q?(k=d.point.x-("horizontal"===Y?f:f-R/2)-o-x)<w&&(nt=(k="auto"===E?Math.max(d.point.x,w)+o:w+o)+f>d.point.x):(k=d.point.x+("horizontal"===Y?0:R/2)+o+x)>D-f-o-x&&(nt=(k="auto"===E?Math.min(d.point.x,D)-("horizontal"===Y?f:f/2)-o:D-f-o)<d.point.x)):(w=Math.max(d.bounds.x1,g.x1),Math.min(d.bounds.x2,g.x2),x=0<=M.indexOf("range")||"error"===M?0>q?Math.max(d.bounds.x1,g.x1)+R/2+o:Math.min(d.bounds.x2,g.x2)-f/2-o+("horizontal"===Y?0:R/2):(Math.max(d.bounds.x1,g.x1)+Math.min(d.bounds.x2,g.x2))/2+("horizontal"===Y?0:R/2),k=0>q?Math.max(d.point.x,x)-("horizontal"===Y?f/2:0):Math.min(d.point.x,x)-f/2,k=Math.max(k,w))),"vertical"===Y&&(C+=c-R/2),B.x=k,B.y=C,B.render(!0),X&&"inside"!==E&&(0>M.indexOf("bar")&&("error"!==M||!d.axisSwapped)&&d.point.x>g.x1&&d.point.x<g.x2||!nt)&&(0>M.indexOf("column")&&("error"!==M||d.axisSwapped)&&d.point.y>g.y1&&d.point.y<g.y2||!nt)&&(I.lineWidth=X,I.strokeStyle=L||"gray",I.setLineDash&&I.setLineDash(tn(O,X)),I.beginPath(),I.moveTo(d.point.x,d.point.y),0<=M.indexOf("bar")||"error"===M&&d.axisSwapped?I.lineTo(k+(0<d.direction?-o:f+o)+("vertical"===Y?-R/2:0),C+("vertical"===Y?-c/2:c/2-R/2)-y):0<=M.indexOf("column")||"error"===M&&!d.axisSwapped?I.lineTo(k+f/2-("horizontal"===Y?0:R/2),C+("vertical"===Y?(C-c<d.point.y?0:-c)+y:(C-R/2<d.point.y?c:0)-R/2)):I.lineTo(k+f/2-("horizontal"===Y?0:R/2),C+("vertical"===Y?C-c<d.point.y?0:-c:(C-R/2<d.point.y?c:0)-R/2)),I.stroke())}}for(I={source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0,startTimePercent:.7},u=0;u<this._indexLabels.length;u++)B=en("indexLabelBackgroundColor",(d=this._indexLabels[u]).dataPoint,d.dataSeries),d.dataSeries.indexLabelBackgroundColor=$t(B)?oe?"transparent":null:B;return I},Ct.prototype.renderLine=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var x=this._eventManager.ghostCtx;g.save();var w=this.plotArea;g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip();for(var o,D=[],y=0;y<u.dataSeriesIndexes.length;y++){var f=u.dataSeriesIndexes[y],c=this.data[f];g.lineWidth=c.lineThickness;var d=c.dataPoints,M="solid";if(g.setLineDash){var k=tn(c.nullDataLineDashType,c.lineThickness),C=tn(M=c.lineDashType,c.lineThickness);g.setLineDash(C)}this._eventManager.objectMap[R=c.id]={objectType:"dataSeries",dataSeriesIndex:f},R=bi(R),x.strokeStyle=R,x.lineWidth=0<c.lineThickness?Math.max(c.lineThickness,4):0;var R=c._colorSet,B=R=c.lineColor=c.options.lineColor?c.options.lineColor:R[0];g.strokeStyle=R;var X,E,O=!0,L=0;if(g.beginPath(),0<d.length){var Y=!1;for(L=0;L<d.length;L++)if(!((X=d[L].x.getTime?d[L].x.getTime():d[L].x)<u.axisX.dataInfo.viewPortMin||X>u.axisX.dataInfo.viewPortMax&&(!c.connectNullData||!Y)))if("number"!=typeof d[L].y)0<L&&!(c.connectNullData||Y||O)&&(g.stroke(),oe&&x.stroke()),Y=!0;else{X=u.axisX.convertValueToPixel(X),E=u.axisY.convertValueToPixel(d[L].y);var it=c.dataPointIds[L];if(this._eventManager.objectMap[it]={id:it,objectType:"dataPoint",dataSeriesIndex:f,dataPointIndex:L,x1:X,y1:E},O||Y?(!O&&c.connectNullData?(g.setLineDash&&(c.options.nullDataLineDashType||M===c.lineDashType&&c.lineDashType!==c.nullDataLineDashType)&&(g.stroke(),g.beginPath(),g.moveTo(o.x,o.y),M=c.nullDataLineDashType,g.setLineDash(k)),g.lineTo(X,E),oe&&x.lineTo(X,E)):(g.beginPath(),g.moveTo(X,E),oe&&(x.beginPath(),x.moveTo(X,E))),Y=O=!1):(g.lineTo(X,E),oe&&x.lineTo(X,E),L%500==0&&(g.stroke(),g.beginPath(),g.moveTo(X,E),oe&&(x.stroke(),x.beginPath(),x.moveTo(X,E)))),o={x:X,y:E},L<d.length-1&&(B!==(d[L].lineColor||R)||M!==(d[L].lineDashType||c.lineDashType))&&(g.stroke(),g.beginPath(),g.moveTo(X,E),g.strokeStyle=B=d[L].lineColor||R,g.setLineDash&&(d[L].lineDashType?g.setLineDash(tn(M=d[L].lineDashType,c.lineThickness)):(M=c.lineDashType,g.setLineDash(C)))),0<d[L].markerSize||0<c.markerSize){var J=c.getMarkerProperties(L,X,E,g);D.push(J),it=bi(it),oe&&D.push({x:X,y:E,ctx:x,type:J.type,size:J.size,color:it,borderColor:it,borderThickness:J.borderThickness})}(d[L].indexLabel||c.indexLabel||d[L].indexLabelFormatter||c.indexLabelFormatter)&&this._indexLabels.push({chartType:"line",dataPoint:d[L],dataSeries:c,point:{x:X,y:E},direction:0>d[L].y===u.axisY.reversed?1:-1,color:R})}g.stroke(),oe&&x.stroke()}}return ie.drawMarkers(D),oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),x.beginPath()),g.restore(),g.beginPath(),{source:I,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderStepLine=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var x=this._eventManager.ghostCtx;g.save();var w=this.plotArea;g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip();for(var o,D=[],y=0;y<u.dataSeriesIndexes.length;y++){var f=u.dataSeriesIndexes[y],c=this.data[f];g.lineWidth=c.lineThickness;var d=c.dataPoints,M="solid";if(g.setLineDash){var k=tn(c.nullDataLineDashType,c.lineThickness),C=tn(M=c.lineDashType,c.lineThickness);g.setLineDash(C)}this._eventManager.objectMap[R=c.id]={objectType:"dataSeries",dataSeriesIndex:f},R=bi(R),x.strokeStyle=R,x.lineWidth=0<c.lineThickness?Math.max(c.lineThickness,4):0;var R=c._colorSet,B=R=c.lineColor=c.options.lineColor?c.options.lineColor:R[0];g.strokeStyle=R;var X,E,O=!0,L=0;if(g.beginPath(),0<d.length){var Y=!1;for(L=0;L<d.length;L++)if(!((X=d[L].getTime?d[L].x.getTime():d[L].x)<u.axisX.dataInfo.viewPortMin||X>u.axisX.dataInfo.viewPortMax&&(!c.connectNullData||!Y)))if("number"!=typeof d[L].y)0<L&&!(c.connectNullData||Y||O)&&(g.stroke(),oe&&x.stroke()),Y=!0;else{var it=E;X=u.axisX.convertValueToPixel(X),E=u.axisY.convertValueToPixel(d[L].y);var J=c.dataPointIds[L];this._eventManager.objectMap[J]={id:J,objectType:"dataPoint",dataSeriesIndex:f,dataPointIndex:L,x1:X,y1:E},O||Y?(!O&&c.connectNullData?(g.setLineDash&&(c.options.nullDataLineDashType||M===c.lineDashType&&c.lineDashType!==c.nullDataLineDashType)&&(g.stroke(),g.beginPath(),g.moveTo(o.x,o.y),M=c.nullDataLineDashType,g.setLineDash(k)),g.lineTo(X,it),g.lineTo(X,E),oe&&(x.lineTo(X,it),x.lineTo(X,E))):(g.beginPath(),g.moveTo(X,E),oe&&(x.beginPath(),x.moveTo(X,E))),Y=O=!1):(g.lineTo(X,it),oe&&x.lineTo(X,it),g.lineTo(X,E),oe&&x.lineTo(X,E),L%500==0&&(g.stroke(),g.beginPath(),g.moveTo(X,E),oe&&(x.stroke(),x.beginPath(),x.moveTo(X,E)))),o={x:X,y:E},L<d.length-1&&(B!==(d[L].lineColor||R)||M!==(d[L].lineDashType||c.lineDashType))&&(g.stroke(),g.beginPath(),g.moveTo(X,E),g.strokeStyle=B=d[L].lineColor||R,g.setLineDash&&(d[L].lineDashType?g.setLineDash(tn(M=d[L].lineDashType,c.lineThickness)):(M=c.lineDashType,g.setLineDash(C)))),(0<d[L].markerSize||0<c.markerSize)&&(it=c.getMarkerProperties(L,X,E,g),D.push(it),J=bi(J),oe&&D.push({x:X,y:E,ctx:x,type:it.type,size:it.size,color:J,borderColor:J,borderThickness:it.borderThickness})),(d[L].indexLabel||c.indexLabel||d[L].indexLabelFormatter||c.indexLabelFormatter)&&this._indexLabels.push({chartType:"stepLine",dataPoint:d[L],dataSeries:c,point:{x:X,y:E},direction:0>d[L].y===u.axisY.reversed?1:-1,color:R})}g.stroke(),oe&&x.stroke()}}return ie.drawMarkers(D),oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),x.beginPath()),g.restore(),g.beginPath(),{source:I,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderSpline=function(u){function I(J){if(0<(J=Vt(J,2)).length){x.beginPath(),oe&&w.beginPath(),x.moveTo(J[0].x,J[0].y),J[0].newStrokeStyle&&(x.strokeStyle=J[0].newStrokeStyle),J[0].newLineDashArray&&x.setLineDash(J[0].newLineDashArray),oe&&w.moveTo(J[0].x,J[0].y);for(var q=0;q<J.length-3;q+=3)x.bezierCurveTo(J[q+1].x,J[q+1].y,J[q+2].x,J[q+2].y,J[q+3].x,J[q+3].y),oe&&w.bezierCurveTo(J[q+1].x,J[q+1].y,J[q+2].x,J[q+2].y,J[q+3].x,J[q+3].y),(0<q&&q%3e3==0||J[q+3].newStrokeStyle||J[q+3].newLineDashArray)&&(x.stroke(),x.beginPath(),x.moveTo(J[q+3].x,J[q+3].y),J[q+3].newStrokeStyle&&(x.strokeStyle=J[q+3].newStrokeStyle),J[q+3].newLineDashArray&&x.setLineDash(J[q+3].newLineDashArray),oe&&(w.stroke(),w.beginPath(),w.moveTo(J[q+3].x,J[q+3].y)));x.stroke(),oe&&w.stroke()}}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var w=this._eventManager.ghostCtx;x.save();var D=this.plotArea;x.beginPath(),x.rect(D.x1,D.y1,D.width,D.height),x.clip();for(var o=[],y=0;y<u.dataSeriesIndexes.length;y++){var f=u.dataSeriesIndexes[y],c=this.data[f];x.lineWidth=c.lineThickness;var d=c.dataPoints,M="solid";if(x.setLineDash){var k=tn(c.nullDataLineDashType,c.lineThickness),C=tn(M=c.lineDashType,c.lineThickness);x.setLineDash(C)}this._eventManager.objectMap[R=c.id]={objectType:"dataSeries",dataSeriesIndex:f},R=bi(R),w.strokeStyle=R,w.lineWidth=0<c.lineThickness?Math.max(c.lineThickness,4):0;var R=c._colorSet,B=R=c.lineColor=c.options.lineColor?c.options.lineColor:R[0];x.strokeStyle=R;var L,X,O=0,E=[];if(x.beginPath(),0<d.length)for(X=!1,O=0;O<d.length;O++)if(!((L=d[O].getTime?d[O].x.getTime():d[O].x)<u.axisX.dataInfo.viewPortMin||L>u.axisX.dataInfo.viewPortMax&&(!c.connectNullData||!X)))if("number"!=typeof d[O].y)0<O&&!X&&(c.connectNullData?x.setLineDash&&0<E.length&&(c.options.nullDataLineDashType||!d[O-1].lineDashType)&&(E[E.length-1].newLineDashArray=k,M=c.nullDataLineDashType):(I(E),E=[])),X=!0;else{L=u.axisX.convertValueToPixel(L),X=u.axisY.convertValueToPixel(d[O].y);var Y=c.dataPointIds[O];if(this._eventManager.objectMap[Y]={id:Y,objectType:"dataPoint",dataSeriesIndex:f,dataPointIndex:O,x1:L,y1:X},E[E.length]={x:L,y:X},O<d.length-1&&(B!==(d[O].lineColor||R)||M!==(d[O].lineDashType||c.lineDashType))&&(E[E.length-1].newStrokeStyle=B=d[O].lineColor||R,x.setLineDash&&(d[O].lineDashType?E[E.length-1].newLineDashArray=tn(M=d[O].lineDashType,c.lineThickness):(M=c.lineDashType,E[E.length-1].newLineDashArray=C))),0<d[O].markerSize||0<c.markerSize){var it=c.getMarkerProperties(O,L,X,x);o.push(it),Y=bi(Y),oe&&o.push({x:L,y:X,ctx:w,type:it.type,size:it.size,color:Y,borderColor:Y,borderThickness:it.borderThickness})}(d[O].indexLabel||c.indexLabel||d[O].indexLabelFormatter||c.indexLabelFormatter)&&this._indexLabels.push({chartType:"spline",dataPoint:d[O],dataSeries:c,point:{x:L,y:X},direction:0>d[O].y===u.axisY.reversed?1:-1,color:R}),X=!1}I(E)}return ie.drawMarkers(o),oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(D.x1,D.y1,D.width,D.height),w.beginPath()),x.restore(),x.beginPath(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderColumn=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,y,x=null,w=this.plotArea,c=0,f=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),d=(c=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.width,this.plotArea.width/u.plotType.totalDataSeries*.9)<<0),M=u.axisX.dataInfo.minDiff;for(isFinite(M)||(M=.3*Math.abs(u.axisX.range)),M=this.dataPointWidth=this.options.dataPointWidth?this.dataPointWidth:w.width*(u.axisX.logarithmic?Math.log(M)/Math.log(u.axisX.range):Math.abs(M)/Math.abs(u.axisX.range))/u.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&c>d&&(c=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,d)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&d<c&&(d=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,c)),M<c&&(M=c),M>d&&(M=d),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),d=0;d<u.dataSeriesIndexes.length;d++){var k=u.dataSeriesIndexes[d],C=this.data[k],R=C.dataPoints;if(0<R.length){var B=!!(5<M&&C.bevelEnabled);for(c=0;c<R.length;c++)if(!((y=R[c].getTime?R[c].x.getTime():R[c].x)<u.axisX.dataInfo.viewPortMin||y>u.axisX.dataInfo.viewPortMax)&&"number"==typeof R[c].y){D=u.axisX.convertValueToPixel(y),o=u.axisY.convertValueToPixel(R[c].y),D=u.axisX.reversed?D+u.plotType.totalDataSeries*M/2-(u.previousDataSeriesCount+d)*M<<0:D-u.plotType.totalDataSeries*M/2+(u.previousDataSeriesCount+d)*M<<0;var L,O=u.axisX.reversed?D-M<<0:D+M<<0;0<=R[c].y?L=f:(L=o,o=f),o>L&&(x=o,o=L,L=x),ps(g,u.axisX.reversed?O:D,o,u.axisX.reversed?D:O,L,x=R[c].color?R[c].color:C._colorSet[c%C._colorSet.length],0,null,B&&(u.axisY.reversed?0>R[c].y:0<=R[c].y),(u.axisY.reversed?0<=R[c].y:0>R[c].y)&&B,!1,!1,C.fillOpacity),this._eventManager.objectMap[x=C.dataPointIds[c]]={id:x,objectType:"dataPoint",dataSeriesIndex:k,dataPointIndex:c,x1:D,y1:o,x2:O,y2:L},x=bi(x),oe&&ps(this._eventManager.ghostCtx,u.axisX.reversed?O:D,o,u.axisX.reversed?D:O,L,x,0,null,!1,!1,!1,!1),(R[c].indexLabel||C.indexLabel||R[c].indexLabelFormatter||C.indexLabelFormatter)&&this._indexLabels.push({chartType:"column",dataPoint:R[c],dataSeries:C,point:{x:D+(O-D)/2,y:0>R[c].y===u.axisY.reversed?o:L},direction:0>R[c].y===u.axisY.reversed?1:-1,bounds:{x1:D,y1:Math.min(o,L),x2:O,y2:Math.max(o,L)},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.yScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:f<u.axisY.bounds.y1?u.axisY.bounds.y1:f>u.axisY.bounds.y2?u.axisY.bounds.y2:f}}},Ct.prototype.renderStackedColumn=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var c,d,x=null,w=this.plotArea,D=[],o=[],y=[],f=[],k=0,M=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),C=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.width<<0),R=u.axisX.dataInfo.minDiff;for(isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:w.width*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))/u.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),C=0;C<u.dataSeriesIndexes.length;C++){var B=u.dataSeriesIndexes[C],O=this.data[B],L=O.dataPoints;if(0<L.length){var X=!!(5<R&&O.bevelEnabled);for(g.strokeStyle="#4572A7 ",k=0;k<L.length;k++)if(!((x=L[k].x.getTime?L[k].x.getTime():L[k].x)<u.axisX.dataInfo.viewPortMin||x>u.axisX.dataInfo.viewPortMax)&&"number"==typeof L[k].y){var Y,E=(c=(c=u.axisX.convertValueToPixel(x))-u.plotType.plotUnits.length*R/2+u.index*R<<0)+R<<0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0<L[k].y)y[x]=L[k].y+(y[x]?y[x]:0),0<y[x]&&(d=u.axisY.convertValueToPixel(y[x]),Y=typeof D[x]<"u"?D[x]:M,D[x]=d);else if(u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0>=L[k].y)f[x]=L[k].y+(f[x]?f[x]:0),Y=u.axisY.convertValueToPixel(f[x]),d=typeof o[x]<"u"?o[x]:M,o[x]=Y;else if(d=u.axisY.convertValueToPixel(L[k].y),0<=L[k].y){var it=typeof D[x]<"u"?D[x]:0;D[x]=it+((Y=M-it)-(d-=it))}else o[x]=(it=o[x]?o[x]:0)+((Y=d+it)-(d=M+it));ps(g,c,u.axisY.reversed?Y:d,E,u.axisY.reversed?d:Y,x=L[k].color?L[k].color:O._colorSet[k%O._colorSet.length],0,null,X&&(u.axisY.reversed?0>L[k].y:0<=L[k].y),(u.axisY.reversed?0<=L[k].y:0>L[k].y)&&X,!1,!1,O.fillOpacity),this._eventManager.objectMap[x=O.dataPointIds[k]]={id:x,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:k,x1:c,y1:d,x2:E,y2:Y},x=bi(x),oe&&ps(this._eventManager.ghostCtx,c,d,E,Y,x,0,null,!1,!1,!1,!1),(L[k].indexLabel||O.indexLabel||L[k].indexLabelFormatter||O.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedColumn",dataPoint:L[k],dataSeries:O,point:{x:c+(E-c)/2,y:0<=L[k].y?d:Y},direction:0>L[k].y===u.axisY.reversed?1:-1,bounds:{x1:c,y1:Math.min(d,Y),x2:E,y2:Math.max(d,Y)},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.yScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:M<u.axisY.bounds.y1?u.axisY.bounds.y1:M>u.axisY.bounds.y2?u.axisY.bounds.y2:M}}},Ct.prototype.renderStackedColumn100=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var c,d,x=null,w=this.plotArea,D=[],o=[],y=[],f=[],k=0,M=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),C=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.width<<0),R=u.axisX.dataInfo.minDiff;for(isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:w.width*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))/u.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),C=0;C<u.dataSeriesIndexes.length;C++){var B=u.dataSeriesIndexes[C],O=this.data[B],L=O.dataPoints;if(0<L.length){var X=!!(5<R&&O.bevelEnabled);for(k=0;k<L.length;k++)if(!((x=L[k].x.getTime?L[k].x.getTime():L[k].x)<u.axisX.dataInfo.viewPortMin||x>u.axisX.dataInfo.viewPortMax)&&"number"==typeof L[k].y){c=u.axisX.convertValueToPixel(x),d=0!==u.dataPointYSums[x]?L[k].y/u.dataPointYSums[x]*100:0;var Y,E=(c=c-u.plotType.plotUnits.length*R/2+u.index*R<<0)+R<<0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0<L[k].y){if(y[x]=d+(typeof y[x]<"u"?y[x]:0),0>=y[x])continue;d=u.axisY.convertValueToPixel(y[x]),Y=D[x]?D[x]:M,D[x]=d}else if(u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0>=L[k].y)f[x]=d+(typeof f[x]<"u"?f[x]:0),Y=u.axisY.convertValueToPixel(f[x]),d=o[x]?o[x]:M,o[x]=Y;else if(d=u.axisY.convertValueToPixel(d),0<=L[k].y){var it=typeof D[x]<"u"?D[x]:0;d-=it,Y=M-it,u.dataSeriesIndexes.length-1===C&&1>=Math.abs(w.y1-d)&&(d=w.y1),D[x]=it+(Y-d)}else Y=d+(it=typeof o[x]<"u"?o[x]:0),d=M+it,u.dataSeriesIndexes.length-1===C&&1>=Math.abs(w.y2-Y)&&(Y=w.y2),o[x]=it+(Y-d);ps(g,c,u.axisY.reversed?Y:d,E,u.axisY.reversed?d:Y,x=L[k].color?L[k].color:O._colorSet[k%O._colorSet.length],0,null,X&&(u.axisY.reversed?0>L[k].y:0<=L[k].y),(u.axisY.reversed?0<=L[k].y:0>L[k].y)&&X,!1,!1,O.fillOpacity),this._eventManager.objectMap[x=O.dataPointIds[k]]={id:x,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:k,x1:c,y1:d,x2:E,y2:Y},x=bi(x),oe&&ps(this._eventManager.ghostCtx,c,d,E,Y,x,0,null,!1,!1,!1,!1),(L[k].indexLabel||O.indexLabel||L[k].indexLabelFormatter||O.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedColumn100",dataPoint:L[k],dataSeries:O,point:{x:c+(E-c)/2,y:0<=L[k].y?d:Y},direction:0>L[k].y===u.axisY.reversed?1:-1,bounds:{x1:c,y1:Math.min(d,Y),x2:E,y2:Math.max(d,Y)},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.yScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:M<u.axisY.bounds.y1?u.axisY.bounds.y1:M>u.axisY.bounds.y2?u.axisY.bounds.y2:M}}},Ct.prototype.renderBar=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,y,x=null,w=this.plotArea,c=0,f=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),d=(c=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.height,this.plotArea.height/u.plotType.totalDataSeries*.9)<<0),M=u.axisX.dataInfo.minDiff;for(isFinite(M)||(M=.3*Math.abs(u.axisX.range)),M=this.options.dataPointWidth?this.dataPointWidth:w.height*(u.axisX.logarithmic?Math.log(M)/Math.log(u.axisX.range):Math.abs(M)/Math.abs(u.axisX.range))/u.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&c>d&&(c=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,d)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&d<c&&(d=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,c)),M<c&&(M=c),M>d&&(M=d),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),d=0;d<u.dataSeriesIndexes.length;d++){var k=u.dataSeriesIndexes[d],C=this.data[k],R=C.dataPoints;if(0<R.length){var B=!!(5<M&&C.bevelEnabled);for(g.strokeStyle="#4572A7 ",c=0;c<R.length;c++)if(!((y=R[c].getTime?R[c].x.getTime():R[c].x)<u.axisX.dataInfo.viewPortMin||y>u.axisX.dataInfo.viewPortMax)&&"number"==typeof R[c].y){o=u.axisX.convertValueToPixel(y),D=u.axisY.convertValueToPixel(R[c].y),o=u.axisX.reversed?o+u.plotType.totalDataSeries*M/2-(u.previousDataSeriesCount+d)*M<<0:o-u.plotType.totalDataSeries*M/2+(u.previousDataSeriesCount+d)*M<<0;var L,O=u.axisX.reversed?o-M<<0:o+M<<0;0<=R[c].y?L=f:(L=D,D=f),ps(g,u.axisY.reversed?D:L,u.axisX.reversed?O:o,u.axisY.reversed?L:D,u.axisX.reversed?o:O,x=R[c].color?R[c].color:C._colorSet[c%C._colorSet.length],0,null,B,!1,!1,!1,C.fillOpacity),this._eventManager.objectMap[x=C.dataPointIds[c]]={id:x,objectType:"dataPoint",dataSeriesIndex:k,dataPointIndex:c,x1:L,y1:o,x2:D,y2:O},x=bi(x),oe&&ps(this._eventManager.ghostCtx,L,u.axisX.reversed?O:o,D,u.axisX.reversed?o:O,x,0,null,!1,!1,!1,!1),(R[c].indexLabel||C.indexLabel||R[c].indexLabelFormatter||C.indexLabelFormatter)&&this._indexLabels.push({chartType:"bar",dataPoint:R[c],dataSeries:C,point:{x:0<=R[c].y?D:L,y:o+(O-o)/2},direction:0>R[c].y===u.axisY.reversed?1:-1,bounds:{x1:Math.min(L,D),y1:o,x2:Math.max(L,D),y2:O},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.xScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:f<u.axisY.bounds.x1?u.axisY.bounds.x1:f>u.axisY.bounds.x2?u.axisY.bounds.x2:f}}},Ct.prototype.renderStackedBar=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var c,d,x=null,w=this.plotArea,D=[],o=[],y=[],f=[],k=0,M=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),C=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.height<<0),R=u.axisX.dataInfo.minDiff;for(isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:w.height*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))/u.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),C=0;C<u.dataSeriesIndexes.length;C++){var B=u.dataSeriesIndexes[C],O=this.data[B],L=O.dataPoints;if(0<L.length){var X=!!(5<R&&O.bevelEnabled);for(g.strokeStyle="#4572A7 ",k=0;k<L.length;k++)if(!((x=L[k].x.getTime?L[k].x.getTime():L[k].x)<u.axisX.dataInfo.viewPortMin||x>u.axisX.dataInfo.viewPortMax)&&"number"==typeof L[k].y){var Y,E=(d=(d=u.axisX.convertValueToPixel(x))-u.plotType.plotUnits.length*R/2+u.index*R<<0)+R<<0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0<L[k].y)y[x]=L[k].y+(y[x]?y[x]:0),0<y[x]&&(Y=D[x]?D[x]:M,D[x]=c=u.axisY.convertValueToPixel(y[x]));else if(u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0>=L[k].y)f[x]=L[k].y+(f[x]?f[x]:0),c=o[x]?o[x]:M,o[x]=Y=u.axisY.convertValueToPixel(f[x]);else if(c=u.axisY.convertValueToPixel(L[k].y),0<=L[k].y){var it=D[x]?D[x]:0;D[x]=it+((c+=it)-(Y=M+it))}else Y=c-(it=o[x]?o[x]:0),o[x]=it+((c=M-it)-Y);ps(g,u.axisY.reversed?c:Y,d,u.axisY.reversed?Y:c,E,x=L[k].color?L[k].color:O._colorSet[k%O._colorSet.length],0,null,X,!1,!1,!1,O.fillOpacity),this._eventManager.objectMap[x=O.dataPointIds[k]]={id:x,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:k,x1:Y,y1:d,x2:c,y2:E},x=bi(x),oe&&ps(this._eventManager.ghostCtx,Y,d,c,E,x,0,null,!1,!1,!1,!1),(L[k].indexLabel||O.indexLabel||L[k].indexLabelFormatter||O.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedBar",dataPoint:L[k],dataSeries:O,point:{x:0<=L[k].y?c:Y,y:d+(E-d)/2},direction:0>L[k].y===u.axisY.reversed?1:-1,bounds:{x1:Math.min(Y,c),y1:d,x2:Math.max(Y,c),y2:E},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.xScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:M<u.axisY.bounds.x1?u.axisY.bounds.x1:M>u.axisY.bounds.x2?u.axisY.bounds.x2:M}}},Ct.prototype.renderStackedBar100=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var c,d,x=null,w=this.plotArea,D=[],o=[],y=[],f=[],k=0,M=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),C=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.height<<0),R=u.axisX.dataInfo.minDiff;for(isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:w.height*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))/u.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip()),C=0;C<u.dataSeriesIndexes.length;C++){var B=u.dataSeriesIndexes[C],O=this.data[B],L=O.dataPoints;if(0<L.length){var X=!!(5<R&&O.bevelEnabled);for(g.strokeStyle="#4572A7 ",k=0;k<L.length;k++)if(!((x=L[k].x.getTime?L[k].x.getTime():L[k].x)<u.axisX.dataInfo.viewPortMin||x>u.axisX.dataInfo.viewPortMax)&&"number"==typeof L[k].y){var E;d=u.axisX.convertValueToPixel(x),E=0!==u.dataPointYSums[x]?L[k].y/u.dataPointYSums[x]*100:0;var Y=(d=d-u.plotType.plotUnits.length*R/2+u.index*R<<0)+R<<0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0<L[k].y){if(y[x]=E+(y[x]?y[x]:0),0>=y[x])continue;E=D[x]?D[x]:M,D[x]=c=u.axisY.convertValueToPixel(y[x])}else if(u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length&&0>=L[k].y)f[x]=E+(f[x]?f[x]:0),c=o[x]?o[x]:M,o[x]=E=u.axisY.convertValueToPixel(f[x]);else if(c=u.axisY.convertValueToPixel(E),0<=L[k].y){var it=D[x]?D[x]:0;E=M+it,c+=it,u.dataSeriesIndexes.length-1===C&&1>=Math.abs(w.x2-c)&&(c=w.x2),D[x]=it+(c-E)}else E=c-(it=o[x]?o[x]:0),c=M-it,u.dataSeriesIndexes.length-1===C&&1>=Math.abs(w.x1-E)&&(E=w.x1),o[x]=it+(c-E);ps(g,u.axisY.reversed?c:E,d,u.axisY.reversed?E:c,Y,x=L[k].color?L[k].color:O._colorSet[k%O._colorSet.length],0,null,X,!1,!1,!1,O.fillOpacity),this._eventManager.objectMap[x=O.dataPointIds[k]]={id:x,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:k,x1:E,y1:d,x2:c,y2:Y},x=bi(x),oe&&ps(this._eventManager.ghostCtx,E,d,c,Y,x,0,null,!1,!1,!1,!1),(L[k].indexLabel||O.indexLabel||L[k].indexLabelFormatter||O.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedBar100",dataPoint:L[k],dataSeries:O,point:{x:0<=L[k].y?c:E,y:d+(Y-d)/2},direction:0>L[k].y===u.axisY.reversed?1:-1,bounds:{x1:Math.min(E,c),y1:d,x2:Math.max(E,c),y2:Y},color:x})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.xScaleAnimation,easingFunction:te.easing.easeOutQuart,animationBase:M<u.axisY.bounds.x1?u.axisY.bounds.x1:M>u.axisY.bounds.x2?u.axisY.bounds.x2:M}}},Ct.prototype.renderArea=function(u){var I,g;function x(){it&&(0<C.lineThickness&&D.stroke(),u.axisY.logarithmic||0>=u.axisY.viewportMinimum&&0<=u.axisY.viewportMaximum?Y=E:0>u.axisY.viewportMaximum?Y=y.y1:0<u.axisY.viewportMinimum&&(Y=E),D.lineTo(O,Y),D.lineTo(it.x,Y),D.closePath(),D.globalAlpha=C.fillOpacity,D.fill(),D.globalAlpha=1,oe&&(o.lineTo(O,Y),o.lineTo(it.x,Y),o.closePath(),o.fill()),D.beginPath(),D.moveTo(O,L),o.beginPath(),o.moveTo(O,L),it={x:O,y:L})}var w=u.targetCanvasCtx||this.plotArea.ctx,D=oe?this._preRenderCtx:w;if(!(0>=u.dataSeriesIndexes.length)){var d,o=this._eventManager.ghostCtx,y=u.axisY.lineCoordinates,f=[],c=this.plotArea;D.save(),oe&&o.save(),D.beginPath(),D.rect(c.x1,c.y1,c.width,c.height),D.clip(),oe&&(o.beginPath(),o.rect(c.x1,c.y1,c.width,c.height),o.clip());for(var M=0;M<u.dataSeriesIndexes.length;M++){var k=u.dataSeriesIndexes[M],C=this.data[k],R=C.dataPoints;this._eventManager.objectMap[f=C.id]={objectType:"dataSeries",dataSeriesIndex:k},f=bi(f),o.fillStyle=f,f=[],I=!0;var O,L,X,Y,B=0,E=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),it=null;if(0<R.length){var J=C._colorSet[B%C._colorSet.length],q=C.lineColor=C.options.lineColor||J,nt=q;if(D.fillStyle=J,D.strokeStyle=q,D.lineWidth=C.lineThickness,g="solid",D.setLineDash){var dt=tn(C.nullDataLineDashType,C.lineThickness),gt=tn(g=C.lineDashType,C.lineThickness);D.setLineDash(gt)}for(var kt=!0;B<R.length;B++)if(!((X=R[B].x.getTime?R[B].x.getTime():R[B].x)<u.axisX.dataInfo.viewPortMin||X>u.axisX.dataInfo.viewPortMax&&(!C.connectNullData||!kt)))if("number"!=typeof R[B].y)C.connectNullData||kt||I||x(),kt=!0;else{O=u.axisX.convertValueToPixel(X),L=u.axisY.convertValueToPixel(R[B].y),I||kt?(!I&&C.connectNullData?(D.setLineDash&&(C.options.nullDataLineDashType||g===C.lineDashType&&C.lineDashType!==C.nullDataLineDashType)&&(I=O,g=L,O=d.x,L=d.y,x(),D.moveTo(d.x,d.y),O=I,L=g,it=d,g=C.nullDataLineDashType,D.setLineDash(dt)),D.lineTo(O,L),oe&&o.lineTo(O,L)):(D.beginPath(),D.moveTo(O,L),oe&&(o.beginPath(),o.moveTo(O,L)),it={x:O,y:L}),kt=I=!1):(D.lineTo(O,L),oe&&o.lineTo(O,L),B%250==0&&x()),d={x:O,y:L},B<R.length-1&&(nt!==(R[B].lineColor||q)||g!==(R[B].lineDashType||C.lineDashType))&&(x(),D.strokeStyle=nt=R[B].lineColor||q,D.setLineDash&&(R[B].lineDashType?D.setLineDash(tn(g=R[B].lineDashType,C.lineThickness)):(g=C.lineDashType,D.setLineDash(gt))));var mt=C.dataPointIds[B];this._eventManager.objectMap[mt]={id:mt,objectType:"dataPoint",dataSeriesIndex:k,dataPointIndex:B,x1:O,y1:L},0!==R[B].markerSize&&(0<R[B].markerSize||0<C.markerSize)&&(X=C.getMarkerProperties(B,O,L,D),f.push(X),mt=bi(mt),oe&&f.push({x:O,y:L,ctx:o,type:X.type,size:X.size,color:mt,borderColor:mt,borderThickness:X.borderThickness})),(R[B].indexLabel||C.indexLabel||R[B].indexLabelFormatter||C.indexLabelFormatter)&&this._indexLabels.push({chartType:"area",dataPoint:R[B],dataSeries:C,point:{x:O,y:L},direction:0>R[B].y===u.axisY.reversed?1:-1,color:J})}x(),ie.drawMarkers(f)}}return oe&&(w.drawImage(this._preRenderCanvas,0,0,this.width,this.height),D.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&D.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&D.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),D.clearRect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.restore()),D.restore(),{source:w,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderSplineArea=function(u){function I(){var kt=Vt(X,2);if(0<kt.length){if(0<d.lineThickness){x.beginPath(),x.moveTo(kt[0].x,kt[0].y),kt[0].newStrokeStyle&&(x.strokeStyle=kt[0].newStrokeStyle),kt[0].newLineDashArray&&x.setLineDash(kt[0].newLineDashArray);for(var mt=0;mt<kt.length-3;mt+=3)x.bezierCurveTo(kt[mt+1].x,kt[mt+1].y,kt[mt+2].x,kt[mt+2].y,kt[mt+3].x,kt[mt+3].y),oe&&w.bezierCurveTo(kt[mt+1].x,kt[mt+1].y,kt[mt+2].x,kt[mt+2].y,kt[mt+3].x,kt[mt+3].y),(kt[mt+3].newStrokeStyle||kt[mt+3].newLineDashArray)&&(x.stroke(),x.beginPath(),x.moveTo(kt[mt+3].x,kt[mt+3].y),kt[mt+3].newStrokeStyle&&(x.strokeStyle=kt[mt+3].newStrokeStyle),kt[mt+3].newLineDashArray&&x.setLineDash(kt[mt+3].newLineDashArray));x.stroke()}for(x.beginPath(),x.moveTo(kt[0].x,kt[0].y),oe&&(w.beginPath(),w.moveTo(kt[0].x,kt[0].y)),mt=0;mt<kt.length-3;mt+=3)x.bezierCurveTo(kt[mt+1].x,kt[mt+1].y,kt[mt+2].x,kt[mt+2].y,kt[mt+3].x,kt[mt+3].y),oe&&w.bezierCurveTo(kt[mt+1].x,kt[mt+1].y,kt[mt+2].x,kt[mt+2].y,kt[mt+3].x,kt[mt+3].y);u.axisY.logarithmic||0>=u.axisY.viewportMinimum&&0<=u.axisY.viewportMaximum?O=B:0>u.axisY.viewportMaximum?O=D.y1:0<u.axisY.viewportMinimum&&(O=B),L={x:kt[0].x,y:kt[0].y},x.lineTo(kt[kt.length-1].x,O),x.lineTo(L.x,O),x.closePath(),x.globalAlpha=d.fillOpacity,x.fill(),x.globalAlpha=1,oe&&(w.lineTo(kt[kt.length-1].x,O),w.lineTo(L.x,O),w.closePath(),w.fill())}}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var w=this._eventManager.ghostCtx,D=u.axisY.lineCoordinates,o=[],y=this.plotArea;x.save(),oe&&w.save(),x.beginPath(),x.rect(y.x1,y.y1,y.width,y.height),x.clip(),oe&&(w.beginPath(),w.rect(y.x1,y.y1,y.width,y.height),w.clip());for(var f=0;f<u.dataSeriesIndexes.length;f++){var c=u.dataSeriesIndexes[f],d=this.data[c],M=d.dataPoints;this._eventManager.objectMap[o=d.id]={objectType:"dataSeries",dataSeriesIndex:c},o=bi(o),w.fillStyle=o,o=[];var C,R,O,k=0,B=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),L=null,X=[];if(0<M.length){var E=d._colorSet[k%d._colorSet.length],Y=d.lineColor=d.options.lineColor||E,it=Y;x.fillStyle=E,x.strokeStyle=Y,x.lineWidth=d.lineThickness;var J="solid";if(x.setLineDash){var q=tn(d.nullDataLineDashType,d.lineThickness),nt=tn(J=d.lineDashType,d.lineThickness);x.setLineDash(nt)}for(R=!1;k<M.length;k++)if(!((C=M[k].x.getTime?M[k].x.getTime():M[k].x)<u.axisX.dataInfo.viewPortMin||C>u.axisX.dataInfo.viewPortMax&&(!d.connectNullData||!R)))if("number"!=typeof M[k].y)0<k&&!R&&(d.connectNullData?x.setLineDash&&0<X.length&&(d.options.nullDataLineDashType||!M[k-1].lineDashType)&&(X[X.length-1].newLineDashArray=q,J=d.nullDataLineDashType):(I(),X=[])),R=!0;else{C=u.axisX.convertValueToPixel(C),R=u.axisY.convertValueToPixel(M[k].y);var dt=d.dataPointIds[k];if(this._eventManager.objectMap[dt]={id:dt,objectType:"dataPoint",dataSeriesIndex:c,dataPointIndex:k,x1:C,y1:R},X[X.length]={x:C,y:R},k<M.length-1&&(it!==(M[k].lineColor||Y)||J!==(M[k].lineDashType||d.lineDashType))&&(X[X.length-1].newStrokeStyle=it=M[k].lineColor||Y,x.setLineDash&&(M[k].lineDashType?X[X.length-1].newLineDashArray=tn(J=M[k].lineDashType,d.lineThickness):(J=d.lineDashType,X[X.length-1].newLineDashArray=nt))),0!==M[k].markerSize&&(0<M[k].markerSize||0<d.markerSize)){var gt=d.getMarkerProperties(k,C,R,x);o.push(gt),dt=bi(dt),oe&&o.push({x:C,y:R,ctx:w,type:gt.type,size:gt.size,color:dt,borderColor:dt,borderThickness:gt.borderThickness})}(M[k].indexLabel||d.indexLabel||M[k].indexLabelFormatter||d.indexLabelFormatter)&&this._indexLabels.push({chartType:"splineArea",dataPoint:M[k],dataSeries:d,point:{x:C,y:R},direction:0>M[k].y===u.axisY.reversed?1:-1,color:E}),R=!1}I(),ie.drawMarkers(o)}}return oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(y.x1,y.y1,y.width,y.height),this._eventManager.ghostCtx.restore()),x.restore(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderStepArea=function(u){var I,g;function x(){it&&(0<C.lineThickness&&D.stroke(),u.axisY.logarithmic||0>=u.axisY.viewportMinimum&&0<=u.axisY.viewportMaximum?Y=E:0>u.axisY.viewportMaximum?Y=y.y1:0<u.axisY.viewportMinimum&&(Y=E),D.lineTo(O,Y),D.lineTo(it.x,Y),D.closePath(),D.globalAlpha=C.fillOpacity,D.fill(),D.globalAlpha=1,oe&&(o.lineTo(O,Y),o.lineTo(it.x,Y),o.closePath(),o.fill()),D.beginPath(),D.moveTo(O,L),o.beginPath(),o.moveTo(O,L),it={x:O,y:L})}var w=u.targetCanvasCtx||this.plotArea.ctx,D=oe?this._preRenderCtx:w;if(!(0>=u.dataSeriesIndexes.length)){var d,o=this._eventManager.ghostCtx,y=u.axisY.lineCoordinates,f=[],c=this.plotArea;D.save(),oe&&o.save(),D.beginPath(),D.rect(c.x1,c.y1,c.width,c.height),D.clip(),oe&&(o.beginPath(),o.rect(c.x1,c.y1,c.width,c.height),o.clip());for(var M=0;M<u.dataSeriesIndexes.length;M++){var k=u.dataSeriesIndexes[M],C=this.data[k],R=C.dataPoints;this._eventManager.objectMap[f=C.id]={objectType:"dataSeries",dataSeriesIndex:k},f=bi(f),o.fillStyle=f,f=[],I=!0;var O,L,X,Y,B=0,E=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),it=null;if(g=!1,0<R.length){var J=C._colorSet[B%C._colorSet.length],q=C.lineColor=C.options.lineColor||J,nt=q;D.fillStyle=J,D.strokeStyle=q,D.lineWidth=C.lineThickness;var dt="solid";if(D.setLineDash){var gt=tn(C.nullDataLineDashType,C.lineThickness),kt=tn(dt=C.lineDashType,C.lineThickness);D.setLineDash(kt)}for(;B<R.length;B++)if(!((X=R[B].x.getTime?R[B].x.getTime():R[B].x)<u.axisX.dataInfo.viewPortMin||X>u.axisX.dataInfo.viewPortMax&&(!C.connectNullData||!g))){var mt=L;"number"!=typeof R[B].y?(C.connectNullData||g||I||x(),g=!0):(O=u.axisX.convertValueToPixel(X),L=u.axisY.convertValueToPixel(R[B].y),I||g?(!I&&C.connectNullData?(D.setLineDash&&(C.options.nullDataLineDashType||dt===C.lineDashType&&C.lineDashType!==C.nullDataLineDashType)&&(I=O,g=L,O=d.x,L=d.y,x(),D.moveTo(d.x,d.y),O=I,L=g,it=d,dt=C.nullDataLineDashType,D.setLineDash(gt)),D.lineTo(O,mt),D.lineTo(O,L),oe&&(o.lineTo(O,mt),o.lineTo(O,L))):(D.beginPath(),D.moveTo(O,L),oe&&(o.beginPath(),o.moveTo(O,L)),it={x:O,y:L}),g=I=!1):(D.lineTo(O,mt),oe&&o.lineTo(O,mt),D.lineTo(O,L),oe&&o.lineTo(O,L),B%250==0&&x()),d={x:O,y:L},B<R.length-1&&(nt!==(R[B].lineColor||q)||dt!==(R[B].lineDashType||C.lineDashType))&&(x(),D.strokeStyle=nt=R[B].lineColor||q,D.setLineDash&&(R[B].lineDashType?D.setLineDash(tn(dt=R[B].lineDashType,C.lineThickness)):(dt=C.lineDashType,D.setLineDash(kt)))),this._eventManager.objectMap[X=C.dataPointIds[B]]={id:X,objectType:"dataPoint",dataSeriesIndex:k,dataPointIndex:B,x1:O,y1:L},0!==R[B].markerSize&&(0<R[B].markerSize||0<C.markerSize)&&(mt=C.getMarkerProperties(B,O,L,D),f.push(mt),X=bi(X),oe&&f.push({x:O,y:L,ctx:o,type:mt.type,size:mt.size,color:X,borderColor:X,borderThickness:mt.borderThickness})),(R[B].indexLabel||C.indexLabel||R[B].indexLabelFormatter||C.indexLabelFormatter)&&this._indexLabels.push({chartType:"stepArea",dataPoint:R[B],dataSeries:C,point:{x:O,y:L},direction:0>R[B].y===u.axisY.reversed?1:-1,color:J}))}x(),ie.drawMarkers(f)}}return oe&&(w.drawImage(this._preRenderCanvas,0,0,this.width,this.height),D.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&D.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&D.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),D.clearRect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.restore()),D.restore(),{source:w,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderStackedArea=function(u){function I(){if(!(1>c.length)){for(0<J.lineThickness&&x.stroke();0<c.length;){var vt=c.pop();x.lineTo(vt.x,vt.y),oe&&O.lineTo(vt.x,vt.y)}x.closePath(),x.globalAlpha=J.fillOpacity,x.fill(),x.globalAlpha=1,x.beginPath(),oe&&(O.closePath(),O.fill(),O.beginPath()),c=[]}}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var C,R,L,X,E,w=null,D=null,o=[],y=this.plotArea,f=[],c=[],d=[],M=[],k=0,B=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),O=this._eventManager.ghostCtx;oe&&O.beginPath(),x.save(),oe&&O.save(),x.beginPath(),x.rect(y.x1,y.y1,y.width,y.height),x.clip(),oe&&(O.beginPath(),O.rect(y.x1,y.y1,y.width,y.height),O.clip()),w=[];for(var Y=0;Y<u.dataSeriesIndexes.length;Y++){var it=u.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;for(J.dataPointIndexes=[],k=0;k<q.length;k++)it=q[k].x.getTime?q[k].x.getTime():q[k].x,J.dataPointIndexes[it]=k,w[it]||(d.push(it),w[it]=!0);d.sort(pn)}for(Y=0;Y<u.dataSeriesIndexes.length;Y++){if(q=(J=this.data[it=u.dataSeriesIndexes[Y]]).dataPoints,X=!0,c=[],this._eventManager.objectMap[k=J.id]={objectType:"dataSeries",dataSeriesIndex:it},k=bi(k),O.fillStyle=k,0<d.length){w=J._colorSet[0];var nt=J.lineColor=J.options.lineColor||w,dt=nt;if(x.fillStyle=w,x.strokeStyle=nt,x.lineWidth=J.lineThickness,E="solid",x.setLineDash){var gt=tn(J.nullDataLineDashType,J.lineThickness),kt=tn(E=J.lineDashType,J.lineThickness);x.setLineDash(kt)}var mt=!0;for(k=0;k<d.length;k++){var Tt=0<=J.dataPointIndexes[D=d[k]]?q[J.dataPointIndexes[D]]:{x:D,y:null};if(!(D<u.axisX.dataInfo.viewPortMin||D>u.axisX.dataInfo.viewPortMax&&(!J.connectNullData||!mt)))if("number"!=typeof Tt.y)J.connectNullData||mt||X||I(),mt=!0;else{C=u.axisX.convertValueToPixel(D);var ee=f[D]?f[D]:0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length){if(M[D]=Tt.y+(M[D]?M[D]:0),0>=M[D]&&u.axisY.logarithmic)continue;R=u.axisY.convertValueToPixel(M[D])}else R=u.axisY.convertValueToPixel(Tt.y),R-=ee;if(c.push({x:C,y:B-ee}),f[D]=B-R,X||mt?(!X&&J.connectNullData?(x.setLineDash&&(J.options.nullDataLineDashType||E===J.lineDashType&&J.lineDashType!==J.nullDataLineDashType)&&(X=c.pop(),E=c[c.length-1],I(),x.moveTo(L.x,L.y),c.push(E),c.push(X),E=J.nullDataLineDashType,x.setLineDash(gt)),x.lineTo(C,R),oe&&O.lineTo(C,R)):(x.beginPath(),x.moveTo(C,R),oe&&(O.beginPath(),O.moveTo(C,R))),mt=X=!1):(x.lineTo(C,R),oe&&O.lineTo(C,R),k%250==0&&(I(),x.moveTo(C,R),oe&&O.moveTo(C,R),c.push({x:C,y:B-ee}))),L={x:C,y:R},k<q.length-1&&(dt!==(q[k].lineColor||nt)||E!==(q[k].lineDashType||J.lineDashType))&&(I(),x.beginPath(),x.moveTo(C,R),c.push({x:C,y:B-ee}),x.strokeStyle=dt=q[k].lineColor||nt,x.setLineDash&&(q[k].lineDashType?x.setLineDash(tn(E=q[k].lineDashType,J.lineThickness)):(E=J.lineDashType,x.setLineDash(kt)))),0<=J.dataPointIndexes[D]){var Ft=J.dataPointIds[J.dataPointIndexes[D]];this._eventManager.objectMap[Ft]={id:Ft,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:J.dataPointIndexes[D],x1:C,y1:R}}0<=J.dataPointIndexes[D]&&0!==Tt.markerSize&&(0<Tt.markerSize||0<J.markerSize)&&(ee=J.getMarkerProperties(J.dataPointIndexes[D],C,R,x),o.push(ee),D=bi(Ft),oe&&o.push({x:C,y:R,ctx:O,type:ee.type,size:ee.size,color:D,borderColor:D,borderThickness:ee.borderThickness})),(Tt.indexLabel||J.indexLabel||Tt.indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedArea",dataPoint:Tt,dataSeries:J,point:{x:C,y:R},direction:0>q[k].y===u.axisY.reversed?1:-1,color:w})}}I(),x.moveTo(C,R),oe&&O.moveTo(C,R)}delete J.dataPointIndexes}return ie.drawMarkers(o),oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(y.x1,y.y1,y.width,y.height),O.restore()),x.restore(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderStackedArea100=function(u){function I(){for(0<J.lineThickness&&x.stroke();0<c.length;){var le=c.pop();x.lineTo(le.x,le.y),oe&&E.lineTo(le.x,le.y)}x.closePath(),x.globalAlpha=J.fillOpacity,x.fill(),x.globalAlpha=1,x.beginPath(),oe&&(E.closePath(),E.fill(),E.beginPath()),c=[]}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var C,R,B,O,L,w=null,D=null,o=this.plotArea,y=[],f=[],c=[],d=[],M=[],k=0,X=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0),E=this._eventManager.ghostCtx;x.save(),oe&&E.save(),x.beginPath(),x.rect(o.x1,o.y1,o.width,o.height),x.clip(),oe&&(E.beginPath(),E.rect(o.x1,o.y1,o.width,o.height),E.clip()),w=[];for(var Y=0;Y<u.dataSeriesIndexes.length;Y++){var it=u.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;for(J.dataPointIndexes=[],k=0;k<q.length;k++)it=q[k].x.getTime?q[k].x.getTime():q[k].x,J.dataPointIndexes[it]=k,w[it]||(d.push(it),w[it]=!0);d.sort(pn)}for(Y=0;Y<u.dataSeriesIndexes.length;Y++){if(q=(J=this.data[it=u.dataSeriesIndexes[Y]]).dataPoints,O=!0,this._eventManager.objectMap[w=J.id]={objectType:"dataSeries",dataSeriesIndex:it},w=bi(w),E.fillStyle=w,c=[],0<d.length){w=J._colorSet[k%J._colorSet.length];var nt=J.lineColor=J.options.lineColor||w,dt=nt;if(x.fillStyle=w,x.strokeStyle=nt,x.lineWidth=J.lineThickness,L="solid",x.setLineDash){var gt=tn(J.nullDataLineDashType,J.lineThickness),kt=tn(L=J.lineDashType,J.lineThickness);x.setLineDash(kt)}var mt=!0;for(k=0;k<d.length;k++){var Tt=0<=J.dataPointIndexes[D=d[k]]?q[J.dataPointIndexes[D]]:{x:D,y:null};if(!(D<u.axisX.dataInfo.viewPortMin||D>u.axisX.dataInfo.viewPortMax&&(!J.connectNullData||!mt)))if("number"!=typeof Tt.y)J.connectNullData||mt||O||I(),mt=!0;else{var ee;ee=0!==u.dataPointYSums[D]?Tt.y/u.dataPointYSums[D]*100:0,C=u.axisX.convertValueToPixel(D);var Ft=f[D]?f[D]:0;if(u.axisY.logarithmic||u.axisY.scaleBreaks&&0<u.axisY.scaleBreaks._appliedBreaks.length){if(M[D]=ee+(M[D]?M[D]:0),0>=M[D]&&u.axisY.logarithmic)continue;R=u.axisY.convertValueToPixel(M[D])}else R=u.axisY.convertValueToPixel(ee),R-=Ft;if(c.push({x:C,y:X-Ft}),f[D]=X-R,O||mt?(!O&&J.connectNullData?(x.setLineDash&&(J.options.nullDataLineDashType||L===J.lineDashType&&J.lineDashType!==J.nullDataLineDashType)&&(O=c.pop(),L=c[c.length-1],I(),x.moveTo(B.x,B.y),c.push(L),c.push(O),L=J.nullDataLineDashType,x.setLineDash(gt)),x.lineTo(C,R),oe&&E.lineTo(C,R)):(x.beginPath(),x.moveTo(C,R),oe&&(E.beginPath(),E.moveTo(C,R))),mt=O=!1):(x.lineTo(C,R),oe&&E.lineTo(C,R),k%250==0&&(I(),x.moveTo(C,R),oe&&E.moveTo(C,R),c.push({x:C,y:X-Ft}))),B={x:C,y:R},k<q.length-1&&(dt!==(q[k].lineColor||nt)||L!==(q[k].lineDashType||J.lineDashType))&&(I(),x.beginPath(),x.moveTo(C,R),c.push({x:C,y:X-Ft}),x.strokeStyle=dt=q[k].lineColor||nt,x.setLineDash&&(q[k].lineDashType?x.setLineDash(tn(L=q[k].lineDashType,J.lineThickness)):(L=J.lineDashType,x.setLineDash(kt)))),0<=J.dataPointIndexes[D]){var vt=J.dataPointIds[J.dataPointIndexes[D]];this._eventManager.objectMap[vt]={id:vt,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:J.dataPointIndexes[D],x1:C,y1:R}}0<=J.dataPointIndexes[D]&&0!==Tt.markerSize&&(0<Tt.markerSize||0<J.markerSize)&&(Ft=J.getMarkerProperties(k,C,R,x),y.push(Ft),D=bi(vt),oe&&y.push({x:C,y:R,ctx:E,type:Ft.type,size:Ft.size,color:D,borderColor:D,borderThickness:Ft.borderThickness})),(Tt.indexLabel||J.indexLabel||Tt.indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedArea100",dataPoint:Tt,dataSeries:J,point:{x:C,y:R},direction:0>q[k].y===u.axisY.reversed?1:-1,color:w})}}I(),x.moveTo(C,R),oe&&E.moveTo(C,R)}delete J.dataPointIndexes}return ie.drawMarkers(y),oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(o.x1,o.y1,o.width,o.height),E.restore()),x.restore(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderBubble=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,x=this.plotArea,w=0;g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(x.x1,x.y1,x.width,x.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(x.x1,x.y1,x.width,x.height),this._eventManager.ghostCtx.clip());for(var y=-1/0,f=1/0,c=0;c<u.dataSeriesIndexes.length;c++){var d=u.dataSeriesIndexes[c],M=this.data[d],k=M.dataPoints,C=0;for(w=0;w<k.length;w++)(D=D=k[w].getTime?k[w].x.getTime():k[w].x)<u.axisX.dataInfo.viewPortMin||D>u.axisX.dataInfo.viewPortMax||typeof k[w].z>"u"||((C=k[w].z)>y&&(y=C),C<f&&(f=C))}var R=25*Math.PI,B=Math.max(Math.pow(.25*Math.min(x.height,x.width)/2,2)*Math.PI,R);for(c=0;c<u.dataSeriesIndexes.length;c++)if(0<(k=(M=this.data[d=u.dataSeriesIndexes[c]]).dataPoints).length)for(g.strokeStyle="#4572A7 ",w=0;w<k.length;w++)if(!((D=D=k[w].getTime?k[w].x.getTime():k[w].x)<u.axisX.dataInfo.viewPortMin||D>u.axisX.dataInfo.viewPortMax)&&"number"==typeof k[w].y){D=u.axisX.convertValueToPixel(D),o=u.axisY.convertValueToPixel(k[w].y),C=k[w].z;var O=2*Math.max(Math.sqrt((y===f?B/2:R+(B-R)/(y-f)*(C-f))/Math.PI)<<0,1);(C=M.getMarkerProperties(w,g)).size=O,g.globalAlpha=M.fillOpacity,ie.drawMarker(D,o,g,C.type,C.size,C.color,C.borderColor,C.borderThickness),g.globalAlpha=1;var L=M.dataPointIds[w];this._eventManager.objectMap[L]={id:L,objectType:"dataPoint",dataSeriesIndex:d,dataPointIndex:w,x1:D,y1:o,size:O},O=bi(L),oe&&ie.drawMarker(D,o,this._eventManager.ghostCtx,C.type,C.size,O,O,C.borderThickness),(k[w].indexLabel||M.indexLabel||k[w].indexLabelFormatter||M.indexLabelFormatter)&&this._indexLabels.push({chartType:"bubble",dataPoint:k[w],dataSeries:M,point:{x:D,y:o},direction:1,bounds:{x1:D-C.size/2,y1:o-C.size/2,x2:D+C.size/2,y2:o+C.size/2},color:null})}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(x.x1,x.y1,x.width,x.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderScatter=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,x=this.plotArea,w=0;g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(x.x1,x.y1,x.width,x.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(x.x1,x.y1,x.width,x.height),this._eventManager.ghostCtx.clip());for(var y=0;y<u.dataSeriesIndexes.length;y++){var f=u.dataSeriesIndexes[y],c=this.data[f],d=c.dataPoints;if(0<d.length){g.strokeStyle="#4572A7 ",Math.pow(.3*Math.min(x.height,x.width)/2,2);var M=0,k=0;for(w=0;w<d.length;w++)if(!((D=D=d[w].getTime?d[w].x.getTime():d[w].x)<u.axisX.dataInfo.viewPortMin||D>u.axisX.dataInfo.viewPortMax)&&"number"==typeof d[w].y){D=u.axisX.convertValueToPixel(D),o=u.axisY.convertValueToPixel(d[w].y);var C=c.getMarkerProperties(w,D,o,g);g.globalAlpha=c.fillOpacity,ie.drawMarker(C.x,C.y,C.ctx,C.type,C.size,C.color,C.borderColor,C.borderThickness),g.globalAlpha=1,Math.sqrt((M-D)*(M-D)+(k-o)*(k-o))<Math.min(C.size,5)&&d.length>Math.min(this.plotArea.width,this.plotArea.height)||(this._eventManager.objectMap[M=c.dataPointIds[w]]={id:M,objectType:"dataPoint",dataSeriesIndex:f,dataPointIndex:w,x1:D,y1:o},M=bi(M),oe&&ie.drawMarker(C.x,C.y,this._eventManager.ghostCtx,C.type,C.size,M,M,C.borderThickness),(d[w].indexLabel||c.indexLabel||d[w].indexLabelFormatter||c.indexLabelFormatter)&&this._indexLabels.push({chartType:"scatter",dataPoint:d[w],dataSeries:c,point:{x:D,y:o},direction:1,bounds:{x1:D-C.size/2,y1:o-C.size/2,x2:D+C.size/2,y2:o+C.size/2},color:null}),M=D,k=o)}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(x.x1,x.y1,x.width,x.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderCandlestick=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I,x=this._eventManager.ghostCtx;if(!(0>=u.dataSeriesIndexes.length)){var o,y,f,c,d,M,k=null,C=null,w=this.plotArea,D=0,R=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,C=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.015*this.width,u.axisX.dataInfo.minDiff);isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:.7*w.width*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&x.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(x.beginPath(),x.rect(w.x1,w.y1,w.width,w.height),x.clip());for(var B=0;B<u.dataSeriesIndexes.length;B++){var O=u.dataSeriesIndexes[B],L=this.data[O],X=L.dataPoints;if(0<X.length){var E=!!(5<R&&L.bevelEnabled);for(D=0;D<X.length;D++)if(!((M=X[D].getTime?X[D].x.getTime():X[D].x)<u.axisX.dataInfo.viewPortMin||M>u.axisX.dataInfo.viewPortMax)&&!$t(X[D].y)&&X[D].y.length&&"number"==typeof X[D].y[0]&&"number"==typeof X[D].y[1]&&"number"==typeof X[D].y[2]&&"number"==typeof X[D].y[3]){o=u.axisX.convertValueToPixel(M),y=u.axisY.convertValueToPixel(X[D].y[0]),f=u.axisY.convertValueToPixel(X[D].y[1]),c=u.axisY.convertValueToPixel(X[D].y[2]),d=u.axisY.convertValueToPixel(X[D].y[3]);var Y=o-R/2<<0,it=Y+R<<0,J=(C=L.options.fallingColor?L.fallingColor:L._colorSet[0],k=X[D].color?X[D].color:L._colorSet[0],Math.round(Math.max(1,.15*R))),q=J%2==0?0:.5,nt=L.dataPointIds[D];this._eventManager.objectMap[nt]={id:nt,objectType:"dataPoint",dataSeriesIndex:O,dataPointIndex:D,x1:Y,y1:y,x2:it,y2:f,x3:o,y3:c,x4:o,y4:d,borderThickness:J,color:k},g.strokeStyle=k,g.beginPath(),g.lineWidth=J,x.lineWidth=Math.max(J,4),"candlestick"===L.type?(g.moveTo(o-q,f),g.lineTo(o-q,Math.min(y,d)),g.stroke(),g.moveTo(o-q,Math.max(y,d)),g.lineTo(o-q,c),g.stroke(),ps(g,Y,Math.min(y,d),it,Math.max(y,d),X[D].y[0]<=X[D].y[3]?L.risingColor:C,J,k,E,E,!1,!1,L.fillOpacity),oe&&(k=bi(nt),x.strokeStyle=k,x.moveTo(o-q,f),x.lineTo(o-q,Math.min(y,d)),x.stroke(),x.moveTo(o-q,Math.max(y,d)),x.lineTo(o-q,c),x.stroke(),ps(x,Y,Math.min(y,d),it,Math.max(y,d),k,0,null,!1,!1,!1,!1))):"ohlc"===L.type&&(g.moveTo(o-q,f),g.lineTo(o-q,c),g.stroke(),g.beginPath(),g.moveTo(o,y),g.lineTo(Y,y),g.stroke(),g.beginPath(),g.moveTo(o,d),g.lineTo(it,d),g.stroke(),oe&&(k=bi(nt),x.strokeStyle=k,x.moveTo(o-q,f),x.lineTo(o-q,c),x.stroke(),x.beginPath(),x.moveTo(o,y),x.lineTo(Y,y),x.stroke(),x.beginPath(),x.moveTo(o,d),x.lineTo(it,d),x.stroke())),(X[D].indexLabel||L.indexLabel||X[D].indexLabelFormatter||L.indexLabelFormatter)&&this._indexLabels.push({chartType:L.type,dataPoint:X[D],dataSeries:L,point:{x:Y+(it-Y)/2,y:u.axisY.reversed?c:f},direction:1,bounds:{x1:Y,y1:Math.min(f,c),x2:it,y2:Math.max(f,c)},color:k})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),x.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderBoxAndWhisker=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I,x=this._eventManager.ghostCtx;if(!(0>=u.dataSeriesIndexes.length)){var D,o,y,f,c,d,M,k=null,w=this.plotArea,C=0,R=(k=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,C=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.015*this.width,u.axisX.dataInfo.minDiff);isFinite(R)||(R=.3*Math.abs(u.axisX.range)),R=this.options.dataPointWidth?this.dataPointWidth:.7*w.width*(u.axisX.logarithmic?Math.log(R)/Math.log(u.axisX.range):Math.abs(R)/Math.abs(u.axisX.range))<<0,this.dataPointMaxWidth&&k>C&&(k=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<k&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,k)),R<k&&(R=k),R>C&&(R=C),g.save(),oe&&x.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(x.beginPath(),x.rect(w.x1,w.y1,w.width,w.height),x.clip());for(var B=!!u.axisY.reversed,O=0;O<u.dataSeriesIndexes.length;O++){var L=u.dataSeriesIndexes[O],X=this.data[L],E=X.dataPoints;if(0<E.length){var Y=!!(5<R&&X.bevelEnabled);for(C=0;C<E.length;C++)if(!((M=E[C].getTime?E[C].x.getTime():E[C].x)<u.axisX.dataInfo.viewPortMin||M>u.axisX.dataInfo.viewPortMax)&&!$t(E[C].y)&&E[C].y.length&&"number"==typeof E[C].y[0]&&"number"==typeof E[C].y[1]&&"number"==typeof E[C].y[2]&&"number"==typeof E[C].y[3]&&"number"==typeof E[C].y[4]&&5===E[C].y.length){D=u.axisX.convertValueToPixel(M),o=u.axisY.convertValueToPixel(E[C].y[0]),y=u.axisY.convertValueToPixel(E[C].y[1]),f=u.axisY.convertValueToPixel(E[C].y[2]),c=u.axisY.convertValueToPixel(E[C].y[3]),d=u.axisY.convertValueToPixel(E[C].y[4]);var it=D-R/2<<0,J=D+R/2<<0,q=(k=E[C].color?E[C].color:X._colorSet[0],Math.round(Math.max(1,.15*R))),nt=q%2==0?0:.5,dt=E[C].whiskerColor?E[C].whiskerColor:E[C].color?X.whiskerColor?X.whiskerColor:E[C].color:X.whiskerColor?X.whiskerColor:k,gt="number"==typeof E[C].whiskerThickness?E[C].whiskerThickness:"number"==typeof X.options.whiskerThickness?X.whiskerThickness:q,kt=E[C].whiskerDashType?E[C].whiskerDashType:X.whiskerDashType,mt="number"==typeof(mt=$t(E[C].whiskerLength)?$t(X.options.whiskerLength)?R:X.whiskerLength:E[C].whiskerLength)?0>=mt?0:mt>=R?R:mt:"string"==typeof mt?parseInt(mt)*R/100>R?R:parseInt(mt)*R/100:R,Tt=Math.round(gt)%2==1?.5:0,ee=E[C].stemColor?E[C].stemColor:E[C].color?X.stemColor?X.stemColor:E[C].color:X.stemColor?X.stemColor:k,Ft="number"==typeof E[C].stemThickness?E[C].stemThickness:"number"==typeof X.options.stemThickness?X.stemThickness:q,vt=Math.round(Ft)%2==1?.5:0,le=E[C].stemDashType?E[C].stemDashType:X.stemDashType,Ht=E[C].lineColor?E[C].lineColor:E[C].color?X.lineColor?X.lineColor:E[C].color:X.lineColor?X.lineColor:k,jt="number"==typeof E[C].lineThickness?E[C].lineThickness:"number"==typeof X.options.lineThickness?X.lineThickness:q,ye=E[C].lineDashType?E[C].lineDashType:X.lineDashType,Rt=Math.round(jt)%2==1?.5:0,se=X.upperBoxColor,Ue=X.lowerBoxColor,ni=$t(X.options.fillOpacity)?1:X.fillOpacity,li=X.dataPointIds[C];this._eventManager.objectMap[li]={id:li,objectType:"dataPoint",dataSeriesIndex:L,dataPointIndex:C,x1:it,y1:o,x2:J,y2:y,x3:D,y3:f,x4:D,y4:c,y5:d,borderThickness:q,color:k,stemThickness:Ft,stemColor:ee,whiskerThickness:gt,whiskerLength:mt,whiskerColor:dt,lineThickness:jt,lineColor:Ht},g.save(),0<Ft&&(g.beginPath(),g.strokeStyle=ee,g.lineWidth=Ft,g.setLineDash&&g.setLineDash(tn(le,Ft)),g.moveTo(D-vt,y),g.lineTo(D-vt,o),g.stroke(),g.moveTo(D-vt,c),g.lineTo(D-vt,f),g.stroke()),g.restore(),x.lineWidth=Math.max(q,4),g.beginPath(),ps(g,it,Math.min(d,y),J,Math.max(y,d),Ue,0,k,!!B&&Y,!B&&Y,!1,!1,ni),g.beginPath(),ps(g,it,Math.min(f,d),J,Math.max(d,f),se,0,k,!B&&Y,!!B&&Y,!1,!1,ni),g.beginPath(),g.lineWidth=q,g.strokeStyle=k,g.rect(it-nt,Math.min(y,f)-nt,J-it+2*nt,Math.max(y,f)-Math.min(y,f)+2*nt),g.stroke(),g.save(),0<jt&&(g.beginPath(),g.globalAlpha=1,g.setLineDash&&g.setLineDash(tn(ye,jt)),g.strokeStyle=Ht,g.lineWidth=jt,g.moveTo(it,d-Rt),g.lineTo(J,d-Rt),g.stroke()),g.restore(),g.save(),0<gt&&(g.beginPath(),g.setLineDash&&g.setLineDash(tn(kt,gt)),g.strokeStyle=dt,g.lineWidth=gt,g.moveTo(D-mt/2<<0,c-Tt),g.lineTo(D+mt/2<<0,c-Tt),g.stroke(),g.moveTo(D-mt/2<<0,o+Tt),g.lineTo(D+mt/2<<0,o+Tt),g.stroke()),g.restore(),oe&&(k=bi(li),x.strokeStyle=k,x.lineWidth=Ft,0<Ft&&(x.moveTo(D-nt-vt,y),x.lineTo(D-nt-vt,Math.max(o,c)),x.stroke(),x.moveTo(D-nt-vt,Math.min(o,c)),x.lineTo(D-nt-vt,f),x.stroke()),ps(x,it,Math.max(y,f),J,Math.min(y,f),k,0,null,!1,!1,!1,!1),0<gt&&(x.beginPath(),x.lineWidth=gt,x.moveTo(D+mt/2,c-Tt),x.lineTo(D-mt/2,c-Tt),x.stroke(),x.moveTo(D+mt/2,o+Tt),x.lineTo(D-mt/2,o+Tt),x.stroke())),(E[C].indexLabel||X.indexLabel||E[C].indexLabelFormatter||X.indexLabelFormatter)&&this._indexLabels.push({chartType:X.type,dataPoint:E[C],dataSeries:X,point:{x:it+(J-it)/2,y:u.axisY.reversed?o:c},direction:1,bounds:{x1:it,y1:Math.min(o,c),x2:J,y2:Math.max(o,c)},color:k})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),x.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderRangeColumn=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,y,x=null,w=this.plotArea,f=0;f=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,D=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.03*this.width;var c=u.axisX.dataInfo.minDiff;isFinite(c)||(c=.3*Math.abs(u.axisX.range)),c=this.options.dataPointWidth?this.dataPointWidth:w.width*(u.axisX.logarithmic?Math.log(c)/Math.log(u.axisX.range):Math.abs(c)/Math.abs(u.axisX.range))/u.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&f>D&&(f=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,D)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&D<f&&(D=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,f)),c<f&&(c=f),c>D&&(c=D),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip());for(var d=0;d<u.dataSeriesIndexes.length;d++){var M=u.dataSeriesIndexes[d],k=this.data[M],C=k.dataPoints;if(0<C.length){var R=!!(5<c&&k.bevelEnabled);for(f=0;f<C.length;f++)if(!((y=C[f].getTime?C[f].x.getTime():C[f].x)<u.axisX.dataInfo.viewPortMin||y>u.axisX.dataInfo.viewPortMax)&&!$t(C[f].y)&&C[f].y.length&&"number"==typeof C[f].y[0]&&"number"==typeof C[f].y[1]){x=u.axisX.convertValueToPixel(y),D=u.axisY.convertValueToPixel(C[f].y[0]),o=u.axisY.convertValueToPixel(C[f].y[1]);var B=u.axisX.reversed?x+u.plotType.totalDataSeries*c/2-(u.previousDataSeriesCount+d)*c<<0:x-u.plotType.totalDataSeries*c/2+(u.previousDataSeriesCount+d)*c<<0,O=u.axisX.reversed?B-c<<0:B+c<<0;if(x=C[f].color?C[f].color:k._colorSet[f%k._colorSet.length],D>o){var L=D;D=o,o=L}this._eventManager.objectMap[L=k.dataPointIds[f]]={id:L,objectType:"dataPoint",dataSeriesIndex:M,dataPointIndex:f,x1:B,y1:D,x2:O,y2:o},ps(g,u.axisX.reversed?O:B,D,u.axisX.reversed?B:O,o,x,0,x,R,R,!1,!1,k.fillOpacity),x=bi(L),oe&&ps(this._eventManager.ghostCtx,u.axisX.reversed?O:B,D,u.axisX.reversed?B:O,o,x,0,null,!1,!1,!1,!1),(C[f].indexLabel||k.indexLabel||C[f].indexLabelFormatter||k.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeColumn",dataPoint:C[f],dataSeries:k,indexKeyword:0,point:{x:B+(O-B)/2,y:C[f].y[1]>=C[f].y[0]?o:D},direction:C[f].y[1]>=C[f].y[0]?-1:1,bounds:{x1:B,y1:Math.min(D,o),x2:O,y2:Math.max(D,o)},color:x}),this._indexLabels.push({chartType:"rangeColumn",dataPoint:C[f],dataSeries:k,indexKeyword:1,point:{x:B+(O-B)/2,y:C[f].y[1]>=C[f].y[0]?D:o},direction:C[f].y[1]>=C[f].y[0]?1:-1,bounds:{x1:B,y1:Math.min(D,o),x2:O,y2:Math.max(D,o)},color:x}))}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderError=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I,x=!!u.axisY._position&&!("left"===u.axisY._position||"right"===u.axisY._position);if(!(0>=u.dataSeriesIndexes.length)){var f,c,d,M,k,C,R,w=null,D=!1,o=this.plotArea,y=0,B=u.axisX.dataInfo.minDiff;isFinite(B)||(B=.3*Math.abs(u.axisX.range)),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(o.x1,o.y1,o.width,o.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(o.x1,o.y1,o.width,o.height),this._eventManager.ghostCtx.clip());for(var O=0,L=0;L<this.data.length;L++)!this.data[L].type.match(/(bar|column)/gi)||!this.data[L].visible||this.data[L].type.match(/(stacked)/gi)&&O||O++;for(var X=0;X<u.dataSeriesIndexes.length;X++){var E=u.dataSeriesIndexes[X],Y=this.data[E],it=Y.dataPoints,J=!$t(Y._linkedSeries)&&!(!Y._linkedSeries.type.match(/(bar|column)/gi)||!Y._linkedSeries.visible),q=0;if(J)for(w=Y._linkedSeries.id,L=0;L<w;L++)!this.data[L].type.match(/(bar|column)/gi)||!this.data[L].visible||this.data[L].type.match(/(stacked)/gi)&&q||(this.data[L].type.match(/(range)/gi)&&(D=!0),q++);if(w=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,y=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:x?Math.min(.15*this.height,this.plotArea.height/(J?O:1)*.9)<<0:.3*this.width,D&&(y=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:x?Math.min(.15*this.height,this.plotArea.height/(J?O:1)*.9)<<0:.03*this.width),L=this.options.dataPointWidth?this.dataPointWidth:(x?o.height:o.width)*(u.axisX.logarithmic?Math.log(B)/Math.log(u.axisX.range):Math.abs(B)/Math.abs(u.axisX.range))/(J?O:1)*.9<<0,this.dataPointMaxWidth&&w>y&&(w=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,y)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&y<w&&(y=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,w)),L<w&&(L=w),L>y&&(L=y),0<it.length){var nt=Y._colorSet;for(y=0;y<it.length;y++){w=Y.lineColor=Y.options.color?Y.options.color:nt[0];var dt={color:it[y].whiskerColor?it[y].whiskerColor:it[y].color?Y.whiskerColor?Y.whiskerColor:it[y].color:Y.whiskerColor?Y.whiskerColor:w,thickness:$t(it[y].whiskerThickness)?Y.whiskerThickness:it[y].whiskerThickness,dashType:it[y].whiskerDashType?it[y].whiskerDashType:Y.whiskerDashType,length:$t(it[y].whiskerLength)?$t(Y.options.whiskerLength)?L:Y.options.whiskerLength:it[y].whiskerLength,trimLength:$t(it[y].whiskerLength)&&$t(Y.options.whiskerLength)?50:0};dt.length="number"==typeof dt.length?0>=dt.length?0:dt.length>=L?L:dt.length:"string"==typeof dt.length?parseInt(dt.length)*L/100>L?L:parseInt(dt.length)*L/100>L:L,dt.thickness="number"==typeof dt.thickness?0>dt.thickness?0:Math.round(dt.thickness):2;var gt={color:it[y].stemColor?it[y].stemColor:it[y].color?Y.stemColor?Y.stemColor:it[y].color:Y.stemColor?Y.stemColor:w,thickness:it[y].stemThickness?it[y].stemThickness:Y.stemThickness,dashType:it[y].stemDashType?it[y].stemDashType:Y.stemDashType};if(gt.thickness="number"==typeof gt.thickness?0>gt.thickness?0:Math.round(gt.thickness):2,!((R=it[y].getTime?it[y].x.getTime():it[y].x)<u.axisX.dataInfo.viewPortMin||R>u.axisX.dataInfo.viewPortMax)&&!$t(it[y].y)&&it[y].y.length&&"number"==typeof it[y].y[0]&&"number"==typeof it[y].y[1]){var kt=u.axisX.convertValueToPixel(R);x?c=kt:f=kt,kt=u.axisY.convertValueToPixel(it[y].y[0]),x?d=kt:k=kt,kt=u.axisY.convertValueToPixel(it[y].y[1]),x?M=kt:C=kt,x?(k=u.axisX.reversed?c+(J?O:1)*L/2-(J?q-1:0)*L<<0:c-(J?O:1)*L/2+(J?q-1:0)*L<<0,C=u.axisX.reversed?k-L<<0:k+L<<0):(d=u.axisX.reversed?f+(J?O:1)*L/2-(J?q-1:0)*L<<0:f-(J?O:1)*L/2+(J?q-1:0)*L<<0,M=u.axisX.reversed?d-L<<0:d+L<<0),!x&&k>C&&(kt=k,k=C,C=kt),x&&d>M&&(kt=d,d=M,M=kt),this._eventManager.objectMap[kt=Y.dataPointIds[y]]={id:kt,objectType:"dataPoint",dataSeriesIndex:E,dataPointIndex:y,x1:Math.min(d,M),y1:Math.min(k,C),x2:Math.max(M,d),y2:Math.max(C,k),isXYSwapped:x,stemProperties:gt,whiskerProperties:dt},Le(g,Math.min(d,M),Math.min(k,C),Math.max(M,d),Math.max(C,k),w,dt,gt,x),oe&&Le(this._eventManager.ghostCtx,d,k,M,C,w,dt,gt,x),(it[y].indexLabel||Y.indexLabel||it[y].indexLabelFormatter||Y.indexLabelFormatter)&&(this._indexLabels.push({chartType:"error",dataPoint:it[y],dataSeries:Y,indexKeyword:0,point:{x:x?it[y].y[1]>=it[y].y[0]?d:M:d+(M-d)/2,y:x?k+(C-k)/2:it[y].y[1]>=it[y].y[0]?C:k},direction:it[y].y[1]>=it[y].y[0]?-1:1,bounds:{x1:x?Math.min(d,M):d,y1:x?k:Math.min(k,C),x2:x?Math.max(d,M):M,y2:x?C:Math.max(k,C)},color:w,axisSwapped:x}),this._indexLabels.push({chartType:"error",dataPoint:it[y],dataSeries:Y,indexKeyword:1,point:{x:x?it[y].y[1]>=it[y].y[0]?M:d:d+(M-d)/2,y:x?k+(C-k)/2:it[y].y[1]>=it[y].y[0]?k:C},direction:it[y].y[1]>=it[y].y[0]?1:-1,bounds:{x1:x?Math.min(d,M):d,y1:x?k:Math.min(k,C),x2:x?Math.max(d,M):M,y2:x?C:Math.max(k,C)},color:w,axisSwapped:x}))}}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(o.x1,o.y1,o.width,o.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderRangeBar=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var D,o,y,f,x=null,w=this.plotArea,c=0;c=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,D=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.height,this.plotArea.height/u.plotType.totalDataSeries*.9)<<0;var d=u.axisX.dataInfo.minDiff;isFinite(d)||(d=.3*Math.abs(u.axisX.range)),d=this.options.dataPointWidth?this.dataPointWidth:w.height*(u.axisX.logarithmic?Math.log(d)/Math.log(u.axisX.range):Math.abs(d)/Math.abs(u.axisX.range))/u.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&c>D&&(c=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,D)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&D<c&&(D=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,c)),d<c&&(d=c),d>D&&(d=D),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(w.x1,w.y1,w.width,w.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.clip());for(var M=0;M<u.dataSeriesIndexes.length;M++){var k=u.dataSeriesIndexes[M],C=this.data[k],R=C.dataPoints;if(0<R.length){var B=!!(5<d&&C.bevelEnabled);for(g.strokeStyle="#4572A7 ",c=0;c<R.length;c++)if(!((f=R[c].getTime?R[c].x.getTime():R[c].x)<u.axisX.dataInfo.viewPortMin||f>u.axisX.dataInfo.viewPortMax)&&!$t(R[c].y)&&R[c].y.length&&"number"==typeof R[c].y[0]&&"number"==typeof R[c].y[1]){D=u.axisY.convertValueToPixel(R[c].y[0]),o=u.axisY.convertValueToPixel(R[c].y[1]),y=u.axisX.convertValueToPixel(f),y=u.axisX.reversed?y+u.plotType.totalDataSeries*d/2-(u.previousDataSeriesCount+M)*d<<0:y-u.plotType.totalDataSeries*d/2+(u.previousDataSeriesCount+M)*d<<0;var O=u.axisX.reversed?y-d<<0:y+d<<0;D>o&&(x=D,D=o,o=x),ps(g,D,u.axisX.reversed?O:y,o,u.axisX.reversed?y:O,x=R[c].color?R[c].color:C._colorSet[c%C._colorSet.length],0,null,B,!1,!1,!1,C.fillOpacity),this._eventManager.objectMap[x=C.dataPointIds[c]]={id:x,objectType:"dataPoint",dataSeriesIndex:k,dataPointIndex:c,x1:D,y1:y,x2:o,y2:O},x=bi(x),oe&&ps(this._eventManager.ghostCtx,D,u.axisX.reversed?O:y,o,u.axisX.reversed?y:O,x,0,null,!1,!1,!1,!1),(R[c].indexLabel||C.indexLabel||R[c].indexLabelFormatter||C.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeBar",dataPoint:R[c],dataSeries:C,indexKeyword:0,point:{x:R[c].y[1]>=R[c].y[0]?D:o,y:y+(O-y)/2},direction:R[c].y[1]>=R[c].y[0]?-1:1,bounds:{x1:Math.min(D,o),y1:y,x2:Math.max(D,o),y2:O},color:x}),this._indexLabels.push({chartType:"rangeBar",dataPoint:R[c],dataSeries:C,indexKeyword:1,point:{x:R[c].y[1]>=R[c].y[0]?o:D,y:y+(O-y)/2},direction:R[c].y[1]>=R[c].y[0]?1:-1,bounds:{x1:Math.min(D,o),y1:y,x2:Math.max(D,o),y2:O},color:x}))}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(w.x1,w.y1,w.width,w.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}},Ct.prototype.renderRangeArea=function(u){function I(){if(X){for(var mt=null,Tt=f.length-1;0<=Tt;Tt--)x.lineTo((mt=f[Tt]).x,mt.y2),w.lineTo(mt.x,mt.y2);if(x.closePath(),x.globalAlpha=d.fillOpacity,x.fill(),x.globalAlpha=1,w.fill(),0<d.lineThickness){for(x.beginPath(),x.moveTo(mt.x,mt.y2),Tt=0;Tt<f.length;Tt++)x.lineTo((mt=f[Tt]).x,mt.y2);for(x.moveTo(f[0].x,f[0].y1),Tt=0;Tt<f.length;Tt++)x.lineTo((mt=f[Tt]).x,mt.y1);x.stroke()}x.beginPath(),x.moveTo(R,B),w.beginPath(),w.moveTo(R,B),X={x:R,y:B},(f=[]).push({x:R,y1:B,y2:O})}}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var w=this._eventManager.ghostCtx,D=[],o=this.plotArea;x.save(),oe&&w.save(),x.beginPath(),x.rect(o.x1,o.y1,o.width,o.height),x.clip(),oe&&(w.beginPath(),w.rect(o.x1,o.y1,o.width,o.height),w.clip());for(var y=0;y<u.dataSeriesIndexes.length;y++){var f=[],c=u.dataSeriesIndexes[y],d=this.data[c],M=d.dataPoints;this._eventManager.objectMap[D=d.id]={objectType:"dataSeries",dataSeriesIndex:c},D=bi(D),w.fillStyle=D,D=[];var R,B,O,L,k=!0,C=0,X=null;if(0<M.length){var E=d._colorSet[C%d._colorSet.length],Y=d.lineColor=d.options.lineColor||E,it=Y;x.fillStyle=E,x.strokeStyle=Y,x.lineWidth=d.lineThickness;var J="solid";if(x.setLineDash){var q=tn(d.nullDataLineDashType,d.lineThickness),nt=tn(J=d.lineDashType,d.lineThickness);x.setLineDash(nt)}for(var dt=!0;C<M.length;C++)if(!((L=M[C].x.getTime?M[C].x.getTime():M[C].x)<u.axisX.dataInfo.viewPortMin||L>u.axisX.dataInfo.viewPortMax&&(!d.connectNullData||!dt)))if(null!==M[C].y&&M[C].y.length&&"number"==typeof M[C].y[0]&&"number"==typeof M[C].y[1]){if(R=u.axisX.convertValueToPixel(L),B=u.axisY.convertValueToPixel(M[C].y[0]),O=u.axisY.convertValueToPixel(M[C].y[1]),k||dt?(d.connectNullData&&!k?(x.setLineDash&&(d.options.nullDataLineDashType||J===d.lineDashType&&d.lineDashType!==d.nullDataLineDashType)&&(f[f.length-1].newLineDashArray=nt,J=d.nullDataLineDashType,x.setLineDash(q)),x.lineTo(R,B),oe&&w.lineTo(R,B),f.push({x:R,y1:B,y2:O})):(x.beginPath(),x.moveTo(R,B),X={x:R,y:B},(f=[]).push({x:R,y1:B,y2:O}),oe&&(w.beginPath(),w.moveTo(R,B))),dt=k=!1):(x.lineTo(R,B),f.push({x:R,y1:B,y2:O}),oe&&w.lineTo(R,B),C%250==0&&I()),this._eventManager.objectMap[L=d.dataPointIds[C]]={id:L,objectType:"dataPoint",dataSeriesIndex:c,dataPointIndex:C,x1:R,y1:B,y2:O},C<M.length-1&&(it!==(M[C].lineColor||Y)||J!==(M[C].lineDashType||d.lineDashType))&&(I(),f[f.length-1].newStrokeStyle=it=M[C].lineColor||Y,x.strokeStyle=it,x.setLineDash&&(M[C].lineDashType?(f[f.length-1].newLineDashArray=tn(J=M[C].lineDashType,d.lineThickness),x.setLineDash(f[f.length-1].newLineDashArray)):(J=d.lineDashType,f[f.length-1].newLineDashArray=nt,x.setLineDash(nt)))),0!==M[C].markerSize&&(0<M[C].markerSize||0<d.markerSize)){var gt=d.getMarkerProperties(C,R,O,x);D.push(gt);var kt=bi(L);oe&&D.push({x:R,y:O,ctx:w,type:gt.type,size:gt.size,color:kt,borderColor:kt,borderThickness:gt.borderThickness}),gt=d.getMarkerProperties(C,R,B,x),D.push(gt),kt=bi(L),oe&&D.push({x:R,y:B,ctx:w,type:gt.type,size:gt.size,color:kt,borderColor:kt,borderThickness:gt.borderThickness})}(M[C].indexLabel||d.indexLabel||M[C].indexLabelFormatter||d.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeArea",dataPoint:M[C],dataSeries:d,indexKeyword:0,point:{x:R,y:B},direction:M[C].y[0]>M[C].y[1]===u.axisY.reversed?-1:1,color:E}),this._indexLabels.push({chartType:"rangeArea",dataPoint:M[C],dataSeries:d,indexKeyword:1,point:{x:R,y:O},direction:M[C].y[0]>M[C].y[1]===u.axisY.reversed?1:-1,color:E}))}else dt||k||I(),dt=!0;I(),ie.drawMarkers(D)}}return oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(o.x1,o.y1,o.width,o.height),this._eventManager.ghostCtx.restore()),x.restore(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderRangeSplineArea=function(u){function I(gt,kt){var mt=Vt(B,2);if(0<mt.length){if(0<c.lineThickness){x.strokeStyle=kt,x.setLineDash&&x.setLineDash(gt),x.beginPath(),x.moveTo(mt[0].x,mt[0].y);for(var Tt=0;Tt<mt.length-3;Tt+=3)(mt[Tt].newStrokeStyle||mt[Tt].newLineDashArray)&&(x.stroke(),x.beginPath(),x.moveTo(mt[Tt].x,mt[Tt].y),mt[Tt].newStrokeStyle&&(x.strokeStyle=mt[Tt].newStrokeStyle),mt[Tt].newLineDashArray&&x.setLineDash(mt[Tt].newLineDashArray)),x.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y)}for(x.beginPath(),x.moveTo(mt[0].x,mt[0].y),oe&&(w.beginPath(),w.moveTo(mt[0].x,mt[0].y)),Tt=0;Tt<mt.length-3;Tt+=3)x.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y),oe&&w.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y);for(mt=Vt(O,2),x.lineTo(O[O.length-1].x,O[O.length-1].y),Tt=mt.length-1;2<Tt;Tt-=3)x.bezierCurveTo(mt[Tt-1].x,mt[Tt-1].y,mt[Tt-2].x,mt[Tt-2].y,mt[Tt-3].x,mt[Tt-3].y),oe&&w.bezierCurveTo(mt[Tt-1].x,mt[Tt-1].y,mt[Tt-2].x,mt[Tt-2].y,mt[Tt-3].x,mt[Tt-3].y);if(x.closePath(),x.globalAlpha=c.fillOpacity,x.fill(),oe&&(w.closePath(),w.fill()),x.globalAlpha=1,0<c.lineThickness){x.strokeStyle=kt,x.setLineDash&&x.setLineDash(gt),x.beginPath(),x.moveTo(mt[0].x,mt[0].y);for(var ee=Tt=0;Tt<mt.length-3;Tt+=3,ee++)(B[ee].newStrokeStyle||B[ee].newLineDashArray)&&(x.stroke(),x.beginPath(),x.moveTo(mt[Tt].x,mt[Tt].y),B[ee].newStrokeStyle&&(x.strokeStyle=B[ee].newStrokeStyle),B[ee].newLineDashArray&&x.setLineDash(B[ee].newLineDashArray)),x.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y);for(mt=Vt(B,2),x.moveTo(mt[0].x,mt[0].y),ee=Tt=0;Tt<mt.length-3;Tt+=3,ee++)(B[ee].newStrokeStyle||B[ee].newLineDashArray)&&(x.stroke(),x.beginPath(),x.moveTo(mt[Tt].x,mt[Tt].y),B[ee].newStrokeStyle&&(x.strokeStyle=B[ee].newStrokeStyle),B[ee].newLineDashArray&&x.setLineDash(B[ee].newLineDashArray)),x.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y);x.stroke()}x.beginPath()}}var g=u.targetCanvasCtx||this.plotArea.ctx,x=oe?this._preRenderCtx:g;if(!(0>=u.dataSeriesIndexes.length)){var w=this._eventManager.ghostCtx,D=[],o=this.plotArea;x.save(),oe&&w.save(),x.beginPath(),x.rect(o.x1,o.y1,o.width,o.height),x.clip(),oe&&(w.beginPath(),w.rect(o.x1,o.y1,o.width,o.height),w.clip());for(var y=0;y<u.dataSeriesIndexes.length;y++){var f=u.dataSeriesIndexes[y],c=this.data[f],d=c.dataPoints;this._eventManager.objectMap[D=c.id]={objectType:"dataSeries",dataSeriesIndex:f},D=bi(D),w.fillStyle=D,D=[];var k,C,R,M=0,B=[],O=[];if(0<d.length){var L=c._colorSet[M%c._colorSet.length],X=c.lineColor=c.options.lineColor||L,E=X;x.fillStyle=L,x.lineWidth=c.lineThickness;var it,Y="solid";if(x.setLineDash){var J=tn(c.nullDataLineDashType,c.lineThickness);it=tn(Y=c.lineDashType,c.lineThickness)}for(C=!1;M<d.length;M++)if(!((k=d[M].x.getTime?d[M].x.getTime():d[M].x)<u.axisX.dataInfo.viewPortMin||k>u.axisX.dataInfo.viewPortMax&&(!c.connectNullData||!C)))if(null!==d[M].y&&d[M].y.length&&"number"==typeof d[M].y[0]&&"number"==typeof d[M].y[1]){k=u.axisX.convertValueToPixel(k),C=u.axisY.convertValueToPixel(d[M].y[0]),R=u.axisY.convertValueToPixel(d[M].y[1]);var q=c.dataPointIds[M];if(this._eventManager.objectMap[q]={id:q,objectType:"dataPoint",dataSeriesIndex:f,dataPointIndex:M,x1:k,y1:C,y2:R},B[B.length]={x:k,y:C},O[O.length]={x:k,y:R},M<d.length-1&&(E!==(d[M].lineColor||X)||Y!==(d[M].lineDashType||c.lineDashType))&&(B[B.length-1].newStrokeStyle=E=d[M].lineColor||X,x.setLineDash&&(d[M].lineDashType?B[B.length-1].newLineDashArray=tn(Y=d[M].lineDashType,c.lineThickness):(Y=c.lineDashType,B[B.length-1].newLineDashArray=it))),0!==d[M].markerSize&&(0<d[M].markerSize||0<c.markerSize)){var nt=c.getMarkerProperties(M,k,C,x);D.push(nt);var dt=bi(q);oe&&D.push({x:k,y:C,ctx:w,type:nt.type,size:nt.size,color:dt,borderColor:dt,borderThickness:nt.borderThickness}),nt=c.getMarkerProperties(M,k,R,x),D.push(nt),dt=bi(q),oe&&D.push({x:k,y:R,ctx:w,type:nt.type,size:nt.size,color:dt,borderColor:dt,borderThickness:nt.borderThickness})}(d[M].indexLabel||c.indexLabel||d[M].indexLabelFormatter||c.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeSplineArea",dataPoint:d[M],dataSeries:c,indexKeyword:0,point:{x:k,y:C},direction:d[M].y[0]<=d[M].y[1]?-1:1,color:L}),this._indexLabels.push({chartType:"rangeSplineArea",dataPoint:d[M],dataSeries:c,indexKeyword:1,point:{x:k,y:R},direction:d[M].y[0]<=d[M].y[1]?1:-1,color:L})),C=!1}else 0<M&&!C&&(c.connectNullData?x.setLineDash&&0<B.length&&(c.options.nullDataLineDashType||!d[M-1].lineDashType)&&(B[B.length-1].newLineDashArray=J,Y=c.nullDataLineDashType):(I(it,X),B=[],O=[])),C=!0;I(it,X),ie.drawMarkers(D)}}return oe&&(g.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&x.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&x.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),x.clearRect(o.x1,o.y1,o.width,o.height),this._eventManager.ghostCtx.restore()),x.restore(),{source:g,dest:this.plotArea.ctx,animationCallback:te.xClipAnimation,easingFunction:te.easing.linear,animationBase:0}}},Ct.prototype.renderWaterfall=function(u){var I=u.targetCanvasCtx||this.plotArea.ctx,g=oe?this._preRenderCtx:I;if(!(0>=u.dataSeriesIndexes.length)){var o,y,f,c,x=this._eventManager.ghostCtx,w=null,D=this.plotArea,M=0,d=u.axisY.convertValueToPixel(u.axisY.logarithmic?u.axisY.viewportMinimum:0);M=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,y=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.width,this.plotArea.width/u.plotType.totalDataSeries*.9)<<0;var k=u.axisX.dataInfo.minDiff;isFinite(k)||(k=.3*Math.abs(u.axisX.range)),k=this.options.dataPointWidth?this.dataPointWidth:D.width*(u.axisX.logarithmic?Math.log(k)/Math.log(u.axisX.range):Math.abs(k)/Math.abs(u.axisX.range))/u.plotType.totalDataSeries*.6<<0,this.dataPointMaxWidth&&M>y&&(M=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,y)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&y<M&&(y=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,M)),k<M&&(k=M),k>y&&(k=y),g.save(),oe&&this._eventManager.ghostCtx.save(),g.beginPath(),g.rect(D.x1,D.y1,D.width,D.height),g.clip(),oe&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(D.x1,D.y1,D.width,D.height),this._eventManager.ghostCtx.clip());for(var C=0;C<u.dataSeriesIndexes.length;C++){var R=u.dataSeriesIndexes[C],B=this.data[R],O=B.dataPoints;w=B._colorSet[0],B.risingColor=B.options.risingColor?B.options.risingColor:w,B.fallingColor=B.options.fallingColor?B.options.fallingColor:"#e40a0a";var L="number"==typeof B.options.lineThickness?Math.round(B.lineThickness):1,X=Math.round(L)%2==1?-.5:0;if(0<O.length){var E=!!(5<k&&B.bevelEnabled),Y=!1,it=null,J=null;for(M=0;M<O.length;M++)if(c=O[M].getTime?O[M].x.getTime():O[M].x,"number"!=typeof O[M].y){if(0<M&&!Y&&B.connectNullData)var q=B.options.nullDataLineDashType||!O[M-1].lineDashType?B.nullDataLineDashType:O[M-1].lineDashType;Y=!0}else{o=u.axisX.convertValueToPixel(c),y=0===B.dataPointEOs[M].cumulativeSum?d:u.axisY.convertValueToPixel(B.dataPointEOs[M].cumulativeSum),f=0===B.dataPointEOs[M].cumulativeSumYStartValue?d:u.axisY.convertValueToPixel(B.dataPointEOs[M].cumulativeSumYStartValue),o=u.axisX.reversed?o+u.plotType.totalDataSeries*k/2-(u.previousDataSeriesCount+C)*k<<0:o-u.plotType.totalDataSeries*k/2+(u.previousDataSeriesCount+C)*k<<0;var nt=u.axisX.reversed?o-k<<0:o+k<<0;y>f&&(w=y,y=f,f=w),u.axisY.reversed&&(w=y,y=f,f=w),this._eventManager.objectMap[w=B.dataPointIds[M]]={id:w,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:M,x1:o,y1:y,x2:nt,y2:f},ps(g,u.axisX.reversed?nt:o,u.axisY.reversed?f:y,u.axisX.reversed?o:nt,u.axisY.reversed?y:f,gt=O[M].color?O[M].color:0<O[M].y?B.risingColor:B.fallingColor,0,gt,E,E,!1,!1,B.fillOpacity),w=bi(w),oe&&ps(this._eventManager.ghostCtx,u.axisX.reversed?nt:o,y,u.axisX.reversed?o:nt,f,w,0,null,!1,!1,!1,!1);var dt,gt=o;dt=typeof O[M].isIntermediateSum<"u"&&!0===O[M].isIntermediateSum||typeof O[M].isCumulativeSum<"u"&&!0===O[M].isCumulativeSum?0<O[M].y?y:f:0<O[M].y?f:y,0<M&&it&&(!Y||B.connectNullData)&&(Y&&g.setLineDash&&g.setLineDash(tn(q,L)),g.beginPath(),g.moveTo(it,J-X),g.lineTo(gt,dt-X),0<L&&g.stroke(),oe&&(x.beginPath(),x.moveTo(it,J-X),x.lineTo(gt,dt-X),0<L&&x.stroke())),Y=!1,it=nt,J=0<O[M].y?y:f,gt=O[M].lineDashType?O[M].lineDashType:B.options.lineDashType?B.options.lineDashType:"shortDash",g.strokeStyle=O[M].lineColor?O[M].lineColor:B.options.lineColor?B.options.lineColor:"#9e9e9e",g.lineWidth=L,g.setLineDash&&(gt=tn(gt,L),g.setLineDash(gt)),(O[M].indexLabel||B.indexLabel||O[M].indexLabelFormatter||B.indexLabelFormatter)&&this._indexLabels.push({chartType:"waterfall",dataPoint:O[M],dataSeries:B,point:{x:o+(nt-o)/2,y:0<=O[M].y?y:f},direction:0>O[M].y===u.axisY.reversed?1:-1,bounds:{x1:o,y1:Math.min(y,f),x2:nt,y2:Math.max(y,f)},color:w})}}}return oe&&(I.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.globalCompositeOperation="source-atop",u.axisX.maskCanvas&&g.drawImage(u.axisX.maskCanvas,0,0,this.width,this.height),u.axisY.maskCanvas&&g.drawImage(u.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),g.clearRect(D.x1,D.y1,D.width,D.height),this._eventManager.ghostCtx.restore()),g.restore(),{source:I,dest:this.plotArea.ctx,animationCallback:te.fadeInAnimation,easingFunction:te.easing.easeInQuad,animationBase:0}}};var Gt=function(u,I,g,x,w,D,o,y,f){if(!(0>g)){if(typeof y>"u"&&(y=1),!oe){var c=Number((o%(2*Math.PI)).toFixed(8));Number((D%(2*Math.PI)).toFixed(8))===c&&(o-=1e-4)}u.save(),u.globalAlpha=y,"pie"===w?(u.beginPath(),u.moveTo(I.x,I.y),u.arc(I.x,I.y,g,D,o,!1),u.fillStyle=x,u.strokeStyle="white",u.lineWidth=2,u.closePath(),u.fill()):"doughnut"===w&&(u.beginPath(),u.arc(I.x,I.y,g,D,o,!1),0<=f&&u.arc(I.x,I.y,f*g,o,D,!0),u.closePath(),u.fillStyle=x,u.strokeStyle="white",u.lineWidth=2,u.fill()),u.globalAlpha=1,u.restore()}};Ct.prototype.renderPie=function(u){function g(dt){var gt=f.plotArea.ctx;for(gt.clearRect(k.x1,k.y1,k.width,k.height),gt.fillStyle=f.backgroundColor,gt.fillRect(k.x1,k.y1,k.width,k.height),gt=0;gt<d.length;gt++){var kt=C[gt].startAngle,mt=C[gt].endAngle;if(mt>kt){var Tt=.07*J*Math.cos(C[gt].midAngle),ee=.07*J*Math.sin(C[gt].midAngle),Ft=!1;d[gt].exploded?(1e-9<Math.abs(C[gt].center.x-(E.x+Tt))||1e-9<Math.abs(C[gt].center.y-(E.y+ee)))&&(C[gt].center.x=E.x+Tt*dt,C[gt].center.y=E.y+ee*dt,Ft=!0):(0<Math.abs(C[gt].center.x-E.x)||0<Math.abs(C[gt].center.y-E.y))&&(C[gt].center.x=E.x+Tt*(1-dt),C[gt].center.y=E.y+ee*(1-dt),Ft=!0),Ft&&((Tt={}).dataSeries=c,Tt.dataPoint=c.dataPoints[gt],Tt.index=gt,f.toolTip.highlightObjects([Tt])),Gt(f.plotArea.ctx,C[gt].center,C[gt].radius,d[gt].color?d[gt].color:c._colorSet[gt%c._colorSet.length],c.type,kt,mt,c.fillOpacity,C[gt].percentInnerRadius)}}for((dt=f.plotArea.ctx).save(),dt.fillStyle="black",dt.strokeStyle="grey",dt.textBaseline="middle",dt.lineJoin="round",gt=gt=0;gt<d.length;gt++)(kt=C[gt]).indexLabelText&&(kt.indexLabelTextBlock.y-=kt.indexLabelTextBlock.height/2,mt=0,kt.indexLabelTextBlock.x+=mt="left"===kt.hemisphere?"inside"!==c.indexLabelPlacement?-(kt.indexLabelTextBlock.width+M):-kt.indexLabelTextBlock.width/2:"inside"!==c.indexLabelPlacement?M:-kt.indexLabelTextBlock.width/2,kt.indexLabelTextBlock.render(!0),kt.indexLabelTextBlock.x-=mt,kt.indexLabelTextBlock.y+=kt.indexLabelTextBlock.height/2,"inside"!==kt.indexLabelPlacement&&0<kt.indexLabelLineThickness&&(mt=kt.center.x+J*Math.cos(kt.midAngle),Tt=kt.center.y+J*Math.sin(kt.midAngle),dt.strokeStyle=kt.indexLabelLineColor,dt.lineWidth=kt.indexLabelLineThickness,dt.setLineDash&&dt.setLineDash(tn(kt.indexLabelLineDashType,kt.indexLabelLineThickness)),dt.beginPath(),dt.moveTo(mt,Tt),dt.lineTo(kt.indexLabelTextBlock.x,kt.indexLabelTextBlock.y),dt.lineTo(kt.indexLabelTextBlock.x+("left"===kt.hemisphere?-M:M),kt.indexLabelTextBlock.y),dt.stroke()),dt.lineJoin="miter");dt.save()}function x(dt,gt){return gt.indexLabelTextBlock.y>dt.indexLabelTextBlock.y?gt.indexLabelTextBlock.y-gt.indexLabelTextBlock.height/2-(dt.indexLabelTextBlock.y+dt.indexLabelTextBlock.height/2):dt.indexLabelTextBlock.y-dt.indexLabelTextBlock.height/2-(gt.indexLabelTextBlock.y+gt.indexLabelTextBlock.height/2)}function w(dt){for(var gt=null,kt=1;kt<d.length;kt++){if(C[gt=(dt+kt+C.length)%C.length].hemisphere!==C[dt].hemisphere){gt=null;break}if(C[gt].indexLabelText&&gt!==dt&&(0>x(C[gt],C[dt])||("right"===C[dt].hemisphere?C[gt].indexLabelTextBlock.y>=C[dt].indexLabelTextBlock.y:C[gt].indexLabelTextBlock.y<=C[dt].indexLabelTextBlock.y)))break;gt=null}return gt}function D(dt,gt,kt){if(1e3<(kt=(kt||0)+1))return 0;gt=gt||0;var mt=0,Tt=E.y-1*B,ee=E.y+1*B;if(0<=dt&&dt<d.length){var Ft=C[dt];if(0>gt&&Ft.indexLabelTextBlock.y<Tt||0<gt&&Ft.indexLabelTextBlock.y>ee)return 0;var vt=0,le=0;for(le=vt=vt=0,0>gt?Ft.indexLabelTextBlock.y-Ft.indexLabelTextBlock.height/2>Tt&&Ft.indexLabelTextBlock.y-Ft.indexLabelTextBlock.height/2+gt<Tt&&(gt=-(Tt-(Ft.indexLabelTextBlock.y-Ft.indexLabelTextBlock.height/2+gt))):Ft.indexLabelTextBlock.y+Ft.indexLabelTextBlock.height/2<Tt&&Ft.indexLabelTextBlock.y+Ft.indexLabelTextBlock.height/2+gt>ee&&(gt=Ft.indexLabelTextBlock.y+Ft.indexLabelTextBlock.height/2+gt-ee),gt=Ft.indexLabelTextBlock.y+gt,Tt=0,Tt="right"===Ft.hemisphere?E.x+Math.sqrt(Math.pow(B,2)-Math.pow(gt-E.y,2)):E.x-Math.sqrt(Math.pow(B,2)-Math.pow(gt-E.y,2)),le=E.x+J*Math.cos(Ft.midAngle),vt=E.y+J*Math.sin(Ft.midAngle),vt=Math.sqrt(Math.pow(Tt-le,2)+Math.pow(gt-vt,2)),le=Math.acos(J/B),gt=(vt=Math.acos((B*B+J*J-vt*vt)/(2*J*B)))<le?gt-Ft.indexLabelTextBlock.y:0,Tt=null,ee=1;ee<d.length;ee++){if(C[Tt=(dt-ee+C.length)%C.length].hemisphere!==C[dt].hemisphere){Tt=null;break}if(C[Tt].indexLabelText&&C[Tt].hemisphere===C[dt].hemisphere&&Tt!==dt&&(0>x(C[Tt],C[dt])||("right"===C[dt].hemisphere?C[Tt].indexLabelTextBlock.y<=C[dt].indexLabelTextBlock.y:C[Tt].indexLabelTextBlock.y>=C[dt].indexLabelTextBlock.y)))break;Tt=null}le=Tt,vt=w(dt),ee=Tt=0,0>gt?(mt=gt,null!==(ee="right"===Ft.hemisphere?le:vt)&&(le=-gt,(gt=Ft.indexLabelTextBlock.y-Ft.indexLabelTextBlock.height/2-(C[ee].indexLabelTextBlock.y+C[ee].indexLabelTextBlock.height/2))-le<R&&+(ee=D(ee,Tt=-le,kt+1)).toFixed(X)>+Tt.toFixed(X)&&(mt=gt>R?-(gt-R):-(le-(ee-Tt))))):0<gt&&(mt=gt,null!==(ee="right"===Ft.hemisphere?vt:le)&&(le=gt,(gt=C[ee].indexLabelTextBlock.y-C[ee].indexLabelTextBlock.height/2-(Ft.indexLabelTextBlock.y+Ft.indexLabelTextBlock.height/2))-le<R&&+(ee=D(ee,Tt=le,kt+1)).toFixed(X)<+Tt.toFixed(X)&&(mt=gt>R?gt-R:le-(Tt-ee)))),mt&&(kt=Ft.indexLabelTextBlock.y+mt,gt=0,gt="right"===Ft.hemisphere?E.x+Math.sqrt(Math.pow(B,2)-Math.pow(kt-E.y,2)):E.x-Math.sqrt(Math.pow(B,2)-Math.pow(kt-E.y,2)),Ft.midAngle>Math.PI/2-L&&Ft.midAngle<Math.PI/2+L?(Tt=C[Tt=(dt-1+C.length)%C.length],dt=C[(dt+1+C.length)%C.length],"left"===Ft.hemisphere&&"right"===Tt.hemisphere&&gt>Tt.indexLabelTextBlock.x?gt=Tt.indexLabelTextBlock.x-15:"right"===Ft.hemisphere&&"left"===dt.hemisphere&&gt<dt.indexLabelTextBlock.x&&(gt=dt.indexLabelTextBlock.x+15)):Ft.midAngle>3*Math.PI/2-L&&Ft.midAngle<3*Math.PI/2+L&&(Tt=C[Tt=(dt-1+C.length)%C.length],dt=C[(dt+1+C.length)%C.length],"right"===Ft.hemisphere&&"left"===Tt.hemisphere&&gt<Tt.indexLabelTextBlock.x?gt=Tt.indexLabelTextBlock.x+15:"left"===Ft.hemisphere&&"right"===dt.hemisphere&&gt>dt.indexLabelTextBlock.x&&(gt=dt.indexLabelTextBlock.x-15)),Ft.indexLabelTextBlock.y=kt,Ft.indexLabelTextBlock.x=gt,Ft.indexLabelAngle=Math.atan2(Ft.indexLabelTextBlock.y-E.y,Ft.indexLabelTextBlock.x-E.x))}return mt}function o(){(dt=f.plotArea.ctx).fillStyle="grey",dt.strokeStyle="grey",dt.font="16px Arial",dt.textBaseline="middle";var mt=dt=0,gt=0,kt=!0;for(mt=0;10>mt&&(1>mt||0<gt);mt++){if((c.radius||!c.radius&&typeof c.innerRadius<"u"&&null!==c.innerRadius&&J-gt<=q)&&(kt=!1),kt&&(J-=gt),gt=0,"inside"!==c.indexLabelPlacement){for(B=J*O,dt=0;dt<d.length;dt++)(Tt=C[dt]).indexLabelTextBlock.x=E.x+B*Math.cos(Tt.midAngle),Tt.indexLabelTextBlock.y=E.y+B*Math.sin(Tt.midAngle),Tt.indexLabelAngle=Tt.midAngle,Tt.radius=J,Tt.percentInnerRadius=nt;for(var ee,Ft,dt=0;dt<d.length;dt++){var Tt=C[dt],vt=w(dt);if(null!==vt){var le=0;if(0>(le=x(ee=C[dt],Ft=C[vt])-R)){for(var jt=Ft=0,Ht=0;Ht<d.length;Ht++)Ht!==dt&&C[Ht].hemisphere===Tt.hemisphere&&(C[Ht].indexLabelTextBlock.y<Tt.indexLabelTextBlock.y?Ft++:jt++);jt=-1*(le-(Ft=le/(Ft+jt||1)*jt));var ye=Ht=0;"right"===Tt.hemisphere?(Ht=D(dt,Ft),+(ye=D(vt,jt=-1*(le-Ht))).toFixed(X)<+jt.toFixed(X)&&+Ht.toFixed(X)<=+Ft.toFixed(X)&&D(dt,-(jt-ye))):(Ht=D(vt,Ft),+(ye=D(dt,jt=-1*(le-Ht))).toFixed(X)<+jt.toFixed(X)&&+Ht.toFixed(X)<=+Ft.toFixed(X)&&D(vt,-(jt-ye)))}}}}else for(dt=0;dt<d.length;dt++)Tt=C[dt],vt=E.x+(B="pie"===c.type?.7*J:.8*J)*Math.cos(Tt.midAngle),Ft=E.y+B*Math.sin(Tt.midAngle),Tt.indexLabelTextBlock.x=vt,Tt.indexLabelTextBlock.y=Ft;for(dt=0;dt<d.length;dt++)0!==(vt=(Tt=C[dt]).indexLabelTextBlock.measureText()).height&&0!==vt.width&&(vt=vt=0,"right"===Tt.hemisphere?(vt=k.x2-(Tt.indexLabelTextBlock.x+Tt.indexLabelTextBlock.width+M),vt*=-1):vt=k.x1-(Tt.indexLabelTextBlock.x-Tt.indexLabelTextBlock.width-M),0<vt&&(!kt&&Tt.indexLabelText&&(.3*Tt.indexLabelTextBlock.maxWidth>(Ft="right"===Tt.hemisphere?k.x2-Tt.indexLabelTextBlock.x:Tt.indexLabelTextBlock.x-k.x1)?Tt.indexLabelText="":Tt.indexLabelTextBlock.maxWidth=.85*Ft,.3*Tt.indexLabelTextBlock.maxWidth<Ft&&(Tt.indexLabelTextBlock.x-="right"===Tt.hemisphere?2:-2)),Math.abs(Tt.indexLabelTextBlock.y-Tt.indexLabelTextBlock.height/2-E.y)<J||Math.abs(Tt.indexLabelTextBlock.y+Tt.indexLabelTextBlock.height/2-E.y)<J)&&(9<(vt/=Math.abs(Math.cos(Tt.indexLabelAngle)))&&(vt*=.3),vt>gt&&(gt=vt)),vt=vt=0,0<Tt.indexLabelAngle&&Tt.indexLabelAngle<Math.PI?(vt=k.y2-(Tt.indexLabelTextBlock.y+Tt.indexLabelTextBlock.height/2+5),vt*=-1):vt=k.y1-(Tt.indexLabelTextBlock.y-Tt.indexLabelTextBlock.height/2-5),0<vt&&(!kt&&Tt.indexLabelText&&0===D(dt,vt*(Ft=0<Tt.indexLabelAngle&&Tt.indexLabelAngle<Math.PI?-1:1))&&D(dt,2*Ft),Math.abs(Tt.indexLabelTextBlock.x-E.x)<J&&(9<(vt/=Math.abs(Math.sin(Tt.indexLabelAngle)))&&(vt*=.3),vt>gt&&(gt=vt))));var Rt=function(se,Ue,ni){for(var li=[],$i=0;li.push(C[Ue]),Ue!==ni;Ue=(Ue+1+d.length)%d.length);for(li.sort(function(wi,wn){return wi.y-wn.y}),Ue=0;Ue<li.length&&(ni=li[Ue],$i<.7*se);Ue++)$i+=ni.indexLabelTextBlock.height,ni.indexLabelTextBlock.text="",ni.indexLabelText="",ni.indexLabelTextBlock.measureText()};!function(){for(var se=-1,Ue=-1,ni=0,li=!1,$i=0;$i<d.length;$i++)if(li=!1,(ee=C[$i]).indexLabelText){var wi=w($i);if(null!==wi){var Ni,wn=C[wi];le=0,(Ni=0>(le=x(ee,wn)))&&(Ni=ee.indexLabelTextBlock.x,Ni=!(ee.indexLabelTextBlock.x+ee.indexLabelTextBlock.width<wn.indexLabelTextBlock.x-M||Ni>wn.indexLabelTextBlock.x+wn.indexLabelTextBlock.width+M||ee.indexLabelTextBlock.y-ee.indexLabelTextBlock.height/2>wn.indexLabelTextBlock.y+wn.indexLabelTextBlock.height/2+M||ee.indexLabelTextBlock.y+ee.indexLabelTextBlock.height/2<wn.indexLabelTextBlock.y-wn.indexLabelTextBlock.height/2-M)),Ni?(0>se&&(se=$i),wi!==se&&(Ue=wi,ni+=-le),$i%Math.max(d.length/10,3)==0&&(li=!0)):li=!0,li&&0<ni&&0<=se&&0<=Ue&&(Rt(ni,se,Ue),Ue=se=-1,ni=0)}}0<ni&&Rt(ni,se,Ue)}()}}function y(){if(f.plotArea.layoutManager.reset(),f.title&&(f.title.dockInsidePlotArea||"center"===f.title.horizontalAlign&&"center"===f.title.verticalAlign)&&f.title.render(),f.subtitles)for(var dt=0;dt<f.subtitles.length;dt++){var gt=f.subtitles[dt];(gt.dockInsidePlotArea||"center"===gt.horizontalAlign&&"center"===gt.verticalAlign)&&gt.render()}f.legend&&(f.legend.dockInsidePlotArea||"center"===f.legend.horizontalAlign&&"center"===f.legend.verticalAlign)&&(f.legend.setLayout(),f.legend.render())}var f=this;if(!(0>=u.dataSeriesIndexes.length)){var B,c=this.data[u.dataSeriesIndexes[0]],d=c.dataPoints,M=10,k=this.plotArea,C=c.dataPointEOs,R=2,O=1.3,L=20/180*Math.PI,X=6,E={x:(k.x2+k.x1)/2,y:(k.y2+k.y1)/2},Y=0;u=!1;for(var it=0;it<d.length;it++)Y+=Math.abs(d[it].y),!u&&typeof d[it].indexLabel<"u"&&null!==d[it].indexLabel&&0<d[it].indexLabel.toString().length&&(u=!0),!u&&typeof d[it].label<"u"&&null!==d[it].label&&0<d[it].label.toString().length&&(u=!0);if(0!==Y){u=u||typeof c.indexLabel<"u"&&null!==c.indexLabel&&0<c.indexLabel.toString().length;var J="inside"!==c.indexLabelPlacement&&u?.75*Math.min(k.width,k.height)/2:.92*Math.min(k.width,k.height)/2;c.radius&&(J=js(c.radius,J));var q=typeof c.innerRadius<"u"&&null!==c.innerRadius?js(c.innerRadius,J):.7*J;c.radius=J,"doughnut"===c.type&&(c.innerRadius=q);var nt=Math.min(q/J,(J-1)/J);this.pieDoughnutClickHandler=function(dt){f.isAnimating||!$t(dt.dataSeries.explodeOnClick)&&!dt.dataSeries.explodeOnClick||((dt=dt.dataPoint).exploded=!dt.exploded,1<this.dataPoints.length&&f._animator.animate(0,500,function(gt){g(gt),y(),f.dispatchEvent("dataAnimationIterationEnd",{chart:f}),f.dispatchEvent("dataAnimationEnd",{chart:f})}))},function I(){if(c&&d){for(var dt=0,gt=0,kt=0,mt=0,Tt=0;Tt<d.length;Tt++){var ee=d[Tt],Ft=c.dataPointIds[Tt];C[Tt].id=Ft,C[Tt].objectType="dataPoint",C[Tt].dataPointIndex=Tt,C[Tt].dataSeriesIndex=0;var vt=C[Tt],Ht={percent:null,total:null},le=null;Ht=f.getPercentAndTotal(c,ee),(c.indexLabelFormatter||ee.indexLabelFormatter)&&(le={chart:f.options,dataSeries:c,dataPoint:ee,total:Ht.total,percent:Ht.percent}),Ht=ee.indexLabelFormatter?ee.indexLabelFormatter(le):ee.indexLabel?f.replaceKeywordsWithValue(ee.indexLabel,ee,c,Tt):c.indexLabelFormatter?c.indexLabelFormatter(le):c.indexLabel?f.replaceKeywordsWithValue(c.indexLabel,ee,c,Tt):ee.label?ee.label:"",f._eventManager.objectMap[Ft]=vt,vt.center={x:E.x,y:E.y},vt.y=ee.y,vt.radius=J,vt.percentInnerRadius=nt,vt.indexLabelText=Ht,vt.indexLabelPlacement=c.indexLabelPlacement,vt.indexLabelLineColor=ee.indexLabelLineColor?ee.indexLabelLineColor:c.options.indexLabelLineColor?c.options.indexLabelLineColor:ee.color?ee.color:c._colorSet[Tt%c._colorSet.length],vt.indexLabelLineThickness=$t(ee.indexLabelLineThickness)?c.indexLabelLineThickness:ee.indexLabelLineThickness,vt.indexLabelLineDashType=ee.indexLabelLineDashType?ee.indexLabelLineDashType:c.indexLabelLineDashType,vt.indexLabelFontColor=ee.indexLabelFontColor?ee.indexLabelFontColor:c.indexLabelFontColor,vt.indexLabelFontStyle=ee.indexLabelFontStyle?ee.indexLabelFontStyle:c.indexLabelFontStyle,vt.indexLabelFontWeight=ee.indexLabelFontWeight?ee.indexLabelFontWeight:c.indexLabelFontWeight,vt.indexLabelFontSize=$t(ee.indexLabelFontSize)?c.indexLabelFontSize:ee.indexLabelFontSize,vt.indexLabelFontFamily=ee.indexLabelFontFamily?ee.indexLabelFontFamily:c.indexLabelFontFamily,vt.indexLabelBackgroundColor=ee.indexLabelBackgroundColor?ee.indexLabelBackgroundColor:c.options.indexLabelBackgroundColor?c.options.indexLabelBackgroundColor:c.indexLabelBackgroundColor,vt.indexLabelMaxWidth=ee.indexLabelMaxWidth?ee.indexLabelMaxWidth:c.indexLabelMaxWidth?c.indexLabelMaxWidth:.33*k.width,vt.indexLabelWrap=typeof ee.indexLabelWrap<"u"?ee.indexLabelWrap:c.indexLabelWrap,vt.indexLabelTextAlign=ee.indexLabelTextAlign?ee.indexLabelTextAlign:c.indexLabelTextAlign?c.indexLabelTextAlign:"left",vt.startAngle=0===Tt?c.startAngle?c.startAngle/180*Math.PI:0:C[Tt-1].endAngle,vt.startAngle=(vt.startAngle+2*Math.PI)%(2*Math.PI),vt.endAngle=vt.startAngle+2*Math.PI/Y*Math.abs(ee.y),ee=((ee=(vt.endAngle+vt.startAngle)/2)+2*Math.PI)%(2*Math.PI),vt.midAngle=ee,vt.midAngle>Math.PI/2-L&&vt.midAngle<Math.PI/2+L?((0===dt||C[kt].midAngle>vt.midAngle)&&(kt=Tt),dt++):vt.midAngle>3*Math.PI/2-L&&vt.midAngle<3*Math.PI/2+L&&((0===gt||C[mt].midAngle>vt.midAngle)&&(mt=Tt),gt++),vt.hemisphere=ee>Math.PI/2&&ee<=3*Math.PI/2?"left":"right",vt.indexLabelTextBlock=new Ri(f.plotArea.ctx,{fontSize:vt.indexLabelFontSize,fontFamily:vt.indexLabelFontFamily,fontColor:vt.indexLabelFontColor,fontStyle:vt.indexLabelFontStyle,fontWeight:vt.indexLabelFontWeight,textAlign:vt.indexLabelTextAlign,backgroundColor:vt.indexLabelBackgroundColor,maxWidth:vt.indexLabelMaxWidth,maxHeight:vt.indexLabelWrap?5*vt.indexLabelFontSize:1.5*vt.indexLabelFontSize,text:vt.indexLabelText,padding:0,textBaseline:"top"}),vt.indexLabelTextBlock.measureText()}for(Ft=ee=0,Ht=!1,Tt=0;Tt<d.length;Tt++)vt=C[(kt+Tt)%d.length],1<dt&&vt.midAngle>Math.PI/2-L&&vt.midAngle<Math.PI/2+L&&(ee<=dt/2&&!Ht?(vt.hemisphere="right",ee++):(vt.hemisphere="left",Ht=!0));for(Ht=!1,Tt=0;Tt<d.length;Tt++)vt=C[(mt+Tt)%d.length],1<gt&&vt.midAngle>3*Math.PI/2-L&&vt.midAngle<3*Math.PI/2+L&&(Ft<=gt/2&&!Ht?(vt.hemisphere="left",Ft++):(vt.hemisphere="right",Ht=!0))}}(),o(),o(),o(),o(),this.disableToolTip=!0,this._animator.animate(0,this.animatedRender?this.animationDuration:0,function(dt){(gt=f.plotArea.ctx).clearRect(k.x1,k.y1,k.width,k.height),gt.fillStyle=f.backgroundColor,gt.fillRect(k.x1,k.y1,k.width,k.height);for(var gt=C[0].startAngle+2*Math.PI*dt,kt=0;kt<d.length;kt++){var mt=0===kt?C[kt].startAngle:Tt,Tt=mt+(C[kt].endAngle-C[kt].startAngle),ee=!1;if(Tt>gt&&(Tt=gt,ee=!0),Tt>mt&&Gt(f.plotArea.ctx,C[kt].center,C[kt].radius,d[kt].color?d[kt].color:c._colorSet[kt%c._colorSet.length],c.type,mt,Tt,c.fillOpacity,C[kt].percentInnerRadius),ee)break}y(),f.dispatchEvent("dataAnimationIterationEnd",{chart:f}),1<=dt&&f.dispatchEvent("dataAnimationEnd",{chart:f})},function(){f.disableToolTip=!1,f._animator.animate(0,f.animatedRender?500:0,function(dt){g(dt),y(),f.dispatchEvent("dataAnimationIterationEnd",{chart:f})}),f.dispatchEvent("dataAnimationEnd",{chart:f})})}}};var re=function(u,I,g,x){typeof g>"u"&&(g=1),0>=Math.round(I.y4-I.y1)||(u.save(),u.globalAlpha=g,u.beginPath(),u.moveTo(Math.round(I.x1),Math.round(I.y1)),u.lineTo(Math.round(I.x2),Math.round(I.y2)),u.lineTo(Math.round(I.x3),Math.round(I.y3)),u.lineTo(Math.round(I.x4),Math.round(I.y4)),"undefined"!==I.x5&&(u.lineTo(Math.round(I.x5),Math.round(I.y5)),u.lineTo(Math.round(I.x6),Math.round(I.y6))),u.closePath(),u.fillStyle=x||I.color,u.fill(),u.globalAplha=1,u.restore())};Ct.prototype.renderFunnel=function(u){function D(){var Qe,qe,fe,Rn;if("inside"!==L.indexLabelPlacement)for(var pi=0;pi<li.length;pi++)0==_e[pi].textBlock.text.length?_e[pi].isDirty=!0:(fe=typeof(Qe=li[pi]).x5<"u"?(Qe.y2+Qe.y4)/2:(Qe.y2+Qe.y3)/2,qe=L.reversed?typeof Qe.x5<"u"&&fe>Ue?C(fe).x2+1:(Qe.x2+Qe.x3)/2+1:typeof Qe.x5<"u"?fe<Ue?C(fe).x2+1:(Qe.x4+Qe.x3)/2+1:(Qe.x2+Qe.x3)/2+1,_e[pi].textBlock.x=qe+le,_e[pi].textBlock.y=fe-_e[pi].height/2,L.reversed?(_e[pi].textBlock.y+_e[pi].height>ye+Y&&(_e[pi].textBlock.y=ye+Y-_e[pi].height),_e[pi].textBlock.y<ni-Y&&(_e[pi].textBlock.y=ni-Y)):(_e[pi].textBlock.y<ye-Y&&(_e[pi].textBlock.y=ye-Y),_e[pi].textBlock.y+_e[pi].height>ni+Y&&(_e[pi].textBlock.y=ni+Y-_e[pi].height)));else for(pi=0;pi<li.length;pi++)0==_e[pi].textBlock.text.length?_e[pi].isDirty=!0:(Rn=_e[pi].width,(qe=(Qe=li[pi]).height)>=(fe=_e[pi].height)?(fe=pi!=wi?(Qe.y1+Qe.y3)/2-fe/2:(Qe.y1+Qe.y4)/2-fe/2,_e[pi].textBlock.x=qe=pi!=wi?(Qe.x4+Qe.x3)/2-Rn/2:(Qe.x5+Qe.x4)/2-Rn/2,_e[pi].textBlock.y=fe):_e[pi].isDirty=!0)}function y(Qe,qe){return(qe<li.length?_e[qe].textBlock.y:L.reversed?ye+Y:ni+Y)-(0>Qe?L.reversed?ni-Y:ye-Y:_e[Qe].textBlock.y+_e[Qe].height+ji)}function f(Qe,qe,fe){var Rn,pi,mn,ze=[],Re=Y,ve=[];if(-1!==qe&&(0<=yn.indexOf(qe)?(pi=yn.indexOf(qe),yn.splice(pi,1)):(yn.push(qe),yn=yn.sort(function(Ii,Ne){return Ii-Ne}))),0===yn.length)ze=Zn;else{pi=Y*(1!=yn.length||0!=yn[0]&&yn[0]!=li.length-1?2:1)/function c(){for(var Qe=0,qe=0;qe<li.length-1;qe++)(0<=yn.indexOf(qe)||0<=yn.indexOf(qe+1))&&Qe++;return Qe}();for(var Zi=0;Zi<li.length;Zi++){if(1==yn.length&&0==yn[0]){if(0===Zi){ze.push(Zn[Zi]),Rn=Re;continue}}else 0===Zi&&(Rn=-1*Re);ze.push(Zn[Zi]+Rn),(0<=yn.indexOf(Zi)||Zi<li.length&&0<=yn.indexOf(Zi+1))&&(Rn+=pi)}}mn=function(){for(var Ii=[],Ne=0;Ne<li.length;Ne++)Ii.push(ze[Ne]-li[Ne].y1);return Ii}(),(new Date).getTime();Qe._animator.animate(0,fe,function(Ii){var Ne=Qe.plotArea.ctx||Qe.ctx;os=!0,Ne.clearRect(E.x1,E.y1,E.x2-E.x1,E.y2-E.y1),Ne.fillStyle=Qe.backgroundColor,Ne.fillRect(E.x1,E.y1,E.width,E.height),function(Ii){for(var Ne,Ui,Te=0;Te<li.length;Te++)Ne=mn[Te],Ui=li[Te],Ne*=Ii,typeof ve[Te]>"u"&&(ve[Te]=0),0>ve&&(ve*=-1),Ui.y1+=Ne-ve[Te],Ui.y2+=Ne-ve[Te],Ui.y3+=Ne-ve[Te],Ui.y4+=Ne-ve[Te],Ui.y5&&(Ui.y5+=Ne-ve[Te],Ui.y6+=Ne-ve[Te]),ve[Te]=Ne}(Ii);var Ui={};for(Ui.dataSeries=L,Ui.dataPoint=L.reversed?L.dataPoints[X.length-1-qe]:L.dataPoints[qe],Ui.index=L.reversed?X.length-1-qe:qe,Qe.toolTip.highlightObjects([Ui]),Ui=0;Ui<li.length;Ui++)re(Ne,li[Ui],L.fillOpacity);B(Ne),dt&&("inside"!==L.indexLabelPlacement?d(Ne):D(),R(Ne)),1<=Ii&&(os=!1)},null,te.easing.easeOutQuart)}function d(Qe){for(var qe,fe,Rn,pi,mn=0;mn<li.length;mn++)qe=C(fe=((li[mn].y2+li[mn].y4)/2<<0)+(pi=_e[mn].lineThickness%2==1?.5:0)).x2-1,Rn=_e[mn].textBlock.x,pi=(_e[mn].textBlock.y+_e[mn].height/2<<0)+pi,_e[mn].isDirty||0==_e[mn].lineThickness||(Qe.strokeStyle=_e[mn].lineColor,Qe.lineWidth=_e[mn].lineThickness,Qe.setLineDash&&Qe.setLineDash(tn(_e[mn].lineDashType,_e[mn].lineThickness)),Qe.beginPath(),Qe.moveTo(qe,fe),Qe.lineTo(Rn,pi),Qe.stroke())}function M(Qe){for(Qe-=1;-1<=Qe&&-1!=Qe&&_e[Qe].isDirty;Qe--);return Qe}function k(Qe){for(Qe+=1;Qe<=li.length&&Qe!=li.length&&_e[Qe].isDirty;Qe++);return Qe}function C(Qe){for(var qe,fe=0;fe<X.length;fe++)if(li[fe].y1<Qe&&li[fe].y4>Qe){qe=li[fe];break}return qe?{x1:Qe=qe.y6&&Qe>qe.y6?qe.x3+(qe.x4-qe.x3)/(qe.y4-qe.y3)*(Qe-qe.y3):qe.x2+(qe.x3-qe.x2)/(qe.y3-qe.y2)*(Qe-qe.y2),x2:Qe}:-1}function R(Qe){for(var qe=0;qe<li.length;qe++)_e[qe].isDirty||(Qe&&(_e[qe].textBlock.ctx=Qe),_e[qe].textBlock.render(!0))}function B(Qe){if(O.plotArea.layoutManager.reset(),Qe.roundRect||ks(Qe),O.title&&(O.title.dockInsidePlotArea||"center"===O.title.horizontalAlign&&"center"===O.title.verticalAlign)&&(O.title.ctx=Qe,O.title.render()),O.subtitles)for(var qe=0;qe<O.subtitles.length;qe++){var fe=O.subtitles[qe];(fe.dockInsidePlotArea||"center"===fe.horizontalAlign&&"center"===fe.verticalAlign)&&(O.subtitles.ctx=Qe,fe.render())}O.legend&&(O.legend.dockInsidePlotArea||"center"===O.legend.horizontalAlign&&"center"===O.legend.verticalAlign)&&(O.legend.ctx=Qe,O.legend.setLayout(),O.legend.render()),Mn.fNg&&Mn.fNg(O)}var O=this;if(!(0>=u.dataSeriesIndexes.length)){for(var L=this.data[u.dataSeriesIndexes[0]],X=L.dataPoints,E=this.plotArea,Y=.025*E.width,it=.01*E.width,J=0,q=E.height-2*Y,nt=Math.min(E.width-2*it,2.8*E.height),dt=!1,gt=0;gt<X.length;gt++)!dt&&typeof X[gt].indexLabel<"u"&&null!==X[gt].indexLabel&&0<X[gt].indexLabel.toString().length&&(dt=!0),!dt&&typeof X[gt].label<"u"&&null!==X[gt].label&&0<X[gt].label.toString().length&&(dt=!0),(!dt&&"function"==typeof L.indexLabelFormatter||"function"==typeof X[gt].indexLabelFormatter)&&(dt=!0);dt=dt||typeof L.indexLabel<"u"&&null!==L.indexLabel&&0<L.indexLabel.toString().length,"inside"!==L.indexLabelPlacement&&dt||(it=(E.width-.75*nt)/2),gt=E.x1+it;var kt=E.x2-it,mt=E.y1+Y,Tt=E.y2-Y,ee=u.targetCanvasCtx||this.plotArea.ctx||this.ctx;if(0!=L.length&&L.dataPoints&&L.visible&&0!==X.length){var Ft,vt,le=30*(kt-(u=75*nt/100))/100;"funnel"===L.type?(Ft=$t(L.options.neckHeight)?.35*q:L.neckHeight,vt=$t(L.options.neckWidth)?.25*u:L.neckWidth,Ft="string"==typeof Ft&&Ft.match(/%$/)?(Ft=parseInt(Ft))*q/100:parseInt(Ft),vt="string"==typeof vt&&vt.match(/%$/)?(vt=parseInt(vt))*u/100:parseInt(vt),Ft>q?Ft=q:0>=Ft&&(Ft=0),vt>u?vt=u-.5:0>=vt&&(vt=0)):"pyramid"===L.type&&(vt=Ft=0,L.reversed=!L.reversed);var Ht=gt,jt=gt+u,ye=L.reversed?Tt:mt,Rt=(it=gt+u/2)-vt/2,se=it+vt/2,Ue=L.reversed?mt+Ft:Tt-Ft,ni=L.reversed?mt:Tt;u=[],it=[];var wi,li=[],$i=(nt=[],mt),wn=(Ue-ye)/(Rt-Ht),Ni=-wn;if(-1!==(gt="area"===(L.valueRepresents?L.valueRepresents:"height")?function g(){var pi,mn,Qe=Ht,qe=jt,fe=Rt,Rn=se;pi=mt,mn=Tt-Ft,Rn=Math.abs((mn-pi)*(qe-Qe+(Rn-fe))/2),pi=mn-pi,mn=(fe=se-Rt)*(mn-Tt),mn=Rn+(mn=Math.abs(mn)),Rn=[];for(var ze=0,Re=0;Re<X.length;Re++){if(typeof X[Re].y>"u")return-1;X[Re].y="number"==typeof X[Re].y?X[Re].y:0,ze+=Math.abs(X[Re].y)}if(0===ze)return-1;var Zi,ui,Ii=Rn[0]=0,ve=0;for(qe-=Qe,Ii=!1,Re=0;Re<X.length;Re++)Qe=Math.abs(X[Re].y)*mn/ze,Ii?Zi=0==Number(fe.toFixed(3))?0:Qe/fe:0>(ui=wn*wn*qe*qe-4*Math.abs(wn)*Qe)?(Qe-=Ii=(qe+(ui=fe))*(pi-ve)/2,Zi=pi-ve,ve+=pi-ve,Zi+=0==ui?0:Qe/ui,ve+=Qe/ui,Ii=!0):(ui=qe-2*(Zi=(Math.abs(wn)*qe-Math.sqrt(ui))/2)/Math.abs(wn),(ve+=Zi)>pi&&(Ii=(qe+(ui=fe))*(pi-(ve-=Zi))/2,Zi=pi-ve,ve+=pi-ve,Zi+=(Qe-=Ii)/ui,ve+=Qe/ui,Ii=!0),qe=ui),Rn.push(Zi);return Rn}():function I(){for(var Qe=0,qe=[],fe=0;fe<X.length;fe++){if(typeof X[fe].y>"u")return-1;X[fe].y="number"==typeof X[fe].y?X[fe].y:0,Qe+=Math.abs(X[fe].y)}if(0===Qe)return-1;for(fe=qe[0]=0;fe<X.length;fe++)qe.push(Math.abs(X[fe].y)*q/Qe);return qe}())){if(L.reversed)for(nt.push($i),vt=gt.length-1;0<vt;vt--)nt.push($i+=gt[vt]);else for(vt=0;vt<gt.length;vt++)nt.push($i+=gt[vt]);if(L.reversed)for(vt=0;vt<gt.length;vt++)nt[vt]<Ue?(u.push(Rt),it.push(se),wi=vt):(u.push((nt[vt]-ye+wn*Ht)/wn),it.push((nt[vt]-ye+Ni*jt)/Ni));else for(vt=0;vt<gt.length;vt++)nt[vt]<Ue?(u.push((nt[vt]-ye+wn*Ht)/wn),it.push((nt[vt]-ye+Ni*jt)/Ni),wi=vt):(u.push(Rt),it.push(se));for(vt=0;vt<gt.length-1;vt++)$i=L.reversed?X[X.length-1-vt].color?X[X.length-1-vt].color:L._colorSet[(X.length-1-vt)%L._colorSet.length]:X[vt].color?X[vt].color:L._colorSet[vt%L._colorSet.length],li.push(vt===wi?{x1:u[vt],y1:nt[vt],x2:it[vt],y2:nt[vt],x3:se,y3:Ue,x4:it[vt+1],y4:nt[vt+1],x5:u[vt+1],y5:nt[vt+1],x6:Rt,y6:Ue,id:vt,height:nt[vt+1]-nt[vt],color:$i}:{x1:u[vt],y1:nt[vt],x2:it[vt],y2:nt[vt],x3:it[vt+1],y3:nt[vt+1],x4:u[vt+1],y4:nt[vt+1],id:vt,height:nt[vt+1]-nt[vt],color:$i});var ji=2,_e=[],os=!1,yn=[],Zn=[];for(gt=!1,u=u=0,Et(yn),vt=0;vt<X.length;vt++)X[vt].exploded&&(gt=!0,yn.push(L.reversed?X.length-1-vt:vt));if(ee.clearRect(E.x1,E.y1,E.width,E.height),ee.fillStyle=O.backgroundColor,ee.fillRect(E.x1,E.y1,E.width,E.height),dt&&L.visible&&(function x(){if(L&&X){for(var Qe,qe,fe,Rn,pi,mn,ze,Re,ve,Zi,ui,Ii,Ne,Ui,Te,Ki=[],Vn=[],bn={percent:null,total:null},Di=null,Mi=0;Mi<X.length;Mi++)Te=C(Te=typeof(Te=li[Mi]).x5<"u"?(Te.y2+Te.y4)/2:(Te.y2+Te.y3)/2).x2+1,Ki[Mi]=kt-Te-le;Te=.5*le,Mi=0;for(var _i=X.length-1;Mi<X.length||0<=_i;Mi++,_i--)Qe=(qe=L.reversed?X[_i]:X[Mi]).color?qe.color:L.reversed?L._colorSet[(X.length-1-Mi)%L._colorSet.length]:L._colorSet[Mi%L._colorSet.length],fe=qe.indexLabelPlacement||L.indexLabelPlacement||"outside",Ui=qe.indexLabelTextAlign||L.indexLabelTextAlign||"left",Rn=qe.indexLabelBackgroundColor||L.indexLabelBackgroundColor||(oe?"transparent":null),pi=qe.indexLabelFontColor||L.indexLabelFontColor||"#979797",mn=$t(qe.indexLabelFontSize)?L.indexLabelFontSize:qe.indexLabelFontSize,ze=qe.indexLabelFontStyle||L.indexLabelFontStyle||"normal",Re=qe.indexLabelFontFamily||L.indexLabelFontFamily||"arial",ve=qe.indexLabelFontWeight||L.indexLabelFontWeight||"normal",Qe=qe.indexLabelLineColor||L.options.indexLabelLineColor||Qe,Zi="number"==typeof qe.indexLabelLineThickness?qe.indexLabelLineThickness:"number"==typeof L.indexLabelLineThickness?L.indexLabelLineThickness:2,ui=qe.indexLabelLineDashType||L.indexLabelLineDashType||"solid",Ii=typeof qe.indexLabelWrap<"u"?qe.indexLabelWrap:!(typeof L.indexLabelWrap<"u")||L.indexLabelWrap,O._eventManager.objectMap[Ne=L.dataPointIds[Mi]]={id:Ne,objectType:"dataPoint",dataPointIndex:Mi,dataSeriesIndex:0,funnelSection:li[L.reversed?X.length-1-Mi:Mi]},"inside"===L.indexLabelPlacement&&(Ki[Mi]=Mi!==wi?L.reversed?li[Mi].x2-li[Mi].x1:li[Mi].x3-li[Mi].x4:li[Mi].x3-li[Mi].x6,20>Ki[Mi]&&(Ki[Mi]=Mi!==wi&&L.reversed?li[Mi].x3-li[Mi].x4:li[Mi].x2-li[Mi].x1,Ki[Mi]/=2)),((Ne=qe.indexLabelMaxWidth?qe.indexLabelMaxWidth:L.options.indexLabelMaxWidth?L.indexLabelMaxWidth:Ki[Mi])>Ki[Mi]||0>Ne)&&(Ne=Ki[Mi]),Vn[Mi]="inside"===L.indexLabelPlacement&&li[Mi].height,bn=O.getPercentAndTotal(L,qe),(L.indexLabelFormatter||qe.indexLabelFormatter)&&(Di={chart:O.options,dataSeries:L,dataPoint:qe,total:bn.total,percent:bn.percent}),qe=qe.indexLabelFormatter?qe.indexLabelFormatter(Di):qe.indexLabel?O.replaceKeywordsWithValue(qe.indexLabel,qe,L,Mi):L.indexLabelFormatter?L.indexLabelFormatter(Di):L.indexLabel?O.replaceKeywordsWithValue(L.indexLabel,qe,L,Mi):qe.label?qe.label:"",0>=Zi&&(Zi=0),1e3>Ne&&1e3-Ne<Te&&(Ne+=1e3-Ne),ee.roundRect||ks(ee),(fe=new Ri(ee,{fontSize:mn,fontFamily:Re,fontColor:pi,fontStyle:ze,fontWeight:ve,horizontalAlign:fe,textAlign:Ui,backgroundColor:Rn,maxWidth:Ne,maxHeight:!1===Vn[Mi]?Ii?4.28571429*mn:1.5*mn:Vn[Mi],text:qe,padding:ji})).measureText(),_e.push({textBlock:fe,id:L.reversed?_i:Mi,isDirty:!1,lineColor:Qe,lineThickness:Zi,lineDashType:ui,height:fe.height<fe.maxHeight?fe.height:fe.maxHeight,width:fe.width<fe.maxWidth?fe.width:fe.maxWidth})}}(),D(),function w(){var Qe,qe,fe,Rn,pi,mn=[];pi=!1,fe=0;for(var ze,Re=kt-jt-le/2,ve=(Re=L.options.indexLabelMaxWidth?L.indexLabelMaxWidth>Re?Re:L.indexLabelMaxWidth:Re,_e.length-1);0<=ve;ve--)ze=X[_e[ve].id],Rn=(fe=_e[ve]).textBlock,qe=(Qe=k(ve)<li.length?_e[k(ve)]:null)?Qe.textBlock:null,fe=fe.height,Qe&&Rn.y+fe+ji>qe.y&&(pi=!0),((fe=ze.indexLabelMaxWidth||Re)>Re||0>fe)&&(fe=Re),mn.push(fe);if(pi)for(ve=_e.length-1;0<=ve;ve--)Qe=li[ve],_e[ve].textBlock.maxWidth=mn[mn.length-(ve+1)],_e[ve].textBlock.measureText(),_e[ve].textBlock.x=kt-Re,pi=_e[ve].textBlock.width<_e[ve].textBlock.maxWidth?_e[ve].textBlock.width:_e[ve].textBlock.maxWidth,_e[ve].height=fe=_e[ve].textBlock.height<_e[ve].textBlock.maxHeight?_e[ve].textBlock.height:_e[ve].textBlock.maxHeight,_e[ve].width=pi,_e[ve].textBlock.y=(fe=typeof Qe.x5<"u"?(Qe.y2+Qe.y4)/2:(Qe.y2+Qe.y3)/2)-_e[ve].height/2,L.reversed?(_e[ve].textBlock.y+_e[ve].height>ye+Y&&(_e[ve].textBlock.y=ye+Y-_e[ve].height),_e[ve].textBlock.y<ni-Y&&(_e[ve].textBlock.y=ni-Y)):(_e[ve].textBlock.y<ye-Y&&(_e[ve].textBlock.y=ye-Y),_e[ve].textBlock.y+_e[ve].height>ni+Y&&(_e[ve].textBlock.y=ni+Y-_e[ve].height))}(),"inside"!==L.indexLabelPlacement)){for(function o(){function Qe(Ne,Ui){var Te;if(0>Ne||Ne>=_e.length)return 0;var Ki,Vn=_e[Ne].textBlock;return 0>Ui?(Ui*=-1,(Te=y(Ki=M(Ne),Ne))>=Ui?(Vn.y-=Ui,Ui):0==Ne?(0<Te&&(Vn.y-=Te),Te):(0<(Te+=Qe(Ki,-(Ui-Te)))&&(Vn.y-=Te),Te)):(Te=y(Ne,Ki=k(Ne)))>=Ui?(Vn.y+=Ui,Ui):Ne==li.length-1?(0<Te&&(Vn.y+=Te),Te):(0<(Te+=Qe(Ki,Ui-Te))&&(Vn.y+=Te),Te)}function qe(){var Ne,Ui,Te,Ki,bn,Vn=0;Ki=(Tt-mt+2*Y)/Zi,bn=Zi;for(var Di,Mi=1;Mi<bn;Mi++){Te=Mi*Ki;for(var _i=_e.length-1;0<=_i;_i--)!_e[_i].isDirty&&_e[_i].textBlock.y<Te&&_e[_i].textBlock.y+_e[_i].height>Te&&!((Di=k(_i))>=_e.length-1)&&_e[_i].textBlock.y+_e[_i].height+ji>_e[Di].textBlock.y&&(_e[_i].textBlock.y=_e[_i].textBlock.y+_e[_i].height-Te>Te-_e[_i].textBlock.y?Te+1:Te-_e[_i].height-1)}for(Di=li.length-1;0<Di;Di--)if(!_e[Di].isDirty){if(0>(Te=M(Di))&&_e[Te=0].isDirty)break;if(_e[Di].textBlock.y<_e[Te].textBlock.y+_e[Te].height){for(Ui=Ui||Di,Ki=Di,bn=0;_e[Ki].textBlock.y<_e[Te].textBlock.y+_e[Te].height+ji;){if(Ne=Ne||_e[Ki].textBlock.y+_e[Ki].height,bn+=_e[Ki].height,bn+=ji,0>=(Ki=Te)){bn+=_e[Ki=0].height;break}if(0>(Te=M(Ki))){bn+=_e[Ki=0].height;break}}if(Ki!=Di){Vn=fe(Ne=bn-(Ne-=Vn=_e[Ki].textBlock.y),Ui,Ki);break}}}return Vn}function fe(Ne,Ui,Te){var Ki=[],Vn=0,bn=0;for(Ne=Math.abs(Ne);Te<=Ui;Te++)Ki.push(li[Te]);for(Ki.sort(function(Di,Mi){return Di.height-Mi.height}),Te=0;Te<Ki.length&&(Ui=Ki[Te],Vn<Ne);Te++)bn++,Vn+=_e[Ui.id].height+ji,_e[Ui.id].textBlock.text="",_e[Ui.id].indexLabelText="",_e[Ui.id].isDirty=!0,_e[Ui.id].textBlock.measureText();return bn}for(var Rn,pi,mn,ze,Re,ve,Zi=1,ui=0;ui<2*Zi;ui++){for(var Ii=_e.length-1;0<=Ii&&(0<=M(Ii)&&M(Ii),ze=(mn=_e[Ii]).textBlock,ve=(Re=k(Ii)<li.length?_e[k(Ii)]:null)?Re.textBlock:null,Rn=+mn.height.toFixed(6),pi=+ze.y.toFixed(6),!(!mn.isDirty&&Re&&pi+Rn+ji>+ve.y.toFixed(6)&&(Rn=ze.y+Rn+ji-ve.y,pi=Qe(Ii,-Rn),pi<Rn&&(0<pi&&(Rn-=pi),pi=Qe(k(Ii),Rn),pi!=Rn))));Ii--);qe()}}(),vt=0;vt<X.length;vt++)_e[vt].isDirty||(u=(kt-(u=_e[vt].textBlock.x+_e[vt].width))/2,0==vt&&(J=u),J>u&&(J=u));for(vt=0;vt<li.length;vt++)li[vt].x1+=J,li[vt].x2+=J,li[vt].x3+=J,li[vt].x4+=J,li[vt].x5&&(li[vt].x5+=J,li[vt].x6+=J),_e[vt].textBlock.x+=J}for(vt=0;vt<li.length;vt++)re(ee,J=li[vt],L.fillOpacity),Zn.push(J.y1);if(B(ee),dt&&L.visible&&("inside"===L.indexLabelPlacement||O.animationEnabled||d(ee),O.animationEnabled||R()),!dt)for(vt=0;vt<X.length;vt++)O._eventManager.objectMap[J=L.dataPointIds[vt]]=u={id:J,objectType:"dataPoint",dataPointIndex:vt,dataSeriesIndex:0,funnelSection:li[L.reversed?X.length-1-vt:vt]};return(!O.animationEnabled&&gt||O.animationEnabled&&!O.animatedRender)&&f(O,-1,0),this.funnelPyramidClickHandler=function(pi){var mn=-1;!os&&!O.isAnimating&&($t(pi.dataSeries.explodeOnClick)||pi.dataSeries.explodeOnClick)&&0<=(mn=L.reversed?X.length-1-pi.dataPointIndex:pi.dataPointIndex)&&(pi=mn,("funnel"===L.type||"pyramid"===L.type)&&(L.reversed?X[X.length-1-pi].exploded=!X[X.length-1-pi].exploded:X[pi].exploded=!X[pi].exploded),f(O,mn,500))},{source:ee,dest:this.plotArea.ctx,animationCallback:function(pi,mn){te.fadeInAnimation(pi,mn),1<=pi&&(f(O,-1,500),B(O.plotArea.ctx||O.ctx))},easingFunction:te.easing.easeInQuad,animationBase:0}}}}},Ct.prototype.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(u){window.setTimeout(u,1e3/60)},Ct.prototype.cancelRequestAnimFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,Ct.prototype.set=function(u,I,g){g=typeof g>"u"||g,"options"===u?(this.options=I,g&&this.render()):Ct.base.set.call(this,u,I,g)},Ct.prototype.exportChart=function(u){var I=(u=typeof u>"u"?{}:u).format?u.format:"png",g=u.fileName?u.fileName:this.exportFileName;if(u.toDataURL)return this.canvas.toDataURL("image/"+I);if((x=this.canvas)&&I&&g){g=g+"."+I;var x=x.toDataURL(u="image/"+I),w=!1,D=document.createElement("a");if(D.download=g,D.href=x,typeof Blob<"u"&&new Blob){for(var o=x.replace(/^data:[a-z\/]*;base64,/,""),y=(o=atob(o),new ArrayBuffer(o.length)),f=(y=new Uint8Array(y),0);f<o.length;f++)y[f]=o.charCodeAt(f);I=new Blob([y.buffer],{type:"image/"+I});try{window.navigator.msSaveBlob(I,g),w=!0}catch{D.dataset.downloadurl=[u,D.download,D.href].join(":"),D.href=window.URL.createObjectURL(I)}}if(!w)try{event=document.createEvent("MouseEvents"),event.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),D.dispatchEvent?D.dispatchEvent(event):D.fireEvent&&D.fireEvent("onclick")}catch{(I=window.open()).document.write("<img src='"+x+"'></img><div>Please right click on the image and save it to your device</div>"),I.document.close()}}},Ct.prototype.print=function(){var u=this.exportChart({toDataURL:!0}),I=document.createElement("iframe");I.setAttribute("class","canvasjs-chart-print-frame"),cn(I,{position:"absolute",width:"100%",border:"0px",margin:"0px 0px 0px 0px",padding:"0px 0px 0px 0px"}),I.style.height=this.height+"px",this._canvasJSContainer.appendChild(I);var g=this,x=I.contentWindow||I.contentDocument.document||I.contentDocument;x.document.open(),x.document.write('<!DOCTYPE HTML>\n<html><body><img src="'+u+'"/><body/></html>'),x.document.body&&x.document.body.style&&(x.document.body.style.margin="0px 0px 0px 0px",x.document.body.style.padding="0px 0px 0px 0px"),x.document.close(),setTimeout(function(){x.focus(),x.print(),setTimeout(function(){g._canvasJSContainer.removeChild(I)},1e3)},500)},Ct.prototype.getPercentAndTotal=function(u,I){var g=null,x=null,w=g=null;if(0<=u.type.indexOf("stacked"))x=0,(g=I.x.getTime?I.x.getTime():I.x)in u.plotUnit.yTotals&&(x=u.plotUnit.yTotals[g],g=u.plotUnit.yAbsTotals[g],w=isNaN(I.y)||0===g?0:I.y/g*100);else if("pie"===u.type||"doughnut"===u.type||"funnel"===u.type||"pyramid"===u.type){for(g=x=0;g<u.dataPoints.length;g++)isNaN(u.dataPoints[g].y)||(x+=u.dataPoints[g].y);w=isNaN(I.y)?0:I.y/x*100}return{percent:w,total:x}},Ct.prototype.replaceKeywordsWithValue=function(u,I,g,x,w){var D=this;if(w=typeof w>"u"?0:w,(0<=g.type.indexOf("stacked")||"pie"===g.type||"doughnut"===g.type||"funnel"===g.type||"pyramid"===g.type)&&(0<=u.indexOf("#percent")||0<=u.indexOf("#total"))){var f="#percent",y="#total",o=this.getPercentAndTotal(g,I);y=isNaN(o.total)?y:o.total,f=isNaN(o.percent)?f:o.percent;do{if(o="",g.percentFormatString)o=g.percentFormatString;else{o="#,##0.";var c=Math.max(Math.ceil(Math.log(1/Math.abs(f))/Math.LN10),2);(isNaN(c)||!isFinite(c))&&(c=2);for(var d=0;d<c;d++)o+="#";g.percentFormatString=o}u=(u=u.replace("#percent",Ps(f,o,D._cultureInfo))).replace("#total",Ps(y,g.yValueFormatString?g.yValueFormatString:"#,##0.########",D._cultureInfo))}while(0<=u.indexOf("#percent")||0<=u.indexOf("#total"))}return u.replace(/\{.*?\}|"[^"]*"|'[^']*'/g,function(M){if('"'===M[0]&&'"'===M[M.length-1]||"'"===M[0]&&"'"===M[M.length-1])return M.slice(1,M.length-1);M=(M=ho(M.slice(1,M.length-1))).replace("#index",w);var k=null;try{var C=M.match(/(.*?)\s*\[\s*(.*?)\s*\]/);C&&0<C.length&&(k=ho(C[2]),M=ho(C[1]))}catch{}if(C=null,"color"===M)return"waterfall"===g.type?I.color?I.color:0<I.y?g.risingColor:g.fallingColor:"error"===g.type?g.color?g.color:g._colorSet[k%g._colorSet.length]:I.color?I.color:g.color?g.color:g._colorSet[x%g._colorSet.length];if(I.hasOwnProperty(M))C=I;else{if(!g.hasOwnProperty(M))return"";C=g}return C=C[M],null!==k&&(C=C[k]),"x"!==M?"y"===M?Ps(C,I.yValueFormatString?I.yValueFormatString:g.yValueFormatString?g.yValueFormatString:g.yValueFormatString="#,##0.########",D._cultureInfo):"z"===M?Ps(C,I.zValueFormatString?I.zValueFormatString:g.zValueFormatString?g.zValueFormatString:g.zValueFormatString="#,##0.########",D._cultureInfo):C:g.axisX&&"dateTime"===g.axisX.valueType||"dateTime"===g.xValueType||I.x&&I.x.getTime?g.axisX.logarithmic?void 0:_o(C,I.xValueFormatString?I.xValueFormatString:g.xValueFormatString?g.xValueFormatString:g.xValueFormatString=D.axisX&&D.axisX.autoValueFormatString?D.axisX.autoValueFormatString:"DD MMM YY",D._cultureInfo):Ps(C,I.xValueFormatString?I.xValueFormatString:g.xValueFormatString?g.xValueFormatString:g.xValueFormatString="#,##0.########",D._cultureInfo)})},On(ri,Wi),ri.prototype.setLayout=function(){var u=this.dockInsidePlotArea?this.chart.plotArea:this.chart,I=u.layoutManager.getFreeSpace(),g=null,x=0,w=0,D=0,o=0,y=this.markerMargin=this.chart.options.legend&&!$t(this.chart.options.legend.markerMargin)?this.chart.options.legend.markerMargin:.3*this.fontSize;this.height=0;var f=[],c=[];"top"===this.verticalAlign||"bottom"===this.verticalAlign?(this.orientation="horizontal",g=this.verticalAlign,D=this.maxWidth=null!==this.maxWidth?this.maxWidth:I.width,o=this.maxHeight=null!==this.maxHeight?this.maxHeight:.5*I.height):"center"===this.verticalAlign&&(this.orientation="vertical",("left"===this.horizontalAlign||"center"===this.horizontalAlign||"right"===this.horizontalAlign)&&(g=this.horizontalAlign),D=this.maxWidth=null!==this.maxWidth?this.maxWidth:.5*I.width,o=this.maxHeight=null!==this.maxHeight?this.maxHeight:I.height),this.errorMarkerColor=[];for(var d=0;d<this.dataSeries.length;d++){var M=this.dataSeries[d];if(M.dataPoints&&M.dataPoints.length)if("pie"!==M.type&&"doughnut"!==M.type&&"funnel"!==M.type&&"pyramid"!==M.type){var k=M.legendMarkerType=M.legendMarkerType?M.legendMarkerType:"line"!==M.type&&"stepLine"!==M.type&&"spline"!==M.type&&"scatter"!==M.type&&"bubble"!==M.type||!M.markerType?"error"===M.type&&M._linkedSeries?M._linkedSeries.legendMarkerType?M._linkedSeries.legendMarkerType:mi.getDefaultLegendMarker(M._linkedSeries.type):mi.getDefaultLegendMarker(M.type):M.markerType,C=M.legendText?M.legendText:this.itemTextFormatter?this.itemTextFormatter({chart:this.chart,legend:this.options,dataSeries:M,dataPoint:null}):M.name,R=M.legendMarkerColor=M.legendMarkerColor?M.legendMarkerColor:M.markerColor?M.markerColor:"error"===M.type?$t(M.whiskerColor)?M._colorSet[0]:M.whiskerColor:M._colorSet[0],B=M.markerSize||"line"!==M.type&&"stepLine"!==M.type&&"spline"!==M.type?.75*this.lineHeight:0,O=M.legendMarkerBorderColor?M.legendMarkerBorderColor:M.markerBorderColor,L=M.legendMarkerBorderThickness?M.legendMarkerBorderThickness:M.markerBorderThickness?Math.max(1,Math.round(.2*B)):0;"error"===M.type&&this.errorMarkerColor.push(R),C=this.chart.replaceKeywordsWithValue(C,M.dataPoints[0],M,d),f.push(k={markerType:k,markerColor:R,text:C,textBlock:null,chartType:M.type,markerSize:B,lineColor:M._colorSet[0],dataSeriesIndex:M.index,dataPointIndex:null,markerBorderColor:O,markerBorderThickness:L})}else for(var X=0;X<M.dataPoints.length;X++){var E=M.dataPoints[X];k=E.legendMarkerType?E.legendMarkerType:M.legendMarkerType?M.legendMarkerType:mi.getDefaultLegendMarker(M.type),C=E.legendText?E.legendText:M.legendText?M.legendText:this.itemTextFormatter?this.itemTextFormatter({chart:this.chart,legend:this.options,dataSeries:M,dataPoint:E}):E.name?E.name:"DataPoint: "+(X+1),R=E.legendMarkerColor?E.legendMarkerColor:M.legendMarkerColor?M.legendMarkerColor:E.color?E.color:M.color?M.color:M._colorSet[X%M._colorSet.length],B=.75*this.lineHeight,O=E.legendMarkerBorderColor?E.legendMarkerBorderColor:M.legendMarkerBorderColor?M.legendMarkerBorderColor:E.markerBorderColor?E.markerBorderColor:M.markerBorderColor,L=E.legendMarkerBorderThickness?E.legendMarkerBorderThickness:M.legendMarkerBorderThickness?M.legendMarkerBorderThickness:E.markerBorderThickness||M.markerBorderThickness?Math.max(1,Math.round(.2*B)):0,k={markerType:k,markerColor:R,text:C=this.chart.replaceKeywordsWithValue(C,E,M,X),textBlock:null,chartType:M.type,markerSize:B,dataSeriesIndex:d,dataPointIndex:X,markerBorderColor:O,markerBorderThickness:L},(E.showInLegend||M.showInLegend&&!1!==E.showInLegend)&&f.push(k)}}if(!0===this.reversed&&f.reverse(),0<f.length){for(M=null,R=C=E=X=0,E=null!==this.itemWidth?null!==this.itemMaxWidth?Math.min(this.itemWidth,this.itemMaxWidth,D):this.itemMaxWidth=Math.min(this.itemWidth,D):null!==this.itemMaxWidth?Math.min(this.itemMaxWidth,D):this.itemMaxWidth=D,E-=(B=0===B?.75*this.lineHeight:B)+y,d=0;d<f.length;d++)O=E,("line"===(k=f[d]).chartType||"spline"===k.chartType||"stepLine"===k.chartType)&&(O-=.2*this.lineHeight),0>=o||typeof o>"u"||0>=O||typeof O>"u"||("horizontal"===this.orientation?(k.textBlock=new Ri(this.ctx,{x:0,y:0,maxWidth:O,maxHeight:this.itemWrap?o:this.lineHeight,angle:0,text:k.text,horizontalAlign:"left",fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontColor:this.fontColor,fontStyle:this.fontStyle,textBaseline:"middle"}),k.textBlock.measureText(),null!==this.itemWidth&&(k.textBlock.width=this.itemWidth-(B+y+("line"===k.chartType||"spline"===k.chartType||"stepLine"===k.chartType?.2*this.lineHeight:0))),(!M||M.width+Math.round(k.textBlock.width+B+y+(0===M.width?0:this.horizontalSpacing)+("line"===k.chartType||"spline"===k.chartType||"stepLine"===k.chartType?.2*this.lineHeight:0))>D)&&(c.push(M={items:[],width:0}),this.height+=C,C=0),C=Math.max(C,k.textBlock.height)):(k.textBlock=new Ri(this.ctx,{x:0,y:0,maxWidth:E,maxHeight:!0===this.itemWrap?o:1.5*this.fontSize,angle:0,text:k.text,horizontalAlign:"left",fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontColor:this.fontColor,fontStyle:this.fontStyle,textBaseline:"middle"}),k.textBlock.measureText(),null!==this.itemWidth&&(k.textBlock.width=this.itemWidth-(B+y+("line"===k.chartType||"spline"===k.chartType||"stepLine"===k.chartType?.2*this.lineHeight:0))),this.height<o-this.lineHeight?c.push(M={items:[],width:0}):(M=c[X],X=(X+1)%c.length),this.height+=k.textBlock.height),k.textBlock.x=M.width,k.textBlock.y=0,M.width+=Math.round(k.textBlock.width+B+y+(0===M.width?0:this.horizontalSpacing)+("line"===k.chartType||"spline"===k.chartType||"stepLine"===k.chartType?.2*this.lineHeight:0)),M.items.push(k),this.width=Math.max(M.width,this.width),R=k.textBlock.width+(B+y+("line"===k.chartType||"spline"===k.chartType||"stepLine"===k.chartType?.2*this.lineHeight:0)));this.itemWidth=R,this.height=!1===this.itemWrap?c.length*this.lineHeight:this.height+C,this.height=Math.min(o,this.height),this.width=Math.min(D,this.width)}for("top"===this.verticalAlign?(w="left"===this.horizontalAlign?I.x1:"right"===this.horizontalAlign?I.x2-this.width:I.x1+I.width/2-this.width/2,x=I.y1):"center"===this.verticalAlign?(w="left"===this.horizontalAlign?I.x1:"right"===this.horizontalAlign?I.x2-this.width:I.x1+I.width/2-this.width/2,x=I.y1+I.height/2-this.height/2):"bottom"===this.verticalAlign&&(w="left"===this.horizontalAlign?I.x1:"right"===this.horizontalAlign?I.x2-this.width:I.x1+I.width/2-this.width/2,x=I.y2-this.height),this.items=f,d=0;d<this.items.length;d++)(k=f[d]).id=++this.chart._eventManager.lastObjectId,this.chart._eventManager.objectMap[k.id]={id:k.id,objectType:"legendItem",legendItemIndex:d,dataSeriesIndex:k.dataSeriesIndex,dataPointIndex:k.dataPointIndex};this.markerSize=B,this.rows=c,0<f.length&&u.layoutManager.registerSpace(g,{width:this.width+2+2,height:this.height+5+5}),this.bounds={x1:w,y1:x,x2:w+this.width,y2:x+this.height}},ri.prototype.render=function(){var u=this.bounds.x1,I=this.bounds.y1,g=this.markerMargin,x=this.maxWidth,w=this.maxHeight,D=this.markerSize,o=this.rows;(0<this.borderThickness&&this.borderColor||this.backgroundColor)&&this.ctx.roundRect(u,I,this.width,this.height,this.cornerRadius,this.borderThickness,this.backgroundColor,this.borderColor);for(var y=0,f=0;f<o.length;f++){for(var c=o[f],d=0,M=0;M<c.items.length;M++){var k=c.items[M],C=k.textBlock.x+u+(0===M?.2*D:this.horizontalSpacing),R=I+y,B=C;if(this.chart.data[k.dataSeriesIndex].visible||(this.ctx.globalAlpha=.5),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(u,I,x,Math.max(w-w%this.lineHeight,0)),this.ctx.clip(),("line"===k.chartType||"stepLine"===k.chartType||"spline"===k.chartType)&&(this.ctx.strokeStyle=k.lineColor,this.ctx.lineWidth=Math.ceil(this.lineHeight/8),this.ctx.beginPath(),this.ctx.moveTo(C-.1*this.lineHeight,R+this.lineHeight/2),this.ctx.lineTo(C+.85*this.lineHeight,R+this.lineHeight/2),this.ctx.stroke(),B-=.1*this.lineHeight),"error"===k.chartType){this.ctx.strokeStyle=this.errorMarkerColor[0],this.ctx.lineWidth=D/8,this.ctx.beginPath();var O=C-.08*this.lineHeight+.1*this.lineHeight,L=R+.15*this.lineHeight,X=.7*this.lineHeight,E=X+.02*this.lineHeight;this.ctx.moveTo(O,L),this.ctx.lineTo(O+X,L),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(O+X/2,L),this.ctx.lineTo(O+X/2,L+E),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(O,L+E),this.ctx.lineTo(O+X,L+E),this.ctx.stroke(),this.errorMarkerColor.shift()}ie.drawMarker(C+D/2,R+this.lineHeight/2,this.ctx,k.markerType,"error"===k.chartType||"line"===k.chartType||"spline"===k.chartType?k.markerSize/2:k.markerSize,k.markerColor,k.markerBorderColor,k.markerBorderThickness),k.textBlock.x=C+g+D,("line"===k.chartType||"stepLine"===k.chartType||"spline"===k.chartType)&&(k.textBlock.x+=.1*this.lineHeight),k.textBlock.y=Math.round(R+this.lineHeight/2),k.textBlock.render(!0),this.ctx.restore(),d=0<M?Math.max(d,k.textBlock.height):k.textBlock.height,this.chart.data[k.dataSeriesIndex].visible||(this.ctx.globalAlpha=1),C=bi(k.id),this.ghostCtx.fillStyle=C,this.ghostCtx.beginPath(),this.ghostCtx.fillRect(B,k.textBlock.y-this.lineHeight/2,k.textBlock.x+k.textBlock.width-B,k.textBlock.height),k.x1=this.chart._eventManager.objectMap[k.id].x1=B,k.y1=this.chart._eventManager.objectMap[k.id].y1=k.textBlock.y-this.lineHeight/2,k.x2=this.chart._eventManager.objectMap[k.id].x2=k.textBlock.x+k.textBlock.width,k.y2=this.chart._eventManager.objectMap[k.id].y2=k.textBlock.y+k.textBlock.height-this.lineHeight/2}y+=d}},On(mi,Wi),mi.prototype.getDefaultAxisPlacement=function(){var u=this.type;return"column"===u||"line"===u||"stepLine"===u||"spline"===u||"area"===u||"stepArea"===u||"splineArea"===u||"stackedColumn"===u||"stackedLine"===u||"bubble"===u||"scatter"===u||"stackedArea"===u||"stackedColumn100"===u||"stackedLine100"===u||"stackedArea100"===u||"candlestick"===u||"ohlc"===u||"rangeColumn"===u||"rangeArea"===u||"rangeSplineArea"===u||"boxAndWhisker"===u||"waterfall"===u?"normal":"bar"===u||"stackedBar"===u||"stackedBar100"===u||"rangeBar"===u?"xySwapped":"pie"===u||"doughnut"===u||"funnel"===u||"pyramid"===u?"none":("error"!==u&&window.console.log("Unknown Chart Type: "+u),null)},mi.getDefaultLegendMarker=function(u){return"column"===u||"stackedColumn"===u||"stackedLine"===u||"bar"===u||"stackedBar"===u||"stackedBar100"===u||"bubble"===u||"scatter"===u||"stackedColumn100"===u||"stackedLine100"===u||"stepArea"===u||"candlestick"===u||"ohlc"===u||"rangeColumn"===u||"rangeBar"===u||"rangeArea"===u||"rangeSplineArea"===u||"boxAndWhisker"===u||"waterfall"===u?"square":"line"===u||"stepLine"===u||"spline"===u||"pie"===u||"doughnut"===u?"circle":"area"===u||"splineArea"===u||"stackedArea"===u||"stackedArea100"===u||"funnel"===u||"pyramid"===u?"triangle":"error"===u?"none":(window.console.log("Unknown Chart Type: "+u),null)},mi.prototype.getDataPointAtX=function(u,I){if(!this.dataPoints||0===this.dataPoints.length)return null;var g={dataPoint:null,distance:1/0,index:NaN},x=null,w=0,D=0,o=1,y=1/0,f=0,c=0,d=0;for("none"!==this.chart.plotInfo.axisPlacement&&(d=this.axisX.logarithmic?1<(d=Math.log(this.dataPoints[this.dataPoints.length-1].x/this.dataPoints[0].x))?Math.min(Math.max((this.dataPoints.length-1)/d*Math.log(u/this.dataPoints[0].x)>>0,0),this.dataPoints.length):0:0<(d=this.dataPoints[this.dataPoints.length-1].x-this.dataPoints[0].x)?Math.min(Math.max((this.dataPoints.length-1)/d*(u-this.dataPoints[0].x)>>0,0),this.dataPoints.length):0);;){if(0<=(D=0<o?d+w:d-w)&&D<this.dataPoints.length){x=this.dataPoints[D];var M=this.axisX.logarithmic?x.x>u?x.x/u:u/x.x:Math.abs(x.x-u);if(M<g.distance&&(g.dataPoint=x,g.distance=M,g.index=D),(x=M)<=y?y=x:0<o?f++:c++,1e3<f&&1e3<c)break}else if(0>d-w&&d+w>=this.dataPoints.length)break;-1===o?(w++,o=1):o=-1}return I||(g.dataPoint.x.getTime?g.dataPoint.x.getTime():g.dataPoint.x)!==(u.getTime?u.getTime():u)?I&&null!==g.dataPoint?g:null:g},mi.prototype.getDataPointAtXY=function(u,I,g){if(!this.dataPoints||0===this.dataPoints.length||u<this.chart.plotArea.x1||u>this.chart.plotArea.x2||I<this.chart.plotArea.y1||I>this.chart.plotArea.y2)return null;g=g||!1;var x=[],w=0,D=0,o=1,y=!1,f=1/0,c=0,d=0,k=0;for("none"!==this.chart.plotInfo.axisPlacement&&(k=(this.chart.axisX[0]?this.chart.axisX[0]:this.chart.axisX2[0]).getXValueAt({x:u,y:I}),k=this.axisX.logarithmic?1<(M=Math.log(this.dataPoints[this.dataPoints.length-1].x/this.dataPoints[0].x))?Math.min(Math.max((this.dataPoints.length-1)/M*Math.log(k/this.dataPoints[0].x)>>0,0),this.dataPoints.length):0:0<(M=this.dataPoints[this.dataPoints.length-1].x-this.dataPoints[0].x)?Math.min(Math.max((this.dataPoints.length-1)/M*(k-this.dataPoints[0].x)>>0,0),this.dataPoints.length):0);;){if(0<=(D=0<o?k+w:k-w)&&D<this.dataPoints.length){var M,C=this.dataPoints[D],R=null;if(M=this.chart._eventManager.objectMap[this.dataPointIds[D]]){switch(this.type){case"column":case"stackedColumn":case"stackedColumn100":case"bar":case"stackedBar":case"stackedBar100":case"rangeColumn":case"rangeBar":case"waterfall":case"error":u>=M.x1&&u<=M.x2&&I>=M.y1&&I<=M.y2&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:Math.min(Math.abs(M.x1-u),Math.abs(M.x2-u),Math.abs(M.y1-I),Math.abs(M.y2-I))}),y=!0);break;case"line":case"stepLine":case"spline":case"area":case"stepArea":case"stackedArea":case"stackedArea100":case"splineArea":case"scatter":var B=en("markerSize",C,this)||4,O=g?20:B;(R=Math.sqrt(Math.pow(M.x1-u,2)+Math.pow(M.y1-I,2)))<=O&&x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:R}),(M=Math.abs(M.x1-u))<=f?f=M:0<o?c++:d++,R<=B/2&&(y=!0);break;case"rangeArea":case"rangeSplineArea":B=en("markerSize",C,this)||4,O=g?20:B,(R=Math.min(Math.sqrt(Math.pow(M.x1-u,2)+Math.pow(M.y1-I,2)),Math.sqrt(Math.pow(M.x1-u,2)+Math.pow(M.y2-I,2))))<=O&&x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:R}),(M=Math.abs(M.x1-u))<=f?f=M:0<o?c++:d++,R<=B/2&&(y=!0);break;case"bubble":B=M.size,(R=Math.sqrt(Math.pow(M.x1-u,2)+Math.pow(M.y1-I,2)))<=B/2&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:R}),y=!0);break;case"pie":case"doughnut":B=M.center,O="doughnut"===this.type?M.percentInnerRadius*M.radius:0,(R=Math.sqrt(Math.pow(B.x-u,2)+Math.pow(B.y-I,2)))<M.radius&&R>O&&(0>(R=Math.atan2(I-B.y,u-B.x))&&(R+=2*Math.PI),R=Number(((R/Math.PI*180%360+360)%360).toFixed(12)),B=Number(((M.startAngle/Math.PI*180%360+360)%360).toFixed(12)),0===(O=Number(((M.endAngle/Math.PI*180%360+360)%360).toFixed(12)))&&1<M.endAngle&&(O=360),B>=O&&0!==C.y&&(O+=360,R<B&&(R+=360)),R>B&&R<O&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:0}),y=!0));break;case"funnel":case"pyramid":I>(R=M.funnelSection).y1&&I<R.y4&&(R.y6?I>R.y6?(D=R.x6+(R.x5-R.x6)/(R.y5-R.y6)*(I-R.y6),R=R.x3+(R.x4-R.x3)/(R.y4-R.y3)*(I-R.y3)):(D=R.x1+(R.x6-R.x1)/(R.y6-R.y1)*(I-R.y1),R=R.x2+(R.x3-R.x2)/(R.y3-R.y2)*(I-R.y2)):(D=R.x1+(R.x4-R.x1)/(R.y4-R.y1)*(I-R.y1),R=R.x2+(R.x3-R.x2)/(R.y3-R.y2)*(I-R.y2)),u>D&&u<R&&(x.push({dataPoint:C,dataPointIndex:M.dataPointIndex,dataSeries:this,distance:0}),y=!0));break;case"boxAndWhisker":(u>=M.x1-M.borderThickness/2&&u<=M.x2+M.borderThickness/2&&I>=M.y4-M.borderThickness/2&&I<=M.y1+M.borderThickness/2||Math.abs(M.x2-u+M.x1-u)<M.borderThickness&&I>=M.y1&&I<=M.y4)&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:Math.min(Math.abs(M.x1-u),Math.abs(M.x2-u),Math.abs(M.y2-I),Math.abs(M.y3-I))}),y=!0);break;case"candlestick":(u>=M.x1-M.borderThickness/2&&u<=M.x2+M.borderThickness/2&&I>=M.y2-M.borderThickness/2&&I<=M.y3+M.borderThickness/2||Math.abs(M.x2-u+M.x1-u)<M.borderThickness&&I>=M.y1&&I<=M.y4)&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:Math.min(Math.abs(M.x1-u),Math.abs(M.x2-u),Math.abs(M.y2-I),Math.abs(M.y3-I))}),y=!0);break;case"ohlc":(Math.abs(M.x2-u+M.x1-u)<M.borderThickness&&I>=M.y2&&I<=M.y3||u>=M.x1&&u<=(M.x2+M.x1)/2&&I>=M.y1-M.borderThickness/2&&I<=M.y1+M.borderThickness/2||u>=(M.x1+M.x2)/2&&u<=M.x2&&I>=M.y4-M.borderThickness/2&&I<=M.y4+M.borderThickness/2)&&(x.push({dataPoint:C,dataPointIndex:D,dataSeries:this,distance:Math.min(Math.abs(M.x1-u),Math.abs(M.x2-u),Math.abs(M.y2-I),Math.abs(M.y3-I))}),y=!0)}if(y||1e3<c&&1e3<d)break}}else if(0>k-w&&k+w>=this.dataPoints.length)break;-1===o?(w++,o=1):o=-1}for(u=null,I=0;I<x.length;I++)u?x[I].distance<=u.distance&&(u=x[I]):u=x[I];return u},mi.prototype.getMarkerProperties=function(u,I,g,x){var w=this.dataPoints;return{x:I,y:g,ctx:x,type:w[u].markerType?w[u].markerType:this.markerType,size:w[u].markerSize?w[u].markerSize:this.markerSize,color:w[u].markerColor?w[u].markerColor:this.markerColor?this.markerColor:w[u].color?w[u].color:this.color?this.color:this._colorSet[u%this._colorSet.length],borderColor:w[u].markerBorderColor?w[u].markerBorderColor:this.markerBorderColor?this.markerBorderColor:null,borderThickness:w[u].markerBorderThickness?w[u].markerBorderThickness:this.markerBorderThickness?this.markerBorderThickness:null}},On(Q,Wi),Q.prototype.createExtraLabelsForLog=function(u){if(!(5<(u=(u||0)+1))){var I=this.logLabelValues[0]||this.intervalStartPosition;if(Math.log(this.range)/Math.log(I/this.viewportMinimum)<this.noTicks-1){for(var g=Q.getNiceNumber((I-this.viewportMinimum)/Math.min(Math.max(2,this.noTicks-this.logLabelValues.length),3),!0),x=Math.ceil(this.viewportMinimum/g)*g;x<I;x+=g)x<this.viewportMinimum||this.logLabelValues.push(x);this.logLabelValues.sort(pn),this.createExtraLabelsForLog(u)}}},Q.prototype.createLabels=function(){var u,I,x,f,d,g=0,o=0,w=0,D=0,y=(o=0,o=this.interval,0),c=.6*this.chart.height;u=!1;var M=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[],k=M.length?$t(this.scaleBreaks.firstBreakIndex)?0:this.scaleBreaks.firstBreakIndex:0;if("axisX"!==this.type||"dateTime"!==this.valueType||this.logarithmic){if(x=this.viewportMaximum,this.labels){u=Math.ceil(o);var C=!1;for(g=o=Math.ceil(this.intervalStartPosition);g<this.viewportMaximum;g+=u){if(!this.labels[g]){C=!1;break}C=!0}C&&(this.interval=u,this.intervalStartPosition=o)}if(this.logarithmic&&!this.equidistantInterval)for(this.logLabelValues||(this.logLabelValues=[],this.createExtraLabelsForLog()),o=0,C=k;o<this.logLabelValues.length;o++)if((g=this.logLabelValues[o])<this.viewportMinimum)o++;else{for(;C<M.length&&g>M[C].endValue;C++);d=g,(u=C<M.length&&g>=M[C].startValue&&g<=M[C].endValue)||(u=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:d,label:this.labels[d]?this.labels[d]:null}):"axisX"===this.type&&this.labels[d]?this.labels[d]:Ps(d,this.valueFormatString,this.chart._cultureInfo),u=new Ri(this.ctx,{x:0,y:0,maxWidth:w,maxHeight:D,angle:this.labelAngle,text:this.prefix+u+this.suffix,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,cornerRadius:this.labelCornerRadius,textAlign:this.labelTextAlign,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle",borderThickness:0}),this._labels.push({position:d,textBlock:u,effectiveHeight:null}))}for(C=k,g=this.intervalStartPosition;g<=x;g=parseFloat(1e-12>this.interval?this.logarithmic&&this.equidistantInterval?g*Math.pow(this.logarithmBase,this.interval):g+this.interval:(this.logarithmic&&this.equidistantInterval?g*Math.pow(this.logarithmBase,this.interval):g+this.interval).toFixed(12))){for(;C<M.length&&g>M[C].endValue;C++);d=g,(u=C<M.length&&g>=M[C].startValue&&g<=M[C].endValue)||(u=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:d,label:this.labels[d]?this.labels[d]:null}):"axisX"===this.type&&this.labels[d]?this.labels[d]:Ps(d,this.valueFormatString,this.chart._cultureInfo),u=new Ri(this.ctx,{x:0,y:0,maxWidth:w,maxHeight:D,angle:this.labelAngle,text:this.prefix+u+this.suffix,textAlign:this.labelTextAlign,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this._labels.push({position:d,textBlock:u,effectiveHeight:null}))}}else for(this.intervalStartPosition=this.getLabelStartPoint(new Date(this.viewportMinimum),this.intervalType,this.interval),x=b(new Date(this.viewportMaximum),this.interval,this.intervalType),C=k,g=this.intervalStartPosition;g<x;b(g,o,this.intervalType)){for(u=g.getTime();C<M.length&&u>M[C].endValue;C++);d=u,(u=C<M.length&&u>=M[C].startValue&&u<=M[C].endValue)||(u=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:new Date(d),label:this.labels[d]?this.labels[d]:null}):"axisX"===this.type&&this.labels[d]?this.labels[d]:_o(d,this.valueFormatString,this.chart._cultureInfo),u=new Ri(this.ctx,{x:0,y:0,maxWidth:w,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,maxHeight:D,angle:this.labelAngle,text:this.prefix+u+this.suffix,textAlign:this.labelTextAlign,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this._labels.push({position:d,textBlock:u,effectiveHeight:null,breaksLabelType:void 0}))}for("bottom"===this._position||"top"===this._position?(y=this.logarithmic&&!this.equidistantInterval&&2<=this._labels.length?this.lineCoordinates.width*Math.log(Math.min(this._labels[this._labels.length-1].position/this._labels[this._labels.length-2].position,this._labels[1].position/this._labels[0].position))/Math.log(this.range):this.lineCoordinates.width/(this.logarithmic&&this.equidistantInterval?Math.log(this.range)/Math.log(this.logarithmBase):Math.abs(this.range))*Pi[this.intervalType+"Duration"]*this.interval,w=typeof this.options.labelMaxWidth>"u"?.5*this.chart.width>>0:this.options.labelMaxWidth,this.chart.panEnabled||(D=typeof this.options.labelWrap>"u"||this.labelWrap?.8*this.chart.height>>0:1.5*this.labelFontSize)):("left"===this._position||"right"===this._position)&&(y=this.logarithmic&&!this.equidistantInterval&&2<=this._labels.length?this.lineCoordinates.height*Math.log(Math.min(this._labels[this._labels.length-1].position/this._labels[this._labels.length-2].position,this._labels[1].position/this._labels[0].position))/Math.log(this.range):this.lineCoordinates.height/(this.logarithmic&&this.equidistantInterval?Math.log(this.range)/Math.log(this.logarithmBase):Math.abs(this.range))*Pi[this.intervalType+"Duration"]*this.interval,this.chart.panEnabled||(w=typeof this.options.labelMaxWidth>"u"?.3*this.chart.width>>0:this.options.labelMaxWidth),D=typeof this.options.labelWrap>"u"||this.labelWrap?.3*this.chart.height>>0:1.5*this.labelFontSize),o=0;o<this._labels.length;o++){(u=this._labels[o].textBlock).maxWidth=w,u.maxHeight=D;var R=u.measureText();f=R.height}if(x=[],k=M=0,this.labelAutoFit||this.options.labelAutoFit)if($t(this.labelAngle)||(this.labelAngle=(this.labelAngle%360+360)%360,90<this.labelAngle&&270>this.labelAngle?this.labelAngle-=180:270<=this.labelAngle&&360>=this.labelAngle&&(this.labelAngle-=360)),"bottom"===this._position||"top"===this._position)if(w=.9*y>>0,k=0,!this.chart.panEnabled&&1<=this._labels.length){for(this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelMaxWidth=w,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelWrap=this.labelWrap,g=0;g<this._labels.length;g++)if(!this._labels[g].breaksLabelType){var B;for(C=(u=this._labels[g].textBlock).text.split(" "),o=0;o<C.length;o++)d=C[o],this.ctx.font=u.fontStyle+" "+u.fontWeight+" "+u.fontSize+"px "+u.fontFamily,(d=this.ctx.measureText(d)).width>k&&(B=g,k=d.width)}for(g=0,g=this.intervalStartPosition<this.viewportMinimum?1:0;g<this._labels.length;g++)if(!this._labels[g].breaksLabelType){for(R=(u=this._labels[g].textBlock).measureText(),C=g+1;C<this._labels.length;C++)if(!this._labels[C].breaksLabelType){I=(I=this._labels[C].textBlock).measureText();break}if(x.push(u.height),this.sessionVariables.labelMaxHeight=Math.max.apply(Math,x),Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.sin(Math.PI/180*Math.abs(this.labelAngle)),o=w*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(D-u.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)),$t(this.options.labelAngle)&&isNaN(this.options.labelAngle)&&0!==this.options.labelAngle)if(this.sessionVariables.labelMaxHeight=0===this.labelAngle?D:Math.min((o-w*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)),o),d=(c-(f+u.fontSize/2)*Math.cos(Math.PI/180*Math.abs(-25)))/Math.sin(Math.PI/180*Math.abs(-25)),$t(this.options.labelWrap)){if($t(this.options.labelWrap))if($t(this.options.labelMaxWidth)){if(!$t(I))if(o=R.width+I.width>>0,C=this.labelFontSize,k<w)o-2*w>M&&(M=o-2*w,o>=2*w&&o<2.2*w?(this.sessionVariables.labelMaxWidth=w,$t(this.options.labelFontSize)&&12<C&&(C=Math.floor(12/13*C),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?C:this.options.labelFontSize,this.sessionVariables.labelAngle=this.labelAngle):o>=2.2*w&&o<2.8*w?(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelFontSize=C):o>=2.8*w&&o<3.2*w?(this.sessionVariables.labelMaxWidth=Math.max(w,k),this.sessionVariables.labelWrap=!0,$t(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?C:this.options.labelFontSize,this.sessionVariables.labelAngle=this.labelAngle):o>=3.2*w&&o<3.6*w?(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelFontSize=this.labelFontSize):o>3.6*w&&o<5*w?($t(this.options.labelFontSize)&&12<C&&(C=Math.floor(12/13*C),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?C:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=d):o>5*w&&(this.sessionVariables.labelWrap=!0,this.sessionVariables.labelMaxWidth=w,this.sessionVariables.labelFontSize=C,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelAngle=this.labelAngle));else if(B===g&&(0===B&&k+this._labels[B+1].textBlock.measureText().width-2*w>M||B===this._labels.length-1&&k+this._labels[B-1].textBlock.measureText().width-2*w>M||0<B&&B<this._labels.length-1&&k+this._labels[B+1].textBlock.measureText().width-2*w>M&&k+this._labels[B-1].textBlock.measureText().width-2*w>M))M=0===B?k+this._labels[B+1].textBlock.measureText().width-2*w:k+this._labels[B-1].textBlock.measureText().width-2*w,this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?C:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=d;else if(0===M)for(this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?C:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,o=0;o<this._labels.length;o++)(u=this._labels[o].textBlock).maxWidth=this.sessionVariables.labelMaxWidth=Math.min(Math.max(w,k),d),R=u.measureText(),o<this._labels.length-1&&((I=this._labels[C=o+1].textBlock).maxWidth=this.sessionVariables.labelMaxWidth=Math.min(Math.max(w,k),d),I=I.measureText(),R.width+I.width>>0>2*w&&(this.sessionVariables.labelAngle=-25))}else this.options.labelMaxWidth<w?(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=o):(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=D)}else this.labelWrap?$t(this.options.labelMaxWidth)?(this.sessionVariables.labelMaxWidth=Math.min(Math.max(w,k),d),this.sessionVariables.labelWrap=this.labelWrap,I&&R.width+I.width>>0>2*w&&(this.sessionVariables.labelAngle=-25)):(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelAngle=this.sessionVariables.labelMaxWidth>w?-25:this.sessionVariables.labelAngle):$t(this.options.labelMaxWidth)?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelMaxWidth=w,I&&R.width+I.width>>0>2*w&&(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=d)):(this.sessionVariables.labelAngle=this.sessionVariables.labelMaxWidth>w?-25:this.sessionVariables.labelAngle,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelWrap=this.labelWrap);else this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxHeight=0===this.labelAngle?D:Math.min((o-w*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)),o),d=0!=this.labelAngle?(c-(f+u.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)):w,this.sessionVariables.labelMaxHeight=this.labelWrap?(c-d*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))/Math.cos(Math.PI/180*Math.abs(this.labelAngle)):1.5*this.labelFontSize,$t(this.options.labelWrap)?$t(this.options.labelWrap)&&(this.labelWrap&&!$t(this.options.labelMaxWidth)?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:d,this.sessionVariables.labelMaxHeight=D):(this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelMaxHeight=o<.9*y?.9*y:o,this.sessionVariables.labelWrap=this.labelWrap)):(this.options.labelWrap?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:d):($t(this.options.labelMaxWidth),this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:d,this.sessionVariables.labelWrap=this.labelWrap),this.sessionVariables.labelMaxHeight=D)}for(o=0;o<this._labels.length;o++)(u=this._labels[o].textBlock).maxWidth=this.labelMaxWidth=this.sessionVariables.labelMaxWidth,u.fontSize=this.sessionVariables.labelFontSize,u.angle=this.labelAngle=this.sessionVariables.labelAngle,u.wrap=this.labelWrap=this.sessionVariables.labelWrap,u.maxHeight=this.sessionVariables.labelMaxHeight,u.measureText()}else for(g=0;g<this._labels.length;g++)(u=this._labels[g].textBlock).maxWidth=this.labelMaxWidth=$t(this.options.labelMaxWidth)?$t(this.sessionVariables.labelMaxWidth)?this.sessionVariables.labelMaxWidth=w:this.sessionVariables.labelMaxWidth:this.options.labelMaxWidth,u.fontSize=this.labelFontSize=$t(this.options.labelFontSize)?$t(this.sessionVariables.labelFontSize)?this.sessionVariables.labelFontSize=this.labelFontSize:this.sessionVariables.labelFontSize:this.options.labelFontSize,u.angle=this.labelAngle=$t(this.options.labelAngle)?$t(this.sessionVariables.labelAngle)?this.sessionVariables.labelAngle=this.labelAngle:this.sessionVariables.labelAngle:this.labelAngle,u.wrap=this.labelWrap=$t(this.options.labelWrap)?$t(this.sessionVariables.labelWrap)?this.sessionVariables.labelWrap=this.labelWrap:this.sessionVariables.labelWrap:this.options.labelWrap,u.maxHeight=$t(this.sessionVariables.labelMaxHeight)?this.sessionVariables.labelMaxHeight=D:this.sessionVariables.labelMaxHeight,u.measureText();else if("left"===this._position||"right"===this._position)if(w=$t(this.options.labelMaxWidth)?.3*this.chart.width>>0:this.options.labelMaxWidth,D=typeof this.options.labelWrap>"u"||this.labelWrap?.3*this.chart.height>>0:1.5*this.labelFontSize,!this.chart.panEnabled&&1<=this._labels.length){for(this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelMaxWidth=w,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelAngle=$t(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle,this.sessionVariables.labelWrap=this.labelWrap,g=0;g<this._labels.length;g++)if(!this._labels[g].breaksLabelType){for(R=(u=this._labels[g].textBlock).measureText(),C=g+1;C<this._labels.length;C++)if(!this._labels[C].breaksLabelType){I=(I=this._labels[C].textBlock).measureText();break}x.push(u.height),this.sessionVariables.labelMaxHeight=Math.max.apply(Math,x),o=w*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(D-u.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.sin(Math.PI/180*Math.abs(this.labelAngle)),$t(this.options.labelAngle)&&isNaN(this.options.labelAngle)&&0!==this.options.labelAngle?$t(this.options.labelWrap)?$t(this.options.labelWrap)&&($t(this.options.labelMaxWidth)?$t(I)||(y=R.height+I.height>>0)-2*D>k&&(k=y-2*D,y>=2*D&&y<2.4*D?($t(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),u.measureText()),this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize):y>=2.4*D&&y<2.8*D?(this.sessionVariables.labelMaxHeight=o,this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelWrap=!0):y>=2.8*D&&y<3.2*D?(this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelWrap=!0,$t(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelAngle=$t(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle):y>=3.2*D&&y<3.6*D?(this.sessionVariables.labelMaxHeight=o,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelFontSize=this.labelFontSize):y>3.6*D&&y<10*D?($t(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelMaxWidth=w,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelAngle=$t(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle):y>10*D&&y<50*D&&($t(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),u.measureText()),this.sessionVariables.labelFontSize=$t(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelMaxWidth=w,this.sessionVariables.labelAngle=$t(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle)):(this.sessionVariables.labelMaxHeight=D,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth)):(this.sessionVariables.labelMaxWidth=this.labelWrap||this.labelMaxWidth?this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth:w,this.sessionVariables.labelMaxHeight=D):(this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxWidth=0===this.labelAngle?w:Math.min((o-D*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))/Math.cos(Math.PI/180*Math.abs(this.labelAngle)),D),$t(this.options.labelWrap)?$t(this.options.labelWrap)&&(this.labelWrap&&!$t(this.options.labelMaxWidth)?(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth,this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxHeight=o):(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:w,this.sessionVariables.labelMaxHeight=0===this.labelAngle?D:o,$t(this.options.labelMaxWidth)&&(this.sessionVariables.labelAngle=this.labelAngle))):this.options.labelWrap?(this.sessionVariables.labelMaxHeight=0===this.labelAngle?D:o,this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=w):(this.sessionVariables.labelMaxHeight=D,$t(this.options.labelMaxWidth),this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth,this.sessionVariables.labelWrap=this.labelWrap))}for(o=0;o<this._labels.length;o++)(u=this._labels[o].textBlock).maxWidth=this.labelMaxWidth=this.sessionVariables.labelMaxWidth,u.fontSize=this.labelFontSize=this.sessionVariables.labelFontSize,u.angle=this.labelAngle=this.sessionVariables.labelAngle,u.wrap=this.labelWrap=this.sessionVariables.labelWrap,u.maxHeight=this.sessionVariables.labelMaxHeight,u.measureText()}else for(g=0;g<this._labels.length;g++)(u=this._labels[g].textBlock).maxWidth=this.labelMaxWidth=$t(this.options.labelMaxWidth)?$t(this.sessionVariables.labelMaxWidth)?this.sessionVariables.labelMaxWidth=w:this.sessionVariables.labelMaxWidth:this.options.labelMaxWidth,u.fontSize=this.labelFontSize=$t(this.options.labelFontSize)?$t(this.sessionVariables.labelFontSize)?this.sessionVariables.labelFontSize=this.labelFontSize:this.sessionVariables.labelFontSize:this.options.labelFontSize,u.angle=this.labelAngle=$t(this.options.labelAngle)?$t(this.sessionVariables.labelAngle)?this.sessionVariables.labelAngle=this.labelAngle:this.sessionVariables.labelAngle:this.labelAngle,u.wrap=this.labelWrap=$t(this.options.labelWrap)?$t(this.sessionVariables.labelWrap)?this.sessionVariables.labelWrap=this.labelWrap:this.sessionVariables.labelWrap:this.options.labelWrap,u.maxHeight=$t(this.sessionVariables.labelMaxHeight)?this.sessionVariables.labelMaxHeight=D:this.sessionVariables.labelMaxHeight,u.measureText();for(g=0;g<this.stripLines.length;g++){var O;"outside"===(w=this.stripLines[g]).labelPlacement?(D=this.sessionVariables.labelMaxWidth,("bottom"===this._position||"top"===this._position)&&($t(w.options.labelWrap)&&!$t(this.sessionVariables.stripLineLabelMaxHeight)?O=this.sessionVariables.stripLineLabelMaxHeight:this.sessionVariables.stripLineLabelMaxHeight=O=w.labelWrap?.8*this.chart.height>>0:1.5*this.labelFontSize),("left"===this._position||"right"===this._position)&&($t(w.options.labelWrap)&&!$t(this.sessionVariables.stripLineLabelMaxHeight)?O=this.sessionVariables.stripLineLabelMaxHeight:this.sessionVariables.stripLineLabelMaxHeight=O=w.labelWrap?.8*this.chart.width>>0:1.5*this.labelFontSize),$t(w.labelBackgroundColor)&&(w.labelBackgroundColor="#EEEEEE")):(D="bottom"===this._position||"top"===this._position?.9*this.chart.width>>0:.9*this.chart.height>>0,O=$t(w.options.labelWrap)||w.labelWrap?"bottom"===this._position||"top"===this._position?.8*this.chart.width>>0:.8*this.chart.height>>0:1.5*this.labelFontSize,$t(w.labelBackgroundColor)&&(w.labelBackgroundColor=$t(w.startValue)&&0!==w.startValue?oe?"transparent":null:"#EEEEEE")),u=new Ri(this.ctx,{x:0,y:0,backgroundColor:w.labelBackgroundColor,borderColor:w.labelBorderColor,borderThickness:w.labelBorderThickness,cornerRadius:w.labelCornerRadius,maxWidth:w.options.labelMaxWidth?w.options.labelMaxWidth:D,maxHeight:O,angle:this.labelAngle,text:w.labelFormatter?w.labelFormatter({chart:this.chart,axis:this,stripLine:w}):w.label,textAlign:this.labelTextAlign,fontSize:"outside"===w.labelPlacement?w.options.labelFontSize?w.labelFontSize:this.labelFontSize:w.labelFontSize,fontFamily:"outside"===w.labelPlacement?w.options.labelFontFamily?w.labelFontFamily:this.labelFontFamily:w.labelFontFamily,fontWeight:"outside"===w.labelPlacement?w.options.labelFontWeight?w.labelFontWeight:this.labelFontWeight:w.labelFontWeight,fontColor:w.labelFontColor||w.color,fontStyle:"outside"===w.labelPlacement?w.options.labelFontStyle?w.labelFontStyle:this.fontWeight:w.labelFontStyle,textBaseline:"middle"}),this._stripLineLabels.push({position:w.value,textBlock:u,effectiveHeight:null,stripLine:w})}},Q.prototype.createLabelsAndCalculateWidth=function(){var u=0,I=0;this._labels=[],this._stripLineLabels=[];var g=this.chart.isNavigator?0:5;if("left"===this._position||"right"===this._position){if(this.createLabels(),"inside"!=this.labelPlacement||"inside"===this.labelPlacement&&0<this._index)for(I=0;I<this._labels.length;I++){var x=this._labels[I].textBlock,w=x.measureText(),D=0;u<(D=0===this.labelAngle?w.width:w.width*Math.cos(Math.PI/180*Math.abs(this.labelAngle))+(w.height-x.fontSize/2)*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))&&(u=D),this._labels[I].effectiveWidth=D}for(I=0;I<this._stripLineLabels.length;I++)"outside"===this._stripLineLabels[I].stripLine.labelPlacement&&this._stripLineLabels[I].stripLine.value>=this.viewportMinimum&&this._stripLineLabels[I].stripLine.value<=this.viewportMaximum&&(w=(x=this._stripLineLabels[I].textBlock).measureText(),u<(D=0===this.labelAngle?w.width:w.width*Math.cos(Math.PI/180*Math.abs(this.labelAngle))+(w.height-x.fontSize/2)*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))&&(u=D),this._stripLineLabels[I].effectiveWidth=D)}return(this.title?this._titleTextBlock.measureText().height+2:0)+u+("inside"===this.tickPlacement?0:this.tickLength)+g},Q.prototype.createLabelsAndCalculateHeight=function(){var u=0;this._labels=[],this._stripLineLabels=[];var I,g=0,x=this.chart.isNavigator?0:5;if("bottom"===this._position||"top"===this._position){if(this.createLabels(),"inside"!=this.labelPlacement||"inside"===this.labelPlacement&&0<this._index)for(g=0;g<this._labels.length;g++){var w=(I=this._labels[g].textBlock).measureText(),D=0;u<(D=0===this.labelAngle?w.height:w.width*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(w.height-I.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))&&(u=D),this._labels[g].effectiveHeight=D}for(g=0;g<this._stripLineLabels.length;g++)"outside"===this._stripLineLabels[g].stripLine.labelPlacement&&this._stripLineLabels[g].stripLine.value>=this.viewportMinimum&&this._stripLineLabels[g].stripLine.value<=this.viewportMaximum&&(w=(I=this._stripLineLabels[g].textBlock).measureText(),u<(D=0===this.labelAngle?w.height:w.width*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(w.height-I.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))&&(u=D),this._stripLineLabels[g].effectiveHeight=D)}return(this.title?this._titleTextBlock.measureText().height+2:0)+u+("inside"===this.tickPlacement?0:this.tickLength)+x},Q.setLayout=function(u,I,g,x,w,D){var o,y,f,c,d=u[0]?u[0].chart:I[0].chart,M=d.isNavigator?0:10,k=d._axes;if(u&&0<u.length)for(var C=0;C<u.length;C++)u[C]&&u[C].calculateAxisParameters();if(I&&0<I.length)for(C=0;C<I.length;C++)I[C].calculateAxisParameters();if(g&&0<g.length)for(C=0;C<g.length;C++)g[C].calculateAxisParameters();if(x&&0<x.length)for(C=0;C<x.length;C++)x[C].calculateAxisParameters();for(C=0;C<k.length;C++)if(k[C]&&k[C].scaleBreaks&&k[C].scaleBreaks._appliedBreaks.length)for(var R=k[C].scaleBreaks._appliedBreaks,B=0;B<R.length&&!(R[B].startValue>k[C].viewportMaximum);B++)R[B].endValue<k[C].viewportMinimum||($t(k[C].scaleBreaks.firstBreakIndex)&&(k[C].scaleBreaks.firstBreakIndex=B),R[B].startValue>=k[C].viewPortMinimum&&(k[C].scaleBreaks.lastBreakIndex=B));var J,q,dt,gt,kt,O=B=0,L=0,X=0,E=0,Y=0,it=0,nt=y=0;for(R=dt=gt=kt=!1,C=0;C<k.length;C++)k[C]&&k[C].title&&(k[C]._titleTextBlock=new Ri(k[C].ctx,{text:k[C].title,horizontalAlign:"center",fontSize:k[C].titleFontSize,fontFamily:k[C].titleFontFamily,fontWeight:k[C].titleFontWeight,fontColor:k[C].titleFontColor,fontStyle:k[C].titleFontStyle,borderColor:k[C].titleBorderColor,borderThickness:k[C].titleBorderThickness,backgroundColor:k[C].titleBackgroundColor,cornerRadius:k[C].titleCornerRadius,textBaseline:"top"}));for(C=0;C<k.length;C++)if(k[C].title)switch(k[C]._position){case"left":k[C]._titleTextBlock.maxWidth=k[C].titleMaxWidth||D.height,k[C]._titleTextBlock.maxHeight=k[C].titleWrap?.8*D.width:1.5*k[C].titleFontSize,k[C]._titleTextBlock.angle=-90;break;case"right":k[C]._titleTextBlock.maxWidth=k[C].titleMaxWidth||D.height,k[C]._titleTextBlock.maxHeight=k[C].titleWrap?.8*D.width:1.5*k[C].titleFontSize,k[C]._titleTextBlock.angle=90;break;default:k[C]._titleTextBlock.maxWidth=k[C].titleMaxWidth||D.width,k[C]._titleTextBlock.maxHeight=k[C].titleWrap?.8*D.height:1.5*k[C].titleFontSize,k[C]._titleTextBlock.angle=0}if("normal"===w){X=[],E=[],Y=[],it=[];for(var mt=[],Tt=[],ee=[],Ft=[];4>B;){var vt=0,le=0,Ht=0,jt=0,ye=w=0,Rt=0,se=0,Ue=0,ni=0,li=0,$i=0;if(g&&0<g.length)for(Y=[],C=li=0;C<g.length;C++)Y.push(Math.ceil(g[C]?g[C].createLabelsAndCalculateWidth():0)),li+=Y[C],Rt+=g[C]&&!d.isNavigator?g[C].margin:0;else Y.push(Math.ceil(g[0]?g[0].createLabelsAndCalculateWidth():0));if(ee.push(Y),x&&0<x.length)for(it=[],C=$i=0;C<x.length;C++)it.push(Math.ceil(x[C]?x[C].createLabelsAndCalculateWidth():0)),$i+=it[C],se+=x[C]?x[C].margin:0;else it.push(Math.ceil(x[0]?x[0].createLabelsAndCalculateWidth():0));if(Ft.push(it),o=Math.round(D.x1+li+Rt),f=Math.round(D.x2-$i-se>d.width-M?d.width-M:D.x2-$i-se),u&&0<u.length)for(X=[],C=Ue=0;C<u.length;C++)u[C]&&(u[C].lineCoordinates={}),u[C].lineCoordinates.width=Math.abs(f-o),u[C].title&&(u[C]._titleTextBlock.maxWidth=0<u[C].titleMaxWidth&&u[C].titleMaxWidth<u[C].lineCoordinates.width?u[C].titleMaxWidth:u[C].lineCoordinates.width),X.push(Math.ceil(u[C]?u[C].createLabelsAndCalculateHeight():0)),Ue+=X[C],w+=u[C]&&!d.isNavigator?u[C].margin:0;else X.push(Math.ceil(u[0]?u[0].createLabelsAndCalculateHeight():0));if(mt.push(X),I&&0<I.length)for(E=[],C=ni=0;C<I.length;C++)I[C]&&(I[C].lineCoordinates={}),I[C].lineCoordinates.width=Math.abs(f-o),I[C].title&&(I[C]._titleTextBlock.maxWidth=0<I[C].titleMaxWidth&&I[C].titleMaxWidth<I[C].lineCoordinates.width?I[C].titleMaxWidth:I[C].lineCoordinates.width),E.push(Math.ceil(I[C]?I[C].createLabelsAndCalculateHeight():0)),ni+=E[C],ye+=I[C]&&!d.isNavigator?I[C].margin:0;else E.push(Math.ceil(I[0]?I[0].createLabelsAndCalculateHeight():0));if(Tt.push(E),u&&0<u.length)for(C=0;C<u.length;C++)u[C]&&(u[C].lineCoordinates.x1=o,f=Math.round(D.x2-$i-se>d.width-M?d.width-M:D.x2-$i-se),u[C]._labels&&1<u[C]._labels.length&&(y=c=0,y="dateTime"===u[C].valueType?u[C]._labels[u[C]._labels.length-2]:u[C]._labels[u[C]._labels.length-1],O=(c=u[C]._labels[1]).textBlock.width*Math.cos(Math.PI/180*Math.abs(c.textBlock.angle))+(c.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(c.textBlock.angle)),L=y.textBlock.width*Math.cos(Math.PI/180*Math.abs(y.textBlock.angle))+(y.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(y.textBlock.angle))),!u[C]||!u[C].labelAutoFit||$t(J)||$t(q)||d.isNavigator||d.stockChart||(y=0,0<u[C].labelAngle?q+L>f&&(y+=0<u[C].labelAngle?q+L-f-$i:0):0>u[C].labelAngle?J-O<o&&J-O<u[C].viewportMinimum&&(nt=o-(Rt+u[C].tickLength+Y+J-O+u[C].labelFontSize/2)):0===u[C].labelAngle&&(q+L>f&&(y=q+L/2-f-$i),J-O<o&&J-O<u[C].viewportMinimum&&(nt=o-Rt-u[C].tickLength-Y-J+O/2)),u[C].viewportMaximum===u[C].maximum&&u[C].viewportMinimum===u[C].minimum&&0<u[C].labelAngle&&0<y?f-=y:u[C].viewportMaximum===u[C].maximum&&u[C].viewportMinimum===u[C].minimum&&0>u[C].labelAngle&&0<nt?o+=nt:u[C].viewportMaximum===u[C].maximum&&u[C].viewportMinimum===u[C].minimum&&0===u[C].labelAngle&&(0<nt&&(o+=nt),0<y&&(f-=y))),d.panEnabled?Ue=$t(d.sessionVariables.axisX.height)?d.sessionVariables.axisX.height=Ue:d.sessionVariables.axisX.height:d.sessionVariables.axisX.height=Ue,y=Math.round(D.y2-Ue-w+vt),c=Math.round(D.y2),u[C].lineCoordinates.x2=f,u[C].lineCoordinates.width=f-o,u[C].lineCoordinates.y1=y,u[C].lineCoordinates.y2=y+u[C].lineThickness/2,"inside"===u[C].labelPlacement&&0<C&&(u[C].lineCoordinates.y1=u[C].lineCoordinates.y1+X[C]-(u[C]._titleTextBlock?u[C]._titleTextBlock.height:0)-("inside"===u[C].tickPlacement?u[C].tickLength:0),u[C].lineCoordinates.y2=u[C].lineCoordinates.y1+u[C].lineThickness/2),u[C].bounds={x1:o,y1:y,x2:f,y2:c-(Ue+w-X[C]-vt),width:f-o,height:c-y}),vt+=X[C]+u[C].margin;if(I&&0<I.length)for(C=0;C<I.length;C++)I[C].lineCoordinates.x1=Math.round(D.x1+li+Rt),I[C].lineCoordinates.x2=Math.round(D.x2-$i-se>d.width-M?d.width-M:D.x2-$i-se),I[C].lineCoordinates.width=Math.abs(f-o),I[C]._labels&&1<I[C]._labels.length&&(y="dateTime"===I[C].valueType?I[C]._labels[I[C]._labels.length-2]:I[C]._labels[I[C]._labels.length-1],O=(c=I[C]._labels[1]).textBlock.width*Math.cos(Math.PI/180*Math.abs(c.textBlock.angle))+(c.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(c.textBlock.angle)),L=y.textBlock.width*Math.cos(Math.PI/180*Math.abs(y.textBlock.angle))+(y.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(y.textBlock.angle))),d.panEnabled?ni=$t(d.sessionVariables.axisX2.height)?d.sessionVariables.axisX2.height=ni:d.sessionVariables.axisX2.height:d.sessionVariables.axisX2.height=ni,y=Math.round(D.y1),c=Math.round(D.y2+I[C].margin),I[C].lineCoordinates.y1=y+ni+ye-le,I[C].lineCoordinates.y2=y,"inside"===I[C].labelPlacement&&0<C&&(I[C].lineCoordinates.y1=I[C-1].bounds.y1-E[C]+(I[C]._titleTextBlock?I[C]._titleTextBlock.height:0)),I[C].bounds={x1:o,y1:y+(ni+ye-E[C]-le),x2:f,y2:c,width:f-o,height:c-y},le+=E[C]+I[C].margin;if(g&&0<g.length)for(C=0;C<g.length;C++)Rt=d.isNavigator?0:10,g[C]&&(o=Math.round(u[0]?u[0].lineCoordinates.x1:I[0].lineCoordinates.x1),Rt=g[C]._labels&&0<g[C]._labels.length?g[C]._labels[g[C]._labels.length-1].textBlock.height/2:M,y=Math.round(D.y1+ni+ye<Math.max(Rt,M)?Math.max(Rt,M):D.y1+ni+ye),f=Math.round(u[0]?u[0].lineCoordinates.x1:I[0].lineCoordinates.x1),Rt=0<u.length?0:g[C]._labels&&0<g[C]._labels.length?g[C]._labels[0].textBlock.height/2:M,c=Math.round(D.y2-Ue-w-Rt),g[C].lineCoordinates={x1:o-Ht,y1:y,x2:f-Ht,y2:c,height:Math.abs(c-y)},"inside"===g[C].labelPlacement&&0<C&&(g[C].lineCoordinates.x1=g[C].lineCoordinates.x1-(Y[C]-(g[C]._titleTextBlock?g[C]._titleTextBlock.height:0))+("outside"===g[C].tickPlacement?g[C].tickLength:0),g[C].lineCoordinates.x2=g[C].lineCoordinates.x1+g[C].lineThickness/2),g[C].bounds={x1:o-(Y[C]+Ht),y1:y,x2:f,y2:c,width:f-o,height:c-y},g[C].title&&(g[C]._titleTextBlock.maxWidth=0<g[C].titleMaxWidth&&g[C].titleMaxWidth<g[C].lineCoordinates.height?g[C].titleMaxWidth:g[C].lineCoordinates.height),Ht+=Y[C]+g[C].margin);if(x&&0<x.length)for(C=0;C<x.length;C++)x[C]&&(o=Math.round(u[0]?u[0].lineCoordinates.x2:I[0].lineCoordinates.x2),f=Math.round(o),Rt=x[C]._labels&&0<x[C]._labels.length?x[C]._labels[x[C]._labels.length-1].textBlock.height/2:0,y=Math.round(D.y1+ni+ye<Math.max(Rt,M)?Math.max(Rt,M):D.y1+ni+ye),Rt=0<u.length?0:x[C]._labels&&0<x[C]._labels.length?x[C]._labels[0].textBlock.height/2:0,c=Math.round(D.y2-(Ue+w+Rt)),x[C].lineCoordinates={x1:o+jt,y1:y,x2:o+jt,y2:c,height:Math.abs(c-y)},"inside"===x[C].labelPlacement&&0<C&&(x[C].lineCoordinates.x1=x[C].lineCoordinates.x1+(it[C]-(x[C]._titleTextBlock?x[C]._titleTextBlock.height:0))-("outside"===x[C].tickPlacement?x[C].tickLength:0)-2,x[C].lineCoordinates.x2=x[C].lineCoordinates.x1+x[C].lineThickness/2),x[C].bounds={x1:o,y1:y,x2:f+(it[C]+jt),y2:c,width:f-o,height:c-y},x[C].title&&(x[C]._titleTextBlock.maxWidth=0<x[C].titleMaxWidth&&x[C].titleMaxWidth<x[C].lineCoordinates.height?x[C].titleMaxWidth:x[C].lineCoordinates.height),jt+=it[C]+x[C].margin);if(u&&0<u.length)for(C=0;C<u.length;C++)u[C]&&(u[C].calculateValueToPixelConversionParameters(),u[C].calculateBreaksSizeInValues(),u[C]._labels&&1<u[C]._labels.length&&(J=(u[C].logarithmic?Math.log(u[C]._labels[1].position/u[C].viewportMinimum)/u[C].conversionParameters.lnLogarithmBase:u[C]._labels[1].position-u[C].viewportMinimum)*Math.abs(u[C].conversionParameters.pixelPerUnit)+u[C].lineCoordinates.x1,o=u[C].getApparentDifference(u[C].viewportMinimum,o=u[C]._labels[u[C]._labels.length-("dateTime"===u[C].valueType?2:1)].position),q=u[C].logarithmic?(1<o?Math.log(o)/u[C].conversionParameters.lnLogarithmBase*Math.abs(u[C].conversionParameters.pixelPerUnit):0)+u[C].lineCoordinates.x1:(0<o?o*Math.abs(u[C].conversionParameters.pixelPerUnit):0)+u[C].lineCoordinates.x1));if(I&&0<I.length)for(C=0;C<I.length;C++)I[C].calculateValueToPixelConversionParameters(),I[C].calculateBreaksSizeInValues(),I[C]._labels&&1<I[C]._labels.length&&(J=(I[C].logarithmic?Math.log(I[C]._labels[1].position/I[C].viewportMinimum)/I[C].conversionParameters.lnLogarithmBase:I[C]._labels[1].position-I[C].viewportMinimum)*Math.abs(I[C].conversionParameters.pixelPerUnit)+I[C].lineCoordinates.x1,o=I[C].getApparentDifference(I[C].viewportMinimum,o=I[C]._labels[I[C]._labels.length-("dateTime"===I[C].valueType?2:1)].position),q=I[C].logarithmic?(1<o?Math.log(o)/I[C].conversionParameters.lnLogarithmBase*Math.abs(I[C].conversionParameters.pixelPerUnit):0)+I[C].lineCoordinates.x1:(0<o?o*Math.abs(I[C].conversionParameters.pixelPerUnit):0)+I[C].lineCoordinates.x1);for(C=0;C<k.length;C++)"axisY"===k[C].type&&(k[C].calculateValueToPixelConversionParameters(),k[C].calculateBreaksSizeInValues());if(0<B){if(u&&0<u.length)for(C=0;C<u.length;C++)R=mt[B-1][C]===mt[B][C];else R=!0;if(I&&0<I.length)for(C=0;C<I.length;C++)dt=Tt[B-1][C]===Tt[B][C];else dt=!0;if(g&&0<g.length)for(C=0;C<g.length;C++)gt=ee[B-1][C]===ee[B][C];else gt=!0;if(x&&0<x.length)for(C=0;C<x.length;C++)kt=Ft[B-1][C]===Ft[B][C];else kt=!0}if(R&&dt&&gt&&kt)break;B++}if(u&&0<u.length)for(C=0;C<u.length;C++)u[C].calculateStripLinesThicknessInValues(),u[C].calculateBreaksInPixels();if(I&&0<I.length)for(C=0;C<I.length;C++)I[C].calculateStripLinesThicknessInValues(),I[C].calculateBreaksInPixels();if(g&&0<g.length)for(C=0;C<g.length;C++)g[C].calculateStripLinesThicknessInValues(),g[C].calculateBreaksInPixels();if(x&&0<x.length)for(C=0;C<x.length;C++)x[C].calculateStripLinesThicknessInValues(),x[C].calculateBreaksInPixels()}else{for(M=[],J=[],nt=[],O=[],q=[],L=[],mt=[],Tt=[];4>B;){if(Ue=jt=le=Ht=se=Rt=ye=w=Ft=ee=vt=ni=0,u&&0<u.length)for(nt=[],C=jt=0;C<u.length;C++)nt.push(Math.ceil(u[C]?u[C].createLabelsAndCalculateWidth():0)),jt+=nt[C],w+=u[C]&&!d.isNavigator?u[C].margin:0;else nt.push(Math.ceil(u[0]?u[0].createLabelsAndCalculateWidth():0));if(mt.push(nt),I&&0<I.length)for(O=[],C=Ue=0;C<I.length;C++)O.push(Math.ceil(I[C]?I[C].createLabelsAndCalculateWidth():0)),Ue+=O[C],ye+=I[C]?I[C].margin:0;else O.push(Math.ceil(I[0]?I[0].createLabelsAndCalculateWidth():0));if(Tt.push(O),g&&0<g.length)for(C=0;C<g.length;C++)g[C].lineCoordinates={},o=Math.round(D.x1+jt+w),f=Math.round(D.x2-Ue-ye>d.width-10?d.width-10:D.x2-Ue-ye),g[C].labelAutoFit&&!$t(X)&&(0<!u.length&&(o=0>g[C].labelAngle?Math.max(o,X):0===g[C].labelAngle?Math.max(o,X/2):o),0<!I.length&&(f=0<g[C].labelAngle||0===g[C].labelAngle?f-E/2:f)),g[C].lineCoordinates.x1=o,g[C].lineCoordinates.x2=f,g[C].lineCoordinates.width=Math.abs(f-o),g[C].title&&(g[C]._titleTextBlock.maxWidth=0<g[C].titleMaxWidth&&g[C].titleMaxWidth<g[C].lineCoordinates.width?g[C].titleMaxWidth:g[C].lineCoordinates.width);if(x&&0<x.length)for(C=0;C<x.length;C++)x[C].lineCoordinates={},o=Math.round(D.x1+jt+w),f=Math.round(D.x2-Ue-ye>x[C].chart.width-10?x[C].chart.width-10:D.x2-Ue-ye),x[C]&&x[C].labelAutoFit&&!$t(Y)&&(0<!u.length&&(o=0<x[C].labelAngle?Math.max(o,Y):0===x[C].labelAngle?Math.max(o,Y/2):o),0<!I.length&&(f-=it/2)),x[C].lineCoordinates.x1=o,x[C].lineCoordinates.x2=f,x[C].lineCoordinates.width=Math.abs(f-o),x[C].title&&(x[C]._titleTextBlock.maxWidth=0<x[C].titleMaxWidth&&x[C].titleMaxWidth<x[C].lineCoordinates.width?x[C].titleMaxWidth:x[C].lineCoordinates.width);if(g&&0<g.length)for(M=[],C=Ht=0;C<g.length;C++)M.push(Math.ceil(g[C]?g[C].createLabelsAndCalculateHeight():0)),Ht+=M[C]+g[C].margin,Rt+=g[C].margin;else M.push(Math.ceil(g[0]?g[0].createLabelsAndCalculateHeight():0));if(q.push(M),x&&0<x.length)for(J=[],C=le=0;C<x.length;C++)J.push(Math.ceil(x[C]?x[C].createLabelsAndCalculateHeight():0)),le+=J[C],se+=x[C].margin;else J.push(Math.ceil(x[0]?x[0].createLabelsAndCalculateHeight():0));if(L.push(J),g&&0<g.length)for(C=0;C<g.length;C++)0<g[C]._labels.length&&(y=g[C]._labels[g[C]._labels.length-1],X=(c=g[C]._labels[0]).textBlock.width*Math.cos(Math.PI/180*Math.abs(c.textBlock.angle))+(c.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(c.textBlock.angle)),E=y.textBlock.width*Math.cos(Math.PI/180*Math.abs(y.textBlock.angle))+(y.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(y.textBlock.angle)));if(x&&0<x.length)for(C=0;C<x.length;C++)x[C]&&0<x[C]._labels.length&&(y=x[C]._labels[x[C]._labels.length-1],Y=(c=x[C]._labels[0]).textBlock.width*Math.cos(Math.PI/180*Math.abs(c.textBlock.angle))+(c.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(c.textBlock.angle)),it=y.textBlock.width*Math.cos(Math.PI/180*Math.abs(y.textBlock.angle))+(y.textBlock.height-y.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(y.textBlock.angle)));if(d.panEnabled)for(C=0;C<g.length;C++)M[C]=$t(d.sessionVariables.axisY.height)?d.sessionVariables.axisY.height=M[C]:d.sessionVariables.axisY.height;else for(C=0;C<g.length;C++)d.sessionVariables.axisY.height=M[C];if(g&&0<g.length)for(C=g.length-1;0<=C;C--)y=Math.round(D.y2),c=Math.round(D.y2>g[C].chart.height?g[C].chart.height:D.y2),g[C].lineCoordinates.y1=y-(M[C]+g[C].margin+ni),g[C].lineCoordinates.y2=y-(M[C]+g[C].margin+ni),"inside"===g[C].labelPlacement&&0<C&&(g[C].lineCoordinates.y1=g[C].lineCoordinates.y1+M[C]-(g[C]._titleTextBlock?g[C]._titleTextBlock.height:0)-("inside"===g[C].tickPlacement?g[C].tickLength:0),g[C].lineCoordinates.y2=g[C].lineCoordinates.y1+g[C].lineThickness/2),g[C].bounds={x1:o,y1:y-(M[C]+ni+g[C].margin),x2:f,y2:c-(ni+g[C].margin),width:f-o,height:M[C]},g[C].title&&(g[C]._titleTextBlock.maxWidth=0<g[C].titleMaxWidth&&g[C].titleMaxWidth<g[C].lineCoordinates.width?g[C].titleMaxWidth:g[C].lineCoordinates.width),ni+=M[C]+g[C].margin;if(x&&0<x.length)for(C=x.length-1;0<=C;C--)x[C]&&(y=Math.round(D.y1),c=Math.round(D.y1+(J[C]+x[C].margin+vt)),x[C].lineCoordinates.y1=c,x[C].lineCoordinates.y2=c,"inside"===x[C].labelPlacement&&0<C&&(x[C].lineCoordinates.y1=c-J[C]+(x[C]._titleTextBlock?x[C]._titleTextBlock.height:0)),x[C].bounds={x1:o,y1:y+(x[C].margin+vt),x2:f,y2:c,width:f-o,height:le},x[C].title&&(x[C]._titleTextBlock.maxWidth=0<x[C].titleMaxWidth&&x[C].titleMaxWidth<x[C].lineCoordinates.width?x[C].titleMaxWidth:x[C].lineCoordinates.width),vt+=J[C]+x[C].margin);if(u&&0<u.length)for(C=0;C<u.length;C++){if(Rt=u[C]._labels&&0<u[C]._labels.length?u[C]._labels[0].textBlock.fontSize/2:0,o=Math.round(D.x1+w),y=x&&0<x.length?Math.round(x[0]?x[0].lineCoordinates.y2:D.y1<Math.max(Rt,10)?Math.max(Rt,10):D.y1):D.y1<Math.max(Rt,10)?Math.max(Rt,10):D.y1,f=Math.round(D.x1+jt+w),c=g&&0<g.length?Math.round(g[0]?g[0].lineCoordinates.y1:D.y2-Ht>d.height-Math.max(Rt,10)?d.height-Math.max(Rt,10):D.y2-Ht):D.y2>d.height-Math.max(Rt,10)?d.height-Math.max(Rt,10):D.y2,g&&0<g.length)for(Rt=0;Rt<g.length;Rt++)g[Rt]&&g[Rt].labelAutoFit&&(f=0>g[Rt].labelAngle?Math.max(f,X):0===g[Rt].labelAngle?Math.max(f,X/2):f,o=0>g[Rt].labelAngle||0===g[Rt].labelAngle?f-jt:o);if(x&&0<x.length)for(Rt=0;Rt<x.length;Rt++)x[Rt]&&x[Rt].labelAutoFit&&(o=(f=x[Rt].lineCoordinates.x1)-jt);u[C].lineCoordinates={x1:f-ee,y1:y,x2:f-ee,y2:c,height:Math.abs(c-y)},"inside"===u[C].labelPlacement&&0<C&&(u[C].lineCoordinates.x1=u[C].lineCoordinates.x1-(nt[C]-(u[C]._titleTextBlock?u[C]._titleTextBlock.height:0))+("outside"===u[C].tickPlacement?u[C].tickLength:0),u[C].lineCoordinates.x2=u[C].lineCoordinates.x1+u[C].lineThickness/2),u[C].bounds={x1:f-(nt[C]+ee),y1:y,x2:f,y2:c,width:f-o,height:c-y},u[C].title&&(u[C]._titleTextBlock.maxWidth=0<u[C].titleMaxWidth&&u[C].titleMaxWidth<u[C].lineCoordinates.height?u[C].titleMaxWidth:u[C].lineCoordinates.height),u[C].calculateValueToPixelConversionParameters(),u[C].calculateBreaksSizeInValues(),ee+=nt[C]+u[C].margin}if(I&&0<I.length)for(C=0;C<I.length;C++){if(Rt=I[C]._labels&&0<I[C]._labels.length?I[C]._labels[0].textBlock.fontSize/2:0,o=Math.round(D.x1-w),y=x&&0<x.length?Math.round(x[0]?x[0].lineCoordinates.y2:D.y1<Math.max(Rt,10)?Math.max(Rt,10):D.y1):D.y1<Math.max(Rt,10)?Math.max(Rt,10):D.y1,f=Math.round(D.x2-Ue-ye),c=g&&0<g.length?Math.round(g[0]?g[0].lineCoordinates.y1:D.y2-Ht>d.height-Math.max(Rt,10)?d.height-Math.max(Rt,10):D.y2-Ht):D.y2>d.height-Math.max(Rt,10)?d.height-Math.max(Rt,10):D.y2,g&&0<g.length)for(Rt=0;Rt<g.length;Rt++)g[Rt]&&g[Rt].labelAutoFit&&(f=0>g[Rt].labelAngle?Math.max(f,X):0===g[Rt].labelAngle?Math.max(f,X/2):f,o=0>g[Rt].labelAngle||0===g[Rt].labelAngle?f-Ue:o);if(x&&0<x.length)for(Rt=0;Rt<x.length;Rt++)x[Rt]&&x[Rt].labelAutoFit&&(o=(f=x[Rt].lineCoordinates.x2)-Ue);I[C].lineCoordinates={x1:f+Ft,y1:y,x2:f+Ft,y2:c,height:Math.abs(c-y)},"inside"===I[C].labelPlacement&&0<C&&(I[C].lineCoordinates.x1=I[C].lineCoordinates.x1+(O[C]-(I[C]._titleTextBlock?I[C]._titleTextBlock.height:0)-2)-("outside"===I[C].tickPlacement?I[C].tickLength:0),I[C].lineCoordinates.x2=I[C].lineCoordinates.x1+I[C].lineThickness/2),I[C].bounds={x1:I[C].lineCoordinates.x1,y1:y,x2:f+O[C]+Ft,y2:c,width:f-o,height:c-y},I[C].title&&(I[C]._titleTextBlock.maxWidth=0<I[C].titleMaxWidth&&I[C].titleMaxWidth<I[C].lineCoordinates.height?I[C].titleMaxWidth:I[C].lineCoordinates.height),I[C].calculateValueToPixelConversionParameters(),I[C].calculateBreaksSizeInValues(),Ft+=O[C]+I[C].margin}for(C=0;C<k.length;C++)"axisY"===k[C].type&&(k[C].calculateValueToPixelConversionParameters(),k[C].calculateBreaksSizeInValues());if(0<B){if(u&&0<u.length)for(C=0;C<u.length;C++)R=mt[B-1][C]===mt[B][C];else R=!0;if(I&&0<I.length)for(C=0;C<I.length;C++)dt=Tt[B-1][C]===Tt[B][C];else dt=!0;if(g&&0<g.length)for(C=0;C<g.length;C++)gt=q[B-1][C]===q[B][C];else gt=!0;if(x&&0<x.length)for(C=0;C<x.length;C++)kt=L[B-1][C]===L[B][C];else kt=!0}if(R&&dt&&gt&&kt)break;B++}if(g&&0<g.length)for(C=0;C<g.length;C++)g[C].calculateStripLinesThicknessInValues(),g[C].calculateBreaksInPixels();if(x&&0<x.length)for(C=0;C<x.length;C++)x[C].calculateStripLinesThicknessInValues(),x[C].calculateBreaksInPixels();if(u&&0<u.length)for(C=0;C<u.length;C++)u[C].calculateStripLinesThicknessInValues(),u[C].calculateBreaksInPixels();if(I&&0<I.length)for(C=0;C<I.length;C++)I[C].calculateStripLinesThicknessInValues(),I[C].calculateBreaksInPixels()}},Q.render=function(u,I,g,x,w){var D=u[0]?u[0].chart:I[0].chart;if(w=D.ctx,D.alignVerticalAxes&&D.alignVerticalAxes(),w.save(),w.beginPath(),u[0]&&w.rect(5,u[0].bounds.y1,u[0].chart.width-10,u[0].bounds.height),I[0]&&w.rect(5,I[I.length-1].bounds.y1,I[0].chart.width-10,I[0].bounds.height),w.clip(),u&&0<u.length)for(var o=0;o<u.length;o++)u[o].renderLabelsTicksAndTitle();if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderLabelsTicksAndTitle();if(w.restore(),g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderLabelsTicksAndTitle();if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderLabelsTicksAndTitle();if(D.preparePlotArea(),D=D.plotArea,w.save(),w.beginPath(),w.rect(D.x1,D.y1,Math.abs(D.x2-D.x1),Math.abs(D.y2-D.y1)),w.clip(),u&&0<u.length)for(o=0;o<u.length;o++)u[o].renderStripLinesOfThicknessType("value");if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderStripLinesOfThicknessType("value");if(g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderStripLinesOfThicknessType("value");if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderStripLinesOfThicknessType("value");if(u&&0<u.length)for(o=0;o<u.length;o++)u[o].renderInterlacedColors();if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderInterlacedColors();if(g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderInterlacedColors();if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderInterlacedColors();if(w.restore(),u&&0<u.length)for(o=0;o<u.length;o++)u[o].renderGrid(),oe&&(u[o].createMask(),u[o].renderBreaksBackground());if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderGrid(),oe&&(I[o].createMask(),I[o].renderBreaksBackground());if(g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderGrid(),oe&&(g[o].createMask(),g[o].renderBreaksBackground());if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderGrid(),oe&&(x[o].createMask(),x[o].renderBreaksBackground());if(u&&0<u.length)for(o=0;o<u.length;o++)u[o].renderAxisLine();if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderAxisLine();if(g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderAxisLine();if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderAxisLine();if(u&&0<u.length)for(o=0;o<u.length;o++)u[o].renderStripLinesOfThicknessType("pixel");if(I&&0<I.length)for(o=0;o<I.length;o++)I[o].renderStripLinesOfThicknessType("pixel");if(g&&0<g.length)for(o=0;o<g.length;o++)g[o].renderStripLinesOfThicknessType("pixel");if(x&&0<x.length)for(o=0;o<x.length;o++)x[o].renderStripLinesOfThicknessType("pixel")},Q.prototype.calculateStripLinesThicknessInValues=function(){for(var u=0;u<this.stripLines.length;u++)if(null!==this.stripLines[u].startValue&&null!==this.stripLines[u].endValue){var g=Math.min(this.stripLines[u].startValue,this.stripLines[u].endValue),I=Math.max(this.stripLines[u].startValue,this.stripLines[u].endValue);g=this.getApparentDifference(g,I),this.stripLines[u].value=this.logarithmic?this.stripLines[u].value*Math.sqrt(Math.log(Math.max(this.stripLines[u].startValue,this.stripLines[u].endValue)/Math.min(this.stripLines[u].startValue,this.stripLines[u].endValue))/Math.log(g)):this.stripLines[u].value+(Math.abs(this.stripLines[u].endValue-this.stripLines[u].startValue)-g)/2,this.stripLines[u].thickness=g,this.stripLines[u]._thicknessType="value"}},Q.prototype.calculateBreaksSizeInValues=function(){for(var w,u="left"===this._position||"right"===this._position?this.lineCoordinates.height||this.chart.height:this.lineCoordinates.width||this.chart.width,I=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[],g=this.conversionParameters.pixelPerUnit||u/(this.logarithmic?this.conversionParameters.maximum/this.conversionParameters.minimum:this.conversionParameters.maximum-this.conversionParameters.minimum),x=this.scaleBreaks&&!$t(this.scaleBreaks.options.spacing),D=0;D<I.length;D++)w=x||!$t(I[D].options.spacing),I[D].spacing=js(I[D].spacing,u,8,w?.1*u:8,w?0:3)<<0,I[D].size=0>I[D].spacing?0:Math.abs(I[D].spacing/g),this.logarithmic&&(I[D].size=Math.pow(this.logarithmBase,I[D].size))},Q.prototype.calculateBreaksInPixels=function(){if(!(this.scaleBreaks&&0>=this.scaleBreaks._appliedBreaks.length)){var u=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];u.length&&(this.scaleBreaks.firstBreakIndex=this.scaleBreaks.lastBreakIndex=null);for(var I=0;I<u.length&&!(u[I].startValue>this.conversionParameters.maximum);I++)u[I].endValue<this.conversionParameters.minimum||($t(this.scaleBreaks.firstBreakIndex)&&(this.scaleBreaks.firstBreakIndex=I),u[I].startValue>=this.conversionParameters.minimum&&(u[I].startPixel=this.convertValueToPixel(u[I].startValue),this.scaleBreaks.lastBreakIndex=I),u[I].endValue<=this.conversionParameters.maximum&&(u[I].endPixel=this.convertValueToPixel(u[I].endValue)))}},Q.prototype.renderLabelsTicksAndTitle=function(){var M,k,u=this,I=!1,g=0,x=0,w=1,D=0;if(0!==this.labelAngle&&360!==this.labelAngle&&(w=1.2),typeof this.options.interval>"u"){if("bottom"===this._position||"top"===this._position)if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit){g=[],w=0!==this.labelAngle&&360!==this.labelAngle?1:1.2;for(var o,y=this.viewportMaximum,f=this.lineCoordinates.width/Math.log(this.range),d=this._labels.length-1;0<=d&&!((M=this._labels[d]).position<this.viewportMinimum);d--)M.position>this.viewportMaximum||!(d===this._labels.length-1||o<Math.log(y/M.position)*f/w)||(g.push(M),y=M.position,o=M.textBlock.width*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+M.textBlock.height*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));this._labels=g}else{for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||(g+=o=M.textBlock.width*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+M.textBlock.height*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));g>this.lineCoordinates.width*w&&this.labelAutoFit&&(I=!0)}if("left"===this._position||"right"===this._position)if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit){var c;for(g=[],y=this.viewportMaximum,f=this.lineCoordinates.height/Math.log(this.range),d=this._labels.length-1;0<=d&&!((M=this._labels[d]).position<this.viewportMinimum);d--)M.position>this.viewportMaximum||!(d===this._labels.length-1||c<Math.log(y/M.position)*f)||(g.push(M),y=M.position,c=M.textBlock.height*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+M.textBlock.width*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));this._labels=g}else{for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||(x+=c=M.textBlock.height*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+M.textBlock.width*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));x>this.lineCoordinates.height*w&&this.labelAutoFit&&(I=!0)}}if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit&&this._labels.sort(function(C,R){return C.position-R.position}),d=0,"bottom"===this._position){for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||M.position>this.viewportMaximum||(k=this.getPixelCoordinatesOnAxis(M.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,x=this.ctx.lineWidth%2==1?.5+(k.x<<0):k.x<<0,this.ctx.beginPath(),this.ctx.moveTo(x,k.y<<0),this.ctx.lineTo(x,k.y+this.tickLength<<0),this.ctx.stroke()),I&&D++%2!=0&&this.labelAutoFit||(0===M.textBlock.angle?(k.x-=M.textBlock.width/2,k.y="inside"===this.labelPlacement?k.y-(("inside"===this.tickPlacement?this.tickLength:0)+M.textBlock.height-M.textBlock.fontSize/2):k.y+("inside"===this.tickPlacement?0:this.tickLength)+M.textBlock.fontSize/2+5):(k.x="inside"===this.labelPlacement?0>this.labelAngle?k.x:k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):k.x-(0>this.labelAngle?M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),k.y="inside"===this.labelPlacement?0>this.labelAngle?k.y-("inside"===this.tickPlacement?this.tickLength:0)-5:k.y-("inside"===this.tickPlacement?this.tickLength:0)-Math.abs(M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)+5):k.y+("inside"===this.tickPlacement?0:this.tickLength)+Math.abs(0>this.labelAngle?M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)-5:5)),M.textBlock.x=k.x,M.textBlock.y=k.y));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(d=0;d<u._labels.length;d++)if(!((M=u._labels[d]).position<u.viewportMinimum||M.position>u.viewportMaximum)&&(k=u.getPixelCoordinatesOnAxis(M.position),u.tickThickness)){u.ctx.lineWidth=u.tickThickness,u.ctx.strokeStyle=u.tickColor;var C=u.ctx.lineWidth%2==1?.5+(k.x<<0):k.x<<0;u.ctx.save(),u.ctx.beginPath(),u.ctx.moveTo(C,k.y<<0),u.ctx.lineTo(C,k.y-u.tickLength<<0),u.ctx.stroke(),u.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.lineCoordinates.x1+this.lineCoordinates.width/2-this._titleTextBlock.width/2,this._titleTextBlock.y=this.bounds.y2-this._titleTextBlock.height-3,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("top"===this._position){for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||M.position>this.viewportMaximum||(k=this.getPixelCoordinatesOnAxis(M.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,x=this.ctx.lineWidth%2==1?.5+(k.x<<0):k.x<<0,this.ctx.beginPath(),this.ctx.moveTo(x,k.y<<0),this.ctx.lineTo(x,k.y-this.tickLength<<0),this.ctx.stroke()),I&&D++%2!=0&&this.labelAutoFit||(0===M.textBlock.angle?(k.x-=M.textBlock.width/2,k.y="inside"===this.labelPlacement?k.y+this.labelFontSize/2+("inside"===this.tickPlacement?this.tickLength:0)+5:k.y-(("inside"===this.tickPlacement?0:this.tickLength)+M.textBlock.height-M.textBlock.fontSize/2)):(k.x="inside"===this.labelPlacement?0<this.labelAngle?k.x:k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):k.x+(M.textBlock.height-this.labelFontSize)*Math.sin(Math.PI/180*this.labelAngle)-(0<this.labelAngle?M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),k.y="inside"===this.labelPlacement?0<this.labelAngle?k.y+("inside"===this.tickPlacement?this.tickLength:0)+5:k.y-M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)+("inside"===this.tickPlacement?this.tickLength:0)+5:k.y-(("inside"===this.tickPlacement?0:this.tickLength)+((M.textBlock.height-M.textBlock.fontSize/2)*Math.cos(Math.PI/180*this.labelAngle)+(0<this.labelAngle?M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0)))),M.textBlock.x=k.x,M.textBlock.y=k.y));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(d=0;d<u._labels.length;d++)if(!((M=u._labels[d]).position<u.viewportMinimum||M.position>u.viewportMaximum)&&(k=u.getPixelCoordinatesOnAxis(M.position),u.tickThickness)){u.ctx.lineWidth=u.tickThickness,u.ctx.strokeStyle=u.tickColor;var C=u.ctx.lineWidth%2==1?.5+(k.x<<0):k.x<<0;u.ctx.save(),u.ctx.beginPath(),u.ctx.moveTo(C,k.y<<0),u.ctx.lineTo(C,k.y+u.tickLength<<0),u.ctx.stroke(),u.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.lineCoordinates.x1+this.lineCoordinates.width/2-this._titleTextBlock.width/2,this._titleTextBlock.y=this.bounds.y1+1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("left"===this._position){for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||M.position>this.viewportMaximum||(k=this.getPixelCoordinatesOnAxis(M.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,x=this.ctx.lineWidth%2==1?.5+(k.y<<0):k.y<<0,this.ctx.beginPath(),this.ctx.moveTo(k.x<<0,x),this.ctx.lineTo(k.x-this.tickLength<<0,x),this.ctx.stroke()),I&&D++%2!=0&&this.labelAutoFit||(0===this.labelAngle?(M.textBlock.y=k.y,M.textBlock.x="inside"===this.labelPlacement?k.x+("inside"===this.tickPlacement?this.tickLength:0)+5:k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength)-5):(M.textBlock.y="inside"===this.labelPlacement?k.y:k.y-M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle),M.textBlock.x="inside"===this.labelPlacement?k.x+("inside"===this.tickPlacement?this.tickLength:0)+5:0<this.labelAngle?k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength)-5:k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)+(M.textBlock.height-M.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength))));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(d=0;d<u._labels.length;d++)if(!((M=u._labels[d]).position<u.viewportMinimum||M.position>u.viewportMaximum)&&(k=u.getPixelCoordinatesOnAxis(M.position),u.tickThickness)){u.ctx.lineWidth=u.tickThickness,u.ctx.strokeStyle=u.tickColor;var C=u.ctx.lineWidth%2==1?.5+(k.y<<0):k.y<<0;u.ctx.save(),u.ctx.beginPath(),u.ctx.moveTo(k.x<<0,C),u.ctx.lineTo(k.x+u.tickLength<<0,C),u.ctx.stroke(),u.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.bounds.x1+1,this._titleTextBlock.y=this.lineCoordinates.height/2+this._titleTextBlock.width/2+this.lineCoordinates.y1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("right"===this._position){for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||M.position>this.viewportMaximum||(k=this.getPixelCoordinatesOnAxis(M.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,x=this.ctx.lineWidth%2==1?.5+(k.y<<0):k.y<<0,this.ctx.beginPath(),this.ctx.moveTo(k.x<<0,x),this.ctx.lineTo(k.x+this.tickLength<<0,x),this.ctx.stroke()),I&&D++%2!=0&&this.labelAutoFit||(0===this.labelAngle?(M.textBlock.y=k.y,M.textBlock.x="inside"===this.labelPlacement?k.x-M.textBlock.width-("inside"===this.tickPlacement?this.tickLength:0)-5:k.x+("inside"===this.tickPlacement?0:this.tickLength)+5):(M.textBlock.y="inside"===this.labelPlacement?k.y-M.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0>this.labelAngle?k.y:k.y-(M.textBlock.height-M.textBlock.fontSize/2-5)*Math.cos(Math.PI/180*this.labelAngle),M.textBlock.x="inside"===this.labelPlacement?k.x-M.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?this.tickLength:0)-5:0<this.labelAngle?k.x+(M.textBlock.height-M.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)+("inside"===this.tickPlacement?0:this.tickLength):k.x+("inside"===this.tickPlacement?0:this.tickLength)+5)));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(d=0;d<u._labels.length;d++)if(!((M=u._labels[d]).position<u.viewportMinimum||M.position>u.viewportMaximum)&&(k=u.getPixelCoordinatesOnAxis(M.position),u.tickThickness)){u.ctx.lineWidth=u.tickThickness,u.ctx.strokeStyle=u.tickColor;var C=u.ctx.lineWidth%2==1?.5+(k.y<<0):k.y<<0;u.ctx.save(),u.ctx.beginPath(),u.ctx.moveTo(k.x<<0,C),u.ctx.lineTo(k.x-u.tickLength<<0,C),u.ctx.stroke(),u.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.bounds.x2-1,this._titleTextBlock.y=this.lineCoordinates.height/2-this._titleTextBlock.width/2+this.lineCoordinates.y1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}if(D=0,"inside"===this.labelPlacement)this.chart.addEventListener("dataAnimationEnd",function(){for(d=0;d<u._labels.length;d++)(M=u._labels[d]).position<u.viewportMinimum||M.position>u.viewportMaximum||I&&D++%2!=0&&u.labelAutoFit||(u.ctx.save(),u.ctx.beginPath(),M.textBlock.render(!0),u.ctx.restore())},this);else for(d=0;d<this._labels.length;d++)(M=this._labels[d]).position<this.viewportMinimum||M.position>this.viewportMaximum||I&&D++%2!=0&&this.labelAutoFit||M.textBlock.render(!0)},Q.prototype.renderInterlacedColors=function(){var I,g,u=this.chart.plotArea.ctx,x=this.chart.plotArea,w=0;if(I=!0,"bottom"!==this._position&&"top"!==this._position||!this.interlacedColor){if(("left"===this._position||"right"===this._position)&&this.interlacedColor)for(u.fillStyle=this.interlacedColor,w=0;w<this._labels.length;w++)I?(g=this.getPixelCoordinatesOnAxis(this._labels[w].position),I=this.getPixelCoordinatesOnAxis(w+1>this._labels.length-1?this.viewportMaximum:this._labels[w+1].position),u.fillRect(x.x1,Math.min(g.y,I.y),Math.abs(x.x1-x.x2),Math.abs(I.y-g.y)),I=!1):I=!0}else for(u.fillStyle=this.interlacedColor,w=0;w<this._labels.length;w++)I?(I=this.getPixelCoordinatesOnAxis(this._labels[w].position),g=this.getPixelCoordinatesOnAxis(w+1>this._labels.length-1?this.viewportMaximum:this._labels[w+1].position),u.fillRect(Math.min(g.x,I.x),x.y1,Math.abs(g.x-I.x),Math.abs(x.y1-x.y2)),I=!1):I=!0;u.beginPath()},Q.prototype.renderStripLinesOfThicknessType=function(u){if(this.stripLines&&0<this.stripLines.length&&u){var g,I=this,f=0,x=0,w=!1,y=!1,D=[],o=[];for(y=!1,f=0;f<this.stripLines.length;f++){var c=this.stripLines[f];c._thicknessType===u&&("pixel"===u&&(c.value<this.viewportMinimum||c.value>this.viewportMaximum||$t(c.value)||isNaN(this.range))||"value"===u&&(c.startValue<=this.viewportMinimum&&c.endValue<=this.viewportMinimum||c.startValue>=this.viewportMaximum&&c.endValue>=this.viewportMaximum||$t(c.startValue)||$t(c.endValue)||isNaN(this.range))||D.push(c))}for(f=0;f<this._stripLineLabels.length;f++)if(c=this.stripLines[f],!((g=this._stripLineLabels[f]).position<this.viewportMinimum||g.position>this.viewportMaximum||isNaN(this.range))){if(u=this.getPixelCoordinatesOnAxis(g.position),"outside"===g.stripLine.labelPlacement)if(c&&(this.ctx.strokeStyle=c.color,"pixel"===c._thicknessType&&(this.ctx.lineWidth=c.thickness)),"bottom"===this._position){var d=this.ctx.lineWidth%2==1?.5+(u.x<<0):u.x<<0;this.ctx.beginPath(),this.ctx.moveTo(d,u.y<<0),this.ctx.lineTo(d,u.y+this.tickLength<<0),this.ctx.stroke(),0===this.labelAngle?(u.x-=g.textBlock.width/2,u.y+=this.tickLength+g.textBlock.fontSize/2+5):(u.x-=0>this.labelAngle?g.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0,u.y+=this.tickLength+Math.abs(0>this.labelAngle?g.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)-5:5))}else"top"===this._position?(d=this.ctx.lineWidth%2==1?.5+(u.x<<0):u.x<<0,this.ctx.beginPath(),this.ctx.moveTo(d,u.y<<0),this.ctx.lineTo(d,u.y-this.tickLength<<0),this.ctx.stroke(),0===this.labelAngle?(u.x-=g.textBlock.width/2,u.y-=this.tickLength+g.textBlock.height-g.textBlock.fontSize/2):(u.x+=(g.textBlock.height-this.tickLength-this.labelFontSize/2)*Math.sin(Math.PI/180*this.labelAngle)-(0<this.labelAngle?g.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),u.y-=this.tickLength+(g.textBlock.height*Math.cos(Math.PI/180*this.labelAngle)+(0<this.labelAngle?g.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0)))):"left"===this._position?(d=this.ctx.lineWidth%2==1?.5+(u.y<<0):u.y<<0,this.ctx.beginPath(),this.ctx.moveTo(u.x<<0,d),this.ctx.lineTo(u.x-this.tickLength<<0,d),this.ctx.stroke(),0===this.labelAngle?u.x=u.x-g.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-this.tickLength-5:(u.y-=g.textBlock.width*Math.sin(Math.PI/180*this.labelAngle),u.x=0<this.labelAngle?u.x-g.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-this.tickLength-5:u.x-g.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)+(g.textBlock.height-g.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)-this.tickLength)):"right"===this._position&&(d=this.ctx.lineWidth%2==1?.5+(u.y<<0):u.y<<0,this.ctx.beginPath(),this.ctx.moveTo(u.x<<0,d),this.ctx.lineTo(u.x+this.tickLength<<0,d),this.ctx.stroke(),0===this.labelAngle?u.x=u.x+this.tickLength+5:(u.y=0>this.labelAngle?u.y:u.y-(g.textBlock.height-g.textBlock.fontSize/2-5)*Math.cos(Math.PI/180*this.labelAngle),u.x=0<this.labelAngle?u.x+(g.textBlock.height-g.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)+this.tickLength:u.x+this.tickLength+5));else g.textBlock.angle=-90,"bottom"===this._position?(g.textBlock.maxWidth=this.options.stripLines[f].labelMaxWidth?this.options.stripLines[f].labelMaxWidth:this.chart.plotArea.height-3,g.textBlock.measureText(),u.x-g.textBlock.height>this.chart.plotArea.x1?$t(c.startValue)?u.x-=g.textBlock.height-g.textBlock.fontSize/2:u.x-=g.textBlock.height/2-g.textBlock.fontSize/2+3:(g.textBlock.angle=90,$t(c.startValue)?u.x+=g.textBlock.height-g.textBlock.fontSize/2:u.x+=g.textBlock.height/2-g.textBlock.fontSize/2+3),u.y=-90===g.textBlock.angle?"near"===g.stripLine.labelAlign?this.chart.plotArea.y2-3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1+g.textBlock.width)/2:this.chart.plotArea.y1+g.textBlock.width+3:"near"===g.stripLine.labelAlign?this.chart.plotArea.y2-g.textBlock.width-3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1-g.textBlock.width)/2:this.chart.plotArea.y1+3):"top"===this._position?(g.textBlock.maxWidth=this.options.stripLines[f].labelMaxWidth?this.options.stripLines[f].labelMaxWidth:this.chart.plotArea.height-3,g.textBlock.measureText(),u.x-g.textBlock.height>this.chart.plotArea.x1?$t(c.startValue)?u.x-=g.textBlock.height-g.textBlock.fontSize/2:u.x-=g.textBlock.height/2-g.textBlock.fontSize/2+3:(g.textBlock.angle=90,$t(c.startValue)?u.x+=g.textBlock.height-g.textBlock.fontSize/2:u.x+=g.textBlock.height/2-g.textBlock.fontSize/2+3),u.y=-90===g.textBlock.angle?"near"===g.stripLine.labelAlign?this.chart.plotArea.y1+g.textBlock.width+3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1+g.textBlock.width)/2:this.chart.plotArea.y2-3:"near"===g.stripLine.labelAlign?this.chart.plotArea.y1+3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1-g.textBlock.width)/2:this.chart.plotArea.y2-g.textBlock.width-3):"left"===this._position?(g.textBlock.maxWidth=this.options.stripLines[f].labelMaxWidth?this.options.stripLines[f].labelMaxWidth:this.chart.plotArea.width-3,g.textBlock.angle=0,g.textBlock.measureText(),u.y-g.textBlock.height>this.chart.plotArea.y1?$t(c.startValue)?u.y-=g.textBlock.height-g.textBlock.fontSize/2:u.y-=g.textBlock.height/2-g.textBlock.fontSize+3:u.y-g.textBlock.height<this.chart.plotArea.y2?u.y+=g.textBlock.fontSize/2+3:$t(c.startValue)?u.y-=g.textBlock.height-g.textBlock.fontSize/2:u.y-=g.textBlock.height/2-g.textBlock.fontSize+3,u.x="near"===g.stripLine.labelAlign?this.chart.plotArea.x1+3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.x2+this.chart.plotArea.x1)/2-g.textBlock.width/2:this.chart.plotArea.x2-g.textBlock.width-3):"right"===this._position&&(g.textBlock.maxWidth=this.options.stripLines[f].labelMaxWidth?this.options.stripLines[f].labelMaxWidth:this.chart.plotArea.width-3,g.textBlock.angle=0,g.textBlock.measureText(),u.y-+g.textBlock.height>this.chart.plotArea.y1?$t(c.startValue)?u.y-=g.textBlock.height-g.textBlock.fontSize/2:u.y-=g.textBlock.height/2-g.textBlock.fontSize/2-3:u.y-g.textBlock.height<this.chart.plotArea.y2?u.y+=g.textBlock.fontSize/2+3:$t(c.startValue)?u.y-=g.textBlock.height-g.textBlock.fontSize/2:u.y-=g.textBlock.height/2-g.textBlock.fontSize/2+3,u.x="near"===g.stripLine.labelAlign?this.chart.plotArea.x2-g.textBlock.width-3:"center"===g.stripLine.labelAlign?(this.chart.plotArea.x2+this.chart.plotArea.x1)/2-g.textBlock.width/2:this.chart.plotArea.x1+3);g.textBlock.x=u.x,g.textBlock.y=u.y,o.push(g)}if(!y){for(y=!1,this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip(),f=0;f<D.length;f++)(c=D[f]).showOnTop?w||(w=!0,this.chart.addEventListener("dataAnimationIterationEnd",function(){for(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip(),x=0;x<D.length;x++)(c=D[x]).showOnTop&&c.render();this.ctx.restore()},c)):c.render();for(f=0;f<o.length;f++)(g=o[f]).stripLine.showOnTop?y||(y=!0,this.chart.addEventListener("dataAnimationIterationEnd",function(){for(x=0;x<o.length;x++)"inside"===(g=o[x]).stripLine.labelPlacement&&g.stripLine.showOnTop&&(I.ctx.save(),I.ctx.beginPath(),I.ctx.rect(I.chart.plotArea.x1,I.chart.plotArea.y1,I.chart.plotArea.width,I.chart.plotArea.height),I.ctx.clip(),g.textBlock.render(!0),I.ctx.restore())},g.textBlock)):"inside"===g.stripLine.labelPlacement&&g.textBlock.render(!0);this.ctx.restore(),y=!0}if(y)for(y=!1,f=0;f<o.length;f++)"outside"===(g=o[f]).stripLine.labelPlacement&&g.textBlock.render(!0)}},Q.prototype.renderBreaksBackground=function(){this.chart._breaksCanvas&&this.scaleBreaks&&0<this.scaleBreaks._appliedBreaks.length&&this.maskCanvas&&(this.chart._breaksCanvasCtx.save(),this.chart._breaksCanvasCtx.beginPath(),this.chart._breaksCanvasCtx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.chart._breaksCanvasCtx.clip(),this.chart._breaksCanvasCtx.drawImage(this.maskCanvas,0,0,this.chart.width,this.chart.height),this.chart._breaksCanvasCtx.restore())},Q.prototype.createMask=function(){if(this.scaleBreaks&&0<this.scaleBreaks._appliedBreaks.length){var u=this.scaleBreaks._appliedBreaks;oe?(this.maskCanvas=Xi(this.chart.width,this.chart.height),this.maskCtx=this.maskCanvas.getContext("2d")):(this.maskCanvas=this.chart.plotArea.canvas,this.maskCtx=this.chart.plotArea.ctx),this.maskCtx.save(),this.maskCtx.beginPath(),this.maskCtx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.maskCtx.clip();for(var I=0;I<u.length;I++)u[I].endValue<this.viewportMinimum||u[I].startValue>this.viewportMaximum||isNaN(this.range)||u[I].render(this.maskCtx);this.maskCtx.restore()}},Q.prototype.renderCrosshair=function(u,I){isFinite(this.minimum)&&isFinite(this.maximum)&&(this.crosshair.render(u,I),this.crosshair.dispatchEvent("updated",{chart:this.chart,crosshair:this.options,axis:this,value:this.crosshair.value},this))},Q.prototype.showCrosshair=function(u){$t(u)||u<this.viewportMinimum||u>this.viewportMaximum||("top"===this._position||"bottom"===this._position?this.crosshair.render(this.convertValueToPixel(u),null,u):this.crosshair.render(null,this.convertValueToPixel(u),u))},Q.prototype.renderGrid=function(){if(this.gridThickness&&0<this.gridThickness){var u=this.chart.ctx;u.save();var I,g=this.chart.plotArea;if(u.lineWidth=this.gridThickness,u.strokeStyle=this.gridColor,u.setLineDash&&u.setLineDash(tn(this.gridDashType,this.gridThickness)),"bottom"===this._position||"top"===this._position)for(x=0;x<this._labels.length;x++)this._labels[x].position<this.viewportMinimum||this._labels[x].position>this.viewportMaximum||this._labels[x].breaksLabelType||(u.beginPath(),I=this.getPixelCoordinatesOnAxis(this._labels[x].position),u.moveTo(I=u.lineWidth%2==1?.5+(I.x<<0):I.x<<0,g.y1<<0),u.lineTo(I,g.y2<<0),u.stroke());else if("left"===this._position||"right"===this._position)for(var x=0;x<this._labels.length;x++)this._labels[x].position<this.viewportMinimum||this._labels[x].position>this.viewportMaximum||this._labels[x].breaksLabelType||(u.beginPath(),I=this.getPixelCoordinatesOnAxis(this._labels[x].position),u.moveTo(g.x1<<0,I=u.lineWidth%2==1?.5+(I.y<<0):I.y<<0),u.lineTo(g.x2<<0,I),u.stroke());u.restore()}},Q.prototype.renderAxisLine=function(){var w,D,u=this.chart.ctx,I=oe?this.chart._preRenderCtx:u,g=Math.ceil(this.tickThickness/(this.reversed?-2:2)),x=Math.ceil(this.tickThickness/(this.reversed?2:-2));if(I.save(),"bottom"===this._position||"top"===this._position){if(this.lineThickness){this.reversed?(w=this.lineCoordinates.x2,D=this.lineCoordinates.x1):(w=this.lineCoordinates.x1,D=this.lineCoordinates.x2),I.lineWidth=this.lineThickness,I.strokeStyle=this.lineColor?this.lineColor:"black",I.setLineDash&&I.setLineDash(tn(this.lineDashType,this.lineThickness));var o=this.lineThickness%2==1?.5+(this.lineCoordinates.y1<<0):this.lineCoordinates.y1<<0;if(I.beginPath(),this.scaleBreaks&&!$t(this.scaleBreaks.firstBreakIndex))if($t(this.scaleBreaks.lastBreakIndex))w=this.scaleBreaks._appliedBreaks[this.scaleBreaks.firstBreakIndex].endPixel+x;else for(var y=this.scaleBreaks.firstBreakIndex;y<=this.scaleBreaks.lastBreakIndex;y++)I.moveTo(w,o),I.lineTo(this.scaleBreaks._appliedBreaks[y].startPixel+g,o),w=this.scaleBreaks._appliedBreaks[y].endPixel+x;w&&(I.moveTo(w,o),I.lineTo(D,o)),I.stroke()}}else if(("left"===this._position||"right"===this._position)&&this.lineThickness){if(this.reversed?(w=this.lineCoordinates.y1,D=this.lineCoordinates.y2):(w=this.lineCoordinates.y2,D=this.lineCoordinates.y1),I.lineWidth=this.lineThickness,I.strokeStyle=this.lineColor,I.setLineDash&&I.setLineDash(tn(this.lineDashType,this.lineThickness)),o=this.lineThickness%2==1?.5+(this.lineCoordinates.x1<<0):this.lineCoordinates.x1<<0,I.beginPath(),this.scaleBreaks&&!$t(this.scaleBreaks.firstBreakIndex))if($t(this.scaleBreaks.lastBreakIndex))w=this.scaleBreaks._appliedBreaks[this.scaleBreaks.firstBreakIndex].endPixel+g;else for(y=this.scaleBreaks.firstBreakIndex;y<=this.scaleBreaks.lastBreakIndex;y++)I.moveTo(o,w),I.lineTo(o,this.scaleBreaks._appliedBreaks[y].startPixel+x),w=this.scaleBreaks._appliedBreaks[y].endPixel+g;w&&(I.moveTo(o,w),I.lineTo(o,D)),I.stroke()}oe&&(u.drawImage(this.chart._preRenderCanvas,0,0,this.chart.width,this.chart.height),this.chart._breaksCanvasCtx&&this.chart._breaksCanvasCtx.drawImage(this.chart._preRenderCanvas,0,0,this.chart.width,this.chart.height),I.clearRect(0,0,this.chart.width,this.chart.height)),I.restore()},Q.prototype.getPixelCoordinatesOnAxis=function(u){var I={};return("bottom"===this._position||"top"===this._position)&&(I.x=this.convertValueToPixel(u),I.y=this.lineCoordinates.y1),("left"===this._position||"right"===this._position)&&(I.y=this.convertValueToPixel(u),I.x=this.lineCoordinates.x2),I},Q.prototype.convertPixelToValue=function(u){if(typeof u>"u")return null;var I,g=0,w=0,x=(g=!0,this.scaleBreaks?this.scaleBreaks._appliedBreaks:[]);if(w="number"==typeof u?u:"left"===this._position||"right"===this._position?u.y:u.x,this.logarithmic){if(u=I=Math.pow(this.logarithmBase,(w-this.conversionParameters.reference)/this.conversionParameters.pixelPerUnit),w<=this.conversionParameters.reference==("left"===this._position||"right"===this._position)!==this.reversed){for(w=0;w<x.length;w++)if(!(x[w].endValue<this.conversionParameters.minimum))if(g)if(x[w].startValue<this.conversionParameters.minimum){if(1<x[w].size&&this.conversionParameters.minimum*Math.pow(x[w].endValue/x[w].startValue,Math.log(I)/Math.log(x[w].size))<x[w].endValue){u=Math.pow(x[w].endValue/x[w].startValue,Math.log(I)/Math.log(x[w].size));break}u*=x[w].endValue/this.conversionParameters.minimum/Math.pow(x[w].size,Math.log(x[w].endValue/this.conversionParameters.minimum)/Math.log(x[w].endValue/x[w].startValue)),I/=Math.pow(x[w].size,Math.log(x[w].endValue/this.conversionParameters.minimum)/Math.log(x[w].endValue/x[w].startValue)),g=!1}else{if(!(I>x[w].startValue/this.conversionParameters.minimum))break;if((I/=x[w].startValue/this.conversionParameters.minimum)<x[w].size){u*=Math.pow(x[w].endValue/x[w].startValue,1===x[w].size?1:Math.log(I)/Math.log(x[w].size))/I;break}u*=x[w].endValue/x[w].startValue/x[w].size,I/=x[w].size,g=!1}else{if(!(I>x[w].startValue/x[w-1].endValue))break;if((I/=x[w].startValue/x[w-1].endValue)<x[w].size){u*=Math.pow(x[w].endValue/x[w].startValue,1===x[w].size?1:Math.log(I)/Math.log(x[w].size))/I;break}u*=x[w].endValue/x[w].startValue/x[w].size,I/=x[w].size}}else for(w=x.length-1;0<=w;w--)if(!(x[w].startValue>this.conversionParameters.minimum))if(g)if(x[w].endValue>this.conversionParameters.minimum){if(1<x[w].size&&this.conversionParameters.minimum*Math.pow(x[w].endValue/x[w].startValue,Math.log(I)/Math.log(x[w].size))>x[w].startValue){u=Math.pow(x[w].endValue/x[w].startValue,Math.log(I)/Math.log(x[w].size));break}u*=x[w].startValue/this.conversionParameters.minimum*Math.pow(x[w].size,Math.log(x[w].startValue/this.conversionParameters.minimum)/Math.log(x[w].endValue/x[w].startValue))*I,I*=Math.pow(x[w].size,Math.log(this.conversionParameters.minimum/x[w].startValue)/Math.log(x[w].endValue/x[w].startValue)),g=!1}else{if(!(I<x[w].endValue/this.conversionParameters.minimum))break;if((I/=x[w].endValue/this.conversionParameters.minimum)>1/x[w].size){u*=Math.pow(x[w].endValue/x[w].startValue,1>=x[w].size?1:Math.log(I)/Math.log(x[w].size))*I;break}u/=x[w].endValue/x[w].startValue/x[w].size,I*=x[w].size,g=!1}else{if(!(I<x[w].endValue/x[w+1].startValue))break;if((I/=x[w].endValue/x[w+1].startValue)>1/x[w].size){u*=Math.pow(x[w].endValue/x[w].startValue,1>=x[w].size?1:Math.log(I)/Math.log(x[w].size))*I;break}u/=x[w].endValue/x[w].startValue/x[w].size,I*=x[w].size}g=u*this.viewportMinimum}else{if(u=I=(w-this.conversionParameters.reference)/this.conversionParameters.pixelPerUnit,w<=this.conversionParameters.reference==("left"===this._position||"right"===this._position)!==this.reversed){for(w=0;w<x.length;w++)if(!(x[w].endValue<this.conversionParameters.minimum))if(g)if(x[w].startValue<this.conversionParameters.minimum){if(x[w].size&&this.conversionParameters.minimum+I*(x[w].endValue-x[w].startValue)/x[w].size<x[w].endValue){u=0>=x[w].size?0:I*(x[w].endValue-x[w].startValue)/x[w].size;break}u+=x[w].endValue-this.conversionParameters.minimum-x[w].size*(x[w].endValue-this.conversionParameters.minimum)/(x[w].endValue-x[w].startValue),I-=x[w].size*(x[w].endValue-this.conversionParameters.minimum)/(x[w].endValue-x[w].startValue),g=!1}else{if(!(I>x[w].startValue-this.conversionParameters.minimum))break;if((I-=x[w].startValue-this.conversionParameters.minimum)<x[w].size){u+=(x[w].endValue-x[w].startValue)*(0===x[w].size?1:I/x[w].size)-I;break}u+=x[w].endValue-x[w].startValue-x[w].size,I-=x[w].size,g=!1}else{if(!(I>x[w].startValue-x[w-1].endValue))break;if((I-=x[w].startValue-x[w-1].endValue)<x[w].size){u+=(x[w].endValue-x[w].startValue)*(0===x[w].size?1:I/x[w].size)-I;break}u+=x[w].endValue-x[w].startValue-x[w].size,I-=x[w].size}}else for(w=x.length-1;0<=w;w--)if(!(x[w].startValue>this.conversionParameters.minimum))if(g)if(x[w].endValue>this.conversionParameters.minimum){if(x[w].size&&this.conversionParameters.minimum+I*(x[w].endValue-x[w].startValue)/x[w].size>x[w].startValue){u=0>=x[w].size?0:I*(x[w].endValue-x[w].startValue)/x[w].size;break}u+=x[w].startValue-this.conversionParameters.minimum+x[w].size*(this.conversionParameters.minimum-x[w].startValue)/(x[w].endValue-x[w].startValue),I+=x[w].size*(this.conversionParameters.minimum-x[w].startValue)/(x[w].endValue-x[w].startValue),g=!1}else{if(!(I<x[w].endValue-this.conversionParameters.minimum))break;if((I-=x[w].endValue-this.conversionParameters.minimum)>-1*x[w].size){u+=(x[w].endValue-x[w].startValue)*(0===x[w].size?1:I/x[w].size)+I;break}u-=x[w].endValue-x[w].startValue-x[w].size,I+=x[w].size,g=!1}else{if(!(I<x[w].endValue-x[w+1].startValue))break;if((I-=x[w].endValue-x[w+1].startValue)>-1*x[w].size){u+=(x[w].endValue-x[w].startValue)*(0===x[w].size?1:I/x[w].size)+I;break}u-=x[w].endValue-x[w].startValue-x[w].size,I+=x[w].size}g=this.conversionParameters.minimum+u}return g},Q.prototype.convertValueToPixel=function(u){return u=this.getApparentDifference(this.conversionParameters.minimum,u,u),this.logarithmic?this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*Math.log(u/this.conversionParameters.minimum)/this.conversionParameters.lnLogarithmBase+.5<<0:"axisX"===this.type?this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*(u-this.conversionParameters.minimum)+.5<<0:this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*(u-this.conversionParameters.minimum)+.5},Q.prototype.getApparentDifference=function(u,I,g,x){var w=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];if(this.logarithmic){g=$t(g)?I/u:g;for(var D=0;D<w.length&&!(I<w[D].startValue);D++)u>w[D].endValue||(u<=w[D].startValue&&I>=w[D].endValue?g=g/w[D].endValue*w[D].startValue*w[D].size:u>=w[D].startValue&&I>=w[D].endValue?g=g/w[D].endValue*u*Math.pow(w[D].size,Math.log(w[D].endValue/u)/Math.log(w[D].endValue/w[D].startValue)):u<=w[D].startValue&&I<=w[D].endValue?g=g/I*w[D].startValue*Math.pow(w[D].size,Math.log(I/w[D].startValue)/Math.log(w[D].endValue/w[D].startValue)):!x&&u>w[D].startValue&&I<w[D].endValue&&(g=u*Math.pow(w[D].size,Math.log(I/u)/Math.log(w[D].endValue/w[D].startValue))))}else for(g=$t(g)?Math.abs(I-u):g,D=0;D<w.length&&!(I<w[D].startValue);D++)u>w[D].endValue||(u<=w[D].startValue&&I>=w[D].endValue?g=g-w[D].endValue+w[D].startValue+w[D].size:u>w[D].startValue&&I>=w[D].endValue?g=g-w[D].endValue+u+w[D].size*(w[D].endValue-u)/(w[D].endValue-w[D].startValue):u<=w[D].startValue&&I<w[D].endValue?g=g-I+w[D].startValue+w[D].size*(I-w[D].startValue)/(w[D].endValue-w[D].startValue):!x&&u>w[D].startValue&&I<w[D].endValue&&(g=u+w[D].size*(I-u)/(w[D].endValue-w[D].startValue)));return g},Q.prototype.setViewPortRange=function(u,I){this.sessionVariables.newViewportMinimum=this.viewportMinimum=Math.min(u,I),this.sessionVariables.newViewportMaximum=this.viewportMaximum=Math.max(u,I)},Q.prototype.getXValueAt=function(u){if(!u)return null;var I=null;return"left"===this._position?I=this.convertPixelToValue(u.y):"bottom"===this._position&&(I=this.convertPixelToValue(u.x)),I},Q.prototype.calculateValueToPixelConversionParameters=function(u){u=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];var I={pixelPerUnit:null,minimum:null,reference:null},g=this.lineCoordinates.width,x=this.lineCoordinates.height;if(g="bottom"===this._position||"top"===this._position?g:x,x=Math.abs(this.range),this.logarithmic)for(var w=0;w<u.length&&!(this.viewportMaximum<u[w].startValue);w++)this.viewportMinimum>u[w].endValue||(this.viewportMinimum>=u[w].startValue&&this.viewportMaximum<=u[w].endValue?g=0:this.viewportMinimum<=u[w].startValue&&this.viewportMaximum>=u[w].endValue?(x=x/u[w].endValue*u[w].startValue,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100):g-Math.min(u[w].spacing,.1*g)):this.viewportMinimum>u[w].startValue&&this.viewportMaximum>=u[w].endValue?(x=x/u[w].endValue*this.viewportMinimum,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100*Math.log(u[w].endValue/this.viewportMinimum)/Math.log(u[w].endValue/u[w].startValue)):g-Math.min(u[w].spacing,.1*g)*Math.log(u[w].endValue/this.viewportMinimum)/Math.log(u[w].endValue/u[w].startValue)):this.viewportMinimum<=u[w].startValue&&this.viewportMaximum<u[w].endValue&&(x=x/this.viewportMaximum*u[w].startValue,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100*Math.log(this.viewportMaximum/u[w].startValue)/Math.log(u[w].endValue/u[w].startValue)):g-Math.min(u[w].spacing,.1*g)*Math.log(this.viewportMaximum/u[w].startValue)/Math.log(u[w].endValue/u[w].startValue)));else for(w=0;w<u.length&&!(this.viewportMaximum<u[w].startValue);w++)this.viewportMinimum>u[w].endValue||(this.viewportMinimum>=u[w].startValue&&this.viewportMaximum<=u[w].endValue?g=0:this.viewportMinimum<=u[w].startValue&&this.viewportMaximum>=u[w].endValue?(x=x-u[w].endValue+u[w].startValue,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100):g-Math.min(u[w].spacing,.1*g)):this.viewportMinimum>u[w].startValue&&this.viewportMaximum>=u[w].endValue?(x=x-u[w].endValue+this.viewportMinimum,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100*(u[w].endValue-this.viewportMinimum)/(u[w].endValue-u[w].startValue)):g-Math.min(u[w].spacing,.1*g)*(u[w].endValue-this.viewportMinimum)/(u[w].endValue-u[w].startValue)):this.viewportMinimum<=u[w].startValue&&this.viewportMaximum<u[w].endValue&&(x=x-this.viewportMaximum+u[w].startValue,g=0<u[w].spacing.toString().indexOf("%")?g*(1-parseFloat(u[w].spacing)/100*(this.viewportMaximum-u[w].startValue)/(u[w].endValue-u[w].startValue)):g-Math.min(u[w].spacing,.1*g)*(this.viewportMaximum-u[w].startValue)/(u[w].endValue-u[w].startValue)));I.minimum=this.viewportMinimum,I.maximum=this.viewportMaximum,I.range=x,("bottom"===this._position||"top"===this._position)&&(this.logarithmic?(I.lnLogarithmBase=Math.log(this.logarithmBase),I.pixelPerUnit=(this.reversed?-1:1)*g*I.lnLogarithmBase/Math.log(Math.abs(x))):I.pixelPerUnit=(this.reversed?-1:1)*g/Math.abs(x),I.reference=this.reversed?this.lineCoordinates.x2:this.lineCoordinates.x1),("left"===this._position||"right"===this._position)&&(this.logarithmic?(I.lnLogarithmBase=Math.log(this.logarithmBase),I.pixelPerUnit=(this.reversed?1:-1)*g*I.lnLogarithmBase/Math.log(Math.abs(x))):I.pixelPerUnit=(this.reversed?1:-1)*g/Math.abs(x),I.reference=this.reversed?this.lineCoordinates.y1:this.lineCoordinates.y2),this.conversionParameters=I},Q.prototype.calculateAxisParameters=function(){if(this.logarithmic)this.calculateLogarithmicAxisParameters();else{var g=this.chart.layoutManager.getFreeSpace(),u=!1,I=!1;"bottom"===this._position||"top"===this._position?(this.maxWidth=g.width,this.maxHeight=g.height):(this.maxWidth=g.height,this.maxHeight=g.width),g="axisX"===this.type?"xySwapped"===this.chart.plotInfo.axisPlacement?62:70:"xySwapped"===this.chart.plotInfo.axisPlacement?50:40;var x,w,D,o=4;if("axisX"===this.type&&(o=600>this.maxWidth?8:6),g=Math.max(o,Math.floor(this.maxWidth/g)),o=0,!$t(this.options.viewportMinimum)&&!$t(this.options.viewportMaximum)&&this.options.viewportMinimum>=this.options.viewportMaximum&&(this.viewportMinimum=this.viewportMaximum=null),!$t(this.options.viewportMinimum)||$t(this.sessionVariables.newViewportMinimum)||isNaN(this.sessionVariables.newViewportMinimum)?(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=this.minimum):this.viewportMinimum=this.sessionVariables.newViewportMinimum,!$t(this.options.viewportMaximum)||$t(this.sessionVariables.newViewportMaximum)||isNaN(this.sessionVariables.newViewportMaximum)?(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=this.maximum):this.viewportMaximum=this.sessionVariables.newViewportMaximum,this.scaleBreaks)for(o=0;o<this.scaleBreaks._appliedBreaks.length;o++)if((!$t(this.sessionVariables.newViewportMinimum)&&this.sessionVariables.newViewportMinimum>=this.scaleBreaks._appliedBreaks[o].startValue||!$t(this.options.minimum)&&this.options.minimum>=this.scaleBreaks._appliedBreaks[o].startValue||!$t(this.options.viewportMinimum)&&this.viewportMinimum>=this.scaleBreaks._appliedBreaks[o].startValue)&&(!$t(this.sessionVariables.newViewportMaximum)&&this.sessionVariables.newViewportMaximum<=this.scaleBreaks._appliedBreaks[o].endValue||!$t(this.options.maximum)&&this.options.maximum<=this.scaleBreaks._appliedBreaks[o].endValue||!$t(this.options.viewportMaximum)&&this.viewportMaximum<=this.scaleBreaks._appliedBreaks[o].endValue)){this.scaleBreaks._appliedBreaks.splice(o,1);break}if("axisX"===this.type){if(this.dataSeries&&0<this.dataSeries.length)for(x=0;x<this.dataSeries.length;x++)"dateTime"===this.dataSeries[x].xValueType&&(I=!0);(w=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax)-(x=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)==0&&(w+=o=typeof this.options.interval>"u"?.4:this.options.interval,x-=o),this.dataInfo.minDiff!==1/0?D=this.dataInfo.minDiff:1<w-x?D=.5*Math.abs(w-x):(D=1,I&&(u=!0))}else"axisY"===this.type&&(x=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin,w=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax,isFinite(x)||isFinite(w)?isFinite(x)?isFinite(w)||(w=x):x=w:(w=typeof this.options.interval>"u"?-1/0:this.options.interval,x=typeof this.options.interval<"u"||isFinite(this.dataInfo.minDiff)?0:1/0),0===x&&0===w?(w+=9,x=0):w-x==0?(w+=o=Math.min(Math.abs(.01*Math.abs(w)),5),x-=o):x>w?(o=Math.min(.01*Math.abs(this.getApparentDifference(w,x,null,!0)),5),0<=w?x=w-o:w=isFinite(x)?x+o:0):(o=Math.min(.01*Math.abs(this.getApparentDifference(x,w,null,!0)),.05),0!==w&&(w+=o),0!==x&&(x-=o)),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<w-x?.5*Math.abs(w-x):1,this.includeZero&&(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&0<x&&(x=0),this.includeZero&&(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&0>w&&(w=0));o=this.getApparentDifference(isNaN(this.viewportMinimum)||null===this.viewportMinimum?x:this.viewportMinimum,isNaN(this.viewportMaximum)||null===this.viewportMaximum?w:this.viewportMaximum,null,!0),"axisX"===this.type&&I?(this.valueType="dateTime",this.intervalType||(o/1<=g?(this.interval=1,this.intervalType="millisecond"):o/2<=g?(this.interval=2,this.intervalType="millisecond"):o/5<=g?(this.interval=5,this.intervalType="millisecond"):o/10<=g?(this.interval=10,this.intervalType="millisecond"):o/20<=g?(this.interval=20,this.intervalType="millisecond"):o/50<=g?(this.interval=50,this.intervalType="millisecond"):o/100<=g?(this.interval=100,this.intervalType="millisecond"):o/200<=g?(this.interval=200,this.intervalType="millisecond"):o/250<=g?(this.interval=250,this.intervalType="millisecond"):o/300<=g?(this.interval=300,this.intervalType="millisecond"):o/400<=g?(this.interval=400,this.intervalType="millisecond"):o/500<=g?(this.interval=500,this.intervalType="millisecond"):o/(1*Pi.secondDuration)<=g?(this.interval=1,this.intervalType="second"):o/(2*Pi.secondDuration)<=g?(this.interval=2,this.intervalType="second"):o/(5*Pi.secondDuration)<=g?(this.interval=5,this.intervalType="second"):o/(10*Pi.secondDuration)<=g?(this.interval=10,this.intervalType="second"):o/(15*Pi.secondDuration)<=g?(this.interval=15,this.intervalType="second"):o/(20*Pi.secondDuration)<=g?(this.interval=20,this.intervalType="second"):o/(30*Pi.secondDuration)<=g?(this.interval=30,this.intervalType="second"):o/(1*Pi.minuteDuration)<=g?(this.interval=1,this.intervalType="minute"):o/(2*Pi.minuteDuration)<=g?(this.interval=2,this.intervalType="minute"):o/(5*Pi.minuteDuration)<=g?(this.interval=5,this.intervalType="minute"):o/(10*Pi.minuteDuration)<=g?(this.interval=10,this.intervalType="minute"):o/(15*Pi.minuteDuration)<=g?(this.interval=15,this.intervalType="minute"):o/(20*Pi.minuteDuration)<=g?(this.interval=20,this.intervalType="minute"):o/(30*Pi.minuteDuration)<=g?(this.interval=30,this.intervalType="minute"):o/(1*Pi.hourDuration)<=g?(this.interval=1,this.intervalType="hour"):o/(2*Pi.hourDuration)<=g?(this.interval=2,this.intervalType="hour"):o/(3*Pi.hourDuration)<=g?(this.interval=3,this.intervalType="hour"):o/(6*Pi.hourDuration)<=g?(this.interval=6,this.intervalType="hour"):o/(1*Pi.dayDuration)<=g?(this.interval=1,this.intervalType="day"):o/(2*Pi.dayDuration)<=g?(this.interval=2,this.intervalType="day"):o/(4*Pi.dayDuration)<=g?(this.interval=4,this.intervalType="day"):o/(1*Pi.weekDuration)<=g?(this.interval=1,this.intervalType="week"):o/(2*Pi.weekDuration)<=g?(this.interval=2,this.intervalType="week"):o/(3*Pi.weekDuration)<=g?(this.interval=3,this.intervalType="week"):o/(1*Pi.monthDuration)<=g?(this.interval=1,this.intervalType="month"):o/(2*Pi.monthDuration)<=g?(this.interval=2,this.intervalType="month"):o/(3*Pi.monthDuration)<=g?(this.interval=3,this.intervalType="month"):o/(6*Pi.monthDuration)<=g?(this.interval=6,this.intervalType="month"):(this.interval=o/(1*Pi.yearDuration)<=g?1:o/(2*Pi.yearDuration)<=g?2:o/(4*Pi.yearDuration)<=g?4:Math.floor(Q.getNiceNumber(o/(g-1),!0)/Pi.yearDuration),this.intervalType="year")),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=x-D/2),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=w+D/2),u?this.autoValueFormatString="MMM DD YYYY HH:mm":"year"===this.intervalType?this.autoValueFormatString="YYYY":"month"===this.intervalType?this.autoValueFormatString="MMM YYYY":"week"===this.intervalType||"day"===this.intervalType?this.autoValueFormatString="MMM DD YYYY":"hour"===this.intervalType||"minute"===this.intervalType?this.autoValueFormatString="hh:mm TT":"second"===this.intervalType?this.autoValueFormatString="hh:mm:ss TT":"millisecond"===this.intervalType&&(this.autoValueFormatString="fff'ms'"),this.valueFormatString||(this.valueFormatString=this.autoValueFormatString)):(this.intervalType="number",o=Q.getNiceNumber(o,!1),this.interval=this.options&&0<this.options.interval?this.options.interval:Q.getNiceNumber(o/(g-1),!0),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum="axisX"===this.type?x-D/2:Math.floor(x/this.interval)*this.interval),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum="axisX"===this.type?w+D/2:Math.ceil(w/this.interval)*this.interval),0===this.viewportMaximum&&0===this.viewportMinimum&&(0===this.options.viewportMinimum?this.viewportMaximum+=10:0===this.options.viewportMaximum&&(this.viewportMinimum-=10),this.options&&typeof this.options.interval>"u"&&(this.interval=Q.getNiceNumber((this.viewportMaximum-this.viewportMinimum)/(g-1),!0)))),(null===this.minimum||null===this.maximum)&&("axisX"===this.type?((w=null!==this.maximum?this.maximum:this.dataInfo.max)-(x=null!==this.minimum?this.minimum:this.dataInfo.min)==0&&(w+=o=typeof this.options.interval>"u"?.4:this.options.interval,x-=o),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<w-x?.5*Math.abs(w-x):1):"axisY"===this.type&&(x=null!==this.minimum?this.minimum:this.dataInfo.min,w=null!==this.maximum?this.maximum:this.dataInfo.max,isFinite(x)||isFinite(w)?0===x&&0===w?(w+=9,x=0):w-x==0?(w+=o=Math.min(Math.abs(.01*Math.abs(w)),5),x-=o):x>w?(o=Math.min(.01*Math.abs(this.getApparentDifference(w,x,null,!0)),5),0<=w?x=w-o:w=isFinite(x)?x+o:0):(o=Math.min(.01*Math.abs(this.getApparentDifference(x,w,null,!0)),.05),0!==w&&(w+=o),0!==x&&(x-=o)):(w=typeof this.options.interval>"u"?-1/0:this.options.interval,x=typeof this.options.interval<"u"||isFinite(this.dataInfo.minDiff)?0:1/0),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<w-x?.5*Math.abs(w-x):1,this.includeZero&&(null===this.minimum||isNaN(this.minimum))&&0<x&&(x=0),this.includeZero&&(null===this.maximum||isNaN(this.maximum))&&0>w&&(w=0)),Math.abs(this.getApparentDifference(x,w,null,!0)),"axisX"===this.type&&I?(this.valueType="dateTime",(null===this.minimum||isNaN(this.minimum))&&(this.minimum=x-D/2,this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?1/0:this.sessionVariables.viewportMinimum)),(null===this.maximum||isNaN(this.maximum))&&(this.maximum=w+D/2,this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?-1/0:this.sessionVariables.viewportMaximum))):(this.intervalType=this.valueType="number",null===this.minimum&&(this.minimum="axisX"===this.type?x-D/2:Math.floor(x/this.interval)*this.interval,this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?1/0:this.sessionVariables.viewportMinimum)),null===this.maximum&&(this.maximum="axisX"===this.type?w+D/2:Math.ceil(w/this.interval)*this.interval,this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?-1/0:this.sessionVariables.viewportMaximum)),0===this.maximum&&0===this.minimum&&(0===this.options.minimum?this.maximum+=10:0===this.options.maximum&&(this.minimum-=10)))),$t(this.sessionVariables.newViewportMinimum)&&(this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum)),$t(this.sessionVariables.newViewportMaximum)&&(this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum)),this.range=this.viewportMaximum-this.viewportMinimum,this.intervalStartPosition="axisX"===this.type&&I?this.getLabelStartPoint(new Date(this.viewportMinimum),this.intervalType,this.interval):Math.floor((this.viewportMinimum+.2*this.interval)/this.interval)*this.interval,this.valueFormatString||(this.valueFormatString=Q.generateValueFormatString(this.range,2))}},Q.prototype.calculateLogarithmicAxisParameters=function(){var I,x,w,D,o,g=this.chart.layoutManager.getFreeSpace(),u=Math.log(this.logarithmBase);if("bottom"===this._position||"top"===this._position?(this.maxWidth=g.width,this.maxHeight=g.height):(this.maxWidth=g.height,this.maxHeight=g.width),g="axisX"===this.type?500>this.maxWidth?7:Math.max(7,Math.floor(this.maxWidth/100)):Math.max(Math.floor(this.maxWidth/50),3),o=1,(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=this.minimum),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=this.maximum),this.scaleBreaks)for(o=0;o<this.scaleBreaks._appliedBreaks.length;o++)if((!$t(this.sessionVariables.newViewportMinimum)&&this.sessionVariables.newViewportMinimum>=this.scaleBreaks._appliedBreaks[o].startValue||!$t(this.options.minimum)&&this.options.minimum>=this.scaleBreaks._appliedBreaks[o].startValue||!$t(this.options.viewportMinimum)&&this.viewportMinimum>=this.scaleBreaks._appliedBreaks[o].startValue)&&(!$t(this.sessionVariables.newViewportMaximum)&&this.sessionVariables.newViewportMaximum<=this.scaleBreaks._appliedBreaks[o].endValue||!$t(this.options.maximum)&&this.options.maximum<=this.scaleBreaks._appliedBreaks[o].endValue||!$t(this.options.viewportMaximum)&&this.viewportMaximum<=this.scaleBreaks._appliedBreaks[o].endValue)){this.scaleBreaks._appliedBreaks.splice(o,1);break}"axisX"===this.type?((w=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax)/(x=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)==1&&(w*=o=Math.pow(this.logarithmBase,typeof this.options.interval>"u"?.4:this.options.interval),x/=o),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:w/x>this.logarithmBase?w/x*Math.pow(this.logarithmBase,.5):this.logarithmBase):"axisY"===this.type&&(w=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax,0>=(x=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)&&!isFinite(w)?(w=typeof this.options.interval>"u"?0:this.options.interval,x=1):0>=x?x=w:isFinite(w)||(w=x),1===x&&1===w?(w*=this.logarithmBase-1/this.logarithmBase,x=1):w/x==1?(w*=o=Math.min(w*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,5)),x/=o):x>w?(o=Math.min(x/w*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,5)),1<=w?x=w/o:w=x*o):(o=Math.min(w/x*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,.04)),1!==w&&(w*=o),1!==x&&(x/=o)),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:w/x>this.logarithmBase?w/x*Math.pow(this.logarithmBase,.5):this.logarithmBase,this.includeZero&&(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&1<x&&(x=1),this.includeZero&&(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&1>w&&(w=1)),o=(isNaN(this.viewportMaximum)||null===this.viewportMaximum?w:this.viewportMaximum)/(isNaN(this.viewportMinimum)||null===this.viewportMinimum?x:this.viewportMinimum);var y=(isNaN(this.viewportMaximum)||null===this.viewportMaximum?w:this.viewportMaximum)-(isNaN(this.viewportMinimum)||null===this.viewportMinimum?x:this.viewportMinimum);if(this.intervalType="number",o=Math.pow(this.logarithmBase,Q.getNiceNumber(Math.abs(Math.log(o)/u),!1)),this.options&&0<this.options.interval?this.interval=this.options.interval:(this.interval=Q.getNiceExponent(Math.log(o)/u/(g-1),!0),I=Q.getNiceNumber(y/(g-1),!0)),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum="axisX"===this.type?x/Math.sqrt(D):Math.pow(this.logarithmBase,this.interval*Math.floor(Math.log(x)/u/this.interval))),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum="axisX"===this.type?w*Math.sqrt(D):Math.pow(this.logarithmBase,this.interval*Math.ceil(Math.log(w)/u/this.interval))),1===this.viewportMaximum&&1===this.viewportMinimum&&(1===this.options.viewportMinimum?this.viewportMaximum*=this.logarithmBase-1/this.logarithmBase:1===this.options.viewportMaximum&&(this.viewportMinimum/=this.logarithmBase-1/this.logarithmBase),this.options&&typeof this.options.interval>"u"&&(this.interval=Q.getNiceExponent(Math.ceil(Math.log(o)/u)/(g-1)),I=Q.getNiceNumber((this.viewportMaximum-this.viewportMinimum)/(g-1),!0))),(null===this.minimum||null===this.maximum)&&("axisX"===this.type?((w=null!==this.maximum?this.maximum:this.dataInfo.max)/(x=null!==this.minimum?this.minimum:this.dataInfo.min)==1&&(w*=o=Math.pow(this.logarithmBase,typeof this.options.interval>"u"?.4:this.options.interval),x/=o),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:w/x>this.logarithmBase?w/x*Math.pow(this.logarithmBase,.5):this.logarithmBase):"axisY"===this.type&&(x=null!==this.minimum?this.minimum:this.dataInfo.min,w=null!==this.maximum?this.maximum:this.dataInfo.max,isFinite(x)||isFinite(w)?1===x&&1===w?(w*=this.logarithmBase,x/=this.logarithmBase):w/x==1?(w*=o=Math.pow(this.logarithmBase,this.interval),x/=o):x>w?(o=Math.min(x/w*.01,5),1<=w?x=w/o:w=x*o):(o=Math.min(w/x*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,.04)),1!==w&&(w*=o),1!==x&&(x/=o)):(w=typeof this.options.interval>"u"?0:this.options.interval,x=1),D=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:w/x>this.logarithmBase?w/x*Math.pow(this.logarithmBase,.5):this.logarithmBase,this.includeZero&&(null===this.minimum||isNaN(this.minimum))&&1<x&&(x=1),this.includeZero&&(null===this.maximum||isNaN(this.maximum))&&1>w&&(w=1)),this.intervalType="number",null===this.minimum&&(this.minimum="axisX"===this.type?x/Math.sqrt(D):Math.pow(this.logarithmBase,this.interval*Math.floor(Math.log(x)/u/this.interval)),$t(null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?typeof this.sessionVariables.newViewportMinimum>"u"?1/0:this.sessionVariables.newViewportMinimum:this.sessionVariables.viewportMinimum)||(this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?typeof this.sessionVariables.newViewportMinimum>"u"?1/0:this.sessionVariables.newViewportMinimum:this.sessionVariables.viewportMinimum))),null===this.maximum&&(this.maximum="axisX"===this.type?w*Math.sqrt(D):Math.pow(this.logarithmBase,this.interval*Math.ceil(Math.log(w)/u/this.interval)),$t(null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?typeof this.sessionVariables.newViewportMaximum>"u"?0:this.sessionVariables.newViewportMaximum:this.sessionVariables.viewportMaximum)||(this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?typeof this.sessionVariables.newViewportMaximum>"u"?0:this.sessionVariables.newViewportMaximum:this.sessionVariables.viewportMaximum))),1===this.maximum&&1===this.minimum&&(1===this.options.minimum?this.maximum*=this.logarithmBase-1/this.logarithmBase:1===this.options.maximum&&(this.minimum/=this.logarithmBase-1/this.logarithmBase))),this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum),this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum),this.viewportMinimum>this.viewportMaximum&&(!this.options.viewportMinimum&&!this.options.minimum||this.options.viewportMaximum||this.options.maximum?this.options.viewportMinimum||this.options.minimum||!this.options.viewportMaximum&&!this.options.maximum||(this.viewportMinimum=this.minimum=(this.options.viewportMaximum||this.options.maximum)/Math.pow(this.logarithmBase,2*Math.ceil(this.interval))):this.viewportMaximum=this.maximum=this.options.viewportMinimum||this.options.minimum),x=Math.pow(this.logarithmBase,Math.floor(Math.log(this.viewportMinimum)/(u*this.interval)+.2)*this.interval),this.range=this.viewportMaximum/this.viewportMinimum,this.noTicks=g,!this.options.interval&&this.range<Math.pow(this.logarithmBase,8>this.viewportMaximum||3>g?2:3)){for(u=Math.floor(this.viewportMinimum/I+.5)*I;u<this.viewportMinimum;)u+=I;this.equidistantInterval=!1,this.intervalStartPosition=u,this.interval=I}else this.options.interval||(I=Math.ceil(this.interval),this.range>this.interval&&(this.interval=I,x=Math.pow(this.logarithmBase,Math.floor(Math.log(this.viewportMinimum)/(u*this.interval)+.2)*this.interval))),this.equidistantInterval=!0,this.intervalStartPosition=x;if(!this.valueFormatString&&(this.valueFormatString="#,##0.##",1>this.viewportMinimum)&&(u=Math.floor(Math.abs(Math.log(this.viewportMinimum)/Math.LN10))+2,(isNaN(u)||!isFinite(u))&&(u=2),2<u))for(o=0;o<u-2;o++)this.valueFormatString+="#"},Q.generateValueFormatString=function(u,I){var g="#,##0.",x=I;1>u&&(x+=Math.floor(Math.abs(Math.log(u)/Math.LN10)),isNaN(x)||!isFinite(x))&&(x=I);for(var w=0;w<x;w++)g+="#";return g},Q.getNiceExponent=function(u,I){var g=Math.floor(Math.log(u)/Math.LN10),x=u/Math.pow(10,g);return x=0>g?1>=x?1:5>=x?5:10:Math.max(Math.floor(x),1),Number(-20>g?x*Math.pow(10,g):(x*Math.pow(10,g)).toFixed(20))},Q.getNiceNumber=function(u,I){var g=Math.floor(Math.log(u)/Math.LN10),x=u/Math.pow(10,g);return x=I?1.5>x?1:3>x?2:7>x?5:10:1>=x?1:2>=x?2:5>=x?5:10,Number(-20>g?x*Math.pow(10,g):(x*Math.pow(10,g)).toFixed(20))},Q.prototype.getLabelStartPoint=function(){var u=Pi[this.intervalType+"Duration"]*this.interval;return u=new Date(Math.floor(this.viewportMinimum/u)*u),"millisecond"!==this.intervalType&&("second"===this.intervalType?0<u.getMilliseconds()&&(u.setSeconds(u.getSeconds()+1),u.setMilliseconds(0)):"minute"===this.intervalType?(0<u.getSeconds()||0<u.getMilliseconds())&&(u.setMinutes(u.getMinutes()+1),u.setSeconds(0),u.setMilliseconds(0)):"hour"===this.intervalType?(0<u.getMinutes()||0<u.getSeconds()||0<u.getMilliseconds())&&(u.setHours(u.getHours()+1),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0)):"day"===this.intervalType?(0<u.getHours()||0<u.getMinutes()||0<u.getSeconds()||0<u.getMilliseconds())&&(u.setDate(u.getDate()+1),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0)):"week"===this.intervalType?(0<u.getDay()||0<u.getHours()||0<u.getMinutes()||0<u.getSeconds()||0<u.getMilliseconds())&&(u.setDate(u.getDate()+(7-u.getDay())),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0)):"month"===this.intervalType?(1<u.getDate()||0<u.getHours()||0<u.getMinutes()||0<u.getSeconds()||0<u.getMilliseconds())&&(u.setMonth(u.getMonth()+1),u.setDate(1),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0)):"year"===this.intervalType&&(0<u.getMonth()||1<u.getDate()||0<u.getHours()||0<u.getMinutes()||0<u.getSeconds()||0<u.getMilliseconds())&&(u.setFullYear(u.getFullYear()+1),u.setMonth(0),u.setDate(1),u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0))),u},On(xt,Wi),On(Pt,Wi),Pt.prototype.createUserOptions=function(u){if(typeof u<"u"||this.options._isPlaceholder){var I=0;this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.options._isPlaceholder||(Et(this.parent[this.optionsName]),I=this.parent.options[this.optionsName].indexOf(this.options)),this.options=typeof u>"u"?{}:u,this.parent.options[this.optionsName][I]=this.options}},Pt.prototype.render=function(u){if(0!==this.spacing||0!==this.options.lineThickness&&(typeof this.options.lineThickness<"u"||0!==this.parent.lineThickness)){var I=this.ctx,g=this.ctx.globalAlpha;this.ctx=u||this.ctx,this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip();var D,o,y,f,c,d,x=this.scaleBreaks.parent.getPixelCoordinatesOnAxis(this.startValue),w=this.scaleBreaks.parent.getPixelCoordinatesOnAxis(this.endValue);this.ctx.strokeStyle=this.lineColor,this.ctx.fillStyle=this.color,this.ctx.beginPath(),this.ctx.globalAlpha=1,bi(this.id),u=Math.max(this.spacing,3);var M=Math.max(0,this.lineThickness);if(this.ctx.lineWidth=M,this.ctx.setLineDash&&this.ctx.setLineDash(tn(this.lineDashType,M)),"bottom"===this.scaleBreaks.parent._position||"top"===this.scaleBreaks.parent._position){if(o=M%2==1?.5+(w.x<<0):w.x<<0,"top"===this.scaleBreaks.parent._position?(w=this.chart.plotArea.y1,y=this.chart.plotArea.y2+M/2+.5<<0):(w=this.chart.plotArea.y2,y=this.chart.plotArea.y1-M/2+.5<<0,u*=-1),this.bounds={x1:(x=M%2==1?.5+(x.x<<0):x.x<<0)-M/2,y1:w,x2:o+M/2,y2:y},this.ctx.moveTo(x,w),"straight"===this.type||"top"===this.scaleBreaks.parent._position&&0>=u||"bottom"===this.scaleBreaks.parent._position&&0<=u)this.ctx.lineTo(x,y),this.ctx.lineTo(o,y),this.ctx.lineTo(o,w);else if("wavy"===this.type){f=x,D=.5,d=(y-(c=w))/u/3;for(var k=0;k<d;k++)this.ctx.bezierCurveTo(f+D*u,c+u,f+D*u,c+2*u,f,c+3*u),c+=3*u,D*=-1;for(this.ctx.bezierCurveTo(f+D*u,c+u,f+D*u,c+2*u,f,c+3*u),D*=-1,this.ctx.lineTo(f=o,c),k=0;k<d;k++)this.ctx.bezierCurveTo(f+D*u,c-u,f+D*u,c-2*u,f,c-3*u),c-=3*u,D*=-1}else if("zigzag"===this.type){for(D=-1,f=x+u,d=(y-(c=w+u))/u/2,k=0;k<d;k++)this.ctx.lineTo(f,c),f+=2*D*u,c+=2*u,D*=-1;for(this.ctx.lineTo(f,c),f+=o-x,k=0;k<d+1;k++)this.ctx.lineTo(f,c),f+=2*D*u,c-=2*u,D*=-1;this.ctx.lineTo(f+D*u,c+u)}}else if("left"===this.scaleBreaks.parent._position||"right"===this.scaleBreaks.parent._position)if(y=M%2==1?.5+(x.y<<0):x.y<<0,"left"===this.scaleBreaks.parent._position?(x=this.chart.plotArea.x1,o=this.chart.plotArea.x2+M/2+.5<<0):(x=this.chart.plotArea.x2,o=this.chart.plotArea.x1-M/2+.5<<0,u*=-1),this.bounds={x1:x,y1:(w=M%2==1?.5+(w.y<<0):w.y<<0)-M/2,x2:o,y2:y+M/2},this.ctx.moveTo(x,w),"straight"===this.type||"left"===this.scaleBreaks.parent._position&&0>=u||"right"===this.scaleBreaks.parent._position&&0<=u)this.ctx.lineTo(o,w),this.ctx.lineTo(o,y),this.ctx.lineTo(x,y);else if("wavy"===this.type){for(c=w,D=.5,d=(o-(f=x))/u/3,k=0;k<d;k++)this.ctx.bezierCurveTo(f+u,c+D*u,f+2*u,c+D*u,f+3*u,c),f+=3*u,D*=-1;for(this.ctx.bezierCurveTo(f+u,c+D*u,f+2*u,c+D*u,f+3*u,c),D*=-1,this.ctx.lineTo(f,c=y),k=0;k<d;k++)this.ctx.bezierCurveTo(f-u,c+D*u,f-2*u,c+D*u,f-3*u,c),f-=3*u,D*=-1}else if("zigzag"===this.type){for(D=1,c=w-u,d=(o-(f=x+u))/u/2,k=0;k<d;k++)this.ctx.lineTo(f,c),c+=2*D*u,f+=2*u,D*=-1;for(this.ctx.lineTo(f,c),c+=y-w,k=0;k<d+1;k++)this.ctx.lineTo(f,c),c+=2*D*u,f-=2*u,D*=-1;this.ctx.lineTo(f+u,c+D*u)}0<M&&this.ctx.stroke(),this.ctx.closePath(),this.ctx.globalAlpha=this.fillOpacity,this.ctx.globalCompositeOperation="destination-over",this.ctx.fill(),this.ctx.restore(),this.ctx.globalAlpha=g,this.ctx=I}},On(yt,Wi),yt.prototype.createUserOptions=function(u){if(typeof u<"u"||this.options._isPlaceholder){var I=0;this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.options._isPlaceholder||(Et(this.parent.stripLines),I=this.parent.options.stripLines.indexOf(this.options)),this.options=typeof u>"u"?{}:u,this.parent.options.stripLines[I]=this.options}},yt.prototype.render=function(){this.ctx.save();var u=this.parent.getPixelCoordinatesOnAxis(this.value),I=Math.abs("pixel"===this._thicknessType?this.thickness:Math.abs(this.parent.convertValueToPixel(this.endValue)-this.parent.convertValueToPixel(this.startValue)));if(0<I){var g=null===this.opacity?1:this.opacity;this.ctx.strokeStyle=this.color,this.ctx.beginPath();var w,D,o,y,x=this.ctx.globalAlpha;this.ctx.globalAlpha=g,bi(this.id),this.ctx.lineWidth=I,this.ctx.setLineDash&&this.ctx.setLineDash(tn(this.lineDashType,I)),"bottom"===this.parent._position||"top"===this.parent._position?(w=D=this.ctx.lineWidth%2==1?.5+(u.x<<0):u.x<<0,this.bounds={x1:w-I/2,y1:o=this.chart.plotArea.y1,x2:D+I/2,y2:y=this.chart.plotArea.y2}):("left"===this.parent._position||"right"===this.parent._position)&&(o=y=this.ctx.lineWidth%2==1?.5+(u.y<<0):u.y<<0,this.bounds={x1:w=this.chart.plotArea.x1,y1:o-I/2,x2:D=this.chart.plotArea.x2,y2:y+I/2}),this.ctx.moveTo(w,o),this.ctx.lineTo(D,y),this.ctx.stroke(),this.ctx.globalAlpha=x}this.ctx.restore()},On(ct,Wi),ct.prototype.showAt=function(u){if(!this.enabled)return!1;var I=this.chart,g=!1;if(I.resetOverlayedCanvas(),I.clearedOverlayedCanvas=this.parent.type,this.chart.renderCrosshairs(this.parent),"xySwapped"===I.plotInfo.axisPlacement){if("bottom"===this.parent._position)for(var x=0;x<I.axisY.length;x++)this.parent===I.axisY[x]&&(I.axisY[x]._crosshairValue=u>=I.axisY[x].viewportMinimum&&u<=I.axisY[x].viewportMaximum?u:null);else if("top"===this.parent._position)for(x=0;x<I.axisY2.length;x++)this.parent===I.axisY2[x]&&(I.axisY2[x]._crosshairValue=u>=I.axisY2[x].viewportMinimum&&u<=I.axisY2[x].viewportMaximum?u:null);else if("left"===this.parent._position)for(x=0;x<I.axisX.length;x++)this.parent===I.axisX[x]&&(I.axisX[x]._crosshairValue=u>=I.axisX[x].viewportMinimum&&u<=I.axisX[x].viewportMaximum?u:null);else if("right"===this.parent._position)for(x=0;x<I.axisX2.length;x++)this.parent===I.axisX2[x]&&(I.axisX2[x]._crosshairValue=u>=I.axisX2[x].viewportMinimum&&u<=I.axisX2[x].viewportMaximum?u:null)}else if("bottom"===this.parent._position)for(x=0;x<I.axisX.length;x++)this.parent===I.axisX[x]&&(I.axisX[x]._crosshairValue=u>=I.axisX[x].viewportMinimum&&u<=I.axisX[x].viewportMaximum?u:null);else if("top"===this.parent._position)for(x=0;x<I.axisX2.length;x++)this.parent===I.axisX2[x]&&(I.axisX2[x]._crosshairValue=u>=I.axisX2[x].viewportMinimum&&u<=I.axisX2[x].viewportMaximum?u:null);else if("left"===this.parent._position)for(x=0;x<I.axisY.length;x++)this.parent===I.axisY[x]&&(I.axisY[x]._crosshairValue=u>=I.axisY[x].viewportMinimum&&u<=I.axisY[x].viewportMaximum?u:null);else if("right"===this.parent._position)for(x=0;x<I.axisY2.length;x++)this.parent===I.axisY2[x]&&(I.axisY2[x]._crosshairValue=u>=I.axisY2[x].viewportMinimum&&u<=I.axisY2[x].viewportMaximum?u:null);for(x=0;x<I.axisX.length;x++)u=I.axisX[x]._crosshairValue,I.axisX[x].crosshair&&I.axisX[x].crosshair.enabled&&!$t(u)&&u>=I.axisX[x].viewportMinimum&&u<=I.axisX[x].viewportMaximum&&(I.axisX[x].showCrosshair(u),I.axisX[x].crosshair._updatedValue=u,this===I.axisX[x].crosshair&&(g=!0));for(x=0;x<I.axisX2.length;x++)u=I.axisX2[x]._crosshairValue,I.axisX2[x].crosshair&&I.axisX2[x].crosshair.enabled&&!$t(u)&&u>=I.axisX2[x].viewportMinimum&&u<=I.axisX2[x].viewportMaximum&&(I.axisX2[x].showCrosshair(u),I.axisX2[x].crosshair._updatedValue=u,this===I.axisX2[x].crosshair&&(g=!0));for(x=0;x<I.axisY.length;x++)u=I.axisY[x]._crosshairValue,I.axisY[x].crosshair&&I.axisY[x].crosshair.enabled&&!$t(u)&&u>=I.axisY[x].viewportMinimum&&u<=I.axisY[x].viewportMaximum&&(I.axisY[x].showCrosshair(u),I.axisY[x].crosshair._updatedValue=u,this===I.axisY[x].crosshair&&(g=!0));for(x=0;x<I.axisY2.length;x++)u=I.axisY2[x]._crosshairValue,I.axisY2[x].crosshair&&I.axisY2[x].crosshair.enabled&&!$t(u)&&u>=I.axisY2[x].viewportMinimum&&u<=I.axisY2[x].viewportMaximum&&(I.axisY2[x].showCrosshair(u),I.axisY2[x].crosshair._updatedValue=u,this===I.axisY2[x].crosshair&&(g=!0));return this.chart.toolTip&&this.chart.toolTip._entries&&this.chart.toolTip.highlightObjects(this.chart.toolTip._entries),g},ct.prototype.hide=function(){this.chart.resetOverlayedCanvas(),this.chart.renderCrosshairs(this.parent),this._hidden=!0},ct.prototype.render=function(u,I,g){var x,w,D,o,y=null,f=null,d=null,c="";if(!this.valueFormatString)if("dateTime"===this.parent.valueType)this.valueFormatString=this.parent.valueFormatString;else{var M=0;M="xySwapped"===this.chart.plotInfo.axisPlacement?50<this.parent.range?0:500<this.chart.width&&25>this.parent.range?2:Math.floor(Math.abs(Math.log(this.parent.range)/Math.LN10))+(5>this.parent.range?2:10>this.parent.range?1:0):50<this.parent.range?0:Math.floor(Math.abs(Math.log(this.parent.range)/Math.LN10))+(5>this.parent.range?2:10>this.parent.range?1:0),this.valueFormatString=Q.generateValueFormatString(this.parent.range,M)}d=null===this.opacity?1:this.opacity,M=Math.abs("pixel"===this._thicknessType?this.thickness:this.parent.conversionParameters.pixelPerUnit*this.thickness);var k=this.chart.overlaidCanvasCtx,C=k.globalAlpha;if(k.globalAlpha=d,k.beginPath(),k.strokeStyle=this.color,k.lineWidth=M,k.save(),this.labelFontSize=Math.abs($t(this.options.labelFontSize)?this.parent.labelFontSize:this.labelFontSize),this.labelMaxWidth=$t(this.options.labelMaxWidth)?.3*this.chart.width:this.labelMaxWidth,this.labelMaxHeight=$t(this.options.labelWrap)||this.labelWrap?.3*this.chart.height:2*this.labelFontSize,0<M&&k.setLineDash&&k.setLineDash(tn(this.lineDashType,M)),d=new Ri(k,{x:0,y:0,padding:{top:2,right:3,bottom:2,left:4},backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,maxWidth:this.labelMaxWidth,maxHeight:this.labelMaxHeight,angle:this.labelAngle,text:c,horizontalAlign:"left",fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this.snapToDataPoint){var R=0;if(c=[],"xySwapped"===this.chart.plotInfo.axisPlacement){var B=null;"bottom"===this.parent._position||"top"===this.parent._position?R=this.parent.dataSeries[0].axisX.convertPixelToValue({y:I}):("left"===this.parent._position||"right"===this.parent._position)&&(R=this.parent.convertPixelToValue({y:I}));for(var O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(B.dataSeries=this.parent.dataSeries[O],null!==B.dataPoint.y&&B.dataSeries.visible&&c.push(B));if(B=null,0===c.length)return;if(c.sort(function(J,q){return J.distance-q.distance}),B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y)),O=0,"rangeBar"===c[0].dataSeries.type||"error"===c[0].dataSeries.type){B=Math.abs(u-this.parent.convertValueToPixel(c[O].dataPoint.y[0]));var L=0;for(R=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(var X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y)))<B&&(B=L,O=R)}else if("stackedBar"===c[0].dataSeries.type){B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y));var E=L=0;for(R=O=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else E+=c[R].dataPoint.y,(L=Math.abs(u-this.parent.convertValueToPixel(E)))<B&&(B=L,O=R)}else if("stackedBar100"===c[0].dataSeries.type){B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y));var Y=E=L=0;for(R=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else E+=c[R].dataPoint.y,Y=c[R].dataPoint.x.getTime?c[R].dataPoint.x.getTime():c[R].dataPoint.x,Y=E/c[R].dataSeries.plotUnit.dataPointYSums[Y]*100,(L=Math.abs(u-this.parent.convertValueToPixel(Y)))<B&&(B=L,O=R)}else for(B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y)),R=O=L=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else(L=Math.abs(u-this.parent.convertValueToPixel(c[R].dataPoint.y)))<B&&(B=L,O=R);if(X=c[O],"bottom"===this.parent._position||"top"===this.parent._position){if(x=0,"rangeBar"===this.parent.dataSeries[O].type||"error"===this.parent.dataSeries[O].type){for(B=Math.abs(u-this.parent.convertValueToPixel(X.dataPoint.y[0])),R=L=0;R<X.dataPoint.y.length;R++)(L=Math.abs(u-this.parent.convertValueToPixel(X.dataPoint.y[R])))<B&&(B=L,x=R);y=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataPoint.y[x])<<0):this.parent.convertValueToPixel(X.dataPoint.y[x])<<0,this.value=X.dataPoint.y[x],d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.y[x]}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y[x]:g,this.valueFormatString,this.chart._cultureInfo):this.label}else if("stackedBar"===this.parent.dataSeries[O].type){for(B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y)),E=L=0,R=O;0<=R;R--)E+=c[R].dataPoint.y,(L=Math.abs(u-this.parent.convertValueToPixel(E)))<B&&(B=L,x=R);y=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(E)<<0):this.parent.convertValueToPixel(E)<<0,this.value=E,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.y}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y:g,this.valueFormatString,this.chart._cultureInfo):this.label}else if("stackedBar100"===this.parent.dataSeries[O].type){for(B=Math.abs(u-this.parent.convertValueToPixel(c[0].dataPoint.y)),Y=E=L=0,R=O;0<=R;R--)E+=c[R].dataPoint.y,Y=c[R].dataPoint.x.getTime?c[R].dataPoint.x.getTime():c[R].dataPoint.x,Y=E/c[R].dataSeries.plotUnit.dataPointYSums[Y]*100,(L=Math.abs(u-this.parent.convertValueToPixel(Y)))<B&&(B=L,x=R);y=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(Y)<<0):this.parent.convertValueToPixel(Y)<<0,this.value=Y,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:Y}):$t(this.options.label)?Ps($t(g)?Y:g,this.valueFormatString,this.chart._cultureInfo):this.label}else y=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataPoint.y)<<0):this.parent.convertValueToPixel(X.dataPoint.y)<<0,this.value=X.dataPoint.y,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.y}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y:g,this.valueFormatString,this.chart._cultureInfo):this.label;x=w=y,this.bounds={x1:x-M/2,y1:D=this.chart.plotArea.y1,x2:w+M/2,y2:o=this.chart.plotArea.y2},d.x=x-d.measureText().width/2,d.x+d.width>this.chart.bounds.x2?d.x=this.chart.bounds.x2-d.width:d.x<this.chart.bounds.x1&&(d.x=this.chart.bounds.x1),d.y=this.parent.lineCoordinates.y2+("top"===this.parent._position?-d.height+this.parent.tickLength:d.fontSize/2)+2,d.y+d.height>this.chart.bounds.y2?d.y=this.chart.bounds.y2-d.height:d.y<this.chart.bounds.y1&&(d.y=this.chart.bounds.y1)}else if("left"===this.parent._position||"right"===this.parent._position){if(D=o=f=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataPoint.x)<<0):this.parent.convertValueToPixel(X.dataPoint.x)<<0,this.bounds={x1:x=this.chart.plotArea.x1,y1:D-M/2,x2:w=this.chart.plotArea.x2,y2:o+M/2},Y=!1,this.parent.labels)for(c=Math.ceil(this.parent.interval),R=0;R<this.parent.viewportMaximum;R+=c){if(!this.parent.labels[R]){Y=!1;break}Y=!0}if(Y){if("axisX"===this.parent.type)for(R=this.parent.convertPixelToValue({y:I}),B=null,O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?B.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?_o(X.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?Ps(X.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label);this.value=X.dataPoint.x,d.y=o+d.fontSize/2-d.measureText().height/2+2,d.y-d.fontSize/2<this.chart.bounds.y1?d.y=this.chart.bounds.y1+d.fontSize/2+2:d.y+d.measureText().height-d.fontSize/2>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.measureText().height+d.fontSize/2),"left"===this.parent._position?d.x=this.parent.lineCoordinates.x2-d.measureText().width:"right"===this.parent._position&&(d.x=this.parent.lineCoordinates.x2)}}else if("bottom"===this.parent._position||"top"===this.parent._position){for(R=this.parent.convertPixelToValue({x:u}),O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(B.dataSeries=this.parent.dataSeries[O],null!==B.dataPoint.y&&B.dataSeries.visible&&c.push(B));if(0===c.length)return;if(c.sort(function(J,q){return J.distance-q.distance}),X=c[0],x=w=y=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataPoint.x)<<0):this.parent.convertValueToPixel(X.dataPoint.x)<<0,this.bounds={x1:x-M/2,y1:D=this.chart.plotArea.y1,x2:w+M/2,y2:o=this.chart.plotArea.y2},Y=!1,this.parent.labels)for(c=Math.ceil(this.parent.interval),R=0;R<this.parent.viewportMaximum;R+=c){if(!this.parent.labels[R]){Y=!1;break}Y=!0}if(Y){if("axisX"===this.parent.type)for(R=this.parent.convertPixelToValue({x:u}),B=null,O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?B.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?_o(X.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.x}):$t(this.options.label)?Ps(X.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label);this.value=X.dataPoint.x,d.x=x-d.measureText().width/2,d.x+d.width>this.chart.bounds.x2&&(d.x=this.chart.bounds.x2-d.width),d.x<this.chart.bounds.x1&&(d.x=this.chart.bounds.x1),"bottom"===this.parent._position?d.y=this.parent.lineCoordinates.y2+d.fontSize/2+2:"top"===this.parent._position&&(d.y=this.parent.lineCoordinates.y1-d.height+d.fontSize/2+2)}else if("left"===this.parent._position||"right"===this.parent._position){for(!$t(this.parent.dataSeries)&&0<this.parent.dataSeries.length&&(R=this.parent.dataSeries[0].axisX.convertPixelToValue({x:u})),O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(B.dataSeries=this.parent.dataSeries[O],null!==B.dataPoint.y&&B.dataSeries.visible&&c.push(B));if(0===c.length)return;if(c.sort(function(J,q){return J.distance-q.distance}),O=0,"rangeColumn"===c[0].dataSeries.type||"rangeArea"===c[0].dataSeries.type||"error"===c[0].dataSeries.type||"rangeSplineArea"===c[0].dataSeries.type||"candlestick"===c[0].dataSeries.type||"ohlc"===c[0].dataSeries.type||"boxAndWhisker"===c[0].dataSeries.type)for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y[0])),R=L=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y)))<B&&(B=L,O=R);else if("stackedColumn"===c[0].dataSeries.type||"stackedArea"===c[0].dataSeries.type)for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y)),R=E=L=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else E+=c[R].dataPoint.y,(L=Math.abs(I-this.parent.convertValueToPixel(E)))<B&&(B=L,O=R);else if("stackedColumn100"===c[0].dataSeries.type||"stackedArea100"===c[0].dataSeries.type)for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y)),R=Y=E=L=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else E+=c[R].dataPoint.y,Y=c[R].dataPoint.x.getTime?c[R].dataPoint.x.getTime():c[R].dataPoint.x,Y=E/c[R].dataSeries.plotUnit.dataPointYSums[Y]*100,(L=Math.abs(I-this.parent.convertValueToPixel(Y)))<B&&(B=L,O=R);else for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y)),R=L=0;R<c.length;R++)if(c[R].dataPoint.y&&c[R].dataPoint.y.length)for(X=0;X<c[R].dataPoint.y.length;X++)(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y[X])))<B&&(B=L,O=R);else(L=Math.abs(I-this.parent.convertValueToPixel(c[R].dataPoint.y)))<B&&(B=L,O=R);if(X=c[O],x=0,"rangeColumn"===this.parent.dataSeries[O].type||"rangeArea"===this.parent.dataSeries[O].type||"error"===this.parent.dataSeries[O].type||"rangeSplineArea"===this.parent.dataSeries[O].type||"candlestick"===this.parent.dataSeries[O].type||"ohlc"===this.parent.dataSeries[O].type||"boxAndWhisker"===this.parent.dataSeries[O].type){for(B=Math.abs(I-this.parent.convertValueToPixel(X.dataPoint.y[0])),R=L=0;R<X.dataPoint.y.length;R++)(L=Math.abs(I-this.parent.convertValueToPixel(X.dataPoint.y[R])))<B&&(B=L,x=R);f=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataPoint.y[x])<<0):this.parent.convertValueToPixel(X.dataPoint.y[x])<<0,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.y[x]}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y[x]:g,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=X.dataPoint.y[x]}else if("stackedColumn"===this.parent.dataSeries[O].type||"stackedArea"===this.parent.dataSeries[O].type){for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y)),E=L=0,R=O;0<=R;R--)E+=c[R].dataPoint.y,(L=Math.abs(I-this.parent.convertValueToPixel(E)))<B&&(B=L,x=R);f=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(E)<<0):this.parent.convertValueToPixel(E)<<0,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataPoint.y}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y:g,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=E}else if("stackedColumn100"===this.parent.dataSeries[O].type||"stackedArea100"===this.parent.dataSeries[O].type){for(B=Math.abs(I-this.parent.convertValueToPixel(c[0].dataPoint.y)),E=L=0,R=O;0<=R;R--)E+=c[R].dataPoint.y,Y=c[R].dataPoint.x.getTime?c[R].dataPoint.x.getTime():c[R].dataPoint.x,Y=E/c[R].dataSeries.plotUnit.dataPointYSums[Y]*100,(L=Math.abs(I-this.parent.convertValueToPixel(Y)))<B&&(B=L,x=R);f=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(Y)<<0):this.parent.convertValueToPixel(Y)<<0,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:Y}):$t(this.options.label)?Ps($t(g)?Y:g,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=Y}else"waterfall"===this.parent.dataSeries[O].type?(f=k.lineWidth%2==1?.5+(this.parent.convertValueToPixel(X.dataSeries.dataPointEOs[X.index].cumulativeSum)<<0):this.parent.convertValueToPixel(X.dataSeries.dataPointEOs[X.index].cumulativeSum)<<0,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:X.dataSeries.dataPointEOs[X.index].cumulativeSum}):$t(this.options.label)?Ps($t(g)?X.dataSeries.dataPointEOs[X.index].cumulativeSum:g,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=X.dataSeries.dataPointEOs[X.index].cumulativeSum):(f=k.lineWidth%2==1?($t(u)?I:this.parent.convertValueToPixel(X.dataPoint.y)<<0)+.5:$t(u)?I:this.parent.convertValueToPixel(X.dataPoint.y)<<0,d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?X.dataPoint.y:g}):$t(this.options.label)?Ps($t(g)?X.dataPoint.y:g,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=X.dataPoint.y);D=o=f,this.bounds={x1:x=this.chart.plotArea.x1,y1:D-M/2,x2:w=this.chart.plotArea.x2,y2:o+M/2},d.y=o+d.fontSize/2-d.measureText().height/2+2,d.y-d.fontSize/2<this.chart.bounds.y1?d.y=this.chart.bounds.y1+d.fontSize/2+2:d.y+d.measureText().height-d.fontSize/2>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.measureText().height+d.fontSize/2),"left"===this.parent._position?d.x=this.parent.lineCoordinates.x2-d.measureText().width:"right"===this.parent._position&&(d.x=this.parent.lineCoordinates.x2)}c=null,("bottom"===this.parent._position||"top"===this.parent._position)&&("top"===this.parent._position&&d.y-d.fontSize/2<this.chart.bounds.y1&&(d.y=this.chart.bounds.y1+d.fontSize/2),"bottom"===this.parent._position&&this.parent.lineCoordinates.y2-d.fontSize/2+d.measureText().height>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.height+d.fontSize/2+2),x>=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMaximum:this.parent.viewportMinimum)&&w<=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMinimum:this.parent.viewportMaximum)&&(0<M&&(k.moveTo(x,D),k.lineTo(w,o),k.stroke(),this._hidden=!1),k.restore())),("left"===this.parent._position||"right"===this.parent._position)&&("left"===this.parent._position&&d.x<this.chart.bounds.x1&&(d.x=this.chart.bounds.x1),"right"===this.parent._position&&d.x+d.measureText().width>this.chart.bounds.x2&&(d.x=this.chart.bounds.x2-d.measureText().width),o>=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMinimum:this.parent.viewportMaximum)&&D<=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMaximum:this.parent.viewportMinimum)&&(0<M&&(k.moveTo(x,D),k.lineTo(w,o),k.stroke(),this._hidden=!1),k.restore()))}else{if("bottom"===this.parent._position||"top"===this.parent._position?(x=w=y=k.lineWidth%2==1?.5+(u<<0):u<<0,this.bounds={x1:x-M/2,y1:D=this.chart.plotArea.y1,x2:w+M/2,y2:o=this.chart.plotArea.y2}):("left"===this.parent._position||"right"===this.parent._position)&&(D=o=f=k.lineWidth%2==1?.5+(I<<0):I<<0,this.bounds={x1:x=this.chart.plotArea.x1,y1:D-M/2,x2:w=this.chart.plotArea.x2,y2:o+M/2}),"xySwapped"===this.chart.plotInfo.axisPlacement)if("left"===this.parent._position||"right"===this.parent._position){if(Y=!1,this.parent.labels)for(c=Math.ceil(this.parent.interval),R=0;R<this.parent.viewportMaximum;R+=c){if(!this.parent.labels[R]){Y=!1;break}Y=!0}if(Y){if("axisX"===this.parent.type)for(R=this.parent.convertPixelToValue({y:I}),B=null,O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(u):g}):$t(this.options.label)?B.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(I):g}):$t(this.options.label)?_o($t(g)?this.parent.convertPixelToValue(I):g,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(I):g}):$t(this.options.label)?Ps($t(g)?this.parent.convertPixelToValue(I):g,this.valueFormatString,this.chart._cultureInfo):this.label);d.y=I+d.fontSize/2-d.measureText().height/2+2,d.y-d.fontSize/2<this.chart.bounds.y1?d.y=this.chart.bounds.y1+d.fontSize/2+2:d.y+d.measureText().height-d.fontSize/2>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.measureText().height+d.fontSize/2),"left"===this.parent._position?d.x=this.parent.lineCoordinates.x1-d.measureText().width:"right"===this.parent._position&&(d.x=this.parent.lineCoordinates.x2)}else("bottom"===this.parent._position||"top"===this.parent._position)&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(u):g}):$t(this.options.label)?Ps($t(g)?this.parent.convertPixelToValue(u):g,this.valueFormatString,this.chart._cultureInfo):this.label,d.x=x-d.measureText().width/2,d.x+d.width>this.chart.bounds.x2&&(d.x=this.chart.bounds.x2-d.width),d.x<this.chart.bounds.x1&&(d.x=this.chart.bounds.x1),"bottom"===this.parent._position?d.y=this.parent.lineCoordinates.y2+d.fontSize/2+2:"top"===this.parent._position&&(d.y=this.parent.lineCoordinates.y1-d.height+d.fontSize/2+2));else if("bottom"===this.parent._position||"top"===this.parent._position){if(Y=!1,c="",this.parent.labels)for(c=Math.ceil(this.parent.interval),R=0;R<this.parent.viewportMaximum;R+=c){if(!this.parent.labels[R]){Y=!1;break}Y=!0}if(Y){if("axisX"===this.parent.type)for(R=this.parent.convertPixelToValue({x:u}),B=null,O=0;O<this.parent.dataSeries.length;O++)(B=this.parent.dataSeries[O].getDataPointAtX(R,!0))&&0<=B.index&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(u):g}):$t(this.options.label)?$t(g)?B.dataPoint.label:g:this.label)}else"dateTime"===this.parent.valueType?d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(u):g}):$t(this.options.label)?_o($t(g)?this.parent.convertPixelToValue(u):g,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?0<this.parent.dataSeries.length?this.parent.convertPixelToValue(u):"":g}):$t(this.options.label)?Ps($t(g)?this.parent.convertPixelToValue(u):g,this.valueFormatString,this.chart._cultureInfo):this.label);d.x=x-d.measureText().width/2,d.x+d.width>this.chart.bounds.x2&&(d.x=this.chart.bounds.x2-d.width),d.x<this.chart.bounds.x1&&(d.x=this.chart.bounds.x1),"bottom"===this.parent._position?d.y=this.parent.lineCoordinates.y2+d.fontSize/2+2:"top"===this.parent._position&&(d.y=this.parent.lineCoordinates.y1-d.height+d.fontSize/2+2)}else("left"===this.parent._position||"right"===this.parent._position)&&(d.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:$t(g)?this.parent.convertPixelToValue(I):g}):$t(this.options.label)?Ps($t(g)?this.parent.convertPixelToValue(I):g,this.valueFormatString,this.chart._cultureInfo):this.label,d.y=I+d.fontSize/2-d.measureText().height/2+2,d.y-d.fontSize/2<this.chart.bounds.y1?d.y=this.chart.bounds.y1+d.fontSize/2+2:d.y+d.measureText().height-d.fontSize/2>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.measureText().height+d.fontSize/2),"left"===this.parent._position?d.x=this.parent.lineCoordinates.x2-d.measureText().width:"right"===this.parent._position&&(d.x=this.parent.lineCoordinates.x2));"left"===this.parent._position&&d.x<this.chart.bounds.x1?d.x=this.chart.bounds.x1:"right"===this.parent._position&&d.x+d.measureText().width>this.chart.bounds.x2?d.x=this.chart.bounds.x2-d.measureText().width:"top"===this.parent._position&&d.y-d.fontSize/2<this.chart.bounds.y1?d.y=this.chart.bounds.y1+d.fontSize/2:"bottom"===this.parent._position&&this.parent.lineCoordinates.y2-d.fontSize/2+d.measureText().height>this.chart.bounds.y2&&(d.y=this.chart.bounds.y2-d.height+d.fontSize/2+2),0<M&&(k.moveTo(x,D),k.lineTo(w,o),k.stroke(),this._hidden=!1),k.restore(),this.value=this.parent.convertPixelToValue("bottom"===this.parent._position||"top"===this.parent._position?u:I)}("bottom"===this.parent._position||"top"===this.parent._position)&&(this._updatedValue=this.parent.convertPixelToValue(y)),("left"===this.parent._position||"right"===this.parent._position)&&(this._updatedValue=this.parent.convertPixelToValue(f)),this._textBlock=d,$t(g)||this.renderLabel(),k.globalAlpha=C},ct.prototype.renderLabel=function(){$t(this._textBlock)||$t(this._textBlock.text)||!("number"==typeof this._textBlock.text.valueOf()||0<this._textBlock.text.length)||this._hidden||this._textBlock.render(!0)},On(pt,Wi),pt.prototype._initialize=function(){if(this.updateOption("updated"),this.updateOption("hidden"),this.enabled){this.container=document.createElement("div"),this.container.setAttribute("class","canvasjs-chart-tooltip"),this.container.style.position="absolute",this.container.style.height="auto",this.container.style.boxShadow="1px 1px 2px 2px rgba(0,0,0,0.1)",this.container.style.zIndex="1000",this.container.style.pointerEvents="none",this.container.style.display="none";var u=document.createElement("div");u.style.width="auto",u.style.height="auto",u.style.minWidth="50px",u.style.lineHeight="normal",u.style.margin="0px 0px 0px 0px",u.style.padding="5px",u.style.fontFamily="Calibri, Arial, Georgia, serif",u.style.fontWeight="normal",u.style.fontStyle=oe?"italic":"normal",u.style.fontSize="14px",u.style.color="#000000",u.style.textShadow="1px 1px 1px rgba(0, 0, 0, 0.1)",u.style.textAlign="left",u.style.border="2px solid gray",u.style.background=oe?"rgba(255,255,255,.9)":"rgb(255,255,255)",u.style.textIndent="0px",u.style.whiteSpace="nowrap",u.style.borderRadius="5px",u.style.MozUserSelect="none",u.style.WebkitUserSelect="none",u.style.msUserSelect="none",u.style.userSelect="none",oe||(u.style.filter="alpha(opacity = 90)",u.style.filter="progid:DXImageTransform.Microsoft.Shadow(Strength=3, Direction=135, Color='#666666')"),u.innerText="Sample Tooltip",this.container.appendChild(u),this.contentDiv=this.container.firstChild,this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.chart._canvasJSContainer.appendChild(this.container)}},pt.prototype.mouseMoveHandler=function(u,I){this._lastUpdated&&4>(new Date).getTime()-this._lastUpdated||(this._lastUpdated=(new Date).getTime(),this.chart.resetOverlayedCanvas(),this._updateToolTip(u,I))},pt.prototype._updateToolTip=function(u,I,g){if(g=typeof g>"u"||g,this.container||this._initialize(),this.enabled||this.hide(),!this.chart.disableToolTip){if(typeof u>"u"||typeof I>"u"){if(isNaN(this._prevX)||isNaN(this._prevY))return;u=this._prevX,I=this._prevY}else this._prevX=u,this._prevY=I;var x=null,w=null,D=[],o=0;if(this.shared&&this.enabled&&"none"!==this.chart.plotInfo.axisPlacement){var y=[];if(this.chart.axisX)for(var f=0;f<this.chart.axisX.length;f++){o=this.chart.axisX[f].convertPixelToValue("xySwapped"===this.chart.plotInfo.axisPlacement?{y:I}:{x:u});var c=null;for(x=0;x<this.chart.axisX[f].dataSeries.length;x++)(c=this.chart.axisX[f].dataSeries[x].getDataPointAtX(o,g))&&0<=c.index&&(c.dataSeries=this.chart.axisX[f].dataSeries[x],null!==c.dataPoint.y&&c.dataSeries.visible&&y.push(c));c=null}if(this.chart.axisX2)for(f=0;f<this.chart.axisX2.length;f++){for(o=this.chart.axisX2[f].convertPixelToValue("xySwapped"===this.chart.plotInfo.axisPlacement?{y:I}:{x:u}),c=null,x=0;x<this.chart.axisX2[f].dataSeries.length;x++)(c=this.chart.axisX2[f].dataSeries[x].getDataPointAtX(o,g))&&0<=c.index&&(c.dataSeries=this.chart.axisX2[f].dataSeries[x],null!==c.dataPoint.y&&c.dataSeries.visible&&y.push(c));c=null}if(0===y.length)return;for(y.sort(function(d,M){return d.distance-M.distance}),g=y[0],x=0;x<y.length;x++)y[x].dataPoint.x.valueOf()===g.dataPoint.x.valueOf()&&D.push(y[x]);y=null}else{if(x=this.chart.getDataPointAtXY(u,I,g))this.currentDataPointIndex=x.dataPointIndex,this.currentSeriesIndex=x.dataSeries.index;else if(oe)if(0<(x=xi(u,I,this.chart._eventManager.ghostCtx))&&typeof this.chart._eventManager.objectMap[x]<"u"){if("legendItem"===(x=this.chart._eventManager.objectMap[x]).objectType)return;this.currentSeriesIndex=x.dataSeriesIndex,this.currentDataPointIndex=0<=x.dataPointIndex?x.dataPointIndex:-1}else this.currentDataPointIndex=-1;else this.currentDataPointIndex=-1;if(0<=this.currentSeriesIndex){if(w=this.chart.data[this.currentSeriesIndex],c={},0<=this.currentDataPointIndex)x=w.dataPoints[this.currentDataPointIndex],c.dataSeries=w,c.dataPoint=x,c.index=this.currentDataPointIndex,c.distance=Math.abs(x.x-o),"waterfall"===w.type&&(c.cumulativeSumYStartValue=w.dataPointEOs[this.currentDataPointIndex].cumulativeSumYStartValue,c.cumulativeSum=w.dataPointEOs[this.currentDataPointIndex].cumulativeSum);else{if(!this.enabled||"line"!==w.type&&"stepLine"!==w.type&&"spline"!==w.type&&"area"!==w.type&&"stepArea"!==w.type&&"splineArea"!==w.type&&"stackedArea"!==w.type&&"stackedArea100"!==w.type&&"rangeArea"!==w.type&&"rangeSplineArea"!==w.type&&"candlestick"!==w.type&&"ohlc"!==w.type&&"boxAndWhisker"!==w.type)return;o=w.axisX.convertPixelToValue({x:u}),$t(c=w.getDataPointAtX(o,g))||(c.dataSeries=w,this.currentDataPointIndex=c.index,x=c.dataPoint)}if(!$t(c)&&!$t(c.dataPoint)&&!$t(c.dataPoint.y))if(c.dataSeries.axisY)if(0<c.dataPoint.y.length){for(x=g=0;x<c.dataPoint.y.length;x++)c.dataPoint.y[x]<c.dataSeries.axisY.viewportMinimum?g--:c.dataPoint.y[x]>c.dataSeries.axisY.viewportMaximum&&g++;g<c.dataPoint.y.length&&g>-c.dataPoint.y.length&&D.push(c)}else"column"===w.type||"bar"===w.type?0>c.dataPoint.y?0>c.dataSeries.axisY.viewportMinimum&&c.dataSeries.axisY.viewportMaximum>=c.dataPoint.y&&D.push(c):c.dataSeries.axisY.viewportMinimum<=c.dataPoint.y&&0<=c.dataSeries.axisY.viewportMaximum&&D.push(c):"bubble"===w.type?c.dataPoint.y>=c.dataSeries.axisY.viewportMinimum-(g=this.chart._eventManager.objectMap[w.dataPointIds[c.index]].size/2)&&c.dataPoint.y<=c.dataSeries.axisY.viewportMaximum+g&&D.push(c):"waterfall"===w.type?(g=0,c.cumulativeSumYStartValue<c.dataSeries.axisY.viewportMinimum?g--:c.cumulativeSumYStartValue>c.dataSeries.axisY.viewportMaximum&&g++,c.cumulativeSum<c.dataSeries.axisY.viewportMinimum?g--:c.cumulativeSum>c.dataSeries.axisY.viewportMaximum&&g++,2>g&&-2<g&&D.push(c)):(0<=c.dataSeries.type.indexOf("100")||"stackedColumn"===w.type||"stackedBar"===w.type||c.dataPoint.y>=c.dataSeries.axisY.viewportMinimum&&c.dataPoint.y<=c.dataSeries.axisY.viewportMaximum)&&D.push(c);else D.push(c)}}if(0<D.length){if(this.highlightObjects(D),this.enabled){if(g="",null!==(g=this.getToolTipInnerHTML({entries:D}))){if(this.contentDiv.innerHTML=g,this.isToolTipDefinedInData&&$t(this.options.content)&&$t(this.options.contentFormatter))for(o=this.contentDiv.getElementsByTagName("span"),x=0;x<o.length;x++)o[x]&&(o[x].style.color=o[x].getAttribute("data-color"));o=!1,"none"===this.container.style.display&&(o=!0,this.container.style.display="block");try{this.contentDiv.style.background=this.backgroundColor?this.backgroundColor:oe?"rgba(255,255,255,.9)":"rgb(255,255,255)",this.borderColor=this.contentDiv.style.borderRightColor=this.contentDiv.style.borderLeftColor=this.contentDiv.style.borderColor="waterfall"===D[0].dataSeries.type?this.options.borderColor?this.options.borderColor:D[0].dataPoint.color?D[0].dataPoint.color:0<D[0].dataPoint.y?D[0].dataSeries.risingColor:D[0].dataSeries.fallingColor:"error"===D[0].dataSeries.type?this.options.borderColor?this.options.borderColor:D[0].dataSeries.color?D[0].dataSeries.color:D[0].dataSeries._colorSet[w.index%D[0].dataSeries._colorSet.length]:this.options.borderColor?this.options.borderColor:D[0].dataPoint.color?D[0].dataPoint.color:D[0].dataSeries.color?D[0].dataSeries.color:D[0].dataSeries._colorSet[D[0].index%D[0].dataSeries._colorSet.length],this.contentDiv.style.borderWidth=this.borderThickness||0===this.borderThickness?this.borderThickness+"px":"2px",this.contentDiv.style.borderRadius=this.cornerRadius||0===this.cornerRadius?this.cornerRadius+"px":"5px",this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.contentDiv.style.fontSize=this.fontSize||0===this.fontSize?this.fontSize+"px":"14px",this.contentDiv.style.color=this.fontColor?this.fontColor:"#000000",this.contentDiv.style.fontFamily=this.fontFamily?this.fontFamily:"Calibri, Arial, Georgia, serif;",this.contentDiv.style.fontWeight=this.fontWeight?this.fontWeight:"normal",this.contentDiv.style.fontStyle=this.fontStyle?this.fontStyle:oe?"italic":"normal"}catch{}"pie"===D[0].dataSeries.type||"doughnut"===D[0].dataSeries.type||"funnel"===D[0].dataSeries.type||"pyramid"===D[0].dataSeries.type||"bar"===D[0].dataSeries.type||"rangeBar"===D[0].dataSeries.type||"stackedBar"===D[0].dataSeries.type||"stackedBar100"===D[0].dataSeries.type?u=u-10-this.container.clientWidth:(u=D[0].dataSeries.axisX.convertValueToPixel(D[0].dataPoint.x)-this.container.clientWidth<<0,u-=10),0>u&&(u+=this.container.clientWidth+20),u+this.container.clientWidth>Math.max(this.chart.container.clientWidth,this.chart.width)&&(u=Math.max(0,Math.max(this.chart.container.clientWidth,this.chart.width)-this.container.clientWidth)),0<(I=10-(I=1!==D.length||this.shared||"line"!==D[0].dataSeries.type&&"stepLine"!==D[0].dataSeries.type&&"spline"!==D[0].dataSeries.type&&"area"!==D[0].dataSeries.type&&"stepArea"!==D[0].dataSeries.type&&"splineArea"!==D[0].dataSeries.type?"bar"===D[0].dataSeries.type||"rangeBar"===D[0].dataSeries.type||"stackedBar"===D[0].dataSeries.type||"stackedBar100"===D[0].dataSeries.type?D[0].dataSeries.axisX.convertValueToPixel(D[0].dataPoint.x):I:D[0].dataSeries.axisY.convertValueToPixel(D[0].dataPoint.y)))+this.container.clientHeight+5&&(I-=I+this.container.clientHeight+5-0),this.fixMozTransitionDelay(u,I),!this.animationEnabled||o?this.disableAnimation():(this.enableAnimation(),this.container.style.MozTransition=this.mozContainerTransition),this.positionLeft=u,this.positionBottom=I,this.container.style.left=u+"px",this.container.style.bottom=I+"px"}else this.hide(!1),this.enabled&&this.dispatchEvent("hidden",{chart:this.chart,toolTip:this},this);for(I=[],x=0;x<D.length;x++)I.push({xValue:D[x].dataPoint.x,dataPoint:D[x].dataPoint,dataSeries:D[x].dataSeries,dataPointIndex:D[x].index,dataSeriesIndex:D[x].dataSeries._index});I={chart:this.chart,toolTip:this.options,content:g,entries:I},this._entries=D,this.dispatchEvent("updated",I,this)}}else this.hide(),this.enabled&&this.dispatchEvent("hidden",{chart:this.chart,toolTip:this},this)}},pt.prototype.highlightObjects=function(u){var I=this.chart.overlaidCanvasCtx;($t(this.chart.clearedOverlayedCanvas)||"toolTip"===this.chart.clearedOverlayedCanvas)&&(this.chart.resetOverlayedCanvas(),I.clearRect(0,0,this.chart.width,this.chart.height),this.chart.clearedOverlayedCanvas="toolTip"),I.save();var g=this.chart.plotArea,x=0;for(I.beginPath(),I.rect(g.x1,g.y1,g.x2-g.x1,g.y2-g.y1),I.clip(),g=0;g<u.length;g++){var w=u[g];if((w=this.chart._eventManager.objectMap[w.dataSeries.dataPointIds[w.index]])&&w.objectType&&"dataPoint"===w.objectType){var D=(x=this.chart.data[w.dataSeriesIndex]).dataPoints[w.dataPointIndex],o=w.dataPointIndex;!1===D.highlightEnabled||!0!==x.highlightEnabled&&!0!==D.highlightEnabled||("line"===x.type||"stepLine"===x.type||"spline"===x.type||"scatter"===x.type||"area"===x.type||"stepArea"===x.type||"splineArea"===x.type||"stackedArea"===x.type||"stackedArea100"===x.type||"rangeArea"===x.type||"rangeSplineArea"===x.type?((D=x.getMarkerProperties(o,w.x1,w.y1,this.chart.overlaidCanvasCtx)).size=Math.max(1.5*D.size<<0,10),D.borderColor=D.borderColor||"#FFFFFF",D.borderThickness=D.borderThickness||Math.ceil(.1*D.size),ie.drawMarkers([D]),typeof w.y2<"u"&&((D=x.getMarkerProperties(o,w.x1,w.y2,this.chart.overlaidCanvasCtx)).size=Math.max(1.5*D.size<<0,10),D.borderColor=D.borderColor||"#FFFFFF",D.borderThickness=D.borderThickness||Math.ceil(.1*D.size),ie.drawMarkers([D]))):"bubble"===x.type?((D=x.getMarkerProperties(o,w.x1,w.y1,this.chart.overlaidCanvasCtx)).size=w.size,D.color="white",D.borderColor="white",I.globalAlpha=.3,ie.drawMarkers([D]),I.globalAlpha=1):"column"===x.type||"stackedColumn"===x.type||"stackedColumn100"===x.type||"bar"===x.type||"rangeBar"===x.type||"stackedBar"===x.type||"stackedBar100"===x.type||"rangeColumn"===x.type||"waterfall"===x.type?ps(I,w.x1,w.y1,w.x2,w.y2,"white",0,null,!1,!1,!1,!1,.3):"pie"===x.type||"doughnut"===x.type?Gt(I,w.center,w.radius,"white",x.type,w.startAngle,w.endAngle,.3,w.percentInnerRadius):"funnel"===x.type||"pyramid"===x.type?re(I,w.funnelSection,.3,"white"):"candlestick"===x.type?(I.globalAlpha=1,I.strokeStyle=w.color,I.lineWidth=2*w.borderThickness,x=I.lineWidth%2==0?0:.5,I.beginPath(),I.moveTo(w.x3-x,Math.min(w.y2,w.y3)),I.lineTo(w.x3-x,Math.min(w.y1,w.y4)),I.stroke(),I.beginPath(),I.moveTo(w.x3-x,Math.max(w.y1,w.y4)),I.lineTo(w.x3-x,Math.max(w.y2,w.y3)),I.stroke(),ps(I,w.x1,Math.min(w.y1,w.y4),w.x2,Math.max(w.y1,w.y4),"transparent",2*w.borderThickness,w.color,!1,!1,!1,!1),I.globalAlpha=1):"ohlc"===x.type?(I.globalAlpha=1,I.strokeStyle=w.color,I.lineWidth=2*w.borderThickness,x=I.lineWidth%2==0?0:.5,I.beginPath(),I.moveTo(w.x3-x,w.y2),I.lineTo(w.x3-x,w.y3),I.stroke(),I.beginPath(),I.moveTo(w.x3,w.y1),I.lineTo(w.x1,w.y1),I.stroke(),I.beginPath(),I.moveTo(w.x3,w.y4),I.lineTo(w.x2,w.y4),I.stroke(),I.globalAlpha=1):"boxAndWhisker"===x.type?(I.save(),I.globalAlpha=1,I.strokeStyle=w.stemColor,I.lineWidth=2*w.stemThickness,0<w.stemThickness&&(I.beginPath(),I.moveTo(w.x3,w.y2+w.borderThickness/2),I.lineTo(w.x3,w.y1+w.whiskerThickness/2),I.stroke(),I.beginPath(),I.moveTo(w.x3,w.y4-w.whiskerThickness/2),I.lineTo(w.x3,w.y3-w.borderThickness/2),I.stroke()),I.beginPath(),ps(I,w.x1-w.borderThickness/2,Math.max(w.y2+w.borderThickness/2,w.y3+w.borderThickness/2),w.x2+w.borderThickness/2,Math.min(w.y2-w.borderThickness/2,w.y3-w.borderThickness/2),"transparent",w.borderThickness,w.color,!1,!1,!1,!1),I.globalAlpha=1,I.strokeStyle=w.whiskerColor,I.lineWidth=2*w.whiskerThickness,0<w.whiskerThickness&&(I.beginPath(),I.moveTo(Math.floor(w.x3-w.whiskerLength/2),w.y4),I.lineTo(Math.ceil(w.x3+w.whiskerLength/2),w.y4),I.stroke(),I.beginPath(),I.moveTo(Math.floor(w.x3-w.whiskerLength/2),w.y1),I.lineTo(Math.ceil(w.x3+w.whiskerLength/2),w.y1),I.stroke()),I.globalAlpha=1,I.strokeStyle=w.lineColor,I.lineWidth=2*w.lineThickness,0<w.lineThickness&&(I.beginPath(),I.moveTo(w.x1,w.y5),I.lineTo(w.x2,w.y5),I.stroke()),I.restore(),I.globalAlpha=1):"error"===x.type&&Le(I,w.x1,w.y1,w.x2,w.y2,"white",w.whiskerProperties,w.stemProperties,w.isXYSwapped,.3))}}I.restore(),I.globalAlpha=1,I.beginPath()},pt.prototype.getToolTipInnerHTML=function(u){u=u.entries;var I=null,g=null,x=null,w=0,D="";this.isToolTipDefinedInData=!0;for(var o=0;o<u.length;o++)if(u[o].dataSeries.toolTipContent||u[o].dataPoint.toolTipContent){this.isToolTipDefinedInData=!1;break}if(this.isToolTipDefinedInData&&(this.content&&"function"==typeof this.content||this.contentFormatter))u={chart:this.chart,toolTip:this.options,entries:u},I=this.contentFormatter?this.contentFormatter(u):this.content(u);else if(this.shared&&"none"!==this.chart.plotInfo.axisPlacement){var y=null,f="";for(o=0;o<u.length;o++){if(g=u[o].dataSeries,x=u[o].dataPoint,w=u[o].index,D="",0===o&&this.isToolTipDefinedInData&&!this.content){if(this.chart.axisX&&0<this.chart.axisX.length?f+=typeof this.chart.axisX[0].labels[x.x]<"u"?this.chart.axisX[0].labels[x.x]:"{x}":this.chart.axisX2&&0<this.chart.axisX2.length&&(f+=typeof this.chart.axisX2[0].labels[x.x]<"u"?this.chart.axisX2[0].labels[x.x]:"{x}"),f+="</br>",!g.visible)continue;f=this.chart.replaceKeywordsWithValue(f,x,g,w)}null===x.toolTipContent||typeof x.toolTipContent>"u"&&null===g.options.toolTipContent||("line"===g.type||"stepLine"===g.type||"spline"===g.type||"area"===g.type||"stepArea"===g.type||"splineArea"===g.type||"column"===g.type||"bar"===g.type||"scatter"===g.type||"stackedColumn"===g.type||"stackedColumn100"===g.type||"stackedBar"===g.type||"stackedBar100"===g.type||"stackedArea"===g.type||"stackedArea100"===g.type||"waterfall"===g.type?(this.chart.axisX&&1<this.chart.axisX.length&&(D+=y!=g.axisXIndex?g.axisX.title?g.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),D+=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y}",y=g.axisXIndex):"bubble"===g.type?(this.chart.axisX&&1<this.chart.axisX.length&&(D+=y!=g.axisXIndex?g.axisX.title?g.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),D+=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y}, &nbsp;&nbsp;{z}"):"rangeColumn"===g.type||"rangeBar"===g.type||"rangeArea"===g.type||"rangeSplineArea"===g.type||"error"===g.type?(this.chart.axisX&&1<this.chart.axisX.length&&(D+=y!=g.axisXIndex?g.axisX.title?g.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),D+=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y[0]},&nbsp;{y[1]}"):"candlestick"===g.type||"ohlc"===g.type?(this.chart.axisX&&1<this.chart.axisX.length&&(D+=y!=g.axisXIndex?g.axisX.title?g.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),D+=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span><br/>Open: &nbsp;&nbsp;{y[0]}<br/>High: &nbsp;&nbsp;&nbsp;{y[1]}<br/>Low:&nbsp;&nbsp;&nbsp;{y[2]}<br/>Close: &nbsp;&nbsp;{y[3]}"):"boxAndWhisker"===g.type&&(this.chart.axisX&&1<this.chart.axisX.length&&(D+=y!=g.axisXIndex?g.axisX.title?g.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),D+=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span><br/>Minimum: &nbsp;&nbsp;{y[0]}<br/>Q1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[1]}<br/>Q2: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[4]}<br/>Q3: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Maximum: &nbsp;{y[3]}"),null===I&&(I=""),g.visible&&(!0===this.reversed?(I=this.chart.replaceKeywordsWithValue(D,x,g,w)+I,o<u.length-1&&(I="</br>"+I)):(I+=this.chart.replaceKeywordsWithValue(D,x,g,w),o<u.length-1&&(I+="</br>"))))}null!==I&&(I=f+I)}else{if(g=u[0].dataSeries,null===(x=u[0].dataPoint).toolTipContent||typeof x.toolTipContent>"u"&&null===g.options.toolTipContent)return null;"line"===g.type||"stepLine"===g.type||"spline"===g.type||"area"===g.type||"stepArea"===g.type||"splineArea"===g.type||"column"===g.type||"bar"===g.type||"scatter"===g.type||"stackedColumn"===g.type||"stackedColumn100"===g.type||"stackedBar"===g.type||"stackedBar100"===g.type||"stackedArea"===g.type||"stackedArea100"===g.type||"waterfall"===g.type?D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.label?"{label}":"{x}")+":</span>&nbsp;&nbsp;{y}":"bubble"===g.type?D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.label?"{label}":"{x}")+":</span>&nbsp;&nbsp;{y}, &nbsp;&nbsp;{z}":"pie"===g.type||"doughnut"===g.type||"funnel"===g.type||"pyramid"===g.type?D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.name?"{name}:</span>&nbsp;&nbsp;":x.label?"{label}:</span>&nbsp;&nbsp;":"</span>")+"{y}":"rangeColumn"===g.type||"rangeBar"===g.type||"rangeArea"===g.type||"rangeSplineArea"===g.type||"error"===g.type?D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.label?"{label}":"{x}")+" :</span>&nbsp;&nbsp;{y[0]}, &nbsp;{y[1]}":"candlestick"===g.type||"ohlc"===g.type?D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.label?"{label}":"{x}")+"</span><br/>Open: &nbsp;&nbsp;{y[0]}<br/>High: &nbsp;&nbsp;&nbsp;{y[1]}<br/>Low: &nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Close: &nbsp;&nbsp;{y[3]}":"boxAndWhisker"===g.type&&(D=x.toolTipContent?x.toolTipContent:g.toolTipContent?g.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(x.label?"{label}":"{x}")+"</span><br/>Minimum: &nbsp;&nbsp;{y[0]}<br/>Q1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[1]}<br/>Q2: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[4]}<br/>Q3: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Maximum: &nbsp;{y[3]}"),null===I&&(I=""),I+=this.chart.replaceKeywordsWithValue(D,x,g,w=u[0].index)}return I},pt.prototype.enableAnimation=function(){if(!this.container.style.WebkitTransition){var u=this.getContainerTransition(this.containerTransitionDuration);this.container.style.WebkitTransition=u,this.container.style.MsTransition=u,this.container.style.transition=u,this.container.style.MozTransition=this.mozContainerTransition}},pt.prototype.disableAnimation=function(){this.container.style.WebkitTransition&&(this.container.style.WebkitTransition="",this.container.style.MozTransition="",this.container.style.MsTransition="",this.container.style.transition="")},pt.prototype.hide=function(u){this.container&&(this.container.style.display="none",this.currentSeriesIndex=-1,this._prevY=this._prevX=NaN,(typeof u>"u"||u)&&this.chart.resetOverlayedCanvas())},pt.prototype.show=function(u,I,g){this._updateToolTip(u,I,!(typeof g>"u")&&g)},pt.prototype.showAtIndex=function(u,I){},pt.prototype.showAtX=function(u,I){if(!this.enabled)return!1;this.chart.clearedOverlayedCanvas=null;var g,x,w,D=[];if(w=!1,I=!$t(I)&&0<=I&&I<this.chart.data.length?I:0,this.shared)for(var o=0;o<this.chart.data.length;o++)(x=(g=this.chart.data[o]).getDataPointAtX(u,!1))&&x.dataPoint&&!$t(x.dataPoint.y)&&g.visible&&(x.dataSeries=g,D.push(x));else(x=(g=this.chart.data[I]).getDataPointAtX(u,!1))&&x.dataPoint&&!$t(x.dataPoint.y)&&g.visible&&(x.dataSeries=g,D.push(x));if(!(0<D.length))return this.hide(),!1;for(o=0;o<D.length;o++){if(x=D[o],(this.shared||0<=x.dataSeries.type.indexOf("100"))&&x.dataPoint.x>=x.dataSeries.axisX.viewportMinimum&&x.dataPoint.x<=x.dataSeries.axisX.viewportMaximum){w=!1;break}if(!(x.dataPoint.x<x.dataSeries.axisX.viewportMinimum||x.dataPoint.x>x.dataSeries.axisX.viewportMaximum||x.dataPoint.y<x.dataSeries.axisY.viewportMinimum||x.dataPoint.y>x.dataSeries.axisY.viewportMaximum)){w=!1;break}w=!0}if(w)return this.hide(),!1;if(this.highlightObjects(D),this._entries=D,o="",null===(o=this.getToolTipInnerHTML({entries:D})))return this.hide(!1),!1;if(this.contentDiv.innerHTML=o,this.isToolTipDefinedInData&&$t(this.options.content)&&$t(this.options.contentFormatter))for(x=this.contentDiv.getElementsByTagName("span"),o=0;o<x.length;o++)x[o]&&(x[o].style.color=x[o].getAttribute("data-color"));o=!1,"none"===this.container.style.display&&(o=!0,this.container.style.display="block");try{this.contentDiv.style.background=this.backgroundColor?this.backgroundColor:oe?"rgba(255,255,255,.9)":"rgb(255,255,255)",this.borderColor=this.contentDiv.style.borderRightColor=this.contentDiv.style.borderLeftColor=this.contentDiv.style.borderColor="waterfall"===D[0].dataSeries.type?this.options.borderColor?this.options.borderColor:D[0].dataPoint.color?D[0].dataPoint.color:0<D[0].dataPoint.y?D[0].dataSeries.risingColor:D[0].dataSeries.fallingColor:"error"===D[0].dataSeries.type?this.options.borderColor?this.options.borderColor:D[0].dataSeries.color?D[0].dataSeries.color:D[0].dataSeries._colorSet[g.index%D[0].dataSeries._colorSet.length]:this.options.borderColor?this.options.borderColor:D[0].dataPoint.color?D[0].dataPoint.color:D[0].dataSeries.color?D[0].dataSeries.color:D[0].dataSeries._colorSet[D[0].index%D[0].dataSeries._colorSet.length],this.contentDiv.style.borderWidth=this.borderThickness||0===this.borderThickness?this.borderThickness+"px":"2px",this.contentDiv.style.borderRadius=this.cornerRadius||0===this.cornerRadius?this.cornerRadius+"px":"5px",this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.contentDiv.style.fontSize=this.fontSize||0===this.fontSize?this.fontSize+"px":"14px",this.contentDiv.style.color=this.fontColor?this.fontColor:"#000000",this.contentDiv.style.fontFamily=this.fontFamily?this.fontFamily:"Calibri, Arial, Georgia, serif;",this.contentDiv.style.fontWeight=this.fontWeight?this.fontWeight:"normal",this.contentDiv.style.fontStyle=this.fontStyle?this.fontStyle:oe?"italic":"normal"}catch{}return"pie"===D[0].dataSeries.type||"doughnut"===D[0].dataSeries.type||"funnel"===D[0].dataSeries.type||"pyramid"===D[0].dataSeries.type?g=mouseX-10-this.container.clientWidth:(g="bar"===D[0].dataSeries.type||"rangeBar"===D[0].dataSeries.type||"stackedBar"===D[0].dataSeries.type||"stackedBar100"===D[0].dataSeries.type?D[0].dataSeries.axisY.convertValueToPixel(D[0].dataPoint.y)-this.container.clientWidth<<0:D[0].dataSeries.axisX.convertValueToPixel(D[0].dataPoint.x)-this.container.clientWidth<<0,g-=10),0>g&&(g+=this.container.clientWidth+20),g+this.container.clientWidth>Math.max(this.chart.container.clientWidth,this.chart.width)&&(g=Math.max(0,Math.max(this.chart.container.clientWidth,this.chart.width)-this.container.clientWidth)),0<(D=10-(D=!(1!==D.length||this.shared||"line"!==D[0].dataSeries.type&&"stepLine"!==D[0].dataSeries.type&&"spline"!==D[0].dataSeries.type&&"area"!==D[0].dataSeries.type&&"stepArea"!==D[0].dataSeries.type&&"splineArea"!==D[0].dataSeries.type)||"bar"!==D[0].dataSeries.type&&"rangeBar"!==D[0].dataSeries.type&&"stackedBar"!==D[0].dataSeries.type&&"stackedBar100"!==D[0].dataSeries.type?D[0].dataSeries.axisY.convertValueToPixel(D[0].dataPoint.y):D[0].dataSeries.axisX.convertValueToPixel(D[0].dataPoint.x)))+this.container.clientHeight+5&&(D-=D+this.container.clientHeight+5-0),this.fixMozTransitionDelay(g,D),!this.animationEnabled||o?this.disableAnimation():(this.enableAnimation(),this.container.style.MozTransition=this.mozContainerTransition),this.container.style.left=g+"px",this.container.style.bottom=D+"px",!0},pt.prototype.fixMozTransitionDelay=function(u,I){if(20<this.chart._eventManager.lastObjectId)this.mozContainerTransition=this.getContainerTransition(0);else{var g=parseFloat(this.container.style.left),x=(g=isNaN(g)?0:g,parseFloat(this.container.style.bottom));x=isNaN(x)?0:x,this.mozContainerTransition=10<Math.sqrt(Math.pow(g-u,2)+Math.pow(x-I,2))?this.getContainerTransition(.1):this.getContainerTransition(0)}},pt.prototype.getContainerTransition=function(u){return"left "+u+"s ease-out 0s, bottom "+u+"s ease-out 0s"},wt.prototype.reset=function(){this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.previousDataPointEventObject=null,this.eventObjects=[],oe&&(this.ghostCtx.clearRect(0,0,this.chart.width,this.chart.height),this.ghostCtx.beginPath())},wt.prototype.getNewObjectTrackingId=function(){return++this.lastObjectId},wt.prototype.mouseEventHandler=function(u){if("mousemove"===u.type||"click"===u.type){var I=[],g=$s(u),x=null;if((x=this.chart.getObjectAtXY(g.x,g.y,!1))&&typeof this.objectMap[x]<"u")if("dataPoint"===(x=this.objectMap[x]).objectType){var w=this.chart.data[x.dataSeriesIndex],D=w.dataPoints[x.dataPointIndex],o=x.dataPointIndex;x.eventParameter={x:g.x,y:g.y,dataPoint:D,dataSeries:w.options,dataPointIndex:o,dataSeriesIndex:w.index,chart:this.chart},x.eventContext={context:D,userContext:D,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},I.push(x),(x=this.objectMap[w.id]).eventParameter={x:g.x,y:g.y,dataPoint:D,dataSeries:w.options,dataPointIndex:o,dataSeriesIndex:w.index,chart:this.chart},x.eventContext={context:w,userContext:w.options,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},I.push(this.objectMap[w.id])}else"legendItem"===x.objectType&&(x.eventParameter={x:g.x,y:g.y,dataSeries:(w=this.chart.data[x.dataSeriesIndex]).options,dataPoint:D=null!==x.dataPointIndex?w.dataPoints[x.dataPointIndex]:null,dataPointIndex:x.dataPointIndex,dataSeriesIndex:x.dataSeriesIndex,chart:this.chart},x.eventContext={context:this.chart.legend,userContext:this.chart.legend.options,mouseover:"itemmouseover",mousemove:"itemmousemove",mouseout:"itemmouseout",click:"itemclick"},I.push(x));for(w=[],g=0;g<this.mouseoveredObjectMaps.length;g++){for(D=!0,x=0;x<I.length;x++)if(I[x].id===this.mouseoveredObjectMaps[g].id){D=!1;break}D?this.fireEvent(this.mouseoveredObjectMaps[g],"mouseout",u):w.push(this.mouseoveredObjectMaps[g])}for(this.mouseoveredObjectMaps=w,g=0;g<I.length;g++){for(w=!1,x=0;x<this.mouseoveredObjectMaps.length;x++)if(I[g].id===this.mouseoveredObjectMaps[x].id){w=!0;break}w||(this.fireEvent(I[g],"mouseover",u),this.mouseoveredObjectMaps.push(I[g])),"click"===u.type?this.fireEvent(I[g],"click",u):"mousemove"===u.type&&this.fireEvent(I[g],"mousemove",u)}}},wt.prototype.fireEvent=function(u,I,g){if(u&&I){var x=u.eventParameter,w=u.eventContext,D=u.eventContext.userContext;D&&w&&D[w[I]]&&D[w[I]].call(D,x),"mouseout"!==I?D.cursor&&D.cursor!==g.target.style.cursor&&(g.target.style.cursor=D.cursor):(g.target.style.cursor=this.chart._defaultCursor,delete u.eventParameter,delete u.eventContext),"click"===I&&"dataPoint"===u.objectType&&this.chart.pieDoughnutClickHandler&&this.chart.pieDoughnutClickHandler.call(this.chart.data[u.dataSeriesIndex],x),"click"===I&&"dataPoint"===u.objectType&&this.chart.funnelPyramidClickHandler&&this.chart.funnelPyramidClickHandler.call(this.chart.data[u.dataSeriesIndex],x)}},It.prototype.animate=function(u,I,g,x,w){var D=this;for(this.chart.isAnimating=!0,w=w||te.easing.linear,g&&this.animations.push({startTime:(new Date).getTime()+(u||0),duration:I,animationCallback:g,onComplete:x}),u=[];0<this.animations.length;)I=this.animations.shift(),g=(new Date).getTime(),x=0,I.startTime<=g&&(x=w(Math.min(g-I.startTime,I.duration),0,1,I.duration),x=Math.min(x,1),isNaN(x)||!isFinite(x))&&(x=1),1>x&&u.push(I),I.animationCallback(x),1<=x&&I.onComplete&&I.onComplete();this.animations=u,0<this.animations.length?this.animationRequestId=this.chart.requestAnimFrame.call(window,function(){D.animate.call(D)}):this.chart.isAnimating=!1},It.prototype.cancelAllAnimations=function(){this.animations=[],this.animationRequestId&&this.chart.cancelRequestAnimFrame.call(window,this.animationRequestId),this.animationRequestId=null,this.chart.isAnimating=!1};var te={yScaleAnimation:function(u,I){if(0!==u){var g=I.dest,x=I.source.canvas,w=I.animationBase;g.drawImage(x,0,0,x.width,x.height,0,w-w*u,g.canvas.width/ls,u*g.canvas.height/ls)}},xScaleAnimation:function(u,I){if(0!==u){var g=I.dest,x=I.source.canvas,w=I.animationBase;g.drawImage(x,0,0,x.width,x.height,w-w*u,0,u*g.canvas.width/ls,g.canvas.height/ls)}},xClipAnimation:function(u,I){if(0!==u){var g=I.dest,x=I.source.canvas;g.save(),0<u&&g.drawImage(x,0,0,x.width*u,x.height,0,0,x.width*u/ls,x.height/ls),g.restore()}},fadeInAnimation:function(u,I){if(0!==u){var g=I.dest,x=I.source.canvas;g.save(),g.globalAlpha=u,g.drawImage(x,0,0,x.width,x.height,0,0,g.canvas.width/ls,g.canvas.height/ls),g.restore()}},easing:{linear:function(u,I,g,x){return g*u/x+I},easeOutQuad:function(u,I,g,x){return-g*(u/=x)*(u-2)+I},easeOutQuart:function(u,I,g,x){return-g*((u=u/x-1)*u*u*u-1)+I},easeInQuad:function(u,I,g,x){return g*(u/=x)*u+I},easeInQuart:function(u,I,g,x){return g*(u/=x)*u*u*u+I}}},ie={drawMarker:function(u,I,g,x,w,D,o,y){if(g){var f=1;g.fillStyle=D||"#000000",g.strokeStyle=o||"#000000",g.lineWidth=y||0,g.setLineDash&&g.setLineDash(tn("solid",y)),"circle"===x?(g.moveTo(u,I),g.beginPath(),g.arc(u,I,w/2,0,2*Math.PI,!1),D&&g.fill(),y&&(o?g.stroke():(f=g.globalAlpha,g.globalAlpha=.15,g.strokeStyle="black",g.stroke(),g.globalAlpha=f))):"square"===x?(g.beginPath(),g.rect(u-w/2,I-w/2,w,w),D&&g.fill(),y&&(o?g.stroke():(f=g.globalAlpha,g.globalAlpha=.15,g.strokeStyle="black",g.stroke(),g.globalAlpha=f))):"triangle"===x?(g.beginPath(),g.moveTo(u-w/2,I+w/2),g.lineTo(u+w/2,I+w/2),g.lineTo(u,I-w/2),g.closePath(),D&&g.fill(),y&&(o?g.stroke():(f=g.globalAlpha,g.globalAlpha=.15,g.strokeStyle="black",g.stroke(),g.globalAlpha=f)),g.beginPath()):"cross"===x&&(g.strokeStyle=D,g.lineWidth=w/4,g.beginPath(),g.moveTo(u-w/2,I-w/2),g.lineTo(u+w/2,I+w/2),g.stroke(),g.moveTo(u+w/2,I-w/2),g.lineTo(u-w/2,I+w/2),g.stroke())}},drawMarkers:function(u){for(var I=0;I<u.length;I++){var g=u[I];ie.drawMarker(g.x,g.y,g.ctx,g.type,g.size,g.color,g.borderColor,g.borderThickness)}}};return Ct}(),at.version="v3.7.5 GA",window.CanvasJS&&at&&!window.CanvasJS.Chart&&(window.CanvasJS.Chart=at)})(),document.createElement("canvas").getContext||function(){function On(){return this.context_||(this.context_=new tn(this))}function b(at){return String(at).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function De(at){at.namespaces.g_vml_||at.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),at.namespaces.g_o_||at.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),at.styleSheets.ex_canvas_||((at=at.createStyleSheet()).owningElement.id="ex_canvas_",at.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}")}function ho(at){var rt=at.srcElement;switch(at.propertyName){case"width":rt.getContext().clearRect(),rt.style.width=rt.attributes.width.nodeValue+"px",rt.firstChild.style.width=rt.clientWidth+"px";break;case"height":rt.getContext().clearRect(),rt.style.height=rt.attributes.height.nodeValue+"px",rt.firstChild.style.height=rt.clientHeight+"px"}}function ks(at){(at=at.srcElement).firstChild&&(at.firstChild.style.width=at.clientWidth+"px",at.firstChild.style.height=at.clientHeight+"px")}function bi(at,rt){for(var Yt=[[1,0,0],[0,1,0],[0,0,1]],Kt=0;3>Kt;Kt++)for(var Xt=0;3>Xt;Xt++){for(var xe=0,We=0;3>We;We++)xe+=at[Kt][We]*rt[We][Xt];Yt[Kt][Xt]=xe}return Yt}function an(at,rt){rt.fillStyle=at.fillStyle,rt.lineCap=at.lineCap,rt.lineJoin=at.lineJoin,rt.lineWidth=at.lineWidth,rt.miterLimit=at.miterLimit,rt.shadowBlur=at.shadowBlur,rt.shadowColor=at.shadowColor,rt.shadowOffsetX=at.shadowOffsetX,rt.shadowOffsetY=at.shadowOffsetY,rt.strokeStyle=at.strokeStyle,rt.globalAlpha=at.globalAlpha,rt.font=at.font,rt.textAlign=at.textAlign,rt.textBaseline=at.textBaseline,rt.arcScaleX_=at.arcScaleX_,rt.arcScaleY_=at.arcScaleY_,rt.lineScale_=at.lineScale_}function $t(at){var Yt=at.indexOf("(",3),rt=at.indexOf(")",Yt+1);return(4!=(Yt=at.substring(Yt+1,rt).split(",")).length||"a"!=at.charAt(3))&&(Yt[3]=1),Yt}function Et(at,rt,Yt){return Math.min(Yt,Math.max(rt,at))}function fo(at,rt,Yt){return 0>Yt&&Yt++,1<Yt&&Yt--,1>6*Yt?at+6*(rt-at)*Yt:1>2*Yt?rt:2>3*Yt?at+6*(rt-at)*(2/3-Yt):at}function Yo(at){if(at in Mn)return Mn[at];var rt,Yt=1;if("#"==(at=String(at)).charAt(0))rt=at;else if(/^rgb/.test(at)){Yt=$t(at),rt="#";for(var Kt,Xt=0;3>Xt;Xt++)Kt=-1!=Yt[Xt].indexOf("%")?Math.floor(parseFloat(Yt[Xt])/100*255):+Yt[Xt],rt+=En[Et(Kt,0,255)];Yt=+Yt[3]}else if(/^hsl/.test(at)){if(Xt=Yt=$t(at),0>(rt=parseFloat(Xt[0])/360%360)&&rt++,Kt=Et(parseFloat(Xt[1])/100,0,1),Xt=Et(parseFloat(Xt[2])/100,0,1),0==Kt)Kt=Xt=rt=Xt;else{var xe=.5>Xt?Xt*(1+Kt):Xt+Kt-Xt*Kt,We=2*Xt-xe;Kt=fo(We,xe,rt+1/3),Xt=fo(We,xe,rt),rt=fo(We,xe,rt-1/3)}rt="#"+En[Math.floor(255*Kt)]+En[Math.floor(255*Xt)]+En[Math.floor(255*rt)],Yt=Yt[3]}else rt=Ys[at]||at;return Mn[at]={color:rt,alpha:Yt}}function tn(at){this.m_=[[1,0,0],[0,1,0],[0,0,1]],this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*Ri,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=at;var rt="width:"+at.clientWidth+"px;height:"+at.clientHeight+"px;overflow:hidden;position:absolute",Yt=at.ownerDocument.createElement("div");Yt.style.cssText=rt,at.appendChild(Yt),(rt=Yt.cloneNode(!1)).style.backgroundColor="red",rt.style.filter="alpha(opacity=0)",at.appendChild(rt),this.element_=Yt,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function Ti(at,rt,Yt,Kt){at.currentPath_.push({type:"bezierCurveTo",cp1x:rt.x,cp1y:rt.y,cp2x:Yt.x,cp2y:Yt.y,x:Kt.x,y:Kt.y}),at.currentX_=Kt.x,at.currentY_=Kt.y}function Li(at,rt){var Yt=(Kt=Yo(at.strokeStyle)).color,Kt=Kt.alpha*at.globalAlpha,Xt=at.lineScale_*at.lineWidth;1>Xt&&(Kt*=Xt),rt.push("<g_vml_:stroke",' opacity="',Kt,'"',' joinstyle="',at.lineJoin,'"',' miterlimit="',at.miterLimit,'"',' endcap="',Ls[at.lineCap]||"square",'"',' weight="',Xt,'px"',' color="',Yt,'" />')}function xi(at,rt,Yt,Kt){var Xt=at.fillStyle,xe=at.arcScaleX_,We=at.arcScaleY_,Ke=Kt.x-Yt.x,Vi=Kt.y-Yt.y;if(Xt instanceof yo){var $e=0,hi=Kt=0,ai=0,Qi=1;if("gradient"==Xt.type_){$e=Xt.x1_/xe,Yt=Xt.y1_/We;var Pi=en(at,Xt.x0_/xe,Xt.y0_/We);$e=en(at,$e,Yt),0>($e=180*Math.atan2($e.x-Pi.x,$e.y-Pi.y)/Math.PI)&&($e+=360),1e-6>$e&&($e=0)}else Kt=((Pi=en(at,Xt.x0_,Xt.y0_)).x-Yt.x)/Ke,hi=(Pi.y-Yt.y)/Vi,Qi=$n.max(Ke/=xe*Ri,Vi/=We*Ri),Qi=2*Xt.r1_/Qi-(ai=2*Xt.r0_/Qi);(xe=Xt.colors_).sort(function(Hs,In){return Hs.offset-In.offset}),Pi=xe[0].color,Yt=xe[(We=xe.length)-1].color,Ke=xe[0].alpha*at.globalAlpha,at=xe[We-1].alpha*at.globalAlpha,Vi=[];for(var Ei=0;Ei<We;Ei++){var ys=xe[Ei];Vi.push(ys.offset*Qi+ai+" "+ys.color)}rt.push('<g_vml_:fill type="',Xt.type_,'"',' method="none" focus="100%"',' color="',Pi,'"',' color2="',Yt,'"',' colors="',Vi.join(","),'"',' opacity="',at,'"',' g_o_:opacity2="',Ke,'"',' angle="',$e,'"',' focusposition="',Kt,",",hi,'" />')}else Xt instanceof Xi?Ke&&Vi&&rt.push("<g_vml_:fill",' position="',-Yt.x/Ke*xe*xe,",",-Yt.y/Vi*We*We,'"',' type="tile"',' src="',Xt.src_,'" />'):(Xt=Yo(at.fillStyle),rt.push('<g_vml_:fill color="',Xt.color,'" opacity="',Xt.alpha*at.globalAlpha,'" />'))}function en(at,rt,Yt){return{x:Ri*(rt*(at=at.m_)[0][0]+Yt*at[1][0]+at[2][0])-Us,y:Ri*(rt*at[0][1]+Yt*at[1][1]+at[2][1])-Us}}function ro(at,rt,Yt){isFinite(rt[0][0])&&isFinite(rt[0][1])&&isFinite(rt[1][0])&&isFinite(rt[1][1])&&isFinite(rt[2][0])&&isFinite(rt[2][1])&&(at.m_=rt,Yt&&(at.lineScale_=As(Wi(rt[0][0]*rt[1][1]-rt[0][1]*rt[1][0]))))}function yo(at){this.type_=at,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function Xi(at,rt){if(!at||1!=at.nodeType||"IMG"!=at.tagName)throw new cn("TYPE_MISMATCH_ERR");if("complete"!=at.readyState)throw new cn("INVALID_STATE_ERR");switch(rt){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=rt;break;default:throw new cn("SYNTAX_ERR")}this.src_=at.src,this.width_=at.width,this.height_=at.height}function cn(at){this.code=this[at],this.message=at+": DOM Exception "+this.code}var $n=Math,zi=$n.round,un=$n.sin,js=$n.cos,Wi=$n.abs,As=$n.sqrt,Ri=10,Us=Ri/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var fn=Array.prototype.slice;De(document);var ln={init:function(at){(at=at||document).createElement("canvas"),at.attachEvent("onreadystatechange",function qa(at,rt,Yt){var Kt=fn.call(arguments,2);return function(){return at.apply(rt,Kt.concat(fn.call(arguments)))}}(this.init_,this,at))},init_:function(at){at=at.getElementsByTagName("canvas");for(var rt=0;rt<at.length;rt++)this.initElement(at[rt])},initElement:function(at){if(!at.getContext){at.getContext=On,De(at.ownerDocument),at.innerHTML="",at.attachEvent("onpropertychange",ho),at.attachEvent("onresize",ks);var rt=at.attributes;rt.width&&rt.width.specified?at.style.width=rt.width.nodeValue+"px":at.width=at.clientWidth,rt.height&&rt.height.specified?at.style.height=rt.height.nodeValue+"px":at.height=at.clientHeight}return at}};ln.init();for(var En=[],Ze=0;16>Ze;Ze++)for(var ao=0;16>ao;ao++)En[16*Ze+ao]=Ze.toString(16)+ao.toString(16);var Ys={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},Mn={},oe={},Ls={butt:"flat",round:"round"};(Ze=tn.prototype).clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},Ze.beginPath=function(){this.currentPath_=[]},Ze.moveTo=function(at,rt){var Yt=en(this,at,rt);this.currentPath_.push({type:"moveTo",x:Yt.x,y:Yt.y}),this.currentX_=Yt.x,this.currentY_=Yt.y},Ze.lineTo=function(at,rt){var Yt=en(this,at,rt);this.currentPath_.push({type:"lineTo",x:Yt.x,y:Yt.y}),this.currentX_=Yt.x,this.currentY_=Yt.y},Ze.bezierCurveTo=function(at,rt,Yt,Kt,Xt,xe){Xt=en(this,Xt,xe),Ti(this,at=en(this,at,rt),Yt=en(this,Yt,Kt),Xt)},Ze.quadraticCurveTo=function(at,rt,Yt,Kt){at=en(this,at,rt),Yt=en(this,Yt,Kt),Ti(this,Kt={x:this.currentX_+2/3*(at.x-this.currentX_),y:this.currentY_+2/3*(at.y-this.currentY_)},{x:Kt.x+(Yt.x-this.currentX_)/3,y:Kt.y+(Yt.y-this.currentY_)/3},Yt)},Ze.arc=function(at,rt,Yt,Kt,Xt,xe){Yt*=Ri;var We=xe?"at":"wa",Ke=at+js(Kt)*Yt-Us,Vi=rt+un(Kt)*Yt-Us;Kt=at+js(Xt)*Yt-Us,Xt=rt+un(Xt)*Yt-Us,Ke!=Kt||xe||(Ke+=.125),at=en(this,at,rt),Ke=en(this,Ke,Vi),Kt=en(this,Kt,Xt),this.currentPath_.push({type:We,x:at.x,y:at.y,radius:Yt,xStart:Ke.x,yStart:Ke.y,xEnd:Kt.x,yEnd:Kt.y})},Ze.rect=function(at,rt,Yt,Kt){this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath()},Ze.strokeRect=function(at,rt,Yt,Kt){var Xt=this.currentPath_;this.beginPath(),this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath(),this.stroke(),this.currentPath_=Xt},Ze.fillRect=function(at,rt,Yt,Kt){var Xt=this.currentPath_;this.beginPath(),this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath(),this.fill(),this.currentPath_=Xt},Ze.createLinearGradient=function(at,rt,Yt,Kt){var Xt=new yo("gradient");return Xt.x0_=at,Xt.y0_=rt,Xt.x1_=Yt,Xt.y1_=Kt,Xt},Ze.createRadialGradient=function(at,rt,Yt,Kt,Xt,xe){var We=new yo("gradientradial");return We.x0_=at,We.y0_=rt,We.r0_=Yt,We.x1_=Kt,We.y1_=Xt,We.r1_=xe,We},Ze.drawImage=function(at,rt){var Yt,Kt,Xt,xe,We,Ke,Vi,$e;Xt=at.runtimeStyle.width,xe=at.runtimeStyle.height,at.runtimeStyle.width="auto",at.runtimeStyle.height="auto";var hi=at.width,ai=at.height;if(at.runtimeStyle.width=Xt,at.runtimeStyle.height=xe,3==arguments.length)Yt=arguments[1],Kt=arguments[2],We=Ke=0,Vi=Xt=hi,$e=xe=ai;else if(5==arguments.length)Yt=arguments[1],Kt=arguments[2],Xt=arguments[3],xe=arguments[4],We=Ke=0,Vi=hi,$e=ai;else{if(9!=arguments.length)throw Error("Invalid number of arguments");We=arguments[1],Ke=arguments[2],Vi=arguments[3],$e=arguments[4],Yt=arguments[5],Kt=arguments[6],Xt=arguments[7],xe=arguments[8]}var Qi=en(this,Yt,Kt),Pi=[];if(Pi.push(" <g_vml_:group",' coordsize="',10*Ri,",",10*Ri,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var Ei=[];Ei.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",zi(Qi.x/Ri),",","Dy=",zi(Qi.y/Ri),"");var ys=en(this,Yt+Xt,Kt),Hs=en(this,Yt,Kt+xe);Yt=en(this,Yt+Xt,Kt+xe),Qi.x=$n.max(Qi.x,ys.x,Hs.x,Yt.x),Qi.y=$n.max(Qi.y,ys.y,Hs.y,Yt.y),Pi.push("padding:0 ",zi(Qi.x/Ri),"px ",zi(Qi.y/Ri),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",Ei.join(""),", sizingmethod='clip');")}else Pi.push("top:",zi(Qi.y/Ri),"px;left:",zi(Qi.x/Ri),"px;");Pi.push(' ">','<g_vml_:image src="',at.src,'"',' style="width:',Ri*Xt,"px;"," height:",Ri*xe,'px"',' cropleft="',We/hi,'"',' croptop="',Ke/ai,'"',' cropright="',(hi-We-Vi)/hi,'"',' cropbottom="',(ai-Ke-$e)/ai,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",Pi.join(""))},Ze.stroke=function(at){var rt=[];rt.push("<g_vml_:shape",' filled="',!!at,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',10*Ri,",",10*Ri,'"',' stroked="',!at,'"',' path="');for(var Yt={x:null,y:null},Kt={x:null,y:null},Xt=0;Xt<this.currentPath_.length;Xt++){var xe=this.currentPath_[Xt];switch(xe.type){case"moveTo":rt.push(" m ",zi(xe.x),",",zi(xe.y));break;case"lineTo":rt.push(" l ",zi(xe.x),",",zi(xe.y));break;case"close":rt.push(" x "),xe=null;break;case"bezierCurveTo":rt.push(" c ",zi(xe.cp1x),",",zi(xe.cp1y),",",zi(xe.cp2x),",",zi(xe.cp2y),",",zi(xe.x),",",zi(xe.y));break;case"at":case"wa":rt.push(" ",xe.type," ",zi(xe.x-this.arcScaleX_*xe.radius),",",zi(xe.y-this.arcScaleY_*xe.radius)," ",zi(xe.x+this.arcScaleX_*xe.radius),",",zi(xe.y+this.arcScaleY_*xe.radius)," ",zi(xe.xStart),",",zi(xe.yStart)," ",zi(xe.xEnd),",",zi(xe.yEnd))}xe&&((null==Yt.x||xe.x<Yt.x)&&(Yt.x=xe.x),(null==Kt.x||xe.x>Kt.x)&&(Kt.x=xe.x),(null==Yt.y||xe.y<Yt.y)&&(Yt.y=xe.y),(null==Kt.y||xe.y>Kt.y)&&(Kt.y=xe.y))}rt.push(' ">'),at?xi(this,rt,Yt,Kt):Li(this,rt),rt.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",rt.join(""))},Ze.fill=function(){this.stroke(!0)},Ze.closePath=function(){this.currentPath_.push({type:"close"})},Ze.save=function(){var at={};an(this,at),this.aStack_.push(at),this.mStack_.push(this.m_),this.m_=bi([[1,0,0],[0,1,0],[0,0,1]],this.m_)},Ze.restore=function(){this.aStack_.length&&(an(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},Ze.translate=function(at,rt){ro(this,bi([[1,0,0],[0,1,0],[at,rt,1]],this.m_),!1)},Ze.rotate=function(at){var rt=js(at);ro(this,bi([[rt,at=un(at),0],[-at,rt,0],[0,0,1]],this.m_),!1)},Ze.scale=function(at,rt){this.arcScaleX_*=at,this.arcScaleY_*=rt,ro(this,bi([[at,0,0],[0,rt,0],[0,0,1]],this.m_),!0)},Ze.transform=function(at,rt,Yt,Kt,Xt,xe){ro(this,bi([[at,rt,0],[Yt,Kt,0],[Xt,xe,1]],this.m_),!0)},Ze.setTransform=function(at,rt,Yt,Kt,Xt,xe){ro(this,[[at,rt,0],[Yt,Kt,0],[Xt,xe,1]],!0)},Ze.drawText_=function(at,rt,Yt,Kt,Xt){var xe=this.m_;Kt=0;var $e,We=1e3,Ke=0,Vi=[];if(oe[$e=this.font])$e=oe[$e];else{var hi=document.createElement("div").style;try{hi.font=$e}catch{}$e=oe[$e]={style:hi.fontStyle||"normal",variant:hi.fontVariant||"normal",weight:hi.fontWeight||"normal",size:hi.fontSize||10,family:hi.fontFamily||"sans-serif"}}hi=$e;var ai=this.element_;for(var Qi in $e={},hi)$e[Qi]=hi[Qi];switch(Qi=parseFloat(ai.currentStyle.fontSize),ai=parseFloat(hi.size),$e.size="number"==typeof hi.size?hi.size:-1!=hi.size.indexOf("px")?ai:-1!=hi.size.indexOf("em")?Qi*ai:-1!=hi.size.indexOf("%")?Qi/100*ai:-1!=hi.size.indexOf("pt")?ai/.75:Qi,$e.size*=.981,Qi=$e.style+" "+$e.variant+" "+$e.weight+" "+$e.size+"px "+$e.family,ai=this.element_.currentStyle,hi=this.textAlign.toLowerCase()){case"left":case"center":case"right":break;case"end":hi="ltr"==ai.direction?"right":"left";break;case"start":hi="rtl"==ai.direction?"right":"left";break;default:hi="left"}switch(this.textBaseline){case"hanging":case"top":Ke=$e.size/1.75;break;case"middle":break;default:Ke=-$e.size/2.25}switch(hi){case"right":Kt=1e3,We=.05;break;case"center":Kt=We=500}rt=en(this,rt+0,Yt+Ke),Vi.push('<g_vml_:line from="',-Kt,' 0" to="',We,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!Xt,'" stroked="',!!Xt,'" style="position:absolute;width:1px;height:1px;">'),Xt?Li(this,Vi):xi(this,Vi,{x:-Kt,y:0},{x:We,y:$e.size}),Xt=xe[0][0].toFixed(3)+","+xe[1][0].toFixed(3)+","+xe[0][1].toFixed(3)+","+xe[1][1].toFixed(3)+",0,0",rt=zi(rt.x/Ri)+","+zi(rt.y/Ri),Vi.push('<g_vml_:skew on="t" matrix="',Xt,'" ',' offset="',rt,'" origin="',Kt,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',b(at),'" style="v-text-align:',hi,";font:",b(Qi),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",Vi.join(""))},Ze.fillText=function(at,rt,Yt,Kt){this.drawText_(at,rt,Yt,Kt,!1)},Ze.strokeText=function(at,rt,Yt,Kt){this.drawText_(at,rt,Yt,Kt,!0)},Ze.measureText=function(at){this.textMeasureEl_||(this.element_.insertAdjacentHTML("beforeEnd",'<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>'),this.textMeasureEl_=this.element_.lastChild);var rt=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(rt.createTextNode(at)),{width:this.textMeasureEl_.offsetWidth}},Ze.clip=function(){},Ze.arcTo=function(){},Ze.createPattern=function(at,rt){return new Xi(at,rt)},yo.prototype.addColorStop=function(at,rt){rt=Yo(rt),this.colors_.push({offset:at,color:rt.color,alpha:rt.alpha})},(Ze=cn.prototype=Error()).INDEX_SIZE_ERR=1,Ze.DOMSTRING_SIZE_ERR=2,Ze.HIERARCHY_REQUEST_ERR=3,Ze.WRONG_DOCUMENT_ERR=4,Ze.INVALID_CHARACTER_ERR=5,Ze.NO_DATA_ALLOWED_ERR=6,Ze.NO_MODIFICATION_ALLOWED_ERR=7,Ze.NOT_FOUND_ERR=8,Ze.NOT_SUPPORTED_ERR=9,Ze.INUSE_ATTRIBUTE_ERR=10,Ze.INVALID_STATE_ERR=11,Ze.SYNTAX_ERR=12,Ze.INVALID_MODIFICATION_ERR=13,Ze.NAMESPACE_ERR=14,Ze.INVALID_ACCESS_ERR=15,Ze.VALIDATION_ERR=16,Ze.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=ln,CanvasRenderingContext2D=tn,CanvasGradient=yo,CanvasPattern=Xi,DOMException=cn}()},836:(Qa,_l)=>{var ss;(function(){function On(Q,xt){Q.prototype=function qa(Q){function xt(){}return xt.prototype=Q,new xt}(xt.prototype),Q.prototype.constructor=Q,Q.base=xt.prototype}function b(Q,xt,Pt){return"millisecond"===Pt?Q.setMilliseconds(Q.getMilliseconds()+1*xt):"second"===Pt?Q.setSeconds(Q.getSeconds()+1*xt):"minute"===Pt?Q.setMinutes(Q.getMinutes()+1*xt):"hour"===Pt?Q.setHours(Q.getHours()+1*xt):"day"===Pt?Q.setDate(Q.getDate()+1*xt):"week"===Pt?Q.setDate(Q.getDate()+7*xt):"month"===Pt?Q.setMonth(Q.getMonth()+1*xt):"year"===Pt&&Q.setFullYear(Q.getFullYear()+1*xt),Q}function De(Q,xt){var Pt=!1;for(0>Q&&(Pt=!0,Q*=-1),Q=""+Q,xt=xt||1;Q.length<xt;)Q="0"+Q;return Pt?"-"+Q:Q}function ho(Q){if(!Q)return Q;for(var xt=/\s/,Pt=(Q=Q.replace(/^\s\s*/,"")).length;xt.test(Q.charAt(--Pt)););return Q.slice(0,Pt+1)}function ks(Q){Q.roundRect=function(xt,Pt,yt,ct,pt,wt,It,Gt){It&&(this.fillStyle=It),Gt&&(this.strokeStyle=Gt),typeof pt>"u"&&(pt=5),this.lineWidth=wt,this.beginPath(),this.moveTo(xt+pt,Pt),this.lineTo(xt+yt-pt,Pt),this.quadraticCurveTo(xt+yt,Pt,xt+yt,Pt+pt),this.lineTo(xt+yt,Pt+ct-pt),this.quadraticCurveTo(xt+yt,Pt+ct,xt+yt-pt,Pt+ct),this.lineTo(xt+pt,Pt+ct),this.quadraticCurveTo(xt,Pt+ct,xt,Pt+ct-pt),this.lineTo(xt,Pt+pt),this.quadraticCurveTo(xt,Pt,xt+pt,Pt),this.closePath(),It&&this.fill(),Gt&&0<wt&&this.stroke()}}function pn(Q,xt){return Q-xt}function bi(Q,xt,Pt){if(Q&&xt&&Pt){Pt=Pt+"."+xt;var yt="image/"+xt;Q=Q.toDataURL(yt);var ct=!1,pt=document.createElement("a");if(pt.download=Pt,pt.href=Q,typeof Blob<"u"&&new Blob){for(var wt=Q.replace(/^data:[a-z\/]*;base64,/,""),It=(wt=atob(wt),new ArrayBuffer(wt.length)),Gt=(It=new Uint8Array(It),0);Gt<wt.length;Gt++)It[Gt]=wt.charCodeAt(Gt);xt=new Blob([It.buffer],{type:"image/"+xt});try{window.navigator.msSaveBlob(xt,Pt),ct=!0}catch{pt.dataset.downloadurl=[yt,pt.download,pt.href].join(":"),pt.href=window.URL.createObjectURL(xt)}}if(!ct)try{event=document.createEvent("MouseEvents"),event.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),pt.dispatchEvent?pt.dispatchEvent(event):pt.fireEvent&&pt.fireEvent("onclick")}catch{(xt=window.open()).document.write("<img src='"+Q+"'></img><div>Please right click on the image and save it to your device</div>"),xt.document.close()}}}function an(Q){var xt=((16711680&Q)>>16).toString(16),Pt=((65280&Q)>>8).toString(16);return Q=((255&Q)>>0).toString(16),"#"+(xt=2>xt.length?"0"+xt:xt)+(Pt=2>Pt.length?"0"+Pt:Pt)+(2>Q.length?"0"+Q:Q)}function $t(Q,xt){var yt,Pt=this.length>>>0;for(0>(yt=0>(yt=Number(xt)||0)?Math.ceil(yt):Math.floor(yt))&&(yt+=Pt);yt<Pt;yt++)if(yt in this&&this[yt]===Q)return yt;return-1}function Et(Q){return null===Q||typeof Q>"u"}function fo(Q){return Q.indexOf||(Q.indexOf=$t),Q}function tn(Q,xt,Pt){var yt=Q+"_"+xt+"_"+(Pt=Pt||"normal"),ct=Lr[yt];if(isNaN(ct)){try{if(!_o){var pt=document.body;(_o=document.createElement("span")).innerHTML="";var wt=document.createTextNode("Mpgyi");_o.appendChild(wt),pt.appendChild(_o)}_o.style.display="",un(_o,{position:"absolute",left:"0px",top:"-20000px",padding:"0px",margin:"0px",border:"none",whiteSpace:"pre",lineHeight:"normal",fontFamily:Q,fontSize:xt+"px",fontWeight:Pt}),ct=Math.round(_o.offsetHeight),_o.style.display="none"}catch{ct=Math.ceil(1.1*xt)}ct=Math.max(ct,xt),Lr[yt]=ct}return ct}function Ti(Q,xt){var Pt=[];if(Pt={solid:[],shortDash:[3,1],shortDot:[1,1],shortDashDot:[3,1,1,1],shortDashDotDot:[3,1,1,1,1,1],dot:[1,2],dash:[4,2],dashDot:[4,2,1,2],longDash:[8,2],longDashDot:[8,2,1,2],longDashDotDot:[8,2,1,2,1,2]}[Q||"solid"])for(var yt=0;yt<Pt.length;yt++)Pt[yt]*=xt;else Pt=[];return Pt}function Li(Q,xt,Pt,yt,ct){return yt=yt||[],ct=Et(ct)?!!Sr&&{passive:!1,capture:!1}:ct,yt.push([Q,xt,Pt,ct]),Q.addEventListener?(Q.addEventListener(xt,Pt,ct),Pt):!!Q.attachEvent&&(Q.attachEvent("on"+xt,yt=function(pt){(pt=pt||window.event).preventDefault=pt.preventDefault||function(){pt.returnValue=!1},pt.stopPropagation=pt.stopPropagation||function(){pt.cancelBubble=!0},Pt.call(Q,pt)}),yt)}function xi(Q,xt,Pt,yt){if(yt=yt||!1,Q.removeEventListener)Q.removeEventListener(xt,Pt,yt);else{if(!Q.detachEvent)return!1;Q.detachEvent("on"+xt,Pt)}}function en(Q,xt){if("createEvent"in document){var Pt=document.createEvent("HTMLEvents");Pt.initEvent(xt,!1,!0),Q.dispatchEvent(Pt)}else Q.fireEvent("on"+xt)}function ro(Q){if(Q._menuButton)Q.exportEnabled?(un(Q._menuButton,{backgroundColor:Q.toolbar.itemBackgroundColor,color:Q.toolbar.fontColor}),Wi(Q._menuButton),Q._menuButton.title=Q._cultureInfo.menuText):As(Q._menuButton);else if(Q.exportEnabled&&rt){var xt=!1;Q._menuButton=document.createElement("button"),js(Q,Q._menuButton,"menu"),Q._toolBar.appendChild(Q._menuButton),Li(Q._menuButton,"touchstart",function(pt){xt=!0},Q.allDOMEventHandlers),Li(Q._menuButton,"click",function(){"none"!==Q._dropdownMenu.style.display||Q._dropDownCloseTime&&500>=(new Date).getTime()-Q._dropDownCloseTime.getTime()||(Q._dropdownMenu.style.display="block",Q._menuButton.blur(),Q._dropdownMenu.focus())},Q.allDOMEventHandlers,!0),Li(Q._menuButton,"mousemove",function(){xt||(un(Q._menuButton,{backgroundColor:Q.toolbar.itemBackgroundColorOnHover,color:Q.toolbar.fontColorOnHover}),0>=navigator.userAgent.search("MSIE")&&un(Q._menuButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},Q.allDOMEventHandlers,!0),Li(Q._menuButton,"mouseout",function(){xt||(un(Q._menuButton,{backgroundColor:Q.toolbar.itemBackgroundColor,color:Q.toolbar.fontColor}),0>=navigator.userAgent.search("MSIE")&&un(Q._menuButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},Q.allDOMEventHandlers,!0)}if(Q.exportEnabled&&Q._dropdownMenu){un(Q._dropdownMenu,{backgroundColor:Q.toolbar.itemBackgroundColor,color:Q.toolbar.fontColor});for(var Pt=Q._dropdownMenu.childNodes,yt=[Q._cultureInfo.printText,Q._cultureInfo.saveJPGText,Q._cultureInfo.savePNGText],ct=0;ct<Pt.length;ct++)un(Pt[ct],{backgroundColor:Q.toolbar.itemBackgroundColor,color:Q.toolbar.fontColor}),Pt[ct].innerHTML=yt[ct]}else!Q._dropdownMenu&&Q.exportEnabled&&rt&&(xt=!1,Q._dropdownMenu=document.createElement("div"),Q._dropdownMenu.setAttribute("tabindex",-1),Pt=-1!==Q.theme.indexOf("dark")?"black":"#888888",un(Q._dropdownMenu,{position:"absolute",zIndex:1,userSelect:"none",MozUserSeelct:"none",WebkitUserSelect:"none",msUserSelect:"none",cursor:"pointer",right:"0px",top:"25px",minWidth:"120px",outline:0,fontSize:"14px",fontFamily:"Arial, Helvetica, sans-serif",padding:"5px 0px 5px 0px",textAlign:"left",lineHeight:"10px",backgroundColor:Q.toolbar.itemBackgroundColor,boxShadow:"2px 2px 10px"+Pt}),Q._dropdownMenu.style.display="none",Q._toolBar.appendChild(Q._dropdownMenu),Li(Q._dropdownMenu,"blur",function(){As(Q._dropdownMenu),Q._dropDownCloseTime=new Date},Q.allDOMEventHandlers,!0),un(Pt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Pt.innerHTML=Q._cultureInfo.printText,Pt.style.backgroundColor=Q.toolbar.itemBackgroundColor,Pt.style.color=Q.toolbar.fontColor,Q._dropdownMenu.appendChild(Pt),Li(Pt,"touchstart",function(pt){xt=!0},Q.allDOMEventHandlers),Li(Pt,"mousemove",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColorOnHover,this.style.color=Q.toolbar.fontColorOnHover)},Q.allDOMEventHandlers,!0),Li(Pt,"mouseout",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColor,this.style.color=Q.toolbar.fontColor)},Q.allDOMEventHandlers,!0),Li(Pt,"click",function(){Q.print(),As(Q._dropdownMenu)},Q.allDOMEventHandlers,!0),un(Pt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Pt.innerHTML=Q._cultureInfo.saveJPGText,Pt.style.backgroundColor=Q.toolbar.itemBackgroundColor,Pt.style.color=Q.toolbar.fontColor,Q._dropdownMenu.appendChild(Pt),Li(Pt,"touchstart",function(pt){xt=!0},Q.allDOMEventHandlers),Li(Pt,"mousemove",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColorOnHover,this.style.color=Q.toolbar.fontColorOnHover)},Q.allDOMEventHandlers,!0),Li(Pt,"mouseout",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColor,this.style.color=Q.toolbar.fontColor)},Q.allDOMEventHandlers,!0),Li(Pt,"click",function(){Q.exportChart({format:"jpeg",fileName:Q.exportFileName}),As(Q._dropdownMenu)},Q.allDOMEventHandlers,!0),un(Pt=document.createElement("div"),{padding:"12px 8px 12px 8px"}),Pt.innerHTML=Q._cultureInfo.savePNGText,Pt.style.backgroundColor=Q.toolbar.itemBackgroundColor,Pt.style.color=Q.toolbar.fontColor,Q._dropdownMenu.appendChild(Pt),Li(Pt,"touchstart",function(pt){xt=!0},Q.allDOMEventHandlers),Li(Pt,"mousemove",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColorOnHover,this.style.color=Q.toolbar.fontColorOnHover)},Q.allDOMEventHandlers,!0),Li(Pt,"mouseout",function(){xt||(this.style.backgroundColor=Q.toolbar.itemBackgroundColor,this.style.color=Q.toolbar.fontColor)},Q.allDOMEventHandlers,!0),Li(Pt,"click",function(){Q.exportChart({format:"png",fileName:Q.exportFileName}),As(Q._dropdownMenu)},Q.allDOMEventHandlers,!0))}function yo(Q,xt,Pt){for(Q=Pt.getImageData(Q*=Js,xt*=Js,2,2).data,xt=!0,Pt=0;4>Pt;Pt++)if(Q[Pt]!==Q[Pt+4]|Q[Pt]!==Q[Pt+8]|Q[Pt]!==Q[Pt+12]){xt=!1;break}return xt?Q[0]<<16|Q[1]<<8|Q[2]:0}function Xi(Q,xt,Pt){return Q in xt?xt[Q]:Pt[Q]}function cn(Q,xt,Pt){if(rt&&ps){var yt=Q.getContext("2d");Q.width=xt*(Js=co/(Br=yt.webkitBackingStorePixelRatio||yt.mozBackingStorePixelRatio||yt.msBackingStorePixelRatio||yt.oBackingStorePixelRatio||yt.backingStorePixelRatio||1)),Q.height=Pt*Js,co!==Br&&(Q.style.width=xt+"px",Q.style.height=Pt+"px",yt.scale(Js,Js))}else Q.width=xt,Q.height=Pt}function zi(Q,xt){Ze&&(this.canvasCount|=0,window.console.log(++this.canvasCount));var Pt=document.createElement("canvas");return Pt.setAttribute("class","canvasjs-chart-canvas"),cn(Pt,Q,xt),rt||typeof G_vmlCanvasManager>"u"||G_vmlCanvasManager.initElement(Pt),Pt}function un(Q,xt){for(var Pt in xt)Q.style[Pt]=xt[Pt]}function js(Q,xt,Pt){xt.getAttribute("state")||(xt.style.backgroundColor=Q.toolbar.itemBackgroundColor,xt.style.color=Q.toolbar.fontColor,xt.style.border="none",un(xt,{WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none"})),xt.getAttribute("state")!==Pt&&(xt.setAttribute("state",Pt),xt.setAttribute("type","button"),un(xt,{padding:"5px 12px",cursor:"pointer",float:"left",width:"40px",height:"25px",outline:"0px",verticalAlign:"baseline",lineHeight:"0"}),xt.setAttribute("title",Q._cultureInfo[Pt+"Text"]),xt.innerHTML="<img src='"+Vt[Pt].image+"' alt='"+Q._cultureInfo[Pt+"Text"]+"' />",un(xt.childNodes[0],{height:"95%",pointerEvents:"none"}))}function Wi(){for(var Q=null,xt=0;xt<arguments.length;xt++)(Q=arguments[xt]).style&&(Q.style.display="inline")}function As(){for(var Q=null,xt=0;xt<arguments.length;xt++)(Q=arguments[xt])&&Q.style&&(Q.style.display="none")}function Ri(Q){if(null===Q||"object"!=typeof Q)return Q;if(Q instanceof Date)return new Date(Q.getTime());if(Array.isArray||(Array.isArray=function(yt){return"[object Array]"===Object.prototype.toString.call(yt)}),Array.isArray(Q)){for(var xt=[],Pt=0;Pt<Q.length;Pt++)xt.push(Ri(Q[Pt]));return xt}for(Pt in xt=new Q.constructor,Q)Q.hasOwnProperty(Pt)&&(xt[Pt]=Ri(Q[Pt]));return xt}function Us(Q,xt,Pt,yt,ct){return null===Q||typeof Q>"u"?typeof Pt>"u"?xt:Pt:(Q=parseFloat(Q.toString())*(0<=Q.toString().indexOf("%")?xt/100:1),typeof yt<"u"&&(Q=Math.min(yt,Q),typeof ct<"u"&&(Q=Math.max(ct,Q))),!isNaN(Q)&&Q<=xt&&0<=Q?Q:typeof Pt>"u"?xt:Pt)}function fn(Q,xt,Pt,yt,ct){this._defaultsKey=Q,this._themeOptionsKey=xt,this._index=yt,this.parent=ct,this._eventListeners=[],Q={},this.theme&&Et(this.parent)&&Et(xt)&&Et(yt)?Q=Et(this.predefinedThemes[this.theme])?this.predefinedThemes.light1:this.predefinedThemes[this.theme]:this.parent&&this.parent.themeOptions&&this.parent.themeOptions[xt]&&(null===yt?Q=this.parent.themeOptions[xt]:0<this.parent.themeOptions[xt].length&&(yt=Math.min(this.parent.themeOptions[xt].length-1,yt),Q=this.parent.themeOptions[xt][yt])),this.themeOptions=Q,this.options=Pt||{_isPlaceholder:!0},this.setOptions(this.options,Q)}function ln(Q,xt,Pt,yt,ct){typeof ct>"u"&&(ct=0),this._padding=ct,this._x1=Q,this._y1=xt,this._x2=Pt,this._y2=yt,this._rightOccupied=this._leftOccupied=this._bottomOccupied=this._topOccupied=this._padding}function En(Q,xt){En.base.constructor.call(this,"TextBlock",null,xt,null,null),this.ctx=Q,this._isDirty=!0,this._wrappedText=null,this._initialize()}function ao(Q,xt){ao.base.constructor.call(this,"Toolbar","toolbar",xt,null,Q),this.chart=Q,this.canvas=Q.canvas,this.ctx=this.chart.ctx,this.optionsName="toolbar"}function Ys(Q,xt){if(Ys.base.constructor.call(this,"Title","title",xt,null,Q),this.chart=Q,this.canvas=Q.canvas,this.ctx=this.chart.ctx,this.optionsName="title",Et(this.options.margin)&&Q.options.subtitles)for(var Pt=Q.options.subtitles,yt=0;yt<Pt.length;yt++)if((Et(Pt[yt].horizontalAlign)&&"center"===this.horizontalAlign||Pt[yt].horizontalAlign===this.horizontalAlign)&&(Et(Pt[yt].verticalAlign)&&"top"===this.verticalAlign||Pt[yt].verticalAlign===this.verticalAlign)&&!Pt[yt].dockInsidePlotArea==!this.dockInsidePlotArea){this.margin=0;break}typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.height=this.width=null,this.bounds={x1:null,y1:null,x2:null,y2:null}}function Mn(Q,xt,Pt){Mn.base.constructor.call(this,"Subtitle","subtitles",xt,Pt,Q),this.chart=Q,this.canvas=Q.canvas,this.ctx=this.chart.ctx,this.optionsName="subtitles",this.isOptionsInArray=!0,typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.height=this.width=null,this.bounds={x1:null,y1:null,x2:null,y2:null}}function oe(){this.pool=[]}function Ls(Q){var xt;Q&&Kt[Q]&&(xt=Kt[Q]),Ls.base.constructor.call(this,"CultureInfo",null,xt,null,null)}var Ke,Vi,$e,hi,ai,Ze=!1,at={},rt=!!document.createElement("canvas").getContext,Yt={Chart:{width:500,height:400,zoomEnabled:!1,zoomType:"x",backgroundColor:"white",theme:"light1",animationEnabled:!1,animationDuration:1200,dataPointWidth:null,dataPointMinWidth:null,dataPointMaxWidth:null,colorSet:"colorSet1",culture:"en",creditHref:"",creditText:"CanvasJS",interactivityEnabled:!0,exportEnabled:!1,exportFileName:"Chart",rangeChanging:null,rangeChanged:null,publicProperties:{title:"readWrite",subtitles:"readWrite",toolbar:"readWrite",toolTip:"readWrite",legend:"readWrite",axisX:"readWrite",axisY:"readWrite",axisX2:"readWrite",axisY2:"readWrite",data:"readWrite",options:"readWrite",bounds:"readOnly",container:"readOnly",selectedColorSet:"readOnly"}},Title:{padding:0,text:null,verticalAlign:"top",horizontalAlign:"center",fontSize:20,fontFamily:"Calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:rt?"transparent":null,margin:5,wrap:!0,maxWidth:null,dockInsidePlotArea:!1,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},Subtitle:{padding:0,text:null,verticalAlign:"top",horizontalAlign:"center",fontSize:14,fontFamily:"Calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:null,margin:2,wrap:!0,maxWidth:null,dockInsidePlotArea:!1,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},Toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white",publicProperties:{options:"readWrite",chart:"readOnly"}},Legend:{name:null,verticalAlign:"center",horizontalAlign:"right",fontSize:14,fontFamily:"calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",cursor:null,itemmouseover:null,itemmouseout:null,itemmousemove:null,itemclick:null,dockInsidePlotArea:!1,reversed:!1,backgroundColor:rt?"transparent":null,borderColor:rt?"transparent":null,borderThickness:0,cornerRadius:0,maxWidth:null,maxHeight:null,markerMargin:null,itemMaxWidth:null,itemWidth:null,itemWrap:!0,itemTextFormatter:null,publicProperties:{options:"readWrite",bounds:"readOnly",chart:"readOnly"}},ToolTip:{enabled:!0,shared:!1,animationEnabled:!0,content:null,contentFormatter:null,reversed:!1,backgroundColor:rt?"rgba(255,255,255,.9)":"rgb(255,255,255)",borderColor:null,borderThickness:2,cornerRadius:5,fontSize:14,fontColor:"black",fontFamily:"Calibri, Arial, Georgia, serif;",fontWeight:"normal",fontStyle:"italic",updated:null,hidden:null,publicProperties:{options:"readWrite",chart:"readOnly"}},Axis:{minimum:null,maximum:null,viewportMinimum:null,viewportMaximum:null,interval:null,intervalType:null,reversed:!1,logarithmic:!1,logarithmBase:10,title:null,titleFontColor:"black",titleFontSize:20,titleFontFamily:"arial",titleFontWeight:"normal",titleFontStyle:"normal",titleWrap:!0,titleMaxWidth:null,titleBackgroundColor:rt?"transparent":null,titleBorderColor:rt?"transparent":null,titleBorderThickness:0,titleCornerRadius:0,labelAngle:0,labelFontFamily:"arial",labelFontColor:"black",labelFontSize:12,labelFontWeight:"normal",labelFontStyle:"normal",labelAutoFit:!0,labelWrap:!0,labelMaxWidth:null,labelFormatter:null,labelBackgroundColor:rt?"transparent":null,labelBorderColor:rt?"transparent":null,labelBorderThickness:0,labelCornerRadius:0,labelPlacement:"outside",labelTextAlign:"left",prefix:"",suffix:"",includeZero:!1,tickLength:5,tickColor:"black",tickThickness:1,tickPlacement:"outside",lineColor:"black",lineThickness:1,lineDashType:"solid",gridColor:"#A0A0A0",gridThickness:0,gridDashType:"solid",interlacedColor:rt?"transparent":null,valueFormatString:null,margin:2,publicProperties:{options:"readWrite",stripLines:"readWrite",scaleBreaks:"readWrite",crosshair:"readWrite",bounds:"readOnly",chart:"readOnly"}},StripLine:{value:null,startValue:null,endValue:null,color:"orange",opacity:null,thickness:2,lineDashType:"solid",label:"",labelPlacement:"inside",labelAlign:"far",labelWrap:!0,labelMaxWidth:null,labelBackgroundColor:null,labelBorderColor:rt?"transparent":null,labelBorderThickness:0,labelCornerRadius:0,labelFontFamily:"arial",labelFontColor:"orange",labelFontSize:12,labelFontWeight:"normal",labelFontStyle:"normal",labelFormatter:null,showOnTop:!1,publicProperties:{options:"readWrite",axis:"readOnly",bounds:"readOnly",chart:"readOnly"}},ScaleBreaks:{autoCalculate:!1,collapsibleThreshold:"25%",maxNumberOfAutoBreaks:2,spacing:8,type:"straight",color:"#FFFFFF",fillOpacity:.9,lineThickness:2,lineColor:"#E16E6E",lineDashType:"solid",publicProperties:{options:"readWrite",customBreaks:"readWrite",axis:"readOnly",autoBreaks:"readOnly",bounds:"readOnly",chart:"readOnly"}},Break:{startValue:null,endValue:null,spacing:8,type:"straight",color:"#FFFFFF",fillOpacity:.9,lineThickness:2,lineColor:"#E16E6E",lineDashType:"solid",publicProperties:{options:"readWrite",scaleBreaks:"readOnly",bounds:"readOnly",chart:"readOnly"}},Crosshair:{enabled:!1,snapToDataPoint:!1,color:"grey",opacity:null,thickness:2,lineDashType:"solid",label:"",labelWrap:!0,labelMaxWidth:null,labelBackgroundColor:rt?"grey":null,labelBorderColor:rt?"grey":null,labelBorderThickness:0,labelCornerRadius:0,labelFontFamily:rt?"Calibri, Optima, Candara, Verdana, Geneva, sans-serif":"calibri",labelFontSize:12,labelFontColor:"#fff",labelFontWeight:"normal",labelFontStyle:"normal",labelFormatter:null,valueFormatString:null,updated:null,hidden:null,publicProperties:{options:"readWrite",axis:"readOnly",bounds:"readOnly",chart:"readOnly"}},DataSeries:{name:null,dataPoints:null,label:"",bevelEnabled:!1,highlightEnabled:!0,cursor:"default",indexLabel:"",indexLabelPlacement:"auto",indexLabelOrientation:"horizontal",indexLabelTextAlign:"left",indexLabelFontColor:"black",indexLabelFontSize:12,indexLabelFontStyle:"normal",indexLabelFontFamily:"Arial",indexLabelFontWeight:"normal",indexLabelBackgroundColor:null,indexLabelLineColor:"gray",indexLabelLineThickness:1,indexLabelLineDashType:"solid",indexLabelMaxWidth:null,indexLabelWrap:!0,indexLabelFormatter:null,lineThickness:2,lineDashType:"solid",connectNullData:!1,nullDataLineDashType:"dash",color:null,lineColor:null,risingColor:"white",fallingColor:"red",fillOpacity:null,startAngle:0,radius:null,innerRadius:null,neckHeight:null,neckWidth:null,reversed:!1,valueRepresents:null,linkedDataSeriesIndex:null,whiskerThickness:2,whiskerDashType:"solid",whiskerColor:null,whiskerLength:null,stemThickness:2,stemColor:null,stemDashType:"solid",upperBoxColor:"white",lowerBoxColor:"white",type:"column",xValueType:"number",axisXType:"primary",axisYType:"primary",axisXIndex:0,axisYIndex:0,xValueFormatString:null,yValueFormatString:null,zValueFormatString:null,percentFormatString:null,showInLegend:null,legendMarkerType:null,legendMarkerColor:null,legendText:null,legendMarkerBorderColor:rt?"transparent":null,legendMarkerBorderThickness:0,markerType:"circle",markerColor:null,markerSize:null,markerBorderColor:rt?"transparent":null,markerBorderThickness:0,mouseover:null,mouseout:null,mousemove:null,click:null,toolTipContent:null,visible:!0,publicProperties:{options:"readWrite",axisX:"readWrite",axisY:"readWrite",chart:"readOnly"}},TextBlock:{x:0,y:0,width:null,height:null,maxWidth:null,maxHeight:null,padding:0,angle:0,text:"",horizontalAlign:"center",textAlign:"left",fontSize:12,fontFamily:"calibri",fontWeight:"normal",fontColor:"black",fontStyle:"normal",borderThickness:0,borderColor:"black",cornerRadius:0,backgroundColor:null,textBaseline:"top"},CultureInfo:{decimalSeparator:".",digitGroupSeparator:",",zoomText:"Zoom",panText:"Pan",resetText:"Reset",menuText:"More Options",saveJPGText:"Save as JPEG",savePNGText:"Save as PNG",printText:"Print",days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}},Kt={en:{}},Xt=rt?"Trebuchet MS, Helvetica, sans-serif":"Arial",xe=rt?"Impact, Charcoal, sans-serif":"Arial",We={colorSet1:"#4F81BC #C0504E #9BBB58 #23BFAA #8064A1 #4AACC5 #F79647 #7F6084 #77A033 #33558B #E59566".split(" "),colorSet2:"#6D78AD #51CDA0 #DF7970 #4C9CA0 #AE7D99 #C9D45C #5592AD #DF874D #52BCA8 #8E7AA3 #E3CB64 #C77B85 #C39762 #8DD17E #B57952 #FCC26C".split(" "),colorSet3:"#8CA1BC #36845C #017E82 #8CB9D0 #708C98 #94838D #F08891 #0366A7 #008276 #EE7757 #E5BA3A #F2990B #03557B #782970".split(" ")};ai=hi="#000000";var Qi={colorSet:"colorSet1",backgroundColor:"#FFFFFF",title:{fontFamily:xe,fontSize:32,fontColor:Vi="#333333",fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:xe,fontSize:Ei=14,fontColor:Vi,fontWeight:"normal",verticalAlign:"top",margin:5}],data:[{indexLabelFontFamily:Xt,indexLabelFontSize:Ei,indexLabelFontColor:Vi,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:Xt,titleFontSize:Pi=20,titleFontColor:Vi,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e="#000000",labelFontWeight:"normal",lineThickness:1,lineColor:Ke="#666666",tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisX2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:Vi,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:Vi,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:Vi,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],legend:{fontFamily:Xt,fontSize:14,fontColor:Vi,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:Xt,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1},toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white"}};Ke="#2A2A2A",$e=Vi="#F5F5F5",Ke="#FFFFFF",hi="#40BAF1",ai="#F5F5F5";var Pi,Ei,ys={colorSet:"colorSet2",title:{fontFamily:Xt,fontSize:33,fontColor:"#3A3A3A",fontWeight:"bold",verticalAlign:"top",margin:5},subtitles:[{fontFamily:Xt,fontSize:Ei=14,fontColor:"#3A3A3A",fontWeight:"normal",verticalAlign:"top",margin:5}],data:[{indexLabelFontFamily:Xt,indexLabelFontSize:Ei,indexLabelFontColor:"#666666",indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:Xt,titleFontSize:Pi=20,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:1,lineColor:"#BBBBBB",tickThickness:1,tickColor:"#BBBBBB",gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisX2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:1,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:0,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],axisY2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:"#666666",titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#666666",labelFontWeight:"normal",lineThickness:0,lineColor:"#BBBBBB",tickColor:"#BBBBBB",tickThickness:1,gridThickness:1,gridColor:"#BBBBBB",stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FFA500",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FFA500",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#EEEEEE",labelFontWeight:"normal",labelBackgroundColor:"black",color:"black",thickness:1,lineDashType:"dot"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#BBBBBB",lineThickness:1,lineDashType:"solid"}}],legend:{fontFamily:Xt,fontSize:14,fontColor:"#3A3A3A",fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:Xt,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1},toolbar:{itemBackgroundColor:"white",itemBackgroundColorOnHover:"#2196f3",buttonBorderColor:"#2196f3",buttonBorderThickness:1,fontColor:"black",fontColorOnHover:"white"}};$e=Vi="#F5F5F5",xe={colorSet:"colorSet12",backgroundColor:"#2A2A2A",title:{fontFamily:xe,fontSize:32,fontColor:Vi,fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:xe,fontSize:Ei=14,fontColor:Vi,fontWeight:"normal",verticalAlign:"top",margin:5}],toolbar:{itemBackgroundColor:"#666666",itemBackgroundColorOnHover:"#FF7372",buttonBorderColor:"#FF7372",buttonBorderThickness:1,fontColor:"#F5F5F5",fontColorOnHover:"#F5F5F5"},data:[{indexLabelFontFamily:Xt,indexLabelFontSize:Ei,indexLabelFontColor:$e,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:Xt,titleFontSize:Pi=20,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke="#FFFFFF",tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai="#F5F5F5",color:hi="#40BAF1",thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisX2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],legend:{fontFamily:Xt,fontSize:14,fontColor:Vi,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:Xt,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1,fontColor:$e,backgroundColor:"rgba(0, 0, 0, .7)"}},$e=Vi="#FAFAFA";var Q,xt,Pt,yt,ct,pt,wt,Hs={light1:Qi,light2:ys,dark1:xe,dark2:hi={colorSet:"colorSet2",backgroundColor:"#32373A",title:{fontFamily:Xt,fontSize:32,fontColor:Vi,fontWeight:"normal",verticalAlign:"top",margin:5},subtitles:[{fontFamily:Xt,fontSize:Ei=14,fontColor:Vi,fontWeight:"normal",verticalAlign:"top",margin:5}],toolbar:{itemBackgroundColor:"#666666",itemBackgroundColorOnHover:"#FF7372",buttonBorderColor:"#FF7372",buttonBorderThickness:1,fontColor:"#F5F5F5",fontColorOnHover:"#F5F5F5"},data:[{indexLabelFontFamily:Xt,indexLabelFontSize:Ei,indexLabelFontColor:$e,indexLabelFontWeight:"normal",indexLabelLineThickness:1}],axisX:[{titleFontFamily:Xt,titleFontSize:Pi=20,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke="#FFFFFF",tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai="#F5F5F5",color:hi="#40BAF1",thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisX2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:1,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:0,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:0,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],axisY2:[{titleFontFamily:Xt,titleFontSize:Pi,titleFontColor:$e,titleFontWeight:"normal",labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:$e,labelFontWeight:"normal",lineThickness:0,lineColor:Ke,tickThickness:1,tickColor:Ke,gridThickness:1,gridColor:Ke,stripLines:[{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#FF7300",labelFontWeight:"normal",labelBackgroundColor:null,color:"#FF7300",thickness:1}],crosshair:{labelFontFamily:Xt,labelFontSize:Ei,labelFontColor:"#000000",labelFontWeight:"normal",labelBackgroundColor:ai,color:hi,thickness:1,lineDashType:"dash"},scaleBreaks:{type:"zigzag",spacing:"2%",lineColor:"#777777",lineThickness:1,lineDashType:"solid",color:"#111111"}}],legend:{fontFamily:Xt,fontSize:14,fontColor:Vi,fontWeight:"bold",verticalAlign:"bottom",horizontalAlign:"center"},toolTip:{fontFamily:Xt,fontSize:14,fontStyle:"normal",cornerRadius:0,borderThickness:1,fontColor:$e,backgroundColor:"rgba(0, 0, 0, .7)"}},theme1:Qi,theme2:ys,theme3:Qi},In={numberDuration:1,yearDuration:314496e5,monthDuration:2592e6,weekDuration:6048e5,dayDuration:864e5,hourDuration:36e5,minuteDuration:6e4,secondDuration:1e3,millisecondDuration:1,dayOfWeekFromInt:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")},Sr=function(){var Q=!1;try{var xt=Object.defineProperty&&Object.defineProperty({},"passive",{get:function(){return Q=!0,!1}});window.addEventListener&&(window.addEventListener("test",null,xt),window.removeEventListener("test",null,xt))}catch{Q=!1}return Q}(),Lr={},_o=null,La=function(Q){var xt=0,Pt=0;if(this.options.width?xt=this.width:this.width=xt=0<this.container.clientWidth?this.container.clientWidth:this.width,this.options.height?Pt=this.height:this.height=Pt=0<this.container.clientHeight?this.container.clientHeight:this.height,this.canvas.width!==xt*Js||this.canvas.height!==Pt*Js){for(var yt=0;yt<Q.length;yt++)cn(Q[yt],xt,Pt);return this.bounds={x1:0,y1:0,x2:this.width,y2:this.height,width:this.width,height:this.height},!0}return!1},Ps=function(){this.ctx.clearRect(0,0,this.width,this.height),this.backgroundColor&&(this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height))},$s=function(Q){Q.width=1,Q.height=1,Q.getContext("2d")&&Q.getContext("2d").clearRect(0,0,1,1)},Zo=function(Q,xt,Pt){return xt=Math.min(this.width,this.height),Math.max("theme4"===this.theme?0:300<=xt?12:11,Math.round(xt*(Q/400)))},Es=(Q=/D{1,4}|M{1,4}|Y{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|f{1,3}|t{1,2}|T{1,2}|K|z{1,3}|"[^"]*"|'[^']*'/g,xt="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Pt="Sun Mon Tue Wed Thu Fri Sat".split(" "),yt="January February March April May June July August September October November December".split(" "),ct="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),pt=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,wt=/[^-+\dA-Z]/g,function(It,Gt,re){var te=re?re.days:xt,ie=re?re.months:yt,u=re?re.shortDays:Pt,I=re?re.shortMonths:ct;re="";var g=!1;if(It=It&&It.getTime?It:It?new Date(It):new Date,isNaN(It))throw SyntaxError("invalid date");"UTC:"===Gt.slice(0,4)&&(Gt=Gt.slice(4),g=!0);var x=It[(re=g?"getUTC":"get")+"Date"](),w=It[re+"Day"](),D=It[re+"Month"](),o=It[re+"FullYear"](),y=It[re+"Hours"](),f=It[re+"Minutes"](),c=It[re+"Seconds"](),d=It[re+"Milliseconds"](),M=g?0:It.getTimezoneOffset();return Gt.replace(Q,function(k){switch(k){case"D":return x;case"DD":return De(x,2);case"DDD":return u[w];case"DDDD":return te[w];case"M":return D+1;case"MM":return De(D+1,2);case"MMM":return I[D];case"MMMM":return ie[D];case"Y":return parseInt(String(o).slice(-2));case"YY":return De(String(o).slice(-2),2);case"YYY":return De(String(o).slice(-3),3);case"YYYY":return De(o,4);case"h":return y%12||12;case"hh":return De(y%12||12,2);case"H":return y;case"HH":return De(y,2);case"m":return f;case"mm":return De(f,2);case"s":return c;case"ss":return De(c,2);case"f":return De(String(d),3).slice(0,1);case"ff":return De(String(d),3).slice(0,2);case"fff":return De(String(d),3).slice(0,3);case"t":return 12>y?"a":"p";case"tt":return 12>y?"am":"pm";case"T":return 12>y?"A":"P";case"TT":return 12>y?"AM":"PM";case"K":return g?"UTC":(String(It).match(pt)||[""]).pop().replace(wt,"");case"z":return(0<M?"-":"+")+Math.floor(Math.abs(M)/60);case"zz":return(0<M?"-":"+")+De(Math.floor(Math.abs(M)/60),2);case"zzz":return(0<M?"-":"+")+De(Math.floor(Math.abs(M)/60),2)+De(Math.abs(M)%60,2);default:return k.slice(1,k.length-1)}})}),Gn=function(Q,xt,Pt){if(null===Q)return"";if(!isFinite(Q))return Q;var yt=0>(Q=Number(Q));yt&&(Q*=-1);var ct=Pt?Pt.decimalSeparator:".",pt=Pt?Pt.digitGroupSeparator:",",wt="";xt=String(xt),wt=1;var x=Pt="",It=-1,Gt=[],re=[],te=0,ie=0,u=0,I=!1,g=0;x=xt.match(/"[^"]*"|'[^']*'|[eE][+-]*[0]+|[,]+[.]|\u2030|./g),xt=null;for(var w=0;x&&w<x.length;w++)if("."===(xt=x[w])&&0>It)It=w;else{if("%"===xt)wt*=100;else{if("\u2030"===xt){wt*=1e3;continue}if(","===xt[0]&&"."===xt[xt.length-1]){wt/=Math.pow(1e3,xt.length-1),It=w+xt.length-1;continue}"E"!==xt[0]&&"e"!==xt[0]||"0"!==xt[xt.length-1]||(I=!0)}0>It?(Gt.push(xt),"#"===xt||"0"===xt?te++:","===xt&&u++):(re.push(xt),"#"!==xt&&"0"!==xt||ie++)}for(I&&(xt=Math.floor(Q),x=-Math.floor(Math.log(Q)/Math.LN10+1),g=0===Q?0:0===xt?-(te+x):String(xt).length-te,wt/=Math.pow(10,g)),0>It&&(It=w),xt=(wt=(Q*wt).toFixed(ie)).split("."),wt=(xt[0]+"").split(""),Q=(xt[1]+"").split(""),wt&&"0"===wt[0]&&wt.shift(),I=x=w=ie=It=0;0<Gt.length;)if("#"===(xt=Gt.pop())||"0"===xt)if(++It===te){var D=wt;if(wt=[],"0"===xt)for(xt=te-ie-(D?D.length:0);0<xt;)D.unshift("0"),xt--;for(;0<D.length;)Pt=D.pop()+Pt,++I%x==0&&w===u&&0<D.length&&(Pt=pt+Pt)}else 0<wt.length?(Pt=wt.pop()+Pt,ie++,I++):"0"===xt&&(Pt="0"+Pt,ie++,I++),I%x==0&&w===u&&0<wt.length&&(Pt=pt+Pt);else"E"!==xt[0]&&"e"!==xt[0]||"0"!==xt[xt.length-1]||!/[eE][+-]*[0]+/.test(xt)?","===xt?(w++,x=I,I=0,0<wt.length&&(Pt=pt+Pt)):Pt=1<xt.length&&('"'===xt[0]&&'"'===xt[xt.length-1]||"'"===xt[0]&&"'"===xt[xt.length-1])?xt.slice(1,xt.length-1)+Pt:xt+Pt:Pt+=(xt=0>g?xt.replace("+","").replace("-",""):xt.replace("-","")).replace(/[0]+/,function(o){return De(g,o.length)});for(pt="",Gt=!1;0<re.length;)"#"===(xt=re.shift())||"0"===xt?0<Q.length&&0!==Number(Q.join(""))?(pt+=Q.shift(),Gt=!0):"0"===xt&&(pt+="0",Gt=!0):1<xt.length&&('"'===xt[0]&&'"'===xt[xt.length-1]||"'"===xt[0]&&"'"===xt[xt.length-1])?pt+=xt.slice(1,xt.length-1):"E"!==xt[0]&&"e"!==xt[0]||"0"!==xt[xt.length-1]||!/[eE][+-]*[0]+/.test(xt)?pt+=xt:pt+=(xt=0>g?xt.replace("+","").replace("-",""):xt.replace("-","")).replace(/[0]+/,function(o){return De(g,o.length)});return Pt+=(Gt?ct:"")+pt,yt?"-"+Pt:Pt},ls=function(Q){var xt=0,Pt=0;return(Q=Q||window.event).offsetX||0===Q.offsetX?(xt=Q.offsetX,Pt=Q.offsetY):Q.layerX||0==Q.layerX?(xt=Q.layerX,Pt=Q.layerY):(xt=Q.pageX-Q.target.offsetLeft,Pt=Q.pageY-Q.target.offsetTop),{x:xt,y:Pt}},ps=!0,co=window.devicePixelRatio||1,Br=1,Js=ps?co/Br:1,is=function(Q,xt,Pt,yt,ct,pt,wt,It,Gt,re,te,ie,u){typeof u>"u"&&(u=1),wt=wt||0,It=It||"black";var I=15<yt-xt&&15<ct-Pt?8:.35*Math.min(yt-xt,ct-Pt);Q.beginPath(),Q.moveTo(xt,Pt),Q.save(),Q.fillStyle=pt,Q.globalAlpha=u,Q.fillRect(xt,Pt,yt-xt,ct-Pt),Q.globalAlpha=1,0<wt&&(u=wt%2==0?0:.5,Q.beginPath(),Q.lineWidth=wt,Q.strokeStyle=It,Q.moveTo(xt,Pt),Q.rect(xt-u,Pt-u,yt-xt+2*u,ct-Pt+2*u),Q.stroke()),Q.restore(),!0===Gt&&(Q.save(),Q.beginPath(),Q.moveTo(xt,Pt),Q.lineTo(xt+I,Pt+I),Q.lineTo(yt-I,Pt+I),Q.lineTo(yt,Pt),Q.closePath(),(wt=Q.createLinearGradient((yt+xt)/2,Pt+I,(yt+xt)/2,Pt)).addColorStop(0,pt),wt.addColorStop(1,"rgba(255, 255, 255, .4)"),Q.fillStyle=wt,Q.fill(),Q.restore()),!0===re&&(Q.save(),Q.beginPath(),Q.moveTo(xt,ct),Q.lineTo(xt+I,ct-I),Q.lineTo(yt-I,ct-I),Q.lineTo(yt,ct),Q.closePath(),(wt=Q.createLinearGradient((yt+xt)/2,ct-I,(yt+xt)/2,ct)).addColorStop(0,pt),wt.addColorStop(1,"rgba(255, 255, 255, .4)"),Q.fillStyle=wt,Q.fill(),Q.restore()),!0===te&&(Q.save(),Q.beginPath(),Q.moveTo(xt,Pt),Q.lineTo(xt+I,Pt+I),Q.lineTo(xt+I,ct-I),Q.lineTo(xt,ct),Q.closePath(),(wt=Q.createLinearGradient(xt+I,(ct+Pt)/2,xt,(ct+Pt)/2)).addColorStop(0,pt),wt.addColorStop(1,"rgba(255, 255, 255, 0.1)"),Q.fillStyle=wt,Q.fill(),Q.restore()),!0===ie&&(Q.save(),Q.beginPath(),Q.moveTo(yt,Pt),Q.lineTo(yt-I,Pt+I),Q.lineTo(yt-I,ct-I),Q.lineTo(yt,ct),(wt=Q.createLinearGradient(yt-I,(ct+Pt)/2,yt,(ct+Pt)/2)).addColorStop(0,pt),wt.addColorStop(1,"rgba(255, 255, 255, 0.1)"),Q.fillStyle=wt,wt.addColorStop(0,pt),wt.addColorStop(1,"rgba(255, 255, 255, 0.1)"),Q.fillStyle=wt,Q.fill(),Q.closePath(),Q.restore())},Vs=function(Q){for(var xt="",Pt=0;Pt<Q.length;Pt++)xt+=String.fromCharCode(Math.ceil(Q.length/57/5)^Q.charCodeAt(Pt));return xt},ut=window&&window[Vs("mnb`uhno")]&&window[Vs("mnb`uhno")].href&&window[Vs("mnb`uhno")].href.indexOf&&(-1!==window[Vs("mnb`uhno")].href.indexOf(Vs("b`ow`rkr/bnl"))||-1!==window[Vs("mnb`uhno")].href.indexOf(Vs("gdonqhy/bnl"))||-1!==window[Vs("mnb`uhno")].href.indexOf(Vs("gheemd"))),Ct=ut&&-1===window[Vs("mnb`uhno")].href.indexOf(Vs("gheemd")),Vt={reset:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAeCAYAAABJ/8wUAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAPjSURBVFhHxVdJaFNRFP1J/jwkP5MxsbaC1WJEglSxOFAXIsFpVRE3ggi1K90obioRRBA33XXnQnciirhQcMCdorgQxBkXWlREkFKsWkv5npvckp/XnzRpKh64kLw733fffe9L/wrL0+mVUdO8uTSZ3MBL/we2qg4rkuSpodCELstXE46ziVkLQ6FQcGOmeSSq6wd4aV50d3drWjj8kQKZJTUc9kxFGenv79dZrDksTSTWWJp2QYtEPiErysyzdX0LsxsCQR8keX8gs6RHIk8ysdgKFg2G53mhuOPsshTlBjKaFo1g7SqLNoShKLdFXT8huQ/paLSbxatYnc2mHMM4hr18Vi8TIvCmXF3vYrW6cF23gGTOk0M1wA4RKvOmq6vLZRVJipvmSWT6tZ6CSEYkco5V50VPT4+D7RwOqi6RiSZm0fJ+vggSqkeoypdsNmuyelNwbXsbgvkWYMtzDWNvWaijoyOBqE+hVK8abcssUeXQ/YfKyi0gFYv1Ipgfoj34fYGTJLOYJA0ODirok32GLN8XhUWCwSes1hIwBg6LydJ/tEeRRapAdUp+wSAiZchtZZWWgAZ+JNpD8peYXQVK9UwUxNpzOK8pq97kURZhYTCKBwPD7h2zK+js7Myi7D8Fod+0TkMI8+EMAngLGc/WtBFWawkFHFnoj/t9KLgGmF0B3QfkxC+EarxkdhnFYlFLY06USqUwL7UMjICHfh/wOc2sCqhpxGbCkLvL7EUDbF73+6DkmVWB6zi7xUDQSLeYvWjAILvm9zEnkJhlbRcDQZcv6Kg2AipyT/Axw6wKlqVSqxDdjF8Izfod13qURdrG/nxehY+xGh+h0CSzKygGvSNQIcc097BI24jb9hax6kj2E7OrMFX1il+ICEf2NrPbhiXLl+fYl+U7zK4iYdsDcyLGf+ofFlkwcN+s10KhmpuYhhtm0hCLVIFL0MDsqNlDIqy9x2CLs1jL6OvrI7vPRbtohXG6eFmsFnHDGAp6n9AgyuVySRZrGvROxRgIfLXhzjrNYnNBUxNX/dMgRWT1mt4XLDovaApD53E9W3ilNX5M55LJHpRtIsgAvciR4WWcgK2Dvb1YqgXevmF8z2zEBTcKG39EfSKsT9EbhVUaI2FZO+oZIqImxol6j66/hcAu4sSN4vc1ZPoKeoE6RGhYL2YYA+ymOSSi0Z0wWntbtkGUWCvfSDXIxONraZ/FY90KUfNTpfC5spnNLgxoYNnR9RO4F8ofXEHOgogCQE99w+fF2Xw+b7O59rEOsyRqGEfpVoaDMQQ1CZrG46bcM6AZ0C/wPqNfHliqejyTySxh9TqQpL+xmbIlkB9SlAAAAABJRU5ErkJggg=="},pan:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAICSURBVEhLxZbPahNRGMUn/5MpuAiBEAIufQGfzr5E40YptBXajYzudCEuGqS+gGlrFwquDGRTutBdYfydzJ3LzeQmJGZue+Dw/Z17Mnfmu5Pof9Hr9Z61Wq0bWZMKj263O6xWq99wU9lOpzPMKgEhEcRucNOcioOK+0RzBhNvt9tPV4nmVF19+OWhVqt9xXgFXZq+8lCv119UKpUJ7iX2FmvFTKz8RH34YdBsNk8wVtjE4fGYwm8wrrDi3WBG5oKXZGRSS9hGuNFojLTe2lFz5xThWZIktayyiE2FdT3rzXBXz7krKiL8c17wAKFDjCus2AvW+YGZ9y2JF0VFRuMPfI//rsCE/C+s26s4gQu9ul7r4NteKx7H8XOC724xNNGbaNu++IrBqbOV7Tj3FgMRvc/YKOr3+3sE47wgEt/Bl/gaK5cHbNU11vYSXylfpK7XOvjuumPp4Wcoipu30Qsez2uMXYz4lfI+mOmwothY+SLiXJy7mKVpWs3Si0CoOMfeI9Od43Wic+jO+ZVv+crsm9QSNhUW9LXSeoPBYLXopthGuFQgdIxxhY+UDwlt1x5CZ1hX+NTUdt/OIvjKaDSmuOJfaIVNPKX+W18j/PLA2/kR44p5Sd8HbHngT/yTfNRWUXX14ZcL3wmX0+TLf8YO7CGT8yFE5zB3/gney25/OETRP9CtPDFe5jShAAAAAElFTkSuQmCC"},zoom:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALWSURBVEhLvZZLaBNRFIabyftBIgEfqCCBoCC6MYqiXYiIj4U76U4X7sUHbhQhUBfixhZEUBDB16YuFERaUaQLK7ooCOJj4UKtYEFU0EptShO/A9Ph3js3k8lo/eHnP7n3nP/M3LlzMz1hkUwmNziOcyKRSFyFt+LxeD/c2Wq1Ym7Kv0M2m11Os1OxWGycn1OwZXCGuXfwIhezkd9/jRgNT2L4ldhs1pbkX5OLJe4euVxuGQaPCa3mnUjtJx7BDuKusJTCV6jVVGHTMuYRjxma7yIOhTgFY6jNaAKew2xPKpVay9ganmkvj+M448/MfJdT5K5Gg4HJacRngPFgqVRaRNwW1B4i7yehWfsEDdz1K+A01AoxPIqGAiuwGfkOTY8+1A6u7AyiFTB2Hu0KPIrdiOnzHLWDybeImvy+Wq2mZa5bUHsD0Zpz+KxHdWQymV6kAb1ElqeORgJLvgnRdj1+R1AfzkIvSUjxVjQSarVakrueIPT8+H1F5jSUy+WXiJrUYBVWyVxU4PEU8TzhfaijUqnMIWrjaY492eWRwdKOIqrnIxnXwLLeRLwk2GQzrEMjg0avEbXxkIxr4OoOImpj2QwyFgms1koa/SZUG8s+0iGnEhNfCNXEhzIXBVz0McTzEvJ+70P9oNFtxEzei3aFYrFYxmuSUPWSv9Yi9IMm2xE1We56Mp1OV4nDwqFmBDV9gk9AEh4gZtFHNt8W4kAUCoXF5MorY9Z/kDni9nDv7hc0i2fhgLvTtX8a99PoMPPagTFPxofRzmDJ9yM+AyEmTfgGysYbQcfhDzPPJDmX0c7gDg4gs9BqFIWhm/Nct5H8gtBq1I7UfIbtvmIuoaGQcp+fdpbbSM43eEH5wrwLbXmhm/fU63VHXjcuok7hEByFY/AeHGC8L5/PL3HT5xGH1uYwfPOICGo+CBcU0vwO1BqzUqILDl/z/9VYIMfpddiAc47jDP8BsUpb13wOLRwAAAAASUVORK5CYII="},menu:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAeCAYAAABE4bxTAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADoSURBVFhH7dc9CsJAFATgRxIIBCwCqZKATX5sbawsY2MvWOtF9AB6AU8gguAJbD2AnZ2VXQT/Ko2TYGCL2OYtYQc+BuYA+1hCtnCVwMm27SGaXpDJIAiCvCkVR05hGOZNN3HkFMdx3nQRR06+76/R1IcFLJlNQEWlmWlBTwJtKLKHynehZqnjOGM0PYWRVXk61C37p7xlZ3Hk5HneCk1dmMH811xGoKLSzDiQwIBZB4ocoPJdqNkDt2yKlueWRVGUtzy3rPwo3sWRU3nLjuLI6OO67oZM00wMw3hrmpZx0XU9syxrR0T0BeMpb9dneSR2AAAAAElFTkSuQmCC"}};at.fSDec=function(Q){for(var xt="",Pt=0;Pt<Q.length;Pt++)xt+=String.fromCharCode(Math.ceil(Q.length/57/5)^Q.charCodeAt(Pt));return xt},delete Yt[at.fSDec("Bi`su")][at.fSDec("bsdehuIsdg")],at.pro={sCH:Yt[at.fSDec("Bi`su")][at.fSDec("bsdehuIsdg")]},at.pos=["cm","cs","um"],at._fTWm=function(Q){if(typeof at.pro.sCH>"u"&&!ut)try{var Pt,yt,xt=(new Date).getMonth()%3,ct=Q[at.fSDec("buy")];ct[at.fSDec("udyuC`rdmhod")]=at.fSDec("unq"),ct[at.fSDec("gnou")]=11+at.fSDec("qy!B`mhcsh-!Mtbhe`!Fs`oed-!Mtbhe`!R`or!Tohbned-!@sh`m-!r`or,rdshg"),ct[at.fSDec("ghmmRuxmd")]=at.fSDec("fsdx"),Pt="cm"===at.pos[xt]||"um"===at.pos[xt]?0:Q.width-ct[at.fSDec("ld`rtsdUdyu")](at.fSDec("B`ow`rKR!Ush`m")).width,yt="um"===at.pos[xt]?0:Q.height-11,ct[at.fSDec("ghmmUdyu")](at.fSDec("B`ow`rKR!Ush`m"),Pt,yt),"cs"===at.pos[xt]&&(Q[at.fSDec("^bsdehuMhoj")].style.right=at.fSDec("`tun"))}catch{}},fn.prototype.setOptions=function(Q,xt){if(Yt[this._defaultsKey]){var yt,Pt=Yt[this._defaultsKey];for(yt in Pt)"publicProperties"!==yt&&Pt.hasOwnProperty(yt)&&(this[yt]=Q&&yt in Q?Q[yt]:xt&&yt in xt?xt[yt]:Pt[yt])}else Ze&&window.console&&console.log("defaults not set")},fn.prototype.get=function(Q){var xt=Yt[this._defaultsKey];return"options"===Q?this.options&&this.options._isPlaceholder?null:this.options:xt.hasOwnProperty(Q)||xt.publicProperties&&xt.publicProperties.hasOwnProperty(Q)?this[Q]:void(window.console&&window.console.log('Property "'+Q+"\" doesn't exist. Please check for typo."))},fn.prototype.set=function(Q,xt,Pt){Pt=typeof Pt>"u"||Pt;var yt=Yt[this._defaultsKey];if("options"===Q)this.createUserOptions(xt);else{if(!(yt.hasOwnProperty(Q)||yt.publicProperties&&yt.publicProperties.hasOwnProperty(Q)&&"readWrite"===yt.publicProperties[Q]))return void(window.console&&(yt.publicProperties&&yt.publicProperties.hasOwnProperty(Q)&&"readOnly"===yt.publicProperties[Q]?window.console.log('Property "'+Q+'" is read-only.'):window.console.log('Property "'+Q+"\" doesn't exist. Please check for typo.")));this.options._isPlaceholder&&this.createUserOptions(),this.options[Q]=xt}Pt&&(this.stockChart||this.chart||this).render()},fn.prototype.addTo=function(Q,xt,Pt,yt){yt=typeof yt>"u"||yt;var ct=Yt[this._defaultsKey];ct.hasOwnProperty(Q)||ct.publicProperties&&ct.publicProperties.hasOwnProperty(Q)&&"readWrite"===ct.publicProperties[Q]?(this.options._isPlaceholder&&this.createUserOptions(),typeof this.options[Q]>"u"&&(this.options[Q]=[]),(Q=this.options[Q]).splice(Pt=typeof Pt>"u"||null===Pt?Q.length:Pt,0,xt),yt&&(this.stockChart||this.chart||this).render()):window.console&&(ct.publicProperties&&ct.publicProperties.hasOwnProperty(Q)&&"readOnly"===ct.publicProperties[Q]?window.console.log('Property "'+Q+'" is read-only.'):window.console.log('Property "'+Q+"\" doesn't exist. Please check for typo."))},fn.prototype.createUserOptions=function(Q){if(typeof Q<"u"||this.options._isPlaceholder)if(this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.isOptionsInArray){this.parent.options[this.optionsName]||(this.parent.options[this.optionsName]=[]);var xt=this.parent.options[this.optionsName],Pt=xt.length;this.options._isPlaceholder||(fo(xt),Pt=xt.indexOf(this.options)),this.options=typeof Q>"u"?{}:Q,xt[Pt]=this.options}else this.options=typeof Q>"u"?{}:Q,Q=this.parent.options,this.optionsName?xt=this.optionsName:(xt=this._defaultsKey)&&0!==xt.length?(Pt=xt.charAt(0).toLowerCase(),1<xt.length&&(Pt=Pt.concat(xt.slice(1))),xt=Pt):xt=void 0,Q[xt]=this.options},fn.prototype.remove=function(Q){if(Q=typeof Q>"u"||Q,this.isOptionsInArray){var xt=this.parent.options[this.optionsName];fo(xt);var Pt=xt.indexOf(this.options);0<=Pt&&xt.splice(Pt,1)}else delete this.parent.options[this.optionsName];Q&&(this.stockChart||this.chart||this).render()},fn.prototype.updateOption=function(Q){!Yt[this._defaultsKey]&&Ze&&window.console&&console.log("defaults not set");var xt=Yt[this._defaultsKey],Pt={},yt=this[Q],ct=this._themeOptionsKey,pt=this._index;return this.theme&&Et(this.parent)&&Et(ct)&&Et(pt)?Pt=Et(this.predefinedThemes[this.theme])?this.predefinedThemes.light1:this.predefinedThemes[this.theme]:this.parent&&this.parent.themeOptions&&this.parent.themeOptions[ct]&&(null===pt?Pt=this.parent.themeOptions[ct]:0<this.parent.themeOptions[ct].length&&(Pt=Math.min(this.parent.themeOptions[ct].length-1,pt),Pt=this.parent.themeOptions[ct][Pt])),this.themeOptions=Pt,Q in xt&&(yt=Q in this.options?this.options[Q]:Pt&&Q in Pt?Pt[Q]:xt[Q]),yt!==this[Q]&&(this[Q]=yt,!0)},fn.prototype.trackChanges=function(Q){if(!this.sessionVariables)throw"Session Variable Store not set";this.sessionVariables[Q]=this.options[Q]},fn.prototype.isBeingTracked=function(Q){return this.options._oldOptions||(this.options._oldOptions={}),!!this.options._oldOptions[Q]},fn.prototype.hasOptionChanged=function(Q){if(!this.sessionVariables)throw"Session Variable Store not set";return this.sessionVariables[Q]!==this.options[Q]},fn.prototype.addEventListener=function(Q,xt,Pt){Q&&xt&&(this._eventListeners[Q]=this._eventListeners[Q]||[],this._eventListeners[Q].push({context:Pt||this,eventHandler:xt}))},fn.prototype.removeEventListener=function(Q,xt){if(Q&&xt&&this._eventListeners[Q])for(var Pt=this._eventListeners[Q],yt=0;yt<Pt.length;yt++)if(Pt[yt].eventHandler===xt){Pt[yt].splice(yt,1);break}},fn.prototype.removeAllEventListeners=function(){this._eventListeners=[]},fn.prototype.dispatchEvent=function(Q,xt,Pt){if(Q&&this._eventListeners[Q]){xt=xt||{};for(var yt=this._eventListeners[Q],ct=0;ct<yt.length;ct++)yt[ct].eventHandler.call(yt[ct].context,xt)}"function"==typeof this[Q]&&this[Q].call(Pt||this.chart,xt)},ln.prototype.registerSpace=function(Q,xt){"top"===Q?this._topOccupied+=xt.height:"bottom"===Q?this._bottomOccupied+=xt.height:"left"===Q?this._leftOccupied+=xt.width:"right"===Q&&(this._rightOccupied+=xt.width)},ln.prototype.unRegisterSpace=function(Q,xt){"top"===Q?this._topOccupied-=xt.height:"bottom"===Q?this._bottomOccupied-=xt.height:"left"===Q?this._leftOccupied-=xt.width:"right"===Q&&(this._rightOccupied-=xt.width)},ln.prototype.getFreeSpace=function(){return{x1:this._x1+this._leftOccupied,y1:this._y1+this._topOccupied,x2:this._x2-this._rightOccupied,y2:this._y2-this._bottomOccupied,width:this._x2-this._x1-this._rightOccupied-this._leftOccupied,height:this._y2-this._y1-this._bottomOccupied-this._topOccupied}},ln.prototype.reset=function(){this._rightOccupied=this._leftOccupied=this._bottomOccupied=this._topOccupied=this._padding},On(En,fn),En.prototype._initialize=function(){Et(this.padding)||"object"!=typeof this.padding?this.topPadding=this.rightPadding=this.bottomPadding=this.leftPadding=0|Number(this.padding):(this.topPadding=Et(this.padding.top)?0:0|Number(this.padding.top),this.rightPadding=Et(this.padding.right)?0:0|Number(this.padding.right),this.bottomPadding=Et(this.padding.bottom)?0:0|Number(this.padding.bottom),this.leftPadding=Et(this.padding.left)?0:0|Number(this.padding.left))},En.prototype.render=function(Q){if(0!==this.fontSize){Q&&this.ctx.save();var xt=this.ctx.font;this.ctx.textBaseline=this.textBaseline;var Pt=0;this._isDirty&&this.measureText(this.ctx),this.ctx.translate(this.x,this.y+Pt),"middle"===this.textBaseline&&(Pt=-this._lineHeight/2),this.ctx.font=this._getFontString(),this.ctx.rotate(Math.PI/180*this.angle);var yt=0,ct=this.topPadding,pt=null;for(this.ctx.roundRect||ks(this.ctx),(0<this.borderThickness&&this.borderColor||this.backgroundColor)&&this.ctx.roundRect(0,Pt,this.width,this.height,this.cornerRadius,this.borderThickness,this.backgroundColor,this.borderColor),this.ctx.fillStyle=this.fontColor,Pt=0;Pt<this._wrappedText.lines.length;Pt++)pt=this._wrappedText.lines[Pt],"right"===this.horizontalAlign||"right"===this.textAlign?yt=this.width-pt.width-this.rightPadding:"left"===this.horizontalAlign||"left"===this.textAlign?yt=this.leftPadding:("center"===this.horizontalAlign||"center"===this.textAlign)&&(yt=(this.width-(this.leftPadding+this.rightPadding))/2-pt.width/2+this.leftPadding),this.ctx.fillText(pt.text,yt,ct),ct+=pt.height;this.ctx.font=xt,Q&&this.ctx.restore()}},En.prototype.setText=function(Q){this.text=Q,this._isDirty=!0,this._wrappedText=null},En.prototype.measureText=function(){if(this._lineHeight=tn(this.fontFamily,this.fontSize,this.fontWeight),null===this.maxWidth)throw"Please set maxWidth and height for TextBlock";return this._wrapText(this.ctx),this._isDirty=!1,{width:this.width,height:this.height}},En.prototype._getLineWithWidth=function(Q,xt,Pt){if(!(Q=String(Q)))return{text:"",width:0};var yt=Pt=0,ct=Q.length-1,pt=1/0;for(this.ctx.font=this._getFontString();yt<=ct;){pt=Math.floor((yt+ct)/2);var wt=Q.substr(0,pt+1);if((Pt=this.ctx.measureText(wt).width)<xt)yt=pt+1;else{if(!(Pt>xt))break;ct=pt-1}}return Pt>xt&&1<wt.length&&(wt=wt.substr(0,wt.length-1),Pt=this.ctx.measureText(wt).width),xt=!0,(wt.length===Q.length||" "===Q[wt.length])&&(xt=!1),xt&&(1<(Q=wt.split(" ")).length&&Q.pop(),wt=Q.join(" "),Pt=this.ctx.measureText(wt).width),{text:wt,width:Pt}},En.prototype._wrapText=function(){var Q=new String(ho(String(this.text))),xt=[],Pt=this.ctx.font,yt=0,ct=0;if(this.ctx.font=this._getFontString(),0===this.frontSize)ct=yt=0;else for(;0<Q.length;){var pt=this.maxHeight-(this.topPadding+this.bottomPadding),wt=this._getLineWithWidth(Q,this.maxWidth-(this.leftPadding+this.rightPadding),!1);wt.height=this._lineHeight,xt.push(wt);var It=ct;ct=Math.max(ct,wt.width),yt+=wt.height,Q=ho(Q.slice(wt.text.length,Q.length)),pt&&yt>pt&&(yt-=(wt=xt.pop()).height,ct=It)}this._wrappedText={lines:xt,width:ct,height:yt},this.width=ct+(this.leftPadding+this.rightPadding),this.height=yt+(this.topPadding+this.bottomPadding),this.ctx.font=Pt},En.prototype._getFontString=function(){var Q;Q=this.fontStyle?this.fontStyle+" ":"",Q+=this.fontWeight?this.fontWeight+" ":"",Q+=this.fontSize?this.fontSize+"px ":"";var xt=this.fontFamily?this.fontFamily+"":"";return!rt&&xt&&"'"!==(xt=xt.split(",")[0])[0]&&'"'!==xt[0]&&(xt="'"+xt+"'"),Q+xt},On(ao,fn),On(Ys,fn),Ys.prototype.setLayout=function(){if(this.text){var It,Gt,re,Q=this.dockInsidePlotArea?this.chart.plotArea:this.chart,xt=Q.layoutManager.getFreeSpace(),Pt=xt.x1,yt=xt.y1,ct=0,pt=0,wt=this.chart._menuButton&&this.chart.exportEnabled&&"top"===this.verticalAlign?22:0;"top"===this.verticalAlign||"bottom"===this.verticalAlign?(null===this.maxWidth&&(this.maxWidth=xt.width-4-wt*("center"===this.horizontalAlign?2:1)),pt=.5*xt.height-this.margin-2,ct=0):"center"===this.verticalAlign&&("left"===this.horizontalAlign||"right"===this.horizontalAlign?(null===this.maxWidth&&(this.maxWidth=xt.height-4),pt=.5*xt.width-this.margin-2):"center"===this.horizontalAlign&&(null===this.maxWidth&&(this.maxWidth=xt.width-4),pt=.5*xt.height-4)),Et(this.padding)||"number"!=typeof this.padding?Et(this.padding)||"object"!=typeof this.padding||(re=this.padding.top?this.padding.top:this.padding.bottom?this.padding.bottom:0,re+=this.padding.bottom?this.padding.bottom:this.padding.top?this.padding.top:0):re=2*this.padding,this.wrap||(pt=Math.min(pt,1.5*this.fontSize+re)),re=(pt=new En(this.ctx,{fontSize:this.fontSize,fontFamily:this.fontFamily,fontColor:this.fontColor,fontStyle:this.fontStyle,fontWeight:this.fontWeight,horizontalAlign:this.horizontalAlign,verticalAlign:this.verticalAlign,borderColor:this.borderColor,borderThickness:this.borderThickness,backgroundColor:this.backgroundColor,maxWidth:this.maxWidth,maxHeight:pt,cornerRadius:this.cornerRadius,text:this.text,padding:this.padding,textBaseline:"top"})).measureText(),"top"===this.verticalAlign||"bottom"===this.verticalAlign?("top"===this.verticalAlign?(yt=xt.y1+2,Gt="top"):"bottom"===this.verticalAlign&&(yt=xt.y2-2-re.height,Gt="bottom"),"left"===this.horizontalAlign?Pt=xt.x1+2:"center"===this.horizontalAlign?Pt=xt.x1+xt.width/2-re.width/2:"right"===this.horizontalAlign&&(Pt=xt.x2-2-re.width-wt),It=this.horizontalAlign,this.width=re.width,this.height=re.height):"center"===this.verticalAlign&&("left"===this.horizontalAlign?(Pt=xt.x1+2,yt=xt.y2-2-(this.maxWidth/2-re.width/2),ct=-90,Gt="left",this.width=re.height,this.height=re.width):"right"===this.horizontalAlign?(Pt=xt.x2-2,yt=xt.y1+2+(this.maxWidth/2-re.width/2),ct=90,Gt="right",this.width=re.height,this.height=re.width):"center"===this.horizontalAlign&&(yt=Q.y1+(Q.height/2-re.height/2),Pt=Q.x1+(Q.width/2-re.width/2),Gt="center",this.width=re.width,this.height=re.height),It="center"),pt.x=Pt,pt.y=yt,pt.angle=ct,pt.horizontalAlign=It,this._textBlock=pt,Q.layoutManager.registerSpace(Gt,{width:this.width+("left"===Gt||"right"===Gt?this.margin+2:0),height:this.height+("top"===Gt||"bottom"===Gt?this.margin+2:0)}),this.bounds={x1:Pt,y1:yt,x2:Pt+this.width,y2:yt+this.height},this.ctx.textBaseline="top"}},Ys.prototype.render=function(){this._textBlock&&this._textBlock.render(!0)},On(Mn,fn),Mn.prototype.setLayout=Ys.prototype.setLayout,Mn.prototype.render=Ys.prototype.render,oe.prototype.get=function(Q,xt){var Pt=null;return 0<this.pool.length?cn(Pt=this.pool.pop(),Q,xt):Pt=zi(Q,xt),Pt},oe.prototype.release=function(Q){this.pool.push(Q)},On(Ls,fn);var Le={addTheme:function(Q,xt){Hs[Q]=xt},addColorSet:function(Q,xt){We[Q]=xt},addCultureInfo:function(Q,xt){Kt[Q]=xt},formatNumber:function(Q,xt,Pt){if(Kt[Pt=Pt||"en"])return Gn(Q,xt||"#,##0.##",new Ls(Pt));throw"Unknown Culture Name"},formatDate:function(Q,xt,Pt){if(Kt[Pt=Pt||"en"])return Es(Q,xt||"DD MMM YYYY",new Ls(Pt));throw"Unknown Culture Name"}};typeof Qa.exports<"u"?Qa.exports=Le:void 0!==(ss=function(){return Le}.apply(_l,[]))&&(Qa.exports=ss);var ri=Le.Chart=function(){function Q(o,y){return o.x-y.x}function xt(o,y,f){y=y||{},Et(f)?(this.predefinedThemes=Hs,this.optionsName=this.parent=this.index=null):(this.parent=f.parent,this.index=f.index,this.predefinedThemes=f.predefinedThemes,this.optionsName=f.optionsName,this.stockChart=f.stockChart,this.panel=o,this.isOptionsInArray=f.isOptionsInArray),this.theme=Et(y.theme)||Et(this.predefinedThemes[y.theme])?"light1":y.theme,xt.base.constructor.call(this,"Chart",this.optionsName,y,this.index,this.parent);var c=this;this._containerId=o,this._objectsInitialized=!1,this.overlaidCanvasCtx=this.ctx=null,this._indexLabels=[],this._panTimerId=0,this._lastTouchEventType="",this._lastTouchData=null,this.isAnimating=!1,this.renderCount=0,this.disableToolTip=this.animatedRender=!1,this.canvasPool=new oe,this.allDOMEventHandlers=[],this.panEnabled=!1,this._defaultCursor="default",this.plotArea={canvas:null,ctx:null,x1:0,y1:0,x2:0,y2:0,width:0,height:0},this._dataInRenderedOrder=[],(this.container="string"==typeof this._containerId?document.getElementById(this._containerId):this._containerId)?(this.container.innerHTML="",y=o=0,y=this.options.height?this.height:0<this.container.clientHeight?this.container.clientHeight:this.height,this.width=o=this.options.width?this.width:0<this.container.clientWidth?this.container.clientWidth:this.width,this.height=y,this.x1=this.y1=0,this.x2=this.width,this.y2=this.height,this.selectedColorSet=typeof We[this.colorSet]<"u"?We[this.colorSet]:We.colorSet1,this._canvasJSContainer=document.createElement("div"),this._canvasJSContainer.setAttribute("class","canvasjs-chart-container"),this._canvasJSContainer.style.position="relative",this._canvasJSContainer.style.textAlign="left",this._canvasJSContainer.style.cursor="auto",this._canvasJSContainer.style.direction="ltr",rt||(this._canvasJSContainer.style.height="0px"),this.container.appendChild(this._canvasJSContainer),this.canvas=zi(o,y),this._preRenderCanvas=zi(o,y),this.canvas.style.position="absolute",this.canvas.style.WebkitUserSelect="none",this.canvas.style.MozUserSelect="none",this.canvas.style.msUserSelect="none",this.canvas.style.userSelect="none",this.canvas.getContext&&(this._canvasJSContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.textBaseline="top",ks(this.ctx),this._preRenderCtx=this._preRenderCanvas.getContext("2d"),this._preRenderCtx.textBaseline="top",ks(this._preRenderCtx),rt?this.plotArea.ctx=this.ctx:(this.plotArea.canvas=zi(o,y),this.plotArea.canvas.style.position="absolute",this.plotArea.canvas.setAttribute("class","plotAreaCanvas"),this._canvasJSContainer.appendChild(this.plotArea.canvas),this.plotArea.ctx=this.plotArea.canvas.getContext("2d")),this.overlaidCanvas=zi(o,y),this.overlaidCanvas.style.position="absolute",this.overlaidCanvas.style.webkitTapHighlightColor="transparent",this.overlaidCanvas.style.WebkitUserSelect="none",this.overlaidCanvas.style.MozUserSelect="none",this.overlaidCanvas.style.msUserSelect="none",this.overlaidCanvas.style.userSelect="none",this.overlaidCanvas.getContext&&(this._canvasJSContainer.appendChild(this.overlaidCanvas),this.overlaidCanvasCtx=this.overlaidCanvas.getContext("2d"),this.overlaidCanvasCtx.textBaseline="top",ks(this.overlaidCanvasCtx)),this._eventManager=new u(this),this.windowResizeHandler=Li(window,"resize",function(){c._updateSize()&&c.render()},this.allDOMEventHandlers),this._toolBar=document.createElement("div"),this._toolBar.setAttribute("class","canvasjs-chart-toolbar"),un(this._toolBar,{position:"absolute",right:"1px",top:"1px"}),this._canvasJSContainer.appendChild(this._toolBar),this.bounds={x1:0,y1:0,x2:this.width,y2:this.height},Li(this.overlaidCanvas,"click",function(d){c._mouseEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mousemove",function(d){c._mouseEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mouseup",function(d){c._mouseEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mousedown",function(d){c._mouseEventHandler(d),As(c._dropdownMenu)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mouseout",function(d){c._mouseEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(d){c._touchEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerMove":"touchmove",function(d){c._touchEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerUp":"touchend",function(d){c._touchEventHandler(d)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerCancel":"touchcancel",function(d){c._touchEventHandler(d)},this.allDOMEventHandlers),this.toolTip=new ie(this,this.options.toolTip),this.data=null,this.axisX=[],this.axisX2=[],this.axisY=[],this.axisY2=[],this.sessionVariables={axisX:[],axisX2:[],axisY:[],axisY2:[]})):window.console&&window.console.log('CanvasJS Error: Chart Container with id "'+this._containerId+'" was not found')}function Pt(o,y){for(var c,f=[],d=0;d<o.length;d++)if(0==d)f.push(o[0]);else{var M,k,C;M=0==(C=d-1)?0:C-1,k=C===o.length-1?C:C+1,c=Math.abs((o[k].x-o[M].x)/(o[k].x-o[C].x==0?.01:o[k].x-o[C].x))*(y-1)/2+1;var R=(o[k].x-o[M].x)/c;c=(o[k].y-o[M].y)/c,f[f.length]=o[C].x>o[M].x&&0<R||o[C].x<o[M].x&&0>R?{x:o[C].x+R/3,y:o[C].y+c/3}:{x:o[C].x,y:o[C].y+c/9},M=0===(C=d)?0:C-1,k=C===o.length-1?C:C+1,c=Math.abs((o[k].x-o[M].x)/(o[C].x-o[M].x==0?.01:o[C].x-o[M].x))*(y-1)/2+1,R=(o[k].x-o[M].x)/c,c=(o[k].y-o[M].y)/c,f[f.length]=o[C].x>o[M].x&&0<R||o[C].x<o[M].x&&0>R?{x:o[C].x-R/3,y:o[C].y-c/3}:{x:o[C].x,y:o[C].y-c/9},f[f.length]=o[d]}return f}function yt(o,y,f,c,d,M,k,C,R,B){var O=0;B?(k.color=M,C.color=M):B=1,O=Math.abs(R?d-f:c-y),O=0<k.trimLength?Math.abs(O*k.trimLength/100):Math.abs(O-k.length),R?(f+=O/2,d-=O/2):(y+=O/2,c-=O/2),O=Math.round(k.thickness)%2==1?.5:0;var L=Math.round(C.thickness)%2==1?.5:0;o.save(),o.globalAlpha=B,o.strokeStyle=C.color||M,o.lineWidth=C.thickness||2,o.setLineDash&&o.setLineDash(Ti(C.dashType,C.thickness)),o.beginPath(),R&&0<C.thickness?(o.moveTo(c-k.thickness/2,Math.round((f+d)/2)-L),o.lineTo(y+k.thickness/2,Math.round((f+d)/2)-L)):0<C.thickness&&(o.moveTo(Math.round((y+c)/2)-L,f+k.thickness/2),o.lineTo(Math.round((y+c)/2)-L,d-k.thickness/2)),o.stroke(),o.strokeStyle=k.color||M,o.lineWidth=k.thickness||2,o.setLineDash&&o.setLineDash(Ti(k.dashType,k.thickness)),o.beginPath(),R&&0<k.thickness?(o.moveTo(c-O,f),o.lineTo(c-O,d),o.moveTo(y+O,f),o.lineTo(y+O,d)):0<k.thickness&&(o.moveTo(y,f+O),o.lineTo(c,f+O),o.moveTo(y,d-O),o.lineTo(c,d-O)),o.stroke(),o.restore()}function ct(o,y){ct.base.constructor.call(this,"Legend","legend",y,null,o),this.chart=o,this.canvas=o.canvas,this.ctx=this.chart.ctx,this.ghostCtx=this.chart._eventManager.ghostCtx,this.items=[],this.optionsName="legend",this.height=this.width=0,this.orientation=null,this.dataSeries=[],this.bounds={x1:null,y1:null,x2:null,y2:null},typeof this.options.fontSize>"u"&&(this.fontSize=this.chart.getAutoFontSize(this.fontSize)),this.lineHeight=tn(this.fontFamily,this.fontSize,this.fontWeight),this.horizontalSpacing=this.fontSize}function pt(o,y,f,c){for(pt.base.constructor.call(this,"DataSeries","data",y,f,o),this.chart=o,this.canvas=o.canvas,this._ctx=o.canvas.ctx,this.index=f,this.noDataPointsInPlotArea=0,this.id=c,this.chart._eventManager.objectMap[c]={id:c,objectType:"dataSeries",dataSeriesIndex:f},o=y.dataPoints?y.dataPoints.length:0,this.dataPointEOs=[],y=0;y<o;y++)this.dataPointEOs[y]={};this.dataPointIds=[],this.plotUnit=[],this.axisY=this.axisX=null,this.optionsName="data",this.isOptionsInArray=!0,null===this.fillOpacity&&(this.fillOpacity=this.type.match(/area/i)?.7:1),this.axisPlacement=this.getDefaultAxisPlacement(),typeof this.options.indexLabelFontSize>"u"&&(this.indexLabelFontSize=this.chart.getAutoFontSize(this.indexLabelFontSize))}function wt(o,y,f,c,d,M){if(wt.base.constructor.call(this,"Axis",y,f,c,o),this.chart=o,this.canvas=o.canvas,this.ctx=o.ctx,this.intervalStartPosition=this.maxHeight=this.maxWidth=0,this.labels=[],this.dataSeries=[],this._stripLineLabels=this._ticks=this._labels=null,this.dataInfo={min:1/0,max:-1/0,viewPortMin:1/0,viewPortMax:-1/0,minDiff:1/0},this.isOptionsInArray=!0,"axisX"===d?("left"===M||"bottom"===M?(this.optionsName="axisX",Et(this.chart.sessionVariables.axisX[c])&&(this.chart.sessionVariables.axisX[c]={}),this.sessionVariables=this.chart.sessionVariables.axisX[c]):(this.optionsName="axisX2",Et(this.chart.sessionVariables.axisX2[c])&&(this.chart.sessionVariables.axisX2[c]={}),this.sessionVariables=this.chart.sessionVariables.axisX2[c]),this.options.interval||(this.intervalType=null)):"left"===M||"bottom"===M?(this.optionsName="axisY",Et(this.chart.sessionVariables.axisY[c])&&(this.chart.sessionVariables.axisY[c]={}),this.sessionVariables=this.chart.sessionVariables.axisY[c]):(this.optionsName="axisY2",Et(this.chart.sessionVariables.axisY2[c])&&(this.chart.sessionVariables.axisY2[c]={}),this.sessionVariables=this.chart.sessionVariables.axisY2[c]),typeof this.options.titleFontSize>"u"&&(this.titleFontSize=this.chart.getAutoFontSize(this.titleFontSize)),typeof this.options.labelFontSize>"u"&&(this.labelFontSize=this.chart.getAutoFontSize(this.labelFontSize)),this.type=d,"axisX"!==d||f&&typeof f.gridThickness<"u"||(this.gridThickness=0),this._position=M,this.lineCoordinates={x1:null,y1:null,x2:null,y2:null,width:null},this.labelAngle=(this.labelAngle%360+360)%360,90<this.labelAngle&&270>this.labelAngle?this.labelAngle-=180:270<=this.labelAngle&&360>=this.labelAngle&&(this.labelAngle-=360),this.options.scaleBreaks&&(this.scaleBreaks=new It(this.chart,this.options.scaleBreaks,++this.chart._eventManager.lastObjectId,this)),this.stripLines=[],this.options.stripLines&&0<this.options.stripLines.length)for(o=0;o<this.options.stripLines.length;o++)this.stripLines.push(new re(this.chart,this.options.stripLines[o],o,++this.chart._eventManager.lastObjectId,this));this.options.crosshair&&(this.crosshair=new te(this.chart,this.options.crosshair,this)),this._titleTextBlock=null,this.hasOptionChanged("viewportMinimum")&&null===this.viewportMinimum&&(this.options.viewportMinimum=void 0,this.sessionVariables.viewportMinimum=null),this.hasOptionChanged("viewportMinimum")||isNaN(this.sessionVariables.newViewportMinimum)||null===this.sessionVariables.newViewportMinimum?this.sessionVariables.newViewportMinimum=null:this.viewportMinimum=this.sessionVariables.newViewportMinimum,this.hasOptionChanged("viewportMaximum")&&null===this.viewportMaximum&&(this.options.viewportMaximum=void 0,this.sessionVariables.viewportMaximum=null),this.hasOptionChanged("viewportMaximum")||isNaN(this.sessionVariables.newViewportMaximum)||null===this.sessionVariables.newViewportMaximum?this.sessionVariables.newViewportMaximum=null:this.viewportMaximum=this.sessionVariables.newViewportMaximum,null!==this.minimum&&null!==this.viewportMinimum&&(this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum)),null!==this.maximum&&null!==this.viewportMaximum&&(this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum)),this.trackChanges("viewportMinimum"),this.trackChanges("viewportMaximum")}function It(o,y,f,c){if(It.base.constructor.call(this,"ScaleBreaks","scaleBreaks",y,null,c),this.id=f,this.chart=o,this.ctx=this.chart.ctx,this.axis=c,this.optionsName="scaleBreaks",this.isOptionsInArray=!1,this._appliedBreaks=[],this.customBreaks=[],this.autoBreaks=[],"string"==typeof this.spacing?(this.spacing=parseFloat(this.spacing),this.spacing=isNaN(this.spacing)?8:(10<this.spacing?10:this.spacing)+"%"):"number"!=typeof this.spacing&&(this.spacing=8),this.autoCalculate&&(this.maxNumberOfAutoBreaks=Math.min(this.maxNumberOfAutoBreaks,5)),this.options.customBreaks&&0<this.options.customBreaks.length){for(o=0;o<this.options.customBreaks.length;o++)this.customBreaks.push(new Gt(this.chart,"customBreaks",this.options.customBreaks[o],o,++this.chart._eventManager.lastObjectId,this)),"number"==typeof this.customBreaks[o].startValue&&"number"==typeof this.customBreaks[o].endValue&&this.customBreaks[o].endValue!==this.customBreaks[o].startValue&&this._appliedBreaks.push(this.customBreaks[o]);for(this._appliedBreaks.sort(function(d,M){return d.startValue-M.startValue}),o=0;o<this._appliedBreaks.length-1;o++)this._appliedBreaks[o].endValue>=this._appliedBreaks[o+1].startValue&&(this._appliedBreaks[o].endValue=Math.max(this._appliedBreaks[o].endValue,this._appliedBreaks[o+1].endValue),window.console&&window.console.log("CanvasJS Error: Breaks "+o+" and "+(o+1)+" are overlapping."),this._appliedBreaks.splice(o,2),o--)}}function Gt(o,y,f,c,d,M){Gt.base.constructor.call(this,"Break",y,f,c,M),this.id=d,this.chart=o,this.ctx=this.chart.ctx,this.scaleBreaks=M,this.optionsName=y,this.isOptionsInArray=!0,this.type=f.type?this.type:M.type,this.fillOpacity=Et(f.fillOpacity)?M.fillOpacity:this.fillOpacity,this.lineThickness=Et(f.lineThickness)?M.lineThickness:this.lineThickness,this.color=f.color?this.color:M.color,this.lineColor=f.lineColor?this.lineColor:M.lineColor,this.lineDashType=f.lineDashType?this.lineDashType:M.lineDashType,!Et(this.startValue)&&this.startValue.getTime&&(this.startValue=this.startValue.getTime()),!Et(this.endValue)&&this.endValue.getTime&&(this.endValue=this.endValue.getTime()),"number"==typeof this.startValue&&"number"==typeof this.endValue&&this.endValue<this.startValue&&(o=this.startValue,this.startValue=this.endValue,this.endValue=o),this.spacing=typeof f.spacing>"u"?M.spacing:f.spacing,"string"==typeof this.options.spacing?(this.spacing=parseFloat(this.spacing),this.spacing=isNaN(this.spacing)?0:(10<this.spacing?10:this.spacing)+"%"):"number"!=typeof this.options.spacing&&(this.spacing=M.spacing),this.size=M.parent.logarithmic?1:0}function re(o,y,f,c,d){re.base.constructor.call(this,"StripLine","stripLines",y,f,d),this.id=c,this.chart=o,this.ctx=this.chart.ctx,this.label=this.label,this.axis=d,this.optionsName="stripLines",this.isOptionsInArray=!0,this._thicknessType="pixel",null!==this.startValue&&null!==this.endValue&&(this.value=d.logarithmic?Math.sqrt((this.startValue.getTime?this.startValue.getTime():this.startValue)*(this.endValue.getTime?this.endValue.getTime():this.endValue)):((this.startValue.getTime?this.startValue.getTime():this.startValue)+(this.endValue.getTime?this.endValue.getTime():this.endValue))/2,this._thicknessType=null)}function te(o,y,f){te.base.constructor.call(this,"Crosshair","crosshair",y,null,f),this.chart=o,this.ctx=this.chart.ctx,this.axis=f,this.optionsName="crosshair",this._thicknessType="pixel"}function ie(o,y){ie.base.constructor.call(this,"ToolTip","toolTip",y,null,o),this.chart=o,this.canvas=o.canvas,this.ctx=this.chart.ctx,this.currentDataPointIndex=this.currentSeriesIndex=-1,this._prevY=this._prevX=NaN,this.containerTransitionDuration=.1,this.mozContainerTransition=this.getContainerTransition(this.containerTransitionDuration),this.optionsName="toolTip",this._initialize()}function u(o){this.chart=o,this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.previousDataPointEventObject=null,this.ghostCanvas=zi(this.chart.width,this.chart.height),this.ghostCtx=this.ghostCanvas.getContext("2d"),this.mouseoveredObjectMaps=[]}function I(o){this.chart=o,this.ctx=this.chart.plotArea.ctx,this.animations=[],this.animationRequestId=null}On(xt,fn),xt.prototype.destroy=function(){var o=this.allDOMEventHandlers;this._animator&&this._animator.cancelAllAnimations(),this._panTimerId&&clearTimeout(this._panTimerId);for(var y=0;y<o.length;y++)xi(o[y][0],o[y][1],o[y][2],o[y][3]);for(this.allDOMEventHandlers=[],this.removeAllEventListeners();this._canvasJSContainer&&this._canvasJSContainer.hasChildNodes();)this._canvasJSContainer.removeChild(this._canvasJSContainer.lastChild);for(;this.container&&this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);for(;this._dropdownMenu&&this._dropdownMenu.hasChildNodes();)this._dropdownMenu.removeChild(this._dropdownMenu.lastChild);this.container=this._canvasJSContainer=null,this.toolTip.container=null,this.canvas&&$s(this.canvas),this.overlaidCanvas&&$s(this.overlaidCanvas),this._preRenderCanvas&&$s(this._preRenderCanvas),this._breaksCanvas&&$s(this._breaksCanvas),this._eventManager&&this._eventManager.ghostCanvas&&$s(this._eventManager.ghostCanvas),this._toolBar=this._dropdownMenu=this._menuButton=this._resetButton=this._zoomButton=null},xt.prototype._updateOptions=function(){var o=this;if(this.updateOption("width"),this.updateOption("height"),this.updateOption("dataPointWidth"),this.updateOption("dataPointMinWidth"),this.updateOption("dataPointMaxWidth"),this.updateOption("interactivityEnabled"),this.updateOption("theme"),this.updateOption("colorSet")&&(this.selectedColorSet=typeof We[this.colorSet]<"u"?We[this.colorSet]:We.colorSet1),this.updateOption("backgroundColor"),this.backgroundColor||(this.backgroundColor="rgba(0,0,0,0)"),this.updateOption("culture"),this._cultureInfo=new Ls(this.options.culture),this.updateOption("animationEnabled"),this.animationEnabled=this.animationEnabled&&rt,this.updateOption("animationDuration"),this.updateOption("rangeChanging"),this.updateOption("rangeChanged"),this.updateOption("exportEnabled"),this.updateOption("exportFileName"),this.updateOption("zoomType"),this.toolbar=new ao(this,this.options.toolbar),this.options.zoomEnabled||this.panEnabled){if(this._zoomButton)un(this._zoomButton,{borderRight:this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,backgroundColor:o.toolbar.itemBackgroundColor,color:o.toolbar.fontColor}),this._zoomButton.title=this._cultureInfo.zoomText;else{var y=!1;As(this._zoomButton=document.createElement("button")),js(this,this._zoomButton,"pan"),this._zoomButton.title=this._cultureInfo.panText,this._toolBar.appendChild(this._zoomButton),this._zoomButton.style.borderRight=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,Li(this._zoomButton,"touchstart",function(c){y=!0},this.allDOMEventHandlers),Li(this._zoomButton,"click",function(){o.zoomEnabled?(o.zoomEnabled=!1,o.panEnabled=!0,js(o,o._zoomButton,"zoom")):(o.zoomEnabled=!0,o.panEnabled=!1,js(o,o._zoomButton,"pan")),o.render()},this.allDOMEventHandlers),Li(this._zoomButton,"mousemove",function(){y?y=!1:(un(o._zoomButton,{backgroundColor:o.toolbar.itemBackgroundColorOnHover,color:o.toolbar.fontColorOnHover,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&un(o._zoomButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},this.allDOMEventHandlers),Li(this._zoomButton,"mouseout",function(){y||(un(o._zoomButton,{backgroundColor:o.toolbar.itemBackgroundColor,color:o.toolbar.fontColor,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&un(o._zoomButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},this.allDOMEventHandlers)}this._resetButton?(un(this._resetButton,{borderRight:this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,backgroundColor:o.toolbar.itemBackgroundColor,color:o.toolbar.fontColor}),this._resetButton.title=this._cultureInfo.resetText):(y=!1,As(this._resetButton=document.createElement("button")),js(this,this._resetButton,"reset"),this._resetButton.style.borderRight=(this.exportEnabled?this.toolbar.buttonBorderThickness:0)+"px solid "+this.toolbar.buttonBorderColor,this._toolBar.appendChild(this._resetButton),Li(this._resetButton,"touchstart",function(c){y=!0},this.allDOMEventHandlers),Li(this._resetButton,"click",function(){if(o.toolTip.hide(),o.toolTip&&o.toolTip.enabled&&o.toolTip.dispatchEvent("hidden",{chart:o,toolTip:o.toolTip},o.toolTip),o.zoomEnabled||o.panEnabled?(o.zoomEnabled=!0,o.panEnabled=!1,js(o,o._zoomButton,"pan"),o._defaultCursor="default",o.overlaidCanvas.style.cursor=o._defaultCursor):(o.zoomEnabled=!1,o.panEnabled=!1),o.sessionVariables.axisX)for(var c=0;c<o.sessionVariables.axisX.length;c++)o.sessionVariables.axisX[c].newViewportMinimum=null,o.sessionVariables.axisX[c].newViewportMaximum=null;if(o.sessionVariables.axisX2)for(c=0;c<o.sessionVariables.axisX2.length;c++)o.sessionVariables.axisX2[c].newViewportMinimum=null,o.sessionVariables.axisX2[c].newViewportMaximum=null;if(o.sessionVariables.axisY)for(c=0;c<o.sessionVariables.axisY.length;c++)o.sessionVariables.axisY[c].newViewportMinimum=null,o.sessionVariables.axisY[c].newViewportMaximum=null;if(o.sessionVariables.axisY2)for(c=0;c<o.sessionVariables.axisY2.length;c++)o.sessionVariables.axisY2[c].newViewportMinimum=null,o.sessionVariables.axisY2[c].newViewportMaximum=null;o.resetOverlayedCanvas(),0>=navigator.userAgent.search("MSIE")&&un(o._resetButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}),As(o._zoomButton,o._resetButton),o.stockChart&&(o.stockChart._rangeEventParameter={stockChart:o.stockChart,source:"chart",index:o.stockChart.charts.indexOf(o),minimum:null,maximum:null}),o._dispatchRangeEvent("rangeChanging","reset"),o.stockChart&&(o.stockChart._rangeEventParameter.type="rangeChanging",o.stockChart.dispatchEvent("rangeChanging",o.stockChart._rangeEventParameter,o.stockChart)),o.render(),o.syncCharts&&o.syncCharts(null,null),o._dispatchRangeEvent("rangeChanged","reset"),o.stockChart&&(o.stockChart._rangeEventParameter.type="rangeChanged",o.stockChart.dispatchEvent("rangeChanged",o.stockChart._rangeEventParameter,o.stockChart))},this.allDOMEventHandlers),Li(this._resetButton,"mousemove",function(){y||(un(o._resetButton,{backgroundColor:o.toolbar.itemBackgroundColorOnHover,color:o.toolbar.fontColorOnHover,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&un(o._resetButton.childNodes[0],{WebkitFilter:"invert(100%)",filter:"invert(100%)"}))},this.allDOMEventHandlers),Li(this._resetButton,"mouseout",function(){y||(un(o._resetButton,{backgroundColor:o.toolbar.itemBackgroundColor,color:o.toolbar.fontColor,transition:"0.4s",WebkitTransition:"0.4s"}),0>=navigator.userAgent.search("MSIE")&&un(o._resetButton.childNodes[0],{WebkitFilter:"invert(0%)",filter:"invert(0%)"}))},this.allDOMEventHandlers),this.overlaidCanvas.style.cursor=o._defaultCursor),this.zoomEnabled||this.panEnabled||(this._zoomButton?(o._zoomButton.getAttribute("state")===o._cultureInfo.zoomText?(this.panEnabled=!0,this.zoomEnabled=!1):(this.zoomEnabled=!0,this.panEnabled=!1),Wi(o._zoomButton,o._resetButton)):(this.zoomEnabled=!0,this.panEnabled=!1))}else this.panEnabled=this.zoomEnabled=!1;for(var f in ro(this),"none"!==this._toolBar.style.display&&this._zoomButton&&(js(o,o._zoomButton,this.panEnabled?"zoom":"pan"),o._resetButton.getAttribute("state")!==o._cultureInfo.resetText&&js(o,o._resetButton,"reset")),this.options.toolTip&&this.toolTip.options!==this.options.toolTip&&(this.toolTip.options=this.options.toolTip),this.toolTip.options)this.toolTip.options.hasOwnProperty(f)&&this.toolTip.updateOption(f)},xt.prototype._updateSize=function(){return La.call(this,[this.canvas,this.overlaidCanvas,this._eventManager.ghostCanvas])},xt.prototype._initialize=function(){this.isNavigator=!(Et(this.parent)||Et(this.parent._defaultsKey)||"Navigator"!==this.parent._defaultsKey),this._animator?this._animator.cancelAllAnimations():this._animator=new I(this),this.removeAllEventListeners(),this.disableToolTip=!1,this._axes=[],this.funnelPyramidClickHandler=this.pieDoughnutClickHandler=null,this._updateOptions(),this.animatedRender=rt&&this.animationEnabled&&0===this.renderCount,this._updateSize(),this.clearCanvas(),this.ctx.beginPath(),this.axisX=[],this.axisX2=[],this.axisY=[],this.axisY2=[],this._indexLabels=[],this._dataInRenderedOrder=[],this._events=[],this._eventManager&&this._eventManager.reset(),this.plotInfo={axisPlacement:null,plotTypes:[]},this.layoutManager=new ln(0,0,this.width,this.height,this.isNavigator?0:2),this.plotArea.layoutManager&&this.plotArea.layoutManager.reset(),this.data=[],this.title=null,this.subtitles=[];var o=0,y=null;if(this.options.data){for(var f=0;f<this.options.data.length;f++)if(o++,!this.options.data[f].type||0<=xt._supportedChartTypes.indexOf(this.options.data[f].type)){var c=new pt(this,this.options.data[f],o-1,++this._eventManager.lastObjectId);"error"===c.type&&(c.linkedDataSeriesIndex=Et(this.options.data[f].linkedDataSeriesIndex)?f-1:this.options.data[f].linkedDataSeriesIndex,0>c.linkedDataSeriesIndex||c.linkedDataSeriesIndex>=this.options.data.length||"number"!=typeof c.linkedDataSeriesIndex||"error"===this.options.data[c.linkedDataSeriesIndex].type)&&(c.linkedDataSeriesIndex=null),null===c.name&&(c.name="DataSeries "+o),null===c.color?1<this.options.data.length?(c._colorSet=[this.selectedColorSet[c.index%this.selectedColorSet.length]],c.color=this.selectedColorSet[c.index%this.selectedColorSet.length]):c._colorSet="line"===c.type||"stepLine"===c.type||"spline"===c.type||"area"===c.type||"stepArea"===c.type||"splineArea"===c.type||"stackedArea"===c.type||"stackedArea100"===c.type||"rangeArea"===c.type||"rangeSplineArea"===c.type||"candlestick"===c.type||"ohlc"===c.type||"waterfall"===c.type||"boxAndWhisker"===c.type?[this.selectedColorSet[0]]:this.selectedColorSet:c._colorSet=[c.color],null===c.markerSize&&(("line"===c.type||"stepLine"===c.type||"spline"===c.type||0<=c.type.toLowerCase().indexOf("area"))&&c.dataPoints&&c.dataPoints.length<this.width/16||"scatter"===c.type)&&(c.markerSize=8),"bubble"!==c.type&&"scatter"!==c.type||!c.dataPoints||(c.dataPoints.some?c.dataPoints.some(function(C){return C.x})&&c.dataPoints.sort(Q):c.dataPoints.sort(Q)),this.data.push(c);var M,d=c.axisPlacement;if(y=y||d,"normal"===d?"xySwapped"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with bar chart':"none"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with pie chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="normal"):"xySwapped"===d?"normal"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with line, area, column or pie chart':"none"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with pie chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="xySwapped"):"none"===d?"normal"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with line, area, column or bar chart':"xySwapped"===this.plotInfo.axisPlacement?M='You cannot combine "'+c.type+'" with bar chart':null===this.plotInfo.axisPlacement&&(this.plotInfo.axisPlacement="none"):null===d&&"none"===this.plotInfo.axisPlacement&&(M='You cannot combine "'+c.type+'" with pie chart'),M&&window.console)return void window.console.log(M)}for(f=0;f<this.data.length;f++){if("none"==y&&"error"===this.data[f].type&&window.console)return void window.console.log('You cannot combine "'+c.type+'" with error chart');"error"===this.data[f].type&&(this.data[f].axisPlacement=this.plotInfo.axisPlacement=y||"normal",this.data[f]._linkedSeries=null===this.data[f].linkedDataSeriesIndex?null:this.data[this.data[f].linkedDataSeriesIndex])}}this._objectsInitialized=!0,this._plotAreaElements=[]},xt._supportedChartTypes=fo("line stepLine spline column area stepArea splineArea bar bubble scatter stackedColumn stackedColumn100 stackedBar stackedBar100 stackedArea stackedArea100 candlestick ohlc boxAndWhisker rangeColumn error rangeBar rangeArea rangeSplineArea pie doughnut funnel pyramid waterfall".split(" ")),xt.prototype.setLayout=function(){for(var o=this._plotAreaElements,y=0;y<this.data.length;y++)if("normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement){if(!this.data[y].axisYType||"primary"===this.data[y].axisYType)if(this.options.axisY&&0<this.options.axisY.length){if(!this.axisY.length)for(var f=0;f<this.options.axisY.length;f++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY[f]=new wt(this,"axisY",this.options.axisY[f],f,"axisY","left")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY[f]=new wt(this,"axisY",this.options.axisY[f],f,"axisY","bottom"));this.data[y].axisY=this.axisY[0<=this.data[y].axisYIndex&&this.data[y].axisYIndex<this.axisY.length?this.data[y].axisYIndex:0],this.axisY[0<=this.data[y].axisYIndex&&this.data[y].axisYIndex<this.axisY.length?this.data[y].axisYIndex:0].dataSeries.push(this.data[y])}else this.axisY.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY[0]=new wt(this,"axisY",this.options.axisY,0,"axisY","left")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY[0]=new wt(this,"axisY",this.options.axisY,0,"axisY","bottom"))),this.data[y].axisY=this.axisY[0],this.axisY[0].dataSeries.push(this.data[y]);if("secondary"===this.data[y].axisYType)if(this.options.axisY2&&0<this.options.axisY2.length){if(!this.axisY2.length)for(f=0;f<this.options.axisY2.length;f++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY2[f]=new wt(this,"axisY2",this.options.axisY2[f],f,"axisY","right")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY2[f]=new wt(this,"axisY2",this.options.axisY2[f],f,"axisY","top"));this.data[y].axisY=this.axisY2[0<=this.data[y].axisYIndex&&this.data[y].axisYIndex<this.axisY2.length?this.data[y].axisYIndex:0],this.axisY2[0<=this.data[y].axisYIndex&&this.data[y].axisYIndex<this.axisY2.length?this.data[y].axisYIndex:0].dataSeries.push(this.data[y])}else this.axisY2.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisY2[0]=new wt(this,"axisY2",this.options.axisY2,0,"axisY","right")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisY2[0]=new wt(this,"axisY2",this.options.axisY2,0,"axisY","top"))),this.data[y].axisY=this.axisY2[0],this.axisY2[0].dataSeries.push(this.data[y]);if(!this.data[y].axisXType||"primary"===this.data[y].axisXType)if(this.options.axisX&&0<this.options.axisX.length){if(!this.axisX.length)for(f=0;f<this.options.axisX.length;f++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX[f]=new wt(this,"axisX",this.options.axisX[f],f,"axisX","bottom")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX[f]=new wt(this,"axisX",this.options.axisX[f],f,"axisX","left"));this.data[y].axisX=this.axisX[0<=this.data[y].axisXIndex&&this.data[y].axisXIndex<this.axisX.length?this.data[y].axisXIndex:0],this.axisX[0<=this.data[y].axisXIndex&&this.data[y].axisXIndex<this.axisX.length?this.data[y].axisXIndex:0].dataSeries.push(this.data[y])}else this.axisX.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX[0]=new wt(this,"axisX",this.options.axisX,0,"axisX","bottom")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX[0]=new wt(this,"axisX",this.options.axisX,0,"axisX","left"))),this.data[y].axisX=this.axisX[0],this.axisX[0].dataSeries.push(this.data[y]);if("secondary"===this.data[y].axisXType)if(this.options.axisX2&&0<this.options.axisX2.length){if(!this.axisX2.length)for(f=0;f<this.options.axisX2.length;f++)"normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX2[f]=new wt(this,"axisX2",this.options.axisX2[f],f,"axisX","top")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX2[f]=new wt(this,"axisX2",this.options.axisX2[f],f,"axisX","right"));this.data[y].axisX=this.axisX2[0<=this.data[y].axisXIndex&&this.data[y].axisXIndex<this.axisX2.length?this.data[y].axisXIndex:0],this.axisX2[0<=this.data[y].axisXIndex&&this.data[y].axisXIndex<this.axisX2.length?this.data[y].axisXIndex:0].dataSeries.push(this.data[y])}else this.axisX2.length||("normal"===this.plotInfo.axisPlacement?this._axes.push(this.axisX2[0]=new wt(this,"axisX2",this.options.axisX2,0,"axisX","top")):"xySwapped"===this.plotInfo.axisPlacement&&this._axes.push(this.axisX2[0]=new wt(this,"axisX2",this.options.axisX2,0,"axisX","right"))),this.data[y].axisX=this.axisX2[0],this.axisX2[0].dataSeries.push(this.data[y])}if(this.axisY){for(f=1;f<this.axisY.length;f++)typeof this.axisY[f].options.gridThickness>"u"&&(this.axisY[f].gridThickness=0);for(f=0;f<this.axisY.length-1;f++)typeof this.axisY[f].options.margin>"u"&&(this.axisY[f].margin=10)}if(this.axisY2){for(f=1;f<this.axisY2.length;f++)typeof this.axisY2[f].options.gridThickness>"u"&&(this.axisY2[f].gridThickness=0);for(f=0;f<this.axisY2.length-1;f++)typeof this.axisY2[f].options.margin>"u"&&(this.axisY2[f].margin=10)}if(this.axisY&&0<this.axisY.length&&this.axisY2&&0<this.axisY2.length&&(0<this.axisY[0].gridThickness&&typeof this.axisY2[0].options.gridThickness>"u"?this.axisY2[0].gridThickness=0:0<this.axisY2[0].gridThickness&&typeof this.axisY[0].options.gridThickness>"u"&&(this.axisY[0].gridThickness=0)),this.axisX)for(f=0;f<this.axisX.length;f++)typeof this.axisX[f].options.gridThickness>"u"&&(this.axisX[f].gridThickness=0);if(this.axisX2)for(f=0;f<this.axisX2.length;f++)typeof this.axisX2[f].options.gridThickness>"u"&&(this.axisX2[f].gridThickness=0);if(this.axisX&&0<this.axisX.length&&this.axisX2&&0<this.axisX2.length&&(0<this.axisX[0].gridThickness&&typeof this.axisX2[0].options.gridThickness>"u"?this.axisX2[0].gridThickness=0:0<this.axisX2[0].gridThickness&&typeof this.axisX[0].options.gridThickness>"u"&&(this.axisX[0].gridThickness=0)),f=!1,0<this._axes.length&&this.options.zoomEnabled&&(this.zoomEnabled||this.panEnabled))for(y=0;y<this._axes.length;y++)if(!Et(this._axes[y].viewportMinimum)||!Et(this._axes[y].viewportMaximum)){f=!0;break}if(f?(Wi(this._zoomButton,this._resetButton),this._toolBar.style.border=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,this._zoomButton.style.borderRight=this.toolbar.buttonBorderThickness+"px solid "+this.toolbar.buttonBorderColor,this._resetButton.style.borderRight=(this.exportEnabled?this.toolbar.buttonBorderThickness:0)+"px solid "+this.toolbar.buttonBorderColor):(As(this._zoomButton,this._resetButton),this._toolBar.style.border=this.toolbar.buttonBorderThickness+"px solid transparent",this.options.zoomEnabled&&(this.zoomEnabled=!0,this.panEnabled=!1)),function Yo(Q){at.fSDec&&Q[Vs("`eeDwdouMhrudods")](Vs("e`u`@ohl`uhnoHuds`uhnoDoe"),function(){at._fTWm&&at._fTWm(Q)})}(this),this._processData(),this.options.title&&(this.title=new Ys(this,this.options.title),this.title.dockInsidePlotArea?o.push(this.title):this.title.setLayout()),this.options.subtitles)for(y=0;y<this.options.subtitles.length;y++)f=new Mn(this,this.options.subtitles[y],y),this.subtitles.push(f),f.dockInsidePlotArea?o.push(f):f.setLayout();for(this.legend=new ct(this,this.options.legend),y=0;y<this.data.length;y++)(this.data[y].showInLegend||"pie"===this.data[y].type||"doughnut"===this.data[y].type||"funnel"===this.data[y].type||"pyramid"===this.data[y].type)&&this.legend.dataSeries.push(this.data[y]);for(this.legend.dockInsidePlotArea?o.push(this.legend):this.legend.setLayout(),y=0;y<this._axes.length;y++)if(this._axes[y].scaleBreaks&&this._axes[y].scaleBreaks._appliedBreaks.length){rt?(this._breaksCanvas=zi(this.width,this.height),this._breaksCanvasCtx=this._breaksCanvas.getContext("2d")):(this._breaksCanvas=this.canvas,this._breaksCanvasCtx=this.ctx);break}this._preRenderCanvas=zi(this.width,this.height),this._preRenderCtx=this._preRenderCanvas.getContext("2d"),"normal"!==this.plotInfo.axisPlacement&&"xySwapped"!==this.plotInfo.axisPlacement||wt.setLayout(this.axisX,this.axisX2,this.axisY,this.axisY2,this.plotInfo.axisPlacement,this.layoutManager.getFreeSpace())},xt.prototype.renderElements=function(){var c=this._plotAreaElements;this.title&&!this.title.dockInsidePlotArea&&this.title.render();for(var o=0;o<this.subtitles.length;o++)this.subtitles[o].dockInsidePlotArea||this.subtitles[o].render();if(this.legend.dockInsidePlotArea||this.legend.render(),"normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement)wt.render(this.axisX,this.axisX2,this.axisY,this.axisY2,this.plotInfo.axisPlacement);else{if("none"!==this.plotInfo.axisPlacement)return;this.preparePlotArea()}for(o=0;o<c.length;o++)c[o].setLayout(),c[o].render();var d,y=[];if(this.animatedRender){var f=zi(this.width,this.height);f.getContext("2d").drawImage(this.canvas,0,0,this.width,this.height)}for(function $n(Q){if(!Ct){var xt=!1,Pt=!1;typeof Yt.Chart.creditHref>"u"?(Q.creditHref=Vs("iuuqr;..b`ow`rkr/bnl."),Q.creditText=Vs("B`ow`rKR/bnl")):(xt=Q.updateOption("creditText"),Pt=Q.updateOption("creditHref")),Q.creditHref&&Q.creditText&&(Q._creditLink||(Q._creditLink=document.createElement("a"),Q._creditLink.setAttribute("class","canvasjs-chart-credit"),Q._creditLink.setAttribute("title","JavaScript Charts"),un(Q._creditLink,{outline:"none",margin:"0px",position:"absolute",right:"2px",top:Q.height-14+"px",color:"dimgrey",textDecoration:"none",fontSize:"11px",fontFamily:"Calibri, Lucida Grande, Lucida Sans Unicode, Arial, sans-serif"}),Q._creditLink.setAttribute("tabIndex",-1),Q._creditLink.setAttribute("target","_blank")),(0===Q.renderCount||xt||Pt)&&(Q._creditLink.setAttribute("href",Q.creditHref),Q._creditLink.innerHTML=Q.creditText),Q._creditLink&&Q.creditHref&&Q.creditText?(Q._creditLink.parentElement||Q._canvasJSContainer.appendChild(Q._creditLink),Q._creditLink.style.top=Q.height-14+"px"):Q._creditLink.parentElement&&Q._canvasJSContainer.removeChild(Q._creditLink))}}(this),c=this.ctx.miterLimit,this.ctx.miterLimit=3,rt&&this._breaksCanvas&&(this._preRenderCtx.drawImage(this.canvas,0,0,this.width,this.height),this._preRenderCtx.drawImage(this._breaksCanvas,0,0,this.width,this.height),this._breaksCanvasCtx.globalCompositeOperation="source-atop",this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),this._preRenderCtx.clearRect(0,0,this.width,this.height)),o=0;o<this.plotInfo.plotTypes.length;o++)for(var M=this.plotInfo.plotTypes[o],k=0;k<M.plotUnits.length;k++){var C=M.plotUnits[k],R=null;C.targetCanvas&&$s(C.targetCanvas),C.targetCanvas=null,this.animatedRender&&(C.targetCanvas=zi(this.width,this.height),C.targetCanvasCtx=C.targetCanvas.getContext("2d"),d=C.targetCanvasCtx.miterLimit,C.targetCanvasCtx.miterLimit=3),"line"===C.type?R=this.renderLine(C):"stepLine"===C.type?R=this.renderStepLine(C):"spline"===C.type?R=this.renderSpline(C):"column"===C.type?R=this.renderColumn(C):"bar"===C.type?R=this.renderBar(C):"area"===C.type?R=this.renderArea(C):"stepArea"===C.type?R=this.renderStepArea(C):"splineArea"===C.type?R=this.renderSplineArea(C):"stackedColumn"===C.type?R=this.renderStackedColumn(C):"stackedColumn100"===C.type?R=this.renderStackedColumn100(C):"stackedBar"===C.type?R=this.renderStackedBar(C):"stackedBar100"===C.type?R=this.renderStackedBar100(C):"stackedArea"===C.type?R=this.renderStackedArea(C):"stackedArea100"===C.type?R=this.renderStackedArea100(C):"bubble"===C.type?R=R=this.renderBubble(C):"scatter"===C.type?R=this.renderScatter(C):"pie"===C.type||"doughnut"===C.type?this.renderPie(C):"funnel"===C.type||"pyramid"===C.type?R=this.renderFunnel(C):"candlestick"===C.type||"ohlc"===C.type?R=this.renderCandlestick(C):"rangeColumn"===C.type?R=this.renderRangeColumn(C):"error"===C.type?R=this.renderError(C):"rangeBar"===C.type?R=this.renderRangeBar(C):"rangeArea"===C.type?R=this.renderRangeArea(C):"rangeSplineArea"===C.type?R=this.renderRangeSplineArea(C):"waterfall"===C.type?R=this.renderWaterfall(C):"boxAndWhisker"===C.type&&(R=this.renderBoxAndWhisker(C));for(var B=0;B<C.dataSeriesIndexes.length;B++)this._dataInRenderedOrder.push(this.data[C.dataSeriesIndexes[B]]);this.animatedRender&&(C.targetCanvasCtx.miterLimit=d,R&&y.push(R))}this.ctx.miterLimit=c,this.animatedRender&&this._breaksCanvasCtx&&y.push({source:this._breaksCanvasCtx,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0,startTimePercent:.7}),this.animatedRender&&0<this._indexLabels.length&&(d=zi(this.width,this.height).getContext("2d"),y.push(this.renderIndexLabels(d)));var O=this;if(0<y.length)O.disableToolTip=!0,O._animator.animate(200,O.animationDuration,function(L){O.ctx.clearRect(0,0,O.width,O.height),O.ctx.drawImage(f,0,0,Math.floor(O.width*Js),Math.floor(O.height*Js),0,0,O.width,O.height);for(var X=0;X<y.length;X++)R=y[X],1>L&&typeof R.startTimePercent<"u"?L>=R.startTimePercent&&R.animationCallback(R.easingFunction(L-R.startTimePercent,0,1,1-R.startTimePercent),R):R.animationCallback(R.easingFunction(L,0,1,1),R);O.dispatchEvent("dataAnimationIterationEnd",{chart:O})},function(){y=[];for(var L=0;L<O.plotInfo.plotTypes.length;L++)for(var X=O.plotInfo.plotTypes[L],E=0;E<X.plotUnits.length;E++){var Y=X.plotUnits[E];Y.targetCanvas&&$s(Y.targetCanvas),Y.targetCanvas=null}f=null,O.disableToolTip=!1,O.dispatchEvent("dataAnimationEnd",{chart:O})});else{if(O._breaksCanvas)if(rt)O.plotArea.ctx.drawImage(O._breaksCanvas,0,0,this.width,this.height);else for(B=0;B<O._axes.length;B++)O._axes[B].createMask();0<O._indexLabels.length&&O.renderIndexLabels(),O.dispatchEvent("dataAnimationIterationEnd",{chart:O}),O.dispatchEvent("dataAnimationEnd",{chart:O})}for(this.attachPlotAreaEventHandlers(),this.zoomEnabled||this.panEnabled||!this._zoomButton||"none"===this._zoomButton.style.display||As(this._zoomButton,this._resetButton),this.toolTip._updateToolTip(),this.renderCount++,Ze&&(O=this,setTimeout(function(){var L=document.getElementById("ghostCanvasCopy");L&&(cn(L,O.width,O.height),L.getContext("2d").drawImage(O._eventManager.ghostCanvas,0,0))},2e3)),this._breaksCanvas&&(delete this._breaksCanvas,delete this._breaksCanvasCtx),B=0;B<this._axes.length;B++)this._axes[B].maskCanvas&&(delete this._axes[B].maskCanvas,delete this._axes[B].maskCtx)},xt.prototype.render=function(o){o&&(this.options=o),this._initialize(),this.setLayout(),this.renderElements(),this._preRenderCanvas&&$s(this._preRenderCanvas)},xt.prototype.attachPlotAreaEventHandlers=function(){this.attachEvent({context:this,chart:this,mousedown:this._plotAreaMouseDown,mouseup:this._plotAreaMouseUp,mousemove:this._plotAreaMouseMove,cursor:this.panEnabled?"move":"default",capture:!0,bounds:this.plotArea})},xt.prototype.categoriseDataSeries=function(){for(var o="",y=0;y<this.data.length;y++)if((o=this.data[y]).dataPoints&&0!==o.dataPoints.length&&o.visible&&0<=xt._supportedChartTypes.indexOf(o.type)){for(var f=null,c=!1,d=null,M=!1,k=0;k<this.plotInfo.plotTypes.length;k++)if(this.plotInfo.plotTypes[k].type===o.type){c=!0,f=this.plotInfo.plotTypes[k];break}for(c||this.plotInfo.plotTypes.push(f={type:o.type,totalDataSeries:0,plotUnits:[]}),k=0;k<f.plotUnits.length;k++)if(f.plotUnits[k].axisYType===o.axisYType&&f.plotUnits[k].axisXType===o.axisXType&&f.plotUnits[k].axisYIndex===o.axisYIndex&&f.plotUnits[k].axisXIndex===o.axisXIndex){M=!0,d=f.plotUnits[k];break}M||f.plotUnits.push(d={type:o.type,previousDataSeriesCount:0,index:f.plotUnits.length,plotType:f,axisXType:o.axisXType,axisYType:o.axisYType,axisYIndex:o.axisYIndex,axisXIndex:o.axisXIndex,axisY:"primary"===o.axisYType?this.axisY[0<=o.axisYIndex&&o.axisYIndex<this.axisY.length?o.axisYIndex:0]:this.axisY2[0<=o.axisYIndex&&o.axisYIndex<this.axisY2.length?o.axisYIndex:0],axisX:"primary"===o.axisXType?this.axisX[0<=o.axisXIndex&&o.axisXIndex<this.axisX.length?o.axisXIndex:0]:this.axisX2[0<=o.axisXIndex&&o.axisXIndex<this.axisX2.length?o.axisXIndex:0],dataSeriesIndexes:[],yTotals:[],yAbsTotals:[]}),f.totalDataSeries++,d.dataSeriesIndexes.push(y),o.plotUnit=d}for(y=0;y<this.plotInfo.plotTypes.length;y++)for(f=this.plotInfo.plotTypes[y],k=o=0;k<f.plotUnits.length;k++)f.plotUnits[k].previousDataSeriesCount=o,o+=f.plotUnits[k].dataSeriesIndexes.length},xt.prototype.assignIdToDataPoints=function(){for(var o=0;o<this.data.length;o++){var y=this.data[o];if(y.dataPoints)for(var f=y.dataPoints.length,c=0;c<f;c++)y.dataPointIds[c]=++this._eventManager.lastObjectId}},xt.prototype._processData=function(){this.assignIdToDataPoints(),this.categoriseDataSeries();for(var o=0;o<this.plotInfo.plotTypes.length;o++)for(var y=this.plotInfo.plotTypes[o],f=0;f<y.plotUnits.length;f++){var c=y.plotUnits[f];"line"===c.type||"stepLine"===c.type||"spline"===c.type||"column"===c.type||"area"===c.type||"stepArea"===c.type||"splineArea"===c.type||"bar"===c.type||"bubble"===c.type||"scatter"===c.type?this._processMultiseriesPlotUnit(c):"stackedColumn"===c.type||"stackedBar"===c.type||"stackedArea"===c.type?this._processStackedPlotUnit(c):"stackedColumn100"===c.type||"stackedBar100"===c.type||"stackedArea100"===c.type?this._processStacked100PlotUnit(c):"candlestick"===c.type||"ohlc"===c.type||"rangeColumn"===c.type||"rangeBar"===c.type||"rangeArea"===c.type||"rangeSplineArea"===c.type||"error"===c.type||"boxAndWhisker"===c.type?this._processMultiYPlotUnit(c):"waterfall"===c.type&&this._processSpecificPlotUnit(c)}this.calculateAutoBreaks()},xt.prototype._processMultiseriesPlotUnit=function(o){if(o.dataSeriesIndexes&&!(1>o.dataSeriesIndexes.length))for(var c,d,y=o.axisY.dataInfo,f=o.axisX.dataInfo,M=!1,k=0;k<o.dataSeriesIndexes.length;k++){var L,C=this.data[o.dataSeriesIndexes[k]],R=0,B=!1,O=!1;if("normal"===C.axisPlacement||"xySwapped"===C.axisPlacement)var X=o.axisX.sessionVariables.newViewportMinimum?o.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:o.axisX.logarithmic?0:-1/0,E=o.axisX.sessionVariables.newViewportMaximum?o.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((C.dataPoints[R].x&&C.dataPoints[R].x.getTime||"dateTime"===C.xValueType)&&(M=!0),R=0;R<C.dataPoints.length;R++){if(typeof C.dataPoints[R].x>"u"&&(C.dataPoints[R].x=R+(o.axisX.logarithmic?1:0)),C.dataPoints[R].x.getTime?(M=!0,c=C.dataPoints[R].x.getTime()):c=C.dataPoints[R].x,d=C.dataPoints[R].y,c<f.min&&(f.min=c),c>f.max&&(f.max=c),d<y.min&&"number"==typeof d&&(y.min=d),d>y.max&&"number"==typeof d&&(y.max=d),0<R){if(o.axisX.logarithmic){var Y=c/C.dataPoints[R-1].x;1>Y&&(Y=1/Y),f.minDiff>Y&&1!==Y&&(f.minDiff=Y)}else 0>(Y=c-C.dataPoints[R-1].x)&&(Y*=-1),f.minDiff>Y&&0!==Y&&(f.minDiff=Y);null!==d&&null!==C.dataPoints[R-1].y&&(o.axisY.logarithmic?(1>(Y=d/C.dataPoints[R-1].y)&&(Y=1/Y),y.minDiff>Y&&1!==Y&&(y.minDiff=Y)):(0>(Y=d-C.dataPoints[R-1].y)&&(Y*=-1),y.minDiff>Y&&0!==Y&&(y.minDiff=Y)))}if(c<X&&!B)null!==d&&(L=c);else{if(!B&&(B=!0,0<R)){R-=2;continue}if(c>E&&!O)O=!0;else if(c>E&&O)continue;C.dataPoints[R].label&&(o.axisX.labels[c]=C.dataPoints[R].label),c<f.viewPortMin&&(f.viewPortMin=c),c>f.viewPortMax&&(f.viewPortMax=c),null===d?f.viewPortMin===c&&L<c&&(f.viewPortMin=L):(d<y.viewPortMin&&"number"==typeof d&&(y.viewPortMin=d),d>y.viewPortMax&&"number"==typeof d&&(y.viewPortMax=d))}}C.axisX.valueType=C.xValueType=M?"dateTime":"number"}},xt.prototype._processStackedPlotUnit=function(o){if(o.dataSeriesIndexes&&!(1>o.dataSeriesIndexes.length)){for(var c,d,y=o.axisY.dataInfo,f=o.axisX.dataInfo,M=!1,k=[],C=[],R=1/0,B=-1/0,O=0;O<o.dataSeriesIndexes.length;O++){var it,L=this.data[o.dataSeriesIndexes[O]],X=0,E=!1,Y=!1;if("normal"===L.axisPlacement||"xySwapped"===L.axisPlacement)var J=o.axisX.sessionVariables.newViewportMinimum?o.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:-1/0,q=o.axisX.sessionVariables.newViewportMaximum?o.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((L.dataPoints[X].x&&L.dataPoints[X].x.getTime||"dateTime"===L.xValueType)&&(M=!0),X=0;X<L.dataPoints.length;X++){if(typeof L.dataPoints[X].x>"u"&&(L.dataPoints[X].x=X+(o.axisX.logarithmic?1:0)),L.dataPoints[X].x.getTime?(M=!0,c=L.dataPoints[X].x.getTime()):c=L.dataPoints[X].x,d=Et(L.dataPoints[X].y)?0:L.dataPoints[X].y,c<f.min&&(f.min=c),c>f.max&&(f.max=c),0<X){if(o.axisX.logarithmic){var nt=c/L.dataPoints[X-1].x;1>nt&&(nt=1/nt),f.minDiff>nt&&1!==nt&&(f.minDiff=nt)}else 0>(nt=c-L.dataPoints[X-1].x)&&(nt*=-1),f.minDiff>nt&&0!==nt&&(f.minDiff=nt);null!==d&&null!==L.dataPoints[X-1].y&&(o.axisY.logarithmic?0<d&&(1>(nt=d/L.dataPoints[X-1].y)&&(nt=1/nt),y.minDiff>nt&&1!==nt&&(y.minDiff=nt)):(0>(nt=d-L.dataPoints[X-1].y)&&(nt*=-1),y.minDiff>nt&&0!==nt&&(y.minDiff=nt)))}if(c<J&&!E)null!==L.dataPoints[X].y&&(it=c);else{if(!E&&(E=!0,0<X)){X-=2;continue}if(c>q&&!Y)Y=!0;else if(c>q&&Y)continue;L.dataPoints[X].label&&(o.axisX.labels[c]=L.dataPoints[X].label),c<f.viewPortMin&&(f.viewPortMin=c),c>f.viewPortMax&&(f.viewPortMax=c),null===L.dataPoints[X].y?f.viewPortMin===c&&it<c&&(f.viewPortMin=it):(o.yTotals[c]=(o.yTotals[c]?o.yTotals[c]:0)+d,o.yAbsTotals[c]=(o.yAbsTotals[c]?o.yAbsTotals[c]:0)+Math.abs(d),0<=d?k[c]?k[c]+=d:(k[c]=d,R=Math.min(d,R)):C[c]?C[c]+=d:(C[c]=d,B=Math.max(d,B)))}}o.axisY.scaleBreaks&&o.axisY.scaleBreaks.autoCalculate&&1<=o.axisY.scaleBreaks.maxNumberOfAutoBreaks&&(y.dataPointYPositiveSums?(y.dataPointYPositiveSums.push.apply(y.dataPointYPositiveSums,k),y.dataPointYNegativeSums.push.apply(y.dataPointYPositiveSums,C)):(y.dataPointYPositiveSums=k,y.dataPointYNegativeSums=C)),L.axisX.valueType=L.xValueType=M?"dateTime":"number"}for(X in k)k.hasOwnProperty(X)&&!isNaN(X)&&((o=k[X])<y.min&&(y.min=Math.min(o,R)),o>y.max&&(y.max=o),X<f.viewPortMin||X>f.viewPortMax||(o<y.viewPortMin&&(y.viewPortMin=Math.min(o,R)),o>y.viewPortMax&&(y.viewPortMax=o)));for(X in C)C.hasOwnProperty(X)&&!isNaN(X)&&((o=C[X])<y.min&&(y.min=o),o>y.max&&(y.max=Math.max(o,B)),X<f.viewPortMin||X>f.viewPortMax||(o<y.viewPortMin&&(y.viewPortMin=o),o>y.viewPortMax&&(y.viewPortMax=Math.max(o,B))))}},xt.prototype._processStacked100PlotUnit=function(o){if(o.dataSeriesIndexes&&!(1>o.dataSeriesIndexes.length)){for(var c,d,y=o.axisY.dataInfo,f=o.axisX.dataInfo,M=!1,k=!1,C=!1,R=[],B=0;B<o.dataSeriesIndexes.length;B++){var Y,O=this.data[o.dataSeriesIndexes[B]],L=0,X=!1,E=!1;if("normal"===O.axisPlacement||"xySwapped"===O.axisPlacement)var it=o.axisX.sessionVariables.newViewportMinimum?o.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:-1/0,J=o.axisX.sessionVariables.newViewportMaximum?o.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((O.dataPoints[L].x&&O.dataPoints[L].x.getTime||"dateTime"===O.xValueType)&&(M=!0),L=0;L<O.dataPoints.length;L++){if(typeof O.dataPoints[L].x>"u"&&(O.dataPoints[L].x=L+(o.axisX.logarithmic?1:0)),O.dataPoints[L].x.getTime?(M=!0,c=O.dataPoints[L].x.getTime()):c=O.dataPoints[L].x,d=Et(O.dataPoints[L].y)?null:O.dataPoints[L].y,c<f.min&&(f.min=c),c>f.max&&(f.max=c),0<L){if(o.axisX.logarithmic){var q=c/O.dataPoints[L-1].x;1>q&&(q=1/q),f.minDiff>q&&1!==q&&(f.minDiff=q)}else 0>(q=c-O.dataPoints[L-1].x)&&(q*=-1),f.minDiff>q&&0!==q&&(f.minDiff=q);Et(d)||null===O.dataPoints[L-1].y||(o.axisY.logarithmic?0<d&&(1>(q=d/O.dataPoints[L-1].y)&&(q=1/q),y.minDiff>q&&1!==q&&(y.minDiff=q)):(0>(q=d-O.dataPoints[L-1].y)&&(q*=-1),y.minDiff>q&&0!==q&&(y.minDiff=q)))}if(c<it&&!X)null!==d&&(Y=c);else{if(!X&&(X=!0,0<L)){L-=2;continue}if(c>J&&!E)E=!0;else if(c>J&&E)continue;O.dataPoints[L].label&&(o.axisX.labels[c]=O.dataPoints[L].label),c<f.viewPortMin&&(f.viewPortMin=c),c>f.viewPortMax&&(f.viewPortMax=c),null===d?f.viewPortMin===c&&Y<c&&(f.viewPortMin=Y):(o.yTotals[c]=(o.yTotals[c]?o.yTotals[c]:0)+d,o.yAbsTotals[c]=(o.yAbsTotals[c]?o.yAbsTotals[c]:0)+Math.abs(d),0<=d?k=!0:0>d&&(C=!0),R[c]=R[c]?R[c]+Math.abs(d):Math.abs(d))}}O.axisX.valueType=O.xValueType=M?"dateTime":"number"}o.axisY.logarithmic?(y.max=Et(y.viewPortMax)?99*Math.pow(o.axisY.logarithmBase,-.05):Math.max(y.viewPortMax,99*Math.pow(o.axisY.logarithmBase,-.05)),y.min=Et(y.viewPortMin)?1:Math.min(y.viewPortMin,1)):k&&!C?(y.max=Et(y.viewPortMax)?99:Math.max(y.viewPortMax,99),y.min=Et(y.viewPortMin)?1:Math.min(y.viewPortMin,1)):k&&C?(y.max=Et(y.viewPortMax)?99:Math.max(y.viewPortMax,99),y.min=Et(y.viewPortMin)?-99:Math.min(y.viewPortMin,-99)):!k&&C&&(y.max=Et(y.viewPortMax)?-1:Math.max(y.viewPortMax,-1),y.min=Et(y.viewPortMin)?-99:Math.min(y.viewPortMin,-99)),y.viewPortMin=y.min,y.viewPortMax=y.max,o.dataPointYSums=R}},xt.prototype._processMultiYPlotUnit=function(o){if(o.dataSeriesIndexes&&!(1>o.dataSeriesIndexes.length))for(var c,d,M,k,y=o.axisY.dataInfo,f=o.axisX.dataInfo,C=!1,R=0;R<o.dataSeriesIndexes.length;R++){var E,Y,it,B=this.data[o.dataSeriesIndexes[R]],O=0,L=!1,X=!1;if("normal"===B.axisPlacement||"xySwapped"===B.axisPlacement)var J=o.axisX.sessionVariables.newViewportMinimum?o.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:o.axisX.logarithmic?0:-1/0,q=o.axisX.sessionVariables.newViewportMaximum?o.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((B.dataPoints[O].x&&B.dataPoints[O].x.getTime||"dateTime"===B.xValueType)&&(C=!0),O=0;O<B.dataPoints.length;O++){if(typeof B.dataPoints[O].x>"u"&&(B.dataPoints[O].x=O+(o.axisX.logarithmic?1:0)),B.dataPoints[O].x.getTime?(C=!0,c=B.dataPoints[O].x.getTime()):c=B.dataPoints[O].x,(d=B.dataPoints[O].y)&&d.length){M=Math.min.apply(null,d),k=Math.max.apply(null,d),Y=!0;for(var nt=0;nt<d.length;nt++)null===d.k&&(Y=!1);Y&&(L||(it=E),E=c)}if(c<f.min&&(f.min=c),c>f.max&&(f.max=c),M<y.min&&(y.min=M),k>y.max&&(y.max=k),0<O&&(o.axisX.logarithmic?(1>(Y=c/B.dataPoints[O-1].x)&&(Y=1/Y),f.minDiff>Y&&1!==Y&&(f.minDiff=Y)):(0>(Y=c-B.dataPoints[O-1].x)&&(Y*=-1),f.minDiff>Y&&0!==Y&&(f.minDiff=Y)),d&&null!==d[0]&&B.dataPoints[O-1].y&&null!==B.dataPoints[O-1].y[0]&&(o.axisY.logarithmic?(1>(Y=d[0]/B.dataPoints[O-1].y[0])&&(Y=1/Y),y.minDiff>Y&&1!==Y&&(y.minDiff=Y)):(0>(Y=d[0]-B.dataPoints[O-1].y[0])&&(Y*=-1),y.minDiff>Y&&0!==Y&&(y.minDiff=Y)))),!(c<J)||L){if(!L&&(L=!0,0<O)){O-=2,E=it;continue}if(c>q&&!X)X=!0;else if(c>q&&X)continue;if(B.dataPoints[O].label&&(o.axisX.labels[c]=B.dataPoints[O].label),c<f.viewPortMin&&(f.viewPortMin=c),c>f.viewPortMax&&(f.viewPortMax=c),f.viewPortMin===c&&d)for(nt=0;nt<d.length;nt++)if(null===d[nt]&&E<c){f.viewPortMin=E;break}null===d?f.viewPortMin===c&&E<c&&(f.viewPortMin=E):(M<y.viewPortMin&&(y.viewPortMin=M),k>y.viewPortMax&&(y.viewPortMax=k))}}B.axisX.valueType=B.xValueType=C?"dateTime":"number"}},xt.prototype._processSpecificPlotUnit=function(o){if("waterfall"===o.type&&o.dataSeriesIndexes&&!(1>o.dataSeriesIndexes.length))for(var c,d,y=o.axisY.dataInfo,f=o.axisX.dataInfo,M=!1,k=0;k<o.dataSeriesIndexes.length;k++){var C=this.data[o.dataSeriesIndexes[k]],R=0,B=!1,O=!1,L=c=0;if("normal"===C.axisPlacement||"xySwapped"===C.axisPlacement)var X=o.axisX.sessionVariables.newViewportMinimum?o.axisX.sessionVariables.newViewportMinimum:this.options.axisX&&this.options.axisX.viewportMinimum?this.options.axisX.viewportMinimum:this.options.axisX&&this.options.axisX.minimum?this.options.axisX.minimum:o.axisX.logarithmic?0:-1/0,E=o.axisX.sessionVariables.newViewportMaximum?o.axisX.sessionVariables.newViewportMaximum:this.options.axisX&&this.options.axisX.viewportMaximum?this.options.axisX.viewportMaximum:this.options.axisX&&this.options.axisX.maximum?this.options.axisX.maximum:1/0;for((C.dataPoints[R].x&&C.dataPoints[R].x.getTime||"dateTime"===C.xValueType)&&(M=!0),R=0;R<C.dataPoints.length;R++)typeof C.dataPoints[R].isCumulativeSum<"u"&&!0===C.dataPoints[R].isCumulativeSum?(C.dataPointEOs[R].cumulativeSumYStartValue=0,C.dataPointEOs[R].cumulativeSum=0===R?0:C.dataPointEOs[R-1].cumulativeSum,C.dataPoints[R].y=0===R?0:C.dataPointEOs[R-1].cumulativeSum):typeof C.dataPoints[R].isIntermediateSum<"u"&&!0===C.dataPoints[R].isIntermediateSum?(C.dataPointEOs[R].cumulativeSumYStartValue=L,C.dataPointEOs[R].cumulativeSum=0===R?0:C.dataPointEOs[R-1].cumulativeSum,C.dataPoints[R].y=0===R?0:c,L=0===R?0:C.dataPointEOs[R-1].cumulativeSum,c=0):(d="number"!=typeof C.dataPoints[R].y?0:C.dataPoints[R].y,C.dataPointEOs[R].cumulativeSumYStartValue=0===R?0:C.dataPointEOs[R-1].cumulativeSum,C.dataPointEOs[R].cumulativeSum=0===R?d:C.dataPointEOs[R-1].cumulativeSum+d,c+=d);for(R=0;R<C.dataPoints.length;R++)if(typeof C.dataPoints[R].x>"u"&&(C.dataPoints[R].x=R+(o.axisX.logarithmic?1:0)),C.dataPoints[R].x.getTime?(M=!0,c=C.dataPoints[R].x.getTime()):c=C.dataPoints[R].x,d=C.dataPoints[R].y,c<f.min&&(f.min=c),c>f.max&&(f.max=c),C.dataPointEOs[R].cumulativeSum<y.min&&(y.min=C.dataPointEOs[R].cumulativeSum),C.dataPointEOs[R].cumulativeSum>y.max&&(y.max=C.dataPointEOs[R].cumulativeSum),0<R&&(o.axisX.logarithmic?(1>(L=c/C.dataPoints[R-1].x)&&(L=1/L),f.minDiff>L&&1!==L&&(f.minDiff=L)):(0>(L=c-C.dataPoints[R-1].x)&&(L*=-1),f.minDiff>L&&0!==L&&(f.minDiff=L)),null!==d&&null!==C.dataPoints[R-1].y&&(o.axisY.logarithmic?(1>(d=C.dataPointEOs[R].cumulativeSum/C.dataPointEOs[R-1].cumulativeSum)&&(d=1/d),y.minDiff>d&&1!==d&&(y.minDiff=d)):(0>(d=C.dataPointEOs[R].cumulativeSum-C.dataPointEOs[R-1].cumulativeSum)&&(d*=-1),y.minDiff>d&&0!==d&&(y.minDiff=d)))),!(c<X)||B){if(!B&&(B=!0,0<R)){R-=2;continue}if(c>E&&!O)O=!0;else if(c>E&&O)continue;C.dataPoints[R].label&&(o.axisX.labels[c]=C.dataPoints[R].label),c<f.viewPortMin&&(f.viewPortMin=c),c>f.viewPortMax&&(f.viewPortMax=c),0<R&&(C.dataPointEOs[R-1].cumulativeSum<y.viewPortMin&&(y.viewPortMin=C.dataPointEOs[R-1].cumulativeSum),C.dataPointEOs[R-1].cumulativeSum>y.viewPortMax&&(y.viewPortMax=C.dataPointEOs[R-1].cumulativeSum)),C.dataPointEOs[R].cumulativeSum<y.viewPortMin&&(y.viewPortMin=C.dataPointEOs[R].cumulativeSum),C.dataPointEOs[R].cumulativeSum>y.viewPortMax&&(y.viewPortMax=C.dataPointEOs[R].cumulativeSum)}C.axisX.valueType=C.xValueType=M?"dateTime":"number"}},xt.prototype.calculateAutoBreaks=function(){function y(Y){if(Y.dataSeriesIndexes&&!(1>Y.dataSeriesIndexes.length)){var it=Y.axisX.scaleBreaks&&Y.axisX.scaleBreaks.autoCalculate&&1<=Y.axisX.scaleBreaks.maxNumberOfAutoBreaks,J=Y.axisY.scaleBreaks&&Y.axisY.scaleBreaks.autoCalculate&&1<=Y.axisY.scaleBreaks.maxNumberOfAutoBreaks;if(it||J)for(var q,ee,nt=(mt=Y.axisX.dataInfo).min,dt=mt.max,gt=(Tt=Y.axisY.dataInfo).min,kt=Tt.max,mt=mt._dataRanges,Tt=Tt._dataRanges,Ft=0,vt=0;vt<Y.dataSeriesIndexes.length;vt++){var le=d.data[Y.dataSeriesIndexes[vt]];if(!(4>le.dataPoints.length))for(Ft=0;Ft<le.dataPoints.length;Ft++)if(it&&(ee=(dt+1-nt)*Math.max(parseFloat(Y.axisX.scaleBreaks.collapsibleThreshold)||10,10)/100,(q=le.dataPoints[Ft].x.getTime?le.dataPoints[Ft].x.getTime():le.dataPoints[Ft].x)<mt[ee=Math.floor((q-nt)/ee)].min&&(mt[ee].min=q),q>mt[ee].max&&(mt[ee].max=q)),J){var Ht=(kt+1-gt)*Math.max(parseFloat(Y.axisY.scaleBreaks.collapsibleThreshold)||10,10)/100;if((q="waterfall"===Y.type?le.dataPointEOs[Ft].cumulativeSum:le.dataPoints[Ft].y)&&q.length)for(var jt=0;jt<q.length;jt++)ee=Math.floor((q[jt]-gt)/Ht),q[jt]<Tt[ee].min&&(Tt[ee].min=q[jt]),q[jt]>Tt[ee].max&&(Tt[ee].max=q[jt]);else Et(q)||(q<Tt[ee=Math.floor((q-gt)/Ht)].min&&(Tt[ee].min=q),q>Tt[ee].max&&(Tt[ee].max=q))}}}}function f(Y){if(Y.dataSeriesIndexes&&!(1>Y.dataSeriesIndexes.length)&&Y.axisX.scaleBreaks&&Y.axisX.scaleBreaks.autoCalculate&&1<=Y.axisX.scaleBreaks.maxNumberOfAutoBreaks)for(var dt,it=Y.axisX.dataInfo,J=it.min,q=it.max,nt=it._dataRanges,gt=0,kt=0;kt<Y.dataSeriesIndexes.length;kt++){var mt=d.data[Y.dataSeriesIndexes[kt]];if(!(4>mt.dataPoints.length))for(gt=0;gt<mt.dataPoints.length;gt++)dt=(q+1-J)*Math.max(parseFloat(Y.axisX.scaleBreaks.collapsibleThreshold)||10,10)/100,(it=mt.dataPoints[gt].x.getTime?mt.dataPoints[gt].x.getTime():mt.dataPoints[gt].x)<nt[dt=Math.floor((it-J)/dt)].min&&(nt[dt].min=it),it>nt[dt].max&&(nt[dt].max=it)}}for(var c,d=this,M=!1,k=0;k<this._axes.length;k++)if(this._axes[k].scaleBreaks&&this._axes[k].scaleBreaks.autoCalculate&&1<=this._axes[k].scaleBreaks.maxNumberOfAutoBreaks){M=!0,this._axes[k].dataInfo._dataRanges=[];for(var C=0;C<100/Math.max(parseFloat(this._axes[k].scaleBreaks.collapsibleThreshold)||10,10);C++)this._axes[k].dataInfo._dataRanges.push({min:1/0,max:-1/0})}if(M){for(k=0;k<this.plotInfo.plotTypes.length;k++)for(M=this.plotInfo.plotTypes[k],C=0;C<M.plotUnits.length;C++)"line"===(c=M.plotUnits[C]).type||"stepLine"===c.type||"spline"===c.type||"column"===c.type||"area"===c.type||"stepArea"===c.type||"splineArea"===c.type||"bar"===c.type||"bubble"===c.type||"scatter"===c.type||"candlestick"===c.type||"ohlc"===c.type||"rangeColumn"===c.type||"rangeBar"===c.type||"rangeArea"===c.type||"rangeSplineArea"===c.type||"waterfall"===c.type||"error"===c.type||"boxAndWhisker"===c.type?y(c):0<=c.type.indexOf("stacked")&&f(c);for(k=0;k<this._axes.length;k++)if(this._axes[k].dataInfo._dataRanges){var R=this._axes[k].dataInfo.min;c=(this._axes[k].dataInfo.max+1-R)*Math.max(parseFloat(this._axes[k].scaleBreaks.collapsibleThreshold)||10,10)/100;var O,L,B=this._axes[k].dataInfo._dataRanges;if(M=[],this._axes[k].dataInfo.dataPointYPositiveSums){var X=this._axes[k].dataInfo.dataPointYPositiveSums;for(C in O=B,X)if(X.hasOwnProperty(C)&&!isNaN(C)&&!Et(L=X[C])){var E=Math.floor((L-R)/c);L<O[E].min&&(O[E].min=L),L>O[E].max&&(O[E].max=L)}delete this._axes[k].dataInfo.dataPointYPositiveSums}if(this._axes[k].dataInfo.dataPointYNegativeSums){for(C in O=B,X=this._axes[k].dataInfo.dataPointYNegativeSums)X.hasOwnProperty(C)&&!isNaN(C)&&(Et(L=-1*X[C])||(L<O[E=Math.floor((L-R)/c)].min&&(O[E].min=L),L>O[E].max&&(O[E].max=L)));delete this._axes[k].dataInfo.dataPointYNegativeSums}for(C=0;C<B.length-1;C++)if(O=B[C].max,isFinite(O))for(;C<B.length-1;){if(R=B[C+1].min,isFinite(R)){(L=R-O)>c&&M.push({diff:L,start:O,end:R});break}C++}if(this._axes[k].scaleBreaks.customBreaks)for(C=0;C<this._axes[k].scaleBreaks.customBreaks.length;C++)for(c=0;c<M.length;c++)(this._axes[k].scaleBreaks.customBreaks[C].startValue<=M[c].start&&M[c].start<=this._axes[k].scaleBreaks.customBreaks[C].endValue||this._axes[k].scaleBreaks.customBreaks[C].startValue<=M[c].start&&M[c].start<=this._axes[k].scaleBreaks.customBreaks[C].endValue||M[c].start<=this._axes[k].scaleBreaks.customBreaks[C].startValue&&this._axes[k].scaleBreaks.customBreaks[C].startValue<=M[c].end||M[c].start<=this._axes[k].scaleBreaks.customBreaks[C].endValue&&this._axes[k].scaleBreaks.customBreaks[C].endValue<=M[c].end)&&(M.splice(c,1),c--);for(M.sort(function(it,J){return J.diff-it.diff}),C=0;C<Math.min(M.length,this._axes[k].scaleBreaks.maxNumberOfAutoBreaks);C++)Y=M[C].start,it=M[C].end,J=this._axes[k].logarithmic?this._axes[k].dataInfo.max/this._axes[k].dataInfo.min:this._axes[k].dataInfo.max-this._axes[k].dataInfo.min,c=this._axes[k].logarithmic?(1>=(J=Math.pow(Math.min(J*Y/it,it/Y),.2))&&(J=Math.pow(1>Y?1/Y:Math.min(it/Y,Y),.25)),{startValue:Y*J,endValue:it/J}):(0>=(J=.2*Math.min(J-it+Y,it-Y))&&(J=.25*Math.min(it-Y,Math.abs(Y))),{startValue:Y+J,endValue:it-J}),this._axes[k].scaleBreaks.autoBreaks.push(new Gt(this,"autoBreaks",c,C,++this._eventManager.lastObjectId,this._axes[k].scaleBreaks)),this._axes[k].scaleBreaks._appliedBreaks.push(this._axes[k].scaleBreaks.autoBreaks[this._axes[k].scaleBreaks.autoBreaks.length-1]);this._axes[k].scaleBreaks._appliedBreaks.sort(function(it,J){return it.startValue-J.startValue})}}var Y,it,J},xt.prototype.renderCrosshairs=function(o){for(var y=0;y<this.axisX.length;y++)this.axisX[y]!=o&&this.axisX[y].crosshair&&this.axisX[y].crosshair.enabled&&!this.axisX[y].crosshair._hidden&&this.axisX[y].showCrosshair(this.axisX[y].crosshair._updatedValue);for(y=0;y<this.axisX2.length;y++)this.axisX2[y]!=o&&this.axisX2[y].crosshair&&this.axisX2[y].crosshair.enabled&&!this.axisX2[y].crosshair._hidden&&this.axisX2[y].showCrosshair(this.axisX2[y].crosshair._updatedValue);for(y=0;y<this.axisY.length;y++)this.axisY[y]!=o&&this.axisY[y].crosshair&&this.axisY[y].crosshair.enabled&&!this.axisY[y].crosshair._hidden&&this.axisY[y].showCrosshair(this.axisY[y].crosshair._updatedValue);for(y=0;y<this.axisY2.length;y++)this.axisY2[y]!=o&&this.axisY2[y].crosshair&&this.axisY2[y].crosshair.enabled&&!this.axisY2[y].crosshair._hidden&&this.axisY2[y].showCrosshair(this.axisY2[y].crosshair._updatedValue)},xt.prototype.getDataPointAtXY=function(o,y,f){f=f||!1;for(var c=[],d=this._dataInRenderedOrder.length-1;0<=d;d--){var M;(M=this._dataInRenderedOrder[d].getDataPointAtXY(o,y,f))&&c.push(M)}for(o=null,y=!1,f=0;f<c.length;f++)if(("line"===c[f].dataSeries.type||"stepLine"===c[f].dataSeries.type||"area"===c[f].dataSeries.type||"stepArea"===c[f].dataSeries.type)&&(d=Xi("markerSize",c[f].dataPoint,c[f].dataSeries)||8,c[f].distance<=d/2)){y=!0;break}for(f=0;f<c.length;f++)y&&"line"!==c[f].dataSeries.type&&"stepLine"!==c[f].dataSeries.type&&"area"!==c[f].dataSeries.type&&"stepArea"!==c[f].dataSeries.type||(o?c[f].distance<=o.distance&&(o=c[f]):o=c[f]);return o},xt.prototype.getObjectAtXY=function(o,y,f){var c=null;if(f=this.getDataPointAtXY(o,y,f||!1))c=f.dataSeries.dataPointIds[f.dataPointIndex];else if(rt)c=yo(o,y,this._eventManager.ghostCtx);else for(f=0;f<this.legend.items.length;f++){var d=this.legend.items[f];o>=d.x1&&o<=d.x2&&y>=d.y1&&y<=d.y2&&(c=d.id)}return c},xt.prototype.getAutoFontSize=Zo,xt.prototype.resetOverlayedCanvas=function(){this.overlaidCanvasCtx.clearRect(0,0,this.width,this.height)},xt.prototype.clearCanvas=Ps,xt.prototype.attachEvent=function(o){this._events.push(o)},xt.prototype._touchEventHandler=function(o){if(o.changedTouches&&this.interactivityEnabled){var y=[],f=o.changedTouches,c=f?f[0]:o,d=null;switch(o.type){case"touchstart":case"MSPointerDown":y=["mousemove","mousedown"],this._lastTouchData=ls(c),this._lastTouchData.time=new Date;break;case"touchmove":case"MSPointerMove":y=["mousemove"];break;case"touchend":case"MSPointerUp":var M=this._lastTouchData&&this._lastTouchData.time?new Date-this._lastTouchData.time:0;y="touchstart"===this._lastTouchEventType||"MSPointerDown"===this._lastTouchEventType||300>M?["mouseup","click"]:["mouseup"];break;default:return}if(!(f&&1<f.length)){(d=ls(c)).time=new Date;try{var k=d.y-this._lastTouchData.y;M=d.time-this._lastTouchData.time,(1<Math.abs(k)&&this._lastTouchData.scroll||5<Math.abs(k)&&250>M)&&(this._lastTouchData.scroll=!0)}catch{}if(this._lastTouchEventType=o.type,this._lastTouchData.scroll&&this.zoomEnabled)this.isDrag&&this.resetOverlayedCanvas(),this.isDrag=!1;else for(f=0;f<y.length;f++)d=y[f],(k=document.createEvent("MouseEvent")).initMouseEvent(d,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),c.target.dispatchEvent(k),(!Et(this._lastTouchData.scroll)&&!this._lastTouchData.scroll||!this._lastTouchData.scroll&&250<M||"click"===d)&&(o.preventManipulation&&o.preventManipulation(),o.preventDefault&&o.cancelable&&o.preventDefault())}}},xt.prototype._dispatchRangeEvent=function(o,y){var f={chart:this};f.type=o,f.trigger=y;var c=[];this.axisX&&0<this.axisX.length&&c.push("axisX"),this.axisX2&&0<this.axisX2.length&&c.push("axisX2"),this.axisY&&0<this.axisY.length&&c.push("axisY"),this.axisY2&&0<this.axisY2.length&&c.push("axisY2");for(var d=0;d<c.length;d++)if(Et(f[c[d]])&&(f[c[d]]=[]),"axisY"===c[d])for(var M=0;M<this.axisY.length;M++)f[c[d]].push({viewportMinimum:this[c[d]][M].sessionVariables.newViewportMinimum,viewportMaximum:this[c[d]][M].sessionVariables.newViewportMaximum});else if("axisY2"===c[d])for(M=0;M<this.axisY2.length;M++)f[c[d]].push({viewportMinimum:this[c[d]][M].sessionVariables.newViewportMinimum,viewportMaximum:this[c[d]][M].sessionVariables.newViewportMaximum});else if("axisX"===c[d])for(M=0;M<this.axisX.length;M++)f[c[d]].push({viewportMinimum:this[c[d]][M].sessionVariables.newViewportMinimum,viewportMaximum:this[c[d]][M].sessionVariables.newViewportMaximum});else if("axisX2"===c[d])for(M=0;M<this.axisX2.length;M++)f[c[d]].push({viewportMinimum:this[c[d]][M].sessionVariables.newViewportMinimum,viewportMaximum:this[c[d]][M].sessionVariables.newViewportMaximum});this.dispatchEvent(o,f,this)},xt.prototype._mouseEventHandler=function(o){typeof o.target>"u"&&o.srcElement&&(o.target=o.srcElement);var c,d,y=ls(o),f=o.type;if(o.which?d=3==o.which:o.button&&(d=2==o.button),xt.capturedEventParam&&(c=xt.capturedEventParam,"mouseup"===f&&(xt.capturedEventParam=null,c.chart.overlaidCanvas.releaseCapture?c.chart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",c.chart._mouseEventHandler,!1)),c.hasOwnProperty(f)&&("mouseup"!==f||c.chart.overlaidCanvas.releaseCapture?o.target!==c.chart.overlaidCanvas&&rt||c[f].call(c.context,y.x,y.y):o.target!==c.chart.overlaidCanvas&&(c.chart.isDrag=!1))),this.interactivityEnabled)if(this._ignoreNextEvent)this._ignoreNextEvent=!1;else if(o.preventManipulation&&o.preventManipulation(),o.preventDefault&&o.preventDefault(),Ze&&window.console&&(window.console.log(f+" --\x3e x: "+y.x+"; y:"+y.y),d&&window.console.log(o.which),"mouseup"===f&&window.console.log("mouseup")),!d){if(!xt.capturedEventParam&&this._events){for(var M=0;M<this._events.length;M++)if(this._events[M].hasOwnProperty(f)){if(y.x>=(d=(c=this._events[M]).bounds).x1&&y.x<=d.x2&&y.y>=d.y1&&y.y<=d.y2){c[f].call(c.context,y.x,y.y),"mousedown"===f&&!0===c.capture?(xt.capturedEventParam=c,this.overlaidCanvas.setCapture?this.overlaidCanvas.setCapture():document.documentElement.addEventListener("mouseup",this._mouseEventHandler,!1)):"mouseup"===f&&(c.chart.overlaidCanvas.releaseCapture?c.chart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",this._mouseEventHandler,!1));break}c=null}o.target.style.cursor=c&&c.cursor?c.cursor:this._defaultCursor}if(y.x<(f=this.plotArea).x1||y.x>f.x2||y.y<f.y1||y.y>f.y2){for(this.toolTip&&this.toolTip.enabled?(this.toolTip.hide(),this.toolTip.dispatchEvent("hidden",{chart:this,toolTip:this.toolTip},this.toolTip)):this.resetOverlayedCanvas(),M=0;M<this.axisX.length;M++)this.axisX[M].crosshair&&this.axisX[M].crosshair.enabled&&(this.axisX[M].crosshair.hide(),this.axisX[M].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX[M].options},this.axisX[M].crosshair));for(M=0;M<this.axisX2.length;M++)this.axisX2[M].crosshair&&this.axisX2[M].crosshair.enabled&&(this.axisX2[M].crosshair.hide(),this.axisX2[M].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX2[M].options},this.axisX2[M].crosshair));for(M=0;M<this.axisY.length;M++)this.axisY[M].crosshair&&this.axisY[M].crosshair.enabled&&(this.axisY[M].crosshair.hide(),this.axisY[M].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY[M].options},this.axisY[M].crosshair));for(M=0;M<this.axisY2.length;M++)this.axisY2[M].crosshair&&this.axisY2[M].crosshair.enabled&&(this.axisY2[M].crosshair.hide(),this.axisY2[M].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY2[M].options},this.axisY2[M].crosshair))}this.isDrag&&this.zoomEnabled||!this._eventManager||this._eventManager.mouseEventHandler(o)}},xt.prototype._plotAreaMouseDown=function(o,y){this.isDrag=!0,this.dragStartPoint={x:o,y}},xt.prototype._plotAreaMouseUp=function(o,y){if(("normal"===this.plotInfo.axisPlacement||"xySwapped"===this.plotInfo.axisPlacement)&&this.isDrag){var f=y-this.dragStartPoint.y,c=o-this.dragStartPoint.x,C=0<=this.zoomType.indexOf("x"),k=0<=this.zoomType.indexOf("y"),d=!1;if(this.resetOverlayedCanvas(),"xySwapped"===this.plotInfo.axisPlacement){var M=k;k=C,C=M}if(this.panEnabled||this.zoomEnabled){if(this.panEnabled)for(C=k=0;C<this._axes.length;C++)(f=this._axes[C]).logarithmic?f.viewportMinimum<f.minimum?(f.sessionVariables.newViewportMinimum=f.viewportMinimum*(k=f.minimum/f.viewportMinimum),f.sessionVariables.newViewportMaximum=f.viewportMaximum*k,d=!0):f.viewportMaximum>f.maximum&&(f.sessionVariables.newViewportMinimum=f.viewportMinimum/(k=f.viewportMaximum/f.maximum),f.sessionVariables.newViewportMaximum=f.viewportMaximum/k,d=!0):f.viewportMinimum<f.minimum?(f.sessionVariables.newViewportMinimum=f.viewportMinimum+(k=f.minimum-f.viewportMinimum),f.sessionVariables.newViewportMaximum=f.viewportMaximum+k,d=!0):f.viewportMaximum>f.maximum&&(f.sessionVariables.newViewportMinimum=f.viewportMinimum-(k=f.viewportMaximum-f.maximum),f.sessionVariables.newViewportMaximum=f.viewportMaximum-k,d=!0);else if((!C||2<Math.abs(c))&&(!k||2<Math.abs(f))&&this.zoomEnabled){if(!this.dragStartPoint)return;f=C?this.dragStartPoint.x:this.plotArea.x1,c=k?this.dragStartPoint.y:this.plotArea.y1,C=C?o:this.plotArea.x2,k=k?y:this.plotArea.y2,2<Math.abs(f-C)&&2<Math.abs(c-k)&&this._zoomPanToSelectedRegion(f,c,C,k)&&(d=!0)}d&&(this._ignoreNextEvent=!0,this._dispatchRangeEvent("rangeChanging","zoom"),this.stockChart&&this.stockChart.navigator&&this.stockChart.navigator.enabled&&(this.stockChart._rangeEventParameter||(this.stockChart._rangeEventParameter={stockChart:this.stockChart,source:"chart",index:this.stockChart.charts.indexOf(this),minimum:this.stockChart.sessionVariables._axisXMin,maximum:this.stockChart.sessionVariables._axisXMax}),this.stockChart._rangeEventParameter.type="rangeChanging",this.stockChart.dispatchEvent("rangeChanging",this.stockChart._rangeEventParameter,this.stockChart)),this.render(),this._dispatchRangeEvent("rangeChanged","zoom"),this.stockChart&&this.stockChart.navigator&&this.stockChart.navigator.enabled&&(this.stockChart._rangeEventParameter.type="rangeChanged",this.stockChart.dispatchEvent("rangeChanged",this.stockChart._rangeEventParameter,this.stockChart)),d&&this.zoomEnabled&&"none"===this._zoomButton.style.display&&(Wi(this._zoomButton,this._resetButton),js(this,this._zoomButton,"pan"),js(this,this._resetButton,"reset")))}}if(this.isDrag=!1,"none"!==this.plotInfo.axisPlacement){if(this.resetOverlayedCanvas(),this.axisX&&0<this.axisX.length)for(d=0;d<this.axisX.length;d++)this.axisX[d].crosshair&&this.axisX[d].crosshair.enabled&&this.axisX[d].renderCrosshair(o,y);if(this.axisX2&&0<this.axisX2.length)for(d=0;d<this.axisX2.length;d++)this.axisX2[d].crosshair&&this.axisX2[d].crosshair.enabled&&this.axisX2[d].renderCrosshair(o,y);if(this.axisY&&0<this.axisY.length)for(d=0;d<this.axisY.length;d++)this.axisY[d].crosshair&&this.axisY[d].crosshair.enabled&&this.axisY[d].renderCrosshair(o,y);if(this.axisY2&&0<this.axisY2.length)for(d=0;d<this.axisY2.length;d++)this.axisY2[d].crosshair&&this.axisY2[d].crosshair.enabled&&this.axisY2[d].renderCrosshair(o,y);if(this.axisX&&0<this.axisX.length)for(d=0;d<this.axisX.length;d++)this.axisX[d].crosshair&&this.axisX[d].crosshair.enabled&&this.axisX[d].crosshair.renderLabel();if(this.axisX2&&0<this.axisX2.length)for(d=0;d<this.axisX2.length;d++)this.axisX2[d].crosshair&&this.axisX2[d].crosshair.enabled&&this.axisX2[d].crosshair.renderLabel();if(this.axisY&&0<this.axisY.length)for(d=0;d<this.axisY.length;d++)this.axisY[d].crosshair&&this.axisY[d].crosshair.enabled&&this.axisY[d].crosshair.renderLabel();if(this.axisY2&&0<this.axisY2.length)for(d=0;d<this.axisY2.length;d++)this.axisY2[d].crosshair&&this.axisY2[d].crosshair.enabled&&this.axisY2[d].crosshair.renderLabel()}},xt.prototype._plotAreaMouseMove=function(o,y){if(this.isDrag&&"none"!==this.plotInfo.axisPlacement){var f=0,c=0,d=f=null,M=(d=0<=this.zoomType.indexOf("x"),0<=this.zoomType.indexOf("y")),k=this;if("xySwapped"===this.plotInfo.axisPlacement&&(f=M,M=d,d=f),f=this.dragStartPoint.x-o,c=this.dragStartPoint.y-y,2<Math.abs(f)&&8>Math.abs(f)&&(this.panEnabled||this.zoomEnabled)){this.toolTip.hide(),this.toolTip&&this.toolTip.enabled&&this.toolTip.dispatchEvent("hidden",{chart:this,toolTip:this.toolTip},this.toolTip);for(var C=0;C<this.axisX.length;C++)this.axisX[C].crosshair&&this.axisX[C].crosshair.enabled&&(this.axisX[C].crosshair.hide(),this.axisX[C].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX[C].options},this.axisX[C].crosshair));for(C=0;C<this.axisX2.length;C++)this.axisX2[C].crosshair&&this.axisX2[C].crosshair.enabled&&(this.axisX2[C].crosshair.hide(),this.axisX2[C].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisX2[C].options},this.axisX2[C].crosshair));for(C=0;C<this.axisY.length;C++)this.axisY[C].crosshair&&this.axisY[C].crosshair.enabled&&(this.axisY[C].crosshair.hide(),this.axisY[C].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY[C].options},this.axisY[C].crosshair));for(C=0;C<this.axisY2.length;C++)this.axisY2[C].crosshair&&this.axisY2[C].crosshair.enabled&&(this.axisY2[C].crosshair.hide(),this.axisY2[C].crosshair.dispatchEvent("hidden",{chart:this,axis:this.axisY2[C].options},this.axisY2[C].crosshair))}else this.panEnabled||this.zoomEnabled||this.toolTip.mouseMoveHandler(o,y);if((!d||2<Math.abs(f)||!M||2<Math.abs(c))&&(this.panEnabled||this.zoomEnabled))if(this.panEnabled)d={x1:d?this.plotArea.x1+f:this.plotArea.x1,y1:M?this.plotArea.y1+c:this.plotArea.y1,x2:d?this.plotArea.x2+f:this.plotArea.x2,y2:M?this.plotArea.y2+c:this.plotArea.y2},clearTimeout(k._panTimerId),k._panTimerId=setTimeout((O=d.x1,L=d.y1,X=d.x2,E=d.y2,function(){k._zoomPanToSelectedRegion(O,L,X,E,!0)&&(k._dispatchRangeEvent("rangeChanging","pan"),k.stockChart&&k.stockChart.navigator&&k.stockChart.navigator.enabled&&(k.stockChart._rangeEventParameter.type="rangeChanging",k.stockChart.dispatchEvent("rangeChanging",k.stockChart._rangeEventParameter,k.stockChart)),k.render(),k._dispatchRangeEvent("rangeChanged","pan"),k.stockChart&&k.stockChart.navigator&&k.stockChart.navigator.enabled&&(k.stockChart._rangeEventParameter.type="rangeChanged",k.stockChart.dispatchEvent("rangeChanged",k.stockChart._rangeEventParameter,k.stockChart)),k.dragStartPoint.x=o,k.dragStartPoint.y=y)}),0);else if(this.zoomEnabled){this.resetOverlayedCanvas(),f=this.overlaidCanvasCtx.globalAlpha,this.overlaidCanvasCtx.fillStyle="#A89896";var R=d?o-this.dragStartPoint.x:this.plotArea.x2-this.plotArea.x1,B=M?y-this.dragStartPoint.y:this.plotArea.y2-this.plotArea.y1;this.validateRegion(c=d?this.dragStartPoint.x:this.plotArea.x1,C=M?this.dragStartPoint.y:this.plotArea.y1,d?o:this.plotArea.x2-this.plotArea.x1,M?y:this.plotArea.y2-this.plotArea.y1,"xy"!==this.zoomType).isValid&&(this.resetOverlayedCanvas(),this.overlaidCanvasCtx.fillStyle="#99B2B5"),this.overlaidCanvasCtx.globalAlpha=.7,this.overlaidCanvasCtx.fillRect(c,C,R,B),this.overlaidCanvasCtx.globalAlpha=f}}else if(this.toolTip.mouseMoveHandler(o,y),"none"!==this.plotInfo.axisPlacement){if(this.axisX&&0<this.axisX.length)for(d=0;d<this.axisX.length;d++)this.axisX[d].crosshair&&this.axisX[d].crosshair.enabled&&this.axisX[d].renderCrosshair(o,y);if(this.axisX2&&0<this.axisX2.length)for(d=0;d<this.axisX2.length;d++)this.axisX2[d].crosshair&&this.axisX2[d].crosshair.enabled&&this.axisX2[d].renderCrosshair(o,y);if(this.axisY&&0<this.axisY.length)for(d=0;d<this.axisY.length;d++)this.axisY[d].crosshair&&this.axisY[d].crosshair.enabled&&this.axisY[d].renderCrosshair(o,y);if(this.axisY2&&0<this.axisY2.length)for(d=0;d<this.axisY2.length;d++)this.axisY2[d].crosshair&&this.axisY2[d].crosshair.enabled&&this.axisY2[d].renderCrosshair(o,y);if(this.axisX&&0<this.axisX.length)for(d=0;d<this.axisX.length;d++)this.axisX[d].crosshair&&this.axisX[d].crosshair.enabled&&this.axisX[d].crosshair.renderLabel();if(this.axisX2&&0<this.axisX2.length)for(d=0;d<this.axisX2.length;d++)this.axisX2[d].crosshair&&this.axisX2[d].crosshair.enabled&&this.axisX2[d].crosshair.renderLabel();if(this.axisY&&0<this.axisY.length)for(d=0;d<this.axisY.length;d++)this.axisY[d].crosshair&&this.axisY[d].crosshair.enabled&&this.axisY[d].crosshair.renderLabel();if(this.axisY2&&0<this.axisY2.length)for(d=0;d<this.axisY2.length;d++)this.axisY2[d].crosshair&&this.axisY2[d].crosshair.enabled&&this.axisY2[d].crosshair.renderLabel()}var O,L,X,E},xt.prototype._zoomPanToSelectedRegion=function(o,y,f,c,d){if(y=(o=this.validateRegion(o,y,f,c,d)).axesWithValidRange,f=o.axesRanges,o.isValid)for(c=0;c<y.length;c++)y[c].setViewPortRange((d=f[c]).val1,d.val2),this.syncCharts&&"y"!=this.zoomType&&this.syncCharts(d.val1,d.val2),this.stockChart&&(this.stockChart._rangeEventParameter={stockChart:this.stockChart,source:"chart",index:this.stockChart.charts.indexOf(this),minimum:d.val1,maximum:d.val2});return o.isValid},xt.prototype.validateRegion=function(o,y,f,c,d){d=d||!1;for(var M=0<=this.zoomType.indexOf("x"),k=0<=this.zoomType.indexOf("y"),C=!1,R=[],B=[],O=[],L=0;L<this._axes.length;L++)("axisX"===this._axes[L].type&&M||"axisY"===this._axes[L].type&&k)&&B.push(this._axes[L]);for(k=0;k<B.length;k++){if(M=!1,(Y=(L=B[k]).convertPixelToValue({x:o,y}))>(E=L.convertPixelToValue({x:f,y:c})))var X=E,E=Y,Y=X;if(L.scaleBreaks)for(X=0;!M&&X<L.scaleBreaks._appliedBreaks.length;X++)M=L.scaleBreaks._appliedBreaks[X].startValue<=Y&&L.scaleBreaks._appliedBreaks[X].endValue>=E;if(isFinite(L.dataInfo.minDiff))if(X=L.getApparentDifference(Y,E,null,!0),M||!(this.panEnabled&&L.scaleBreaks&&L.scaleBreaks._appliedBreaks.length)&&(L.logarithmic&&X<Math.pow(L.dataInfo.minDiff,3)||!L.logarithmic&&X<3*Math.abs(L.dataInfo.minDiff))||Y<L.minimum||E>L.maximum){if(!d){C=!1;break}}else R.push(L),O.push({val1:Y,val2:E}),C=!0}return{isValid:C,axesWithValidRange:R,axesRanges:O}},xt.prototype.preparePlotArea=function(){var o=this.plotArea;if(!rt&&(0<o.x1||0<o.y1)&&o.ctx.translate(o.x1,o.y1),(this.axisX[0]||this.axisX2[0])&&(this.axisY[0]||this.axisY2[0])){var y=this.axisX[0]?this.axisX[0].lineCoordinates:this.axisX2[0].lineCoordinates;if(this.axisY&&0<this.axisY.length&&this.axisY[0]){var f=this.axisY[0];o.x1=y.x1<y.x2?y.x1:f.lineCoordinates.x1,o.y1=y.y1<f.lineCoordinates.y1?y.y1:f.lineCoordinates.y1,o.x2=y.x2>f.lineCoordinates.x2?y.x2:f.lineCoordinates.x2,o.y2=y.y2>y.y1?y.y2:f.lineCoordinates.y2,o.width=o.x2-o.x1,o.height=o.y2-o.y1}this.axisY2&&0<this.axisY2.length&&this.axisY2[0]&&(f=this.axisY2[0],o.x1=y.x1<y.x2?y.x1:f.lineCoordinates.x1,o.y1=y.y1<f.lineCoordinates.y1?y.y1:f.lineCoordinates.y1,o.x2=y.x2>f.lineCoordinates.x2?y.x2:f.lineCoordinates.x2,o.y2=y.y2>y.y1?y.y2:f.lineCoordinates.y2,o.width=o.x2-o.x1,o.height=o.y2-o.y1)}else y=this.layoutManager.getFreeSpace(),o.x1=y.x1,o.x2=y.x2,o.y1=y.y1,o.y2=y.y2,o.width=y.width,o.height=y.height;rt||(o.canvas.width=o.width,o.canvas.height=o.height,o.canvas.style.left=o.x1+"px",o.canvas.style.top=o.y1+"px",(0<o.x1||0<o.y1)&&o.ctx.translate(-o.x1,-o.y1)),o.layoutManager=new ln(o.x1,o.y1,o.x2,o.y2,2)},xt.prototype.renderIndexLabels=function(o){var y=o||this.plotArea.ctx,f=this.plotArea,c=0,d=0,M=0,k=M=d=0,C=0,R=c=0,B=0;for(o=0;o<this._indexLabels.length;o++){var X,E,O=this._indexLabels[o],L=O.chartType.toLowerCase(),Y=(k=Xi("indexLabelFontColor",O.dataPoint,O.dataSeries),Xi("indexLabelFontSize",O.dataPoint,O.dataSeries)),it=(C=Xi("indexLabelFontFamily",O.dataPoint,O.dataSeries),R=Xi("indexLabelFontStyle",O.dataPoint,O.dataSeries),B=Xi("indexLabelFontWeight",O.dataPoint,O.dataSeries),Xi("indexLabelBackgroundColor",O.dataPoint,O.dataSeries));X=Xi("indexLabelMaxWidth",O.dataPoint,O.dataSeries),E=Xi("indexLabelWrap",O.dataPoint,O.dataSeries);var J=Xi("indexLabelLineDashType",O.dataPoint,O.dataSeries),q=Xi("indexLabelLineColor",O.dataPoint,O.dataSeries),nt=Et(O.dataPoint.indexLabelLineThickness)?Et(O.dataSeries.options.indexLabelLineThickness)?0:O.dataSeries.options.indexLabelLineThickness:O.dataPoint.indexLabelLineThickness,dt=(c=0<nt?Math.min(10,("normal"===this.plotInfo.axisPlacement?this.plotArea.height:this.plotArea.width)<<0):0,{percent:null,total:null}),gt=null;(0<=O.dataSeries.type.indexOf("stacked")||"pie"===O.dataSeries.type||"doughnut"===O.dataSeries.type)&&(dt=this.getPercentAndTotal(O.dataSeries,O.dataPoint)),(O.dataSeries.indexLabelFormatter||O.dataPoint.indexLabelFormatter)&&(gt={chart:this,dataSeries:O.dataSeries,dataPoint:O.dataPoint,index:O.indexKeyword,total:dt.total,percent:dt.percent});var kt=O.dataPoint.indexLabelFormatter?O.dataPoint.indexLabelFormatter(gt):O.dataPoint.indexLabel?this.replaceKeywordsWithValue(O.dataPoint.indexLabel,O.dataPoint,O.dataSeries,null,O.indexKeyword):O.dataSeries.indexLabelFormatter?O.dataSeries.indexLabelFormatter(gt):O.dataSeries.indexLabel?this.replaceKeywordsWithValue(O.dataSeries.indexLabel,O.dataPoint,O.dataSeries,null,O.indexKeyword):null;if(null!==kt&&""!==kt){dt=Xi("indexLabelPlacement",O.dataPoint,O.dataSeries),gt=Xi("indexLabelOrientation",O.dataPoint,O.dataSeries);var mt=Xi("indexLabelTextAlign",O.dataPoint,O.dataSeries),Tt=O.direction,ee=(d=O.dataSeries.axisX,M=O.dataSeries.axisY,!1);if((it=new En(y,{x:0,y:0,maxWidth:X||.5*this.width,maxHeight:E?5*Y:1.5*Y,angle:"horizontal"===gt?0:-90,text:kt,padding:0,backgroundColor:it,textAlign:mt,fontSize:Y,fontFamily:C,fontWeight:B,fontColor:k,fontStyle:R,textBaseline:"middle"})).measureText(),O.dataSeries.indexLabelMaxWidth=it.maxWidth,"stackedarea100"===L){if(O.point.x<f.x1||O.point.x>f.x2||O.point.y<f.y1-1||O.point.y>f.y2+1)continue}else if("rangearea"===L||"rangesplinearea"===L){if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum||Math.max.apply(null,O.dataPoint.y)<M.viewportMinimum||Math.min.apply(null,O.dataPoint.y)>M.viewportMaximum)continue}else if(0<=L.indexOf("line")||0<=L.indexOf("area")||0<=L.indexOf("bubble")||0<=L.indexOf("scatter")){if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum||O.dataPoint.y<M.viewportMinimum||O.dataPoint.y>M.viewportMaximum)continue}else if(0<=L.indexOf("column")||"waterfall"===L||"error"===L&&!O.axisSwapped){if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum||O.bounds.y1>f.y2||O.bounds.y2<f.y1)continue}else if(0<=L.indexOf("bar")||"error"===L){if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum||O.bounds.x1>f.x2||O.bounds.x2<f.x1)continue}else if("candlestick"===L||"ohlc"===L){if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum||Math.max.apply(null,O.dataPoint.y)<M.viewportMinimum||Math.min.apply(null,O.dataPoint.y)>M.viewportMaximum)continue}else if(O.dataPoint.x<d.viewportMinimum||O.dataPoint.x>d.viewportMaximum)continue;k=C=2,"horizontal"===gt?(R=it.width,B=it.height):(B=it.width,R=it.height),"normal"===this.plotInfo.axisPlacement?(0<=L.indexOf("line")||0<=L.indexOf("area")?(dt="auto",C=4):0<=L.indexOf("stacked")?"auto"===dt&&(dt="inside"):("bubble"===L||"scatter"===L)&&(dt="inside"),X=O.point.x-("horizontal"===gt?R/2:R/2-Y/2),"inside"!==dt?(d=f.y1,M=f.y2,0<Tt?(E=O.point.y+("horizontal"===gt?Y/2:0)-B-C-c)<d&&(ee=(E="auto"===dt?Math.max(O.point.y,d)+Y/2+C:d+Y/2+C)+B>O.point.y):(E=O.point.y+Y/2+C+c)>M-B&&(ee=(E="auto"===dt?Math.min(O.point.y,M)+Y/2-B-C:M+Y/2-B)<O.point.y)):(d=Math.max(O.bounds.y1,f.y1),M=Math.min(O.bounds.y2,f.y2-B+Y/2),c=0<=L.indexOf("range")||"error"===L?0<Tt?Math.max(O.bounds.y1,f.y1)+Y/2+C:Math.min(O.bounds.y2,f.y2)+Y/2-B+C:(Math.max(O.bounds.y1,f.y1)+Math.min(O.bounds.y2,f.y2))/2-B/2+Y/2+("horizontal"===gt?C:0),0<Tt?(E=Math.max(O.point.y,c))<d&&("bubble"===L||"scatter"===L)&&(E=Math.max(O.point.y-B-C,f.y1+C)):(E=Math.min(O.point.y,c))>M-B-C&&("bubble"===L||"scatter"===L)&&(E=Math.min(O.point.y+C,f.y2-B-C)),E=Math.min(E,M))):(0<=L.indexOf("line")||0<=L.indexOf("area")||0<=L.indexOf("scatter")?(dt="auto",k=4):0<=L.indexOf("stacked")?"auto"===dt&&(dt="inside"):"bubble"===L&&(dt="inside"),E=O.point.y+Y/2-B/2+C,"inside"!==dt?(d=f.x1,M=f.x2,0>Tt?(X=O.point.x-("horizontal"===gt?R:R-Y/2)-k-c)<d&&(ee=(X="auto"===dt?Math.max(O.point.x,d)+k:d+k)+R>O.point.x):(X=O.point.x+("horizontal"===gt?0:Y/2)+k+c)>M-R-k-c&&(ee=(X="auto"===dt?Math.min(O.point.x,M)-("horizontal"===gt?R:R/2)-k:M-R-k)<O.point.x)):(d=Math.max(O.bounds.x1,f.x1),Math.min(O.bounds.x2,f.x2),c=0<=L.indexOf("range")||"error"===L?0>Tt?Math.max(O.bounds.x1,f.x1)+Y/2+k:Math.min(O.bounds.x2,f.x2)-R/2-k+("horizontal"===gt?0:Y/2):(Math.max(O.bounds.x1,f.x1)+Math.min(O.bounds.x2,f.x2))/2+("horizontal"===gt?0:Y/2),X=0>Tt?Math.max(O.point.x,c)-("horizontal"===gt?R/2:0):Math.min(O.point.x,c)-R/2,X=Math.max(X,d))),"vertical"===gt&&(E+=B-Y/2),it.x=X,it.y=E,it.render(!0),nt&&"inside"!==dt&&(0>L.indexOf("bar")&&("error"!==L||!O.axisSwapped)&&O.point.x>f.x1&&O.point.x<f.x2||!ee)&&(0>L.indexOf("column")&&("error"!==L||O.axisSwapped)&&O.point.y>f.y1&&O.point.y<f.y2||!ee)&&(y.lineWidth=nt,y.strokeStyle=q||"gray",y.setLineDash&&y.setLineDash(Ti(J,nt)),y.beginPath(),y.moveTo(O.point.x,O.point.y),0<=L.indexOf("bar")||"error"===L&&O.axisSwapped?y.lineTo(X+(0<O.direction?-k:R+k)+("vertical"===gt?-Y/2:0),E+("vertical"===gt?-B/2:B/2-Y/2)-C):0<=L.indexOf("column")||"error"===L&&!O.axisSwapped?y.lineTo(X+R/2-("horizontal"===gt?0:Y/2),E+("vertical"===gt?(E-B<O.point.y?0:-B)+C:(E-Y/2<O.point.y?B:0)-Y/2)):y.lineTo(X+R/2-("horizontal"===gt?0:Y/2),E+("vertical"===gt?E-B<O.point.y?0:-B:(E-Y/2<O.point.y?B:0)-Y/2)),y.stroke())}}for(y={source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0,startTimePercent:.7},o=0;o<this._indexLabels.length;o++)it=Xi("indexLabelBackgroundColor",(O=this._indexLabels[o]).dataPoint,O.dataSeries),O.dataSeries.indexLabelBackgroundColor=Et(it)?rt?"transparent":null:it;return y},xt.prototype.renderLine=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var c=this._eventManager.ghostCtx;f.save();var d=this.plotArea;f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip();for(var k,M=[],C=0;C<o.dataSeriesIndexes.length;C++){var R=o.dataSeriesIndexes[C],B=this.data[R];f.lineWidth=B.lineThickness;var O=B.dataPoints,L="solid";if(f.setLineDash){var X=Ti(B.nullDataLineDashType,B.lineThickness),E=Ti(L=B.lineDashType,B.lineThickness);f.setLineDash(E)}this._eventManager.objectMap[Y=B.id]={objectType:"dataSeries",dataSeriesIndex:R},Y=an(Y),c.strokeStyle=Y,c.lineWidth=0<B.lineThickness?Math.max(B.lineThickness,4):0;var Y=B._colorSet,it=Y=B.lineColor=B.options.lineColor?B.options.lineColor:Y[0];f.strokeStyle=Y;var nt,dt,J=!0,q=0;if(f.beginPath(),0<O.length){var gt=!1;for(q=0;q<O.length;q++)if(!((nt=O[q].x.getTime?O[q].x.getTime():O[q].x)<o.axisX.dataInfo.viewPortMin||nt>o.axisX.dataInfo.viewPortMax&&(!B.connectNullData||!gt)))if("number"!=typeof O[q].y)0<q&&!(B.connectNullData||gt||J)&&(f.stroke(),rt&&c.stroke()),gt=!0;else{nt=o.axisX.convertValueToPixel(nt),dt=o.axisY.convertValueToPixel(O[q].y);var kt=B.dataPointIds[q];if(this._eventManager.objectMap[kt]={id:kt,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:q,x1:nt,y1:dt},J||gt?(!J&&B.connectNullData?(f.setLineDash&&(B.options.nullDataLineDashType||L===B.lineDashType&&B.lineDashType!==B.nullDataLineDashType)&&(f.stroke(),f.beginPath(),f.moveTo(k.x,k.y),L=B.nullDataLineDashType,f.setLineDash(X)),f.lineTo(nt,dt),rt&&c.lineTo(nt,dt)):(f.beginPath(),f.moveTo(nt,dt),rt&&(c.beginPath(),c.moveTo(nt,dt))),gt=J=!1):(f.lineTo(nt,dt),rt&&c.lineTo(nt,dt),q%500==0&&(f.stroke(),f.beginPath(),f.moveTo(nt,dt),rt&&(c.stroke(),c.beginPath(),c.moveTo(nt,dt)))),k={x:nt,y:dt},q<O.length-1&&(it!==(O[q].lineColor||Y)||L!==(O[q].lineDashType||B.lineDashType))&&(f.stroke(),f.beginPath(),f.moveTo(nt,dt),f.strokeStyle=it=O[q].lineColor||Y,f.setLineDash&&(O[q].lineDashType?f.setLineDash(Ti(L=O[q].lineDashType,B.lineThickness)):(L=B.lineDashType,f.setLineDash(E)))),0<O[q].markerSize||0<B.markerSize){var mt=B.getMarkerProperties(q,nt,dt,f);M.push(mt),kt=an(kt),rt&&M.push({x:nt,y:dt,ctx:c,type:mt.type,size:mt.size,color:kt,borderColor:kt,borderThickness:mt.borderThickness})}(O[q].indexLabel||B.indexLabel||O[q].indexLabelFormatter||B.indexLabelFormatter)&&this._indexLabels.push({chartType:"line",dataPoint:O[q],dataSeries:B,point:{x:nt,y:dt},direction:0>O[q].y===o.axisY.reversed?1:-1,color:Y})}f.stroke(),rt&&c.stroke()}}return D.drawMarkers(M),rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),c.beginPath()),f.restore(),f.beginPath(),{source:y,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderStepLine=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var c=this._eventManager.ghostCtx;f.save();var d=this.plotArea;f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip();for(var k,M=[],C=0;C<o.dataSeriesIndexes.length;C++){var R=o.dataSeriesIndexes[C],B=this.data[R];f.lineWidth=B.lineThickness;var O=B.dataPoints,L="solid";if(f.setLineDash){var X=Ti(B.nullDataLineDashType,B.lineThickness),E=Ti(L=B.lineDashType,B.lineThickness);f.setLineDash(E)}this._eventManager.objectMap[Y=B.id]={objectType:"dataSeries",dataSeriesIndex:R},Y=an(Y),c.strokeStyle=Y,c.lineWidth=0<B.lineThickness?Math.max(B.lineThickness,4):0;var Y=B._colorSet,it=Y=B.lineColor=B.options.lineColor?B.options.lineColor:Y[0];f.strokeStyle=Y;var nt,dt,J=!0,q=0;if(f.beginPath(),0<O.length){var gt=!1;for(q=0;q<O.length;q++)if(!((nt=O[q].getTime?O[q].x.getTime():O[q].x)<o.axisX.dataInfo.viewPortMin||nt>o.axisX.dataInfo.viewPortMax&&(!B.connectNullData||!gt)))if("number"!=typeof O[q].y)0<q&&!(B.connectNullData||gt||J)&&(f.stroke(),rt&&c.stroke()),gt=!0;else{var kt=dt;nt=o.axisX.convertValueToPixel(nt),dt=o.axisY.convertValueToPixel(O[q].y);var mt=B.dataPointIds[q];this._eventManager.objectMap[mt]={id:mt,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:q,x1:nt,y1:dt},J||gt?(!J&&B.connectNullData?(f.setLineDash&&(B.options.nullDataLineDashType||L===B.lineDashType&&B.lineDashType!==B.nullDataLineDashType)&&(f.stroke(),f.beginPath(),f.moveTo(k.x,k.y),L=B.nullDataLineDashType,f.setLineDash(X)),f.lineTo(nt,kt),f.lineTo(nt,dt),rt&&(c.lineTo(nt,kt),c.lineTo(nt,dt))):(f.beginPath(),f.moveTo(nt,dt),rt&&(c.beginPath(),c.moveTo(nt,dt))),gt=J=!1):(f.lineTo(nt,kt),rt&&c.lineTo(nt,kt),f.lineTo(nt,dt),rt&&c.lineTo(nt,dt),q%500==0&&(f.stroke(),f.beginPath(),f.moveTo(nt,dt),rt&&(c.stroke(),c.beginPath(),c.moveTo(nt,dt)))),k={x:nt,y:dt},q<O.length-1&&(it!==(O[q].lineColor||Y)||L!==(O[q].lineDashType||B.lineDashType))&&(f.stroke(),f.beginPath(),f.moveTo(nt,dt),f.strokeStyle=it=O[q].lineColor||Y,f.setLineDash&&(O[q].lineDashType?f.setLineDash(Ti(L=O[q].lineDashType,B.lineThickness)):(L=B.lineDashType,f.setLineDash(E)))),(0<O[q].markerSize||0<B.markerSize)&&(kt=B.getMarkerProperties(q,nt,dt,f),M.push(kt),mt=an(mt),rt&&M.push({x:nt,y:dt,ctx:c,type:kt.type,size:kt.size,color:mt,borderColor:mt,borderThickness:kt.borderThickness})),(O[q].indexLabel||B.indexLabel||O[q].indexLabelFormatter||B.indexLabelFormatter)&&this._indexLabels.push({chartType:"stepLine",dataPoint:O[q],dataSeries:B,point:{x:nt,y:dt},direction:0>O[q].y===o.axisY.reversed?1:-1,color:Y})}f.stroke(),rt&&c.stroke()}}return D.drawMarkers(M),rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),c.beginPath()),f.restore(),f.beginPath(),{source:y,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderSpline=function(o){function y(mt){if(0<(mt=Pt(mt,2)).length){c.beginPath(),rt&&d.beginPath(),c.moveTo(mt[0].x,mt[0].y),mt[0].newStrokeStyle&&(c.strokeStyle=mt[0].newStrokeStyle),mt[0].newLineDashArray&&c.setLineDash(mt[0].newLineDashArray),rt&&d.moveTo(mt[0].x,mt[0].y);for(var Tt=0;Tt<mt.length-3;Tt+=3)c.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y),rt&&d.bezierCurveTo(mt[Tt+1].x,mt[Tt+1].y,mt[Tt+2].x,mt[Tt+2].y,mt[Tt+3].x,mt[Tt+3].y),(0<Tt&&Tt%3e3==0||mt[Tt+3].newStrokeStyle||mt[Tt+3].newLineDashArray)&&(c.stroke(),c.beginPath(),c.moveTo(mt[Tt+3].x,mt[Tt+3].y),mt[Tt+3].newStrokeStyle&&(c.strokeStyle=mt[Tt+3].newStrokeStyle),mt[Tt+3].newLineDashArray&&c.setLineDash(mt[Tt+3].newLineDashArray),rt&&(d.stroke(),d.beginPath(),d.moveTo(mt[Tt+3].x,mt[Tt+3].y)));c.stroke(),rt&&d.stroke()}}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var d=this._eventManager.ghostCtx;c.save();var M=this.plotArea;c.beginPath(),c.rect(M.x1,M.y1,M.width,M.height),c.clip();for(var k=[],C=0;C<o.dataSeriesIndexes.length;C++){var R=o.dataSeriesIndexes[C],B=this.data[R];c.lineWidth=B.lineThickness;var O=B.dataPoints,L="solid";if(c.setLineDash){var X=Ti(B.nullDataLineDashType,B.lineThickness),E=Ti(L=B.lineDashType,B.lineThickness);c.setLineDash(E)}this._eventManager.objectMap[Y=B.id]={objectType:"dataSeries",dataSeriesIndex:R},Y=an(Y),d.strokeStyle=Y,d.lineWidth=0<B.lineThickness?Math.max(B.lineThickness,4):0;var Y=B._colorSet,it=Y=B.lineColor=B.options.lineColor?B.options.lineColor:Y[0];c.strokeStyle=Y;var q,nt,J=0,dt=[];if(c.beginPath(),0<O.length)for(nt=!1,J=0;J<O.length;J++)if(!((q=O[J].getTime?O[J].x.getTime():O[J].x)<o.axisX.dataInfo.viewPortMin||q>o.axisX.dataInfo.viewPortMax&&(!B.connectNullData||!nt)))if("number"!=typeof O[J].y)0<J&&!nt&&(B.connectNullData?c.setLineDash&&0<dt.length&&(B.options.nullDataLineDashType||!O[J-1].lineDashType)&&(dt[dt.length-1].newLineDashArray=X,L=B.nullDataLineDashType):(y(dt),dt=[])),nt=!0;else{q=o.axisX.convertValueToPixel(q),nt=o.axisY.convertValueToPixel(O[J].y);var gt=B.dataPointIds[J];if(this._eventManager.objectMap[gt]={id:gt,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:J,x1:q,y1:nt},dt[dt.length]={x:q,y:nt},J<O.length-1&&(it!==(O[J].lineColor||Y)||L!==(O[J].lineDashType||B.lineDashType))&&(dt[dt.length-1].newStrokeStyle=it=O[J].lineColor||Y,c.setLineDash&&(O[J].lineDashType?dt[dt.length-1].newLineDashArray=Ti(L=O[J].lineDashType,B.lineThickness):(L=B.lineDashType,dt[dt.length-1].newLineDashArray=E))),0<O[J].markerSize||0<B.markerSize){var kt=B.getMarkerProperties(J,q,nt,c);k.push(kt),gt=an(gt),rt&&k.push({x:q,y:nt,ctx:d,type:kt.type,size:kt.size,color:gt,borderColor:gt,borderThickness:kt.borderThickness})}(O[J].indexLabel||B.indexLabel||O[J].indexLabelFormatter||B.indexLabelFormatter)&&this._indexLabels.push({chartType:"spline",dataPoint:O[J],dataSeries:B,point:{x:q,y:nt},direction:0>O[J].y===o.axisY.reversed?1:-1,color:Y}),nt=!1}y(dt)}return D.drawMarkers(k),rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(M.x1,M.y1,M.width,M.height),d.beginPath()),c.restore(),c.beginPath(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderColumn=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,C,c=null,d=this.plotArea,B=0,R=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),O=(B=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.width,this.plotArea.width/o.plotType.totalDataSeries*.9)<<0),L=o.axisX.dataInfo.minDiff;for(isFinite(L)||(L=.3*Math.abs(o.axisX.range)),L=this.dataPointWidth=this.options.dataPointWidth?this.dataPointWidth:d.width*(o.axisX.logarithmic?Math.log(L)/Math.log(o.axisX.range):Math.abs(L)/Math.abs(o.axisX.range))/o.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&B>O&&(B=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,O)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&O<B&&(O=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,B)),L<B&&(L=B),L>O&&(L=O),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip()),O=0;O<o.dataSeriesIndexes.length;O++){var X=o.dataSeriesIndexes[O],E=this.data[X],Y=E.dataPoints;if(0<Y.length){var it=!!(5<L&&E.bevelEnabled);for(B=0;B<Y.length;B++)if(!((C=Y[B].getTime?Y[B].x.getTime():Y[B].x)<o.axisX.dataInfo.viewPortMin||C>o.axisX.dataInfo.viewPortMax)&&"number"==typeof Y[B].y){M=o.axisX.convertValueToPixel(C),k=o.axisY.convertValueToPixel(Y[B].y),M=o.axisX.reversed?M+o.plotType.totalDataSeries*L/2-(o.previousDataSeriesCount+O)*L<<0:M-o.plotType.totalDataSeries*L/2+(o.previousDataSeriesCount+O)*L<<0;var q,J=o.axisX.reversed?M-L<<0:M+L<<0;0<=Y[B].y?q=R:(q=k,k=R),k>q&&(c=k,k=q,q=c),is(f,M,k,J,q,c=Y[B].color?Y[B].color:E._colorSet[B%E._colorSet.length],0,null,it&&0<=Y[B].y,0>Y[B].y&&it,!1,!1,E.fillOpacity),this._eventManager.objectMap[c=E.dataPointIds[B]]={id:c,objectType:"dataPoint",dataSeriesIndex:X,dataPointIndex:B,x1:M,y1:k,x2:J,y2:q},c=an(c),rt&&is(this._eventManager.ghostCtx,M,k,J,q,c,0,null,!1,!1,!1,!1),(Y[B].indexLabel||E.indexLabel||Y[B].indexLabelFormatter||E.indexLabelFormatter)&&this._indexLabels.push({chartType:"column",dataPoint:Y[B],dataSeries:E,point:{x:M+(J-M)/2,y:0>Y[B].y===o.axisY.reversed?k:q},direction:0>Y[B].y===o.axisY.reversed?1:-1,bounds:{x1:M,y1:Math.min(k,q),x2:J,y2:Math.max(k,q)},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.yScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:R<o.axisY.bounds.y1?o.axisY.bounds.y1:R>o.axisY.bounds.y2?o.axisY.bounds.y2:R}}},xt.prototype.renderStackedColumn=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var B,O,c=null,d=this.plotArea,M=[],k=[],C=[],R=[],X=0,L=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0);X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,B=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.width<<0;var E=o.axisX.dataInfo.minDiff;isFinite(E)||(E=.3*Math.abs(o.axisX.range)),E=this.options.dataPointWidth?this.dataPointWidth:d.width*(o.axisX.logarithmic?Math.log(E)/Math.log(o.axisX.range):Math.abs(E)/Math.abs(o.axisX.range))/o.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&X>B&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,B)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&B<X&&(B=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),E<X&&(E=X),E>B&&(E=B),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var Y=0;Y<o.dataSeriesIndexes.length;Y++){var it=o.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;if(0<q.length){var nt=!!(5<E&&J.bevelEnabled);for(f.strokeStyle="#4572A7 ",X=0;X<q.length;X++)if(!((c=q[X].x.getTime?q[X].x.getTime():q[X].x)<o.axisX.dataInfo.viewPortMin||c>o.axisX.dataInfo.viewPortMax)&&"number"==typeof q[X].y){var kt,dt=(B=o.axisX.convertValueToPixel(c))-o.plotType.plotUnits.length*E/2+o.index*E<<0,gt=dt+E<<0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0<q[X].y)C[c]=q[X].y+(C[c]?C[c]:0),0<C[c]&&(O=o.axisY.convertValueToPixel(C[c]),kt=typeof M[c]<"u"?M[c]:L,M[c]=O);else if(o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0>=q[X].y)R[c]=q[X].y+(R[c]?R[c]:0),kt=o.axisY.convertValueToPixel(R[c]),O=typeof k[c]<"u"?k[c]:L,k[c]=kt;else if(O=o.axisY.convertValueToPixel(q[X].y),0<=q[X].y){var mt=typeof M[c]<"u"?M[c]:0;M[c]=mt+((kt=L-mt)-(O-=mt))}else k[c]=(mt=k[c]?k[c]:0)+((kt=O+mt)-(O=L+mt));is(f,dt,O,gt,kt,c=q[X].color?q[X].color:J._colorSet[X%J._colorSet.length],0,null,nt&&0<=q[X].y,0>q[X].y&&nt,!1,!1,J.fillOpacity),this._eventManager.objectMap[c=J.dataPointIds[X]]={id:c,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:X,x1:dt,y1:O,x2:gt,y2:kt},c=an(c),rt&&is(this._eventManager.ghostCtx,dt,O,gt,kt,c,0,null,!1,!1,!1,!1),(q[X].indexLabel||J.indexLabel||q[X].indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedColumn",dataPoint:q[X],dataSeries:J,point:{x:B,y:0<=q[X].y?O:kt},direction:0>q[X].y===o.axisY.reversed?1:-1,bounds:{x1:dt,y1:Math.min(O,kt),x2:gt,y2:Math.max(O,kt)},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.yScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:L<o.axisY.bounds.y1?o.axisY.bounds.y1:L>o.axisY.bounds.y2?o.axisY.bounds.y2:L}}},xt.prototype.renderStackedColumn100=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var B,O,c=null,d=this.plotArea,M=[],k=[],C=[],R=[],X=0,L=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0);X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,B=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.width<<0;var E=o.axisX.dataInfo.minDiff;isFinite(E)||(E=.3*Math.abs(o.axisX.range)),E=this.options.dataPointWidth?this.dataPointWidth:d.width*(o.axisX.logarithmic?Math.log(E)/Math.log(o.axisX.range):Math.abs(E)/Math.abs(o.axisX.range))/o.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&X>B&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,B)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&B<X&&(B=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),E<X&&(E=X),E>B&&(E=B),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var Y=0;Y<o.dataSeriesIndexes.length;Y++){var it=o.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;if(0<q.length){var nt=!!(5<E&&J.bevelEnabled);for(X=0;X<q.length;X++)if(!((c=q[X].x.getTime?q[X].x.getTime():q[X].x)<o.axisX.dataInfo.viewPortMin||c>o.axisX.dataInfo.viewPortMax)&&"number"==typeof q[X].y){B=o.axisX.convertValueToPixel(c),O=0!==o.dataPointYSums[c]?q[X].y/o.dataPointYSums[c]*100:0;var kt,dt=B-o.plotType.plotUnits.length*E/2+o.index*E<<0,gt=dt+E<<0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0<q[X].y){if(C[c]=O+(typeof C[c]<"u"?C[c]:0),0>=C[c])continue;O=o.axisY.convertValueToPixel(C[c]),kt=M[c]?M[c]:L,M[c]=O}else if(o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0>=q[X].y)R[c]=O+(typeof R[c]<"u"?R[c]:0),kt=o.axisY.convertValueToPixel(R[c]),O=k[c]?k[c]:L,k[c]=kt;else if(O=o.axisY.convertValueToPixel(O),0<=q[X].y){var mt=typeof M[c]<"u"?M[c]:0;O-=mt,kt=L-mt,o.dataSeriesIndexes.length-1===Y&&1>=Math.abs(d.y1-O)&&(O=d.y1),M[c]=mt+(kt-O)}else kt=O+(mt=typeof k[c]<"u"?k[c]:0),O=L+mt,o.dataSeriesIndexes.length-1===Y&&1>=Math.abs(d.y2-kt)&&(kt=d.y2),k[c]=mt+(kt-O);is(f,dt,O,gt,kt,c=q[X].color?q[X].color:J._colorSet[X%J._colorSet.length],0,null,nt&&0<=q[X].y,0>q[X].y&&nt,!1,!1,J.fillOpacity),this._eventManager.objectMap[c=J.dataPointIds[X]]={id:c,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:X,x1:dt,y1:O,x2:gt,y2:kt},c=an(c),rt&&is(this._eventManager.ghostCtx,dt,O,gt,kt,c,0,null,!1,!1,!1,!1),(q[X].indexLabel||J.indexLabel||q[X].indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedColumn100",dataPoint:q[X],dataSeries:J,point:{x:B,y:0<=q[X].y?O:kt},direction:0>q[X].y===o.axisY.reversed?1:-1,bounds:{x1:dt,y1:Math.min(O,kt),x2:gt,y2:Math.max(O,kt)},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.yScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:L<o.axisY.bounds.y1?o.axisY.bounds.y1:L>o.axisY.bounds.y2?o.axisY.bounds.y2:L}}},xt.prototype.renderBar=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,C,c=null,d=this.plotArea,B=0,R=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),O=(B=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.height,this.plotArea.height/o.plotType.totalDataSeries*.9)<<0),L=o.axisX.dataInfo.minDiff;for(isFinite(L)||(L=.3*Math.abs(o.axisX.range)),L=this.options.dataPointWidth?this.dataPointWidth:d.height*(o.axisX.logarithmic?Math.log(L)/Math.log(o.axisX.range):Math.abs(L)/Math.abs(o.axisX.range))/o.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&B>O&&(B=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,O)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&O<B&&(O=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,B)),L<B&&(L=B),L>O&&(L=O),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip()),O=0;O<o.dataSeriesIndexes.length;O++){var X=o.dataSeriesIndexes[O],E=this.data[X],Y=E.dataPoints;if(0<Y.length){var it=!!(5<L&&E.bevelEnabled);for(f.strokeStyle="#4572A7 ",B=0;B<Y.length;B++)if(!((C=Y[B].getTime?Y[B].x.getTime():Y[B].x)<o.axisX.dataInfo.viewPortMin||C>o.axisX.dataInfo.viewPortMax)&&"number"==typeof Y[B].y){k=o.axisX.convertValueToPixel(C),M=o.axisY.convertValueToPixel(Y[B].y),k=o.axisX.reversed?k+o.plotType.totalDataSeries*L/2-(o.previousDataSeriesCount+O)*L<<0:k-o.plotType.totalDataSeries*L/2+(o.previousDataSeriesCount+O)*L<<0;var q,J=o.axisX.reversed?k-L<<0:k+L<<0;0<=Y[B].y?q=R:(q=M,M=R),is(f,q,k,M,J,c=Y[B].color?Y[B].color:E._colorSet[B%E._colorSet.length],0,null,it,!1,!1,!1,E.fillOpacity),this._eventManager.objectMap[c=E.dataPointIds[B]]={id:c,objectType:"dataPoint",dataSeriesIndex:X,dataPointIndex:B,x1:q,y1:k,x2:M,y2:J},c=an(c),rt&&is(this._eventManager.ghostCtx,q,k,M,J,c,0,null,!1,!1,!1,!1),(Y[B].indexLabel||E.indexLabel||Y[B].indexLabelFormatter||E.indexLabelFormatter)&&this._indexLabels.push({chartType:"bar",dataPoint:Y[B],dataSeries:E,point:{x:0<=Y[B].y?M:q,y:k+(J-k)/2},direction:0>Y[B].y===o.axisY.reversed?1:-1,bounds:{x1:Math.min(q,M),y1:k,x2:Math.max(q,M),y2:J},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.xScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:R<o.axisY.bounds.x1?o.axisY.bounds.x1:R>o.axisY.bounds.x2?o.axisY.bounds.x2:R}}},xt.prototype.renderStackedBar=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var B,O,c=null,d=this.plotArea,M=[],k=[],C=[],R=[],X=0,L=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0);X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,O=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.height<<0;var E=o.axisX.dataInfo.minDiff;isFinite(E)||(E=.3*Math.abs(o.axisX.range)),E=this.options.dataPointWidth?this.dataPointWidth:d.height*(o.axisX.logarithmic?Math.log(E)/Math.log(o.axisX.range):Math.abs(E)/Math.abs(o.axisX.range))/o.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&X>O&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,O)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&O<X&&(O=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),E<X&&(E=X),E>O&&(E=O),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var Y=0;Y<o.dataSeriesIndexes.length;Y++){var it=o.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;if(0<q.length){var nt=!!(5<E&&J.bevelEnabled);for(f.strokeStyle="#4572A7 ",X=0;X<q.length;X++)if(!((c=q[X].x.getTime?q[X].x.getTime():q[X].x)<o.axisX.dataInfo.viewPortMin||c>o.axisX.dataInfo.viewPortMax)&&"number"==typeof q[X].y){var kt,dt=(O=o.axisX.convertValueToPixel(c))-o.plotType.plotUnits.length*E/2+o.index*E<<0,gt=dt+E<<0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0<q[X].y)C[c]=q[X].y+(C[c]?C[c]:0),0<C[c]&&(kt=M[c]?M[c]:L,M[c]=B=o.axisY.convertValueToPixel(C[c]));else if(o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0>=q[X].y)R[c]=q[X].y+(R[c]?R[c]:0),B=k[c]?k[c]:L,k[c]=kt=o.axisY.convertValueToPixel(R[c]);else if(B=o.axisY.convertValueToPixel(q[X].y),0<=q[X].y){var mt=M[c]?M[c]:0;M[c]=mt+((B+=mt)-(kt=L+mt))}else kt=B-(mt=k[c]?k[c]:0),k[c]=mt+((B=L-mt)-kt);is(f,kt,dt,B,gt,c=q[X].color?q[X].color:J._colorSet[X%J._colorSet.length],0,null,nt,!1,!1,!1,J.fillOpacity),this._eventManager.objectMap[c=J.dataPointIds[X]]={id:c,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:X,x1:kt,y1:dt,x2:B,y2:gt},c=an(c),rt&&is(this._eventManager.ghostCtx,kt,dt,B,gt,c,0,null,!1,!1,!1,!1),(q[X].indexLabel||J.indexLabel||q[X].indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedBar",dataPoint:q[X],dataSeries:J,point:{x:0<=q[X].y?B:kt,y:O},direction:0>q[X].y===o.axisY.reversed?1:-1,bounds:{x1:Math.min(kt,B),y1:dt,x2:Math.max(kt,B),y2:gt},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.xScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:L<o.axisY.bounds.x1?o.axisY.bounds.x1:L>o.axisY.bounds.x2?o.axisY.bounds.x2:L}}},xt.prototype.renderStackedBar100=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var B,O,c=null,d=this.plotArea,M=[],k=[],C=[],R=[],X=0,L=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0);X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,O=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.15*this.height<<0;var E=o.axisX.dataInfo.minDiff;isFinite(E)||(E=.3*Math.abs(o.axisX.range)),E=this.options.dataPointWidth?this.dataPointWidth:d.height*(o.axisX.logarithmic?Math.log(E)/Math.log(o.axisX.range):Math.abs(E)/Math.abs(o.axisX.range))/o.plotType.plotUnits.length*.9<<0,this.dataPointMaxWidth&&X>O&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,O)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&O<X&&(O=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),E<X&&(E=X),E>O&&(E=O),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var Y=0;Y<o.dataSeriesIndexes.length;Y++){var it=o.dataSeriesIndexes[Y],J=this.data[it],q=J.dataPoints;if(0<q.length){var nt=!!(5<E&&J.bevelEnabled);for(f.strokeStyle="#4572A7 ",X=0;X<q.length;X++)if(!((c=q[X].x.getTime?q[X].x.getTime():q[X].x)<o.axisX.dataInfo.viewPortMin||c>o.axisX.dataInfo.viewPortMax)&&"number"==typeof q[X].y){var dt;O=o.axisX.convertValueToPixel(c),dt=0!==o.dataPointYSums[c]?q[X].y/o.dataPointYSums[c]*100:0;var gt=O-o.plotType.plotUnits.length*E/2+o.index*E<<0,kt=gt+E<<0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0<q[X].y){if(C[c]=dt+(C[c]?C[c]:0),0>=C[c])continue;dt=M[c]?M[c]:L,M[c]=B=o.axisY.convertValueToPixel(C[c])}else if(o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length&&0>=q[X].y)R[c]=dt+(R[c]?R[c]:0),B=k[c]?k[c]:L,k[c]=dt=o.axisY.convertValueToPixel(R[c]);else if(B=o.axisY.convertValueToPixel(dt),0<=q[X].y){var mt=M[c]?M[c]:0;dt=L+mt,B+=mt,o.dataSeriesIndexes.length-1===Y&&1>=Math.abs(d.x2-B)&&(B=d.x2),M[c]=mt+(B-dt)}else dt=B-(mt=k[c]?k[c]:0),B=L-mt,o.dataSeriesIndexes.length-1===Y&&1>=Math.abs(d.x1-dt)&&(dt=d.x1),k[c]=mt+(B-dt);is(f,dt,gt,B,kt,c=q[X].color?q[X].color:J._colorSet[X%J._colorSet.length],0,null,nt,!1,!1,!1,J.fillOpacity),this._eventManager.objectMap[c=J.dataPointIds[X]]={id:c,objectType:"dataPoint",dataSeriesIndex:it,dataPointIndex:X,x1:dt,y1:gt,x2:B,y2:kt},c=an(c),rt&&is(this._eventManager.ghostCtx,dt,gt,B,kt,c,0,null,!1,!1,!1,!1),(q[X].indexLabel||J.indexLabel||q[X].indexLabelFormatter||J.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedBar100",dataPoint:q[X],dataSeries:J,point:{x:0<=q[X].y?B:dt,y:O},direction:0>q[X].y===o.axisY.reversed?1:-1,bounds:{x1:Math.min(dt,B),y1:gt,x2:Math.max(dt,B),y2:kt},color:c})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.xScaleAnimation,easingFunction:w.easing.easeOutQuart,animationBase:L<o.axisY.bounds.x1?o.axisY.bounds.x1:L>o.axisY.bounds.x2?o.axisY.bounds.x2:L}}},xt.prototype.renderArea=function(o){var y,f;function c(){kt&&(0<E.lineThickness&&M.stroke(),o.axisY.logarithmic||0>=o.axisY.viewportMinimum&&0<=o.axisY.viewportMaximum?gt=dt:0>o.axisY.viewportMaximum?gt=C.y1:0<o.axisY.viewportMinimum&&(gt=dt),M.lineTo(J,gt),M.lineTo(kt.x,gt),M.closePath(),M.globalAlpha=E.fillOpacity,M.fill(),M.globalAlpha=1,rt&&(k.lineTo(J,gt),k.lineTo(kt.x,gt),k.closePath(),k.fill()),M.beginPath(),M.moveTo(J,q),k.beginPath(),k.moveTo(J,q),kt={x:J,y:q})}var d=o.targetCanvasCtx||this.plotArea.ctx,M=rt?this._preRenderCtx:d;if(!(0>=o.dataSeriesIndexes.length)){var O,k=this._eventManager.ghostCtx,C=o.axisY.lineCoordinates,R=[],B=this.plotArea;M.save(),rt&&k.save(),M.beginPath(),M.rect(B.x1,B.y1,B.width,B.height),M.clip(),rt&&(k.beginPath(),k.rect(B.x1,B.y1,B.width,B.height),k.clip());for(var L=0;L<o.dataSeriesIndexes.length;L++){var X=o.dataSeriesIndexes[L],E=this.data[X],Y=E.dataPoints;this._eventManager.objectMap[R=E.id]={objectType:"dataSeries",dataSeriesIndex:X},R=an(R),k.fillStyle=R,R=[],y=!0;var J,q,nt,gt,it=0,dt=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),kt=null;if(0<Y.length){var mt=E._colorSet[it%E._colorSet.length],Tt=E.lineColor=E.options.lineColor||mt,ee=Tt;if(M.fillStyle=mt,M.strokeStyle=Tt,M.lineWidth=E.lineThickness,f="solid",M.setLineDash){var Ft=Ti(E.nullDataLineDashType,E.lineThickness),vt=Ti(f=E.lineDashType,E.lineThickness);M.setLineDash(vt)}for(var le=!0;it<Y.length;it++)if(!((nt=Y[it].x.getTime?Y[it].x.getTime():Y[it].x)<o.axisX.dataInfo.viewPortMin||nt>o.axisX.dataInfo.viewPortMax&&(!E.connectNullData||!le)))if("number"!=typeof Y[it].y)E.connectNullData||le||y||c(),le=!0;else{J=o.axisX.convertValueToPixel(nt),q=o.axisY.convertValueToPixel(Y[it].y),y||le?(!y&&E.connectNullData?(M.setLineDash&&(E.options.nullDataLineDashType||f===E.lineDashType&&E.lineDashType!==E.nullDataLineDashType)&&(y=J,f=q,J=O.x,q=O.y,c(),M.moveTo(O.x,O.y),J=y,q=f,kt=O,f=E.nullDataLineDashType,M.setLineDash(Ft)),M.lineTo(J,q),rt&&k.lineTo(J,q)):(M.beginPath(),M.moveTo(J,q),rt&&(k.beginPath(),k.moveTo(J,q)),kt={x:J,y:q}),le=y=!1):(M.lineTo(J,q),rt&&k.lineTo(J,q),it%250==0&&c()),O={x:J,y:q},it<Y.length-1&&(ee!==(Y[it].lineColor||Tt)||f!==(Y[it].lineDashType||E.lineDashType))&&(c(),M.strokeStyle=ee=Y[it].lineColor||Tt,M.setLineDash&&(Y[it].lineDashType?M.setLineDash(Ti(f=Y[it].lineDashType,E.lineThickness)):(f=E.lineDashType,M.setLineDash(vt))));var Ht=E.dataPointIds[it];this._eventManager.objectMap[Ht]={id:Ht,objectType:"dataPoint",dataSeriesIndex:X,dataPointIndex:it,x1:J,y1:q},0!==Y[it].markerSize&&(0<Y[it].markerSize||0<E.markerSize)&&(nt=E.getMarkerProperties(it,J,q,M),R.push(nt),Ht=an(Ht),rt&&R.push({x:J,y:q,ctx:k,type:nt.type,size:nt.size,color:Ht,borderColor:Ht,borderThickness:nt.borderThickness})),(Y[it].indexLabel||E.indexLabel||Y[it].indexLabelFormatter||E.indexLabelFormatter)&&this._indexLabels.push({chartType:"area",dataPoint:Y[it],dataSeries:E,point:{x:J,y:q},direction:0>Y[it].y===o.axisY.reversed?1:-1,color:mt})}c(),D.drawMarkers(R)}}return rt&&(d.drawImage(this._preRenderCanvas,0,0,this.width,this.height),M.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&M.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&M.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),M.clearRect(B.x1,B.y1,B.width,B.height),this._eventManager.ghostCtx.restore()),M.restore(),{source:d,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderSplineArea=function(o){function y(){var le=Pt(nt,2);if(0<le.length){if(0<O.lineThickness){c.beginPath(),c.moveTo(le[0].x,le[0].y),le[0].newStrokeStyle&&(c.strokeStyle=le[0].newStrokeStyle),le[0].newLineDashArray&&c.setLineDash(le[0].newLineDashArray);for(var Ht=0;Ht<le.length-3;Ht+=3)c.bezierCurveTo(le[Ht+1].x,le[Ht+1].y,le[Ht+2].x,le[Ht+2].y,le[Ht+3].x,le[Ht+3].y),rt&&d.bezierCurveTo(le[Ht+1].x,le[Ht+1].y,le[Ht+2].x,le[Ht+2].y,le[Ht+3].x,le[Ht+3].y),(le[Ht+3].newStrokeStyle||le[Ht+3].newLineDashArray)&&(c.stroke(),c.beginPath(),c.moveTo(le[Ht+3].x,le[Ht+3].y),le[Ht+3].newStrokeStyle&&(c.strokeStyle=le[Ht+3].newStrokeStyle),le[Ht+3].newLineDashArray&&c.setLineDash(le[Ht+3].newLineDashArray));c.stroke()}for(c.beginPath(),c.moveTo(le[0].x,le[0].y),rt&&(d.beginPath(),d.moveTo(le[0].x,le[0].y)),Ht=0;Ht<le.length-3;Ht+=3)c.bezierCurveTo(le[Ht+1].x,le[Ht+1].y,le[Ht+2].x,le[Ht+2].y,le[Ht+3].x,le[Ht+3].y),rt&&d.bezierCurveTo(le[Ht+1].x,le[Ht+1].y,le[Ht+2].x,le[Ht+2].y,le[Ht+3].x,le[Ht+3].y);o.axisY.logarithmic||0>=o.axisY.viewportMinimum&&0<=o.axisY.viewportMaximum?J=it:0>o.axisY.viewportMaximum?J=M.y1:0<o.axisY.viewportMinimum&&(J=it),q={x:le[0].x,y:le[0].y},c.lineTo(le[le.length-1].x,J),c.lineTo(q.x,J),c.closePath(),c.globalAlpha=O.fillOpacity,c.fill(),c.globalAlpha=1,rt&&(d.lineTo(le[le.length-1].x,J),d.lineTo(q.x,J),d.closePath(),d.fill())}}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var d=this._eventManager.ghostCtx,M=o.axisY.lineCoordinates,k=[],C=this.plotArea;c.save(),rt&&d.save(),c.beginPath(),c.rect(C.x1,C.y1,C.width,C.height),c.clip(),rt&&(d.beginPath(),d.rect(C.x1,C.y1,C.width,C.height),d.clip());for(var R=0;R<o.dataSeriesIndexes.length;R++){var B=o.dataSeriesIndexes[R],O=this.data[B],L=O.dataPoints;this._eventManager.objectMap[k=O.id]={objectType:"dataSeries",dataSeriesIndex:B},k=an(k),d.fillStyle=k,k=[];var E,Y,J,X=0,it=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),q=null,nt=[];if(0<L.length){var dt=O._colorSet[X%O._colorSet.length],gt=O.lineColor=O.options.lineColor||dt,kt=gt;c.fillStyle=dt,c.strokeStyle=gt,c.lineWidth=O.lineThickness;var mt="solid";if(c.setLineDash){var Tt=Ti(O.nullDataLineDashType,O.lineThickness),ee=Ti(mt=O.lineDashType,O.lineThickness);c.setLineDash(ee)}for(Y=!1;X<L.length;X++)if(!((E=L[X].x.getTime?L[X].x.getTime():L[X].x)<o.axisX.dataInfo.viewPortMin||E>o.axisX.dataInfo.viewPortMax&&(!O.connectNullData||!Y)))if("number"!=typeof L[X].y)0<X&&!Y&&(O.connectNullData?c.setLineDash&&0<nt.length&&(O.options.nullDataLineDashType||!L[X-1].lineDashType)&&(nt[nt.length-1].newLineDashArray=Tt,mt=O.nullDataLineDashType):(y(),nt=[])),Y=!0;else{E=o.axisX.convertValueToPixel(E),Y=o.axisY.convertValueToPixel(L[X].y);var Ft=O.dataPointIds[X];if(this._eventManager.objectMap[Ft]={id:Ft,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:X,x1:E,y1:Y},nt[nt.length]={x:E,y:Y},X<L.length-1&&(kt!==(L[X].lineColor||gt)||mt!==(L[X].lineDashType||O.lineDashType))&&(nt[nt.length-1].newStrokeStyle=kt=L[X].lineColor||gt,c.setLineDash&&(L[X].lineDashType?nt[nt.length-1].newLineDashArray=Ti(mt=L[X].lineDashType,O.lineThickness):(mt=O.lineDashType,nt[nt.length-1].newLineDashArray=ee))),0!==L[X].markerSize&&(0<L[X].markerSize||0<O.markerSize)){var vt=O.getMarkerProperties(X,E,Y,c);k.push(vt),Ft=an(Ft),rt&&k.push({x:E,y:Y,ctx:d,type:vt.type,size:vt.size,color:Ft,borderColor:Ft,borderThickness:vt.borderThickness})}(L[X].indexLabel||O.indexLabel||L[X].indexLabelFormatter||O.indexLabelFormatter)&&this._indexLabels.push({chartType:"splineArea",dataPoint:L[X],dataSeries:O,point:{x:E,y:Y},direction:0>L[X].y===o.axisY.reversed?1:-1,color:dt}),Y=!1}y(),D.drawMarkers(k)}}return rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(C.x1,C.y1,C.width,C.height),this._eventManager.ghostCtx.restore()),c.restore(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderStepArea=function(o){var y,f;function c(){kt&&(0<E.lineThickness&&M.stroke(),o.axisY.logarithmic||0>=o.axisY.viewportMinimum&&0<=o.axisY.viewportMaximum?gt=dt:0>o.axisY.viewportMaximum?gt=C.y1:0<o.axisY.viewportMinimum&&(gt=dt),M.lineTo(J,gt),M.lineTo(kt.x,gt),M.closePath(),M.globalAlpha=E.fillOpacity,M.fill(),M.globalAlpha=1,rt&&(k.lineTo(J,gt),k.lineTo(kt.x,gt),k.closePath(),k.fill()),M.beginPath(),M.moveTo(J,q),k.beginPath(),k.moveTo(J,q),kt={x:J,y:q})}var d=o.targetCanvasCtx||this.plotArea.ctx,M=rt?this._preRenderCtx:d;if(!(0>=o.dataSeriesIndexes.length)){var O,k=this._eventManager.ghostCtx,C=o.axisY.lineCoordinates,R=[],B=this.plotArea;M.save(),rt&&k.save(),M.beginPath(),M.rect(B.x1,B.y1,B.width,B.height),M.clip(),rt&&(k.beginPath(),k.rect(B.x1,B.y1,B.width,B.height),k.clip());for(var L=0;L<o.dataSeriesIndexes.length;L++){var X=o.dataSeriesIndexes[L],E=this.data[X],Y=E.dataPoints;this._eventManager.objectMap[R=E.id]={objectType:"dataSeries",dataSeriesIndex:X},R=an(R),k.fillStyle=R,R=[],y=!0;var J,q,nt,gt,it=0,dt=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),kt=null;if(f=!1,0<Y.length){var mt=E._colorSet[it%E._colorSet.length],Tt=E.lineColor=E.options.lineColor||mt,ee=Tt;M.fillStyle=mt,M.strokeStyle=Tt,M.lineWidth=E.lineThickness;var Ft="solid";if(M.setLineDash){var vt=Ti(E.nullDataLineDashType,E.lineThickness),le=Ti(Ft=E.lineDashType,E.lineThickness);M.setLineDash(le)}for(;it<Y.length;it++)if(!((nt=Y[it].x.getTime?Y[it].x.getTime():Y[it].x)<o.axisX.dataInfo.viewPortMin||nt>o.axisX.dataInfo.viewPortMax&&(!E.connectNullData||!f))){var Ht=q;"number"!=typeof Y[it].y?(E.connectNullData||f||y||c(),f=!0):(J=o.axisX.convertValueToPixel(nt),q=o.axisY.convertValueToPixel(Y[it].y),y||f?(!y&&E.connectNullData?(M.setLineDash&&(E.options.nullDataLineDashType||Ft===E.lineDashType&&E.lineDashType!==E.nullDataLineDashType)&&(y=J,f=q,J=O.x,q=O.y,c(),M.moveTo(O.x,O.y),J=y,q=f,kt=O,Ft=E.nullDataLineDashType,M.setLineDash(vt)),M.lineTo(J,Ht),M.lineTo(J,q),rt&&(k.lineTo(J,Ht),k.lineTo(J,q))):(M.beginPath(),M.moveTo(J,q),rt&&(k.beginPath(),k.moveTo(J,q)),kt={x:J,y:q}),f=y=!1):(M.lineTo(J,Ht),rt&&k.lineTo(J,Ht),M.lineTo(J,q),rt&&k.lineTo(J,q),it%250==0&&c()),O={x:J,y:q},it<Y.length-1&&(ee!==(Y[it].lineColor||Tt)||Ft!==(Y[it].lineDashType||E.lineDashType))&&(c(),M.strokeStyle=ee=Y[it].lineColor||Tt,M.setLineDash&&(Y[it].lineDashType?M.setLineDash(Ti(Ft=Y[it].lineDashType,E.lineThickness)):(Ft=E.lineDashType,M.setLineDash(le)))),this._eventManager.objectMap[nt=E.dataPointIds[it]]={id:nt,objectType:"dataPoint",dataSeriesIndex:X,dataPointIndex:it,x1:J,y1:q},0!==Y[it].markerSize&&(0<Y[it].markerSize||0<E.markerSize)&&(Ht=E.getMarkerProperties(it,J,q,M),R.push(Ht),nt=an(nt),rt&&R.push({x:J,y:q,ctx:k,type:Ht.type,size:Ht.size,color:nt,borderColor:nt,borderThickness:Ht.borderThickness})),(Y[it].indexLabel||E.indexLabel||Y[it].indexLabelFormatter||E.indexLabelFormatter)&&this._indexLabels.push({chartType:"stepArea",dataPoint:Y[it],dataSeries:E,point:{x:J,y:q},direction:0>Y[it].y===o.axisY.reversed?1:-1,color:mt}))}c(),D.drawMarkers(R)}}return rt&&(d.drawImage(this._preRenderCanvas,0,0,this.width,this.height),M.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&M.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&M.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),M.clearRect(B.x1,B.y1,B.width,B.height),this._eventManager.ghostCtx.restore()),M.restore(),{source:d,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderStackedArea=function(o){function y(){if(!(1>B.length)){for(0<mt.lineThickness&&c.stroke();0<B.length;){var se=B.pop();c.lineTo(se.x,se.y),rt&&J.lineTo(se.x,se.y)}c.closePath(),c.globalAlpha=mt.fillOpacity,c.fill(),c.globalAlpha=1,c.beginPath(),rt&&(J.closePath(),J.fill(),J.beginPath()),B=[]}}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var E,Y,q,nt,dt,d=null,M=null,k=[],C=this.plotArea,R=[],B=[],O=[],L=[],X=0,it=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),J=this._eventManager.ghostCtx;rt&&J.beginPath(),c.save(),rt&&J.save(),c.beginPath(),c.rect(C.x1,C.y1,C.width,C.height),c.clip(),rt&&(J.beginPath(),J.rect(C.x1,C.y1,C.width,C.height),J.clip()),d=[];for(var gt=0;gt<o.dataSeriesIndexes.length;gt++){var kt=o.dataSeriesIndexes[gt],mt=this.data[kt],Tt=mt.dataPoints;for(mt.dataPointIndexes=[],X=0;X<Tt.length;X++)kt=Tt[X].x.getTime?Tt[X].x.getTime():Tt[X].x,mt.dataPointIndexes[kt]=X,d[kt]||(O.push(kt),d[kt]=!0);O.sort(pn)}for(gt=0;gt<o.dataSeriesIndexes.length;gt++){if(Tt=(mt=this.data[kt=o.dataSeriesIndexes[gt]]).dataPoints,nt=!0,B=[],this._eventManager.objectMap[X=mt.id]={objectType:"dataSeries",dataSeriesIndex:kt},X=an(X),J.fillStyle=X,0<O.length){d=mt._colorSet[0];var ee=mt.lineColor=mt.options.lineColor||d,Ft=ee;if(c.fillStyle=d,c.strokeStyle=ee,c.lineWidth=mt.lineThickness,dt="solid",c.setLineDash){var vt=Ti(mt.nullDataLineDashType,mt.lineThickness),le=Ti(dt=mt.lineDashType,mt.lineThickness);c.setLineDash(le)}var Ht=!0;for(X=0;X<O.length;X++){var jt=0<=mt.dataPointIndexes[M=O[X]]?Tt[mt.dataPointIndexes[M]]:{x:M,y:null};if(!(M<o.axisX.dataInfo.viewPortMin||M>o.axisX.dataInfo.viewPortMax&&(!mt.connectNullData||!Ht)))if("number"!=typeof jt.y)mt.connectNullData||Ht||nt||y(),Ht=!0;else{E=o.axisX.convertValueToPixel(M);var ye=R[M]?R[M]:0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length){if(L[M]=jt.y+(L[M]?L[M]:0),0>=L[M]&&o.axisY.logarithmic)continue;Y=o.axisY.convertValueToPixel(L[M])}else Y=o.axisY.convertValueToPixel(jt.y),Y-=ye;if(B.push({x:E,y:it-ye}),R[M]=it-Y,nt||Ht?(!nt&&mt.connectNullData?(c.setLineDash&&(mt.options.nullDataLineDashType||dt===mt.lineDashType&&mt.lineDashType!==mt.nullDataLineDashType)&&(nt=B.pop(),dt=B[B.length-1],y(),c.moveTo(q.x,q.y),B.push(dt),B.push(nt),dt=mt.nullDataLineDashType,c.setLineDash(vt)),c.lineTo(E,Y),rt&&J.lineTo(E,Y)):(c.beginPath(),c.moveTo(E,Y),rt&&(J.beginPath(),J.moveTo(E,Y))),Ht=nt=!1):(c.lineTo(E,Y),rt&&J.lineTo(E,Y),X%250==0&&(y(),c.moveTo(E,Y),rt&&J.moveTo(E,Y),B.push({x:E,y:it-ye}))),q={x:E,y:Y},X<Tt.length-1&&(Ft!==(Tt[X].lineColor||ee)||dt!==(Tt[X].lineDashType||mt.lineDashType))&&(y(),c.beginPath(),c.moveTo(E,Y),B.push({x:E,y:it-ye}),c.strokeStyle=Ft=Tt[X].lineColor||ee,c.setLineDash&&(Tt[X].lineDashType?c.setLineDash(Ti(dt=Tt[X].lineDashType,mt.lineThickness)):(dt=mt.lineDashType,c.setLineDash(le)))),0<=mt.dataPointIndexes[M]){var Rt=mt.dataPointIds[mt.dataPointIndexes[M]];this._eventManager.objectMap[Rt]={id:Rt,objectType:"dataPoint",dataSeriesIndex:kt,dataPointIndex:mt.dataPointIndexes[M],x1:E,y1:Y}}0<=mt.dataPointIndexes[M]&&0!==jt.markerSize&&(0<jt.markerSize||0<mt.markerSize)&&(ye=mt.getMarkerProperties(mt.dataPointIndexes[M],E,Y,c),k.push(ye),M=an(Rt),rt&&k.push({x:E,y:Y,ctx:J,type:ye.type,size:ye.size,color:M,borderColor:M,borderThickness:ye.borderThickness})),(jt.indexLabel||mt.indexLabel||jt.indexLabelFormatter||mt.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedArea",dataPoint:jt,dataSeries:mt,point:{x:E,y:Y},direction:0>Tt[X].y===o.axisY.reversed?1:-1,color:d})}}y(),c.moveTo(E,Y),rt&&J.moveTo(E,Y)}delete mt.dataPointIndexes}return D.drawMarkers(k),rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(C.x1,C.y1,C.width,C.height),J.restore()),c.restore(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderStackedArea100=function(o){function y(){for(0<mt.lineThickness&&c.stroke();0<B.length;){var Ue=B.pop();c.lineTo(Ue.x,Ue.y),rt&&dt.lineTo(Ue.x,Ue.y)}c.closePath(),c.globalAlpha=mt.fillOpacity,c.fill(),c.globalAlpha=1,c.beginPath(),rt&&(dt.closePath(),dt.fill(),dt.beginPath()),B=[]}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var E,Y,it,J,q,d=null,M=null,k=this.plotArea,C=[],R=[],B=[],O=[],L=[],X=0,nt=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0),dt=this._eventManager.ghostCtx;c.save(),rt&&dt.save(),c.beginPath(),c.rect(k.x1,k.y1,k.width,k.height),c.clip(),rt&&(dt.beginPath(),dt.rect(k.x1,k.y1,k.width,k.height),dt.clip()),d=[];for(var gt=0;gt<o.dataSeriesIndexes.length;gt++){var kt=o.dataSeriesIndexes[gt],mt=this.data[kt],Tt=mt.dataPoints;for(mt.dataPointIndexes=[],X=0;X<Tt.length;X++)kt=Tt[X].x.getTime?Tt[X].x.getTime():Tt[X].x,mt.dataPointIndexes[kt]=X,d[kt]||(O.push(kt),d[kt]=!0);O.sort(pn)}for(gt=0;gt<o.dataSeriesIndexes.length;gt++){if(Tt=(mt=this.data[kt=o.dataSeriesIndexes[gt]]).dataPoints,J=!0,this._eventManager.objectMap[d=mt.id]={objectType:"dataSeries",dataSeriesIndex:kt},d=an(d),dt.fillStyle=d,B=[],0<O.length){d=mt._colorSet[X%mt._colorSet.length];var ee=mt.lineColor=mt.options.lineColor||d,Ft=ee;if(c.fillStyle=d,c.strokeStyle=ee,c.lineWidth=mt.lineThickness,q="solid",c.setLineDash){var vt=Ti(mt.nullDataLineDashType,mt.lineThickness),le=Ti(q=mt.lineDashType,mt.lineThickness);c.setLineDash(le)}var Ht=!0;for(X=0;X<O.length;X++){var jt=0<=mt.dataPointIndexes[M=O[X]]?Tt[mt.dataPointIndexes[M]]:{x:M,y:null};if(!(M<o.axisX.dataInfo.viewPortMin||M>o.axisX.dataInfo.viewPortMax&&(!mt.connectNullData||!Ht)))if("number"!=typeof jt.y)mt.connectNullData||Ht||J||y(),Ht=!0;else{var ye;ye=0!==o.dataPointYSums[M]?jt.y/o.dataPointYSums[M]*100:0,E=o.axisX.convertValueToPixel(M);var Rt=R[M]?R[M]:0;if(o.axisY.logarithmic||o.axisY.scaleBreaks&&0<o.axisY.scaleBreaks._appliedBreaks.length){if(L[M]=ye+(L[M]?L[M]:0),0>=L[M]&&o.axisY.logarithmic)continue;Y=o.axisY.convertValueToPixel(L[M])}else Y=o.axisY.convertValueToPixel(ye),Y-=Rt;if(B.push({x:E,y:nt-Rt}),R[M]=nt-Y,J||Ht?(!J&&mt.connectNullData?(c.setLineDash&&(mt.options.nullDataLineDashType||q===mt.lineDashType&&mt.lineDashType!==mt.nullDataLineDashType)&&(J=B.pop(),q=B[B.length-1],y(),c.moveTo(it.x,it.y),B.push(q),B.push(J),q=mt.nullDataLineDashType,c.setLineDash(vt)),c.lineTo(E,Y),rt&&dt.lineTo(E,Y)):(c.beginPath(),c.moveTo(E,Y),rt&&(dt.beginPath(),dt.moveTo(E,Y))),Ht=J=!1):(c.lineTo(E,Y),rt&&dt.lineTo(E,Y),X%250==0&&(y(),c.moveTo(E,Y),rt&&dt.moveTo(E,Y),B.push({x:E,y:nt-Rt}))),it={x:E,y:Y},X<Tt.length-1&&(Ft!==(Tt[X].lineColor||ee)||q!==(Tt[X].lineDashType||mt.lineDashType))&&(y(),c.beginPath(),c.moveTo(E,Y),B.push({x:E,y:nt-Rt}),c.strokeStyle=Ft=Tt[X].lineColor||ee,c.setLineDash&&(Tt[X].lineDashType?c.setLineDash(Ti(q=Tt[X].lineDashType,mt.lineThickness)):(q=mt.lineDashType,c.setLineDash(le)))),0<=mt.dataPointIndexes[M]){var se=mt.dataPointIds[mt.dataPointIndexes[M]];this._eventManager.objectMap[se]={id:se,objectType:"dataPoint",dataSeriesIndex:kt,dataPointIndex:mt.dataPointIndexes[M],x1:E,y1:Y}}0<=mt.dataPointIndexes[M]&&0!==jt.markerSize&&(0<jt.markerSize||0<mt.markerSize)&&(Rt=mt.getMarkerProperties(X,E,Y,c),C.push(Rt),M=an(se),rt&&C.push({x:E,y:Y,ctx:dt,type:Rt.type,size:Rt.size,color:M,borderColor:M,borderThickness:Rt.borderThickness})),(jt.indexLabel||mt.indexLabel||jt.indexLabelFormatter||mt.indexLabelFormatter)&&this._indexLabels.push({chartType:"stackedArea100",dataPoint:jt,dataSeries:mt,point:{x:E,y:Y},direction:0>Tt[X].y===o.axisY.reversed?1:-1,color:d})}}y(),c.moveTo(E,Y),rt&&dt.moveTo(E,Y)}delete mt.dataPointIndexes}return D.drawMarkers(C),rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(k.x1,k.y1,k.width,k.height),dt.restore()),c.restore(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderBubble=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,c=this.plotArea,d=0;f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(c.x1,c.y1,c.width,c.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.clip());for(var C=-1/0,R=1/0,B=0;B<o.dataSeriesIndexes.length;B++){var O=o.dataSeriesIndexes[B],L=this.data[O],X=L.dataPoints,E=0;for(d=0;d<X.length;d++)(M=M=X[d].getTime?X[d].x.getTime():X[d].x)<o.axisX.dataInfo.viewPortMin||M>o.axisX.dataInfo.viewPortMax||typeof X[d].z>"u"||((E=X[d].z)>C&&(C=E),E<R&&(R=E))}var Y=25*Math.PI,it=Math.max(Math.pow(.25*Math.min(c.height,c.width)/2,2)*Math.PI,Y);for(B=0;B<o.dataSeriesIndexes.length;B++)if(0<(X=(L=this.data[O=o.dataSeriesIndexes[B]]).dataPoints).length)for(f.strokeStyle="#4572A7 ",d=0;d<X.length;d++)if(!((M=M=X[d].getTime?X[d].x.getTime():X[d].x)<o.axisX.dataInfo.viewPortMin||M>o.axisX.dataInfo.viewPortMax)&&"number"==typeof X[d].y){M=o.axisX.convertValueToPixel(M),k=o.axisY.convertValueToPixel(X[d].y),E=X[d].z;var J=2*Math.max(Math.sqrt((C===R?it/2:Y+(it-Y)/(C-R)*(E-R))/Math.PI)<<0,1);(E=L.getMarkerProperties(d,f)).size=J,f.globalAlpha=L.fillOpacity,D.drawMarker(M,k,f,E.type,E.size,E.color,E.borderColor,E.borderThickness),f.globalAlpha=1;var q=L.dataPointIds[d];this._eventManager.objectMap[q]={id:q,objectType:"dataPoint",dataSeriesIndex:O,dataPointIndex:d,x1:M,y1:k,size:J},J=an(q),rt&&D.drawMarker(M,k,this._eventManager.ghostCtx,E.type,E.size,J,J,E.borderThickness),(X[d].indexLabel||L.indexLabel||X[d].indexLabelFormatter||L.indexLabelFormatter)&&this._indexLabels.push({chartType:"bubble",dataPoint:X[d],dataSeries:L,point:{x:M,y:k},direction:1,bounds:{x1:M-E.size/2,y1:k-E.size/2,x2:M+E.size/2,y2:k+E.size/2},color:null})}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderScatter=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,c=this.plotArea,d=0;f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(c.x1,c.y1,c.width,c.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.clip());for(var C=0;C<o.dataSeriesIndexes.length;C++){var R=o.dataSeriesIndexes[C],B=this.data[R],O=B.dataPoints;if(0<O.length){f.strokeStyle="#4572A7 ",Math.pow(.3*Math.min(c.height,c.width)/2,2);var L=0,X=0;for(d=0;d<O.length;d++)if(!((M=M=O[d].getTime?O[d].x.getTime():O[d].x)<o.axisX.dataInfo.viewPortMin||M>o.axisX.dataInfo.viewPortMax)&&"number"==typeof O[d].y){M=o.axisX.convertValueToPixel(M),k=o.axisY.convertValueToPixel(O[d].y);var E=B.getMarkerProperties(d,M,k,f);f.globalAlpha=B.fillOpacity,D.drawMarker(E.x,E.y,E.ctx,E.type,E.size,E.color,E.borderColor,E.borderThickness),f.globalAlpha=1,Math.sqrt((L-M)*(L-M)+(X-k)*(X-k))<Math.min(E.size,5)&&O.length>Math.min(this.plotArea.width,this.plotArea.height)||(this._eventManager.objectMap[L=B.dataPointIds[d]]={id:L,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:d,x1:M,y1:k},L=an(L),rt&&D.drawMarker(E.x,E.y,this._eventManager.ghostCtx,E.type,E.size,L,L,E.borderThickness),(O[d].indexLabel||B.indexLabel||O[d].indexLabelFormatter||B.indexLabelFormatter)&&this._indexLabels.push({chartType:"scatter",dataPoint:O[d],dataSeries:B,point:{x:M,y:k},direction:1,bounds:{x1:M-E.size/2,y1:k-E.size/2,x2:M+E.size/2,y2:k+E.size/2},color:null}),L=M,X=k)}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(c.x1,c.y1,c.width,c.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderCandlestick=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y,c=this._eventManager.ghostCtx;if(!(0>=o.dataSeriesIndexes.length)){var k,C,R,B,O,L,X=null,E=null,d=this.plotArea,M=0,Y=(X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,E=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.015*this.width,o.axisX.dataInfo.minDiff);isFinite(Y)||(Y=.3*Math.abs(o.axisX.range)),Y=this.options.dataPointWidth?this.dataPointWidth:.7*d.width*(o.axisX.logarithmic?Math.log(Y)/Math.log(o.axisX.range):Math.abs(Y)/Math.abs(o.axisX.range))<<0,this.dataPointMaxWidth&&X>E&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,E)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&E<X&&(E=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),Y<X&&(Y=X),Y>E&&(Y=E),f.save(),rt&&c.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(c.beginPath(),c.rect(d.x1,d.y1,d.width,d.height),c.clip());for(var it=0;it<o.dataSeriesIndexes.length;it++){var J=o.dataSeriesIndexes[it],q=this.data[J],nt=q.dataPoints;if(0<nt.length){var dt=!!(5<Y&&q.bevelEnabled);for(M=0;M<nt.length;M++)if(!((L=nt[M].getTime?nt[M].x.getTime():nt[M].x)<o.axisX.dataInfo.viewPortMin||L>o.axisX.dataInfo.viewPortMax)&&!Et(nt[M].y)&&nt[M].y.length&&"number"==typeof nt[M].y[0]&&"number"==typeof nt[M].y[1]&&"number"==typeof nt[M].y[2]&&"number"==typeof nt[M].y[3]){k=o.axisX.convertValueToPixel(L),C=o.axisY.convertValueToPixel(nt[M].y[0]),R=o.axisY.convertValueToPixel(nt[M].y[1]),B=o.axisY.convertValueToPixel(nt[M].y[2]),O=o.axisY.convertValueToPixel(nt[M].y[3]);var gt=k-Y/2<<0,kt=gt+Y<<0,mt=(E=q.options.fallingColor?q.fallingColor:q._colorSet[0],X=nt[M].color?nt[M].color:q._colorSet[0],Math.round(Math.max(1,.15*Y))),Tt=mt%2==0?0:.5,ee=q.dataPointIds[M];this._eventManager.objectMap[ee]={id:ee,objectType:"dataPoint",dataSeriesIndex:J,dataPointIndex:M,x1:gt,y1:C,x2:kt,y2:R,x3:k,y3:B,x4:k,y4:O,borderThickness:mt,color:X},f.strokeStyle=X,f.beginPath(),f.lineWidth=mt,c.lineWidth=Math.max(mt,4),"candlestick"===q.type?(f.moveTo(k-Tt,R),f.lineTo(k-Tt,Math.min(C,O)),f.stroke(),f.moveTo(k-Tt,Math.max(C,O)),f.lineTo(k-Tt,B),f.stroke(),is(f,gt,Math.min(C,O),kt,Math.max(C,O),nt[M].y[0]<=nt[M].y[3]?q.risingColor:E,mt,X,dt,dt,!1,!1,q.fillOpacity),rt&&(X=an(ee),c.strokeStyle=X,c.moveTo(k-Tt,R),c.lineTo(k-Tt,Math.min(C,O)),c.stroke(),c.moveTo(k-Tt,Math.max(C,O)),c.lineTo(k-Tt,B),c.stroke(),is(c,gt,Math.min(C,O),kt,Math.max(C,O),X,0,null,!1,!1,!1,!1))):"ohlc"===q.type&&(f.moveTo(k-Tt,R),f.lineTo(k-Tt,B),f.stroke(),f.beginPath(),f.moveTo(k,C),f.lineTo(gt,C),f.stroke(),f.beginPath(),f.moveTo(k,O),f.lineTo(kt,O),f.stroke(),rt&&(X=an(ee),c.strokeStyle=X,c.moveTo(k-Tt,R),c.lineTo(k-Tt,B),c.stroke(),c.beginPath(),c.moveTo(k,C),c.lineTo(gt,C),c.stroke(),c.beginPath(),c.moveTo(k,O),c.lineTo(kt,O),c.stroke())),(nt[M].indexLabel||q.indexLabel||nt[M].indexLabelFormatter||q.indexLabelFormatter)&&this._indexLabels.push({chartType:q.type,dataPoint:nt[M],dataSeries:q,point:{x:gt+(kt-gt)/2,y:o.axisY.reversed?B:R},direction:1,bounds:{x1:gt,y1:Math.min(R,B),x2:kt,y2:Math.max(R,B)},color:X})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),c.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderBoxAndWhisker=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y,c=this._eventManager.ghostCtx;if(!(0>=o.dataSeriesIndexes.length)){var M,k,C,R,B,O,L,X=null,d=this.plotArea,E=0,Y=(X=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,E=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.015*this.width,o.axisX.dataInfo.minDiff);isFinite(Y)||(Y=.3*Math.abs(o.axisX.range)),Y=this.options.dataPointWidth?this.dataPointWidth:.7*d.width*(o.axisX.logarithmic?Math.log(Y)/Math.log(o.axisX.range):Math.abs(Y)/Math.abs(o.axisX.range))<<0,this.dataPointMaxWidth&&X>E&&(X=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,E)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&E<X&&(E=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,X)),Y<X&&(Y=X),Y>E&&(Y=E),f.save(),rt&&c.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(c.beginPath(),c.rect(d.x1,d.y1,d.width,d.height),c.clip());for(var it=!!o.axisY.reversed,J=0;J<o.dataSeriesIndexes.length;J++){var q=o.dataSeriesIndexes[J],nt=this.data[q],dt=nt.dataPoints;if(0<dt.length){var gt=!!(5<Y&&nt.bevelEnabled);for(E=0;E<dt.length;E++)if(!((L=dt[E].getTime?dt[E].x.getTime():dt[E].x)<o.axisX.dataInfo.viewPortMin||L>o.axisX.dataInfo.viewPortMax)&&!Et(dt[E].y)&&dt[E].y.length&&"number"==typeof dt[E].y[0]&&"number"==typeof dt[E].y[1]&&"number"==typeof dt[E].y[2]&&"number"==typeof dt[E].y[3]&&"number"==typeof dt[E].y[4]&&5===dt[E].y.length){M=o.axisX.convertValueToPixel(L),k=o.axisY.convertValueToPixel(dt[E].y[0]),C=o.axisY.convertValueToPixel(dt[E].y[1]),R=o.axisY.convertValueToPixel(dt[E].y[2]),B=o.axisY.convertValueToPixel(dt[E].y[3]),O=o.axisY.convertValueToPixel(dt[E].y[4]);var kt=M-Y/2<<0,mt=M+Y/2<<0,Tt=(X=dt[E].color?dt[E].color:nt._colorSet[0],Math.round(Math.max(1,.15*Y))),ee=Tt%2==0?0:.5,Ft=dt[E].whiskerColor?dt[E].whiskerColor:dt[E].color?nt.whiskerColor?nt.whiskerColor:dt[E].color:nt.whiskerColor?nt.whiskerColor:X,vt="number"==typeof dt[E].whiskerThickness?dt[E].whiskerThickness:"number"==typeof nt.options.whiskerThickness?nt.whiskerThickness:Tt,le=dt[E].whiskerDashType?dt[E].whiskerDashType:nt.whiskerDashType,Ht="number"==typeof(Ht=Et(dt[E].whiskerLength)?Et(nt.options.whiskerLength)?Y:nt.whiskerLength:dt[E].whiskerLength)?0>=Ht?0:Ht>=Y?Y:Ht:"string"==typeof Ht?parseInt(Ht)*Y/100>Y?Y:parseInt(Ht)*Y/100:Y,jt=Math.round(vt)%2==1?.5:0,ye=dt[E].stemColor?dt[E].stemColor:dt[E].color?nt.stemColor?nt.stemColor:dt[E].color:nt.stemColor?nt.stemColor:X,Rt="number"==typeof dt[E].stemThickness?dt[E].stemThickness:"number"==typeof nt.options.stemThickness?nt.stemThickness:Tt,se=Math.round(Rt)%2==1?.5:0,Ue=dt[E].stemDashType?dt[E].stemDashType:nt.stemDashType,ni=dt[E].lineColor?dt[E].lineColor:dt[E].color?nt.lineColor?nt.lineColor:dt[E].color:nt.lineColor?nt.lineColor:X,li="number"==typeof dt[E].lineThickness?dt[E].lineThickness:"number"==typeof nt.options.lineThickness?nt.lineThickness:Tt,$i=dt[E].lineDashType?dt[E].lineDashType:nt.lineDashType,wi=Math.round(li)%2==1?.5:0,wn=nt.upperBoxColor,Ni=nt.lowerBoxColor,ji=Et(nt.options.fillOpacity)?1:nt.fillOpacity,_e=nt.dataPointIds[E];this._eventManager.objectMap[_e]={id:_e,objectType:"dataPoint",dataSeriesIndex:q,dataPointIndex:E,x1:kt,y1:k,x2:mt,y2:C,x3:M,y3:R,x4:M,y4:B,y5:O,borderThickness:Tt,color:X,stemThickness:Rt,stemColor:ye,whiskerThickness:vt,whiskerLength:Ht,whiskerColor:Ft,lineThickness:li,lineColor:ni},f.save(),0<Rt&&(f.beginPath(),f.strokeStyle=ye,f.lineWidth=Rt,f.setLineDash&&f.setLineDash(Ti(Ue,Rt)),f.moveTo(M-se,C),f.lineTo(M-se,k),f.stroke(),f.moveTo(M-se,B),f.lineTo(M-se,R),f.stroke()),f.restore(),c.lineWidth=Math.max(Tt,4),f.beginPath(),is(f,kt,Math.min(O,C),mt,Math.max(C,O),Ni,0,X,!!it&&gt,!it&&gt,!1,!1,ji),f.beginPath(),is(f,kt,Math.min(R,O),mt,Math.max(O,R),wn,0,X,!it&&gt,!!it&&gt,!1,!1,ji),f.beginPath(),f.lineWidth=Tt,f.strokeStyle=X,f.rect(kt-ee,Math.min(C,R)-ee,mt-kt+2*ee,Math.max(C,R)-Math.min(C,R)+2*ee),f.stroke(),f.save(),0<li&&(f.beginPath(),f.globalAlpha=1,f.setLineDash&&f.setLineDash(Ti($i,li)),f.strokeStyle=ni,f.lineWidth=li,f.moveTo(kt,O-wi),f.lineTo(mt,O-wi),f.stroke()),f.restore(),f.save(),0<vt&&(f.beginPath(),f.setLineDash&&f.setLineDash(Ti(le,vt)),f.strokeStyle=Ft,f.lineWidth=vt,f.moveTo(M-Ht/2<<0,B-jt),f.lineTo(M+Ht/2<<0,B-jt),f.stroke(),f.moveTo(M-Ht/2<<0,k+jt),f.lineTo(M+Ht/2<<0,k+jt),f.stroke()),f.restore(),rt&&(X=an(_e),c.strokeStyle=X,c.lineWidth=Rt,0<Rt&&(c.moveTo(M-ee-se,C),c.lineTo(M-ee-se,Math.max(k,B)),c.stroke(),c.moveTo(M-ee-se,Math.min(k,B)),c.lineTo(M-ee-se,R),c.stroke()),is(c,kt,Math.max(C,R),mt,Math.min(C,R),X,0,null,!1,!1,!1,!1),0<vt&&(c.beginPath(),c.lineWidth=vt,c.moveTo(M+Ht/2,B-jt),c.lineTo(M-Ht/2,B-jt),c.stroke(),c.moveTo(M+Ht/2,k+jt),c.lineTo(M-Ht/2,k+jt),c.stroke())),(dt[E].indexLabel||nt.indexLabel||dt[E].indexLabelFormatter||nt.indexLabelFormatter)&&this._indexLabels.push({chartType:nt.type,dataPoint:dt[E],dataSeries:nt,point:{x:kt+(mt-kt)/2,y:o.axisY.reversed?k:B},direction:1,bounds:{x1:kt,y1:Math.min(k,B),x2:mt,y2:Math.max(k,B)},color:X})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),c.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderRangeColumn=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,C,c=null,d=this.plotArea,R=0;R=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,M=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:.03*this.width;var B=o.axisX.dataInfo.minDiff;isFinite(B)||(B=.3*Math.abs(o.axisX.range)),B=this.options.dataPointWidth?this.dataPointWidth:d.width*(o.axisX.logarithmic?Math.log(B)/Math.log(o.axisX.range):Math.abs(B)/Math.abs(o.axisX.range))/o.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&R>M&&(R=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,M)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&M<R&&(M=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,R)),B<R&&(B=R),B>M&&(B=M),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var O=0;O<o.dataSeriesIndexes.length;O++){var L=o.dataSeriesIndexes[O],X=this.data[L],E=X.dataPoints;if(0<E.length){var Y=!!(5<B&&X.bevelEnabled);for(R=0;R<E.length;R++)if(!((C=E[R].getTime?E[R].x.getTime():E[R].x)<o.axisX.dataInfo.viewPortMin||C>o.axisX.dataInfo.viewPortMax)&&!Et(E[R].y)&&E[R].y.length&&"number"==typeof E[R].y[0]&&"number"==typeof E[R].y[1]){c=o.axisX.convertValueToPixel(C),M=o.axisY.convertValueToPixel(E[R].y[0]),k=o.axisY.convertValueToPixel(E[R].y[1]);var it=o.axisX.reversed?c+o.plotType.totalDataSeries*B/2-(o.previousDataSeriesCount+O)*B<<0:c-o.plotType.totalDataSeries*B/2+(o.previousDataSeriesCount+O)*B<<0,J=o.axisX.reversed?it-B<<0:it+B<<0;if(c=E[R].color?E[R].color:X._colorSet[R%X._colorSet.length],M>k){var q=M;M=k,k=q}this._eventManager.objectMap[q=X.dataPointIds[R]]={id:q,objectType:"dataPoint",dataSeriesIndex:L,dataPointIndex:R,x1:it,y1:M,x2:J,y2:k},is(f,it,M,J,k,c,0,c,Y,Y,!1,!1,X.fillOpacity),c=an(q),rt&&is(this._eventManager.ghostCtx,it,M,J,k,c,0,null,!1,!1,!1,!1),(E[R].indexLabel||X.indexLabel||E[R].indexLabelFormatter||X.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeColumn",dataPoint:E[R],dataSeries:X,indexKeyword:0,point:{x:it+(J-it)/2,y:E[R].y[1]>=E[R].y[0]?k:M},direction:E[R].y[1]>=E[R].y[0]?-1:1,bounds:{x1:it,y1:Math.min(M,k),x2:J,y2:Math.max(M,k)},color:c}),this._indexLabels.push({chartType:"rangeColumn",dataPoint:E[R],dataSeries:X,indexKeyword:1,point:{x:it+(J-it)/2,y:E[R].y[1]>=E[R].y[0]?M:k},direction:E[R].y[1]>=E[R].y[0]?1:-1,bounds:{x1:it,y1:Math.min(M,k),x2:J,y2:Math.max(M,k)},color:c}))}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderError=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y,c=!!o.axisY._position&&!("left"===o.axisY._position||"right"===o.axisY._position);if(!(0>=o.dataSeriesIndexes.length)){var R,B,O,L,X,E,Y,d=null,M=!1,k=this.plotArea,C=0,it=o.axisX.dataInfo.minDiff;isFinite(it)||(it=.3*Math.abs(o.axisX.range)),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(k.x1,k.y1,k.width,k.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(k.x1,k.y1,k.width,k.height),this._eventManager.ghostCtx.clip());for(var J=0,q=0;q<this.data.length;q++)!this.data[q].type.match(/(bar|column)/gi)||!this.data[q].visible||this.data[q].type.match(/(stacked)/gi)&&J||J++;for(var nt=0;nt<o.dataSeriesIndexes.length;nt++){var dt=o.dataSeriesIndexes[nt],gt=this.data[dt],kt=gt.dataPoints,mt=!Et(gt._linkedSeries)&&!(!gt._linkedSeries.type.match(/(bar|column)/gi)||!gt._linkedSeries.visible),Tt=0;if(mt)for(d=gt._linkedSeries.id,q=0;q<d;q++)!this.data[q].type.match(/(bar|column)/gi)||!this.data[q].visible||this.data[q].type.match(/(stacked)/gi)&&Tt||(this.data[q].type.match(/(range)/gi)&&(M=!0),Tt++);if(d=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,C=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:c?Math.min(.15*this.height,this.plotArea.height/(mt?J:1)*.9)<<0:.3*this.width,M&&(C=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:c?Math.min(.15*this.height,this.plotArea.height/(mt?J:1)*.9)<<0:.03*this.width),q=this.options.dataPointWidth?this.dataPointWidth:(c?k.height:k.width)*(o.axisX.logarithmic?Math.log(it)/Math.log(o.axisX.range):Math.abs(it)/Math.abs(o.axisX.range))/(mt?J:1)*.9<<0,this.dataPointMaxWidth&&d>C&&(d=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<d&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,d)),q<d&&(q=d),q>C&&(q=C),0<kt.length){var ee=gt._colorSet;for(C=0;C<kt.length;C++){d=gt.lineColor=gt.options.color?gt.options.color:ee[0];var Ft={color:kt[C].whiskerColor?kt[C].whiskerColor:kt[C].color?gt.whiskerColor?gt.whiskerColor:kt[C].color:gt.whiskerColor?gt.whiskerColor:d,thickness:Et(kt[C].whiskerThickness)?gt.whiskerThickness:kt[C].whiskerThickness,dashType:kt[C].whiskerDashType?kt[C].whiskerDashType:gt.whiskerDashType,length:Et(kt[C].whiskerLength)?Et(gt.options.whiskerLength)?q:gt.options.whiskerLength:kt[C].whiskerLength,trimLength:Et(kt[C].whiskerLength)&&Et(gt.options.whiskerLength)?50:0};Ft.length="number"==typeof Ft.length?0>=Ft.length?0:Ft.length>=q?q:Ft.length:"string"==typeof Ft.length?parseInt(Ft.length)*q/100>q?q:parseInt(Ft.length)*q/100>q:q,Ft.thickness="number"==typeof Ft.thickness?0>Ft.thickness?0:Math.round(Ft.thickness):2;var vt={color:kt[C].stemColor?kt[C].stemColor:kt[C].color?gt.stemColor?gt.stemColor:kt[C].color:gt.stemColor?gt.stemColor:d,thickness:kt[C].stemThickness?kt[C].stemThickness:gt.stemThickness,dashType:kt[C].stemDashType?kt[C].stemDashType:gt.stemDashType};if(vt.thickness="number"==typeof vt.thickness?0>vt.thickness?0:Math.round(vt.thickness):2,!((Y=kt[C].getTime?kt[C].x.getTime():kt[C].x)<o.axisX.dataInfo.viewPortMin||Y>o.axisX.dataInfo.viewPortMax)&&!Et(kt[C].y)&&kt[C].y.length&&"number"==typeof kt[C].y[0]&&"number"==typeof kt[C].y[1]){var le=o.axisX.convertValueToPixel(Y);c?B=le:R=le,le=o.axisY.convertValueToPixel(kt[C].y[0]),c?O=le:X=le,le=o.axisY.convertValueToPixel(kt[C].y[1]),c?L=le:E=le,c?(X=o.axisX.reversed?B+(mt?J:1)*q/2-(mt?Tt-1:0)*q<<0:B-(mt?J:1)*q/2+(mt?Tt-1:0)*q<<0,E=o.axisX.reversed?X-q<<0:X+q<<0):(O=o.axisX.reversed?R+(mt?J:1)*q/2-(mt?Tt-1:0)*q<<0:R-(mt?J:1)*q/2+(mt?Tt-1:0)*q<<0,L=o.axisX.reversed?O-q<<0:O+q<<0),!c&&X>E&&(le=X,X=E,E=le),c&&O>L&&(le=O,O=L,L=le),this._eventManager.objectMap[le=gt.dataPointIds[C]]={id:le,objectType:"dataPoint",dataSeriesIndex:dt,dataPointIndex:C,x1:Math.min(O,L),y1:Math.min(X,E),x2:Math.max(L,O),y2:Math.max(E,X),isXYSwapped:c,stemProperties:vt,whiskerProperties:Ft},yt(f,Math.min(O,L),Math.min(X,E),Math.max(L,O),Math.max(E,X),d,Ft,vt,c),rt&&yt(this._eventManager.ghostCtx,O,X,L,E,d,Ft,vt,c),(kt[C].indexLabel||gt.indexLabel||kt[C].indexLabelFormatter||gt.indexLabelFormatter)&&(this._indexLabels.push({chartType:"error",dataPoint:kt[C],dataSeries:gt,indexKeyword:0,point:{x:c?kt[C].y[1]>=kt[C].y[0]?O:L:O+(L-O)/2,y:c?X+(E-X)/2:kt[C].y[1]>=kt[C].y[0]?E:X},direction:kt[C].y[1]>=kt[C].y[0]?-1:1,bounds:{x1:c?Math.min(O,L):O,y1:c?X:Math.min(X,E),x2:c?Math.max(O,L):L,y2:c?E:Math.max(X,E)},color:d,axisSwapped:c}),this._indexLabels.push({chartType:"error",dataPoint:kt[C],dataSeries:gt,indexKeyword:1,point:{x:c?kt[C].y[1]>=kt[C].y[0]?L:O:O+(L-O)/2,y:c?X+(E-X)/2:kt[C].y[1]>=kt[C].y[0]?X:E},direction:kt[C].y[1]>=kt[C].y[0]?1:-1,bounds:{x1:c?Math.min(O,L):O,y1:c?X:Math.min(X,E),x2:c?Math.max(O,L):L,y2:c?E:Math.max(X,E)},color:d,axisSwapped:c}))}}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(k.x1,k.y1,k.width,k.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderRangeBar=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var M,k,C,R,c=null,d=this.plotArea,B=0;B=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,M=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.height,this.plotArea.height/o.plotType.totalDataSeries*.9)<<0;var O=o.axisX.dataInfo.minDiff;isFinite(O)||(O=.3*Math.abs(o.axisX.range)),O=this.options.dataPointWidth?this.dataPointWidth:d.height*(o.axisX.logarithmic?Math.log(O)/Math.log(o.axisX.range):Math.abs(O)/Math.abs(o.axisX.range))/o.plotType.totalDataSeries*.9<<0,this.dataPointMaxWidth&&B>M&&(B=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,M)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&M<B&&(M=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,B)),O<B&&(O=B),O>M&&(O=M),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(d.x1,d.y1,d.width,d.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.clip());for(var L=0;L<o.dataSeriesIndexes.length;L++){var X=o.dataSeriesIndexes[L],E=this.data[X],Y=E.dataPoints;if(0<Y.length){var it=!!(5<O&&E.bevelEnabled);for(f.strokeStyle="#4572A7 ",B=0;B<Y.length;B++)if(!((R=Y[B].getTime?Y[B].x.getTime():Y[B].x)<o.axisX.dataInfo.viewPortMin||R>o.axisX.dataInfo.viewPortMax)&&!Et(Y[B].y)&&Y[B].y.length&&"number"==typeof Y[B].y[0]&&"number"==typeof Y[B].y[1]){M=o.axisY.convertValueToPixel(Y[B].y[0]),k=o.axisY.convertValueToPixel(Y[B].y[1]),C=o.axisX.convertValueToPixel(R),C=o.axisX.reversed?C+o.plotType.totalDataSeries*O/2-(o.previousDataSeriesCount+L)*O<<0:C-o.plotType.totalDataSeries*O/2+(o.previousDataSeriesCount+L)*O<<0;var J=o.axisX.reversed?C-O<<0:C+O<<0;M>k&&(c=M,M=k,k=c),is(f,M,C,k,J,c=Y[B].color?Y[B].color:E._colorSet[B%E._colorSet.length],0,null,it,!1,!1,!1,E.fillOpacity),this._eventManager.objectMap[c=E.dataPointIds[B]]={id:c,objectType:"dataPoint",dataSeriesIndex:X,dataPointIndex:B,x1:M,y1:C,x2:k,y2:J},c=an(c),rt&&is(this._eventManager.ghostCtx,M,C,k,J,c,0,null,!1,!1,!1,!1),(Y[B].indexLabel||E.indexLabel||Y[B].indexLabelFormatter||E.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeBar",dataPoint:Y[B],dataSeries:E,indexKeyword:0,point:{x:Y[B].y[1]>=Y[B].y[0]?M:k,y:C+(J-C)/2},direction:Y[B].y[1]>=Y[B].y[0]?-1:1,bounds:{x1:Math.min(M,k),y1:C,x2:Math.max(M,k),y2:J},color:c}),this._indexLabels.push({chartType:"rangeBar",dataPoint:Y[B],dataSeries:E,indexKeyword:1,point:{x:Y[B].y[1]>=Y[B].y[0]?k:M,y:C+(J-C)/2},direction:Y[B].y[1]>=Y[B].y[0]?1:-1,bounds:{x1:Math.min(M,k),y1:C,x2:Math.max(M,k),y2:J},color:c}))}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(d.x1,d.y1,d.width,d.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}},xt.prototype.renderRangeArea=function(o){function y(){if(nt){for(var Ht=null,jt=R.length-1;0<=jt;jt--)c.lineTo((Ht=R[jt]).x,Ht.y2),d.lineTo(Ht.x,Ht.y2);if(c.closePath(),c.globalAlpha=O.fillOpacity,c.fill(),c.globalAlpha=1,d.fill(),0<O.lineThickness){for(c.beginPath(),c.moveTo(Ht.x,Ht.y2),jt=0;jt<R.length;jt++)c.lineTo((Ht=R[jt]).x,Ht.y2);for(c.moveTo(R[0].x,R[0].y1),jt=0;jt<R.length;jt++)c.lineTo((Ht=R[jt]).x,Ht.y1);c.stroke()}c.beginPath(),c.moveTo(Y,it),d.beginPath(),d.moveTo(Y,it),nt={x:Y,y:it},(R=[]).push({x:Y,y1:it,y2:J})}}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var d=this._eventManager.ghostCtx,M=[],k=this.plotArea;c.save(),rt&&d.save(),c.beginPath(),c.rect(k.x1,k.y1,k.width,k.height),c.clip(),rt&&(d.beginPath(),d.rect(k.x1,k.y1,k.width,k.height),d.clip());for(var C=0;C<o.dataSeriesIndexes.length;C++){var R=[],B=o.dataSeriesIndexes[C],O=this.data[B],L=O.dataPoints;this._eventManager.objectMap[M=O.id]={objectType:"dataSeries",dataSeriesIndex:B},M=an(M),d.fillStyle=M,M=[];var Y,it,J,q,X=!0,E=0,nt=null;if(0<L.length){var dt=O._colorSet[E%O._colorSet.length],gt=O.lineColor=O.options.lineColor||dt,kt=gt;c.fillStyle=dt,c.strokeStyle=gt,c.lineWidth=O.lineThickness;var mt="solid";if(c.setLineDash){var Tt=Ti(O.nullDataLineDashType,O.lineThickness),ee=Ti(mt=O.lineDashType,O.lineThickness);c.setLineDash(ee)}for(var Ft=!0;E<L.length;E++)if(!((q=L[E].x.getTime?L[E].x.getTime():L[E].x)<o.axisX.dataInfo.viewPortMin||q>o.axisX.dataInfo.viewPortMax&&(!O.connectNullData||!Ft)))if(null!==L[E].y&&L[E].y.length&&"number"==typeof L[E].y[0]&&"number"==typeof L[E].y[1]){if(Y=o.axisX.convertValueToPixel(q),it=o.axisY.convertValueToPixel(L[E].y[0]),J=o.axisY.convertValueToPixel(L[E].y[1]),X||Ft?(O.connectNullData&&!X?(c.setLineDash&&(O.options.nullDataLineDashType||mt===O.lineDashType&&O.lineDashType!==O.nullDataLineDashType)&&(R[R.length-1].newLineDashArray=ee,mt=O.nullDataLineDashType,c.setLineDash(Tt)),c.lineTo(Y,it),rt&&d.lineTo(Y,it),R.push({x:Y,y1:it,y2:J})):(c.beginPath(),c.moveTo(Y,it),nt={x:Y,y:it},(R=[]).push({x:Y,y1:it,y2:J}),rt&&(d.beginPath(),d.moveTo(Y,it))),Ft=X=!1):(c.lineTo(Y,it),R.push({x:Y,y1:it,y2:J}),rt&&d.lineTo(Y,it),E%250==0&&y()),this._eventManager.objectMap[q=O.dataPointIds[E]]={id:q,objectType:"dataPoint",dataSeriesIndex:B,dataPointIndex:E,x1:Y,y1:it,y2:J},E<L.length-1&&(kt!==(L[E].lineColor||gt)||mt!==(L[E].lineDashType||O.lineDashType))&&(y(),R[R.length-1].newStrokeStyle=kt=L[E].lineColor||gt,c.strokeStyle=kt,c.setLineDash&&(L[E].lineDashType?(R[R.length-1].newLineDashArray=Ti(mt=L[E].lineDashType,O.lineThickness),c.setLineDash(R[R.length-1].newLineDashArray)):(mt=O.lineDashType,R[R.length-1].newLineDashArray=ee,c.setLineDash(ee)))),0!==L[E].markerSize&&(0<L[E].markerSize||0<O.markerSize)){var vt=O.getMarkerProperties(E,Y,J,c);M.push(vt);var le=an(q);rt&&M.push({x:Y,y:J,ctx:d,type:vt.type,size:vt.size,color:le,borderColor:le,borderThickness:vt.borderThickness}),vt=O.getMarkerProperties(E,Y,it,c),M.push(vt),le=an(q),rt&&M.push({x:Y,y:it,ctx:d,type:vt.type,size:vt.size,color:le,borderColor:le,borderThickness:vt.borderThickness})}(L[E].indexLabel||O.indexLabel||L[E].indexLabelFormatter||O.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeArea",dataPoint:L[E],dataSeries:O,indexKeyword:0,point:{x:Y,y:it},direction:L[E].y[0]>L[E].y[1]===o.axisY.reversed?-1:1,color:dt}),this._indexLabels.push({chartType:"rangeArea",dataPoint:L[E],dataSeries:O,indexKeyword:1,point:{x:Y,y:J},direction:L[E].y[0]>L[E].y[1]===o.axisY.reversed?1:-1,color:dt}))}else Ft||X||y(),Ft=!0;y(),D.drawMarkers(M)}}return rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(k.x1,k.y1,k.width,k.height),this._eventManager.ghostCtx.restore()),c.restore(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderRangeSplineArea=function(o){function y(vt,le){var Ht=Pt(it,2);if(0<Ht.length){if(0<B.lineThickness){c.strokeStyle=le,c.setLineDash&&c.setLineDash(vt),c.beginPath(),c.moveTo(Ht[0].x,Ht[0].y);for(var jt=0;jt<Ht.length-3;jt+=3)(Ht[jt].newStrokeStyle||Ht[jt].newLineDashArray)&&(c.stroke(),c.beginPath(),c.moveTo(Ht[jt].x,Ht[jt].y),Ht[jt].newStrokeStyle&&(c.strokeStyle=Ht[jt].newStrokeStyle),Ht[jt].newLineDashArray&&c.setLineDash(Ht[jt].newLineDashArray)),c.bezierCurveTo(Ht[jt+1].x,Ht[jt+1].y,Ht[jt+2].x,Ht[jt+2].y,Ht[jt+3].x,Ht[jt+3].y)}for(c.beginPath(),c.moveTo(Ht[0].x,Ht[0].y),rt&&(d.beginPath(),d.moveTo(Ht[0].x,Ht[0].y)),jt=0;jt<Ht.length-3;jt+=3)c.bezierCurveTo(Ht[jt+1].x,Ht[jt+1].y,Ht[jt+2].x,Ht[jt+2].y,Ht[jt+3].x,Ht[jt+3].y),rt&&d.bezierCurveTo(Ht[jt+1].x,Ht[jt+1].y,Ht[jt+2].x,Ht[jt+2].y,Ht[jt+3].x,Ht[jt+3].y);for(Ht=Pt(J,2),c.lineTo(J[J.length-1].x,J[J.length-1].y),jt=Ht.length-1;2<jt;jt-=3)c.bezierCurveTo(Ht[jt-1].x,Ht[jt-1].y,Ht[jt-2].x,Ht[jt-2].y,Ht[jt-3].x,Ht[jt-3].y),rt&&d.bezierCurveTo(Ht[jt-1].x,Ht[jt-1].y,Ht[jt-2].x,Ht[jt-2].y,Ht[jt-3].x,Ht[jt-3].y);if(c.closePath(),c.globalAlpha=B.fillOpacity,c.fill(),rt&&(d.closePath(),d.fill()),c.globalAlpha=1,0<B.lineThickness){c.strokeStyle=le,c.setLineDash&&c.setLineDash(vt),c.beginPath(),c.moveTo(Ht[0].x,Ht[0].y);for(var ye=jt=0;jt<Ht.length-3;jt+=3,ye++)(it[ye].newStrokeStyle||it[ye].newLineDashArray)&&(c.stroke(),c.beginPath(),c.moveTo(Ht[jt].x,Ht[jt].y),it[ye].newStrokeStyle&&(c.strokeStyle=it[ye].newStrokeStyle),it[ye].newLineDashArray&&c.setLineDash(it[ye].newLineDashArray)),c.bezierCurveTo(Ht[jt+1].x,Ht[jt+1].y,Ht[jt+2].x,Ht[jt+2].y,Ht[jt+3].x,Ht[jt+3].y);for(Ht=Pt(it,2),c.moveTo(Ht[0].x,Ht[0].y),ye=jt=0;jt<Ht.length-3;jt+=3,ye++)(it[ye].newStrokeStyle||it[ye].newLineDashArray)&&(c.stroke(),c.beginPath(),c.moveTo(Ht[jt].x,Ht[jt].y),it[ye].newStrokeStyle&&(c.strokeStyle=it[ye].newStrokeStyle),it[ye].newLineDashArray&&c.setLineDash(it[ye].newLineDashArray)),c.bezierCurveTo(Ht[jt+1].x,Ht[jt+1].y,Ht[jt+2].x,Ht[jt+2].y,Ht[jt+3].x,Ht[jt+3].y);c.stroke()}c.beginPath()}}var f=o.targetCanvasCtx||this.plotArea.ctx,c=rt?this._preRenderCtx:f;if(!(0>=o.dataSeriesIndexes.length)){var d=this._eventManager.ghostCtx,M=[],k=this.plotArea;c.save(),rt&&d.save(),c.beginPath(),c.rect(k.x1,k.y1,k.width,k.height),c.clip(),rt&&(d.beginPath(),d.rect(k.x1,k.y1,k.width,k.height),d.clip());for(var C=0;C<o.dataSeriesIndexes.length;C++){var R=o.dataSeriesIndexes[C],B=this.data[R],O=B.dataPoints;this._eventManager.objectMap[M=B.id]={objectType:"dataSeries",dataSeriesIndex:R},M=an(M),d.fillStyle=M,M=[];var X,E,Y,L=0,it=[],J=[];if(0<O.length){var q=B._colorSet[L%B._colorSet.length],nt=B.lineColor=B.options.lineColor||q,dt=nt;c.fillStyle=q,c.lineWidth=B.lineThickness;var kt,gt="solid";if(c.setLineDash){var mt=Ti(B.nullDataLineDashType,B.lineThickness);kt=Ti(gt=B.lineDashType,B.lineThickness)}for(E=!1;L<O.length;L++)if(!((X=O[L].x.getTime?O[L].x.getTime():O[L].x)<o.axisX.dataInfo.viewPortMin||X>o.axisX.dataInfo.viewPortMax&&(!B.connectNullData||!E)))if(null!==O[L].y&&O[L].y.length&&"number"==typeof O[L].y[0]&&"number"==typeof O[L].y[1]){X=o.axisX.convertValueToPixel(X),E=o.axisY.convertValueToPixel(O[L].y[0]),Y=o.axisY.convertValueToPixel(O[L].y[1]);var Tt=B.dataPointIds[L];if(this._eventManager.objectMap[Tt]={id:Tt,objectType:"dataPoint",dataSeriesIndex:R,dataPointIndex:L,x1:X,y1:E,y2:Y},it[it.length]={x:X,y:E},J[J.length]={x:X,y:Y},L<O.length-1&&(dt!==(O[L].lineColor||nt)||gt!==(O[L].lineDashType||B.lineDashType))&&(it[it.length-1].newStrokeStyle=dt=O[L].lineColor||nt,c.setLineDash&&(O[L].lineDashType?it[it.length-1].newLineDashArray=Ti(gt=O[L].lineDashType,B.lineThickness):(gt=B.lineDashType,it[it.length-1].newLineDashArray=kt))),0!==O[L].markerSize&&(0<O[L].markerSize||0<B.markerSize)){var ee=B.getMarkerProperties(L,X,E,c);M.push(ee);var Ft=an(Tt);rt&&M.push({x:X,y:E,ctx:d,type:ee.type,size:ee.size,color:Ft,borderColor:Ft,borderThickness:ee.borderThickness}),ee=B.getMarkerProperties(L,X,Y,c),M.push(ee),Ft=an(Tt),rt&&M.push({x:X,y:Y,ctx:d,type:ee.type,size:ee.size,color:Ft,borderColor:Ft,borderThickness:ee.borderThickness})}(O[L].indexLabel||B.indexLabel||O[L].indexLabelFormatter||B.indexLabelFormatter)&&(this._indexLabels.push({chartType:"rangeSplineArea",dataPoint:O[L],dataSeries:B,indexKeyword:0,point:{x:X,y:E},direction:O[L].y[0]<=O[L].y[1]?-1:1,color:q}),this._indexLabels.push({chartType:"rangeSplineArea",dataPoint:O[L],dataSeries:B,indexKeyword:1,point:{x:X,y:Y},direction:O[L].y[0]<=O[L].y[1]?1:-1,color:q})),E=!1}else 0<L&&!E&&(B.connectNullData?c.setLineDash&&0<it.length&&(B.options.nullDataLineDashType||!O[L-1].lineDashType)&&(it[it.length-1].newLineDashArray=mt,gt=B.nullDataLineDashType):(y(kt,nt),it=[],J=[])),E=!0;y(kt,nt),D.drawMarkers(M)}}return rt&&(f.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&c.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&c.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),c.clearRect(k.x1,k.y1,k.width,k.height),this._eventManager.ghostCtx.restore()),c.restore(),{source:f,dest:this.plotArea.ctx,animationCallback:w.xClipAnimation,easingFunction:w.easing.linear,animationBase:0}}},xt.prototype.renderWaterfall=function(o){var y=o.targetCanvasCtx||this.plotArea.ctx,f=rt?this._preRenderCtx:y;if(!(0>=o.dataSeriesIndexes.length)){var k,C,R,B,c=this._eventManager.ghostCtx,d=null,M=this.plotArea,L=0,O=o.axisY.convertValueToPixel(o.axisY.logarithmic?o.axisY.viewportMinimum:0);L=this.options.dataPointMinWidth?this.dataPointMinWidth:this.options.dataPointWidth?this.dataPointWidth:1,C=this.options.dataPointMaxWidth?this.dataPointMaxWidth:this.options.dataPointWidth?this.dataPointWidth:Math.min(.15*this.width,this.plotArea.width/o.plotType.totalDataSeries*.9)<<0;var X=o.axisX.dataInfo.minDiff;isFinite(X)||(X=.3*Math.abs(o.axisX.range)),X=this.options.dataPointWidth?this.dataPointWidth:M.width*(o.axisX.logarithmic?Math.log(X)/Math.log(o.axisX.range):Math.abs(X)/Math.abs(o.axisX.range))/o.plotType.totalDataSeries*.6<<0,this.dataPointMaxWidth&&L>C&&(L=Math.min(this.options.dataPointWidth?this.dataPointWidth:1/0,C)),!this.dataPointMaxWidth&&this.dataPointMinWidth&&C<L&&(C=Math.max(this.options.dataPointWidth?this.dataPointWidth:-1/0,L)),X<L&&(X=L),X>C&&(X=C),f.save(),rt&&this._eventManager.ghostCtx.save(),f.beginPath(),f.rect(M.x1,M.y1,M.width,M.height),f.clip(),rt&&(this._eventManager.ghostCtx.beginPath(),this._eventManager.ghostCtx.rect(M.x1,M.y1,M.width,M.height),this._eventManager.ghostCtx.clip());for(var E=0;E<o.dataSeriesIndexes.length;E++){var Y=o.dataSeriesIndexes[E],it=this.data[Y],J=it.dataPoints;d=it._colorSet[0],it.risingColor=it.options.risingColor?it.options.risingColor:d,it.fallingColor=it.options.fallingColor?it.options.fallingColor:"#e40a0a";var q="number"==typeof it.options.lineThickness?Math.round(it.lineThickness):1,nt=Math.round(q)%2==1?-.5:0;if(0<J.length){var dt=!!(5<X&&it.bevelEnabled),gt=!1,kt=null,mt=null;for(L=0;L<J.length;L++)if(B=J[L].getTime?J[L].x.getTime():J[L].x,"number"!=typeof J[L].y){if(0<L&&!gt&&it.connectNullData)var Tt=it.options.nullDataLineDashType||!J[L-1].lineDashType?it.nullDataLineDashType:J[L-1].lineDashType;gt=!0}else{k=o.axisX.convertValueToPixel(B),C=0===it.dataPointEOs[L].cumulativeSum?O:o.axisY.convertValueToPixel(it.dataPointEOs[L].cumulativeSum),R=0===it.dataPointEOs[L].cumulativeSumYStartValue?O:o.axisY.convertValueToPixel(it.dataPointEOs[L].cumulativeSumYStartValue),k=o.axisX.reversed?k+o.plotType.totalDataSeries*X/2-(o.previousDataSeriesCount+E)*X<<0:k-o.plotType.totalDataSeries*X/2+(o.previousDataSeriesCount+E)*X<<0;var ee=o.axisX.reversed?k-X<<0:k+X<<0;C>R&&(d=C,C=R,R=d),o.axisY.reversed&&(d=C,C=R,R=d),this._eventManager.objectMap[d=it.dataPointIds[L]]={id:d,objectType:"dataPoint",dataSeriesIndex:Y,dataPointIndex:L,x1:k,y1:C,x2:ee,y2:R},is(f,k,C,ee,R,vt=J[L].color?J[L].color:0<J[L].y?it.risingColor:it.fallingColor,0,vt,dt,dt,!1,!1,it.fillOpacity),d=an(d),rt&&is(this._eventManager.ghostCtx,k,C,ee,R,d,0,null,!1,!1,!1,!1);var Ft,vt=k;Ft=typeof J[L].isIntermediateSum<"u"&&!0===J[L].isIntermediateSum||typeof J[L].isCumulativeSum<"u"&&!0===J[L].isCumulativeSum?0<J[L].y?C:R:0<J[L].y?R:C,0<L&&kt&&(!gt||it.connectNullData)&&(gt&&f.setLineDash&&f.setLineDash(Ti(Tt,q)),f.beginPath(),f.moveTo(kt,mt-nt),f.lineTo(vt,Ft-nt),0<q&&f.stroke(),rt&&(c.beginPath(),c.moveTo(kt,mt-nt),c.lineTo(vt,Ft-nt),0<q&&c.stroke())),gt=!1,kt=ee,mt=0<J[L].y?C:R,vt=J[L].lineDashType?J[L].lineDashType:it.options.lineDashType?it.options.lineDashType:"shortDash",f.strokeStyle=J[L].lineColor?J[L].lineColor:it.options.lineColor?it.options.lineColor:"#9e9e9e",f.lineWidth=q,f.setLineDash&&(vt=Ti(vt,q),f.setLineDash(vt)),(J[L].indexLabel||it.indexLabel||J[L].indexLabelFormatter||it.indexLabelFormatter)&&this._indexLabels.push({chartType:"waterfall",dataPoint:J[L],dataSeries:it,point:{x:k+(ee-k)/2,y:0<=J[L].y?C:R},direction:0>J[L].y===o.axisY.reversed?1:-1,bounds:{x1:k,y1:Math.min(C,R),x2:ee,y2:Math.max(C,R)},color:d})}}}return rt&&(y.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.globalCompositeOperation="source-atop",o.axisX.maskCanvas&&f.drawImage(o.axisX.maskCanvas,0,0,this.width,this.height),o.axisY.maskCanvas&&f.drawImage(o.axisY.maskCanvas,0,0,this.width,this.height),this._breaksCanvasCtx&&this._breaksCanvasCtx.drawImage(this._preRenderCanvas,0,0,this.width,this.height),f.clearRect(M.x1,M.y1,M.width,M.height),this._eventManager.ghostCtx.restore()),f.restore(),{source:y,dest:this.plotArea.ctx,animationCallback:w.fadeInAnimation,easingFunction:w.easing.easeInQuad,animationBase:0}}};var g=function(o,y,f,c,d,M,k,C,R){if(!(0>f)){if(typeof C>"u"&&(C=1),!rt){var B=Number((k%(2*Math.PI)).toFixed(8));Number((M%(2*Math.PI)).toFixed(8))===B&&(k-=1e-4)}o.save(),o.globalAlpha=C,"pie"===d?(o.beginPath(),o.moveTo(y.x,y.y),o.arc(y.x,y.y,f,M,k,!1),o.fillStyle=c,o.strokeStyle="white",o.lineWidth=2,o.closePath(),o.fill()):"doughnut"===d&&(o.beginPath(),o.arc(y.x,y.y,f,M,k,!1),0<=R&&o.arc(y.x,y.y,R*f,k,M,!0),o.closePath(),o.fillStyle=c,o.strokeStyle="white",o.lineWidth=2,o.fill()),o.globalAlpha=1,o.restore()}};xt.prototype.renderPie=function(o){function f(Ft){var vt=R.plotArea.ctx;for(vt.clearRect(X.x1,X.y1,X.width,X.height),vt.fillStyle=R.backgroundColor,vt.fillRect(X.x1,X.y1,X.width,X.height),vt=0;vt<O.length;vt++){var le=E[vt].startAngle,Ht=E[vt].endAngle;if(Ht>le){var jt=.07*mt*Math.cos(E[vt].midAngle),ye=.07*mt*Math.sin(E[vt].midAngle),Rt=!1;O[vt].exploded?(1e-9<Math.abs(E[vt].center.x-(dt.x+jt))||1e-9<Math.abs(E[vt].center.y-(dt.y+ye)))&&(E[vt].center.x=dt.x+jt*Ft,E[vt].center.y=dt.y+ye*Ft,Rt=!0):(0<Math.abs(E[vt].center.x-dt.x)||0<Math.abs(E[vt].center.y-dt.y))&&(E[vt].center.x=dt.x+jt*(1-Ft),E[vt].center.y=dt.y+ye*(1-Ft),Rt=!0),Rt&&((jt={}).dataSeries=B,jt.dataPoint=B.dataPoints[vt],jt.index=vt,R.toolTip.highlightObjects([jt])),g(R.plotArea.ctx,E[vt].center,E[vt].radius,O[vt].color?O[vt].color:B._colorSet[vt%B._colorSet.length],B.type,le,Ht,B.fillOpacity,E[vt].percentInnerRadius)}}for((Ft=R.plotArea.ctx).save(),Ft.fillStyle="black",Ft.strokeStyle="grey",Ft.textBaseline="middle",Ft.lineJoin="round",vt=vt=0;vt<O.length;vt++)(le=E[vt]).indexLabelText&&(le.indexLabelTextBlock.y-=le.indexLabelTextBlock.height/2,Ht=0,le.indexLabelTextBlock.x+=Ht="left"===le.hemisphere?"inside"!==B.indexLabelPlacement?-(le.indexLabelTextBlock.width+L):-le.indexLabelTextBlock.width/2:"inside"!==B.indexLabelPlacement?L:-le.indexLabelTextBlock.width/2,le.indexLabelTextBlock.render(!0),le.indexLabelTextBlock.x-=Ht,le.indexLabelTextBlock.y+=le.indexLabelTextBlock.height/2,"inside"!==le.indexLabelPlacement&&0<le.indexLabelLineThickness&&(Ht=le.center.x+mt*Math.cos(le.midAngle),jt=le.center.y+mt*Math.sin(le.midAngle),Ft.strokeStyle=le.indexLabelLineColor,Ft.lineWidth=le.indexLabelLineThickness,Ft.setLineDash&&Ft.setLineDash(Ti(le.indexLabelLineDashType,le.indexLabelLineThickness)),Ft.beginPath(),Ft.moveTo(Ht,jt),Ft.lineTo(le.indexLabelTextBlock.x,le.indexLabelTextBlock.y),Ft.lineTo(le.indexLabelTextBlock.x+("left"===le.hemisphere?-L:L),le.indexLabelTextBlock.y),Ft.stroke()),Ft.lineJoin="miter");Ft.save()}function c(Ft,vt){return vt.indexLabelTextBlock.y>Ft.indexLabelTextBlock.y?vt.indexLabelTextBlock.y-vt.indexLabelTextBlock.height/2-(Ft.indexLabelTextBlock.y+Ft.indexLabelTextBlock.height/2):Ft.indexLabelTextBlock.y-Ft.indexLabelTextBlock.height/2-(vt.indexLabelTextBlock.y+vt.indexLabelTextBlock.height/2)}function d(Ft){for(var vt=null,le=1;le<O.length;le++){if(E[vt=(Ft+le+E.length)%E.length].hemisphere!==E[Ft].hemisphere){vt=null;break}if(E[vt].indexLabelText&&vt!==Ft&&(0>c(E[vt],E[Ft])||("right"===E[Ft].hemisphere?E[vt].indexLabelTextBlock.y>=E[Ft].indexLabelTextBlock.y:E[vt].indexLabelTextBlock.y<=E[Ft].indexLabelTextBlock.y)))break;vt=null}return vt}function M(Ft,vt,le){if(1e3<(le=(le||0)+1))return 0;vt=vt||0;var Ht=0,jt=dt.y-1*it,ye=dt.y+1*it;if(0<=Ft&&Ft<O.length){var Rt=E[Ft];if(0>vt&&Rt.indexLabelTextBlock.y<jt||0<vt&&Rt.indexLabelTextBlock.y>ye)return 0;var se=0,Ue=0;for(Ue=se=se=0,0>vt?Rt.indexLabelTextBlock.y-Rt.indexLabelTextBlock.height/2>jt&&Rt.indexLabelTextBlock.y-Rt.indexLabelTextBlock.height/2+vt<jt&&(vt=-(jt-(Rt.indexLabelTextBlock.y-Rt.indexLabelTextBlock.height/2+vt))):Rt.indexLabelTextBlock.y+Rt.indexLabelTextBlock.height/2<jt&&Rt.indexLabelTextBlock.y+Rt.indexLabelTextBlock.height/2+vt>ye&&(vt=Rt.indexLabelTextBlock.y+Rt.indexLabelTextBlock.height/2+vt-ye),vt=Rt.indexLabelTextBlock.y+vt,jt=0,jt="right"===Rt.hemisphere?dt.x+Math.sqrt(Math.pow(it,2)-Math.pow(vt-dt.y,2)):dt.x-Math.sqrt(Math.pow(it,2)-Math.pow(vt-dt.y,2)),Ue=dt.x+mt*Math.cos(Rt.midAngle),se=dt.y+mt*Math.sin(Rt.midAngle),se=Math.sqrt(Math.pow(jt-Ue,2)+Math.pow(vt-se,2)),Ue=Math.acos(mt/it),vt=(se=Math.acos((it*it+mt*mt-se*se)/(2*mt*it)))<Ue?vt-Rt.indexLabelTextBlock.y:0,jt=null,ye=1;ye<O.length;ye++){if(E[jt=(Ft-ye+E.length)%E.length].hemisphere!==E[Ft].hemisphere){jt=null;break}if(E[jt].indexLabelText&&E[jt].hemisphere===E[Ft].hemisphere&&jt!==Ft&&(0>c(E[jt],E[Ft])||("right"===E[Ft].hemisphere?E[jt].indexLabelTextBlock.y<=E[Ft].indexLabelTextBlock.y:E[jt].indexLabelTextBlock.y>=E[Ft].indexLabelTextBlock.y)))break;jt=null}Ue=jt,se=d(Ft),ye=jt=0,0>vt?(Ht=vt,null!==(ye="right"===Rt.hemisphere?Ue:se)&&(Ue=-vt,(vt=Rt.indexLabelTextBlock.y-Rt.indexLabelTextBlock.height/2-(E[ye].indexLabelTextBlock.y+E[ye].indexLabelTextBlock.height/2))-Ue<Y&&+(ye=M(ye,jt=-Ue,le+1)).toFixed(nt)>+jt.toFixed(nt)&&(Ht=vt>Y?-(vt-Y):-(Ue-(ye-jt))))):0<vt&&(Ht=vt,null!==(ye="right"===Rt.hemisphere?se:Ue)&&(Ue=vt,(vt=E[ye].indexLabelTextBlock.y-E[ye].indexLabelTextBlock.height/2-(Rt.indexLabelTextBlock.y+Rt.indexLabelTextBlock.height/2))-Ue<Y&&+(ye=M(ye,jt=Ue,le+1)).toFixed(nt)<+jt.toFixed(nt)&&(Ht=vt>Y?vt-Y:Ue-(jt-ye)))),Ht&&(le=Rt.indexLabelTextBlock.y+Ht,vt=0,vt="right"===Rt.hemisphere?dt.x+Math.sqrt(Math.pow(it,2)-Math.pow(le-dt.y,2)):dt.x-Math.sqrt(Math.pow(it,2)-Math.pow(le-dt.y,2)),Rt.midAngle>Math.PI/2-q&&Rt.midAngle<Math.PI/2+q?(jt=E[jt=(Ft-1+E.length)%E.length],Ft=E[(Ft+1+E.length)%E.length],"left"===Rt.hemisphere&&"right"===jt.hemisphere&&vt>jt.indexLabelTextBlock.x?vt=jt.indexLabelTextBlock.x-15:"right"===Rt.hemisphere&&"left"===Ft.hemisphere&&vt<Ft.indexLabelTextBlock.x&&(vt=Ft.indexLabelTextBlock.x+15)):Rt.midAngle>3*Math.PI/2-q&&Rt.midAngle<3*Math.PI/2+q&&(jt=E[jt=(Ft-1+E.length)%E.length],Ft=E[(Ft+1+E.length)%E.length],"right"===Rt.hemisphere&&"left"===jt.hemisphere&&vt<jt.indexLabelTextBlock.x?vt=jt.indexLabelTextBlock.x+15:"left"===Rt.hemisphere&&"right"===Ft.hemisphere&&vt>Ft.indexLabelTextBlock.x&&(vt=Ft.indexLabelTextBlock.x-15)),Rt.indexLabelTextBlock.y=le,Rt.indexLabelTextBlock.x=vt,Rt.indexLabelAngle=Math.atan2(Rt.indexLabelTextBlock.y-dt.y,Rt.indexLabelTextBlock.x-dt.x))}return Ht}function k(){(Ft=R.plotArea.ctx).fillStyle="grey",Ft.strokeStyle="grey",Ft.font="16px Arial",Ft.textBaseline="middle";var Ht=Ft=0,vt=0,le=!0;for(Ht=0;10>Ht&&(1>Ht||0<vt);Ht++){if((B.radius||!B.radius&&typeof B.innerRadius<"u"&&null!==B.innerRadius&&mt-vt<=Tt)&&(le=!1),le&&(mt-=vt),vt=0,"inside"!==B.indexLabelPlacement){for(it=mt*J,Ft=0;Ft<O.length;Ft++)(jt=E[Ft]).indexLabelTextBlock.x=dt.x+it*Math.cos(jt.midAngle),jt.indexLabelTextBlock.y=dt.y+it*Math.sin(jt.midAngle),jt.indexLabelAngle=jt.midAngle,jt.radius=mt,jt.percentInnerRadius=ee;for(var ye,Rt,Ft=0;Ft<O.length;Ft++){var jt=E[Ft],se=d(Ft);if(null!==se){var Ue=0;if(0>(Ue=c(ye=E[Ft],Rt=E[se])-Y)){for(var li=Rt=0,ni=0;ni<O.length;ni++)ni!==Ft&&E[ni].hemisphere===jt.hemisphere&&(E[ni].indexLabelTextBlock.y<jt.indexLabelTextBlock.y?Rt++:li++);li=-1*(Ue-(Rt=Ue/(Rt+li||1)*li));var $i=ni=0;"right"===jt.hemisphere?(ni=M(Ft,Rt),+($i=M(se,li=-1*(Ue-ni))).toFixed(nt)<+li.toFixed(nt)&&+ni.toFixed(nt)<=+Rt.toFixed(nt)&&M(Ft,-(li-$i))):(ni=M(se,Rt),+($i=M(Ft,li=-1*(Ue-ni))).toFixed(nt)<+li.toFixed(nt)&&+ni.toFixed(nt)<=+Rt.toFixed(nt)&&M(se,-(li-$i)))}}}}else for(Ft=0;Ft<O.length;Ft++)jt=E[Ft],se=dt.x+(it="pie"===B.type?.7*mt:.8*mt)*Math.cos(jt.midAngle),Rt=dt.y+it*Math.sin(jt.midAngle),jt.indexLabelTextBlock.x=se,jt.indexLabelTextBlock.y=Rt;for(Ft=0;Ft<O.length;Ft++)0!==(se=(jt=E[Ft]).indexLabelTextBlock.measureText()).height&&0!==se.width&&(se=se=0,"right"===jt.hemisphere?(se=X.x2-(jt.indexLabelTextBlock.x+jt.indexLabelTextBlock.width+L),se*=-1):se=X.x1-(jt.indexLabelTextBlock.x-jt.indexLabelTextBlock.width-L),0<se&&(!le&&jt.indexLabelText&&(.3*jt.indexLabelTextBlock.maxWidth>(Rt="right"===jt.hemisphere?X.x2-jt.indexLabelTextBlock.x:jt.indexLabelTextBlock.x-X.x1)?jt.indexLabelText="":jt.indexLabelTextBlock.maxWidth=.85*Rt,.3*jt.indexLabelTextBlock.maxWidth<Rt&&(jt.indexLabelTextBlock.x-="right"===jt.hemisphere?2:-2)),Math.abs(jt.indexLabelTextBlock.y-jt.indexLabelTextBlock.height/2-dt.y)<mt||Math.abs(jt.indexLabelTextBlock.y+jt.indexLabelTextBlock.height/2-dt.y)<mt)&&(9<(se/=Math.abs(Math.cos(jt.indexLabelAngle)))&&(se*=.3),se>vt&&(vt=se)),se=se=0,0<jt.indexLabelAngle&&jt.indexLabelAngle<Math.PI?(se=X.y2-(jt.indexLabelTextBlock.y+jt.indexLabelTextBlock.height/2+5),se*=-1):se=X.y1-(jt.indexLabelTextBlock.y-jt.indexLabelTextBlock.height/2-5),0<se&&(!le&&jt.indexLabelText&&0===M(Ft,se*(Rt=0<jt.indexLabelAngle&&jt.indexLabelAngle<Math.PI?-1:1))&&M(Ft,2*Rt),Math.abs(jt.indexLabelTextBlock.x-dt.x)<mt&&(9<(se/=Math.abs(Math.sin(jt.indexLabelAngle)))&&(se*=.3),se>vt&&(vt=se))));var wi=function(wn,Ni,ji){for(var _e=[],os=0;_e.push(E[Ni]),Ni!==ji;Ni=(Ni+1+O.length)%O.length);for(_e.sort(function(yn,Zn){return yn.y-Zn.y}),Ni=0;Ni<_e.length&&(ji=_e[Ni],os<.7*wn);Ni++)os+=ji.indexLabelTextBlock.height,ji.indexLabelTextBlock.text="",ji.indexLabelText="",ji.indexLabelTextBlock.measureText()};!function(){for(var wn=-1,Ni=-1,ji=0,_e=!1,os=0;os<O.length;os++)if(_e=!1,(ye=E[os]).indexLabelText){var yn=d(os);if(null!==yn){var Qe,Zn=E[yn];Ue=0,(Qe=0>(Ue=c(ye,Zn)))&&(Qe=ye.indexLabelTextBlock.x,Qe=!(ye.indexLabelTextBlock.x+ye.indexLabelTextBlock.width<Zn.indexLabelTextBlock.x-L||Qe>Zn.indexLabelTextBlock.x+Zn.indexLabelTextBlock.width+L||ye.indexLabelTextBlock.y-ye.indexLabelTextBlock.height/2>Zn.indexLabelTextBlock.y+Zn.indexLabelTextBlock.height/2+L||ye.indexLabelTextBlock.y+ye.indexLabelTextBlock.height/2<Zn.indexLabelTextBlock.y-Zn.indexLabelTextBlock.height/2-L)),Qe?(0>wn&&(wn=os),yn!==wn&&(Ni=yn,ji+=-Ue),os%Math.max(O.length/10,3)==0&&(_e=!0)):_e=!0,_e&&0<ji&&0<=wn&&0<=Ni&&(wi(ji,wn,Ni),Ni=wn=-1,ji=0)}}0<ji&&wi(ji,wn,Ni)}()}}function C(){if(R.plotArea.layoutManager.reset(),R.title&&(R.title.dockInsidePlotArea||"center"===R.title.horizontalAlign&&"center"===R.title.verticalAlign)&&R.title.render(),R.subtitles)for(var Ft=0;Ft<R.subtitles.length;Ft++){var vt=R.subtitles[Ft];(vt.dockInsidePlotArea||"center"===vt.horizontalAlign&&"center"===vt.verticalAlign)&&vt.render()}R.legend&&(R.legend.dockInsidePlotArea||"center"===R.legend.horizontalAlign&&"center"===R.legend.verticalAlign)&&(R.legend.setLayout(),R.legend.render())}var R=this;if(!(0>=o.dataSeriesIndexes.length)){var it,B=this.data[o.dataSeriesIndexes[0]],O=B.dataPoints,L=10,X=this.plotArea,E=B.dataPointEOs,Y=2,J=1.3,q=20/180*Math.PI,nt=6,dt={x:(X.x2+X.x1)/2,y:(X.y2+X.y1)/2},gt=0;o=!1;for(var kt=0;kt<O.length;kt++)gt+=Math.abs(O[kt].y),!o&&typeof O[kt].indexLabel<"u"&&null!==O[kt].indexLabel&&0<O[kt].indexLabel.toString().length&&(o=!0),!o&&typeof O[kt].label<"u"&&null!==O[kt].label&&0<O[kt].label.toString().length&&(o=!0);if(0!==gt){o=o||typeof B.indexLabel<"u"&&null!==B.indexLabel&&0<B.indexLabel.toString().length;var mt="inside"!==B.indexLabelPlacement&&o?.75*Math.min(X.width,X.height)/2:.92*Math.min(X.width,X.height)/2;B.radius&&(mt=Us(B.radius,mt));var Tt=typeof B.innerRadius<"u"&&null!==B.innerRadius?Us(B.innerRadius,mt):.7*mt;B.radius=mt,"doughnut"===B.type&&(B.innerRadius=Tt);var ee=Math.min(Tt/mt,(mt-1)/mt);this.pieDoughnutClickHandler=function(Ft){R.isAnimating||!Et(Ft.dataSeries.explodeOnClick)&&!Ft.dataSeries.explodeOnClick||((Ft=Ft.dataPoint).exploded=!Ft.exploded,1<this.dataPoints.length&&R._animator.animate(0,500,function(vt){f(vt),C(),R.dispatchEvent("dataAnimationIterationEnd",{chart:R}),R.dispatchEvent("dataAnimationEnd",{chart:R})}))},function y(){if(B&&O){for(var Ft=0,vt=0,le=0,Ht=0,jt=0;jt<O.length;jt++){var ye=O[jt],Rt=B.dataPointIds[jt];E[jt].id=Rt,E[jt].objectType="dataPoint",E[jt].dataPointIndex=jt,E[jt].dataSeriesIndex=0;var se=E[jt],ni={percent:null,total:null},Ue=null;ni=R.getPercentAndTotal(B,ye),(B.indexLabelFormatter||ye.indexLabelFormatter)&&(Ue={chart:R.options,dataSeries:B,dataPoint:ye,total:ni.total,percent:ni.percent}),ni=ye.indexLabelFormatter?ye.indexLabelFormatter(Ue):ye.indexLabel?R.replaceKeywordsWithValue(ye.indexLabel,ye,B,jt):B.indexLabelFormatter?B.indexLabelFormatter(Ue):B.indexLabel?R.replaceKeywordsWithValue(B.indexLabel,ye,B,jt):ye.label?ye.label:"",R._eventManager.objectMap[Rt]=se,se.center={x:dt.x,y:dt.y},se.y=ye.y,se.radius=mt,se.percentInnerRadius=ee,se.indexLabelText=ni,se.indexLabelPlacement=B.indexLabelPlacement,se.indexLabelLineColor=ye.indexLabelLineColor?ye.indexLabelLineColor:B.options.indexLabelLineColor?B.options.indexLabelLineColor:ye.color?ye.color:B._colorSet[jt%B._colorSet.length],se.indexLabelLineThickness=Et(ye.indexLabelLineThickness)?B.indexLabelLineThickness:ye.indexLabelLineThickness,se.indexLabelLineDashType=ye.indexLabelLineDashType?ye.indexLabelLineDashType:B.indexLabelLineDashType,se.indexLabelFontColor=ye.indexLabelFontColor?ye.indexLabelFontColor:B.indexLabelFontColor,se.indexLabelFontStyle=ye.indexLabelFontStyle?ye.indexLabelFontStyle:B.indexLabelFontStyle,se.indexLabelFontWeight=ye.indexLabelFontWeight?ye.indexLabelFontWeight:B.indexLabelFontWeight,se.indexLabelFontSize=Et(ye.indexLabelFontSize)?B.indexLabelFontSize:ye.indexLabelFontSize,se.indexLabelFontFamily=ye.indexLabelFontFamily?ye.indexLabelFontFamily:B.indexLabelFontFamily,se.indexLabelBackgroundColor=ye.indexLabelBackgroundColor?ye.indexLabelBackgroundColor:B.options.indexLabelBackgroundColor?B.options.indexLabelBackgroundColor:B.indexLabelBackgroundColor,se.indexLabelMaxWidth=ye.indexLabelMaxWidth?ye.indexLabelMaxWidth:B.indexLabelMaxWidth?B.indexLabelMaxWidth:.33*X.width,se.indexLabelWrap=typeof ye.indexLabelWrap<"u"?ye.indexLabelWrap:B.indexLabelWrap,se.indexLabelTextAlign=ye.indexLabelTextAlign?ye.indexLabelTextAlign:B.indexLabelTextAlign?B.indexLabelTextAlign:"left",se.startAngle=0===jt?B.startAngle?B.startAngle/180*Math.PI:0:E[jt-1].endAngle,se.startAngle=(se.startAngle+2*Math.PI)%(2*Math.PI),se.endAngle=se.startAngle+2*Math.PI/gt*Math.abs(ye.y),ye=((ye=(se.endAngle+se.startAngle)/2)+2*Math.PI)%(2*Math.PI),se.midAngle=ye,se.midAngle>Math.PI/2-q&&se.midAngle<Math.PI/2+q?((0===Ft||E[le].midAngle>se.midAngle)&&(le=jt),Ft++):se.midAngle>3*Math.PI/2-q&&se.midAngle<3*Math.PI/2+q&&((0===vt||E[Ht].midAngle>se.midAngle)&&(Ht=jt),vt++),se.hemisphere=ye>Math.PI/2&&ye<=3*Math.PI/2?"left":"right",se.indexLabelTextBlock=new En(R.plotArea.ctx,{fontSize:se.indexLabelFontSize,fontFamily:se.indexLabelFontFamily,fontColor:se.indexLabelFontColor,fontStyle:se.indexLabelFontStyle,fontWeight:se.indexLabelFontWeight,textAlign:se.indexLabelTextAlign,backgroundColor:se.indexLabelBackgroundColor,maxWidth:se.indexLabelMaxWidth,maxHeight:se.indexLabelWrap?5*se.indexLabelFontSize:1.5*se.indexLabelFontSize,text:se.indexLabelText,padding:0,textBaseline:"top"}),se.indexLabelTextBlock.measureText()}for(Rt=ye=0,ni=!1,jt=0;jt<O.length;jt++)se=E[(le+jt)%O.length],1<Ft&&se.midAngle>Math.PI/2-q&&se.midAngle<Math.PI/2+q&&(ye<=Ft/2&&!ni?(se.hemisphere="right",ye++):(se.hemisphere="left",ni=!0));for(ni=!1,jt=0;jt<O.length;jt++)se=E[(Ht+jt)%O.length],1<vt&&se.midAngle>3*Math.PI/2-q&&se.midAngle<3*Math.PI/2+q&&(Rt<=vt/2&&!ni?(se.hemisphere="left",Rt++):(se.hemisphere="right",ni=!0))}}(),k(),k(),k(),k(),this.disableToolTip=!0,this._animator.animate(0,this.animatedRender?this.animationDuration:0,function(Ft){(vt=R.plotArea.ctx).clearRect(X.x1,X.y1,X.width,X.height),vt.fillStyle=R.backgroundColor,vt.fillRect(X.x1,X.y1,X.width,X.height);for(var vt=E[0].startAngle+2*Math.PI*Ft,le=0;le<O.length;le++){var Ht=0===le?E[le].startAngle:jt,jt=Ht+(E[le].endAngle-E[le].startAngle),ye=!1;if(jt>vt&&(jt=vt,ye=!0),jt>Ht&&g(R.plotArea.ctx,E[le].center,E[le].radius,O[le].color?O[le].color:B._colorSet[le%B._colorSet.length],B.type,Ht,jt,B.fillOpacity,E[le].percentInnerRadius),ye)break}C(),R.dispatchEvent("dataAnimationIterationEnd",{chart:R}),1<=Ft&&R.dispatchEvent("dataAnimationEnd",{chart:R})},function(){R.disableToolTip=!1,R._animator.animate(0,R.animatedRender?500:0,function(Ft){f(Ft),C(),R.dispatchEvent("dataAnimationIterationEnd",{chart:R})}),R.dispatchEvent("dataAnimationEnd",{chart:R})})}}};var x=function(o,y,f,c){typeof f>"u"&&(f=1),0>=Math.round(y.y4-y.y1)||(o.save(),o.globalAlpha=f,o.beginPath(),o.moveTo(Math.round(y.x1),Math.round(y.y1)),o.lineTo(Math.round(y.x2),Math.round(y.y2)),o.lineTo(Math.round(y.x3),Math.round(y.y3)),o.lineTo(Math.round(y.x4),Math.round(y.y4)),"undefined"!==y.x5&&(o.lineTo(Math.round(y.x5),Math.round(y.y5)),o.lineTo(Math.round(y.x6),Math.round(y.y6))),o.closePath(),o.fillStyle=c||y.color,o.fill(),o.globalAplha=1,o.restore())};xt.prototype.renderFunnel=function(o){function M(){var ze,Re,ve,Zi;if("inside"!==q.indexLabelPlacement)for(var ui=0;ui<_e.length;ui++)0==fe[ui].textBlock.text.length?fe[ui].isDirty=!0:(ve=typeof(ze=_e[ui]).x5<"u"?(ze.y2+ze.y4)/2:(ze.y2+ze.y3)/2,Re=q.reversed?typeof ze.x5<"u"&&ve>Ni?E(ve).x2+1:(ze.x2+ze.x3)/2+1:typeof ze.x5<"u"?ve<Ni?E(ve).x2+1:(ze.x4+ze.x3)/2+1:(ze.x2+ze.x3)/2+1,fe[ui].textBlock.x=Re+Ue,fe[ui].textBlock.y=ve-fe[ui].height/2,q.reversed?(fe[ui].textBlock.y+fe[ui].height>$i+gt&&(fe[ui].textBlock.y=$i+gt-fe[ui].height),fe[ui].textBlock.y<ji-gt&&(fe[ui].textBlock.y=ji-gt)):(fe[ui].textBlock.y<$i-gt&&(fe[ui].textBlock.y=$i-gt),fe[ui].textBlock.y+fe[ui].height>ji+gt&&(fe[ui].textBlock.y=ji+gt-fe[ui].height)));else for(ui=0;ui<_e.length;ui++)0==fe[ui].textBlock.text.length?fe[ui].isDirty=!0:(Zi=fe[ui].width,(Re=(ze=_e[ui]).height)>=(ve=fe[ui].height)?(ve=ui!=yn?(ze.y1+ze.y3)/2-ve/2:(ze.y1+ze.y4)/2-ve/2,fe[ui].textBlock.x=Re=ui!=yn?(ze.x4+ze.x3)/2-Zi/2:(ze.x5+ze.x4)/2-Zi/2,fe[ui].textBlock.y=ve):fe[ui].isDirty=!0)}function C(ze,Re){return(Re<_e.length?fe[Re].textBlock.y:q.reversed?$i+gt:ji+gt)-(0>ze?q.reversed?ji-gt:$i-gt:fe[ze].textBlock.y+fe[ze].height+qe)}function R(ze,Re,ve){var Zi,ui,Ii,Ne=[],Ui=gt,Te=[];if(-1!==Re&&(0<=pi.indexOf(Re)?(ui=pi.indexOf(Re),pi.splice(ui,1)):(pi.push(Re),pi=pi.sort(function(bn,Di){return bn-Di}))),0===pi.length)Ne=mn;else{ui=gt*(1!=pi.length||0!=pi[0]&&pi[0]!=_e.length-1?2:1)/function B(){for(var ze=0,Re=0;Re<_e.length-1;Re++)(0<=pi.indexOf(Re)||0<=pi.indexOf(Re+1))&&ze++;return ze}();for(var Ki=0;Ki<_e.length;Ki++){if(1==pi.length&&0==pi[0]){if(0===Ki){Ne.push(mn[Ki]),Zi=Ui;continue}}else 0===Ki&&(Zi=-1*Ui);Ne.push(mn[Ki]+Zi),(0<=pi.indexOf(Ki)||Ki<_e.length&&0<=pi.indexOf(Ki+1))&&(Zi+=ui)}}Ii=function(){for(var bn=[],Di=0;Di<_e.length;Di++)bn.push(Ne[Di]-_e[Di].y1);return bn}(),(new Date).getTime();ze._animator.animate(0,ve,function(bn){var Di=ze.plotArea.ctx||ze.ctx;Rn=!0,Di.clearRect(dt.x1,dt.y1,dt.x2-dt.x1,dt.y2-dt.y1),Di.fillStyle=ze.backgroundColor,Di.fillRect(dt.x1,dt.y1,dt.width,dt.height),function(bn){for(var Di,Mi,_i=0;_i<_e.length;_i++)Di=Ii[_i],Mi=_e[_i],Di*=bn,typeof Te[_i]>"u"&&(Te[_i]=0),0>Te&&(Te*=-1),Mi.y1+=Di-Te[_i],Mi.y2+=Di-Te[_i],Mi.y3+=Di-Te[_i],Mi.y4+=Di-Te[_i],Mi.y5&&(Mi.y5+=Di-Te[_i],Mi.y6+=Di-Te[_i]),Te[_i]=Di}(bn);var Mi={};for(Mi.dataSeries=q,Mi.dataPoint=q.reversed?q.dataPoints[nt.length-1-Re]:q.dataPoints[Re],Mi.index=q.reversed?nt.length-1-Re:Re,ze.toolTip.highlightObjects([Mi]),Mi=0;Mi<_e.length;Mi++)x(Di,_e[Mi],q.fillOpacity);it(Di),Ft&&("inside"!==q.indexLabelPlacement?O(Di):M(),Y(Di)),1<=bn&&(Rn=!1)},null,w.easing.easeOutQuart)}function O(ze){for(var Re,ve,Zi,ui,Ii=0;Ii<_e.length;Ii++)Re=E(ve=((_e[Ii].y2+_e[Ii].y4)/2<<0)+(ui=fe[Ii].lineThickness%2==1?.5:0)).x2-1,Zi=fe[Ii].textBlock.x,ui=(fe[Ii].textBlock.y+fe[Ii].height/2<<0)+ui,fe[Ii].isDirty||0==fe[Ii].lineThickness||(ze.strokeStyle=fe[Ii].lineColor,ze.lineWidth=fe[Ii].lineThickness,ze.setLineDash&&ze.setLineDash(Ti(fe[Ii].lineDashType,fe[Ii].lineThickness)),ze.beginPath(),ze.moveTo(Re,ve),ze.lineTo(Zi,ui),ze.stroke())}function L(ze){for(ze-=1;-1<=ze&&-1!=ze&&fe[ze].isDirty;ze--);return ze}function X(ze){for(ze+=1;ze<=_e.length&&ze!=_e.length&&fe[ze].isDirty;ze++);return ze}function E(ze){for(var Re,ve=0;ve<nt.length;ve++)if(_e[ve].y1<ze&&_e[ve].y4>ze){Re=_e[ve];break}return Re?{x1:ze=Re.y6&&ze>Re.y6?Re.x3+(Re.x4-Re.x3)/(Re.y4-Re.y3)*(ze-Re.y3):Re.x2+(Re.x3-Re.x2)/(Re.y3-Re.y2)*(ze-Re.y2),x2:ze}:-1}function Y(ze){for(var Re=0;Re<_e.length;Re++)fe[Re].isDirty||(ze&&(fe[Re].textBlock.ctx=ze),fe[Re].textBlock.render(!0))}function it(ze){if(J.plotArea.layoutManager.reset(),ze.roundRect||ks(ze),J.title&&(J.title.dockInsidePlotArea||"center"===J.title.horizontalAlign&&"center"===J.title.verticalAlign)&&(J.title.ctx=ze,J.title.render()),J.subtitles)for(var Re=0;Re<J.subtitles.length;Re++){var ve=J.subtitles[Re];(ve.dockInsidePlotArea||"center"===ve.horizontalAlign&&"center"===ve.verticalAlign)&&(J.subtitles.ctx=ze,ve.render())}J.legend&&(J.legend.dockInsidePlotArea||"center"===J.legend.horizontalAlign&&"center"===J.legend.verticalAlign)&&(J.legend.ctx=ze,J.legend.setLayout(),J.legend.render()),at.fNg&&at.fNg(J)}var J=this;if(!(0>=o.dataSeriesIndexes.length)){for(var q=this.data[o.dataSeriesIndexes[0]],nt=q.dataPoints,dt=this.plotArea,gt=.025*dt.width,kt=.01*dt.width,mt=0,Tt=dt.height-2*gt,ee=Math.min(dt.width-2*kt,2.8*dt.height),Ft=!1,vt=0;vt<nt.length;vt++)!Ft&&typeof nt[vt].indexLabel<"u"&&null!==nt[vt].indexLabel&&0<nt[vt].indexLabel.toString().length&&(Ft=!0),!Ft&&typeof nt[vt].label<"u"&&null!==nt[vt].label&&0<nt[vt].label.toString().length&&(Ft=!0),(!Ft&&"function"==typeof q.indexLabelFormatter||"function"==typeof nt[vt].indexLabelFormatter)&&(Ft=!0);Ft=Ft||typeof q.indexLabel<"u"&&null!==q.indexLabel&&0<q.indexLabel.toString().length,"inside"!==q.indexLabelPlacement&&Ft||(kt=(dt.width-.75*ee)/2),vt=dt.x1+kt;var le=dt.x2-kt,Ht=dt.y1+gt,jt=dt.y2-gt,ye=o.targetCanvasCtx||this.plotArea.ctx||this.ctx;if(0!=q.length&&q.dataPoints&&q.visible&&0!==nt.length){var Rt,se,Ue=30*(le-(o=75*ee/100))/100;"funnel"===q.type?(Rt=Et(q.options.neckHeight)?.35*Tt:q.neckHeight,se=Et(q.options.neckWidth)?.25*o:q.neckWidth,Rt="string"==typeof Rt&&Rt.match(/%$/)?(Rt=parseInt(Rt))*Tt/100:parseInt(Rt),se="string"==typeof se&&se.match(/%$/)?(se=parseInt(se))*o/100:parseInt(se),Rt>Tt?Rt=Tt:0>=Rt&&(Rt=0),se>o?se=o-.5:0>=se&&(se=0)):"pyramid"===q.type&&(se=Rt=0,q.reversed=!q.reversed);var ni=vt,li=vt+o,$i=q.reversed?jt:Ht,wi=(kt=vt+o/2)-se/2,wn=kt+se/2,Ni=q.reversed?Ht+Rt:jt-Rt,ji=q.reversed?Ht:jt;o=[],kt=[];var yn,_e=[],os=(ee=[],Ht),Zn=(Ni-$i)/(wi-ni),Qe=-Zn;if(-1!==(vt="area"===(q.valueRepresents?q.valueRepresents:"height")?function f(){var ui,Ii,ze=ni,Re=li,ve=wi,Zi=wn;ui=Ht,Ii=jt-Rt,Zi=Math.abs((Ii-ui)*(Re-ze+(Zi-ve))/2),ui=Ii-ui,Ii=(ve=wn-wi)*(Ii-jt),Ii=Zi+(Ii=Math.abs(Ii)),Zi=[];for(var Ne=0,Ui=0;Ui<nt.length;Ui++){if(typeof nt[Ui].y>"u")return-1;nt[Ui].y="number"==typeof nt[Ui].y?nt[Ui].y:0,Ne+=Math.abs(nt[Ui].y)}if(0===Ne)return-1;var Ki,Vn,bn=Zi[0]=0,Te=0;for(Re-=ze,bn=!1,Ui=0;Ui<nt.length;Ui++)ze=Math.abs(nt[Ui].y)*Ii/Ne,bn?Ki=0==Number(ve.toFixed(3))?0:ze/ve:0>(Vn=Zn*Zn*Re*Re-4*Math.abs(Zn)*ze)?(ze-=bn=(Re+(Vn=ve))*(ui-Te)/2,Ki=ui-Te,Te+=ui-Te,Ki+=0==Vn?0:ze/Vn,Te+=ze/Vn,bn=!0):(Vn=Re-2*(Ki=(Math.abs(Zn)*Re-Math.sqrt(Vn))/2)/Math.abs(Zn),(Te+=Ki)>ui&&(bn=(Re+(Vn=ve))*(ui-(Te-=Ki))/2,Ki=ui-Te,Te+=ui-Te,Ki+=(ze-=bn)/Vn,Te+=ze/Vn,bn=!0),Re=Vn),Zi.push(Ki);return Zi}():function y(){for(var ze=0,Re=[],ve=0;ve<nt.length;ve++){if(typeof nt[ve].y>"u")return-1;nt[ve].y="number"==typeof nt[ve].y?nt[ve].y:0,ze+=Math.abs(nt[ve].y)}if(0===ze)return-1;for(ve=Re[0]=0;ve<nt.length;ve++)Re.push(Math.abs(nt[ve].y)*Tt/ze);return Re}())){if(q.reversed)for(ee.push(os),se=vt.length-1;0<se;se--)ee.push(os+=vt[se]);else for(se=0;se<vt.length;se++)ee.push(os+=vt[se]);if(q.reversed)for(se=0;se<vt.length;se++)ee[se]<Ni?(o.push(wi),kt.push(wn),yn=se):(o.push((ee[se]-$i+Zn*ni)/Zn),kt.push((ee[se]-$i+Qe*li)/Qe));else for(se=0;se<vt.length;se++)ee[se]<Ni?(o.push((ee[se]-$i+Zn*ni)/Zn),kt.push((ee[se]-$i+Qe*li)/Qe),yn=se):(o.push(wi),kt.push(wn));for(se=0;se<vt.length-1;se++)os=q.reversed?nt[nt.length-1-se].color?nt[nt.length-1-se].color:q._colorSet[(nt.length-1-se)%q._colorSet.length]:nt[se].color?nt[se].color:q._colorSet[se%q._colorSet.length],_e.push(se===yn?{x1:o[se],y1:ee[se],x2:kt[se],y2:ee[se],x3:wn,y3:Ni,x4:kt[se+1],y4:ee[se+1],x5:o[se+1],y5:ee[se+1],x6:wi,y6:Ni,id:se,height:ee[se+1]-ee[se],color:os}:{x1:o[se],y1:ee[se],x2:kt[se],y2:ee[se],x3:kt[se+1],y3:ee[se+1],x4:o[se+1],y4:ee[se+1],id:se,height:ee[se+1]-ee[se],color:os});var qe=2,fe=[],Rn=!1,pi=[],mn=[];for(vt=!1,o=o=0,fo(pi),se=0;se<nt.length;se++)nt[se].exploded&&(vt=!0,pi.push(q.reversed?nt.length-1-se:se));if(ye.clearRect(dt.x1,dt.y1,dt.width,dt.height),ye.fillStyle=J.backgroundColor,ye.fillRect(dt.x1,dt.y1,dt.width,dt.height),Ft&&q.visible&&(function c(){if(q&&nt){for(var ze,Re,ve,Zi,ui,Ii,Ne,Ui,Te,Ki,Vn,bn,Di,Mi,_i,Tn=[],uo=[],zo={percent:null,total:null},ko=null,vi=0;vi<nt.length;vi++)_i=E(_i=typeof(_i=_e[vi]).x5<"u"?(_i.y2+_i.y4)/2:(_i.y2+_i.y3)/2).x2+1,Tn[vi]=le-_i-Ue;_i=.5*Ue,vi=0;for(var vo=nt.length-1;vi<nt.length||0<=vo;vi++,vo--)ze=(Re=q.reversed?nt[vo]:nt[vi]).color?Re.color:q.reversed?q._colorSet[(nt.length-1-vi)%q._colorSet.length]:q._colorSet[vi%q._colorSet.length],ve=Re.indexLabelPlacement||q.indexLabelPlacement||"outside",Mi=Re.indexLabelTextAlign||q.indexLabelTextAlign||"left",Zi=Re.indexLabelBackgroundColor||q.indexLabelBackgroundColor||(rt?"transparent":null),ui=Re.indexLabelFontColor||q.indexLabelFontColor||"#979797",Ii=Et(Re.indexLabelFontSize)?q.indexLabelFontSize:Re.indexLabelFontSize,Ne=Re.indexLabelFontStyle||q.indexLabelFontStyle||"normal",Ui=Re.indexLabelFontFamily||q.indexLabelFontFamily||"arial",Te=Re.indexLabelFontWeight||q.indexLabelFontWeight||"normal",ze=Re.indexLabelLineColor||q.options.indexLabelLineColor||ze,Ki="number"==typeof Re.indexLabelLineThickness?Re.indexLabelLineThickness:"number"==typeof q.indexLabelLineThickness?q.indexLabelLineThickness:2,Vn=Re.indexLabelLineDashType||q.indexLabelLineDashType||"solid",bn=typeof Re.indexLabelWrap<"u"?Re.indexLabelWrap:!(typeof q.indexLabelWrap<"u")||q.indexLabelWrap,J._eventManager.objectMap[Di=q.dataPointIds[vi]]={id:Di,objectType:"dataPoint",dataPointIndex:vi,dataSeriesIndex:0,funnelSection:_e[q.reversed?nt.length-1-vi:vi]},"inside"===q.indexLabelPlacement&&(Tn[vi]=vi!==yn?q.reversed?_e[vi].x2-_e[vi].x1:_e[vi].x3-_e[vi].x4:_e[vi].x3-_e[vi].x6,20>Tn[vi]&&(Tn[vi]=vi!==yn&&q.reversed?_e[vi].x3-_e[vi].x4:_e[vi].x2-_e[vi].x1,Tn[vi]/=2)),((Di=Re.indexLabelMaxWidth?Re.indexLabelMaxWidth:q.options.indexLabelMaxWidth?q.indexLabelMaxWidth:Tn[vi])>Tn[vi]||0>Di)&&(Di=Tn[vi]),uo[vi]="inside"===q.indexLabelPlacement&&_e[vi].height,zo=J.getPercentAndTotal(q,Re),(q.indexLabelFormatter||Re.indexLabelFormatter)&&(ko={chart:J.options,dataSeries:q,dataPoint:Re,total:zo.total,percent:zo.percent}),Re=Re.indexLabelFormatter?Re.indexLabelFormatter(ko):Re.indexLabel?J.replaceKeywordsWithValue(Re.indexLabel,Re,q,vi):q.indexLabelFormatter?q.indexLabelFormatter(ko):q.indexLabel?J.replaceKeywordsWithValue(q.indexLabel,Re,q,vi):Re.label?Re.label:"",0>=Ki&&(Ki=0),1e3>Di&&1e3-Di<_i&&(Di+=1e3-Di),ye.roundRect||ks(ye),(ve=new En(ye,{fontSize:Ii,fontFamily:Ui,fontColor:ui,fontStyle:Ne,fontWeight:Te,horizontalAlign:ve,textAlign:Mi,backgroundColor:Zi,maxWidth:Di,maxHeight:!1===uo[vi]?bn?4.28571429*Ii:1.5*Ii:uo[vi],text:Re,padding:qe})).measureText(),fe.push({textBlock:ve,id:q.reversed?vo:vi,isDirty:!1,lineColor:ze,lineThickness:Ki,lineDashType:Vn,height:ve.height<ve.maxHeight?ve.height:ve.maxHeight,width:ve.width<ve.maxWidth?ve.width:ve.maxWidth})}}(),M(),function d(){var ze,Re,ve,Zi,ui,Ii=[];ui=!1,ve=0;for(var Ne,Ui=le-li-Ue/2,Te=(Ui=q.options.indexLabelMaxWidth?q.indexLabelMaxWidth>Ui?Ui:q.indexLabelMaxWidth:Ui,fe.length-1);0<=Te;Te--)Ne=nt[fe[Te].id],Zi=(ve=fe[Te]).textBlock,Re=(ze=X(Te)<_e.length?fe[X(Te)]:null)?ze.textBlock:null,ve=ve.height,ze&&Zi.y+ve+qe>Re.y&&(ui=!0),((ve=Ne.indexLabelMaxWidth||Ui)>Ui||0>ve)&&(ve=Ui),Ii.push(ve);if(ui)for(Te=fe.length-1;0<=Te;Te--)ze=_e[Te],fe[Te].textBlock.maxWidth=Ii[Ii.length-(Te+1)],fe[Te].textBlock.measureText(),fe[Te].textBlock.x=le-Ui,ui=fe[Te].textBlock.width<fe[Te].textBlock.maxWidth?fe[Te].textBlock.width:fe[Te].textBlock.maxWidth,fe[Te].height=ve=fe[Te].textBlock.height<fe[Te].textBlock.maxHeight?fe[Te].textBlock.height:fe[Te].textBlock.maxHeight,fe[Te].width=ui,fe[Te].textBlock.y=(ve=typeof ze.x5<"u"?(ze.y2+ze.y4)/2:(ze.y2+ze.y3)/2)-fe[Te].height/2,q.reversed?(fe[Te].textBlock.y+fe[Te].height>$i+gt&&(fe[Te].textBlock.y=$i+gt-fe[Te].height),fe[Te].textBlock.y<ji-gt&&(fe[Te].textBlock.y=ji-gt)):(fe[Te].textBlock.y<$i-gt&&(fe[Te].textBlock.y=$i-gt),fe[Te].textBlock.y+fe[Te].height>ji+gt&&(fe[Te].textBlock.y=ji+gt-fe[Te].height))}(),"inside"!==q.indexLabelPlacement)){for(function k(){function ze(Di,Mi){var _i;if(0>Di||Di>=fe.length)return 0;var Tn,uo=fe[Di].textBlock;return 0>Mi?(Mi*=-1,(_i=C(Tn=L(Di),Di))>=Mi?(uo.y-=Mi,Mi):0==Di?(0<_i&&(uo.y-=_i),_i):(0<(_i+=ze(Tn,-(Mi-_i)))&&(uo.y-=_i),_i)):(_i=C(Di,Tn=X(Di)))>=Mi?(uo.y+=Mi,Mi):Di==_e.length-1?(0<_i&&(uo.y+=_i),_i):(0<(_i+=ze(Tn,Mi-_i))&&(uo.y+=_i),_i)}function Re(){var Di,Mi,_i,Tn,zo,uo=0;Tn=(jt-Ht+2*gt)/Ki,zo=Ki;for(var ko,vi=1;vi<zo;vi++){_i=vi*Tn;for(var vo=fe.length-1;0<=vo;vo--)!fe[vo].isDirty&&fe[vo].textBlock.y<_i&&fe[vo].textBlock.y+fe[vo].height>_i&&!((ko=X(vo))>=fe.length-1)&&fe[vo].textBlock.y+fe[vo].height+qe>fe[ko].textBlock.y&&(fe[vo].textBlock.y=fe[vo].textBlock.y+fe[vo].height-_i>_i-fe[vo].textBlock.y?_i+1:_i-fe[vo].height-1)}for(ko=_e.length-1;0<ko;ko--)if(!fe[ko].isDirty){if(0>(_i=L(ko))&&fe[_i=0].isDirty)break;if(fe[ko].textBlock.y<fe[_i].textBlock.y+fe[_i].height){for(Mi=Mi||ko,Tn=ko,zo=0;fe[Tn].textBlock.y<fe[_i].textBlock.y+fe[_i].height+qe;){if(Di=Di||fe[Tn].textBlock.y+fe[Tn].height,zo+=fe[Tn].height,zo+=qe,0>=(Tn=_i)){zo+=fe[Tn=0].height;break}if(0>(_i=L(Tn))){zo+=fe[Tn=0].height;break}}if(Tn!=ko){uo=ve(Di=zo-(Di-=uo=fe[Tn].textBlock.y),Mi,Tn);break}}}return uo}function ve(Di,Mi,_i){var Tn=[],uo=0,zo=0;for(Di=Math.abs(Di);_i<=Mi;_i++)Tn.push(_e[_i]);for(Tn.sort(function(ko,vi){return ko.height-vi.height}),_i=0;_i<Tn.length&&(Mi=Tn[_i],uo<Di);_i++)zo++,uo+=fe[Mi.id].height+qe,fe[Mi.id].textBlock.text="",fe[Mi.id].indexLabelText="",fe[Mi.id].isDirty=!0,fe[Mi.id].textBlock.measureText();return zo}for(var Zi,ui,Ii,Ne,Ui,Te,Ki=1,Vn=0;Vn<2*Ki;Vn++){for(var bn=fe.length-1;0<=bn&&(0<=L(bn)&&L(bn),Ne=(Ii=fe[bn]).textBlock,Te=(Ui=X(bn)<_e.length?fe[X(bn)]:null)?Ui.textBlock:null,Zi=+Ii.height.toFixed(6),ui=+Ne.y.toFixed(6),!(!Ii.isDirty&&Ui&&ui+Zi+qe>+Te.y.toFixed(6)&&(Zi=Ne.y+Zi+qe-Te.y,ui=ze(bn,-Zi),ui<Zi&&(0<ui&&(Zi-=ui),ui=ze(X(bn),Zi),ui!=Zi))));bn--);Re()}}(),se=0;se<nt.length;se++)fe[se].isDirty||(o=(le-(o=fe[se].textBlock.x+fe[se].width))/2,0==se&&(mt=o),mt>o&&(mt=o));for(se=0;se<_e.length;se++)_e[se].x1+=mt,_e[se].x2+=mt,_e[se].x3+=mt,_e[se].x4+=mt,_e[se].x5&&(_e[se].x5+=mt,_e[se].x6+=mt),fe[se].textBlock.x+=mt}for(se=0;se<_e.length;se++)x(ye,mt=_e[se],q.fillOpacity),mn.push(mt.y1);if(it(ye),Ft&&q.visible&&("inside"===q.indexLabelPlacement||J.animationEnabled||O(ye),J.animationEnabled||Y()),!Ft)for(se=0;se<nt.length;se++)J._eventManager.objectMap[mt=q.dataPointIds[se]]=o={id:mt,objectType:"dataPoint",dataPointIndex:se,dataSeriesIndex:0,funnelSection:_e[q.reversed?nt.length-1-se:se]};return(!J.animationEnabled&&vt||J.animationEnabled&&!J.animatedRender)&&R(J,-1,0),this.funnelPyramidClickHandler=function(ui){var Ii=-1;!Rn&&!J.isAnimating&&(Et(ui.dataSeries.explodeOnClick)||ui.dataSeries.explodeOnClick)&&0<=(Ii=q.reversed?nt.length-1-ui.dataPointIndex:ui.dataPointIndex)&&(ui=Ii,("funnel"===q.type||"pyramid"===q.type)&&(q.reversed?nt[nt.length-1-ui].exploded=!nt[nt.length-1-ui].exploded:nt[ui].exploded=!nt[ui].exploded),R(J,Ii,500))},{source:ye,dest:this.plotArea.ctx,animationCallback:function(ui,Ii){w.fadeInAnimation(ui,Ii),1<=ui&&(R(J,-1,500),it(J.plotArea.ctx||J.ctx))},easingFunction:w.easing.easeInQuad,animationBase:0}}}}},xt.prototype.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){window.setTimeout(o,1e3/60)},xt.prototype.cancelRequestAnimFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,xt.prototype.set=function(o,y,f){f=typeof f>"u"||f,"options"===o?(this.options=y,f&&this.render()):xt.base.set.call(this,o,y,f)},xt.prototype.exportChart=function(o){var y=(o=typeof o>"u"?{}:o).format?o.format:"png",f=o.fileName?o.fileName:this.exportFileName;if(o.toDataURL)return this.canvas.toDataURL("image/"+y);bi(this.canvas,y,f)},xt.prototype.print=function(){var o=this.exportChart({toDataURL:!0}),y=document.createElement("iframe");y.setAttribute("class","canvasjs-chart-print-frame"),un(y,{position:"absolute",width:"100%",border:"0px",margin:"0px 0px 0px 0px",padding:"0px 0px 0px 0px"}),y.style.height=this.height+"px",this._canvasJSContainer.appendChild(y);var f=this,c=y.contentWindow||y.contentDocument.document||y.contentDocument;c.document.open(),c.document.write('<!DOCTYPE HTML>\n<html><body><img src="'+o+'"/><body/></html>'),c.document.body&&c.document.body.style&&(c.document.body.style.margin="0px 0px 0px 0px",c.document.body.style.padding="0px 0px 0px 0px"),c.document.close(),setTimeout(function(){c.focus(),c.print(),setTimeout(function(){f._canvasJSContainer.removeChild(y)},1e3)},500)},xt.prototype.getPercentAndTotal=function(o,y){var f=null,c=null,d=f=null;if(0<=o.type.indexOf("stacked"))c=0,(f=y.x.getTime?y.x.getTime():y.x)in o.plotUnit.yTotals&&(c=o.plotUnit.yTotals[f],f=o.plotUnit.yAbsTotals[f],d=isNaN(y.y)||0===f?0:y.y/f*100);else if("pie"===o.type||"doughnut"===o.type||"funnel"===o.type||"pyramid"===o.type){for(f=c=0;f<o.dataPoints.length;f++)isNaN(o.dataPoints[f].y)||(c+=o.dataPoints[f].y);d=isNaN(y.y)?0:y.y/c*100}return{percent:d,total:c}},xt.prototype.replaceKeywordsWithValue=function(o,y,f,c,d){var M=this;if(d=typeof d>"u"?0:d,(0<=f.type.indexOf("stacked")||"pie"===f.type||"doughnut"===f.type||"funnel"===f.type||"pyramid"===f.type)&&(0<=o.indexOf("#percent")||0<=o.indexOf("#total"))){var R="#percent",C="#total",k=this.getPercentAndTotal(f,y);C=isNaN(k.total)?C:k.total,R=isNaN(k.percent)?R:k.percent;do{if(k="",f.percentFormatString)k=f.percentFormatString;else{k="#,##0.";var B=Math.max(Math.ceil(Math.log(1/Math.abs(R))/Math.LN10),2);(isNaN(B)||!isFinite(B))&&(B=2);for(var O=0;O<B;O++)k+="#";f.percentFormatString=k}o=(o=o.replace("#percent",Gn(R,k,M._cultureInfo))).replace("#total",Gn(C,f.yValueFormatString?f.yValueFormatString:"#,##0.########",M._cultureInfo))}while(0<=o.indexOf("#percent")||0<=o.indexOf("#total"))}return o.replace(/\{.*?\}|"[^"]*"|'[^']*'/g,function(L){if('"'===L[0]&&'"'===L[L.length-1]||"'"===L[0]&&"'"===L[L.length-1])return L.slice(1,L.length-1);L=(L=ho(L.slice(1,L.length-1))).replace("#index",d);var X=null;try{var E=L.match(/(.*?)\s*\[\s*(.*?)\s*\]/);E&&0<E.length&&(X=ho(E[2]),L=ho(E[1]))}catch{}if(E=null,"color"===L)return"waterfall"===f.type?y.color?y.color:0<y.y?f.risingColor:f.fallingColor:"error"===f.type?f.color?f.color:f._colorSet[X%f._colorSet.length]:y.color?y.color:f.color?f.color:f._colorSet[c%f._colorSet.length];if(y.hasOwnProperty(L))E=y;else{if(!f.hasOwnProperty(L))return"";E=f}return E=E[L],null!==X&&(E=E[X]),"x"!==L?"y"===L?Gn(E,y.yValueFormatString?y.yValueFormatString:f.yValueFormatString?f.yValueFormatString:f.yValueFormatString="#,##0.########",M._cultureInfo):"z"===L?Gn(E,y.zValueFormatString?y.zValueFormatString:f.zValueFormatString?f.zValueFormatString:f.zValueFormatString="#,##0.########",M._cultureInfo):E:f.axisX&&"dateTime"===f.axisX.valueType||"dateTime"===f.xValueType||y.x&&y.x.getTime?f.axisX.logarithmic?void 0:Es(E,y.xValueFormatString?y.xValueFormatString:f.xValueFormatString?f.xValueFormatString:f.xValueFormatString=M.axisX&&M.axisX.autoValueFormatString?M.axisX.autoValueFormatString:"DD MMM YY",M._cultureInfo):Gn(E,y.xValueFormatString?y.xValueFormatString:f.xValueFormatString?f.xValueFormatString:f.xValueFormatString="#,##0.########",M._cultureInfo)})},On(ct,fn),ct.prototype.setLayout=function(){var o=this.dockInsidePlotArea?this.chart.plotArea:this.chart,y=o.layoutManager.getFreeSpace(),f=null,c=0,d=0,M=0,k=0,C=this.markerMargin=this.chart.options.legend&&!Et(this.chart.options.legend.markerMargin)?this.chart.options.legend.markerMargin:.3*this.fontSize;this.height=0;var R=[],B=[];"top"===this.verticalAlign||"bottom"===this.verticalAlign?(this.orientation="horizontal",f=this.verticalAlign,M=this.maxWidth=null!==this.maxWidth?this.maxWidth:y.width,k=this.maxHeight=null!==this.maxHeight?this.maxHeight:.5*y.height):"center"===this.verticalAlign&&(this.orientation="vertical",("left"===this.horizontalAlign||"center"===this.horizontalAlign||"right"===this.horizontalAlign)&&(f=this.horizontalAlign),M=this.maxWidth=null!==this.maxWidth?this.maxWidth:.5*y.width,k=this.maxHeight=null!==this.maxHeight?this.maxHeight:y.height),this.errorMarkerColor=[];for(var O=0;O<this.dataSeries.length;O++){var L=this.dataSeries[O];if(L.dataPoints&&L.dataPoints.length)if("pie"!==L.type&&"doughnut"!==L.type&&"funnel"!==L.type&&"pyramid"!==L.type){var X=L.legendMarkerType=L.legendMarkerType?L.legendMarkerType:"line"!==L.type&&"stepLine"!==L.type&&"spline"!==L.type&&"scatter"!==L.type&&"bubble"!==L.type||!L.markerType?"error"===L.type&&L._linkedSeries?L._linkedSeries.legendMarkerType?L._linkedSeries.legendMarkerType:pt.getDefaultLegendMarker(L._linkedSeries.type):pt.getDefaultLegendMarker(L.type):L.markerType,E=L.legendText?L.legendText:this.itemTextFormatter?this.itemTextFormatter({chart:this.chart,legend:this.options,dataSeries:L,dataPoint:null}):L.name,Y=L.legendMarkerColor=L.legendMarkerColor?L.legendMarkerColor:L.markerColor?L.markerColor:"error"===L.type?Et(L.whiskerColor)?L._colorSet[0]:L.whiskerColor:L._colorSet[0],it=L.markerSize||"line"!==L.type&&"stepLine"!==L.type&&"spline"!==L.type?.75*this.lineHeight:0,J=L.legendMarkerBorderColor?L.legendMarkerBorderColor:L.markerBorderColor,q=L.legendMarkerBorderThickness?L.legendMarkerBorderThickness:L.markerBorderThickness?Math.max(1,Math.round(.2*it)):0;"error"===L.type&&this.errorMarkerColor.push(Y),E=this.chart.replaceKeywordsWithValue(E,L.dataPoints[0],L,O),R.push(X={markerType:X,markerColor:Y,text:E,textBlock:null,chartType:L.type,markerSize:it,lineColor:L._colorSet[0],dataSeriesIndex:L.index,dataPointIndex:null,markerBorderColor:J,markerBorderThickness:q})}else for(var nt=0;nt<L.dataPoints.length;nt++){var dt=L.dataPoints[nt];X=dt.legendMarkerType?dt.legendMarkerType:L.legendMarkerType?L.legendMarkerType:pt.getDefaultLegendMarker(L.type),E=dt.legendText?dt.legendText:L.legendText?L.legendText:this.itemTextFormatter?this.itemTextFormatter({chart:this.chart,legend:this.options,dataSeries:L,dataPoint:dt}):dt.name?dt.name:"DataPoint: "+(nt+1),Y=dt.legendMarkerColor?dt.legendMarkerColor:L.legendMarkerColor?L.legendMarkerColor:dt.color?dt.color:L.color?L.color:L._colorSet[nt%L._colorSet.length],it=.75*this.lineHeight,J=dt.legendMarkerBorderColor?dt.legendMarkerBorderColor:L.legendMarkerBorderColor?L.legendMarkerBorderColor:dt.markerBorderColor?dt.markerBorderColor:L.markerBorderColor,q=dt.legendMarkerBorderThickness?dt.legendMarkerBorderThickness:L.legendMarkerBorderThickness?L.legendMarkerBorderThickness:dt.markerBorderThickness||L.markerBorderThickness?Math.max(1,Math.round(.2*it)):0,X={markerType:X,markerColor:Y,text:E=this.chart.replaceKeywordsWithValue(E,dt,L,nt),textBlock:null,chartType:L.type,markerSize:it,dataSeriesIndex:O,dataPointIndex:nt,markerBorderColor:J,markerBorderThickness:q},(dt.showInLegend||L.showInLegend&&!1!==dt.showInLegend)&&R.push(X)}}if(!0===this.reversed&&R.reverse(),0<R.length){for(L=null,Y=E=dt=nt=0,dt=null!==this.itemWidth?null!==this.itemMaxWidth?Math.min(this.itemWidth,this.itemMaxWidth,M):this.itemMaxWidth=Math.min(this.itemWidth,M):null!==this.itemMaxWidth?Math.min(this.itemMaxWidth,M):this.itemMaxWidth=M,dt-=(it=0===it?.75*this.lineHeight:it)+C,O=0;O<R.length;O++)J=dt,("line"===(X=R[O]).chartType||"spline"===X.chartType||"stepLine"===X.chartType)&&(J-=.2*this.lineHeight),0>=k||typeof k>"u"||0>=J||typeof J>"u"||("horizontal"===this.orientation?(X.textBlock=new En(this.ctx,{x:0,y:0,maxWidth:J,maxHeight:this.itemWrap?k:this.lineHeight,angle:0,text:X.text,horizontalAlign:"left",fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontColor:this.fontColor,fontStyle:this.fontStyle,textBaseline:"middle"}),X.textBlock.measureText(),null!==this.itemWidth&&(X.textBlock.width=this.itemWidth-(it+C+("line"===X.chartType||"spline"===X.chartType||"stepLine"===X.chartType?.2*this.lineHeight:0))),(!L||L.width+Math.round(X.textBlock.width+it+C+(0===L.width?0:this.horizontalSpacing)+("line"===X.chartType||"spline"===X.chartType||"stepLine"===X.chartType?.2*this.lineHeight:0))>M)&&(B.push(L={items:[],width:0}),this.height+=E,E=0),E=Math.max(E,X.textBlock.height)):(X.textBlock=new En(this.ctx,{x:0,y:0,maxWidth:dt,maxHeight:!0===this.itemWrap?k:1.5*this.fontSize,angle:0,text:X.text,horizontalAlign:"left",fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontColor:this.fontColor,fontStyle:this.fontStyle,textBaseline:"middle"}),X.textBlock.measureText(),null!==this.itemWidth&&(X.textBlock.width=this.itemWidth-(it+C+("line"===X.chartType||"spline"===X.chartType||"stepLine"===X.chartType?.2*this.lineHeight:0))),this.height<k-this.lineHeight?B.push(L={items:[],width:0}):(L=B[nt],nt=(nt+1)%B.length),this.height+=X.textBlock.height),X.textBlock.x=L.width,X.textBlock.y=0,L.width+=Math.round(X.textBlock.width+it+C+(0===L.width?0:this.horizontalSpacing)+("line"===X.chartType||"spline"===X.chartType||"stepLine"===X.chartType?.2*this.lineHeight:0)),L.items.push(X),this.width=Math.max(L.width,this.width),Y=X.textBlock.width+(it+C+("line"===X.chartType||"spline"===X.chartType||"stepLine"===X.chartType?.2*this.lineHeight:0)));this.itemWidth=Y,this.height=!1===this.itemWrap?B.length*this.lineHeight:this.height+E,this.height=Math.min(k,this.height),this.width=Math.min(M,this.width)}for("top"===this.verticalAlign?(d="left"===this.horizontalAlign?y.x1:"right"===this.horizontalAlign?y.x2-this.width:y.x1+y.width/2-this.width/2,c=y.y1):"center"===this.verticalAlign?(d="left"===this.horizontalAlign?y.x1:"right"===this.horizontalAlign?y.x2-this.width:y.x1+y.width/2-this.width/2,c=y.y1+y.height/2-this.height/2):"bottom"===this.verticalAlign&&(d="left"===this.horizontalAlign?y.x1:"right"===this.horizontalAlign?y.x2-this.width:y.x1+y.width/2-this.width/2,c=y.y2-this.height),this.items=R,O=0;O<this.items.length;O++)(X=R[O]).id=++this.chart._eventManager.lastObjectId,this.chart._eventManager.objectMap[X.id]={id:X.id,objectType:"legendItem",legendItemIndex:O,dataSeriesIndex:X.dataSeriesIndex,dataPointIndex:X.dataPointIndex};this.markerSize=it,this.rows=B,0<R.length&&o.layoutManager.registerSpace(f,{width:this.width+2+2,height:this.height+5+5}),this.bounds={x1:d,y1:c,x2:d+this.width,y2:c+this.height}},ct.prototype.render=function(){var o=this.bounds.x1,y=this.bounds.y1,f=this.markerMargin,c=this.maxWidth,d=this.maxHeight,M=this.markerSize,k=this.rows;(0<this.borderThickness&&this.borderColor||this.backgroundColor)&&this.ctx.roundRect(o,y,this.width,this.height,this.cornerRadius,this.borderThickness,this.backgroundColor,this.borderColor);for(var C=0,R=0;R<k.length;R++){for(var B=k[R],O=0,L=0;L<B.items.length;L++){var X=B.items[L],E=X.textBlock.x+o+(0===L?.2*M:this.horizontalSpacing),Y=y+C,it=E;if(this.chart.data[X.dataSeriesIndex].visible||(this.ctx.globalAlpha=.5),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(o,y,c,Math.max(d-d%this.lineHeight,0)),this.ctx.clip(),("line"===X.chartType||"stepLine"===X.chartType||"spline"===X.chartType)&&(this.ctx.strokeStyle=X.lineColor,this.ctx.lineWidth=Math.ceil(this.lineHeight/8),this.ctx.beginPath(),this.ctx.moveTo(E-.1*this.lineHeight,Y+this.lineHeight/2),this.ctx.lineTo(E+.85*this.lineHeight,Y+this.lineHeight/2),this.ctx.stroke(),it-=.1*this.lineHeight),"error"===X.chartType){this.ctx.strokeStyle=this.errorMarkerColor[0],this.ctx.lineWidth=M/8,this.ctx.beginPath();var J=E-.08*this.lineHeight+.1*this.lineHeight,q=Y+.15*this.lineHeight,nt=.7*this.lineHeight,dt=nt+.02*this.lineHeight;this.ctx.moveTo(J,q),this.ctx.lineTo(J+nt,q),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(J+nt/2,q),this.ctx.lineTo(J+nt/2,q+dt),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(J,q+dt),this.ctx.lineTo(J+nt,q+dt),this.ctx.stroke(),this.errorMarkerColor.shift()}D.drawMarker(E+M/2,Y+this.lineHeight/2,this.ctx,X.markerType,"error"===X.chartType||"line"===X.chartType||"spline"===X.chartType?X.markerSize/2:X.markerSize,X.markerColor,X.markerBorderColor,X.markerBorderThickness),X.textBlock.x=E+f+M,("line"===X.chartType||"stepLine"===X.chartType||"spline"===X.chartType)&&(X.textBlock.x+=.1*this.lineHeight),X.textBlock.y=Math.round(Y+this.lineHeight/2),X.textBlock.render(!0),this.ctx.restore(),O=0<L?Math.max(O,X.textBlock.height):X.textBlock.height,this.chart.data[X.dataSeriesIndex].visible||(this.ctx.globalAlpha=1),E=an(X.id),this.ghostCtx.fillStyle=E,this.ghostCtx.beginPath(),this.ghostCtx.fillRect(it,X.textBlock.y-this.lineHeight/2,X.textBlock.x+X.textBlock.width-it,X.textBlock.height),X.x1=this.chart._eventManager.objectMap[X.id].x1=it,X.y1=this.chart._eventManager.objectMap[X.id].y1=X.textBlock.y-this.lineHeight/2,X.x2=this.chart._eventManager.objectMap[X.id].x2=X.textBlock.x+X.textBlock.width,X.y2=this.chart._eventManager.objectMap[X.id].y2=X.textBlock.y+X.textBlock.height-this.lineHeight/2}C+=O}},On(pt,fn),pt.prototype.getDefaultAxisPlacement=function(){var o=this.type;return"column"===o||"line"===o||"stepLine"===o||"spline"===o||"area"===o||"stepArea"===o||"splineArea"===o||"stackedColumn"===o||"stackedLine"===o||"bubble"===o||"scatter"===o||"stackedArea"===o||"stackedColumn100"===o||"stackedLine100"===o||"stackedArea100"===o||"candlestick"===o||"ohlc"===o||"rangeColumn"===o||"rangeArea"===o||"rangeSplineArea"===o||"boxAndWhisker"===o||"waterfall"===o?"normal":"bar"===o||"stackedBar"===o||"stackedBar100"===o||"rangeBar"===o?"xySwapped":"pie"===o||"doughnut"===o||"funnel"===o||"pyramid"===o?"none":("error"!==o&&window.console.log("Unknown Chart Type: "+o),null)},pt.getDefaultLegendMarker=function(o){return"column"===o||"stackedColumn"===o||"stackedLine"===o||"bar"===o||"stackedBar"===o||"stackedBar100"===o||"bubble"===o||"scatter"===o||"stackedColumn100"===o||"stackedLine100"===o||"stepArea"===o||"candlestick"===o||"ohlc"===o||"rangeColumn"===o||"rangeBar"===o||"rangeArea"===o||"rangeSplineArea"===o||"boxAndWhisker"===o||"waterfall"===o?"square":"line"===o||"stepLine"===o||"spline"===o||"pie"===o||"doughnut"===o?"circle":"area"===o||"splineArea"===o||"stackedArea"===o||"stackedArea100"===o||"funnel"===o||"pyramid"===o?"triangle":"error"===o?"none":(window.console.log("Unknown Chart Type: "+o),null)},pt.prototype.getDataPointAtX=function(o,y){if(!this.dataPoints||0===this.dataPoints.length)return null;var f={dataPoint:null,distance:1/0,index:NaN},c=null,d=0,M=0,k=1,C=1/0,R=0,B=0,O=0;for("none"!==this.chart.plotInfo.axisPlacement&&(O=this.axisX.logarithmic?1<(O=Math.log(this.dataPoints[this.dataPoints.length-1].x/this.dataPoints[0].x))?Math.min(Math.max((this.dataPoints.length-1)/O*Math.log(o/this.dataPoints[0].x)>>0,0),this.dataPoints.length):0:0<(O=this.dataPoints[this.dataPoints.length-1].x-this.dataPoints[0].x)?Math.min(Math.max((this.dataPoints.length-1)/O*(o-this.dataPoints[0].x)>>0,0),this.dataPoints.length):0);;){if(0<=(M=0<k?O+d:O-d)&&M<this.dataPoints.length){c=this.dataPoints[M];var L=this.axisX.logarithmic?c.x>o?c.x/o:o/c.x:Math.abs(c.x-o);if(L<f.distance&&(f.dataPoint=c,f.distance=L,f.index=M),(c=L)<=C?C=c:0<k?R++:B++,1e3<R&&1e3<B)break}else if(0>O-d&&O+d>=this.dataPoints.length)break;-1===k?(d++,k=1):k=-1}return y||(f.dataPoint.x.getTime?f.dataPoint.x.getTime():f.dataPoint.x)!==(o.getTime?o.getTime():o)?y&&null!==f.dataPoint?f:null:f},pt.prototype.getDataPointAtXY=function(o,y,f){if(!this.dataPoints||0===this.dataPoints.length||o<this.chart.plotArea.x1||o>this.chart.plotArea.x2||y<this.chart.plotArea.y1||y>this.chart.plotArea.y2)return null;f=f||!1;var c=[],d=0,M=0,k=1,C=!1,R=1/0,B=0,O=0,X=0;for("none"!==this.chart.plotInfo.axisPlacement&&(X=(this.chart.axisX[0]?this.chart.axisX[0]:this.chart.axisX2[0]).getXValueAt({x:o,y}),X=this.axisX.logarithmic?1<(L=Math.log(this.dataPoints[this.dataPoints.length-1].x/this.dataPoints[0].x))?Math.min(Math.max((this.dataPoints.length-1)/L*Math.log(X/this.dataPoints[0].x)>>0,0),this.dataPoints.length):0:0<(L=this.dataPoints[this.dataPoints.length-1].x-this.dataPoints[0].x)?Math.min(Math.max((this.dataPoints.length-1)/L*(X-this.dataPoints[0].x)>>0,0),this.dataPoints.length):0);;){if(0<=(M=0<k?X+d:X-d)&&M<this.dataPoints.length){var L,E=this.dataPoints[M],Y=null;if(L=this.chart._eventManager.objectMap[this.dataPointIds[M]]){switch(this.type){case"column":case"stackedColumn":case"stackedColumn100":case"bar":case"stackedBar":case"stackedBar100":case"rangeColumn":case"rangeBar":case"waterfall":case"error":o>=L.x1&&o<=L.x2&&y>=L.y1&&y<=L.y2&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Math.min(Math.abs(L.x1-o),Math.abs(L.x2-o),Math.abs(L.y1-y),Math.abs(L.y2-y))}),C=!0);break;case"line":case"stepLine":case"spline":case"area":case"stepArea":case"stackedArea":case"stackedArea100":case"splineArea":case"scatter":var it=Xi("markerSize",E,this)||4,J=f?20:it;(Y=Math.sqrt(Math.pow(L.x1-o,2)+Math.pow(L.y1-y,2)))<=J&&c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Y}),(L=Math.abs(L.x1-o))<=R?R=L:0<k?B++:O++,Y<=it/2&&(C=!0);break;case"rangeArea":case"rangeSplineArea":it=Xi("markerSize",E,this)||4,J=f?20:it,(Y=Math.min(Math.sqrt(Math.pow(L.x1-o,2)+Math.pow(L.y1-y,2)),Math.sqrt(Math.pow(L.x1-o,2)+Math.pow(L.y2-y,2))))<=J&&c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Y}),(L=Math.abs(L.x1-o))<=R?R=L:0<k?B++:O++,Y<=it/2&&(C=!0);break;case"bubble":it=L.size,(Y=Math.sqrt(Math.pow(L.x1-o,2)+Math.pow(L.y1-y,2)))<=it/2&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Y}),C=!0);break;case"pie":case"doughnut":it=L.center,J="doughnut"===this.type?L.percentInnerRadius*L.radius:0,(Y=Math.sqrt(Math.pow(it.x-o,2)+Math.pow(it.y-y,2)))<L.radius&&Y>J&&(0>(Y=Math.atan2(y-it.y,o-it.x))&&(Y+=2*Math.PI),Y=Number(((Y/Math.PI*180%360+360)%360).toFixed(12)),it=Number(((L.startAngle/Math.PI*180%360+360)%360).toFixed(12)),0===(J=Number(((L.endAngle/Math.PI*180%360+360)%360).toFixed(12)))&&1<L.endAngle&&(J=360),it>=J&&0!==E.y&&(J+=360,Y<it&&(Y+=360)),Y>it&&Y<J&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:0}),C=!0));break;case"funnel":case"pyramid":y>(Y=L.funnelSection).y1&&y<Y.y4&&(Y.y6?y>Y.y6?(M=Y.x6+(Y.x5-Y.x6)/(Y.y5-Y.y6)*(y-Y.y6),Y=Y.x3+(Y.x4-Y.x3)/(Y.y4-Y.y3)*(y-Y.y3)):(M=Y.x1+(Y.x6-Y.x1)/(Y.y6-Y.y1)*(y-Y.y1),Y=Y.x2+(Y.x3-Y.x2)/(Y.y3-Y.y2)*(y-Y.y2)):(M=Y.x1+(Y.x4-Y.x1)/(Y.y4-Y.y1)*(y-Y.y1),Y=Y.x2+(Y.x3-Y.x2)/(Y.y3-Y.y2)*(y-Y.y2)),o>M&&o<Y&&(c.push({dataPoint:E,dataPointIndex:L.dataPointIndex,dataSeries:this,distance:0}),C=!0));break;case"boxAndWhisker":(o>=L.x1-L.borderThickness/2&&o<=L.x2+L.borderThickness/2&&y>=L.y4-L.borderThickness/2&&y<=L.y1+L.borderThickness/2||Math.abs(L.x2-o+L.x1-o)<L.borderThickness&&y>=L.y1&&y<=L.y4)&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Math.min(Math.abs(L.x1-o),Math.abs(L.x2-o),Math.abs(L.y2-y),Math.abs(L.y3-y))}),C=!0);break;case"candlestick":(o>=L.x1-L.borderThickness/2&&o<=L.x2+L.borderThickness/2&&y>=L.y2-L.borderThickness/2&&y<=L.y3+L.borderThickness/2||Math.abs(L.x2-o+L.x1-o)<L.borderThickness&&y>=L.y1&&y<=L.y4)&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Math.min(Math.abs(L.x1-o),Math.abs(L.x2-o),Math.abs(L.y2-y),Math.abs(L.y3-y))}),C=!0);break;case"ohlc":(Math.abs(L.x2-o+L.x1-o)<L.borderThickness&&y>=L.y2&&y<=L.y3||o>=L.x1&&o<=(L.x2+L.x1)/2&&y>=L.y1-L.borderThickness/2&&y<=L.y1+L.borderThickness/2||o>=(L.x1+L.x2)/2&&o<=L.x2&&y>=L.y4-L.borderThickness/2&&y<=L.y4+L.borderThickness/2)&&(c.push({dataPoint:E,dataPointIndex:M,dataSeries:this,distance:Math.min(Math.abs(L.x1-o),Math.abs(L.x2-o),Math.abs(L.y2-y),Math.abs(L.y3-y))}),C=!0)}if(C||1e3<B&&1e3<O)break}}else if(0>X-d&&X+d>=this.dataPoints.length)break;-1===k?(d++,k=1):k=-1}for(o=null,y=0;y<c.length;y++)o?c[y].distance<=o.distance&&(o=c[y]):o=c[y];return o},pt.prototype.getMarkerProperties=function(o,y,f,c){var d=this.dataPoints;return{x:y,y:f,ctx:c,type:d[o].markerType?d[o].markerType:this.markerType,size:d[o].markerSize?d[o].markerSize:this.markerSize,color:d[o].markerColor?d[o].markerColor:this.markerColor?this.markerColor:d[o].color?d[o].color:this.color?this.color:this._colorSet[o%this._colorSet.length],borderColor:d[o].markerBorderColor?d[o].markerBorderColor:this.markerBorderColor?this.markerBorderColor:null,borderThickness:d[o].markerBorderThickness?d[o].markerBorderThickness:this.markerBorderThickness?this.markerBorderThickness:null}},On(wt,fn),wt.prototype.createExtraLabelsForLog=function(o){if(!(5<(o=(o||0)+1))){var y=this.logLabelValues[0]||this.intervalStartPosition;if(Math.log(this.range)/Math.log(y/this.viewportMinimum)<this.noTicks-1){for(var f=wt.getNiceNumber((y-this.viewportMinimum)/Math.min(Math.max(2,this.noTicks-this.logLabelValues.length),3),!0),c=Math.ceil(this.viewportMinimum/f)*f;c<y;c+=f)c<this.viewportMinimum||this.logLabelValues.push(c);this.logLabelValues.sort(pn),this.createExtraLabelsForLog(o)}}},wt.prototype.createLabels=function(){var o,y,c,R,O,f=0,k=0,d=0,M=0,C=(k=0,k=this.interval,0),B=.6*this.chart.height;o=!1;var L=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[],X=L.length?Et(this.scaleBreaks.firstBreakIndex)?0:this.scaleBreaks.firstBreakIndex:0;if("axisX"!==this.type||"dateTime"!==this.valueType||this.logarithmic){if(c=this.viewportMaximum,this.labels){o=Math.ceil(k);var E=!1;for(f=k=Math.ceil(this.intervalStartPosition);f<this.viewportMaximum;f+=o){if(!this.labels[f]){E=!1;break}E=!0}E&&(this.interval=o,this.intervalStartPosition=k)}if(this.logarithmic&&!this.equidistantInterval)for(this.logLabelValues||(this.logLabelValues=[],this.createExtraLabelsForLog()),k=0,E=X;k<this.logLabelValues.length;k++)if((f=this.logLabelValues[k])<this.viewportMinimum)k++;else{for(;E<L.length&&f>L[E].endValue;E++);O=f,(o=E<L.length&&f>=L[E].startValue&&f<=L[E].endValue)||(o=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:O,label:this.labels[O]?this.labels[O]:null}):"axisX"===this.type&&this.labels[O]?this.labels[O]:Gn(O,this.valueFormatString,this.chart._cultureInfo),o=new En(this.ctx,{x:0,y:0,maxWidth:d,maxHeight:M,angle:this.labelAngle,text:this.prefix+o+this.suffix,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,cornerRadius:this.labelCornerRadius,textAlign:this.labelTextAlign,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle",borderThickness:0}),this._labels.push({position:O,textBlock:o,effectiveHeight:null}))}for(E=X,f=this.intervalStartPosition;f<=c;f=parseFloat(1e-12>this.interval?this.logarithmic&&this.equidistantInterval?f*Math.pow(this.logarithmBase,this.interval):f+this.interval:(this.logarithmic&&this.equidistantInterval?f*Math.pow(this.logarithmBase,this.interval):f+this.interval).toFixed(12))){for(;E<L.length&&f>L[E].endValue;E++);O=f,(o=E<L.length&&f>=L[E].startValue&&f<=L[E].endValue)||(o=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:O,label:this.labels[O]?this.labels[O]:null}):"axisX"===this.type&&this.labels[O]?this.labels[O]:Gn(O,this.valueFormatString,this.chart._cultureInfo),o=new En(this.ctx,{x:0,y:0,maxWidth:d,maxHeight:M,angle:this.labelAngle,text:this.prefix+o+this.suffix,textAlign:this.labelTextAlign,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this._labels.push({position:O,textBlock:o,effectiveHeight:null}))}}else for(this.intervalStartPosition=this.getLabelStartPoint(new Date(this.viewportMinimum),this.intervalType,this.interval),c=b(new Date(this.viewportMaximum),this.interval,this.intervalType),E=X,f=this.intervalStartPosition;f<c;b(f,k,this.intervalType)){for(o=f.getTime();E<L.length&&o>L[E].endValue;E++);O=o,(o=E<L.length&&o>=L[E].startValue&&o<=L[E].endValue)||(o=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.options,value:new Date(O),label:this.labels[O]?this.labels[O]:null}):"axisX"===this.type&&this.labels[O]?this.labels[O]:Es(O,this.valueFormatString,this.chart._cultureInfo),o=new En(this.ctx,{x:0,y:0,maxWidth:d,backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,maxHeight:M,angle:this.labelAngle,text:this.prefix+o+this.suffix,textAlign:this.labelTextAlign,fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this._labels.push({position:O,textBlock:o,effectiveHeight:null,breaksLabelType:void 0}))}for("bottom"===this._position||"top"===this._position?(C=this.logarithmic&&!this.equidistantInterval&&2<=this._labels.length?this.lineCoordinates.width*Math.log(Math.min(this._labels[this._labels.length-1].position/this._labels[this._labels.length-2].position,this._labels[1].position/this._labels[0].position))/Math.log(this.range):this.lineCoordinates.width/(this.logarithmic&&this.equidistantInterval?Math.log(this.range)/Math.log(this.logarithmBase):Math.abs(this.range))*In[this.intervalType+"Duration"]*this.interval,d=typeof this.options.labelMaxWidth>"u"?.5*this.chart.width>>0:this.options.labelMaxWidth,this.chart.panEnabled||(M=typeof this.options.labelWrap>"u"||this.labelWrap?.8*this.chart.height>>0:1.5*this.labelFontSize)):("left"===this._position||"right"===this._position)&&(C=this.logarithmic&&!this.equidistantInterval&&2<=this._labels.length?this.lineCoordinates.height*Math.log(Math.min(this._labels[this._labels.length-1].position/this._labels[this._labels.length-2].position,this._labels[1].position/this._labels[0].position))/Math.log(this.range):this.lineCoordinates.height/(this.logarithmic&&this.equidistantInterval?Math.log(this.range)/Math.log(this.logarithmBase):Math.abs(this.range))*In[this.intervalType+"Duration"]*this.interval,this.chart.panEnabled||(d=typeof this.options.labelMaxWidth>"u"?.3*this.chart.width>>0:this.options.labelMaxWidth),M=typeof this.options.labelWrap>"u"||this.labelWrap?.3*this.chart.height>>0:1.5*this.labelFontSize),k=0;k<this._labels.length;k++){(o=this._labels[k].textBlock).maxWidth=d,o.maxHeight=M;var Y=o.measureText();R=Y.height}if(c=[],X=L=0,this.labelAutoFit||this.options.labelAutoFit)if(Et(this.labelAngle)||(this.labelAngle=(this.labelAngle%360+360)%360,90<this.labelAngle&&270>this.labelAngle?this.labelAngle-=180:270<=this.labelAngle&&360>=this.labelAngle&&(this.labelAngle-=360)),"bottom"===this._position||"top"===this._position)if(d=.9*C>>0,X=0,!this.chart.panEnabled&&1<=this._labels.length){for(this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelWrap=this.labelWrap,f=0;f<this._labels.length;f++)if(!this._labels[f].breaksLabelType){var it;for(E=(o=this._labels[f].textBlock).text.split(" "),k=0;k<E.length;k++)O=E[k],this.ctx.font=o.fontStyle+" "+o.fontWeight+" "+o.fontSize+"px "+o.fontFamily,(O=this.ctx.measureText(O)).width>X&&(it=f,X=O.width)}for(f=0,f=this.intervalStartPosition<this.viewportMinimum?1:0;f<this._labels.length;f++)if(!this._labels[f].breaksLabelType){for(Y=(o=this._labels[f].textBlock).measureText(),E=f+1;E<this._labels.length;E++)if(!this._labels[E].breaksLabelType){y=(y=this._labels[E].textBlock).measureText();break}if(c.push(o.height),this.sessionVariables.labelMaxHeight=Math.max.apply(Math,c),Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.sin(Math.PI/180*Math.abs(this.labelAngle)),k=d*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(M-o.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Et(this.options.labelAngle)&&isNaN(this.options.labelAngle)&&0!==this.options.labelAngle)if(this.sessionVariables.labelMaxHeight=0===this.labelAngle?M:Math.min((k-d*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)),k),O=(B-(R+o.fontSize/2)*Math.cos(Math.PI/180*Math.abs(-25)))/Math.sin(Math.PI/180*Math.abs(-25)),Et(this.options.labelWrap)){if(Et(this.options.labelWrap))if(Et(this.options.labelMaxWidth)){if(!Et(y))if(k=Y.width+y.width>>0,E=this.labelFontSize,X<d)k-2*d>L&&(L=k-2*d,k>=2*d&&k<2.2*d?(this.sessionVariables.labelMaxWidth=d,Et(this.options.labelFontSize)&&12<E&&(E=Math.floor(12/13*E),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?E:this.options.labelFontSize,this.sessionVariables.labelAngle=this.labelAngle):k>=2.2*d&&k<2.8*d?(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=O,this.sessionVariables.labelFontSize=E):k>=2.8*d&&k<3.2*d?(this.sessionVariables.labelMaxWidth=Math.max(d,X),this.sessionVariables.labelWrap=!0,Et(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?E:this.options.labelFontSize,this.sessionVariables.labelAngle=this.labelAngle):k>=3.2*d&&k<3.6*d?(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelMaxWidth=O,this.sessionVariables.labelFontSize=this.labelFontSize):k>3.6*d&&k<5*d?(Et(this.options.labelFontSize)&&12<E&&(E=Math.floor(12/13*E),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?E:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=O):k>5*d&&(this.sessionVariables.labelWrap=!0,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelFontSize=E,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelAngle=this.labelAngle));else if(it===f&&(0===it&&X+this._labels[it+1].textBlock.measureText().width-2*d>L||it===this._labels.length-1&&X+this._labels[it-1].textBlock.measureText().width-2*d>L||0<it&&it<this._labels.length-1&&X+this._labels[it+1].textBlock.measureText().width-2*d>L&&X+this._labels[it-1].textBlock.measureText().width-2*d>L))L=0===it?X+this._labels[it+1].textBlock.measureText().width-2*d:X+this._labels[it-1].textBlock.measureText().width-2*d,this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?E:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=O;else if(0===L)for(this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?E:this.options.labelFontSize,this.sessionVariables.labelWrap=!0,k=0;k<this._labels.length;k++)(o=this._labels[k].textBlock).maxWidth=this.sessionVariables.labelMaxWidth=Math.min(Math.max(d,X),O),Y=o.measureText(),k<this._labels.length-1&&((y=this._labels[E=k+1].textBlock).maxWidth=this.sessionVariables.labelMaxWidth=Math.min(Math.max(d,X),O),y=y.measureText(),Y.width+y.width>>0>2*d&&(this.sessionVariables.labelAngle=-25))}else this.options.labelMaxWidth<d?(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=k):(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=M)}else this.labelWrap?Et(this.options.labelMaxWidth)?(this.sessionVariables.labelMaxWidth=Math.min(Math.max(d,X),O),this.sessionVariables.labelWrap=this.labelWrap,y&&Y.width+y.width>>0>2*d&&(this.sessionVariables.labelAngle=-25)):(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelAngle=this.sessionVariables.labelMaxWidth>d?-25:this.sessionVariables.labelAngle):Et(this.options.labelMaxWidth)?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelMaxWidth=d,y&&Y.width+y.width>>0>2*d&&(this.sessionVariables.labelAngle=-25,this.sessionVariables.labelMaxWidth=O)):(this.sessionVariables.labelAngle=this.sessionVariables.labelMaxWidth>d?-25:this.sessionVariables.labelAngle,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelWrap=this.labelWrap);else this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxHeight=0===this.labelAngle?M:Math.min((k-d*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)),k),O=0!=this.labelAngle?(B-(R+o.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))/Math.sin(Math.PI/180*Math.abs(this.labelAngle)):d,this.sessionVariables.labelMaxHeight=this.labelWrap?(B-O*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))/Math.cos(Math.PI/180*Math.abs(this.labelAngle)):1.5*this.labelFontSize,Et(this.options.labelWrap)?Et(this.options.labelWrap)&&(this.labelWrap&&!Et(this.options.labelMaxWidth)?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:O,this.sessionVariables.labelMaxHeight=M):(this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxWidth=O,this.sessionVariables.labelMaxHeight=k<.9*C?.9*C:k,this.sessionVariables.labelWrap=this.labelWrap)):(this.options.labelWrap?(this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:O):(Et(this.options.labelMaxWidth),this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:O,this.sessionVariables.labelWrap=this.labelWrap),this.sessionVariables.labelMaxHeight=M)}for(k=0;k<this._labels.length;k++)(o=this._labels[k].textBlock).maxWidth=this.labelMaxWidth=this.sessionVariables.labelMaxWidth,o.fontSize=this.sessionVariables.labelFontSize,o.angle=this.labelAngle=this.sessionVariables.labelAngle,o.wrap=this.labelWrap=this.sessionVariables.labelWrap,o.maxHeight=this.sessionVariables.labelMaxHeight,o.measureText()}else for(f=0;f<this._labels.length;f++)(o=this._labels[f].textBlock).maxWidth=this.labelMaxWidth=Et(this.options.labelMaxWidth)?Et(this.sessionVariables.labelMaxWidth)?this.sessionVariables.labelMaxWidth=d:this.sessionVariables.labelMaxWidth:this.options.labelMaxWidth,o.fontSize=this.labelFontSize=Et(this.options.labelFontSize)?Et(this.sessionVariables.labelFontSize)?this.sessionVariables.labelFontSize=this.labelFontSize:this.sessionVariables.labelFontSize:this.options.labelFontSize,o.angle=this.labelAngle=Et(this.options.labelAngle)?Et(this.sessionVariables.labelAngle)?this.sessionVariables.labelAngle=this.labelAngle:this.sessionVariables.labelAngle:this.labelAngle,o.wrap=this.labelWrap=Et(this.options.labelWrap)?Et(this.sessionVariables.labelWrap)?this.sessionVariables.labelWrap=this.labelWrap:this.sessionVariables.labelWrap:this.options.labelWrap,o.maxHeight=Et(this.sessionVariables.labelMaxHeight)?this.sessionVariables.labelMaxHeight=M:this.sessionVariables.labelMaxHeight,o.measureText();else if("left"===this._position||"right"===this._position)if(d=Et(this.options.labelMaxWidth)?.3*this.chart.width>>0:this.options.labelMaxWidth,M=typeof this.options.labelWrap>"u"||this.labelWrap?.3*this.chart.height>>0:1.5*this.labelFontSize,!this.chart.panEnabled&&1<=this._labels.length){for(this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelAngle=Et(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle,this.sessionVariables.labelWrap=this.labelWrap,f=0;f<this._labels.length;f++)if(!this._labels[f].breaksLabelType){for(Y=(o=this._labels[f].textBlock).measureText(),E=f+1;E<this._labels.length;E++)if(!this._labels[E].breaksLabelType){y=(y=this._labels[E].textBlock).measureText();break}c.push(o.height),this.sessionVariables.labelMaxHeight=Math.max.apply(Math,c),k=d*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(M-o.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.cos(Math.PI/180*Math.abs(this.labelAngle)),Math.sin(Math.PI/180*Math.abs(this.labelAngle)),Et(this.options.labelAngle)&&isNaN(this.options.labelAngle)&&0!==this.options.labelAngle?Et(this.options.labelWrap)?Et(this.options.labelWrap)&&(Et(this.options.labelMaxWidth)?Et(y)||(C=Y.height+y.height>>0)-2*M>X&&(X=C-2*M,C>=2*M&&C<2.4*M?(Et(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),o.measureText()),this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize):C>=2.4*M&&C<2.8*M?(this.sessionVariables.labelMaxHeight=k,this.sessionVariables.labelFontSize=this.labelFontSize,this.sessionVariables.labelWrap=!0):C>=2.8*M&&C<3.2*M?(this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelWrap=!0,Et(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelAngle=Et(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle):C>=3.2*M&&C<3.6*M?(this.sessionVariables.labelMaxHeight=k,this.sessionVariables.labelWrap=!0,this.sessionVariables.labelFontSize=this.labelFontSize):C>3.6*M&&C<10*M?(Et(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelAngle=Et(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle):C>10*M&&C<50*M&&(Et(this.options.labelFontSize)&&12<this.labelFontSize&&(this.labelFontSize=Math.floor(12/13*this.labelFontSize),o.measureText()),this.sessionVariables.labelFontSize=Et(this.options.labelFontSize)?this.labelFontSize:this.options.labelFontSize,this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelMaxWidth=d,this.sessionVariables.labelAngle=Et(this.sessionVariables.labelAngle)?0:this.sessionVariables.labelAngle)):(this.sessionVariables.labelMaxHeight=M,this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth)):(this.sessionVariables.labelMaxWidth=this.labelWrap||this.labelMaxWidth?this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth:d,this.sessionVariables.labelMaxHeight=M):(this.sessionVariables.labelAngle=this.labelAngle,this.sessionVariables.labelMaxWidth=0===this.labelAngle?d:Math.min((k-M*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))/Math.cos(Math.PI/180*Math.abs(this.labelAngle)),M),Et(this.options.labelWrap)?Et(this.options.labelWrap)&&(this.labelWrap&&!Et(this.options.labelMaxWidth)?(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth,this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxHeight=k):(this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:d,this.sessionVariables.labelMaxHeight=0===this.labelAngle?M:k,Et(this.options.labelMaxWidth)&&(this.sessionVariables.labelAngle=this.labelAngle))):this.options.labelWrap?(this.sessionVariables.labelMaxHeight=0===this.labelAngle?M:k,this.sessionVariables.labelWrap=this.labelWrap,this.sessionVariables.labelMaxWidth=d):(this.sessionVariables.labelMaxHeight=M,Et(this.options.labelMaxWidth),this.sessionVariables.labelMaxWidth=this.options.labelMaxWidth?this.options.labelMaxWidth:this.sessionVariables.labelMaxWidth,this.sessionVariables.labelWrap=this.labelWrap))}for(k=0;k<this._labels.length;k++)(o=this._labels[k].textBlock).maxWidth=this.labelMaxWidth=this.sessionVariables.labelMaxWidth,o.fontSize=this.labelFontSize=this.sessionVariables.labelFontSize,o.angle=this.labelAngle=this.sessionVariables.labelAngle,o.wrap=this.labelWrap=this.sessionVariables.labelWrap,o.maxHeight=this.sessionVariables.labelMaxHeight,o.measureText()}else for(f=0;f<this._labels.length;f++)(o=this._labels[f].textBlock).maxWidth=this.labelMaxWidth=Et(this.options.labelMaxWidth)?Et(this.sessionVariables.labelMaxWidth)?this.sessionVariables.labelMaxWidth=d:this.sessionVariables.labelMaxWidth:this.options.labelMaxWidth,o.fontSize=this.labelFontSize=Et(this.options.labelFontSize)?Et(this.sessionVariables.labelFontSize)?this.sessionVariables.labelFontSize=this.labelFontSize:this.sessionVariables.labelFontSize:this.options.labelFontSize,o.angle=this.labelAngle=Et(this.options.labelAngle)?Et(this.sessionVariables.labelAngle)?this.sessionVariables.labelAngle=this.labelAngle:this.sessionVariables.labelAngle:this.labelAngle,o.wrap=this.labelWrap=Et(this.options.labelWrap)?Et(this.sessionVariables.labelWrap)?this.sessionVariables.labelWrap=this.labelWrap:this.sessionVariables.labelWrap:this.options.labelWrap,o.maxHeight=Et(this.sessionVariables.labelMaxHeight)?this.sessionVariables.labelMaxHeight=M:this.sessionVariables.labelMaxHeight,o.measureText();for(f=0;f<this.stripLines.length;f++){var J;"outside"===(d=this.stripLines[f]).labelPlacement?(M=this.sessionVariables.labelMaxWidth,("bottom"===this._position||"top"===this._position)&&(Et(d.options.labelWrap)&&!Et(this.sessionVariables.stripLineLabelMaxHeight)?J=this.sessionVariables.stripLineLabelMaxHeight:this.sessionVariables.stripLineLabelMaxHeight=J=d.labelWrap?.8*this.chart.height>>0:1.5*this.labelFontSize),("left"===this._position||"right"===this._position)&&(Et(d.options.labelWrap)&&!Et(this.sessionVariables.stripLineLabelMaxHeight)?J=this.sessionVariables.stripLineLabelMaxHeight:this.sessionVariables.stripLineLabelMaxHeight=J=d.labelWrap?.8*this.chart.width>>0:1.5*this.labelFontSize),Et(d.labelBackgroundColor)&&(d.labelBackgroundColor="#EEEEEE")):(M="bottom"===this._position||"top"===this._position?.9*this.chart.width>>0:.9*this.chart.height>>0,J=Et(d.options.labelWrap)||d.labelWrap?"bottom"===this._position||"top"===this._position?.8*this.chart.width>>0:.8*this.chart.height>>0:1.5*this.labelFontSize,Et(d.labelBackgroundColor)&&(d.labelBackgroundColor=Et(d.startValue)&&0!==d.startValue?rt?"transparent":null:"#EEEEEE")),o=new En(this.ctx,{x:0,y:0,backgroundColor:d.labelBackgroundColor,borderColor:d.labelBorderColor,borderThickness:d.labelBorderThickness,cornerRadius:d.labelCornerRadius,maxWidth:d.options.labelMaxWidth?d.options.labelMaxWidth:M,maxHeight:J,angle:this.labelAngle,text:d.labelFormatter?d.labelFormatter({chart:this.chart,axis:this,stripLine:d}):d.label,textAlign:this.labelTextAlign,fontSize:"outside"===d.labelPlacement?d.options.labelFontSize?d.labelFontSize:this.labelFontSize:d.labelFontSize,fontFamily:"outside"===d.labelPlacement?d.options.labelFontFamily?d.labelFontFamily:this.labelFontFamily:d.labelFontFamily,fontWeight:"outside"===d.labelPlacement?d.options.labelFontWeight?d.labelFontWeight:this.labelFontWeight:d.labelFontWeight,fontColor:d.labelFontColor||d.color,fontStyle:"outside"===d.labelPlacement?d.options.labelFontStyle?d.labelFontStyle:this.fontWeight:d.labelFontStyle,textBaseline:"middle"}),this._stripLineLabels.push({position:d.value,textBlock:o,effectiveHeight:null,stripLine:d})}},wt.prototype.createLabelsAndCalculateWidth=function(){var o=0,y=0;this._labels=[],this._stripLineLabels=[];var f=this.chart.isNavigator?0:5;if("left"===this._position||"right"===this._position){if(this.createLabels(),"inside"!=this.labelPlacement||"inside"===this.labelPlacement&&0<this._index)for(y=0;y<this._labels.length;y++){var c=this._labels[y].textBlock,d=c.measureText(),M=0;o<(M=0===this.labelAngle?d.width:d.width*Math.cos(Math.PI/180*Math.abs(this.labelAngle))+(d.height-c.fontSize/2)*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))&&(o=M),this._labels[y].effectiveWidth=M}for(y=0;y<this._stripLineLabels.length;y++)"outside"===this._stripLineLabels[y].stripLine.labelPlacement&&this._stripLineLabels[y].stripLine.value>=this.viewportMinimum&&this._stripLineLabels[y].stripLine.value<=this.viewportMaximum&&(d=(c=this._stripLineLabels[y].textBlock).measureText(),o<(M=0===this.labelAngle?d.width:d.width*Math.cos(Math.PI/180*Math.abs(this.labelAngle))+(d.height-c.fontSize/2)*Math.sin(Math.PI/180*Math.abs(this.labelAngle)))&&(o=M),this._stripLineLabels[y].effectiveWidth=M)}return(this.title?this._titleTextBlock.measureText().height+2:0)+o+("inside"===this.tickPlacement?0:this.tickLength)+f},wt.prototype.createLabelsAndCalculateHeight=function(){var o=0;this._labels=[],this._stripLineLabels=[];var y,f=0,c=this.chart.isNavigator?0:5;if("bottom"===this._position||"top"===this._position){if(this.createLabels(),"inside"!=this.labelPlacement||"inside"===this.labelPlacement&&0<this._index)for(f=0;f<this._labels.length;f++){var d=(y=this._labels[f].textBlock).measureText(),M=0;o<(M=0===this.labelAngle?d.height:d.width*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(d.height-y.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))&&(o=M),this._labels[f].effectiveHeight=M}for(f=0;f<this._stripLineLabels.length;f++)"outside"===this._stripLineLabels[f].stripLine.labelPlacement&&this._stripLineLabels[f].stripLine.value>=this.viewportMinimum&&this._stripLineLabels[f].stripLine.value<=this.viewportMaximum&&(d=(y=this._stripLineLabels[f].textBlock).measureText(),o<(M=0===this.labelAngle?d.height:d.width*Math.sin(Math.PI/180*Math.abs(this.labelAngle))+(d.height-y.fontSize/2)*Math.cos(Math.PI/180*Math.abs(this.labelAngle)))&&(o=M),this._stripLineLabels[f].effectiveHeight=M)}return(this.title?this._titleTextBlock.measureText().height+2:0)+o+("inside"===this.tickPlacement?0:this.tickLength)+c},wt.setLayout=function(o,y,f,c,d,M){var k,C,R,B,O=o[0]?o[0].chart:y[0].chart,L=O.isNavigator?0:10,X=O._axes;if(o&&0<o.length)for(var E=0;E<o.length;E++)o[E]&&o[E].calculateAxisParameters();if(y&&0<y.length)for(E=0;E<y.length;E++)y[E].calculateAxisParameters();if(f&&0<f.length)for(E=0;E<f.length;E++)f[E].calculateAxisParameters();if(c&&0<c.length)for(E=0;E<c.length;E++)c[E].calculateAxisParameters();for(E=0;E<X.length;E++)if(X[E]&&X[E].scaleBreaks&&X[E].scaleBreaks._appliedBreaks.length)for(var Y=X[E].scaleBreaks._appliedBreaks,it=0;it<Y.length&&!(Y[it].startValue>X[E].viewportMaximum);it++)Y[it].endValue<X[E].viewportMinimum||(Et(X[E].scaleBreaks.firstBreakIndex)&&(X[E].scaleBreaks.firstBreakIndex=it),Y[it].startValue>=X[E].viewPortMinimum&&(X[E].scaleBreaks.lastBreakIndex=it));var mt,Tt,Ft,vt,le,J=it=0,q=0,nt=0,dt=0,gt=0,kt=0,ee=C=0;for(Y=Ft=vt=le=!1,E=0;E<X.length;E++)X[E]&&X[E].title&&(X[E]._titleTextBlock=new En(X[E].ctx,{text:X[E].title,horizontalAlign:"center",fontSize:X[E].titleFontSize,fontFamily:X[E].titleFontFamily,fontWeight:X[E].titleFontWeight,fontColor:X[E].titleFontColor,fontStyle:X[E].titleFontStyle,borderColor:X[E].titleBorderColor,borderThickness:X[E].titleBorderThickness,backgroundColor:X[E].titleBackgroundColor,cornerRadius:X[E].titleCornerRadius,textBaseline:"top"}));for(E=0;E<X.length;E++)if(X[E].title)switch(X[E]._position){case"left":X[E]._titleTextBlock.maxWidth=X[E].titleMaxWidth||M.height,X[E]._titleTextBlock.maxHeight=X[E].titleWrap?.8*M.width:1.5*X[E].titleFontSize,X[E]._titleTextBlock.angle=-90;break;case"right":X[E]._titleTextBlock.maxWidth=X[E].titleMaxWidth||M.height,X[E]._titleTextBlock.maxHeight=X[E].titleWrap?.8*M.width:1.5*X[E].titleFontSize,X[E]._titleTextBlock.angle=90;break;default:X[E]._titleTextBlock.maxWidth=X[E].titleMaxWidth||M.width,X[E]._titleTextBlock.maxHeight=X[E].titleWrap?.8*M.height:1.5*X[E].titleFontSize,X[E]._titleTextBlock.angle=0}if("normal"===d){nt=[],dt=[],gt=[],kt=[];for(var Ht=[],jt=[],ye=[],Rt=[];4>it;){var se=0,Ue=0,ni=0,li=0,$i=d=0,wi=0,wn=0,Ni=0,ji=0,_e=0,os=0;if(f&&0<f.length)for(gt=[],E=_e=0;E<f.length;E++)gt.push(Math.ceil(f[E]?f[E].createLabelsAndCalculateWidth():0)),_e+=gt[E],wi+=f[E]&&!O.isNavigator?f[E].margin:0;else gt.push(Math.ceil(f[0]?f[0].createLabelsAndCalculateWidth():0));if(ye.push(gt),c&&0<c.length)for(kt=[],E=os=0;E<c.length;E++)kt.push(Math.ceil(c[E]?c[E].createLabelsAndCalculateWidth():0)),os+=kt[E],wn+=c[E]?c[E].margin:0;else kt.push(Math.ceil(c[0]?c[0].createLabelsAndCalculateWidth():0));if(Rt.push(kt),k=Math.round(M.x1+_e+wi),R=Math.round(M.x2-os-wn>O.width-L?O.width-L:M.x2-os-wn),o&&0<o.length)for(nt=[],E=Ni=0;E<o.length;E++)o[E]&&(o[E].lineCoordinates={}),o[E].lineCoordinates.width=Math.abs(R-k),o[E].title&&(o[E]._titleTextBlock.maxWidth=0<o[E].titleMaxWidth&&o[E].titleMaxWidth<o[E].lineCoordinates.width?o[E].titleMaxWidth:o[E].lineCoordinates.width),nt.push(Math.ceil(o[E]?o[E].createLabelsAndCalculateHeight():0)),Ni+=nt[E],d+=o[E]&&!O.isNavigator?o[E].margin:0;else nt.push(Math.ceil(o[0]?o[0].createLabelsAndCalculateHeight():0));if(Ht.push(nt),y&&0<y.length)for(dt=[],E=ji=0;E<y.length;E++)y[E]&&(y[E].lineCoordinates={}),y[E].lineCoordinates.width=Math.abs(R-k),y[E].title&&(y[E]._titleTextBlock.maxWidth=0<y[E].titleMaxWidth&&y[E].titleMaxWidth<y[E].lineCoordinates.width?y[E].titleMaxWidth:y[E].lineCoordinates.width),dt.push(Math.ceil(y[E]?y[E].createLabelsAndCalculateHeight():0)),ji+=dt[E],$i+=y[E]&&!O.isNavigator?y[E].margin:0;else dt.push(Math.ceil(y[0]?y[0].createLabelsAndCalculateHeight():0));if(jt.push(dt),o&&0<o.length)for(E=0;E<o.length;E++)o[E]&&(o[E].lineCoordinates.x1=k,R=Math.round(M.x2-os-wn>O.width-L?O.width-L:M.x2-os-wn),o[E]._labels&&1<o[E]._labels.length&&(C=B=0,C="dateTime"===o[E].valueType?o[E]._labels[o[E]._labels.length-2]:o[E]._labels[o[E]._labels.length-1],J=(B=o[E]._labels[1]).textBlock.width*Math.cos(Math.PI/180*Math.abs(B.textBlock.angle))+(B.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(B.textBlock.angle)),q=C.textBlock.width*Math.cos(Math.PI/180*Math.abs(C.textBlock.angle))+(C.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(C.textBlock.angle))),!o[E]||!o[E].labelAutoFit||Et(mt)||Et(Tt)||O.isNavigator||O.stockChart||(C=0,0<o[E].labelAngle?Tt+q>R&&(C+=0<o[E].labelAngle?Tt+q-R-os:0):0>o[E].labelAngle?mt-J<k&&mt-J<o[E].viewportMinimum&&(ee=k-(wi+o[E].tickLength+gt+mt-J+o[E].labelFontSize/2)):0===o[E].labelAngle&&(Tt+q>R&&(C=Tt+q/2-R-os),mt-J<k&&mt-J<o[E].viewportMinimum&&(ee=k-wi-o[E].tickLength-gt-mt+J/2)),o[E].viewportMaximum===o[E].maximum&&o[E].viewportMinimum===o[E].minimum&&0<o[E].labelAngle&&0<C?R-=C:o[E].viewportMaximum===o[E].maximum&&o[E].viewportMinimum===o[E].minimum&&0>o[E].labelAngle&&0<ee?k+=ee:o[E].viewportMaximum===o[E].maximum&&o[E].viewportMinimum===o[E].minimum&&0===o[E].labelAngle&&(0<ee&&(k+=ee),0<C&&(R-=C))),O.panEnabled?Ni=Et(O.sessionVariables.axisX.height)?O.sessionVariables.axisX.height=Ni:O.sessionVariables.axisX.height:O.sessionVariables.axisX.height=Ni,C=Math.round(M.y2-Ni-d+se),B=Math.round(M.y2),o[E].lineCoordinates.x2=R,o[E].lineCoordinates.width=R-k,o[E].lineCoordinates.y1=C,o[E].lineCoordinates.y2=C+o[E].lineThickness/2,"inside"===o[E].labelPlacement&&0<E&&(o[E].lineCoordinates.y1=o[E].lineCoordinates.y1+nt[E]-(o[E]._titleTextBlock?o[E]._titleTextBlock.height:0)-("inside"===o[E].tickPlacement?o[E].tickLength:0),o[E].lineCoordinates.y2=o[E].lineCoordinates.y1+o[E].lineThickness/2),o[E].bounds={x1:k,y1:C,x2:R,y2:B-(Ni+d-nt[E]-se),width:R-k,height:B-C}),se+=nt[E]+o[E].margin;if(y&&0<y.length)for(E=0;E<y.length;E++)y[E].lineCoordinates.x1=Math.round(M.x1+_e+wi),y[E].lineCoordinates.x2=Math.round(M.x2-os-wn>O.width-L?O.width-L:M.x2-os-wn),y[E].lineCoordinates.width=Math.abs(R-k),y[E]._labels&&1<y[E]._labels.length&&(C="dateTime"===y[E].valueType?y[E]._labels[y[E]._labels.length-2]:y[E]._labels[y[E]._labels.length-1],J=(B=y[E]._labels[1]).textBlock.width*Math.cos(Math.PI/180*Math.abs(B.textBlock.angle))+(B.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(B.textBlock.angle)),q=C.textBlock.width*Math.cos(Math.PI/180*Math.abs(C.textBlock.angle))+(C.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(C.textBlock.angle))),O.panEnabled?ji=Et(O.sessionVariables.axisX2.height)?O.sessionVariables.axisX2.height=ji:O.sessionVariables.axisX2.height:O.sessionVariables.axisX2.height=ji,C=Math.round(M.y1),B=Math.round(M.y2+y[E].margin),y[E].lineCoordinates.y1=C+ji+$i-Ue,y[E].lineCoordinates.y2=C,"inside"===y[E].labelPlacement&&0<E&&(y[E].lineCoordinates.y1=y[E-1].bounds.y1-dt[E]+(y[E]._titleTextBlock?y[E]._titleTextBlock.height:0)),y[E].bounds={x1:k,y1:C+(ji+$i-dt[E]-Ue),x2:R,y2:B,width:R-k,height:B-C},Ue+=dt[E]+y[E].margin;if(f&&0<f.length)for(E=0;E<f.length;E++)wi=O.isNavigator?0:10,f[E]&&(k=Math.round(o[0]?o[0].lineCoordinates.x1:y[0].lineCoordinates.x1),wi=f[E]._labels&&0<f[E]._labels.length?f[E]._labels[f[E]._labels.length-1].textBlock.height/2:L,C=Math.round(M.y1+ji+$i<Math.max(wi,L)?Math.max(wi,L):M.y1+ji+$i),R=Math.round(o[0]?o[0].lineCoordinates.x1:y[0].lineCoordinates.x1),wi=0<o.length?0:f[E]._labels&&0<f[E]._labels.length?f[E]._labels[0].textBlock.height/2:L,B=Math.round(M.y2-Ni-d-wi),f[E].lineCoordinates={x1:k-ni,y1:C,x2:R-ni,y2:B,height:Math.abs(B-C)},"inside"===f[E].labelPlacement&&0<E&&(f[E].lineCoordinates.x1=f[E].lineCoordinates.x1-(gt[E]-(f[E]._titleTextBlock?f[E]._titleTextBlock.height:0))+("outside"===f[E].tickPlacement?f[E].tickLength:0),f[E].lineCoordinates.x2=f[E].lineCoordinates.x1+f[E].lineThickness/2),f[E].bounds={x1:k-(gt[E]+ni),y1:C,x2:R,y2:B,width:R-k,height:B-C},f[E].title&&(f[E]._titleTextBlock.maxWidth=0<f[E].titleMaxWidth&&f[E].titleMaxWidth<f[E].lineCoordinates.height?f[E].titleMaxWidth:f[E].lineCoordinates.height),ni+=gt[E]+f[E].margin);if(c&&0<c.length)for(E=0;E<c.length;E++)c[E]&&(k=Math.round(o[0]?o[0].lineCoordinates.x2:y[0].lineCoordinates.x2),R=Math.round(k),wi=c[E]._labels&&0<c[E]._labels.length?c[E]._labels[c[E]._labels.length-1].textBlock.height/2:0,C=Math.round(M.y1+ji+$i<Math.max(wi,L)?Math.max(wi,L):M.y1+ji+$i),wi=0<o.length?0:c[E]._labels&&0<c[E]._labels.length?c[E]._labels[0].textBlock.height/2:0,B=Math.round(M.y2-(Ni+d+wi)),c[E].lineCoordinates={x1:k+li,y1:C,x2:k+li,y2:B,height:Math.abs(B-C)},"inside"===c[E].labelPlacement&&0<E&&(c[E].lineCoordinates.x1=c[E].lineCoordinates.x1+(kt[E]-(c[E]._titleTextBlock?c[E]._titleTextBlock.height:0))-("outside"===c[E].tickPlacement?c[E].tickLength:0)-2,c[E].lineCoordinates.x2=c[E].lineCoordinates.x1+c[E].lineThickness/2),c[E].bounds={x1:k,y1:C,x2:R+(kt[E]+li),y2:B,width:R-k,height:B-C},c[E].title&&(c[E]._titleTextBlock.maxWidth=0<c[E].titleMaxWidth&&c[E].titleMaxWidth<c[E].lineCoordinates.height?c[E].titleMaxWidth:c[E].lineCoordinates.height),li+=kt[E]+c[E].margin);if(o&&0<o.length)for(E=0;E<o.length;E++)o[E]&&(o[E].calculateValueToPixelConversionParameters(),o[E].calculateBreaksSizeInValues(),o[E]._labels&&1<o[E]._labels.length&&(mt=(o[E].logarithmic?Math.log(o[E]._labels[1].position/o[E].viewportMinimum)/o[E].conversionParameters.lnLogarithmBase:o[E]._labels[1].position-o[E].viewportMinimum)*Math.abs(o[E].conversionParameters.pixelPerUnit)+o[E].lineCoordinates.x1,k=o[E].getApparentDifference(o[E].viewportMinimum,k=o[E]._labels[o[E]._labels.length-("dateTime"===o[E].valueType?2:1)].position),Tt=o[E].logarithmic?(1<k?Math.log(k)/o[E].conversionParameters.lnLogarithmBase*Math.abs(o[E].conversionParameters.pixelPerUnit):0)+o[E].lineCoordinates.x1:(0<k?k*Math.abs(o[E].conversionParameters.pixelPerUnit):0)+o[E].lineCoordinates.x1));if(y&&0<y.length)for(E=0;E<y.length;E++)y[E].calculateValueToPixelConversionParameters(),y[E].calculateBreaksSizeInValues(),y[E]._labels&&1<y[E]._labels.length&&(mt=(y[E].logarithmic?Math.log(y[E]._labels[1].position/y[E].viewportMinimum)/y[E].conversionParameters.lnLogarithmBase:y[E]._labels[1].position-y[E].viewportMinimum)*Math.abs(y[E].conversionParameters.pixelPerUnit)+y[E].lineCoordinates.x1,k=y[E].getApparentDifference(y[E].viewportMinimum,k=y[E]._labels[y[E]._labels.length-("dateTime"===y[E].valueType?2:1)].position),Tt=y[E].logarithmic?(1<k?Math.log(k)/y[E].conversionParameters.lnLogarithmBase*Math.abs(y[E].conversionParameters.pixelPerUnit):0)+y[E].lineCoordinates.x1:(0<k?k*Math.abs(y[E].conversionParameters.pixelPerUnit):0)+y[E].lineCoordinates.x1);for(E=0;E<X.length;E++)"axisY"===X[E].type&&(X[E].calculateValueToPixelConversionParameters(),X[E].calculateBreaksSizeInValues());if(0<it){if(o&&0<o.length)for(E=0;E<o.length;E++)Y=Ht[it-1][E]===Ht[it][E];else Y=!0;if(y&&0<y.length)for(E=0;E<y.length;E++)Ft=jt[it-1][E]===jt[it][E];else Ft=!0;if(f&&0<f.length)for(E=0;E<f.length;E++)vt=ye[it-1][E]===ye[it][E];else vt=!0;if(c&&0<c.length)for(E=0;E<c.length;E++)le=Rt[it-1][E]===Rt[it][E];else le=!0}if(Y&&Ft&&vt&&le)break;it++}if(o&&0<o.length)for(E=0;E<o.length;E++)o[E].calculateStripLinesThicknessInValues(),o[E].calculateBreaksInPixels();if(y&&0<y.length)for(E=0;E<y.length;E++)y[E].calculateStripLinesThicknessInValues(),y[E].calculateBreaksInPixels();if(f&&0<f.length)for(E=0;E<f.length;E++)f[E].calculateStripLinesThicknessInValues(),f[E].calculateBreaksInPixels();if(c&&0<c.length)for(E=0;E<c.length;E++)c[E].calculateStripLinesThicknessInValues(),c[E].calculateBreaksInPixels()}else{for(L=[],mt=[],ee=[],J=[],Tt=[],q=[],Ht=[],jt=[];4>it;){if(Ni=li=Ue=ni=wn=wi=$i=d=Rt=ye=se=ji=0,o&&0<o.length)for(ee=[],E=li=0;E<o.length;E++)ee.push(Math.ceil(o[E]?o[E].createLabelsAndCalculateWidth():0)),li+=ee[E],d+=o[E]&&!O.isNavigator?o[E].margin:0;else ee.push(Math.ceil(o[0]?o[0].createLabelsAndCalculateWidth():0));if(Ht.push(ee),y&&0<y.length)for(J=[],E=Ni=0;E<y.length;E++)J.push(Math.ceil(y[E]?y[E].createLabelsAndCalculateWidth():0)),Ni+=J[E],$i+=y[E]?y[E].margin:0;else J.push(Math.ceil(y[0]?y[0].createLabelsAndCalculateWidth():0));if(jt.push(J),f&&0<f.length)for(E=0;E<f.length;E++)f[E].lineCoordinates={},k=Math.round(M.x1+li+d),R=Math.round(M.x2-Ni-$i>O.width-10?O.width-10:M.x2-Ni-$i),f[E].labelAutoFit&&!Et(nt)&&(0<!o.length&&(k=0>f[E].labelAngle?Math.max(k,nt):0===f[E].labelAngle?Math.max(k,nt/2):k),0<!y.length&&(R=0<f[E].labelAngle||0===f[E].labelAngle?R-dt/2:R)),f[E].lineCoordinates.x1=k,f[E].lineCoordinates.x2=R,f[E].lineCoordinates.width=Math.abs(R-k),f[E].title&&(f[E]._titleTextBlock.maxWidth=0<f[E].titleMaxWidth&&f[E].titleMaxWidth<f[E].lineCoordinates.width?f[E].titleMaxWidth:f[E].lineCoordinates.width);if(c&&0<c.length)for(E=0;E<c.length;E++)c[E].lineCoordinates={},k=Math.round(M.x1+li+d),R=Math.round(M.x2-Ni-$i>c[E].chart.width-10?c[E].chart.width-10:M.x2-Ni-$i),c[E]&&c[E].labelAutoFit&&!Et(gt)&&(0<!o.length&&(k=0<c[E].labelAngle?Math.max(k,gt):0===c[E].labelAngle?Math.max(k,gt/2):k),0<!y.length&&(R-=kt/2)),c[E].lineCoordinates.x1=k,c[E].lineCoordinates.x2=R,c[E].lineCoordinates.width=Math.abs(R-k),c[E].title&&(c[E]._titleTextBlock.maxWidth=0<c[E].titleMaxWidth&&c[E].titleMaxWidth<c[E].lineCoordinates.width?c[E].titleMaxWidth:c[E].lineCoordinates.width);if(f&&0<f.length)for(L=[],E=ni=0;E<f.length;E++)L.push(Math.ceil(f[E]?f[E].createLabelsAndCalculateHeight():0)),ni+=L[E]+f[E].margin,wi+=f[E].margin;else L.push(Math.ceil(f[0]?f[0].createLabelsAndCalculateHeight():0));if(Tt.push(L),c&&0<c.length)for(mt=[],E=Ue=0;E<c.length;E++)mt.push(Math.ceil(c[E]?c[E].createLabelsAndCalculateHeight():0)),Ue+=mt[E],wn+=c[E].margin;else mt.push(Math.ceil(c[0]?c[0].createLabelsAndCalculateHeight():0));if(q.push(mt),f&&0<f.length)for(E=0;E<f.length;E++)0<f[E]._labels.length&&(C=f[E]._labels[f[E]._labels.length-1],nt=(B=f[E]._labels[0]).textBlock.width*Math.cos(Math.PI/180*Math.abs(B.textBlock.angle))+(B.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(B.textBlock.angle)),dt=C.textBlock.width*Math.cos(Math.PI/180*Math.abs(C.textBlock.angle))+(C.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(C.textBlock.angle)));if(c&&0<c.length)for(E=0;E<c.length;E++)c[E]&&0<c[E]._labels.length&&(C=c[E]._labels[c[E]._labels.length-1],gt=(B=c[E]._labels[0]).textBlock.width*Math.cos(Math.PI/180*Math.abs(B.textBlock.angle))+(B.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(B.textBlock.angle)),kt=C.textBlock.width*Math.cos(Math.PI/180*Math.abs(C.textBlock.angle))+(C.textBlock.height-C.textBlock.fontSize/2)*Math.sin(Math.PI/180*Math.abs(C.textBlock.angle)));if(O.panEnabled)for(E=0;E<f.length;E++)L[E]=Et(O.sessionVariables.axisY.height)?O.sessionVariables.axisY.height=L[E]:O.sessionVariables.axisY.height;else for(E=0;E<f.length;E++)O.sessionVariables.axisY.height=L[E];if(f&&0<f.length)for(E=f.length-1;0<=E;E--)C=Math.round(M.y2),B=Math.round(M.y2>f[E].chart.height?f[E].chart.height:M.y2),f[E].lineCoordinates.y1=C-(L[E]+f[E].margin+ji),f[E].lineCoordinates.y2=C-(L[E]+f[E].margin+ji),"inside"===f[E].labelPlacement&&0<E&&(f[E].lineCoordinates.y1=f[E].lineCoordinates.y1+L[E]-(f[E]._titleTextBlock?f[E]._titleTextBlock.height:0)-("inside"===f[E].tickPlacement?f[E].tickLength:0),f[E].lineCoordinates.y2=f[E].lineCoordinates.y1+f[E].lineThickness/2),f[E].bounds={x1:k,y1:C-(L[E]+ji+f[E].margin),x2:R,y2:B-(ji+f[E].margin),width:R-k,height:L[E]},f[E].title&&(f[E]._titleTextBlock.maxWidth=0<f[E].titleMaxWidth&&f[E].titleMaxWidth<f[E].lineCoordinates.width?f[E].titleMaxWidth:f[E].lineCoordinates.width),ji+=L[E]+f[E].margin;if(c&&0<c.length)for(E=c.length-1;0<=E;E--)c[E]&&(C=Math.round(M.y1),B=Math.round(M.y1+(mt[E]+c[E].margin+se)),c[E].lineCoordinates.y1=B,c[E].lineCoordinates.y2=B,"inside"===c[E].labelPlacement&&0<E&&(c[E].lineCoordinates.y1=B-mt[E]+(c[E]._titleTextBlock?c[E]._titleTextBlock.height:0)),c[E].bounds={x1:k,y1:C+(c[E].margin+se),x2:R,y2:B,width:R-k,height:Ue},c[E].title&&(c[E]._titleTextBlock.maxWidth=0<c[E].titleMaxWidth&&c[E].titleMaxWidth<c[E].lineCoordinates.width?c[E].titleMaxWidth:c[E].lineCoordinates.width),se+=mt[E]+c[E].margin);if(o&&0<o.length)for(E=0;E<o.length;E++){if(wi=o[E]._labels&&0<o[E]._labels.length?o[E]._labels[0].textBlock.fontSize/2:0,k=Math.round(M.x1+d),C=c&&0<c.length?Math.round(c[0]?c[0].lineCoordinates.y2:M.y1<Math.max(wi,10)?Math.max(wi,10):M.y1):M.y1<Math.max(wi,10)?Math.max(wi,10):M.y1,R=Math.round(M.x1+li+d),B=f&&0<f.length?Math.round(f[0]?f[0].lineCoordinates.y1:M.y2-ni>O.height-Math.max(wi,10)?O.height-Math.max(wi,10):M.y2-ni):M.y2>O.height-Math.max(wi,10)?O.height-Math.max(wi,10):M.y2,f&&0<f.length)for(wi=0;wi<f.length;wi++)f[wi]&&f[wi].labelAutoFit&&(R=0>f[wi].labelAngle?Math.max(R,nt):0===f[wi].labelAngle?Math.max(R,nt/2):R,k=0>f[wi].labelAngle||0===f[wi].labelAngle?R-li:k);if(c&&0<c.length)for(wi=0;wi<c.length;wi++)c[wi]&&c[wi].labelAutoFit&&(k=(R=c[wi].lineCoordinates.x1)-li);o[E].lineCoordinates={x1:R-ye,y1:C,x2:R-ye,y2:B,height:Math.abs(B-C)},"inside"===o[E].labelPlacement&&0<E&&(o[E].lineCoordinates.x1=o[E].lineCoordinates.x1-(ee[E]-(o[E]._titleTextBlock?o[E]._titleTextBlock.height:0))+("outside"===o[E].tickPlacement?o[E].tickLength:0),o[E].lineCoordinates.x2=o[E].lineCoordinates.x1+o[E].lineThickness/2),o[E].bounds={x1:R-(ee[E]+ye),y1:C,x2:R,y2:B,width:R-k,height:B-C},o[E].title&&(o[E]._titleTextBlock.maxWidth=0<o[E].titleMaxWidth&&o[E].titleMaxWidth<o[E].lineCoordinates.height?o[E].titleMaxWidth:o[E].lineCoordinates.height),o[E].calculateValueToPixelConversionParameters(),o[E].calculateBreaksSizeInValues(),ye+=ee[E]+o[E].margin}if(y&&0<y.length)for(E=0;E<y.length;E++){if(wi=y[E]._labels&&0<y[E]._labels.length?y[E]._labels[0].textBlock.fontSize/2:0,k=Math.round(M.x1-d),C=c&&0<c.length?Math.round(c[0]?c[0].lineCoordinates.y2:M.y1<Math.max(wi,10)?Math.max(wi,10):M.y1):M.y1<Math.max(wi,10)?Math.max(wi,10):M.y1,R=Math.round(M.x2-Ni-$i),B=f&&0<f.length?Math.round(f[0]?f[0].lineCoordinates.y1:M.y2-ni>O.height-Math.max(wi,10)?O.height-Math.max(wi,10):M.y2-ni):M.y2>O.height-Math.max(wi,10)?O.height-Math.max(wi,10):M.y2,f&&0<f.length)for(wi=0;wi<f.length;wi++)f[wi]&&f[wi].labelAutoFit&&(R=0>f[wi].labelAngle?Math.max(R,nt):0===f[wi].labelAngle?Math.max(R,nt/2):R,k=0>f[wi].labelAngle||0===f[wi].labelAngle?R-Ni:k);if(c&&0<c.length)for(wi=0;wi<c.length;wi++)c[wi]&&c[wi].labelAutoFit&&(k=(R=c[wi].lineCoordinates.x2)-Ni);y[E].lineCoordinates={x1:R+Rt,y1:C,x2:R+Rt,y2:B,height:Math.abs(B-C)},"inside"===y[E].labelPlacement&&0<E&&(y[E].lineCoordinates.x1=y[E].lineCoordinates.x1+(J[E]-(y[E]._titleTextBlock?y[E]._titleTextBlock.height:0)-2)-("outside"===y[E].tickPlacement?y[E].tickLength:0),y[E].lineCoordinates.x2=y[E].lineCoordinates.x1+y[E].lineThickness/2),y[E].bounds={x1:y[E].lineCoordinates.x1,y1:C,x2:R+J[E]+Rt,y2:B,width:R-k,height:B-C},y[E].title&&(y[E]._titleTextBlock.maxWidth=0<y[E].titleMaxWidth&&y[E].titleMaxWidth<y[E].lineCoordinates.height?y[E].titleMaxWidth:y[E].lineCoordinates.height),y[E].calculateValueToPixelConversionParameters(),y[E].calculateBreaksSizeInValues(),Rt+=J[E]+y[E].margin}for(E=0;E<X.length;E++)"axisY"===X[E].type&&(X[E].calculateValueToPixelConversionParameters(),X[E].calculateBreaksSizeInValues());if(0<it){if(o&&0<o.length)for(E=0;E<o.length;E++)Y=Ht[it-1][E]===Ht[it][E];else Y=!0;if(y&&0<y.length)for(E=0;E<y.length;E++)Ft=jt[it-1][E]===jt[it][E];else Ft=!0;if(f&&0<f.length)for(E=0;E<f.length;E++)vt=Tt[it-1][E]===Tt[it][E];else vt=!0;if(c&&0<c.length)for(E=0;E<c.length;E++)le=q[it-1][E]===q[it][E];else le=!0}if(Y&&Ft&&vt&&le)break;it++}if(f&&0<f.length)for(E=0;E<f.length;E++)f[E].calculateStripLinesThicknessInValues(),f[E].calculateBreaksInPixels();if(c&&0<c.length)for(E=0;E<c.length;E++)c[E].calculateStripLinesThicknessInValues(),c[E].calculateBreaksInPixels();if(o&&0<o.length)for(E=0;E<o.length;E++)o[E].calculateStripLinesThicknessInValues(),o[E].calculateBreaksInPixels();if(y&&0<y.length)for(E=0;E<y.length;E++)y[E].calculateStripLinesThicknessInValues(),y[E].calculateBreaksInPixels()}},wt.render=function(o,y,f,c,d){var M=o[0]?o[0].chart:y[0].chart;if(d=M.ctx,M.alignVerticalAxes&&M.alignVerticalAxes(),d.save(),d.beginPath(),o[0]&&d.rect(5,o[0].bounds.y1,o[0].chart.width-10,o[0].bounds.height),y[0]&&d.rect(5,y[y.length-1].bounds.y1,y[0].chart.width-10,y[0].bounds.height),d.clip(),o&&0<o.length)for(var k=0;k<o.length;k++)o[k].renderLabelsTicksAndTitle();if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderLabelsTicksAndTitle();if(d.restore(),f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderLabelsTicksAndTitle();if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderLabelsTicksAndTitle();if(M.preparePlotArea(),M=M.plotArea,d.save(),d.beginPath(),d.rect(M.x1,M.y1,Math.abs(M.x2-M.x1),Math.abs(M.y2-M.y1)),d.clip(),o&&0<o.length)for(k=0;k<o.length;k++)o[k].renderStripLinesOfThicknessType("value");if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderStripLinesOfThicknessType("value");if(f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderStripLinesOfThicknessType("value");if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderStripLinesOfThicknessType("value");if(o&&0<o.length)for(k=0;k<o.length;k++)o[k].renderInterlacedColors();if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderInterlacedColors();if(f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderInterlacedColors();if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderInterlacedColors();if(d.restore(),o&&0<o.length)for(k=0;k<o.length;k++)o[k].renderGrid(),rt&&(o[k].createMask(),o[k].renderBreaksBackground());if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderGrid(),rt&&(y[k].createMask(),y[k].renderBreaksBackground());if(f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderGrid(),rt&&(f[k].createMask(),f[k].renderBreaksBackground());if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderGrid(),rt&&(c[k].createMask(),c[k].renderBreaksBackground());if(o&&0<o.length)for(k=0;k<o.length;k++)o[k].renderAxisLine();if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderAxisLine();if(f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderAxisLine();if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderAxisLine();if(o&&0<o.length)for(k=0;k<o.length;k++)o[k].renderStripLinesOfThicknessType("pixel");if(y&&0<y.length)for(k=0;k<y.length;k++)y[k].renderStripLinesOfThicknessType("pixel");if(f&&0<f.length)for(k=0;k<f.length;k++)f[k].renderStripLinesOfThicknessType("pixel");if(c&&0<c.length)for(k=0;k<c.length;k++)c[k].renderStripLinesOfThicknessType("pixel")},wt.prototype.calculateStripLinesThicknessInValues=function(){for(var o=0;o<this.stripLines.length;o++)if(null!==this.stripLines[o].startValue&&null!==this.stripLines[o].endValue){var f=Math.min(this.stripLines[o].startValue,this.stripLines[o].endValue),y=Math.max(this.stripLines[o].startValue,this.stripLines[o].endValue);f=this.getApparentDifference(f,y),this.stripLines[o].value=this.logarithmic?this.stripLines[o].value*Math.sqrt(Math.log(Math.max(this.stripLines[o].startValue,this.stripLines[o].endValue)/Math.min(this.stripLines[o].startValue,this.stripLines[o].endValue))/Math.log(f)):this.stripLines[o].value+(Math.abs(this.stripLines[o].endValue-this.stripLines[o].startValue)-f)/2,this.stripLines[o].thickness=f,this.stripLines[o]._thicknessType="value"}},wt.prototype.calculateBreaksSizeInValues=function(){for(var d,o="left"===this._position||"right"===this._position?this.lineCoordinates.height||this.chart.height:this.lineCoordinates.width||this.chart.width,y=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[],f=this.conversionParameters.pixelPerUnit||o/(this.logarithmic?this.conversionParameters.maximum/this.conversionParameters.minimum:this.conversionParameters.maximum-this.conversionParameters.minimum),c=this.scaleBreaks&&!Et(this.scaleBreaks.options.spacing),M=0;M<y.length;M++)d=c||!Et(y[M].options.spacing),y[M].spacing=Us(y[M].spacing,o,8,d?.1*o:8,d?0:3)<<0,y[M].size=0>y[M].spacing?0:Math.abs(y[M].spacing/f),this.logarithmic&&(y[M].size=Math.pow(this.logarithmBase,y[M].size))},wt.prototype.calculateBreaksInPixels=function(){if(!(this.scaleBreaks&&0>=this.scaleBreaks._appliedBreaks.length)){var o=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];o.length&&(this.scaleBreaks.firstBreakIndex=this.scaleBreaks.lastBreakIndex=null);for(var y=0;y<o.length&&!(o[y].startValue>this.conversionParameters.maximum);y++)o[y].endValue<this.conversionParameters.minimum||(Et(this.scaleBreaks.firstBreakIndex)&&(this.scaleBreaks.firstBreakIndex=y),o[y].startValue>=this.conversionParameters.minimum&&(o[y].startPixel=this.convertValueToPixel(o[y].startValue),this.scaleBreaks.lastBreakIndex=y),o[y].endValue<=this.conversionParameters.maximum&&(o[y].endPixel=this.convertValueToPixel(o[y].endValue)))}},wt.prototype.renderLabelsTicksAndTitle=function(){var L,X,o=this,y=!1,f=0,c=0,d=1,M=0;if(0!==this.labelAngle&&360!==this.labelAngle&&(d=1.2),typeof this.options.interval>"u"){if("bottom"===this._position||"top"===this._position)if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit){f=[],d=0!==this.labelAngle&&360!==this.labelAngle?1:1.2;for(var k,C=this.viewportMaximum,R=this.lineCoordinates.width/Math.log(this.range),O=this._labels.length-1;0<=O&&!((L=this._labels[O]).position<this.viewportMinimum);O--)L.position>this.viewportMaximum||!(O===this._labels.length-1||k<Math.log(C/L.position)*R/d)||(f.push(L),C=L.position,k=L.textBlock.width*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+L.textBlock.height*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));this._labels=f}else{for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||(f+=k=L.textBlock.width*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+L.textBlock.height*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));f>this.lineCoordinates.width*d&&this.labelAutoFit&&(y=!0)}if("left"===this._position||"right"===this._position)if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit){var B;for(f=[],C=this.viewportMaximum,R=this.lineCoordinates.height/Math.log(this.range),O=this._labels.length-1;0<=O&&!((L=this._labels[O]).position<this.viewportMinimum);O--)L.position>this.viewportMaximum||!(O===this._labels.length-1||B<Math.log(C/L.position)*R)||(f.push(L),C=L.position,B=L.textBlock.height*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+L.textBlock.width*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));this._labels=f}else{for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||(c+=B=L.textBlock.height*Math.abs(Math.cos(Math.PI/180*this.labelAngle))+L.textBlock.width*Math.abs(Math.sin(Math.PI/180*this.labelAngle)));c>this.lineCoordinates.height*d&&this.labelAutoFit&&(y=!0)}}if(this.logarithmic&&!this.equidistantInterval&&this.labelAutoFit&&this._labels.sort(function(E,Y){return E.position-Y.position}),O=0,"bottom"===this._position){for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||L.position>this.viewportMaximum||(X=this.getPixelCoordinatesOnAxis(L.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,c=this.ctx.lineWidth%2==1?.5+(X.x<<0):X.x<<0,this.ctx.beginPath(),this.ctx.moveTo(c,X.y<<0),this.ctx.lineTo(c,X.y+this.tickLength<<0),this.ctx.stroke()),y&&M++%2!=0&&this.labelAutoFit||(0===L.textBlock.angle?(X.x-=L.textBlock.width/2,X.y="inside"===this.labelPlacement?X.y-(("inside"===this.tickPlacement?this.tickLength:0)+L.textBlock.height-L.textBlock.fontSize/2):X.y+("inside"===this.tickPlacement?0:this.tickLength)+L.textBlock.fontSize/2+5):(X.x="inside"===this.labelPlacement?0>this.labelAngle?X.x:X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):X.x-(0>this.labelAngle?L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),X.y="inside"===this.labelPlacement?0>this.labelAngle?X.y-("inside"===this.tickPlacement?this.tickLength:0)-5:X.y-("inside"===this.tickPlacement?this.tickLength:0)-Math.abs(L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)+5):X.y+("inside"===this.tickPlacement?0:this.tickLength)+Math.abs(0>this.labelAngle?L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)-5:5)),L.textBlock.x=X.x,L.textBlock.y=X.y));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(O=0;O<o._labels.length;O++)if(!((L=o._labels[O]).position<o.viewportMinimum||L.position>o.viewportMaximum)&&(X=o.getPixelCoordinatesOnAxis(L.position),o.tickThickness)){o.ctx.lineWidth=o.tickThickness,o.ctx.strokeStyle=o.tickColor;var E=o.ctx.lineWidth%2==1?.5+(X.x<<0):X.x<<0;o.ctx.save(),o.ctx.beginPath(),o.ctx.moveTo(E,X.y<<0),o.ctx.lineTo(E,X.y-o.tickLength<<0),o.ctx.stroke(),o.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.lineCoordinates.x1+this.lineCoordinates.width/2-this._titleTextBlock.width/2,this._titleTextBlock.y=this.bounds.y2-this._titleTextBlock.height-3,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("top"===this._position){for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||L.position>this.viewportMaximum||(X=this.getPixelCoordinatesOnAxis(L.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,c=this.ctx.lineWidth%2==1?.5+(X.x<<0):X.x<<0,this.ctx.beginPath(),this.ctx.moveTo(c,X.y<<0),this.ctx.lineTo(c,X.y-this.tickLength<<0),this.ctx.stroke()),y&&M++%2!=0&&this.labelAutoFit||(0===L.textBlock.angle?(X.x-=L.textBlock.width/2,X.y="inside"===this.labelPlacement?X.y+this.labelFontSize/2+("inside"===this.tickPlacement?this.tickLength:0)+5:X.y-(("inside"===this.tickPlacement?0:this.tickLength)+L.textBlock.height-L.textBlock.fontSize/2)):(X.x="inside"===this.labelPlacement?0<this.labelAngle?X.x:X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):X.x+(L.textBlock.height-this.labelFontSize)*Math.sin(Math.PI/180*this.labelAngle)-(0<this.labelAngle?L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),X.y="inside"===this.labelPlacement?0<this.labelAngle?X.y+("inside"===this.tickPlacement?this.tickLength:0)+5:X.y-L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)+("inside"===this.tickPlacement?this.tickLength:0)+5:X.y-(("inside"===this.tickPlacement?0:this.tickLength)+((L.textBlock.height-L.textBlock.fontSize/2)*Math.cos(Math.PI/180*this.labelAngle)+(0<this.labelAngle?L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0)))),L.textBlock.x=X.x,L.textBlock.y=X.y));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(O=0;O<o._labels.length;O++)if(!((L=o._labels[O]).position<o.viewportMinimum||L.position>o.viewportMaximum)&&(X=o.getPixelCoordinatesOnAxis(L.position),o.tickThickness)){o.ctx.lineWidth=o.tickThickness,o.ctx.strokeStyle=o.tickColor;var E=o.ctx.lineWidth%2==1?.5+(X.x<<0):X.x<<0;o.ctx.save(),o.ctx.beginPath(),o.ctx.moveTo(E,X.y<<0),o.ctx.lineTo(E,X.y+o.tickLength<<0),o.ctx.stroke(),o.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.lineCoordinates.x1+this.lineCoordinates.width/2-this._titleTextBlock.width/2,this._titleTextBlock.y=this.bounds.y1+1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("left"===this._position){for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||L.position>this.viewportMaximum||(X=this.getPixelCoordinatesOnAxis(L.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,c=this.ctx.lineWidth%2==1?.5+(X.y<<0):X.y<<0,this.ctx.beginPath(),this.ctx.moveTo(X.x<<0,c),this.ctx.lineTo(X.x-this.tickLength<<0,c),this.ctx.stroke()),y&&M++%2!=0&&this.labelAutoFit||(0===this.labelAngle?(L.textBlock.y=X.y,L.textBlock.x="inside"===this.labelPlacement?X.x+("inside"===this.tickPlacement?this.tickLength:0)+5:X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength)-5):(L.textBlock.y="inside"===this.labelPlacement?X.y:X.y-L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle),L.textBlock.x="inside"===this.labelPlacement?X.x+("inside"===this.tickPlacement?this.tickLength:0)+5:0<this.labelAngle?X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength)-5:X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)+(L.textBlock.height-L.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?0:this.tickLength))));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(O=0;O<o._labels.length;O++)if(!((L=o._labels[O]).position<o.viewportMinimum||L.position>o.viewportMaximum)&&(X=o.getPixelCoordinatesOnAxis(L.position),o.tickThickness)){o.ctx.lineWidth=o.tickThickness,o.ctx.strokeStyle=o.tickColor;var E=o.ctx.lineWidth%2==1?.5+(X.y<<0):X.y<<0;o.ctx.save(),o.ctx.beginPath(),o.ctx.moveTo(X.x<<0,E),o.ctx.lineTo(X.x+o.tickLength<<0,E),o.ctx.stroke(),o.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.bounds.x1+1,this._titleTextBlock.y=this.lineCoordinates.height/2+this._titleTextBlock.width/2+this.lineCoordinates.y1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}else if("right"===this._position){for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||L.position>this.viewportMaximum||(X=this.getPixelCoordinatesOnAxis(L.position),this.tickThickness&&"inside"!=this.tickPlacement&&(this.ctx.lineWidth=this.tickThickness,this.ctx.strokeStyle=this.tickColor,c=this.ctx.lineWidth%2==1?.5+(X.y<<0):X.y<<0,this.ctx.beginPath(),this.ctx.moveTo(X.x<<0,c),this.ctx.lineTo(X.x+this.tickLength<<0,c),this.ctx.stroke()),y&&M++%2!=0&&this.labelAutoFit||(0===this.labelAngle?(L.textBlock.y=X.y,L.textBlock.x="inside"===this.labelPlacement?X.x-L.textBlock.width-("inside"===this.tickPlacement?this.tickLength:0)-5:X.x+("inside"===this.tickPlacement?0:this.tickLength)+5):(L.textBlock.y="inside"===this.labelPlacement?X.y-L.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0>this.labelAngle?X.y:X.y-(L.textBlock.height-L.textBlock.fontSize/2-5)*Math.cos(Math.PI/180*this.labelAngle),L.textBlock.x="inside"===this.labelPlacement?X.x-L.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-("inside"===this.tickPlacement?this.tickLength:0)-5:0<this.labelAngle?X.x+(L.textBlock.height-L.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)+("inside"===this.tickPlacement?0:this.tickLength):X.x+("inside"===this.tickPlacement?0:this.tickLength)+5)));"inside"===this.tickPlacement&&this.chart.addEventListener("dataAnimationEnd",function(){for(O=0;O<o._labels.length;O++)if(!((L=o._labels[O]).position<o.viewportMinimum||L.position>o.viewportMaximum)&&(X=o.getPixelCoordinatesOnAxis(L.position),o.tickThickness)){o.ctx.lineWidth=o.tickThickness,o.ctx.strokeStyle=o.tickColor;var E=o.ctx.lineWidth%2==1?.5+(X.y<<0):X.y<<0;o.ctx.save(),o.ctx.beginPath(),o.ctx.moveTo(X.x<<0,E),o.ctx.lineTo(X.x-o.tickLength<<0,E),o.ctx.stroke(),o.ctx.restore()}},this),this.title&&(this._titleTextBlock.measureText(),this._titleTextBlock.x=this.bounds.x2-1,this._titleTextBlock.y=this.lineCoordinates.height/2-this._titleTextBlock.width/2+this.lineCoordinates.y1,this.titleMaxWidth=this._titleTextBlock.maxWidth,this._titleTextBlock.render(!0))}if(M=0,"inside"===this.labelPlacement)this.chart.addEventListener("dataAnimationEnd",function(){for(O=0;O<o._labels.length;O++)(L=o._labels[O]).position<o.viewportMinimum||L.position>o.viewportMaximum||y&&M++%2!=0&&o.labelAutoFit||(o.ctx.save(),o.ctx.beginPath(),L.textBlock.render(!0),o.ctx.restore())},this);else for(O=0;O<this._labels.length;O++)(L=this._labels[O]).position<this.viewportMinimum||L.position>this.viewportMaximum||y&&M++%2!=0&&this.labelAutoFit||L.textBlock.render(!0)},wt.prototype.renderInterlacedColors=function(){var y,f,o=this.chart.plotArea.ctx,c=this.chart.plotArea,d=0;if(y=!0,"bottom"!==this._position&&"top"!==this._position||!this.interlacedColor){if(("left"===this._position||"right"===this._position)&&this.interlacedColor)for(o.fillStyle=this.interlacedColor,d=0;d<this._labels.length;d++)y?(f=this.getPixelCoordinatesOnAxis(this._labels[d].position),y=this.getPixelCoordinatesOnAxis(d+1>this._labels.length-1?this.viewportMaximum:this._labels[d+1].position),o.fillRect(c.x1,Math.min(f.y,y.y),Math.abs(c.x1-c.x2),Math.abs(y.y-f.y)),y=!1):y=!0}else for(o.fillStyle=this.interlacedColor,d=0;d<this._labels.length;d++)y?(y=this.getPixelCoordinatesOnAxis(this._labels[d].position),f=this.getPixelCoordinatesOnAxis(d+1>this._labels.length-1?this.viewportMaximum:this._labels[d+1].position),o.fillRect(Math.min(f.x,y.x),c.y1,Math.abs(f.x-y.x),Math.abs(c.y1-c.y2)),y=!1):y=!0;o.beginPath()},wt.prototype.renderStripLinesOfThicknessType=function(o){if(this.stripLines&&0<this.stripLines.length&&o){var f,y=this,R=0,c=0,d=!1,C=!1,M=[],k=[];for(C=!1,R=0;R<this.stripLines.length;R++){var B=this.stripLines[R];B._thicknessType===o&&("pixel"===o&&(B.value<this.viewportMinimum||B.value>this.viewportMaximum||Et(B.value)||isNaN(this.range))||"value"===o&&(B.startValue<=this.viewportMinimum&&B.endValue<=this.viewportMinimum||B.startValue>=this.viewportMaximum&&B.endValue>=this.viewportMaximum||Et(B.startValue)||Et(B.endValue)||isNaN(this.range))||M.push(B))}for(R=0;R<this._stripLineLabels.length;R++)if(B=this.stripLines[R],!((f=this._stripLineLabels[R]).position<this.viewportMinimum||f.position>this.viewportMaximum||isNaN(this.range))){if(o=this.getPixelCoordinatesOnAxis(f.position),"outside"===f.stripLine.labelPlacement)if(B&&(this.ctx.strokeStyle=B.color,"pixel"===B._thicknessType&&(this.ctx.lineWidth=B.thickness)),"bottom"===this._position){var O=this.ctx.lineWidth%2==1?.5+(o.x<<0):o.x<<0;this.ctx.beginPath(),this.ctx.moveTo(O,o.y<<0),this.ctx.lineTo(O,o.y+this.tickLength<<0),this.ctx.stroke(),0===this.labelAngle?(o.x-=f.textBlock.width/2,o.y+=this.tickLength+f.textBlock.fontSize/2+5):(o.x-=0>this.labelAngle?f.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0,o.y+=this.tickLength+Math.abs(0>this.labelAngle?f.textBlock.width*Math.sin(Math.PI/180*this.labelAngle)-5:5))}else"top"===this._position?(O=this.ctx.lineWidth%2==1?.5+(o.x<<0):o.x<<0,this.ctx.beginPath(),this.ctx.moveTo(O,o.y<<0),this.ctx.lineTo(O,o.y-this.tickLength<<0),this.ctx.stroke(),0===this.labelAngle?(o.x-=f.textBlock.width/2,o.y-=this.tickLength+f.textBlock.height-f.textBlock.fontSize/2):(o.x+=(f.textBlock.height-this.tickLength-this.labelFontSize/2)*Math.sin(Math.PI/180*this.labelAngle)-(0<this.labelAngle?f.textBlock.width*Math.cos(Math.PI/180*this.labelAngle):0),o.y-=this.tickLength+(f.textBlock.height*Math.cos(Math.PI/180*this.labelAngle)+(0<this.labelAngle?f.textBlock.width*Math.sin(Math.PI/180*this.labelAngle):0)))):"left"===this._position?(O=this.ctx.lineWidth%2==1?.5+(o.y<<0):o.y<<0,this.ctx.beginPath(),this.ctx.moveTo(o.x<<0,O),this.ctx.lineTo(o.x-this.tickLength<<0,O),this.ctx.stroke(),0===this.labelAngle?o.x=o.x-f.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-this.tickLength-5:(o.y-=f.textBlock.width*Math.sin(Math.PI/180*this.labelAngle),o.x=0<this.labelAngle?o.x-f.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)-this.tickLength-5:o.x-f.textBlock.width*Math.cos(Math.PI/180*this.labelAngle)+(f.textBlock.height-f.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)-this.tickLength)):"right"===this._position&&(O=this.ctx.lineWidth%2==1?.5+(o.y<<0):o.y<<0,this.ctx.beginPath(),this.ctx.moveTo(o.x<<0,O),this.ctx.lineTo(o.x+this.tickLength<<0,O),this.ctx.stroke(),0===this.labelAngle?o.x=o.x+this.tickLength+5:(o.y=0>this.labelAngle?o.y:o.y-(f.textBlock.height-f.textBlock.fontSize/2-5)*Math.cos(Math.PI/180*this.labelAngle),o.x=0<this.labelAngle?o.x+(f.textBlock.height-f.textBlock.fontSize/2-5)*Math.sin(Math.PI/180*this.labelAngle)+this.tickLength:o.x+this.tickLength+5));else f.textBlock.angle=-90,"bottom"===this._position?(f.textBlock.maxWidth=this.options.stripLines[R].labelMaxWidth?this.options.stripLines[R].labelMaxWidth:this.chart.plotArea.height-3,f.textBlock.measureText(),o.x-f.textBlock.height>this.chart.plotArea.x1?Et(B.startValue)?o.x-=f.textBlock.height-f.textBlock.fontSize/2:o.x-=f.textBlock.height/2-f.textBlock.fontSize/2+3:(f.textBlock.angle=90,Et(B.startValue)?o.x+=f.textBlock.height-f.textBlock.fontSize/2:o.x+=f.textBlock.height/2-f.textBlock.fontSize/2+3),o.y=-90===f.textBlock.angle?"near"===f.stripLine.labelAlign?this.chart.plotArea.y2-3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1+f.textBlock.width)/2:this.chart.plotArea.y1+f.textBlock.width+3:"near"===f.stripLine.labelAlign?this.chart.plotArea.y2-f.textBlock.width-3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1-f.textBlock.width)/2:this.chart.plotArea.y1+3):"top"===this._position?(f.textBlock.maxWidth=this.options.stripLines[R].labelMaxWidth?this.options.stripLines[R].labelMaxWidth:this.chart.plotArea.height-3,f.textBlock.measureText(),o.x-f.textBlock.height>this.chart.plotArea.x1?Et(B.startValue)?o.x-=f.textBlock.height-f.textBlock.fontSize/2:o.x-=f.textBlock.height/2-f.textBlock.fontSize/2+3:(f.textBlock.angle=90,Et(B.startValue)?o.x+=f.textBlock.height-f.textBlock.fontSize/2:o.x+=f.textBlock.height/2-f.textBlock.fontSize/2+3),o.y=-90===f.textBlock.angle?"near"===f.stripLine.labelAlign?this.chart.plotArea.y1+f.textBlock.width+3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1+f.textBlock.width)/2:this.chart.plotArea.y2-3:"near"===f.stripLine.labelAlign?this.chart.plotArea.y1+3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.y2+this.chart.plotArea.y1-f.textBlock.width)/2:this.chart.plotArea.y2-f.textBlock.width-3):"left"===this._position?(f.textBlock.maxWidth=this.options.stripLines[R].labelMaxWidth?this.options.stripLines[R].labelMaxWidth:this.chart.plotArea.width-3,f.textBlock.angle=0,f.textBlock.measureText(),o.y-f.textBlock.height>this.chart.plotArea.y1?Et(B.startValue)?o.y-=f.textBlock.height-f.textBlock.fontSize/2:o.y-=f.textBlock.height/2-f.textBlock.fontSize+3:o.y-f.textBlock.height<this.chart.plotArea.y2?o.y+=f.textBlock.fontSize/2+3:Et(B.startValue)?o.y-=f.textBlock.height-f.textBlock.fontSize/2:o.y-=f.textBlock.height/2-f.textBlock.fontSize+3,o.x="near"===f.stripLine.labelAlign?this.chart.plotArea.x1+3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.x2+this.chart.plotArea.x1)/2-f.textBlock.width/2:this.chart.plotArea.x2-f.textBlock.width-3):"right"===this._position&&(f.textBlock.maxWidth=this.options.stripLines[R].labelMaxWidth?this.options.stripLines[R].labelMaxWidth:this.chart.plotArea.width-3,f.textBlock.angle=0,f.textBlock.measureText(),o.y-+f.textBlock.height>this.chart.plotArea.y1?Et(B.startValue)?o.y-=f.textBlock.height-f.textBlock.fontSize/2:o.y-=f.textBlock.height/2-f.textBlock.fontSize/2-3:o.y-f.textBlock.height<this.chart.plotArea.y2?o.y+=f.textBlock.fontSize/2+3:Et(B.startValue)?o.y-=f.textBlock.height-f.textBlock.fontSize/2:o.y-=f.textBlock.height/2-f.textBlock.fontSize/2+3,o.x="near"===f.stripLine.labelAlign?this.chart.plotArea.x2-f.textBlock.width-3:"center"===f.stripLine.labelAlign?(this.chart.plotArea.x2+this.chart.plotArea.x1)/2-f.textBlock.width/2:this.chart.plotArea.x1+3);f.textBlock.x=o.x,f.textBlock.y=o.y,k.push(f)}if(!C){for(C=!1,this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip(),R=0;R<M.length;R++)(B=M[R]).showOnTop?d||(d=!0,this.chart.addEventListener("dataAnimationIterationEnd",function(){for(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip(),c=0;c<M.length;c++)(B=M[c]).showOnTop&&B.render();this.ctx.restore()},B)):B.render();for(R=0;R<k.length;R++)(f=k[R]).stripLine.showOnTop?C||(C=!0,this.chart.addEventListener("dataAnimationIterationEnd",function(){for(c=0;c<k.length;c++)"inside"===(f=k[c]).stripLine.labelPlacement&&f.stripLine.showOnTop&&(y.ctx.save(),y.ctx.beginPath(),y.ctx.rect(y.chart.plotArea.x1,y.chart.plotArea.y1,y.chart.plotArea.width,y.chart.plotArea.height),y.ctx.clip(),f.textBlock.render(!0),y.ctx.restore())},f.textBlock)):"inside"===f.stripLine.labelPlacement&&f.textBlock.render(!0);this.ctx.restore(),C=!0}if(C)for(C=!1,R=0;R<k.length;R++)"outside"===(f=k[R]).stripLine.labelPlacement&&f.textBlock.render(!0)}},wt.prototype.renderBreaksBackground=function(){this.chart._breaksCanvas&&this.scaleBreaks&&0<this.scaleBreaks._appliedBreaks.length&&this.maskCanvas&&(this.chart._breaksCanvasCtx.save(),this.chart._breaksCanvasCtx.beginPath(),this.chart._breaksCanvasCtx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.chart._breaksCanvasCtx.clip(),this.chart._breaksCanvasCtx.drawImage(this.maskCanvas,0,0,this.chart.width,this.chart.height),this.chart._breaksCanvasCtx.restore())},wt.prototype.createMask=function(){if(this.scaleBreaks&&0<this.scaleBreaks._appliedBreaks.length){var o=this.scaleBreaks._appliedBreaks;rt?(this.maskCanvas=zi(this.chart.width,this.chart.height),this.maskCtx=this.maskCanvas.getContext("2d")):(this.maskCanvas=this.chart.plotArea.canvas,this.maskCtx=this.chart.plotArea.ctx),this.maskCtx.save(),this.maskCtx.beginPath(),this.maskCtx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.maskCtx.clip();for(var y=0;y<o.length;y++)o[y].endValue<this.viewportMinimum||o[y].startValue>this.viewportMaximum||isNaN(this.range)||o[y].render(this.maskCtx);this.maskCtx.restore()}},wt.prototype.renderCrosshair=function(o,y){isFinite(this.minimum)&&isFinite(this.maximum)&&(this.crosshair.render(o,y),this.crosshair.dispatchEvent("updated",{chart:this.chart,crosshair:this.options,axis:this,value:this.crosshair.value},this))},wt.prototype.showCrosshair=function(o){Et(o)||o<this.viewportMinimum||o>this.viewportMaximum||("top"===this._position||"bottom"===this._position?this.crosshair.render(this.convertValueToPixel(o),null,o):this.crosshair.render(null,this.convertValueToPixel(o),o))},wt.prototype.renderGrid=function(){if(this.gridThickness&&0<this.gridThickness){var o=this.chart.ctx;o.save();var y,f=this.chart.plotArea;if(o.lineWidth=this.gridThickness,o.strokeStyle=this.gridColor,o.setLineDash&&o.setLineDash(Ti(this.gridDashType,this.gridThickness)),"bottom"===this._position||"top"===this._position)for(c=0;c<this._labels.length;c++)this._labels[c].position<this.viewportMinimum||this._labels[c].position>this.viewportMaximum||this._labels[c].breaksLabelType||(o.beginPath(),y=this.getPixelCoordinatesOnAxis(this._labels[c].position),o.moveTo(y=o.lineWidth%2==1?.5+(y.x<<0):y.x<<0,f.y1<<0),o.lineTo(y,f.y2<<0),o.stroke());else if("left"===this._position||"right"===this._position)for(var c=0;c<this._labels.length;c++)this._labels[c].position<this.viewportMinimum||this._labels[c].position>this.viewportMaximum||this._labels[c].breaksLabelType||(o.beginPath(),y=this.getPixelCoordinatesOnAxis(this._labels[c].position),o.moveTo(f.x1<<0,y=o.lineWidth%2==1?.5+(y.y<<0):y.y<<0),o.lineTo(f.x2<<0,y),o.stroke());o.restore()}},wt.prototype.renderAxisLine=function(){var d,M,o=this.chart.ctx,y=rt?this.chart._preRenderCtx:o,f=Math.ceil(this.tickThickness/(this.reversed?-2:2)),c=Math.ceil(this.tickThickness/(this.reversed?2:-2));if(y.save(),"bottom"===this._position||"top"===this._position){if(this.lineThickness){this.reversed?(d=this.lineCoordinates.x2,M=this.lineCoordinates.x1):(d=this.lineCoordinates.x1,M=this.lineCoordinates.x2),y.lineWidth=this.lineThickness,y.strokeStyle=this.lineColor?this.lineColor:"black",y.setLineDash&&y.setLineDash(Ti(this.lineDashType,this.lineThickness));var k=this.lineThickness%2==1?.5+(this.lineCoordinates.y1<<0):this.lineCoordinates.y1<<0;if(y.beginPath(),this.scaleBreaks&&!Et(this.scaleBreaks.firstBreakIndex))if(Et(this.scaleBreaks.lastBreakIndex))d=this.scaleBreaks._appliedBreaks[this.scaleBreaks.firstBreakIndex].endPixel+c;else for(var C=this.scaleBreaks.firstBreakIndex;C<=this.scaleBreaks.lastBreakIndex;C++)y.moveTo(d,k),y.lineTo(this.scaleBreaks._appliedBreaks[C].startPixel+f,k),d=this.scaleBreaks._appliedBreaks[C].endPixel+c;d&&(y.moveTo(d,k),y.lineTo(M,k)),y.stroke()}}else if(("left"===this._position||"right"===this._position)&&this.lineThickness){if(this.reversed?(d=this.lineCoordinates.y1,M=this.lineCoordinates.y2):(d=this.lineCoordinates.y2,M=this.lineCoordinates.y1),y.lineWidth=this.lineThickness,y.strokeStyle=this.lineColor,y.setLineDash&&y.setLineDash(Ti(this.lineDashType,this.lineThickness)),k=this.lineThickness%2==1?.5+(this.lineCoordinates.x1<<0):this.lineCoordinates.x1<<0,y.beginPath(),this.scaleBreaks&&!Et(this.scaleBreaks.firstBreakIndex))if(Et(this.scaleBreaks.lastBreakIndex))d=this.scaleBreaks._appliedBreaks[this.scaleBreaks.firstBreakIndex].endPixel+f;else for(C=this.scaleBreaks.firstBreakIndex;C<=this.scaleBreaks.lastBreakIndex;C++)y.moveTo(k,d),y.lineTo(k,this.scaleBreaks._appliedBreaks[C].startPixel+c),d=this.scaleBreaks._appliedBreaks[C].endPixel+f;d&&(y.moveTo(k,d),y.lineTo(k,M)),y.stroke()}rt&&(o.drawImage(this.chart._preRenderCanvas,0,0,this.chart.width,this.chart.height),this.chart._breaksCanvasCtx&&this.chart._breaksCanvasCtx.drawImage(this.chart._preRenderCanvas,0,0,this.chart.width,this.chart.height),y.clearRect(0,0,this.chart.width,this.chart.height)),y.restore()},wt.prototype.getPixelCoordinatesOnAxis=function(o){var y={};return("bottom"===this._position||"top"===this._position)&&(y.x=this.convertValueToPixel(o),y.y=this.lineCoordinates.y1),("left"===this._position||"right"===this._position)&&(y.y=this.convertValueToPixel(o),y.x=this.lineCoordinates.x2),y},wt.prototype.convertPixelToValue=function(o){if(typeof o>"u")return null;var y,f=0,d=0,c=(f=!0,this.scaleBreaks?this.scaleBreaks._appliedBreaks:[]);if(d="number"==typeof o?o:"left"===this._position||"right"===this._position?o.y:o.x,this.logarithmic){if(o=y=Math.pow(this.logarithmBase,(d-this.conversionParameters.reference)/this.conversionParameters.pixelPerUnit),d<=this.conversionParameters.reference==("left"===this._position||"right"===this._position)!==this.reversed){for(d=0;d<c.length;d++)if(!(c[d].endValue<this.conversionParameters.minimum))if(f)if(c[d].startValue<this.conversionParameters.minimum){if(1<c[d].size&&this.conversionParameters.minimum*Math.pow(c[d].endValue/c[d].startValue,Math.log(y)/Math.log(c[d].size))<c[d].endValue){o=Math.pow(c[d].endValue/c[d].startValue,Math.log(y)/Math.log(c[d].size));break}o*=c[d].endValue/this.conversionParameters.minimum/Math.pow(c[d].size,Math.log(c[d].endValue/this.conversionParameters.minimum)/Math.log(c[d].endValue/c[d].startValue)),y/=Math.pow(c[d].size,Math.log(c[d].endValue/this.conversionParameters.minimum)/Math.log(c[d].endValue/c[d].startValue)),f=!1}else{if(!(y>c[d].startValue/this.conversionParameters.minimum))break;if((y/=c[d].startValue/this.conversionParameters.minimum)<c[d].size){o*=Math.pow(c[d].endValue/c[d].startValue,1===c[d].size?1:Math.log(y)/Math.log(c[d].size))/y;break}o*=c[d].endValue/c[d].startValue/c[d].size,y/=c[d].size,f=!1}else{if(!(y>c[d].startValue/c[d-1].endValue))break;if((y/=c[d].startValue/c[d-1].endValue)<c[d].size){o*=Math.pow(c[d].endValue/c[d].startValue,1===c[d].size?1:Math.log(y)/Math.log(c[d].size))/y;break}o*=c[d].endValue/c[d].startValue/c[d].size,y/=c[d].size}}else for(d=c.length-1;0<=d;d--)if(!(c[d].startValue>this.conversionParameters.minimum))if(f)if(c[d].endValue>this.conversionParameters.minimum){if(1<c[d].size&&this.conversionParameters.minimum*Math.pow(c[d].endValue/c[d].startValue,Math.log(y)/Math.log(c[d].size))>c[d].startValue){o=Math.pow(c[d].endValue/c[d].startValue,Math.log(y)/Math.log(c[d].size));break}o*=c[d].startValue/this.conversionParameters.minimum*Math.pow(c[d].size,Math.log(c[d].startValue/this.conversionParameters.minimum)/Math.log(c[d].endValue/c[d].startValue))*y,y*=Math.pow(c[d].size,Math.log(this.conversionParameters.minimum/c[d].startValue)/Math.log(c[d].endValue/c[d].startValue)),f=!1}else{if(!(y<c[d].endValue/this.conversionParameters.minimum))break;if((y/=c[d].endValue/this.conversionParameters.minimum)>1/c[d].size){o*=Math.pow(c[d].endValue/c[d].startValue,1>=c[d].size?1:Math.log(y)/Math.log(c[d].size))*y;break}o/=c[d].endValue/c[d].startValue/c[d].size,y*=c[d].size,f=!1}else{if(!(y<c[d].endValue/c[d+1].startValue))break;if((y/=c[d].endValue/c[d+1].startValue)>1/c[d].size){o*=Math.pow(c[d].endValue/c[d].startValue,1>=c[d].size?1:Math.log(y)/Math.log(c[d].size))*y;break}o/=c[d].endValue/c[d].startValue/c[d].size,y*=c[d].size}f=o*this.viewportMinimum}else{if(o=y=(d-this.conversionParameters.reference)/this.conversionParameters.pixelPerUnit,d<=this.conversionParameters.reference==("left"===this._position||"right"===this._position)!==this.reversed){for(d=0;d<c.length;d++)if(!(c[d].endValue<this.conversionParameters.minimum))if(f)if(c[d].startValue<this.conversionParameters.minimum){if(c[d].size&&this.conversionParameters.minimum+y*(c[d].endValue-c[d].startValue)/c[d].size<c[d].endValue){o=0>=c[d].size?0:y*(c[d].endValue-c[d].startValue)/c[d].size;break}o+=c[d].endValue-this.conversionParameters.minimum-c[d].size*(c[d].endValue-this.conversionParameters.minimum)/(c[d].endValue-c[d].startValue),y-=c[d].size*(c[d].endValue-this.conversionParameters.minimum)/(c[d].endValue-c[d].startValue),f=!1}else{if(!(y>c[d].startValue-this.conversionParameters.minimum))break;if((y-=c[d].startValue-this.conversionParameters.minimum)<c[d].size){o+=(c[d].endValue-c[d].startValue)*(0===c[d].size?1:y/c[d].size)-y;break}o+=c[d].endValue-c[d].startValue-c[d].size,y-=c[d].size,f=!1}else{if(!(y>c[d].startValue-c[d-1].endValue))break;if((y-=c[d].startValue-c[d-1].endValue)<c[d].size){o+=(c[d].endValue-c[d].startValue)*(0===c[d].size?1:y/c[d].size)-y;break}o+=c[d].endValue-c[d].startValue-c[d].size,y-=c[d].size}}else for(d=c.length-1;0<=d;d--)if(!(c[d].startValue>this.conversionParameters.minimum))if(f)if(c[d].endValue>this.conversionParameters.minimum){if(c[d].size&&this.conversionParameters.minimum+y*(c[d].endValue-c[d].startValue)/c[d].size>c[d].startValue){o=0>=c[d].size?0:y*(c[d].endValue-c[d].startValue)/c[d].size;break}o+=c[d].startValue-this.conversionParameters.minimum+c[d].size*(this.conversionParameters.minimum-c[d].startValue)/(c[d].endValue-c[d].startValue),y+=c[d].size*(this.conversionParameters.minimum-c[d].startValue)/(c[d].endValue-c[d].startValue),f=!1}else{if(!(y<c[d].endValue-this.conversionParameters.minimum))break;if((y-=c[d].endValue-this.conversionParameters.minimum)>-1*c[d].size){o+=(c[d].endValue-c[d].startValue)*(0===c[d].size?1:y/c[d].size)+y;break}o-=c[d].endValue-c[d].startValue-c[d].size,y+=c[d].size,f=!1}else{if(!(y<c[d].endValue-c[d+1].startValue))break;if((y-=c[d].endValue-c[d+1].startValue)>-1*c[d].size){o+=(c[d].endValue-c[d].startValue)*(0===c[d].size?1:y/c[d].size)+y;break}o-=c[d].endValue-c[d].startValue-c[d].size,y+=c[d].size}f=this.conversionParameters.minimum+o}return f},wt.prototype.convertValueToPixel=function(o){return o=this.getApparentDifference(this.conversionParameters.minimum,o,o),this.logarithmic?this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*Math.log(o/this.conversionParameters.minimum)/this.conversionParameters.lnLogarithmBase+.5<<0:"axisX"===this.type?this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*(o-this.conversionParameters.minimum)+.5<<0:this.conversionParameters.reference+this.conversionParameters.pixelPerUnit*(o-this.conversionParameters.minimum)+.5},wt.prototype.getApparentDifference=function(o,y,f,c){var d=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];if(this.logarithmic){f=Et(f)?y/o:f;for(var M=0;M<d.length&&!(y<d[M].startValue);M++)o>d[M].endValue||(o<=d[M].startValue&&y>=d[M].endValue?f=f/d[M].endValue*d[M].startValue*d[M].size:o>=d[M].startValue&&y>=d[M].endValue?f=f/d[M].endValue*o*Math.pow(d[M].size,Math.log(d[M].endValue/o)/Math.log(d[M].endValue/d[M].startValue)):o<=d[M].startValue&&y<=d[M].endValue?f=f/y*d[M].startValue*Math.pow(d[M].size,Math.log(y/d[M].startValue)/Math.log(d[M].endValue/d[M].startValue)):!c&&o>d[M].startValue&&y<d[M].endValue&&(f=o*Math.pow(d[M].size,Math.log(y/o)/Math.log(d[M].endValue/d[M].startValue))))}else for(f=Et(f)?Math.abs(y-o):f,M=0;M<d.length&&!(y<d[M].startValue);M++)o>d[M].endValue||(o<=d[M].startValue&&y>=d[M].endValue?f=f-d[M].endValue+d[M].startValue+d[M].size:o>d[M].startValue&&y>=d[M].endValue?f=f-d[M].endValue+o+d[M].size*(d[M].endValue-o)/(d[M].endValue-d[M].startValue):o<=d[M].startValue&&y<d[M].endValue?f=f-y+d[M].startValue+d[M].size*(y-d[M].startValue)/(d[M].endValue-d[M].startValue):!c&&o>d[M].startValue&&y<d[M].endValue&&(f=o+d[M].size*(y-o)/(d[M].endValue-d[M].startValue)));return f},wt.prototype.setViewPortRange=function(o,y){this.sessionVariables.newViewportMinimum=this.viewportMinimum=Math.min(o,y),this.sessionVariables.newViewportMaximum=this.viewportMaximum=Math.max(o,y)},wt.prototype.getXValueAt=function(o){if(!o)return null;var y=null;return"left"===this._position?y=this.convertPixelToValue(o.y):"bottom"===this._position&&(y=this.convertPixelToValue(o.x)),y},wt.prototype.calculateValueToPixelConversionParameters=function(o){o=this.scaleBreaks?this.scaleBreaks._appliedBreaks:[];var y={pixelPerUnit:null,minimum:null,reference:null},f=this.lineCoordinates.width,c=this.lineCoordinates.height;if(f="bottom"===this._position||"top"===this._position?f:c,c=Math.abs(this.range),this.logarithmic)for(var d=0;d<o.length&&!(this.viewportMaximum<o[d].startValue);d++)this.viewportMinimum>o[d].endValue||(this.viewportMinimum>=o[d].startValue&&this.viewportMaximum<=o[d].endValue?f=0:this.viewportMinimum<=o[d].startValue&&this.viewportMaximum>=o[d].endValue?(c=c/o[d].endValue*o[d].startValue,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100):f-Math.min(o[d].spacing,.1*f)):this.viewportMinimum>o[d].startValue&&this.viewportMaximum>=o[d].endValue?(c=c/o[d].endValue*this.viewportMinimum,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100*Math.log(o[d].endValue/this.viewportMinimum)/Math.log(o[d].endValue/o[d].startValue)):f-Math.min(o[d].spacing,.1*f)*Math.log(o[d].endValue/this.viewportMinimum)/Math.log(o[d].endValue/o[d].startValue)):this.viewportMinimum<=o[d].startValue&&this.viewportMaximum<o[d].endValue&&(c=c/this.viewportMaximum*o[d].startValue,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100*Math.log(this.viewportMaximum/o[d].startValue)/Math.log(o[d].endValue/o[d].startValue)):f-Math.min(o[d].spacing,.1*f)*Math.log(this.viewportMaximum/o[d].startValue)/Math.log(o[d].endValue/o[d].startValue)));else for(d=0;d<o.length&&!(this.viewportMaximum<o[d].startValue);d++)this.viewportMinimum>o[d].endValue||(this.viewportMinimum>=o[d].startValue&&this.viewportMaximum<=o[d].endValue?f=0:this.viewportMinimum<=o[d].startValue&&this.viewportMaximum>=o[d].endValue?(c=c-o[d].endValue+o[d].startValue,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100):f-Math.min(o[d].spacing,.1*f)):this.viewportMinimum>o[d].startValue&&this.viewportMaximum>=o[d].endValue?(c=c-o[d].endValue+this.viewportMinimum,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100*(o[d].endValue-this.viewportMinimum)/(o[d].endValue-o[d].startValue)):f-Math.min(o[d].spacing,.1*f)*(o[d].endValue-this.viewportMinimum)/(o[d].endValue-o[d].startValue)):this.viewportMinimum<=o[d].startValue&&this.viewportMaximum<o[d].endValue&&(c=c-this.viewportMaximum+o[d].startValue,f=0<o[d].spacing.toString().indexOf("%")?f*(1-parseFloat(o[d].spacing)/100*(this.viewportMaximum-o[d].startValue)/(o[d].endValue-o[d].startValue)):f-Math.min(o[d].spacing,.1*f)*(this.viewportMaximum-o[d].startValue)/(o[d].endValue-o[d].startValue)));y.minimum=this.viewportMinimum,y.maximum=this.viewportMaximum,y.range=c,("bottom"===this._position||"top"===this._position)&&(this.logarithmic?(y.lnLogarithmBase=Math.log(this.logarithmBase),y.pixelPerUnit=(this.reversed?-1:1)*f*y.lnLogarithmBase/Math.log(Math.abs(c))):y.pixelPerUnit=(this.reversed?-1:1)*f/Math.abs(c),y.reference=this.reversed?this.lineCoordinates.x2:this.lineCoordinates.x1),("left"===this._position||"right"===this._position)&&(this.logarithmic?(y.lnLogarithmBase=Math.log(this.logarithmBase),y.pixelPerUnit=(this.reversed?1:-1)*f*y.lnLogarithmBase/Math.log(Math.abs(c))):y.pixelPerUnit=(this.reversed?1:-1)*f/Math.abs(c),y.reference=this.reversed?this.lineCoordinates.y1:this.lineCoordinates.y2),this.conversionParameters=y},wt.prototype.calculateAxisParameters=function(){if(this.logarithmic)this.calculateLogarithmicAxisParameters();else{var f=this.chart.layoutManager.getFreeSpace(),o=!1,y=!1;"bottom"===this._position||"top"===this._position?(this.maxWidth=f.width,this.maxHeight=f.height):(this.maxWidth=f.height,this.maxHeight=f.width),f="axisX"===this.type?"xySwapped"===this.chart.plotInfo.axisPlacement?62:70:"xySwapped"===this.chart.plotInfo.axisPlacement?50:40;var c,d,M,k=4;if("axisX"===this.type&&(k=600>this.maxWidth?8:6),f=Math.max(k,Math.floor(this.maxWidth/f)),k=0,!Et(this.options.viewportMinimum)&&!Et(this.options.viewportMaximum)&&this.options.viewportMinimum>=this.options.viewportMaximum&&(this.viewportMinimum=this.viewportMaximum=null),!Et(this.options.viewportMinimum)||Et(this.sessionVariables.newViewportMinimum)||isNaN(this.sessionVariables.newViewportMinimum)?(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=this.minimum):this.viewportMinimum=this.sessionVariables.newViewportMinimum,!Et(this.options.viewportMaximum)||Et(this.sessionVariables.newViewportMaximum)||isNaN(this.sessionVariables.newViewportMaximum)?(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=this.maximum):this.viewportMaximum=this.sessionVariables.newViewportMaximum,this.scaleBreaks)for(k=0;k<this.scaleBreaks._appliedBreaks.length;k++)if((!Et(this.sessionVariables.newViewportMinimum)&&this.sessionVariables.newViewportMinimum>=this.scaleBreaks._appliedBreaks[k].startValue||!Et(this.options.minimum)&&this.options.minimum>=this.scaleBreaks._appliedBreaks[k].startValue||!Et(this.options.viewportMinimum)&&this.viewportMinimum>=this.scaleBreaks._appliedBreaks[k].startValue)&&(!Et(this.sessionVariables.newViewportMaximum)&&this.sessionVariables.newViewportMaximum<=this.scaleBreaks._appliedBreaks[k].endValue||!Et(this.options.maximum)&&this.options.maximum<=this.scaleBreaks._appliedBreaks[k].endValue||!Et(this.options.viewportMaximum)&&this.viewportMaximum<=this.scaleBreaks._appliedBreaks[k].endValue)){this.scaleBreaks._appliedBreaks.splice(k,1);break}if("axisX"===this.type){if(this.dataSeries&&0<this.dataSeries.length)for(c=0;c<this.dataSeries.length;c++)"dateTime"===this.dataSeries[c].xValueType&&(y=!0);(d=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax)-(c=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)==0&&(d+=k=typeof this.options.interval>"u"?.4:this.options.interval,c-=k),this.dataInfo.minDiff!==1/0?M=this.dataInfo.minDiff:1<d-c?M=.5*Math.abs(d-c):(M=1,y&&(o=!0))}else"axisY"===this.type&&(c=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin,d=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax,isFinite(c)||isFinite(d)?isFinite(c)?isFinite(d)||(d=c):c=d:(d=typeof this.options.interval>"u"?-1/0:this.options.interval,c=typeof this.options.interval<"u"||isFinite(this.dataInfo.minDiff)?0:1/0),0===c&&0===d?(d+=9,c=0):d-c==0?(d+=k=Math.min(Math.abs(.01*Math.abs(d)),5),c-=k):c>d?(k=Math.min(.01*Math.abs(this.getApparentDifference(d,c,null,!0)),5),0<=d?c=d-k:d=isFinite(c)?c+k:0):(k=Math.min(.01*Math.abs(this.getApparentDifference(c,d,null,!0)),.05),0!==d&&(d+=k),0!==c&&(c-=k)),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<d-c?.5*Math.abs(d-c):1,this.includeZero&&(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&0<c&&(c=0),this.includeZero&&(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&0>d&&(d=0));k=this.getApparentDifference(isNaN(this.viewportMinimum)||null===this.viewportMinimum?c:this.viewportMinimum,isNaN(this.viewportMaximum)||null===this.viewportMaximum?d:this.viewportMaximum,null,!0),"axisX"===this.type&&y?(this.intervalType||(k/1<=f?(this.interval=1,this.intervalType="millisecond"):k/2<=f?(this.interval=2,this.intervalType="millisecond"):k/5<=f?(this.interval=5,this.intervalType="millisecond"):k/10<=f?(this.interval=10,this.intervalType="millisecond"):k/20<=f?(this.interval=20,this.intervalType="millisecond"):k/50<=f?(this.interval=50,this.intervalType="millisecond"):k/100<=f?(this.interval=100,this.intervalType="millisecond"):k/200<=f?(this.interval=200,this.intervalType="millisecond"):k/250<=f?(this.interval=250,this.intervalType="millisecond"):k/300<=f?(this.interval=300,this.intervalType="millisecond"):k/400<=f?(this.interval=400,this.intervalType="millisecond"):k/500<=f?(this.interval=500,this.intervalType="millisecond"):k/(1*In.secondDuration)<=f?(this.interval=1,this.intervalType="second"):k/(2*In.secondDuration)<=f?(this.interval=2,this.intervalType="second"):k/(5*In.secondDuration)<=f?(this.interval=5,this.intervalType="second"):k/(10*In.secondDuration)<=f?(this.interval=10,this.intervalType="second"):k/(15*In.secondDuration)<=f?(this.interval=15,this.intervalType="second"):k/(20*In.secondDuration)<=f?(this.interval=20,this.intervalType="second"):k/(30*In.secondDuration)<=f?(this.interval=30,this.intervalType="second"):k/(1*In.minuteDuration)<=f?(this.interval=1,this.intervalType="minute"):k/(2*In.minuteDuration)<=f?(this.interval=2,this.intervalType="minute"):k/(5*In.minuteDuration)<=f?(this.interval=5,this.intervalType="minute"):k/(10*In.minuteDuration)<=f?(this.interval=10,this.intervalType="minute"):k/(15*In.minuteDuration)<=f?(this.interval=15,this.intervalType="minute"):k/(20*In.minuteDuration)<=f?(this.interval=20,this.intervalType="minute"):k/(30*In.minuteDuration)<=f?(this.interval=30,this.intervalType="minute"):k/(1*In.hourDuration)<=f?(this.interval=1,this.intervalType="hour"):k/(2*In.hourDuration)<=f?(this.interval=2,this.intervalType="hour"):k/(3*In.hourDuration)<=f?(this.interval=3,this.intervalType="hour"):k/(6*In.hourDuration)<=f?(this.interval=6,this.intervalType="hour"):k/(1*In.dayDuration)<=f?(this.interval=1,this.intervalType="day"):k/(2*In.dayDuration)<=f?(this.interval=2,this.intervalType="day"):k/(4*In.dayDuration)<=f?(this.interval=4,this.intervalType="day"):k/(1*In.weekDuration)<=f?(this.interval=1,this.intervalType="week"):k/(2*In.weekDuration)<=f?(this.interval=2,this.intervalType="week"):k/(3*In.weekDuration)<=f?(this.interval=3,this.intervalType="week"):k/(1*In.monthDuration)<=f?(this.interval=1,this.intervalType="month"):k/(2*In.monthDuration)<=f?(this.interval=2,this.intervalType="month"):k/(3*In.monthDuration)<=f?(this.interval=3,this.intervalType="month"):k/(6*In.monthDuration)<=f?(this.interval=6,this.intervalType="month"):(this.interval=k/(1*In.yearDuration)<=f?1:k/(2*In.yearDuration)<=f?2:k/(4*In.yearDuration)<=f?4:Math.floor(wt.getNiceNumber(k/(f-1),!0)/In.yearDuration),this.intervalType="year")),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=c-M/2),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=d+M/2),o?this.autoValueFormatString="MMM DD YYYY HH:mm":"year"===this.intervalType?this.autoValueFormatString="YYYY":"month"===this.intervalType?this.autoValueFormatString="MMM YYYY":"week"===this.intervalType||"day"===this.intervalType?this.autoValueFormatString="MMM DD YYYY":"hour"===this.intervalType||"minute"===this.intervalType?this.autoValueFormatString="hh:mm TT":"second"===this.intervalType?this.autoValueFormatString="hh:mm:ss TT":"millisecond"===this.intervalType&&(this.autoValueFormatString="fff'ms'"),this.valueFormatString||(this.valueFormatString=this.autoValueFormatString)):(this.intervalType="number",k=wt.getNiceNumber(k,!1),this.interval=this.options&&0<this.options.interval?this.options.interval:wt.getNiceNumber(k/(f-1),!0),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum="axisX"===this.type?c-M/2:Math.floor(c/this.interval)*this.interval),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum="axisX"===this.type?d+M/2:Math.ceil(d/this.interval)*this.interval),0===this.viewportMaximum&&0===this.viewportMinimum&&(0===this.options.viewportMinimum?this.viewportMaximum+=10:0===this.options.viewportMaximum&&(this.viewportMinimum-=10),this.options&&typeof this.options.interval>"u"&&(this.interval=wt.getNiceNumber((this.viewportMaximum-this.viewportMinimum)/(f-1),!0)))),(null===this.minimum||null===this.maximum)&&("axisX"===this.type?((d=null!==this.maximum?this.maximum:this.dataInfo.max)-(c=null!==this.minimum?this.minimum:this.dataInfo.min)==0&&(d+=k=typeof this.options.interval>"u"?.4:this.options.interval,c-=k),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<d-c?.5*Math.abs(d-c):1):"axisY"===this.type&&(c=null!==this.minimum?this.minimum:this.dataInfo.min,d=null!==this.maximum?this.maximum:this.dataInfo.max,isFinite(c)||isFinite(d)?0===c&&0===d?(d+=9,c=0):d-c==0?(d+=k=Math.min(Math.abs(.01*Math.abs(d)),5),c-=k):c>d?(k=Math.min(.01*Math.abs(this.getApparentDifference(d,c,null,!0)),5),0<=d?c=d-k:d=isFinite(c)?c+k:0):(k=Math.min(.01*Math.abs(this.getApparentDifference(c,d,null,!0)),.05),0!==d&&(d+=k),0!==c&&(c-=k)):(d=typeof this.options.interval>"u"?-1/0:this.options.interval,c=typeof this.options.interval<"u"||isFinite(this.dataInfo.minDiff)?0:1/0),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:1<d-c?.5*Math.abs(d-c):1,this.includeZero&&(null===this.minimum||isNaN(this.minimum))&&0<c&&(c=0),this.includeZero&&(null===this.maximum||isNaN(this.maximum))&&0>d&&(d=0)),Math.abs(this.getApparentDifference(c,d,null,!0)),"axisX"===this.type&&y?(this.valueType="dateTime",(null===this.minimum||isNaN(this.minimum))&&(this.minimum=c-M/2,this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?1/0:this.sessionVariables.viewportMinimum)),(null===this.maximum||isNaN(this.maximum))&&(this.maximum=d+M/2,this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?-1/0:this.sessionVariables.viewportMaximum))):(this.intervalType=this.valueType="number",null===this.minimum&&(this.minimum="axisX"===this.type?c-M/2:Math.floor(c/this.interval)*this.interval,this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?1/0:this.sessionVariables.viewportMinimum)),null===this.maximum&&(this.maximum="axisX"===this.type?d+M/2:Math.ceil(d/this.interval)*this.interval,this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?-1/0:this.sessionVariables.viewportMaximum)),0===this.maximum&&0===this.minimum&&(0===this.options.minimum?this.maximum+=10:0===this.options.maximum&&(this.minimum-=10)))),Et(this.sessionVariables.newViewportMinimum)&&(this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum)),Et(this.sessionVariables.newViewportMaximum)&&(this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum)),this.range=this.viewportMaximum-this.viewportMinimum,this.intervalStartPosition="axisX"===this.type&&y?this.getLabelStartPoint(new Date(this.viewportMinimum),this.intervalType,this.interval):Math.floor((this.viewportMinimum+.2*this.interval)/this.interval)*this.interval,this.valueFormatString||(this.valueFormatString=wt.generateValueFormatString(this.range,2))}},wt.prototype.calculateLogarithmicAxisParameters=function(){var y,c,d,M,k,f=this.chart.layoutManager.getFreeSpace(),o=Math.log(this.logarithmBase);if("bottom"===this._position||"top"===this._position?(this.maxWidth=f.width,this.maxHeight=f.height):(this.maxWidth=f.height,this.maxHeight=f.width),f="axisX"===this.type?500>this.maxWidth?7:Math.max(7,Math.floor(this.maxWidth/100)):Math.max(Math.floor(this.maxWidth/50),3),k=1,(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum=this.minimum),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum=this.maximum),this.scaleBreaks)for(k=0;k<this.scaleBreaks._appliedBreaks.length;k++)if((!Et(this.sessionVariables.newViewportMinimum)&&this.sessionVariables.newViewportMinimum>=this.scaleBreaks._appliedBreaks[k].startValue||!Et(this.options.minimum)&&this.options.minimum>=this.scaleBreaks._appliedBreaks[k].startValue||!Et(this.options.viewportMinimum)&&this.viewportMinimum>=this.scaleBreaks._appliedBreaks[k].startValue)&&(!Et(this.sessionVariables.newViewportMaximum)&&this.sessionVariables.newViewportMaximum<=this.scaleBreaks._appliedBreaks[k].endValue||!Et(this.options.maximum)&&this.options.maximum<=this.scaleBreaks._appliedBreaks[k].endValue||!Et(this.options.viewportMaximum)&&this.viewportMaximum<=this.scaleBreaks._appliedBreaks[k].endValue)){this.scaleBreaks._appliedBreaks.splice(k,1);break}"axisX"===this.type?((d=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax)/(c=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)==1&&(d*=k=Math.pow(this.logarithmBase,typeof this.options.interval>"u"?.4:this.options.interval),c/=k),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:d/c>this.logarithmBase?d/c*Math.pow(this.logarithmBase,.5):this.logarithmBase):"axisY"===this.type&&(d=null!==this.viewportMaximum?this.viewportMaximum:this.dataInfo.viewPortMax,0>=(c=null!==this.viewportMinimum?this.viewportMinimum:this.dataInfo.viewPortMin)&&!isFinite(d)?(d=typeof this.options.interval>"u"?0:this.options.interval,c=1):0>=c?c=d:isFinite(d)||(d=c),1===c&&1===d?(d*=this.logarithmBase-1/this.logarithmBase,c=1):d/c==1?(d*=k=Math.min(d*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,5)),c/=k):c>d?(k=Math.min(c/d*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,5)),1<=d?c=d/k:d=c*k):(k=Math.min(d/c*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,.04)),1!==d&&(d*=k),1!==c&&(c/=k)),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:d/c>this.logarithmBase?d/c*Math.pow(this.logarithmBase,.5):this.logarithmBase,this.includeZero&&(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&1<c&&(c=1),this.includeZero&&(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&1>d&&(d=1)),k=(isNaN(this.viewportMaximum)||null===this.viewportMaximum?d:this.viewportMaximum)/(isNaN(this.viewportMinimum)||null===this.viewportMinimum?c:this.viewportMinimum);var C=(isNaN(this.viewportMaximum)||null===this.viewportMaximum?d:this.viewportMaximum)-(isNaN(this.viewportMinimum)||null===this.viewportMinimum?c:this.viewportMinimum);if(this.intervalType="number",k=Math.pow(this.logarithmBase,wt.getNiceNumber(Math.abs(Math.log(k)/o),!1)),this.options&&0<this.options.interval?this.interval=this.options.interval:(this.interval=wt.getNiceExponent(Math.log(k)/o/(f-1),!0),y=wt.getNiceNumber(C/(f-1),!0)),(null===this.viewportMinimum||isNaN(this.viewportMinimum))&&(this.viewportMinimum="axisX"===this.type?c/Math.sqrt(M):Math.pow(this.logarithmBase,this.interval*Math.floor(Math.log(c)/o/this.interval))),(null===this.viewportMaximum||isNaN(this.viewportMaximum))&&(this.viewportMaximum="axisX"===this.type?d*Math.sqrt(M):Math.pow(this.logarithmBase,this.interval*Math.ceil(Math.log(d)/o/this.interval))),1===this.viewportMaximum&&1===this.viewportMinimum&&(1===this.options.viewportMinimum?this.viewportMaximum*=this.logarithmBase-1/this.logarithmBase:1===this.options.viewportMaximum&&(this.viewportMinimum/=this.logarithmBase-1/this.logarithmBase),this.options&&typeof this.options.interval>"u"&&(this.interval=wt.getNiceExponent(Math.ceil(Math.log(k)/o)/(f-1)),y=wt.getNiceNumber((this.viewportMaximum-this.viewportMinimum)/(f-1),!0))),(null===this.minimum||null===this.maximum)&&("axisX"===this.type?((d=null!==this.maximum?this.maximum:this.dataInfo.max)/(c=null!==this.minimum?this.minimum:this.dataInfo.min)==1&&(d*=k=Math.pow(this.logarithmBase,typeof this.options.interval>"u"?.4:this.options.interval),c/=k),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:d/c>this.logarithmBase?d/c*Math.pow(this.logarithmBase,.5):this.logarithmBase):"axisY"===this.type&&(c=null!==this.minimum?this.minimum:this.dataInfo.min,d=null!==this.maximum?this.maximum:this.dataInfo.max,isFinite(c)||isFinite(d)?1===c&&1===d?(d*=this.logarithmBase,c/=this.logarithmBase):d/c==1?(d*=k=Math.pow(this.logarithmBase,this.interval),c/=k):c>d?(k=Math.min(c/d*.01,5),1<=d?c=d/k:d=c*k):(k=Math.min(d/c*Math.pow(this.logarithmBase,.01),Math.pow(this.logarithmBase,.04)),1!==d&&(d*=k),1!==c&&(c/=k)):(d=typeof this.options.interval>"u"?0:this.options.interval,c=1),M=this.dataInfo.minDiff!==1/0?this.dataInfo.minDiff:d/c>this.logarithmBase?d/c*Math.pow(this.logarithmBase,.5):this.logarithmBase,this.includeZero&&(null===this.minimum||isNaN(this.minimum))&&1<c&&(c=1),this.includeZero&&(null===this.maximum||isNaN(this.maximum))&&1>d&&(d=1)),this.intervalType="number",null===this.minimum&&(this.minimum="axisX"===this.type?c/Math.sqrt(M):Math.pow(this.logarithmBase,this.interval*Math.floor(Math.log(c)/o/this.interval)),Et(null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?typeof this.sessionVariables.newViewportMinimum>"u"?1/0:this.sessionVariables.newViewportMinimum:this.sessionVariables.viewportMinimum)||(this.minimum=Math.min(this.minimum,null===this.sessionVariables.viewportMinimum||isNaN(this.sessionVariables.viewportMinimum)?typeof this.sessionVariables.newViewportMinimum>"u"?1/0:this.sessionVariables.newViewportMinimum:this.sessionVariables.viewportMinimum))),null===this.maximum&&(this.maximum="axisX"===this.type?d*Math.sqrt(M):Math.pow(this.logarithmBase,this.interval*Math.ceil(Math.log(d)/o/this.interval)),Et(null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?typeof this.sessionVariables.newViewportMaximum>"u"?0:this.sessionVariables.newViewportMaximum:this.sessionVariables.viewportMaximum)||(this.maximum=Math.max(this.maximum,null===this.sessionVariables.viewportMaximum||isNaN(this.sessionVariables.viewportMaximum)?typeof this.sessionVariables.newViewportMaximum>"u"?0:this.sessionVariables.newViewportMaximum:this.sessionVariables.viewportMaximum))),1===this.maximum&&1===this.minimum&&(1===this.options.minimum?this.maximum*=this.logarithmBase-1/this.logarithmBase:1===this.options.maximum&&(this.minimum/=this.logarithmBase-1/this.logarithmBase))),this.viewportMinimum=Math.max(this.viewportMinimum,this.minimum),this.viewportMaximum=Math.min(this.viewportMaximum,this.maximum),this.viewportMinimum>this.viewportMaximum&&(!this.options.viewportMinimum&&!this.options.minimum||this.options.viewportMaximum||this.options.maximum?this.options.viewportMinimum||this.options.minimum||!this.options.viewportMaximum&&!this.options.maximum||(this.viewportMinimum=this.minimum=(this.options.viewportMaximum||this.options.maximum)/Math.pow(this.logarithmBase,2*Math.ceil(this.interval))):this.viewportMaximum=this.maximum=this.options.viewportMinimum||this.options.minimum),c=Math.pow(this.logarithmBase,Math.floor(Math.log(this.viewportMinimum)/(o*this.interval)+.2)*this.interval),this.range=this.viewportMaximum/this.viewportMinimum,this.noTicks=f,!this.options.interval&&this.range<Math.pow(this.logarithmBase,8>this.viewportMaximum||3>f?2:3)){for(o=Math.floor(this.viewportMinimum/y+.5)*y;o<this.viewportMinimum;)o+=y;this.equidistantInterval=!1,this.intervalStartPosition=o,this.interval=y}else this.options.interval||(y=Math.ceil(this.interval),this.range>this.interval&&(this.interval=y,c=Math.pow(this.logarithmBase,Math.floor(Math.log(this.viewportMinimum)/(o*this.interval)+.2)*this.interval))),this.equidistantInterval=!0,this.intervalStartPosition=c;if(!this.valueFormatString&&(this.valueFormatString="#,##0.##",1>this.viewportMinimum)&&(o=Math.floor(Math.abs(Math.log(this.viewportMinimum)/Math.LN10))+2,(isNaN(o)||!isFinite(o))&&(o=2),2<o))for(k=0;k<o-2;k++)this.valueFormatString+="#"},wt.generateValueFormatString=function(o,y){var f="#,##0.",c=y;1>o&&(c+=Math.floor(Math.abs(Math.log(o)/Math.LN10)),isNaN(c)||!isFinite(c))&&(c=y);for(var d=0;d<c;d++)f+="#";return f},wt.getNiceExponent=function(o,y){var f=Math.floor(Math.log(o)/Math.LN10),c=o/Math.pow(10,f);return c=0>f?1>=c?1:5>=c?5:10:Math.max(Math.floor(c),1),Number(-20>f?c*Math.pow(10,f):(c*Math.pow(10,f)).toFixed(20))},wt.getNiceNumber=function(o,y){var f=Math.floor(Math.log(o)/Math.LN10),c=o/Math.pow(10,f);return c=y?1.5>c?1:3>c?2:7>c?5:10:1>=c?1:2>=c?2:5>=c?5:10,Number(-20>f?c*Math.pow(10,f):(c*Math.pow(10,f)).toFixed(20))},wt.prototype.getLabelStartPoint=function(){var o=In[this.intervalType+"Duration"]*this.interval;return o=new Date(Math.floor(this.viewportMinimum/o)*o),"millisecond"!==this.intervalType&&("second"===this.intervalType?0<o.getMilliseconds()&&(o.setSeconds(o.getSeconds()+1),o.setMilliseconds(0)):"minute"===this.intervalType?(0<o.getSeconds()||0<o.getMilliseconds())&&(o.setMinutes(o.getMinutes()+1),o.setSeconds(0),o.setMilliseconds(0)):"hour"===this.intervalType?(0<o.getMinutes()||0<o.getSeconds()||0<o.getMilliseconds())&&(o.setHours(o.getHours()+1),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"day"===this.intervalType?(0<o.getHours()||0<o.getMinutes()||0<o.getSeconds()||0<o.getMilliseconds())&&(o.setDate(o.getDate()+1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"week"===this.intervalType?(0<o.getDay()||0<o.getHours()||0<o.getMinutes()||0<o.getSeconds()||0<o.getMilliseconds())&&(o.setDate(o.getDate()+(7-o.getDay())),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"month"===this.intervalType?(1<o.getDate()||0<o.getHours()||0<o.getMinutes()||0<o.getSeconds()||0<o.getMilliseconds())&&(o.setMonth(o.getMonth()+1),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)):"year"===this.intervalType&&(0<o.getMonth()||1<o.getDate()||0<o.getHours()||0<o.getMinutes()||0<o.getSeconds()||0<o.getMilliseconds())&&(o.setFullYear(o.getFullYear()+1),o.setMonth(0),o.setDate(1),o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0))),o},On(It,fn),On(Gt,fn),Gt.prototype.createUserOptions=function(o){if(typeof o<"u"||this.options._isPlaceholder){var y=0;this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.options._isPlaceholder||(fo(this.parent[this.optionsName]),y=this.parent.options[this.optionsName].indexOf(this.options)),this.options=typeof o>"u"?{}:o,this.parent.options[this.optionsName][y]=this.options}},Gt.prototype.render=function(o){if(0!==this.spacing||0!==this.options.lineThickness&&(typeof this.options.lineThickness<"u"||0!==this.parent.lineThickness)){var y=this.ctx,f=this.ctx.globalAlpha;this.ctx=o||this.ctx,this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.chart.plotArea.x1,this.chart.plotArea.y1,this.chart.plotArea.width,this.chart.plotArea.height),this.ctx.clip();var M,k,C,R,B,O,c=this.scaleBreaks.parent.getPixelCoordinatesOnAxis(this.startValue),d=this.scaleBreaks.parent.getPixelCoordinatesOnAxis(this.endValue);this.ctx.strokeStyle=this.lineColor,this.ctx.fillStyle=this.color,this.ctx.beginPath(),this.ctx.globalAlpha=1,an(this.id),o=Math.max(this.spacing,3);var L=Math.max(0,this.lineThickness);if(this.ctx.lineWidth=L,this.ctx.setLineDash&&this.ctx.setLineDash(Ti(this.lineDashType,L)),"bottom"===this.scaleBreaks.parent._position||"top"===this.scaleBreaks.parent._position){if(k=L%2==1?.5+(d.x<<0):d.x<<0,"top"===this.scaleBreaks.parent._position?(d=this.chart.plotArea.y1,C=this.chart.plotArea.y2+L/2+.5<<0):(d=this.chart.plotArea.y2,C=this.chart.plotArea.y1-L/2+.5<<0,o*=-1),this.bounds={x1:(c=L%2==1?.5+(c.x<<0):c.x<<0)-L/2,y1:d,x2:k+L/2,y2:C},this.ctx.moveTo(c,d),"straight"===this.type||"top"===this.scaleBreaks.parent._position&&0>=o||"bottom"===this.scaleBreaks.parent._position&&0<=o)this.ctx.lineTo(c,C),this.ctx.lineTo(k,C),this.ctx.lineTo(k,d);else if("wavy"===this.type){R=c,M=.5,O=(C-(B=d))/o/3;for(var X=0;X<O;X++)this.ctx.bezierCurveTo(R+M*o,B+o,R+M*o,B+2*o,R,B+3*o),B+=3*o,M*=-1;for(this.ctx.bezierCurveTo(R+M*o,B+o,R+M*o,B+2*o,R,B+3*o),M*=-1,this.ctx.lineTo(R=k,B),X=0;X<O;X++)this.ctx.bezierCurveTo(R+M*o,B-o,R+M*o,B-2*o,R,B-3*o),B-=3*o,M*=-1}else if("zigzag"===this.type){for(M=-1,R=c+o,O=(C-(B=d+o))/o/2,X=0;X<O;X++)this.ctx.lineTo(R,B),R+=2*M*o,B+=2*o,M*=-1;for(this.ctx.lineTo(R,B),R+=k-c,X=0;X<O+1;X++)this.ctx.lineTo(R,B),R+=2*M*o,B-=2*o,M*=-1;this.ctx.lineTo(R+M*o,B+o)}}else if("left"===this.scaleBreaks.parent._position||"right"===this.scaleBreaks.parent._position)if(C=L%2==1?.5+(c.y<<0):c.y<<0,"left"===this.scaleBreaks.parent._position?(c=this.chart.plotArea.x1,k=this.chart.plotArea.x2+L/2+.5<<0):(c=this.chart.plotArea.x2,k=this.chart.plotArea.x1-L/2+.5<<0,o*=-1),this.bounds={x1:c,y1:(d=L%2==1?.5+(d.y<<0):d.y<<0)-L/2,x2:k,y2:C+L/2},this.ctx.moveTo(c,d),"straight"===this.type||"left"===this.scaleBreaks.parent._position&&0>=o||"right"===this.scaleBreaks.parent._position&&0<=o)this.ctx.lineTo(k,d),this.ctx.lineTo(k,C),this.ctx.lineTo(c,C);else if("wavy"===this.type){for(B=d,M=.5,O=(k-(R=c))/o/3,X=0;X<O;X++)this.ctx.bezierCurveTo(R+o,B+M*o,R+2*o,B+M*o,R+3*o,B),R+=3*o,M*=-1;for(this.ctx.bezierCurveTo(R+o,B+M*o,R+2*o,B+M*o,R+3*o,B),M*=-1,this.ctx.lineTo(R,B=C),X=0;X<O;X++)this.ctx.bezierCurveTo(R-o,B+M*o,R-2*o,B+M*o,R-3*o,B),R-=3*o,M*=-1}else if("zigzag"===this.type){for(M=1,B=d-o,O=(k-(R=c+o))/o/2,X=0;X<O;X++)this.ctx.lineTo(R,B),B+=2*M*o,R+=2*o,M*=-1;for(this.ctx.lineTo(R,B),B+=C-d,X=0;X<O+1;X++)this.ctx.lineTo(R,B),B+=2*M*o,R-=2*o,M*=-1;this.ctx.lineTo(R+o,B+M*o)}0<L&&this.ctx.stroke(),this.ctx.closePath(),this.ctx.globalAlpha=this.fillOpacity,this.ctx.globalCompositeOperation="destination-over",this.ctx.fill(),this.ctx.restore(),this.ctx.globalAlpha=f,this.ctx=y}},On(re,fn),re.prototype.createUserOptions=function(o){if(typeof o<"u"||this.options._isPlaceholder){var y=0;this.parent.options._isPlaceholder&&this.parent.createUserOptions(),this.options._isPlaceholder||(fo(this.parent.stripLines),y=this.parent.options.stripLines.indexOf(this.options)),this.options=typeof o>"u"?{}:o,this.parent.options.stripLines[y]=this.options}},re.prototype.render=function(){this.ctx.save();var o=this.parent.getPixelCoordinatesOnAxis(this.value),y=Math.abs("pixel"===this._thicknessType?this.thickness:Math.abs(this.parent.convertValueToPixel(this.endValue)-this.parent.convertValueToPixel(this.startValue)));if(0<y){var f=null===this.opacity?1:this.opacity;this.ctx.strokeStyle=this.color,this.ctx.beginPath();var d,M,k,C,c=this.ctx.globalAlpha;this.ctx.globalAlpha=f,an(this.id),this.ctx.lineWidth=y,this.ctx.setLineDash&&this.ctx.setLineDash(Ti(this.lineDashType,y)),"bottom"===this.parent._position||"top"===this.parent._position?(d=M=this.ctx.lineWidth%2==1?.5+(o.x<<0):o.x<<0,this.bounds={x1:d-y/2,y1:k=this.chart.plotArea.y1,x2:M+y/2,y2:C=this.chart.plotArea.y2}):("left"===this.parent._position||"right"===this.parent._position)&&(k=C=this.ctx.lineWidth%2==1?.5+(o.y<<0):o.y<<0,this.bounds={x1:d=this.chart.plotArea.x1,y1:k-y/2,x2:M=this.chart.plotArea.x2,y2:C+y/2}),this.ctx.moveTo(d,k),this.ctx.lineTo(M,C),this.ctx.stroke(),this.ctx.globalAlpha=c}this.ctx.restore()},On(te,fn),te.prototype.showAt=function(o){if(!this.enabled)return!1;var y=this.chart,f=!1;if(y.resetOverlayedCanvas(),y.clearedOverlayedCanvas=this.parent.type,this.chart.renderCrosshairs(this.parent),"xySwapped"===y.plotInfo.axisPlacement){if("bottom"===this.parent._position)for(var c=0;c<y.axisY.length;c++)this.parent===y.axisY[c]&&(y.axisY[c]._crosshairValue=o>=y.axisY[c].viewportMinimum&&o<=y.axisY[c].viewportMaximum?o:null);else if("top"===this.parent._position)for(c=0;c<y.axisY2.length;c++)this.parent===y.axisY2[c]&&(y.axisY2[c]._crosshairValue=o>=y.axisY2[c].viewportMinimum&&o<=y.axisY2[c].viewportMaximum?o:null);else if("left"===this.parent._position)for(c=0;c<y.axisX.length;c++)this.parent===y.axisX[c]&&(y.axisX[c]._crosshairValue=o>=y.axisX[c].viewportMinimum&&o<=y.axisX[c].viewportMaximum?o:null);else if("right"===this.parent._position)for(c=0;c<y.axisX2.length;c++)this.parent===y.axisX2[c]&&(y.axisX2[c]._crosshairValue=o>=y.axisX2[c].viewportMinimum&&o<=y.axisX2[c].viewportMaximum?o:null)}else if("bottom"===this.parent._position)for(c=0;c<y.axisX.length;c++)this.parent===y.axisX[c]&&(y.axisX[c]._crosshairValue=o>=y.axisX[c].viewportMinimum&&o<=y.axisX[c].viewportMaximum?o:null);else if("top"===this.parent._position)for(c=0;c<y.axisX2.length;c++)this.parent===y.axisX2[c]&&(y.axisX2[c]._crosshairValue=o>=y.axisX2[c].viewportMinimum&&o<=y.axisX2[c].viewportMaximum?o:null);else if("left"===this.parent._position)for(c=0;c<y.axisY.length;c++)this.parent===y.axisY[c]&&(y.axisY[c]._crosshairValue=o>=y.axisY[c].viewportMinimum&&o<=y.axisY[c].viewportMaximum?o:null);else if("right"===this.parent._position)for(c=0;c<y.axisY2.length;c++)this.parent===y.axisY2[c]&&(y.axisY2[c]._crosshairValue=o>=y.axisY2[c].viewportMinimum&&o<=y.axisY2[c].viewportMaximum?o:null);for(c=0;c<y.axisX.length;c++)o=y.axisX[c]._crosshairValue,y.axisX[c].crosshair&&y.axisX[c].crosshair.enabled&&!Et(o)&&o>=y.axisX[c].viewportMinimum&&o<=y.axisX[c].viewportMaximum&&(y.axisX[c].showCrosshair(o),y.axisX[c].crosshair._updatedValue=o,this===y.axisX[c].crosshair&&(f=!0));for(c=0;c<y.axisX2.length;c++)o=y.axisX2[c]._crosshairValue,y.axisX2[c].crosshair&&y.axisX2[c].crosshair.enabled&&!Et(o)&&o>=y.axisX2[c].viewportMinimum&&o<=y.axisX2[c].viewportMaximum&&(y.axisX2[c].showCrosshair(o),y.axisX2[c].crosshair._updatedValue=o,this===y.axisX2[c].crosshair&&(f=!0));for(c=0;c<y.axisY.length;c++)o=y.axisY[c]._crosshairValue,y.axisY[c].crosshair&&y.axisY[c].crosshair.enabled&&!Et(o)&&o>=y.axisY[c].viewportMinimum&&o<=y.axisY[c].viewportMaximum&&(y.axisY[c].showCrosshair(o),y.axisY[c].crosshair._updatedValue=o,this===y.axisY[c].crosshair&&(f=!0));for(c=0;c<y.axisY2.length;c++)o=y.axisY2[c]._crosshairValue,y.axisY2[c].crosshair&&y.axisY2[c].crosshair.enabled&&!Et(o)&&o>=y.axisY2[c].viewportMinimum&&o<=y.axisY2[c].viewportMaximum&&(y.axisY2[c].showCrosshair(o),y.axisY2[c].crosshair._updatedValue=o,this===y.axisY2[c].crosshair&&(f=!0));return this.chart.toolTip&&this.chart.toolTip._entries&&this.chart.toolTip.highlightObjects(this.chart.toolTip._entries),f},te.prototype.hide=function(){this.chart.resetOverlayedCanvas(),this.chart.renderCrosshairs(this.parent),this._hidden=!0},te.prototype.render=function(o,y,f){var c,d,M,k,C=null,R=null,O=null,B="";if(!this.valueFormatString)if("dateTime"===this.parent.valueType)this.valueFormatString=this.parent.valueFormatString;else{var L=0;L="xySwapped"===this.chart.plotInfo.axisPlacement?50<this.parent.range?0:500<this.chart.width&&25>this.parent.range?2:Math.floor(Math.abs(Math.log(this.parent.range)/Math.LN10))+(5>this.parent.range?2:10>this.parent.range?1:0):50<this.parent.range?0:Math.floor(Math.abs(Math.log(this.parent.range)/Math.LN10))+(5>this.parent.range?2:10>this.parent.range?1:0),this.valueFormatString=wt.generateValueFormatString(this.parent.range,L)}O=null===this.opacity?1:this.opacity,L=Math.abs("pixel"===this._thicknessType?this.thickness:this.parent.conversionParameters.pixelPerUnit*this.thickness);var X=this.chart.overlaidCanvasCtx,E=X.globalAlpha;if(X.globalAlpha=O,X.beginPath(),X.strokeStyle=this.color,X.lineWidth=L,X.save(),this.labelFontSize=Math.abs(Et(this.options.labelFontSize)?this.parent.labelFontSize:this.labelFontSize),this.labelMaxWidth=Et(this.options.labelMaxWidth)?.3*this.chart.width:this.labelMaxWidth,this.labelMaxHeight=Et(this.options.labelWrap)||this.labelWrap?.3*this.chart.height:2*this.labelFontSize,0<L&&X.setLineDash&&X.setLineDash(Ti(this.lineDashType,L)),O=new En(X,{x:0,y:0,padding:{top:2,right:3,bottom:2,left:4},backgroundColor:this.labelBackgroundColor,borderColor:this.labelBorderColor,borderThickness:this.labelBorderThickness,cornerRadius:this.labelCornerRadius,maxWidth:this.labelMaxWidth,maxHeight:this.labelMaxHeight,angle:this.labelAngle,text:B,horizontalAlign:"left",fontSize:this.labelFontSize,fontFamily:this.labelFontFamily,fontWeight:this.labelFontWeight,fontColor:this.labelFontColor,fontStyle:this.labelFontStyle,textBaseline:"middle"}),this.snapToDataPoint){var Y=0;if(B=[],"xySwapped"===this.chart.plotInfo.axisPlacement){var it=null;"bottom"===this.parent._position||"top"===this.parent._position?Y=this.parent.dataSeries[0].axisX.convertPixelToValue({y}):("left"===this.parent._position||"right"===this.parent._position)&&(Y=this.parent.convertPixelToValue({y}));for(var J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(it.dataSeries=this.parent.dataSeries[J],null!==it.dataPoint.y&&it.dataSeries.visible&&B.push(it));if(it=null,0===B.length)return;if(B.sort(function(mt,Tt){return mt.distance-Tt.distance}),it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y)),J=0,"rangeBar"===B[0].dataSeries.type||"error"===B[0].dataSeries.type){it=Math.abs(o-this.parent.convertValueToPixel(B[J].dataPoint.y[0]));var q=0;for(Y=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(var nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y)))<it&&(it=q,J=Y)}else if("stackedBar"===B[0].dataSeries.type){it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y));var dt=q=0;for(Y=J=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else dt+=B[Y].dataPoint.y,(q=Math.abs(o-this.parent.convertValueToPixel(dt)))<it&&(it=q,J=Y)}else if("stackedBar100"===B[0].dataSeries.type){it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y));var gt=dt=q=0;for(Y=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else dt+=B[Y].dataPoint.y,gt=B[Y].dataPoint.x.getTime?B[Y].dataPoint.x.getTime():B[Y].dataPoint.x,gt=dt/B[Y].dataSeries.plotUnit.dataPointYSums[gt]*100,(q=Math.abs(o-this.parent.convertValueToPixel(gt)))<it&&(it=q,J=Y)}else for(it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y)),Y=J=q=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else(q=Math.abs(o-this.parent.convertValueToPixel(B[Y].dataPoint.y)))<it&&(it=q,J=Y);if(nt=B[J],"bottom"===this.parent._position||"top"===this.parent._position){if(c=0,"rangeBar"===this.parent.dataSeries[J].type||"error"===this.parent.dataSeries[J].type){for(it=Math.abs(o-this.parent.convertValueToPixel(nt.dataPoint.y[0])),Y=q=0;Y<nt.dataPoint.y.length;Y++)(q=Math.abs(o-this.parent.convertValueToPixel(nt.dataPoint.y[Y])))<it&&(it=q,c=Y);C=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataPoint.y[c])<<0):this.parent.convertValueToPixel(nt.dataPoint.y[c])<<0,this.value=nt.dataPoint.y[c],O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.y[c]}):Et(this.options.label)?Gn(f||nt.dataPoint.y[c],this.valueFormatString,this.chart._cultureInfo):this.label}else if("stackedBar"===this.parent.dataSeries[J].type){for(it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y)),dt=q=0,Y=J;0<=Y;Y--)dt+=B[Y].dataPoint.y,(q=Math.abs(o-this.parent.convertValueToPixel(dt)))<it&&(it=q,c=Y);C=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(dt)<<0):this.parent.convertValueToPixel(dt)<<0,this.value=dt,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.y}):Et(this.options.label)?Gn(f||nt.dataPoint.y,this.valueFormatString,this.chart._cultureInfo):this.label}else if("stackedBar100"===this.parent.dataSeries[J].type){for(it=Math.abs(o-this.parent.convertValueToPixel(B[0].dataPoint.y)),gt=dt=q=0,Y=J;0<=Y;Y--)dt+=B[Y].dataPoint.y,gt=B[Y].dataPoint.x.getTime?B[Y].dataPoint.x.getTime():B[Y].dataPoint.x,gt=dt/B[Y].dataSeries.plotUnit.dataPointYSums[gt]*100,(q=Math.abs(o-this.parent.convertValueToPixel(gt)))<it&&(it=q,c=Y);C=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(gt)<<0):this.parent.convertValueToPixel(gt)<<0,this.value=gt,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:gt}):Et(this.options.label)?Gn(f||gt,this.valueFormatString,this.chart._cultureInfo):this.label}else C=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataPoint.y)<<0):this.parent.convertValueToPixel(nt.dataPoint.y)<<0,this.value=nt.dataPoint.y,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.y}):Et(this.options.label)?Gn(f||nt.dataPoint.y,this.valueFormatString,this.chart._cultureInfo):this.label;c=d=C,this.bounds={x1:c-L/2,y1:M=this.chart.plotArea.y1,x2:d+L/2,y2:k=this.chart.plotArea.y2},O.x=c-O.measureText().width/2,O.x+O.width>this.chart.bounds.x2?O.x=this.chart.bounds.x2-O.width:O.x<this.chart.bounds.x1&&(O.x=this.chart.bounds.x1),O.y=this.parent.lineCoordinates.y2+("top"===this.parent._position?-O.height+this.parent.tickLength:O.fontSize/2)+2,O.y+O.height>this.chart.bounds.y2?O.y=this.chart.bounds.y2-O.height:O.y<this.chart.bounds.y1&&(O.y=this.chart.bounds.y1)}else if("left"===this.parent._position||"right"===this.parent._position){if(M=k=R=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataPoint.x)<<0):this.parent.convertValueToPixel(nt.dataPoint.x)<<0,this.bounds={x1:c=this.chart.plotArea.x1,y1:M-L/2,x2:d=this.chart.plotArea.x2,y2:k+L/2},gt=!1,this.parent.labels)for(B=Math.ceil(this.parent.interval),Y=0;Y<this.parent.viewportMaximum;Y+=B){if(!this.parent.labels[Y]){gt=!1;break}gt=!0}if(gt){if("axisX"===this.parent.type)for(Y=this.parent.convertPixelToValue({y}),it=null,J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?it.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?Es(nt.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?Gn(nt.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label);this.value=nt.dataPoint.x,O.y=k+O.fontSize/2-O.measureText().height/2+2,O.y-O.fontSize/2<this.chart.bounds.y1?O.y=this.chart.bounds.y1+O.fontSize/2+2:O.y+O.measureText().height-O.fontSize/2>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.measureText().height+O.fontSize/2),"left"===this.parent._position?O.x=this.parent.lineCoordinates.x2-O.measureText().width:"right"===this.parent._position&&(O.x=this.parent.lineCoordinates.x2)}}else if("bottom"===this.parent._position||"top"===this.parent._position){for(Y=this.parent.convertPixelToValue({x:o}),J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(it.dataSeries=this.parent.dataSeries[J],null!==it.dataPoint.y&&it.dataSeries.visible&&B.push(it));if(0===B.length)return;if(B.sort(function(mt,Tt){return mt.distance-Tt.distance}),nt=B[0],c=d=C=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataPoint.x)<<0):this.parent.convertValueToPixel(nt.dataPoint.x)<<0,this.bounds={x1:c-L/2,y1:M=this.chart.plotArea.y1,x2:d+L/2,y2:k=this.chart.plotArea.y2},gt=!1,this.parent.labels)for(B=Math.ceil(this.parent.interval),Y=0;Y<this.parent.viewportMaximum;Y+=B){if(!this.parent.labels[Y]){gt=!1;break}gt=!0}if(gt){if("axisX"===this.parent.type)for(Y=this.parent.convertPixelToValue({x:o}),it=null,J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?it.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?Es(nt.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.x}):Et(this.options.label)?Gn(nt.dataPoint.x,this.valueFormatString,this.chart._cultureInfo):this.label);this.value=nt.dataPoint.x,O.x=c-O.measureText().width/2,O.x+O.width>this.chart.bounds.x2&&(O.x=this.chart.bounds.x2-O.width),O.x<this.chart.bounds.x1&&(O.x=this.chart.bounds.x1),"bottom"===this.parent._position?O.y=this.parent.lineCoordinates.y2+O.fontSize/2+2:"top"===this.parent._position&&(O.y=this.parent.lineCoordinates.y1-O.height+O.fontSize/2+2)}else if("left"===this.parent._position||"right"===this.parent._position){for(!Et(this.parent.dataSeries)&&0<this.parent.dataSeries.length&&(Y=this.parent.dataSeries[0].axisX.convertPixelToValue({x:o})),J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(it.dataSeries=this.parent.dataSeries[J],null!==it.dataPoint.y&&it.dataSeries.visible&&B.push(it));if(0===B.length)return;if(B.sort(function(mt,Tt){return mt.distance-Tt.distance}),J=0,"rangeColumn"===B[0].dataSeries.type||"rangeArea"===B[0].dataSeries.type||"error"===B[0].dataSeries.type||"rangeSplineArea"===B[0].dataSeries.type||"candlestick"===B[0].dataSeries.type||"ohlc"===B[0].dataSeries.type||"boxAndWhisker"===B[0].dataSeries.type)for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y[0])),Y=q=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y)))<it&&(it=q,J=Y);else if("stackedColumn"===B[0].dataSeries.type||"stackedArea"===B[0].dataSeries.type)for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y)),Y=dt=q=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else dt+=B[Y].dataPoint.y,(q=Math.abs(y-this.parent.convertValueToPixel(dt)))<it&&(it=q,J=Y);else if("stackedColumn100"===B[0].dataSeries.type||"stackedArea100"===B[0].dataSeries.type)for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y)),Y=gt=dt=q=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else dt+=B[Y].dataPoint.y,gt=B[Y].dataPoint.x.getTime?B[Y].dataPoint.x.getTime():B[Y].dataPoint.x,gt=dt/B[Y].dataSeries.plotUnit.dataPointYSums[gt]*100,(q=Math.abs(y-this.parent.convertValueToPixel(gt)))<it&&(it=q,J=Y);else for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y)),Y=q=0;Y<B.length;Y++)if(B[Y].dataPoint.y&&B[Y].dataPoint.y.length)for(nt=0;nt<B[Y].dataPoint.y.length;nt++)(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y[nt])))<it&&(it=q,J=Y);else(q=Math.abs(y-this.parent.convertValueToPixel(B[Y].dataPoint.y)))<it&&(it=q,J=Y);if(nt=B[J],c=0,"rangeColumn"===this.parent.dataSeries[J].type||"rangeArea"===this.parent.dataSeries[J].type||"error"===this.parent.dataSeries[J].type||"rangeSplineArea"===this.parent.dataSeries[J].type||"candlestick"===this.parent.dataSeries[J].type||"ohlc"===this.parent.dataSeries[J].type||"boxAndWhisker"===this.parent.dataSeries[J].type){for(it=Math.abs(y-this.parent.convertValueToPixel(nt.dataPoint.y[0])),Y=q=0;Y<nt.dataPoint.y.length;Y++)(q=Math.abs(y-this.parent.convertValueToPixel(nt.dataPoint.y[Y])))<it&&(it=q,c=Y);R=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataPoint.y[c])<<0):this.parent.convertValueToPixel(nt.dataPoint.y[c])<<0,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.y[c]}):Et(this.options.label)?Gn(f||nt.dataPoint.y[c],this.valueFormatString,this.chart._cultureInfo):this.label,this.value=nt.dataPoint.y[c]}else if("stackedColumn"===this.parent.dataSeries[J].type||"stackedArea"===this.parent.dataSeries[J].type){for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y)),dt=q=0,Y=J;0<=Y;Y--)dt+=B[Y].dataPoint.y,(q=Math.abs(y-this.parent.convertValueToPixel(dt)))<it&&(it=q,c=Y);R=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(dt)<<0):this.parent.convertValueToPixel(dt)<<0,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataPoint.y}):Et(this.options.label)?Gn(f||nt.dataPoint.y,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=dt}else if("stackedColumn100"===this.parent.dataSeries[J].type||"stackedArea100"===this.parent.dataSeries[J].type){for(it=Math.abs(y-this.parent.convertValueToPixel(B[0].dataPoint.y)),dt=q=0,Y=J;0<=Y;Y--)dt+=B[Y].dataPoint.y,gt=B[Y].dataPoint.x.getTime?B[Y].dataPoint.x.getTime():B[Y].dataPoint.x,gt=dt/B[Y].dataSeries.plotUnit.dataPointYSums[gt]*100,(q=Math.abs(y-this.parent.convertValueToPixel(gt)))<it&&(it=q,c=Y);R=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(gt)<<0):this.parent.convertValueToPixel(gt)<<0,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:gt}):Et(this.options.label)?Gn(f||gt,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=gt}else"waterfall"===this.parent.dataSeries[J].type?(R=X.lineWidth%2==1?.5+(this.parent.convertValueToPixel(nt.dataSeries.dataPointEOs[nt.index].cumulativeSum)<<0):this.parent.convertValueToPixel(nt.dataSeries.dataPointEOs[nt.index].cumulativeSum)<<0,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:nt.dataSeries.dataPointEOs[nt.index].cumulativeSum}):Et(this.options.label)?Gn(f||nt.dataSeries.dataPointEOs[nt.index].cumulativeSum,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=nt.dataSeries.dataPointEOs[nt.index].cumulativeSum):(R=X.lineWidth%2==1?(Et(o)?y:this.parent.convertValueToPixel(nt.dataPoint.y)<<0)+.5:Et(o)?y:this.parent.convertValueToPixel(nt.dataPoint.y)<<0,O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||nt.dataPoint.y}):Et(this.options.label)?Gn(f||nt.dataPoint.y,this.valueFormatString,this.chart._cultureInfo):this.label,this.value=nt.dataPoint.y);M=k=R,this.bounds={x1:c=this.chart.plotArea.x1,y1:M-L/2,x2:d=this.chart.plotArea.x2,y2:k+L/2},O.y=k+O.fontSize/2-O.measureText().height/2+2,O.y-O.fontSize/2<this.chart.bounds.y1?O.y=this.chart.bounds.y1+O.fontSize/2+2:O.y+O.measureText().height-O.fontSize/2>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.measureText().height+O.fontSize/2),"left"===this.parent._position?O.x=this.parent.lineCoordinates.x2-O.measureText().width:"right"===this.parent._position&&(O.x=this.parent.lineCoordinates.x2)}B=null,("bottom"===this.parent._position||"top"===this.parent._position)&&("top"===this.parent._position&&O.y-O.fontSize/2<this.chart.bounds.y1&&(O.y=this.chart.bounds.y1+O.fontSize/2),"bottom"===this.parent._position&&this.parent.lineCoordinates.y2-O.fontSize/2+O.measureText().height>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.height+O.fontSize/2+2),c>=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMaximum:this.parent.viewportMinimum)&&d<=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMinimum:this.parent.viewportMaximum)&&(0<L&&(X.moveTo(c,M),X.lineTo(d,k),X.stroke(),this._hidden=!1),X.restore())),("left"===this.parent._position||"right"===this.parent._position)&&("left"===this.parent._position&&O.x<this.chart.bounds.x1&&(O.x=this.chart.bounds.x1),"right"===this.parent._position&&O.x+O.measureText().width>this.chart.bounds.x2&&(O.x=this.chart.bounds.x2-O.measureText().width),k>=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMinimum:this.parent.viewportMaximum)&&M<=this.parent.convertValueToPixel(this.parent.reversed?this.parent.viewportMaximum:this.parent.viewportMinimum)&&(0<L&&(X.moveTo(c,M),X.lineTo(d,k),X.stroke(),this._hidden=!1),X.restore()))}else{if("bottom"===this.parent._position||"top"===this.parent._position?(c=d=C=X.lineWidth%2==1?.5+(o<<0):o<<0,this.bounds={x1:c-L/2,y1:M=this.chart.plotArea.y1,x2:d+L/2,y2:k=this.chart.plotArea.y2}):("left"===this.parent._position||"right"===this.parent._position)&&(M=k=R=X.lineWidth%2==1?.5+(y<<0):y<<0,this.bounds={x1:c=this.chart.plotArea.x1,y1:M-L/2,x2:d=this.chart.plotArea.x2,y2:k+L/2}),"xySwapped"===this.chart.plotInfo.axisPlacement)if("left"===this.parent._position||"right"===this.parent._position){if(gt=!1,this.parent.labels)for(B=Math.ceil(this.parent.interval),Y=0;Y<this.parent.viewportMaximum;Y+=B){if(!this.parent.labels[Y]){gt=!1;break}gt=!0}if(gt){if("axisX"===this.parent.type)for(Y=this.parent.convertPixelToValue({y}),it=null,J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(o)}):Et(this.options.label)?it.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(y)}):Et(this.options.label)?Es(f||this.parent.convertPixelToValue(y),this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(y)}):Et(this.options.label)?Gn(f||this.parent.convertPixelToValue(y),this.valueFormatString,this.chart._cultureInfo):this.label);O.y=y+O.fontSize/2-O.measureText().height/2+2,O.y-O.fontSize/2<this.chart.bounds.y1?O.y=this.chart.bounds.y1+O.fontSize/2+2:O.y+O.measureText().height-O.fontSize/2>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.measureText().height+O.fontSize/2),"left"===this.parent._position?O.x=this.parent.lineCoordinates.x1-O.measureText().width:"right"===this.parent._position&&(O.x=this.parent.lineCoordinates.x2)}else("bottom"===this.parent._position||"top"===this.parent._position)&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(o)}):Et(this.options.label)?Gn(f||this.parent.convertPixelToValue(o),this.valueFormatString,this.chart._cultureInfo):this.label,O.x=c-O.measureText().width/2,O.x+O.width>this.chart.bounds.x2&&(O.x=this.chart.bounds.x2-O.width),O.x<this.chart.bounds.x1&&(O.x=this.chart.bounds.x1),"bottom"===this.parent._position?O.y=this.parent.lineCoordinates.y2+O.fontSize/2+2:"top"===this.parent._position&&(O.y=this.parent.lineCoordinates.y1-O.height+O.fontSize/2+2));else if("bottom"===this.parent._position||"top"===this.parent._position){if(gt=!1,B="",this.parent.labels)for(B=Math.ceil(this.parent.interval),Y=0;Y<this.parent.viewportMaximum;Y+=B){if(!this.parent.labels[Y]){gt=!1;break}gt=!0}if(gt){if("axisX"===this.parent.type)for(Y=this.parent.convertPixelToValue({x:o}),it=null,J=0;J<this.parent.dataSeries.length;J++)(it=this.parent.dataSeries[J].getDataPointAtX(Y,!0))&&0<=it.index&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(o)}):Et(this.options.label)?f||it.dataPoint.label:this.label)}else"dateTime"===this.parent.valueType?O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(o)}):Et(this.options.label)?Es(f||this.parent.convertPixelToValue(o),this.valueFormatString,this.chart._cultureInfo):this.label:"number"===this.parent.valueType&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||(0<this.parent.dataSeries.length?this.parent.convertPixelToValue(o):"")}):Et(this.options.label)?Gn(f||this.parent.convertPixelToValue(o),this.valueFormatString,this.chart._cultureInfo):this.label);O.x=c-O.measureText().width/2,O.x+O.width>this.chart.bounds.x2&&(O.x=this.chart.bounds.x2-O.width),O.x<this.chart.bounds.x1&&(O.x=this.chart.bounds.x1),"bottom"===this.parent._position?O.y=this.parent.lineCoordinates.y2+O.fontSize/2+2:"top"===this.parent._position&&(O.y=this.parent.lineCoordinates.y1-O.height+O.fontSize/2+2)}else("left"===this.parent._position||"right"===this.parent._position)&&(O.text=this.labelFormatter?this.labelFormatter({chart:this.chart,axis:this.parent.options,crosshair:this.options,value:f||this.parent.convertPixelToValue(y)}):Et(this.options.label)?Gn(f||this.parent.convertPixelToValue(y),this.valueFormatString,this.chart._cultureInfo):this.label,O.y=y+O.fontSize/2-O.measureText().height/2+2,O.y-O.fontSize/2<this.chart.bounds.y1?O.y=this.chart.bounds.y1+O.fontSize/2+2:O.y+O.measureText().height-O.fontSize/2>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.measureText().height+O.fontSize/2),"left"===this.parent._position?O.x=this.parent.lineCoordinates.x2-O.measureText().width:"right"===this.parent._position&&(O.x=this.parent.lineCoordinates.x2));"left"===this.parent._position&&O.x<this.chart.bounds.x1?O.x=this.chart.bounds.x1:"right"===this.parent._position&&O.x+O.measureText().width>this.chart.bounds.x2?O.x=this.chart.bounds.x2-O.measureText().width:"top"===this.parent._position&&O.y-O.fontSize/2<this.chart.bounds.y1?O.y=this.chart.bounds.y1+O.fontSize/2:"bottom"===this.parent._position&&this.parent.lineCoordinates.y2-O.fontSize/2+O.measureText().height>this.chart.bounds.y2&&(O.y=this.chart.bounds.y2-O.height+O.fontSize/2+2),0<L&&(X.moveTo(c,M),X.lineTo(d,k),X.stroke(),this._hidden=!1),X.restore(),this.value=this.parent.convertPixelToValue("bottom"===this.parent._position||"top"===this.parent._position?o:y)}("bottom"===this.parent._position||"top"===this.parent._position)&&(this._updatedValue=this.parent.convertPixelToValue(C)),("left"===this.parent._position||"right"===this.parent._position)&&(this._updatedValue=this.parent.convertPixelToValue(R)),this._textBlock=O,Et(f)||this.renderLabel(),X.globalAlpha=E},te.prototype.renderLabel=function(){Et(this._textBlock)||Et(this._textBlock.text)||!("number"==typeof this._textBlock.text.valueOf()||0<this._textBlock.text.length)||this._hidden||this._textBlock.render(!0)},On(ie,fn),ie.prototype._initialize=function(){if(this.updateOption("updated"),this.updateOption("hidden"),this.enabled){this.container=document.createElement("div"),this.container.setAttribute("class","canvasjs-chart-tooltip"),this.container.style.position="absolute",this.container.style.height="auto",this.container.style.boxShadow="1px 1px 2px 2px rgba(0,0,0,0.1)",this.container.style.zIndex="1000",this.container.style.pointerEvents="none",this.container.style.display="none";var o=document.createElement("div");o.style.width="auto",o.style.height="auto",o.style.minWidth="50px",o.style.lineHeight="normal",o.style.margin="0px 0px 0px 0px",o.style.padding="5px",o.style.fontFamily="Calibri, Arial, Georgia, serif",o.style.fontWeight="normal",o.style.fontStyle=rt?"italic":"normal",o.style.fontSize="14px",o.style.color="#000000",o.style.textShadow="1px 1px 1px rgba(0, 0, 0, 0.1)",o.style.textAlign="left",o.style.border="2px solid gray",o.style.background=rt?"rgba(255,255,255,.9)":"rgb(255,255,255)",o.style.textIndent="0px",o.style.whiteSpace="nowrap",o.style.borderRadius="5px",o.style.MozUserSelect="none",o.style.WebkitUserSelect="none",o.style.msUserSelect="none",o.style.userSelect="none",rt||(o.style.filter="alpha(opacity = 90)",o.style.filter="progid:DXImageTransform.Microsoft.Shadow(Strength=3, Direction=135, Color='#666666')"),o.innerText="Sample Tooltip",this.container.appendChild(o),this.contentDiv=this.container.firstChild,this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.chart._canvasJSContainer.appendChild(this.container)}},ie.prototype.mouseMoveHandler=function(o,y){this._lastUpdated&&4>(new Date).getTime()-this._lastUpdated||(this._lastUpdated=(new Date).getTime(),this.chart.resetOverlayedCanvas(),this._updateToolTip(o,y))},ie.prototype._updateToolTip=function(o,y,f){if(f=typeof f>"u"||f,this.container||this._initialize(),this.enabled||this.hide(),!this.chart.disableToolTip){if(typeof o>"u"||typeof y>"u"){if(isNaN(this._prevX)||isNaN(this._prevY))return;o=this._prevX,y=this._prevY}else this._prevX=o,this._prevY=y;var c=null,d=null,M=[],k=0;if(this.shared&&this.enabled&&"none"!==this.chart.plotInfo.axisPlacement){if("xySwapped"===this.chart.plotInfo.axisPlacement){var C=[];if(this.chart.axisX)for(var R=0;R<this.chart.axisX.length;R++){k=this.chart.axisX[R].convertPixelToValue({y});var B=null;for(c=0;c<this.chart.axisX[R].dataSeries.length;c++)(B=this.chart.axisX[R].dataSeries[c].getDataPointAtX(k,f))&&0<=B.index&&(B.dataSeries=this.chart.axisX[R].dataSeries[c],null!==B.dataPoint.y&&C.push(B));B=null}if(this.chart.axisX2)for(R=0;R<this.chart.axisX2.length;R++){for(k=this.chart.axisX2[R].convertPixelToValue({y}),B=null,c=0;c<this.chart.axisX2[R].dataSeries.length;c++)(B=this.chart.axisX2[R].dataSeries[c].getDataPointAtX(k,f))&&0<=B.index&&(B.dataSeries=this.chart.axisX2[R].dataSeries[c],null!==B.dataPoint.y&&C.push(B));B=null}}else{if(C=[],this.chart.axisX)for(R=0;R<this.chart.axisX.length;R++)for(k=this.chart.axisX[R].convertPixelToValue({x:o}),B=null,c=0;c<this.chart.axisX[R].dataSeries.length;c++)(B=this.chart.axisX[R].dataSeries[c].getDataPointAtX(k,f))&&0<=B.index&&(B.dataSeries=this.chart.axisX[R].dataSeries[c],null!==B.dataPoint.y&&C.push(B));if(this.chart.axisX2)for(R=0;R<this.chart.axisX2.length;R++)for(k=this.chart.axisX2[R].convertPixelToValue({x:o}),B=null,c=0;c<this.chart.axisX2[R].dataSeries.length;c++)(B=this.chart.axisX2[R].dataSeries[c].getDataPointAtX(k,f))&&0<=B.index&&(B.dataSeries=this.chart.axisX2[R].dataSeries[c],null!==B.dataPoint.y&&C.push(B))}if(0===C.length)return;for(C.sort(function(O,L){return O.distance-L.distance}),f=C[0],c=0;c<C.length;c++)C[c].dataPoint.x.valueOf()===f.dataPoint.x.valueOf()&&M.push(C[c]);C=null}else{if(c=this.chart.getDataPointAtXY(o,y,f))this.currentDataPointIndex=c.dataPointIndex,this.currentSeriesIndex=c.dataSeries.index;else if(rt)if(0<(c=yo(o,y,this.chart._eventManager.ghostCtx))&&typeof this.chart._eventManager.objectMap[c]<"u"){if("legendItem"===(c=this.chart._eventManager.objectMap[c]).objectType)return;this.currentSeriesIndex=c.dataSeriesIndex,this.currentDataPointIndex=0<=c.dataPointIndex?c.dataPointIndex:-1}else this.currentDataPointIndex=-1;else this.currentDataPointIndex=-1;if(0<=this.currentSeriesIndex){if(d=this.chart.data[this.currentSeriesIndex],B={},0<=this.currentDataPointIndex)c=d.dataPoints[this.currentDataPointIndex],B.dataSeries=d,B.dataPoint=c,B.index=this.currentDataPointIndex,B.distance=Math.abs(c.x-k),"waterfall"===d.type&&(B.cumulativeSumYStartValue=d.dataPointEOs[this.currentDataPointIndex].cumulativeSumYStartValue,B.cumulativeSum=d.dataPointEOs[this.currentDataPointIndex].cumulativeSum);else{if(!this.enabled||"line"!==d.type&&"stepLine"!==d.type&&"spline"!==d.type&&"area"!==d.type&&"stepArea"!==d.type&&"splineArea"!==d.type&&"stackedArea"!==d.type&&"stackedArea100"!==d.type&&"rangeArea"!==d.type&&"rangeSplineArea"!==d.type&&"candlestick"!==d.type&&"ohlc"!==d.type&&"boxAndWhisker"!==d.type)return;k=d.axisX.convertPixelToValue({x:o}),Et(B=d.getDataPointAtX(k,f))||(B.dataSeries=d,this.currentDataPointIndex=B.index,c=B.dataPoint)}if(!Et(B)&&!Et(B.dataPoint)&&!Et(B.dataPoint.y))if(B.dataSeries.axisY)if(0<B.dataPoint.y.length){for(c=f=0;c<B.dataPoint.y.length;c++)B.dataPoint.y[c]<B.dataSeries.axisY.viewportMinimum?f--:B.dataPoint.y[c]>B.dataSeries.axisY.viewportMaximum&&f++;f<B.dataPoint.y.length&&f>-B.dataPoint.y.length&&M.push(B)}else"column"===d.type||"bar"===d.type?0>B.dataPoint.y?0>B.dataSeries.axisY.viewportMinimum&&B.dataSeries.axisY.viewportMaximum>=B.dataPoint.y&&M.push(B):B.dataSeries.axisY.viewportMinimum<=B.dataPoint.y&&0<=B.dataSeries.axisY.viewportMaximum&&M.push(B):"bubble"===d.type?B.dataPoint.y>=B.dataSeries.axisY.viewportMinimum-(f=this.chart._eventManager.objectMap[d.dataPointIds[B.index]].size/2)&&B.dataPoint.y<=B.dataSeries.axisY.viewportMaximum+f&&M.push(B):"waterfall"===d.type?(f=0,B.cumulativeSumYStartValue<B.dataSeries.axisY.viewportMinimum?f--:B.cumulativeSumYStartValue>B.dataSeries.axisY.viewportMaximum&&f++,B.cumulativeSum<B.dataSeries.axisY.viewportMinimum?f--:B.cumulativeSum>B.dataSeries.axisY.viewportMaximum&&f++,2>f&&-2<f&&M.push(B)):(0<=B.dataSeries.type.indexOf("100")||"stackedColumn"===d.type||"stackedBar"===d.type||B.dataPoint.y>=B.dataSeries.axisY.viewportMinimum&&B.dataPoint.y<=B.dataSeries.axisY.viewportMaximum)&&M.push(B);else M.push(B)}}if(0<M.length){if(this.highlightObjects(M),this.enabled){if(f="",null!==(f=this.getToolTipInnerHTML({entries:M}))){if(this.contentDiv.innerHTML=f,this.isToolTipDefinedInData&&Et(this.options.content)&&Et(this.options.contentFormatter))for(k=this.contentDiv.getElementsByTagName("span"),c=0;c<k.length;c++)k[c]&&(k[c].style.color=k[c].getAttribute("data-color"));k=!1,"none"===this.container.style.display&&(k=!0,this.container.style.display="block");try{this.contentDiv.style.background=this.backgroundColor?this.backgroundColor:rt?"rgba(255,255,255,.9)":"rgb(255,255,255)",this.borderColor=this.contentDiv.style.borderRightColor=this.contentDiv.style.borderLeftColor=this.contentDiv.style.borderColor="waterfall"===M[0].dataSeries.type?this.options.borderColor?this.options.borderColor:M[0].dataPoint.color?M[0].dataPoint.color:0<M[0].dataPoint.y?M[0].dataSeries.risingColor:M[0].dataSeries.fallingColor:"error"===M[0].dataSeries.type?this.options.borderColor?this.options.borderColor:M[0].dataSeries.color?M[0].dataSeries.color:M[0].dataSeries._colorSet[d.index%M[0].dataSeries._colorSet.length]:this.options.borderColor?this.options.borderColor:M[0].dataPoint.color?M[0].dataPoint.color:M[0].dataSeries.color?M[0].dataSeries.color:M[0].dataSeries._colorSet[M[0].index%M[0].dataSeries._colorSet.length],this.contentDiv.style.borderWidth=this.borderThickness||0===this.borderThickness?this.borderThickness+"px":"2px",this.contentDiv.style.borderRadius=this.cornerRadius||0===this.cornerRadius?this.cornerRadius+"px":"5px",this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.contentDiv.style.fontSize=this.fontSize||0===this.fontSize?this.fontSize+"px":"14px",this.contentDiv.style.color=this.fontColor?this.fontColor:"#000000",this.contentDiv.style.fontFamily=this.fontFamily?this.fontFamily:"Calibri, Arial, Georgia, serif;",this.contentDiv.style.fontWeight=this.fontWeight?this.fontWeight:"normal",this.contentDiv.style.fontStyle=this.fontStyle?this.fontStyle:rt?"italic":"normal"}catch{}"pie"===M[0].dataSeries.type||"doughnut"===M[0].dataSeries.type||"funnel"===M[0].dataSeries.type||"pyramid"===M[0].dataSeries.type||"bar"===M[0].dataSeries.type||"rangeBar"===M[0].dataSeries.type||"stackedBar"===M[0].dataSeries.type||"stackedBar100"===M[0].dataSeries.type?o=o-10-this.container.clientWidth:(o=M[0].dataSeries.axisX.convertValueToPixel(M[0].dataPoint.x)-this.container.clientWidth<<0,o-=10),0>o&&(o+=this.container.clientWidth+20),o+this.container.clientWidth>Math.max(this.chart.container.clientWidth,this.chart.width)&&(o=Math.max(0,Math.max(this.chart.container.clientWidth,this.chart.width)-this.container.clientWidth)),0<(y=10-(y=1!==M.length||this.shared||"line"!==M[0].dataSeries.type&&"stepLine"!==M[0].dataSeries.type&&"spline"!==M[0].dataSeries.type&&"area"!==M[0].dataSeries.type&&"stepArea"!==M[0].dataSeries.type&&"splineArea"!==M[0].dataSeries.type?"bar"===M[0].dataSeries.type||"rangeBar"===M[0].dataSeries.type||"stackedBar"===M[0].dataSeries.type||"stackedBar100"===M[0].dataSeries.type?M[0].dataSeries.axisX.convertValueToPixel(M[0].dataPoint.x):y:M[0].dataSeries.axisY.convertValueToPixel(M[0].dataPoint.y)))+this.container.clientHeight+5&&(y-=y+this.container.clientHeight+5-0),this.fixMozTransitionDelay(o,y),!this.animationEnabled||k?this.disableAnimation():(this.enableAnimation(),this.container.style.MozTransition=this.mozContainerTransition),this.positionLeft=o,this.positionBottom=y,this.container.style.left=o+"px",this.container.style.bottom=y+"px"}else this.hide(!1),this.enabled&&this.dispatchEvent("hidden",{chart:this.chart,toolTip:this},this);for(y=[],c=0;c<M.length;c++)y.push({xValue:M[c].dataPoint.x,dataPoint:M[c].dataPoint,dataSeries:M[c].dataSeries,dataPointIndex:M[c].index,dataSeriesIndex:M[c].dataSeries._index});y={chart:this.chart,toolTip:this.options,content:f,entries:y},this._entries=M,this.dispatchEvent("updated",y,this)}}else this.hide(),this.enabled&&this.dispatchEvent("hidden",{chart:this.chart,toolTip:this},this)}},ie.prototype.highlightObjects=function(o){var y=this.chart.overlaidCanvasCtx;(Et(this.chart.clearedOverlayedCanvas)||"toolTip"===this.chart.clearedOverlayedCanvas)&&(this.chart.resetOverlayedCanvas(),y.clearRect(0,0,this.chart.width,this.chart.height),this.chart.clearedOverlayedCanvas="toolTip"),y.save();var f=this.chart.plotArea,c=0;for(y.beginPath(),y.rect(f.x1,f.y1,f.x2-f.x1,f.y2-f.y1),y.clip(),f=0;f<o.length;f++){var d=o[f];if((d=this.chart._eventManager.objectMap[d.dataSeries.dataPointIds[d.index]])&&d.objectType&&"dataPoint"===d.objectType){var M=(c=this.chart.data[d.dataSeriesIndex]).dataPoints[d.dataPointIndex],k=d.dataPointIndex;!1===M.highlightEnabled||!0!==c.highlightEnabled&&!0!==M.highlightEnabled||("line"===c.type||"stepLine"===c.type||"spline"===c.type||"scatter"===c.type||"area"===c.type||"stepArea"===c.type||"splineArea"===c.type||"stackedArea"===c.type||"stackedArea100"===c.type||"rangeArea"===c.type||"rangeSplineArea"===c.type?((M=c.getMarkerProperties(k,d.x1,d.y1,this.chart.overlaidCanvasCtx)).size=Math.max(1.5*M.size<<0,10),M.borderColor=M.borderColor||"#FFFFFF",M.borderThickness=M.borderThickness||Math.ceil(.1*M.size),D.drawMarkers([M]),typeof d.y2<"u"&&((M=c.getMarkerProperties(k,d.x1,d.y2,this.chart.overlaidCanvasCtx)).size=Math.max(1.5*M.size<<0,10),M.borderColor=M.borderColor||"#FFFFFF",M.borderThickness=M.borderThickness||Math.ceil(.1*M.size),D.drawMarkers([M]))):"bubble"===c.type?((M=c.getMarkerProperties(k,d.x1,d.y1,this.chart.overlaidCanvasCtx)).size=d.size,M.color="white",M.borderColor="white",y.globalAlpha=.3,D.drawMarkers([M]),y.globalAlpha=1):"column"===c.type||"stackedColumn"===c.type||"stackedColumn100"===c.type||"bar"===c.type||"rangeBar"===c.type||"stackedBar"===c.type||"stackedBar100"===c.type||"rangeColumn"===c.type||"waterfall"===c.type?is(y,d.x1,d.y1,d.x2,d.y2,"white",0,null,!1,!1,!1,!1,.3):"pie"===c.type||"doughnut"===c.type?g(y,d.center,d.radius,"white",c.type,d.startAngle,d.endAngle,.3,d.percentInnerRadius):"funnel"===c.type||"pyramid"===c.type?x(y,d.funnelSection,.3,"white"):"candlestick"===c.type?(y.globalAlpha=1,y.strokeStyle=d.color,y.lineWidth=2*d.borderThickness,c=y.lineWidth%2==0?0:.5,y.beginPath(),y.moveTo(d.x3-c,Math.min(d.y2,d.y3)),y.lineTo(d.x3-c,Math.min(d.y1,d.y4)),y.stroke(),y.beginPath(),y.moveTo(d.x3-c,Math.max(d.y1,d.y4)),y.lineTo(d.x3-c,Math.max(d.y2,d.y3)),y.stroke(),is(y,d.x1,Math.min(d.y1,d.y4),d.x2,Math.max(d.y1,d.y4),"transparent",2*d.borderThickness,d.color,!1,!1,!1,!1),y.globalAlpha=1):"ohlc"===c.type?(y.globalAlpha=1,y.strokeStyle=d.color,y.lineWidth=2*d.borderThickness,c=y.lineWidth%2==0?0:.5,y.beginPath(),y.moveTo(d.x3-c,d.y2),y.lineTo(d.x3-c,d.y3),y.stroke(),y.beginPath(),y.moveTo(d.x3,d.y1),y.lineTo(d.x1,d.y1),y.stroke(),y.beginPath(),y.moveTo(d.x3,d.y4),y.lineTo(d.x2,d.y4),y.stroke(),y.globalAlpha=1):"boxAndWhisker"===c.type?(y.save(),y.globalAlpha=1,y.strokeStyle=d.stemColor,y.lineWidth=2*d.stemThickness,0<d.stemThickness&&(y.beginPath(),y.moveTo(d.x3,d.y2+d.borderThickness/2),y.lineTo(d.x3,d.y1+d.whiskerThickness/2),y.stroke(),y.beginPath(),y.moveTo(d.x3,d.y4-d.whiskerThickness/2),y.lineTo(d.x3,d.y3-d.borderThickness/2),y.stroke()),y.beginPath(),is(y,d.x1-d.borderThickness/2,Math.max(d.y2+d.borderThickness/2,d.y3+d.borderThickness/2),d.x2+d.borderThickness/2,Math.min(d.y2-d.borderThickness/2,d.y3-d.borderThickness/2),"transparent",d.borderThickness,d.color,!1,!1,!1,!1),y.globalAlpha=1,y.strokeStyle=d.whiskerColor,y.lineWidth=2*d.whiskerThickness,0<d.whiskerThickness&&(y.beginPath(),y.moveTo(Math.floor(d.x3-d.whiskerLength/2),d.y4),y.lineTo(Math.ceil(d.x3+d.whiskerLength/2),d.y4),y.stroke(),y.beginPath(),y.moveTo(Math.floor(d.x3-d.whiskerLength/2),d.y1),y.lineTo(Math.ceil(d.x3+d.whiskerLength/2),d.y1),y.stroke()),y.globalAlpha=1,y.strokeStyle=d.lineColor,y.lineWidth=2*d.lineThickness,0<d.lineThickness&&(y.beginPath(),y.moveTo(d.x1,d.y5),y.lineTo(d.x2,d.y5),y.stroke()),y.restore(),y.globalAlpha=1):"error"===c.type&&yt(y,d.x1,d.y1,d.x2,d.y2,"white",d.whiskerProperties,d.stemProperties,d.isXYSwapped,.3))}}y.restore(),y.globalAlpha=1,y.beginPath()},ie.prototype.getToolTipInnerHTML=function(o){o=o.entries;var y=null,f=null,c=null,d=0,M="";this.isToolTipDefinedInData=!0;for(var k=0;k<o.length;k++)if(o[k].dataSeries.toolTipContent||o[k].dataPoint.toolTipContent){this.isToolTipDefinedInData=!1;break}if(this.isToolTipDefinedInData&&(this.content&&"function"==typeof this.content||this.contentFormatter))o={chart:this.chart,toolTip:this.options,entries:o},y=this.contentFormatter?this.contentFormatter(o):this.content(o);else if(this.shared&&"none"!==this.chart.plotInfo.axisPlacement){var C=null,R="";for(k=0;k<o.length;k++)f=o[k].dataSeries,c=o[k].dataPoint,d=o[k].index,M="",0===k&&this.isToolTipDefinedInData&&!this.content&&(this.chart.axisX&&0<this.chart.axisX.length?R+=typeof this.chart.axisX[0].labels[c.x]<"u"?this.chart.axisX[0].labels[c.x]:"{x}":this.chart.axisX2&&0<this.chart.axisX2.length&&(R+=typeof this.chart.axisX2[0].labels[c.x]<"u"?this.chart.axisX2[0].labels[c.x]:"{x}"),R=this.chart.replaceKeywordsWithValue(R+="</br>",c,f,d)),null===c.toolTipContent||typeof c.toolTipContent>"u"&&null===f.options.toolTipContent||("line"===f.type||"stepLine"===f.type||"spline"===f.type||"area"===f.type||"stepArea"===f.type||"splineArea"===f.type||"column"===f.type||"bar"===f.type||"scatter"===f.type||"stackedColumn"===f.type||"stackedColumn100"===f.type||"stackedBar"===f.type||"stackedBar100"===f.type||"stackedArea"===f.type||"stackedArea100"===f.type||"waterfall"===f.type?(this.chart.axisX&&1<this.chart.axisX.length&&(M+=C!=f.axisXIndex?f.axisX.title?f.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),M+=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y}",C=f.axisXIndex):"bubble"===f.type?(this.chart.axisX&&1<this.chart.axisX.length&&(M+=C!=f.axisXIndex?f.axisX.title?f.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),M+=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y}, &nbsp;&nbsp;{z}"):"rangeColumn"===f.type||"rangeBar"===f.type||"rangeArea"===f.type||"rangeSplineArea"===f.type||"error"===f.type?(this.chart.axisX&&1<this.chart.axisX.length&&(M+=C!=f.axisXIndex?f.axisX.title?f.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),M+=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span>&nbsp;&nbsp;{y[0]},&nbsp;{y[1]}"):"candlestick"===f.type||"ohlc"===f.type?(this.chart.axisX&&1<this.chart.axisX.length&&(M+=C!=f.axisXIndex?f.axisX.title?f.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),M+=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span><br/>Open: &nbsp;&nbsp;{y[0]}<br/>High: &nbsp;&nbsp;&nbsp;{y[1]}<br/>Low:&nbsp;&nbsp;&nbsp;{y[2]}<br/>Close: &nbsp;&nbsp;{y[3]}"):"boxAndWhisker"===f.type&&(this.chart.axisX&&1<this.chart.axisX.length&&(M+=C!=f.axisXIndex?f.axisX.title?f.axisX.title+"<br/>":"X:{axisXIndex}<br/>":""),M+=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>{name}:</span><br/>Minimum: &nbsp;&nbsp;{y[0]}<br/>Q1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[1]}<br/>Q2: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[4]}<br/>Q3: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Maximum: &nbsp;{y[3]}"),null===y&&(y=""),!0===this.reversed?(y=this.chart.replaceKeywordsWithValue(M,c,f,d)+y,k<o.length-1&&(y="</br>"+y)):(y+=this.chart.replaceKeywordsWithValue(M,c,f,d),k<o.length-1&&(y+="</br>")));null!==y&&(y=R+y)}else{if(f=o[0].dataSeries,null===(c=o[0].dataPoint).toolTipContent||typeof c.toolTipContent>"u"&&null===f.options.toolTipContent)return null;"line"===f.type||"stepLine"===f.type||"spline"===f.type||"area"===f.type||"stepArea"===f.type||"splineArea"===f.type||"column"===f.type||"bar"===f.type||"scatter"===f.type||"stackedColumn"===f.type||"stackedColumn100"===f.type||"stackedBar"===f.type||"stackedBar100"===f.type||"stackedArea"===f.type||"stackedArea100"===f.type||"waterfall"===f.type?M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.label?"{label}":"{x}")+":</span>&nbsp;&nbsp;{y}":"bubble"===f.type?M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.label?"{label}":"{x}")+":</span>&nbsp;&nbsp;{y}, &nbsp;&nbsp;{z}":"pie"===f.type||"doughnut"===f.type||"funnel"===f.type||"pyramid"===f.type?M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.name?"{name}:</span>&nbsp;&nbsp;":c.label?"{label}:</span>&nbsp;&nbsp;":"</span>")+"{y}":"rangeColumn"===f.type||"rangeBar"===f.type||"rangeArea"===f.type||"rangeSplineArea"===f.type||"error"===f.type?M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.label?"{label}":"{x}")+" :</span>&nbsp;&nbsp;{y[0]}, &nbsp;{y[1]}":"candlestick"===f.type||"ohlc"===f.type?M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.label?"{label}":"{x}")+"</span><br/>Open: &nbsp;&nbsp;{y[0]}<br/>High: &nbsp;&nbsp;&nbsp;{y[1]}<br/>Low: &nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Close: &nbsp;&nbsp;{y[3]}":"boxAndWhisker"===f.type&&(M=c.toolTipContent?c.toolTipContent:f.toolTipContent?f.toolTipContent:this.content&&"function"!=typeof this.content?this.content:"<span data-color='\""+(this.options.fontColor?"":"'{color}'")+"\"'>"+(c.label?"{label}":"{x}")+"</span><br/>Minimum: &nbsp;&nbsp;{y[0]}<br/>Q1: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[1]}<br/>Q2: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[4]}<br/>Q3: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{y[2]}<br/>Maximum: &nbsp;{y[3]}"),null===y&&(y=""),y+=this.chart.replaceKeywordsWithValue(M,c,f,d=o[0].index)}return y},ie.prototype.enableAnimation=function(){if(!this.container.style.WebkitTransition){var o=this.getContainerTransition(this.containerTransitionDuration);this.container.style.WebkitTransition=o,this.container.style.MsTransition=o,this.container.style.transition=o,this.container.style.MozTransition=this.mozContainerTransition}},ie.prototype.disableAnimation=function(){this.container.style.WebkitTransition&&(this.container.style.WebkitTransition="",this.container.style.MozTransition="",this.container.style.MsTransition="",this.container.style.transition="")},ie.prototype.hide=function(o){this.container&&(this.container.style.display="none",this.currentSeriesIndex=-1,this._prevY=this._prevX=NaN,(typeof o>"u"||o)&&this.chart.resetOverlayedCanvas())},ie.prototype.show=function(o,y,f){this._updateToolTip(o,y,!(typeof f>"u")&&f)},ie.prototype.showAtIndex=function(o,y){},ie.prototype.showAtX=function(o,y){if(!this.enabled)return!1;this.chart.clearedOverlayedCanvas=null;var f,c,d,M=[];if(d=!1,y=!Et(y)&&0<=y&&y<this.chart.data.length?y:0,this.shared)for(var k=0;k<this.chart.data.length;k++)(c=(f=this.chart.data[k]).getDataPointAtX(o,!1))&&c.dataPoint&&!Et(c.dataPoint.y)&&f.visible&&(c.dataSeries=f,M.push(c));else(c=(f=this.chart.data[y]).getDataPointAtX(o,!1))&&c.dataPoint&&!Et(c.dataPoint.y)&&f.visible&&(c.dataSeries=f,M.push(c));if(!(0<M.length))return this.hide(),!1;for(k=0;k<M.length;k++){if(!((c=M[k]).dataPoint.x<c.dataSeries.axisX.viewportMinimum||c.dataPoint.x>c.dataSeries.axisX.viewportMaximum||c.dataPoint.y<c.dataSeries.axisY.viewportMinimum||c.dataPoint.y>c.dataSeries.axisY.viewportMaximum)){d=!1;break}d=!0}if(d)return this.hide(),!1;if(this.highlightObjects(M),this._entries=M,k="",null===(k=this.getToolTipInnerHTML({entries:M})))return this.hide(!1),!1;if(this.contentDiv.innerHTML=k,this.isToolTipDefinedInData&&Et(this.options.content)&&Et(this.options.contentFormatter))for(c=this.contentDiv.getElementsByTagName("span"),k=0;k<c.length;k++)c[k]&&(c[k].style.color=c[k].getAttribute("data-color"));k=!1,"none"===this.container.style.display&&(k=!0,this.container.style.display="block");try{this.contentDiv.style.background=this.backgroundColor?this.backgroundColor:rt?"rgba(255,255,255,.9)":"rgb(255,255,255)",this.borderColor=this.contentDiv.style.borderRightColor=this.contentDiv.style.borderLeftColor=this.contentDiv.style.borderColor="waterfall"===M[0].dataSeries.type?this.options.borderColor?this.options.borderColor:M[0].dataPoint.color?M[0].dataPoint.color:0<M[0].dataPoint.y?M[0].dataSeries.risingColor:M[0].dataSeries.fallingColor:"error"===M[0].dataSeries.type?this.options.borderColor?this.options.borderColor:M[0].dataSeries.color?M[0].dataSeries.color:M[0].dataSeries._colorSet[f.index%M[0].dataSeries._colorSet.length]:this.options.borderColor?this.options.borderColor:M[0].dataPoint.color?M[0].dataPoint.color:M[0].dataSeries.color?M[0].dataSeries.color:M[0].dataSeries._colorSet[M[0].index%M[0].dataSeries._colorSet.length],this.contentDiv.style.borderWidth=this.borderThickness||0===this.borderThickness?this.borderThickness+"px":"2px",this.contentDiv.style.borderRadius=this.cornerRadius||0===this.cornerRadius?this.cornerRadius+"px":"5px",this.container.style.borderRadius=this.contentDiv.style.borderRadius,this.contentDiv.style.fontSize=this.fontSize||0===this.fontSize?this.fontSize+"px":"14px",this.contentDiv.style.color=this.fontColor?this.fontColor:"#000000",this.contentDiv.style.fontFamily=this.fontFamily?this.fontFamily:"Calibri, Arial, Georgia, serif;",this.contentDiv.style.fontWeight=this.fontWeight?this.fontWeight:"normal",this.contentDiv.style.fontStyle=this.fontStyle?this.fontStyle:rt?"italic":"normal"}catch{}return"pie"===M[0].dataSeries.type||"doughnut"===M[0].dataSeries.type||"funnel"===M[0].dataSeries.type||"pyramid"===M[0].dataSeries.type?f=mouseX-10-this.container.clientWidth:(f="bar"===M[0].dataSeries.type||"rangeBar"===M[0].dataSeries.type||"stackedBar"===M[0].dataSeries.type||"stackedBar100"===M[0].dataSeries.type?M[0].dataSeries.axisY.convertValueToPixel(M[0].dataPoint.y)-this.container.clientWidth<<0:M[0].dataSeries.axisX.convertValueToPixel(M[0].dataPoint.x)-this.container.clientWidth<<0,f-=10),0>f&&(f+=this.container.clientWidth+20),f+this.container.clientWidth>Math.max(this.chart.container.clientWidth,this.chart.width)&&(f=Math.max(0,Math.max(this.chart.container.clientWidth,this.chart.width)-this.container.clientWidth)),0<(M=10-(M=!(1!==M.length||this.shared||"line"!==M[0].dataSeries.type&&"stepLine"!==M[0].dataSeries.type&&"spline"!==M[0].dataSeries.type&&"area"!==M[0].dataSeries.type&&"stepArea"!==M[0].dataSeries.type&&"splineArea"!==M[0].dataSeries.type)||"bar"!==M[0].dataSeries.type&&"rangeBar"!==M[0].dataSeries.type&&"stackedBar"!==M[0].dataSeries.type&&"stackedBar100"!==M[0].dataSeries.type?M[0].dataSeries.axisY.convertValueToPixel(M[0].dataPoint.y):M[0].dataSeries.axisX.convertValueToPixel(M[0].dataPoint.x)))+this.container.clientHeight+5&&(M-=M+this.container.clientHeight+5-0),this.fixMozTransitionDelay(f,M),!this.animationEnabled||k?this.disableAnimation():(this.enableAnimation(),this.container.style.MozTransition=this.mozContainerTransition),this.container.style.left=f+"px",this.container.style.bottom=M+"px",!0},ie.prototype.fixMozTransitionDelay=function(o,y){if(20<this.chart._eventManager.lastObjectId)this.mozContainerTransition=this.getContainerTransition(0);else{var f=parseFloat(this.container.style.left),c=(f=isNaN(f)?0:f,parseFloat(this.container.style.bottom));c=isNaN(c)?0:c,this.mozContainerTransition=10<Math.sqrt(Math.pow(f-o,2)+Math.pow(c-y,2))?this.getContainerTransition(.1):this.getContainerTransition(0)}},ie.prototype.getContainerTransition=function(o){return"left "+o+"s ease-out 0s, bottom "+o+"s ease-out 0s"},u.prototype.reset=function(){this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.previousDataPointEventObject=null,this.eventObjects=[],rt&&(this.ghostCtx.clearRect(0,0,this.chart.width,this.chart.height),this.ghostCtx.beginPath())},u.prototype.getNewObjectTrackingId=function(){return++this.lastObjectId},u.prototype.mouseEventHandler=function(o){if("mousemove"===o.type||"click"===o.type){var y=[],f=ls(o),c=null;if((c=this.chart.getObjectAtXY(f.x,f.y,!1))&&typeof this.objectMap[c]<"u")if("dataPoint"===(c=this.objectMap[c]).objectType){var d=this.chart.data[c.dataSeriesIndex],M=d.dataPoints[c.dataPointIndex],k=c.dataPointIndex;c.eventParameter={x:f.x,y:f.y,dataPoint:M,dataSeries:d.options,dataPointIndex:k,dataSeriesIndex:d.index,chart:this.chart},c.eventContext={context:M,userContext:M,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},y.push(c),(c=this.objectMap[d.id]).eventParameter={x:f.x,y:f.y,dataPoint:M,dataSeries:d.options,dataPointIndex:k,dataSeriesIndex:d.index,chart:this.chart},c.eventContext={context:d,userContext:d.options,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},y.push(this.objectMap[d.id])}else"legendItem"===c.objectType&&(c.eventParameter={x:f.x,y:f.y,dataSeries:(d=this.chart.data[c.dataSeriesIndex]).options,dataPoint:M=null!==c.dataPointIndex?d.dataPoints[c.dataPointIndex]:null,dataPointIndex:c.dataPointIndex,dataSeriesIndex:c.dataSeriesIndex,chart:this.chart},c.eventContext={context:this.chart.legend,userContext:this.chart.legend.options,mouseover:"itemmouseover",mousemove:"itemmousemove",mouseout:"itemmouseout",click:"itemclick"},y.push(c));for(d=[],f=0;f<this.mouseoveredObjectMaps.length;f++){for(M=!0,c=0;c<y.length;c++)if(y[c].id===this.mouseoveredObjectMaps[f].id){M=!1;break}M?this.fireEvent(this.mouseoveredObjectMaps[f],"mouseout",o):d.push(this.mouseoveredObjectMaps[f])}for(this.mouseoveredObjectMaps=d,f=0;f<y.length;f++){for(d=!1,c=0;c<this.mouseoveredObjectMaps.length;c++)if(y[f].id===this.mouseoveredObjectMaps[c].id){d=!0;break}d||(this.fireEvent(y[f],"mouseover",o),this.mouseoveredObjectMaps.push(y[f])),"click"===o.type?this.fireEvent(y[f],"click",o):"mousemove"===o.type&&this.fireEvent(y[f],"mousemove",o)}}},u.prototype.fireEvent=function(o,y,f){if(o&&y){var c=o.eventParameter,d=o.eventContext,M=o.eventContext.userContext;M&&d&&M[d[y]]&&M[d[y]].call(M,c),"mouseout"!==y?M.cursor&&M.cursor!==f.target.style.cursor&&(f.target.style.cursor=M.cursor):(f.target.style.cursor=this.chart._defaultCursor,delete o.eventParameter,delete o.eventContext),"click"===y&&"dataPoint"===o.objectType&&this.chart.pieDoughnutClickHandler&&this.chart.pieDoughnutClickHandler.call(this.chart.data[o.dataSeriesIndex],c),"click"===y&&"dataPoint"===o.objectType&&this.chart.funnelPyramidClickHandler&&this.chart.funnelPyramidClickHandler.call(this.chart.data[o.dataSeriesIndex],c)}},I.prototype.animate=function(o,y,f,c,d){var M=this;for(this.chart.isAnimating=!0,d=d||w.easing.linear,f&&this.animations.push({startTime:(new Date).getTime()+(o||0),duration:y,animationCallback:f,onComplete:c}),o=[];0<this.animations.length;)y=this.animations.shift(),f=(new Date).getTime(),c=0,y.startTime<=f&&(c=d(Math.min(f-y.startTime,y.duration),0,1,y.duration),c=Math.min(c,1),isNaN(c)||!isFinite(c))&&(c=1),1>c&&o.push(y),y.animationCallback(c),1<=c&&y.onComplete&&y.onComplete();this.animations=o,0<this.animations.length?this.animationRequestId=this.chart.requestAnimFrame.call(window,function(){M.animate.call(M)}):this.chart.isAnimating=!1},I.prototype.cancelAllAnimations=function(){this.animations=[],this.animationRequestId&&this.chart.cancelRequestAnimFrame.call(window,this.animationRequestId),this.animationRequestId=null,this.chart.isAnimating=!1};var w={yScaleAnimation:function(o,y){if(0!==o){var f=y.dest,c=y.source.canvas,d=y.animationBase;f.drawImage(c,0,0,c.width,c.height,0,d-d*o,f.canvas.width/Js,o*f.canvas.height/Js)}},xScaleAnimation:function(o,y){if(0!==o){var f=y.dest,c=y.source.canvas,d=y.animationBase;f.drawImage(c,0,0,c.width,c.height,d-d*o,0,o*f.canvas.width/Js,f.canvas.height/Js)}},xClipAnimation:function(o,y){if(0!==o){var f=y.dest,c=y.source.canvas;f.save(),0<o&&f.drawImage(c,0,0,c.width*o,c.height,0,0,c.width*o/Js,c.height/Js),f.restore()}},fadeInAnimation:function(o,y){if(0!==o){var f=y.dest,c=y.source.canvas;f.save(),f.globalAlpha=o,f.drawImage(c,0,0,c.width,c.height,0,0,f.canvas.width/Js,f.canvas.height/Js),f.restore()}},easing:{linear:function(o,y,f,c){return f*o/c+y},easeOutQuad:function(o,y,f,c){return-f*(o/=c)*(o-2)+y},easeOutQuart:function(o,y,f,c){return-f*((o=o/c-1)*o*o*o-1)+y},easeInQuad:function(o,y,f,c){return f*(o/=c)*o+y},easeInQuart:function(o,y,f,c){return f*(o/=c)*o*o*o+y}}},D={drawMarker:function(o,y,f,c,d,M,k,C){if(f){var R=1;f.fillStyle=M||"#000000",f.strokeStyle=k||"#000000",f.lineWidth=C||0,f.setLineDash&&f.setLineDash(Ti("solid",C)),"circle"===c?(f.moveTo(o,y),f.beginPath(),f.arc(o,y,d/2,0,2*Math.PI,!1),M&&f.fill(),C&&(k?f.stroke():(R=f.globalAlpha,f.globalAlpha=.15,f.strokeStyle="black",f.stroke(),f.globalAlpha=R))):"square"===c?(f.beginPath(),f.rect(o-d/2,y-d/2,d,d),M&&f.fill(),C&&(k?f.stroke():(R=f.globalAlpha,f.globalAlpha=.15,f.strokeStyle="black",f.stroke(),f.globalAlpha=R))):"triangle"===c?(f.beginPath(),f.moveTo(o-d/2,y+d/2),f.lineTo(o+d/2,y+d/2),f.lineTo(o,y-d/2),f.closePath(),M&&f.fill(),C&&(k?f.stroke():(R=f.globalAlpha,f.globalAlpha=.15,f.strokeStyle="black",f.stroke(),f.globalAlpha=R)),f.beginPath()):"cross"===c&&(f.strokeStyle=M,f.lineWidth=d/4,f.beginPath(),f.moveTo(o-d/2,y-d/2),f.lineTo(o+d/2,y+d/2),f.stroke(),f.moveTo(o+d/2,y-d/2),f.lineTo(o-d/2,y+d/2),f.stroke())}},drawMarkers:function(o){for(var y=0;y<o.length;y++){var f=o[y];D.drawMarker(f.x,f.y,f.ctx,f.type,f.size,f.color,f.borderColor,f.borderThickness)}}};return xt}();ri.version="v3.6.4 GA",window.CanvasJS&&ri&&!window.CanvasJS.Chart&&(window.CanvasJS.Chart=ri),Yt.StockChart={width:500,height:600,backgroundColor:"white",theme:"light1",animationEnabled:!1,animationDuration:1200,culture:"en",creditHref:"",creditText:"CanvasJS",exportEnabled:!1,exportFileName:"StockChart",colorSet:"colorSet1",rangeChanging:null,rangeChanged:null,publicProperties:{title:"readWrite",subtitles:"readWrite",toolbar:"readWrite",navigator:"readWrite",rangeSelector:"readWrite",charts:"readWrite",options:"readWrite",bounds:"readOnly",container:"readOnly",selectedColorSet:"readOnly"}},Yt.Navigator={enabled:!0,width:500,height:70,verticalAlign:"bottom",horizontalAlign:"center",dynamicUpdate:!0,backgroundColor:"#fff",animationEnabled:!1,animationDuration:1200,theme:"light1",publicProperties:{slider:"readWrite",backgroundColor:"readWrite",animationEnabled:"readWrite",animationDuration:"readWrite",theme:"readWrite",axisX:"readWrite",axisY:"readWrite",axisX2:"readWrite",axisY2:"readWrite",data:"readWrite",options:"readWrite",bounds:"readOnly"}},Yt.RangeSelector={enabled:!0,width:500,height:35,label:"Range",verticalAlign:"top",horizontalAlign:"center",selectedRangeButtonIndex:null,publicProperties:{options:"readWrite",buttons:"readWrite",inputFields:"readWrite",buttonStyle:"readWrite",bounds:"readOnly"}},Yt.RangeButton={range:null,rangeType:null,label:null,style:"position: inline; margin: 5px 0;text-align:center;cursor: pointer;",backgroundColorDisabled:"#ddd",publicProperties:{options:"readWrite",bounds:"readOnly"}},Yt.ButtonStyle={backgroundColor:"#fff",backgroundColorOnHover:"#2196f3",backgroundColorOnSelect:"#2196f3",borderColor:"#2196f3",borderThickness:2,labelFontColor:"#000",labelFontColorOnHover:"#fff",labelFontSize:14,labelFontStyle:"normal",labelFontFamily:rt?"Trebuchet MS, Helvetica, sans-serif":"Arial",labelFontWeight:"normal",width:null,maxWidth:null,padding:{left:5,right:5,top:2,bottom:2},spacing:5,cursor:"pointer",publicProperties:{options:"readWrite"}},Yt.InputFields={enabled:!0,startValue:null,endValue:null,valueType:"dateTime",valueFormatString:"MMM DD YYYY",publicProperties:{style:"readWrite",options:"readWrite"}},Yt.Style={backgroundColor:"#fff",borderColor:"#2196f3",borderColorOnFocus:"#008eff",borderThickness:2,fontColor:"#000",fontSize:12,fontStyle:"normal",fontFamily:rt?"Trebuchet MS, Helvetica, sans-serif":"Arial",fontWeight:"normal",width:null,maxWidth:null,padding:{left:5,right:5,top:2,bottom:2},spacing:5,cursor:"text",publicProperties:{options:"readWrite"}},Yt.Slider={maskColor:"#d9e8f9",maskInverted:!1,maskOpacity:.7,handleColor:"#ddd",handleBorderColor:"#aaa",handleBorderThickness:1,handleWidth:8,handleHeight:18,minimum:null,maximum:null,outlineThickness:1,outlineColor:"#666",outlineInverted:!1,publicProperties:{options:"readWrite"}},Yt.CultureInfo.rangeSelector={fromText:"From",toText:"To",rangeText:"Range"},Vi="#333333",Qi={colorSet:"colorSet1",backgroundColor:Ke="#FFFFFF",title:Qi.title,subtitles:Qi.subtitles,charts:[Qi],rangeSelector:{buttonStyle:{backgroundColor:"#FEFEFE",backgroundColorOnHover:"#41a5f5",backgroundColorOnSelect:"#2196f3",borderColor:"#2196f3",borderThickness:1,labelFontColor:$e="#000000",labelFontColorOnHover:"#ffffff",labelFontSize:14,labelFontStyle:"normal",labelFontFamily:Xt,labelFontWeight:"normal",spacing:0},inputFields:{style:{backgroundColor:"#ffffff",borderColor:"#2196f3",borderColorOnFocus:"#2196f3",borderThickness:1,fontColor:$e,fontSize:14,fontStyle:"normal",fontFamily:Xt,fontWeight:"normal"}}},navigator:{backgroundColor:Ke,slider:{maskColor:"#d9e8f9",maskOpacity:.6,handleColor:"#efefef",handleBorderColor:"#666666",handleBorderThickness:1,outlineColor:"#666666",outlineThickness:1}},toolbar:Qi.toolbar},Vi="#3A3A3A",ys={colorSet:"colorSet2",backgroundColor:Ke="#FFFFFF",title:ys.title,subtitles:ys.subtitles,charts:[ys],rangeSelector:{buttonStyle:{backgroundColor:"#FEFEFE",backgroundColorOnHover:"#41a5f5",backgroundColorOnSelect:"#2196f3",borderColor:"#2196f3",borderThickness:1,labelFontColor:$e="#666666",labelFontColorOnHover:"#ffffff",labelFontSize:14,labelFontStyle:"normal",labelFontFamily:Xt,labelFontWeight:"normal",spacing:0},inputFields:{style:{backgroundColor:"#ffffff",borderColor:"#2196f3",borderColorOnFocus:"#2196f3",borderThickness:1,fontColor:$e,fontSize:14,fontStyle:"normal",fontFamily:Xt,fontWeight:"normal"}}},navigator:{backgroundColor:Ke,slider:{maskColor:"#D9E8F9",maskOpacity:.6,handleColor:"#EFEFEF",handleBorderColor:"#BBBBBB",handleBorderThickness:1,outlineColor:"#BBBBBB",outlineThickness:1}},toolbar:ys.toolbar},$e=Vi="#F5F5F5",xe={colorSet:"colorSet1",backgroundColor:Ke="#2A2A2A",title:xe.title,subtitles:xe.subtitles,charts:[xe],rangeSelector:{buttonStyle:{backgroundColor:"#666666",backgroundColorOnHover:"#FF7372",backgroundColorOnSelect:"#FF7372",borderColor:"#FF7372",borderThickness:1,labelFontColor:$e,labelFontColorOnHover:"#F5F5F5",labelFontSize:14,labelFontStyle:"normal",labelFontFamily:Xt,labelFontWeight:"normal",spacing:0},inputFields:{style:{backgroundColor:"#666666",borderColor:"#FF7372",borderColorOnFocus:"#FF7372",borderThickness:1,fontColor:$e,fontSize:14,fontStyle:"normal",fontFamily:Xt,fontWeight:"normal"}}},navigator:{backgroundColor:Ke,slider:{maskColor:"#d9e8f9",maskOpacity:.6,handleColor:"#efefef",handleBorderColor:"#666666",handleBorderThickness:1,outlineColor:"#FFFFFF",outlineThickness:1}},toolbar:xe.toolbar},$e=Vi="#FAFAFA";var mi={light1:Qi,light2:ys,dark1:xe,dark2:{colorSet:"colorSet2",backgroundColor:Ke="#32373A",title:hi.title,subtitles:hi.subtitles,charts:[hi],rangeSelector:{buttonStyle:{backgroundColor:"#666666",backgroundColorOnHover:"#FF7372",backgroundColorOnSelect:"#FF7372",borderColor:"#FF7372",borderThickness:1,labelFontColor:$e,labelFontColorOnHover:"#F5F5F5",labelFontSize:14,labelFontStyle:"normal",labelFontFamily:Xt,labelFontWeight:"normal",spacing:0},inputFields:{style:{backgroundColor:"#666666",borderColor:"#FF7372",borderColorOnFocus:"#FF7372",borderThickness:1,fontColor:$e,fontSize:14,fontStyle:"normal",fontFamily:Xt,fontWeight:"normal"}}},navigator:{backgroundColor:Ke,slider:{maskColor:"#d9e8f9",maskOpacity:.6,handleColor:"#efefef",handleBorderColor:"#666666",handleBorderThickness:1,outlineColor:"#FFFFFF",outlineThickness:1}},toolbar:hi.toolbar}};Vi=Le.StockChart=function(){function Q(g){var x;return(x=document.createElement("div")).setAttribute("class",g),un(x,{position:"absolute",textAlign:"left",cursor:"auto",webkitTapHighlightColor:"transparent"}),x}function xt(g,x,w){return(g=document.createElement(g)).setAttribute("class",x),un(g,{webkitTapHighlightColor:"transparent"}),Et(w)||g.setAttribute("type",w),g}function Pt(g,x){this.theme=Et((x=x||{}).theme)||Et(Hs[x.theme])?"light1":x.theme,this.predefinedThemes=mi,Pt.base.constructor.call(this,"StockChart",null,x,null,null),this.optionsName="stockChart";var D,o,w=this;(this.sessionVariables={},this._axisXMax=this._axisXMin=null,this._containerId=g,this._objectsInitialized=!1,this.ctx=null,this.plotArea={canvas:null,ctx:null,x1:0,y1:0,x2:0,y2:0,width:0,height:0},this._dataInRenderedOrder=[],this.allDOMEventHandlers=[],this.container="string"==typeof this._containerId?document.getElementById(this._containerId):this._containerId)?(this.container.innerHTML="",this._defaultCursor="default",o=this.options.height?this.height:0<this.container.clientHeight?this.container.clientHeight:this.height,this.width=D=this.options.width?this.width:0<this.container.clientWidth?this.container.clientWidth:this.width,this.height=o,this.x1=this.y1=0,this.x2=this.width,this.y2=this.height,this.selectedColorSet=typeof We[this.colorSet]<"u"?We[this.colorSet]:We.colorSet1,this._canvasJSContainer=document.createElement("div"),this._canvasJSContainer.setAttribute("class","canvasjs-stock-container"),this._canvasJSContainer.style.position="relative",this._canvasJSContainer.style.userSelect=this._canvasJSContainer.style.WebkitUserSelect=this._canvasJSContainer.style.MozUserSelect=this._canvasJSContainer.style.msUserSelect="none",this._canvasJSContainer.style.textAlign="left",this._canvasJSContainer.style.cursor="auto",this._canvasJSContainer.style.direction="ltr",this._canvasJSContainer.style.fontFamily=Xt,rt||(this._canvasJSContainer.style.height="0px"),this.container.appendChild(this._canvasJSContainer),this.canvas=zi(D,o),this.canvas.style.position="absolute",this.canvas.getContext&&(this._canvasJSContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.textBaseline="top",ks(this.ctx),this.overlaidCanvas=zi(D,o),this.overlaidCanvas.style.position="absolute",this.overlaidCanvas.style.webkitTapHighlightColor="transparent",this.overlaidCanvas.getContext&&(this._canvasJSContainer.appendChild(this.overlaidCanvas),this.overlaidCanvasCtx=this.overlaidCanvas.getContext("2d"),this.overlaidCanvasCtx.textBaseline="top",ks(this.overlaidCanvasCtx)),rt?this.plotArea.ctx=this.ctx:(this.plotArea.canvas=zi(D,o),this.plotArea.canvas.style.position="absolute",this.plotArea.canvas.setAttribute("class","plotAreaCanvas"),this._canvasJSContainer.appendChild(this.plotArea.canvas),this.plotArea.ctx=this.plotArea.canvas.getContext("2d")),this._toolBar=document.createElement("div"),this._toolBar.setAttribute("class","canvasjs-chart-toolbar"),un(this._toolBar,{position:"absolute",right:"1px",top:"1px",zIndex:999}),this._canvasJSContainer.appendChild(this._toolBar),this.bounds={x1:0,y1:0,x2:this.width,y2:this.height},this.charts=[],fo(this.charts),this._eventManager=new pt(this),Li(this.overlaidCanvas,"click",function(y){w._mouseEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mousemove",function(y){w._mouseEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mouseup",function(y){w._mouseEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mousedown",function(y){w._mouseEventHandler(y),As(w._dropdownMenu)},this.allDOMEventHandlers),Li(this.overlaidCanvas,"mouseout",function(y){w._mouseEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(y){w._touchEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerMove":"touchmove",function(y){w._touchEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerUp":"touchend",function(y){w._touchEventHandler(y)},this.allDOMEventHandlers),Li(this.overlaidCanvas,window.navigator.msPointerEnabled?"MSPointerCancel":"touchcancel",function(y){w._touchEventHandler(y)},this.allDOMEventHandlers),this.windowResizeHandler=Li(window,"resize",function(){w._updateSize()&&w.render()},this.allDOMEventHandlers))):window.console&&window.console.log('CanvasJS Error: StockChart Container with id "'+this._containerId+'" was not found')}function yt(g,x){yt.base.constructor.call(this,g,x),this.options=x,this.dockInsidePlotArea=!1}function ct(g,x,w){ct.base.constructor.call(this,g,x,w),this.options=x,this.dockInsidePlotArea=!1}function pt(g){this.stockChart=g,this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.ghostCanvas=zi(this.stockChart.width,this.stockChart.height),this.ghostCtx=this.ghostCanvas.getContext("2d"),this.mouseoveredObjectMaps=[]}function wt(g,x){x=x||{},this.optionsName="navigator",wt.base.constructor.call(this,"Navigator","navigator",x,null,g),this.parent=this.stockChart=g}function It(g,x){this.panel=Q("canvasjs-slider-panel"),this.parent=this.navigator=g,this.stockChart=g.stockChart,this.navigator.panel.appendChild(this.panel),It.base.constructor.call(this,"Slider","slider",x,null,g),this.options=Et(x.navigator)||Et(x.navigator.slider)?{}:x.navigator.slider,this.optionsName="slider",this.panMode=!1,this.sessionVariables={}}function Gt(g,x){Gt.base.constructor.call(this,"RangeSelector","rangeSelector",x,null,g),this.parent=this.stockChart=g,this.options=Et(x)||Et(x.rangeSelector)?{}:x.rangeSelector,this.optionsName="rangeSelector",this.ctx=g.ctx}function re(g,x,w){re.base.constructor.call(this,"RangeButton","rangeButton",w,x,g.rangeSelector),this.stockChart=g,this.parent=this.rangeSelector=g.rangeSelector,this.options=Et(w)?{}:w,this.optionsName="rangeButton",this.enabled=!1,this.state="off"}function te(g,x){te.base.constructor.call(this,"InputFields","inputFields",x,null,g.rangeSelector),this.stockChart=g,this.options=Et(x)||Et(x.inputFields)?{}:x.inputFields,this.parent=this.rangeSelector=g.rangeSelector,this.elements=[],this._textBlocks=[],this.optionsName="inputFields",this.elements.push(xt("input","canvasjs-input-field","text")),this.elements.push(xt("input","canvasjs-input-field","text"));for(var w=0;w<this.elements.length;w++)this.stockChart._canvasJSContainer.appendChild(this.elements[w]);var D=this,o=null,y=null;Li(this.elements[0],"focus",function(){D.enabled&&(D.elements[0].focused=!0,D._textBlocks[0].borderColor=D.style.borderColorOnFocus,D._textBlocks[0].render(!0))},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[0],"focusout",function(){var f;D.enabled&&(D.elements[0].focused=!1,D.stockChart.charts&&D.stockChart.charts.length&&(f=D.stockChart.charts[0].axisX&&D.stockChart.charts[0].axisX.length?D.stockChart.charts[0].axisX[0]:D.stockChart.charts[0].axisX2[0]),this.value="dateTime"===D.valueType?Es(f?f.viewportMinimum:null,"YYYY-MM-DD",D.stockChart._cultureInfo):Gn(f?f.viewportMinimum:null,D.valueFormatString,D.stockChart._cultureInfo),this.style.display="none",D._textBlocks[0].borderColor=D.style.borderColor,D._textBlocks[0].render(!0))},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[1],"focus",function(){D.enabled&&(D.elements[1].focused=!0,D._textBlocks[1].borderColor=D.style.borderColorOnFocus,D._textBlocks[1].render(!0))},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[1],"focusout",function(){var f;D.enabled&&(D.elements[1].focused=!1,D.stockChart.charts&&D.stockChart.charts.length&&(f=D.stockChart.charts[0].axisX&&D.stockChart.charts[0].axisX.length?D.stockChart.charts[0].axisX[0]:D.stockChart.charts[0].axisX2[0]),this.value="dateTime"===D.valueType?Es(f?f.viewportMaximum:null,"YYYY-MM-DD",D.stockChart._cultureInfo):Gn(f?f.viewportMaximum:null,D.valueFormatString,D.stockChart._cultureInfo),this.style.display="none",D._textBlocks[1].borderColor=D.style.borderColor,D._textBlocks[1].render(!0))},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[0],"change",function(f){var c,d;D.enabled&&(D.stockChart.charts&&D.stockChart.charts.length&&(D.stockChart.navigator&&D.stockChart.navigator.enabled&&(d=D.stockChart.navigator&&D.stockChart.navigator.chart&&D.stockChart.navigator.chart.axisX?D.stockChart.navigator.chart.axisX[0]:D.stockChart.navigator.chart.axisX2[0]),c=D.stockChart.charts[0].axisX&&D.stockChart.charts[0].axisX.length?D.stockChart.charts[0].axisX[0]:D.stockChart.charts[0].axisX2[0]),f="dateTime"===D.valueType?isNaN(new Date(this.value.replace(/-/g,"/")).getTime())?null:new Date(this.value.replace(/-/g,"/")).getTime():this.value,o=Et(d)?!Et(f)&&f<(Et(c)?null:c.maximum)?Math.max(Et(c)?null:c.minimum,f):Et(c)?null:c.minimum:!Et(f)&&f<(Et(d)?null:d.maximum)?Math.max(Et(d)?null:d.minimum,f):Et(d)?null:d.minimum,y=Et(c)?null:c.viewportMaximum,D.stockChart._rangeEventParameter={stockChart:D.stockChart,source:"inputFields",index:null,minimum:o,maximum:y},D.stockChart._rangeEventParameter.type="rangeChanging",D.stockChart.dispatchEvent("rangeChanging",D.stockChart._rangeEventParameter,D.stockChart),D.stockChart.sessionVariables._axisXMin=o,D.stockChart.sessionVariables._axisXMax=y,D.stockChart._syncCharts(o,y),D.stockChart._rangeEventParameter.type="rangeChanged",D.stockChart.dispatchEvent("rangeChanged",D.stockChart._rangeEventParameter,D.stockChart),D.stockChart.rangeSelector&&D.stockChart.rangeSelector.resetRangeButtons())},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[1],"change",function(f){var c,d;D.enabled&&(D.stockChart.charts&&D.stockChart.charts.length&&(D.stockChart.navigator&&D.stockChart.navigator.enabled&&(d=D.stockChart.navigator&&D.stockChart.navigator.chart&&D.stockChart.navigator.chart.axisX?D.stockChart.navigator.chart.axisX[0]:D.stockChart.navigator.chart.axisX2[0]),c=D.stockChart.charts[0].axisX&&D.stockChart.charts[0].axisX.length?D.stockChart.charts[0].axisX[0]:D.stockChart.charts[0].axisX2[0]),f="dateTime"===D.valueType?isNaN(new Date(this.value.replace(/-/g,"/")).getTime())?null:new Date(this.value.replace(/-/g,"/")).getTime():this.value,o=c?c.viewportMinimum:null,y=Et(d)?!Et(f)&&f>(c?c.minimum:null)?Math.min(c?c.maximum:null,f):c?c.maximum:null:!Et(f)&&f>(d?d.minimum:null)?Math.min(d?d.maximum:null,f):d?d.maximum:null,D.stockChart._rangeEventParameter={stockChart:D.stockChart,source:"inputFields",index:null,minimum:o,maximum:y},D.stockChart._rangeEventParameter.type="rangeChanging",D.stockChart.dispatchEvent("rangeChanging",D.stockChart._rangeEventParameter,D.stockChart),D.stockChart.sessionVariables._axisXMin=o,D.stockChart.sessionVariables._axisXMax=y,D.stockChart._syncCharts(o,y),D.stockChart._rangeEventParameter.type="rangeChanged",D.stockChart.dispatchEvent("rangeChanged",D.stockChart._rangeEventParameter,D.stockChart),D.stockChart.rangeSelector&&D.stockChart.rangeSelector.resetRangeButtons())},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[0],"keydown",function(f){if(D.enabled&&13===f.keyCode){var c="dateTime"===D.valueType?Es(D.startValue,"YYYY-MM-DD"):Gn(D.startValue,D.valueFormatString);this.value!=c&&en(this,"change"),this.blur(),f.preventDefault&&f.preventDefault()}},this.rangeSelector.stockChart.allDOMEventHandlers),Li(this.elements[1],"keydown",function(f){if(D.enabled&&13===f.keyCode){var c="dateTime"===D.valueType?Es(D.endValue,"YYYY-MM-DD"):Gn(D.endValue,D.valueFormatString);this.value!=c&&en(this,"change"),this.blur(),f.preventDefault&&f.preventDefault()}},this.rangeSelector.stockChart.allDOMEventHandlers)}function ie(g,x){ie.base.constructor.call(this,"ButtonStyle","buttonStyle",x,null,g.rangeSelector),this.stockChart=g,this.parent=this.rangeSelector=g.rangeSelector,this.options=Et(x)||Et(x.buttonStyle)?{}:x.buttonStyle,this.optionsName="buttonStyle"}function u(g,x){u.base.constructor.call(this,"Style","style",x,null,g.rangeSelector.inputFields),this.stockChart=g,this.parent=this.inputFields=g.rangeSelector.inputFields,this.options=Et(x)||Et(x.style)?{}:x.style,this.optionsName="style"}var I=!0;return On(Pt,fn),Pt.prototype._updateOptions=function(){this.updateOption("width"),this.updateOption("height"),this.updateOption("theme"),this.updateOption("colorSet")&&(this.selectedColorSet=typeof We[this.colorSet]<"u"?We[this.colorSet]:We.colorSet1),this.updateOption("backgroundColor"),this.backgroundColor||(this.backgroundColor="rgba(0,0,0,0)"),this.updateOption("exportEnabled"),this.updateOption("exportFileName"),this.updateOption("creditHref"),this.updateOption("creditHref"),this.updateOption("culture"),this._cultureInfo=new Ls(this.options.culture),this.updateOption("animationEnabled"),this.updateOption("animationDuration"),this.updateOption("rangeChanging"),this.updateOption("rangeChanged"),this.toolbar=new ao(this,this.options.toolbar),ro(this)},Pt._supportedChartTypes=fo("line stepLine spline column area stepArea splineArea bubble scatter stackedColumn stackedColumn100 stackedArea stackedArea100 candlestick ohlc boxAndWhisker rangeColumn error rangeArea rangeSplineArea waterfall".split(" ")),Pt.prototype._initialize=function(){var g;this._updateOptions(),this.animationEnabled=this.animationEnabled&&rt,this._updateSize(),this.clearCanvas(),this.ctx.beginPath(),fo(x=Et(this.options.charts)?[]:this.options.charts);for(var w=0;w<this.charts.length;w++)0>x.indexOf((g=this.charts[w]).options)&&(this.charts.splice(w,1),g.destroy(),this._canvasJSContainer.removeChild(g.panel),w--);if(this.layoutManager=new ln(0,0,this.width,this.height,2),this.plotArea.layoutManager&&this.plotArea.layoutManager.reset(),this.title=null,this.subtitles=[],this.options.title&&(this.title=new yt(this,this.options.title),this.title.setLayout()),this.options.subtitles)for(w=0;w<this.options.subtitles.length;w++)g=new ct(this,this.options.subtitles[w],w),this.subtitles.push(g),g.setLayout();if(this.navigator=this.navigator||new wt(this,this.options.navigator),this.navigator._initialize(),this.navigator.enabled){for(g={theme:this.options.navigator&&this.options.navigator.theme?this.options.navigator.theme:this.theme,animationEnabled:this.options.navigator&&!Et(this.options.navigator.animationEnabled)?this.options.navigator.animationEnabled:this.animationEnabled,animationDuration:this.options.navigator&&this.options.navigator.animationDuration?this.options.navigator.animationDuration:this.animationDuration,culture:this.options.navigator&&this.options.navigator.culture?this.options.navigator.culture:this.culture,zoomEnabled:!1,data:this.options.navigator&&this.options.navigator.data?this.options.navigator.data:this.options.charts&&this.options.charts[0]&&this.options.charts[0].data?Ri(this.options.charts[0].data):[],axisX:this.options.navigator&&this.options.navigator.axisX?this.options.navigator.axisX:{},axisY:this.options.navigator&&this.options.navigator.axisY?this.options.navigator.axisY:{},axisX2:this.options.navigator&&this.options.navigator.axisX2?this.options.navigator.axisX2:{},axisY2:this.options.navigator&&this.options.navigator.axisY2?this.options.navigator.axisY2:{},interactivityEnabled:!1,exportEnabled:!1},w=0;w<g.data.length;w++)!Et(this.navigator.options.data)||!Et(g.data[w].type)&&(Et(g.data[w].type)||0<=g.data[w].type.indexOf("range")||0<=g.data[w].type.indexOf("ohlc")||0<=g.data[w].type.indexOf("candlestick")||0<=g.data[w].type.indexOf("error"))?this.navigator.options.data&&Et(this.navigator.options.data[w].type)&&(g.data[w].type="splineArea"):g.data[w].type="splineArea";if(g.axisX.length)for(w=0;w<g.axisX.length;w++)g.axisX[w].titleFontSize=Et(g.axisX[w].titleFontSize)?1:g.axisX[w].titleFontSize,g.axisX[w].labelFontSize=Et(g.axisX[w].labelFontSize)?12:g.axisX[w].labelFontSize,g.axisX[w].labelAngle=Et(g.axisX[w].labelAngle)?0:g.axisX[w].labelAngle,g.axisX[w].labelPlacement=Et(g.axisX[w].labelPlacement)?"inside":g.axisX[w].labelPlacement,g.axisX[w].tickLength=Et(g.axisX[w].tickLength)?0:g.axisX[w].tickLength,g.axisX[w].lineThickness=Et(g.axisX[w].lineThickness)?0:g.axisX[w].lineThickness,g.axisX[w].tickThickness=Et(g.axisX[w].tickThickness)?0:g.axisX[w].tickThickness,g.axisX[w].gridThickness=Et(g.axisX[w].gridThickness)?1:g.axisX[w].gridThickness;else g.axisX.titleFontSize=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.titleFontSize)?this.options.navigator.axisX.titleFontSize:rt?0:1,g.axisX.labelFontSize=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.labelFontSize)?this.options.navigator.axisX.labelFontSize:12,g.axisX.labelAngle=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.labelAngle)?this.options.navigator.axisX.labelAngle:0,g.axisX.labelPlacement=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.labelPlacement)?this.options.navigator.axisX.labelPlacement:"inside",g.axisX.tickLength=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.tickLength)?this.options.navigator.axisX.tickLength:0,g.axisX.lineThickness=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.lineThickness)?this.options.navigator.axisX.lineThickness:0,g.axisX.tickThickness=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.tickThickness)?this.options.navigator.axisX.tickThickness:0,g.axisX.gridThickness=this.options.navigator&&this.options.navigator.axisX&&!Et(this.options.navigator.axisX.gridThickness)?this.options.navigator.axisX.gridThickness:1;if(g.axisY.length)for(w=0;w<g.axisY.length;w++)g.axisY[w].titleFontSize=g.axisY[w].titleFontSize?g.axisY[w].titleFontSize:rt?0:1,g.axisY[w].labelFontSize=g.axisY[w].labelFontSize?g.axisY[w].labelFontSize:rt?0:1,g.axisY[w].labelPlacement=g.axisY[w].labelPlacement?g.axisY[w].labelPlacement:"inside",g.axisY[w].includeZero=!1,g.axisY[w].lineThickness=0,g.axisY[w].tickThickness=0,g.axisY[w].tickLength=0,g.axisY[w].gridThickness=0;else g.axisY.titleFontSize=this.options.navigator&&this.options.navigator.axisY&&this.options.navigator.axisY.titleFontSize?this.options.navigator.axisY.titleFontSize:rt?0:1,g.axisY.labelFontSize=this.options.navigator&&this.options.navigator.axisY&&this.options.navigator.axisY.labelFontSize?this.options.navigator.axisY.labelFontSize:rt?0:1,g.axisY.labelPlacement=this.options.navigator&&this.options.navigator.axisY&&this.options.navigator.axisY.labelPlacement?this.options.navigator.axisY.labelPlacement:"inside",g.axisY.includeZero=!1,g.axisY.lineThickness=0,g.axisY.tickThickness=0,g.axisY.tickLength=0,g.axisY.gridThickness=0;if(g.axisX2.length)for(w=0;w<g.axisX2.length;w++)g.axisX2[w].titleFontSize=g.axisX2[w].titleFontSize?g.axisX2[w].titleFontSize:rt?0:1,g.axisX2[w].labelFontSize=g.axisX2[w].labelFontSize?g.axisX2[w].labelFontSize:12,g.axisX2[w].labelAngle=Et(g.axisX2[w].labelAngle)?0:g.axisX2[w].labelAngle,g.axisX2[w].labelPlacement=g.axisX2[w].labelPlacement?g.axisX2[w].labelPlacement:"inside",g.axisX2[w].tickLength=Et(g.axisX2[w].tickLength)?0:g.axisX2[w].tickLength,g.axisX2[w].lineThickness=g.axisX2[w].lineThickness?g.axisX2[w].lineThickness:0,g.axisX2[w].tickThickness=g.axisX2[w].tickThickness?g.axisX2[w].tickThickness:1,g.axisX2[w].gridThickness=Et(g.axisX2[w].gridThickness)?1:g.axisX2[w].gridThickness;else g.axisX2.titleFontSize=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.titleFontSize?this.options.navigator.axisX2.titleFontSize:rt?0:1,g.axisX2.labelFontSize=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.labelFontSize?this.options.navigator.axisX2.labelFontSize:12,g.axisX2.labelAngle=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.labelAngle?this.options.navigator.axisX2.labelAngle:0,g.axisX2.labelPlacement=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.labelPlacement?this.options.navigator.axisX2.labelPlacement:"inside",g.axisX2.tickLength=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.tickLength?this.options.navigator.axisX2.tickLength:0,g.axisX2.lineThickness=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.lineThickness?this.options.navigator.axisX2.lineThickness:0,g.axisX2.tickThickness=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.tickThickness?this.options.navigator.axisX2.tickThickness:1,g.axisX2.gridThickness=this.options.navigator&&this.options.navigator.axisX2&&this.options.navigator.axisX2.gridThickness?this.options.navigator.axisX2.gridThickness:1;if(g.axisY2.length)for(w=0;w<g.axisY2.length;w++)g.axisY2[w].titleFontSize=g.axisY2[w].titleFontSize?g.axisY2[w].titleFontSize:rt?0:1,g.axisY2[w].labelFontSize=g.axisY2[w].labelFontSize?g.axisY2[w].labelFontSize:rt?0:1,g.axisY2[w].labelPlacement=g.axisY2[w].labelPlacement?g.axisY2[w].labelPlacement:"inside",g.axisY2[w].includeZero=!1,g.axisY2[w].lineThickness=0,g.axisY2[w].margin=0,g.axisY2[w].tickLength=0,g.axisY2[w].tickThickness=0,g.axisY2[w].gridThickness=0;else g.axisY2.titleFontSize=this.options.navigator&&this.options.navigator.axisY2&&this.options.navigator.axisY2.titleFontSize?this.options.navigator.axisY2.titleFontSize:rt?0:1,g.axisY2.labelFontSize=this.options.navigator&&this.options.navigator.axisY2&&this.options.navigator.axisY2.labelFontSize?this.options.navigator.axisY2.labelFontSize:rt?0:1,g.axisY2.labelPlacement=this.options.navigator&&this.options.navigator.axisY2&&this.options.navigator.axisY2.labelPlacement?this.options.navigator.axisY2.labelPlacement:"inside",g.axisY2.includeZero=!1,g.axisY2.lineThickness=0,g.axisY2.margin=0,g.axisY2.tickLength=0,g.axisY2.tickThickness=0,g.axisY2.gridThickness=0;for(g.backgroundColor=this.navigator.backgroundColor,w=0;w<g.data.length;w++)g.data[w].markerSize=g.data[w].markerSize?g.data[w].markerSize:0;if(!this.navigator.chart){var D=Q("canvasjs-chart-panel");this.navigator.panel.appendChild(D),D.style.height=this.navigator.height+"px",D.style.width=this.navigator.width+"px"}this.navigator.chart&&(this.navigator.chart.panel.style.width=this.navigator.width+"px"),this.navigator.chart=this.navigator.chart||new ri(D,g,{parent:this.navigator,isOptionsInArray:!1,index:null,predefinedThemes:mi,optionsName:"navigator",stockChart:this}),this.navigator.chart._initialize(),this.navigator.chart.setLayout(),this.navigator.chart.selectedColorSet=this.selectedColorSet,this.navigator._chartOptions=g,this.navigator.slider=this.navigator.slider||new It(this.navigator,this.options),this.navigator.slider._initialize()}if(this.rangeSelector=this.rangeSelector||new Gt(this,this.options),this.rangeSelector.buttonStyle=this.rangeSelector.buttonStyle||new ie(this,this.rangeSelector.options),this.rangeSelector.inputFields=this.rangeSelector.inputFields||new te(this,this.rangeSelector.options),this.rangeSelector.inputFields.style=new u(this,this.rangeSelector.inputFields.options),this.rangeSelector.inputFields.style._updateOptions(),this.rangeSelector.inputFields._initialize(),this.rangeSelector.inputFields&&this.rangeSelector.inputFields.enabled)for(this.rangeSelector.inputFields._textBlocks=[],this.rangeSelector.inputFields._labels=[],this.rangeSelector.inputFieldsWidth=0,D=this.rangeSelector.inputFields.style.maxWidth=this.rangeSelector.inputFields.style.options.maxWidth?this.rangeSelector.inputFields.style.options.maxWidth:this.rangeSelector.stockChart.width/2,w=0;w<this.rangeSelector.inputFields.elements.length;w++){var x=(g=new En(this.rangeSelector.ctx,{x:0,y:0,backgroundColor:this.rangeSelector.inputFields.style.backgroundColor,borderColor:this.rangeSelector.inputFields.style.borderColor,borderThickness:this.rangeSelector.inputFields.style.borderThickness,cornerRadius:0,maxWidth:Et(this.rangeSelector.inputFields.style.options.width)?D:this.rangeSelector.inputFields.style.width,maxHeight:2*this.rangeSelector.inputFields.style.fontSize,angle:0,padding:this.rangeSelector.inputFields.style.padding,text:this.rangeSelector.inputFields.valueFormatString,horizontalAlign:"center",textAlign:"center",fontSize:this.rangeSelector.inputFields.style.fontSize,fontFamily:this.rangeSelector.inputFields.style.fontFamily,fontWeight:this.rangeSelector.inputFields.style.fontWeight,fontColor:this.rangeSelector.inputFields.style.fontColor,fontStyle:this.rangeSelector.inputFields.style.fontStyle,textBaseline:"middle"})).measureText(),o=new En(this.rangeSelector.ctx,{x:0,y:0,backgroundColor:rt?"transparent":null,borderColor:this.rangeSelector.inputFields.style.borderColor,borderThickness:0,cornerRadius:0,maxWidth:this.rangeSelector.inputFields.style.maxWidth,maxHeight:2*this.rangeSelector.inputFields.style.fontSize,angle:0,padding:this.rangeSelector.inputFields.style.padding,text:"From",horizontalAlign:"left",fontSize:this.rangeSelector.inputFields.style.fontSize,fontFamily:this.rangeSelector.inputFields.style.fontFamily,fontWeight:this.rangeSelector.inputFields.style.fontWeight,fontColor:this.rangeSelector.inputFields.style.fontColor,fontStyle:this.rangeSelector.inputFields.style.fontStyle,textBaseline:"middle"});this.rangeSelector.inputFields._textBlocks.push(g),this.rangeSelector.inputFields._labels.push(o),this.rangeSelector.inputFields._textBlocks[w].bounds={x1:null,x2:null,y1:null,y2:null,width:null,height:null},this.rangeSelector.inputFields._labels[w].bounds={x1:null,x2:null,y1:null,y2:null,width:null,height:null},this.rangeSelector.inputFieldsWidth+=x.width+this.rangeSelector.inputFields.style.spacing+o.measureText().width,this.rangeSelector.inputFieldsHeight=this.rangeSelector.inputFieldsHeight<x.height?x.height:this.rangeSelector.inputFieldsHeight,(g=this.rangeSelector.inputFields._textBlocks[w]).id=++this.rangeSelector.stockChart._eventManager.lastObjectId,this.rangeSelector.stockChart._eventManager.objectMap[g.id]={id:g.id,objectType:"inputFields",inputFieldIndex:w}}this.rangeSelector.buttonStyle._updateOptions(),this.rangeSelector._initialize(),this._objectsInitialized=!0},Pt.prototype.render=function(g){var w,M,x=this;if(g&&(this.options=g),this._initialize(),this.title&&this.title.render(),this.subtitles)for(g=0;g<this.subtitles.length;g++)this.subtitles[g].render();if(this.options.charts){w=Array(this.options.charts.length);var D=(o=this.layoutManager.getFreeSpace()).height,o=o.height,f=this.options.charts.length;for(g=0;g<this.options.charts.length;g++)!Et(this.options.charts[g].height)&&parseFloat(this.options.charts[g].height)&&(w[g]=0<=this.options.charts[g].height.toString().indexOf("%")?Us(this.options.charts[g].height,D,Math.floor(o/f),this.height,0):this.options.charts[g].height,o-=w[g],f--);for(o=Math.floor(o/f),g=0;g<this.options.charts.length;g++)Et(w[g])&&(w[g]=o);f=this.options.charts;var y,c=this.charts;for(this.charts=[],g=0;g<f.length;g++){for(o=this.layoutManager.getFreeSpace(),(D=f[g]).theme=f[g].theme?f[g].theme:this.options.theme?this.options.theme:this.theme,D.animationEnabled=Et(f[g].animationEnabled)?this.animationEnabled:f[g].animationEnabled,D.animationDuration=f[g].animationDuration?f[g].animationDuration:this.animationDuration,D.culture=f[g].culture?f[g].culture:this.culture,D.height=f[g].height?w[g]:null,Et(f.backgroundColor)?Et(this.options.backgroundColor)||(D.backgroundColor=this.backgroundColor):D.backgroundColor=this.options.charts[g].backgroundColor,y=c.length;0<y--&&c[y].options!==D;);0<=y?(this.charts[g]=c[y],this.charts[g].options=D):((y=Q("canvasjs-chart-panel")).style.height=w[g]+"px",this._canvasJSContainer.appendChild(y),this.charts[g]=new ri(y,D,{parent:this,isOptionsInArray:!0,index:g,predefinedThemes:mi,optionsName:"charts",stockChart:this})),this.charts[g].panel.style.width=o.width+"px",this.charts[g].panel.style.top=o.y1+"px",this.charts[g].panel.style.left=o.x1+"px",this.charts[g].panel.style.height=w[g]+"px",this.charts[g].height=D.height?D.height:w[g],this.layoutManager.registerSpace("top",{width:o.width,height:w[g]})}for(c=null,g=0;g<this.charts.length;g++)if(!Et(this.options.charts[g].data))for(y=0;y<this.options.charts[g].data.length;y++)0<=Pt._supportedChartTypes.indexOf((w=this.options.charts[g].data[y]).type)||Et(w.type)||(I=!1,window.console&&window.console.log("CanvasJS Error: "+w.type+" Chart is not Supported in StockChart"));if(!I)return;for(this.setChartsLayout(),g=w=0;g<this.charts.length;g++)if(Et(this.charts[g].options.colorSet)){for(this.charts[g].selectedColorSet=[],y=w;y<w+this.charts[g].data.length;y++)this.charts[g].selectedColorSet.push(this.selectedColorSet[y%this.selectedColorSet.length]);w+=this.charts[g].data.length}if(this.navigator&&this.navigator.enabled)if(this.navigator.options.data){for(this.navigator.chart.selectedColorSet=[],y=w;y<w+this.navigator.chart.data.length;y++)this.navigator.chart.selectedColorSet.push(this.selectedColorSet[y%this.selectedColorSet.length]);w+=this.navigator.chart.data.length}else this.navigator.chart.selectedColorSet=this.charts[0].selectedColorSet}if(this.navigator&&this.navigator.enabled){for(g=0;g<this.navigator.chart.data.length;g++)0<=Pt._supportedChartTypes.indexOf(this.navigator.chart.data[g].type)||(I=!1,window.console&&window.console.log("CanvasJS Error: "+this.navigator.chart.data[g].type+" Chart is not Supported in Navigator"));if(I){var d=this.navigator.chart.axisX&&this.navigator.chart.axisX.length?this.navigator.chart.axisX[0]:this.navigator.chart.axisX2[0];d.bounds.x1>this._chartsPlotAreaX1&&(this._chartsPlotAreaX1=d.bounds.x1),this.navigator.width=this.navigator.chart.width=this.navigator.slider.fullWidth=this.navigator.options.width?this.navigator.options.width:this._chartsPlotAreaX2-this._chartsPlotAreaX1+d.bounds.x1,this.navigator.panel.style.left=this._chartsPlotAreaX1+this.layoutManager.getFreeSpace().x1-d.bounds.x1+"px",this.navigator.panel.style.width=this.navigator.chart.panel.style.width=this.navigator.options.width?this.navigator.options.width:this._chartsPlotAreaX2-this._chartsPlotAreaX1+d.bounds.x1+"px",this.navigator.chart.render(this.navigator._chartOptions),this.navigator.backgroundColor=this.navigator.chart.backgroundColor,this.navigator.animationEnabled=this.navigator.chart.animationEnabled,this.navigator.animationDuration=this.navigator.chart.animationDuration,this.navigator.theme=this.navigator.chart.theme,this.navigator.axisX=this.navigator.chart.axisX,this.navigator.axisX2=this.navigator.chart.axisX2,this.navigator.axisY=this.navigator.chart.axisY,this.navigator.axisY2=this.navigator.chart.axisY2,this.navigator.data=this.navigator.chart.data}}for(o=w=null,y=0,f=D=null,g=0;g<this.charts.length;g++)for(c=this.charts[g].axisX&&this.charts[g].axisX.length?this.charts[g].axisX:this.charts[g].axisX2,w=w||(c&&0<c.length?c[0].minimum:null),o=o||(c&&0<c.length?c[0].maximum:null),y=0;y<c.length;y++)(d=c[y]).minimum<w&&(w=d.minimum),d.maximum>o&&(o=d.maximum);if(this.navigator&&this.navigator.chart&&I&&(M=this.navigator.chart.axisX&&0<this.navigator.chart.axisX.length?this.navigator.chart.axisX[0]:this.navigator.chart.axisX2[0],this._axisXMin=this.navigator.slider.minimum=Et(this.navigator.options.slider)||Et(this.navigator.options.slider.minimum)?null:Math.max(M.minimum,this.navigator.slider.minimum),this._axisXMax=this.navigator.slider.maximum=Et(this.navigator.options.slider)||Et(this.navigator.options.slider.maximum)?null:Math.min(M.maximum,this.navigator.slider.maximum)),this.rangeSelector&&this.rangeSelector.enabled){for(y=M?M.maximum-M.minimum:o-w,this.charts&&this.charts.length&&(d=this.charts[0].axisX&&this.charts[0].axisX.length?this.charts[0].axisX[0]:this.charts[0].axisX2[0]),g=0;g<this.rangeSelector.buttons.length;g++){var k=null;"year"===(c=this.rangeSelector.buttons[g]).rangeType?k=31104e6*c.range:"ytd"===c.rangeType?k="ytd":"month"===c.rangeType?k=2592e6*c.range:"week"===c.rangeType?k=6048e5*c.range:"day"===c.rangeType?k=864e5*c.range:"hour"===c.rangeType?k=36e5*c.range:"minute"===c.rangeType?k=6e4*c.range:"second"===c.rangeType?k=1e3*c.range:"millisecond"===c.rangeType?k=c.range:"all"===c.rangeType?k=null:"number"===c.rangeType&&(k=c.range),("ytd"===c.rangeType||k<y)&&(c.enabled=!0),c.enabled?(c.cursor=this.rangeSelector.buttonStyle.cursor,"on"===c.state&&(Et(this._axisXMin)&&Et(this._axisXMax)&&(c.textBlock.fontWeight="bold",c.textBlock.fontColor=this.rangeSelector.buttonStyle.labelFontColorOnHover,c.textBlock.backgroundColor=this.rangeSelector.buttonStyle.backgroundColorOnSelect),"ytd"===c.rangeType&&d?((D=new Date(d.viewportMaximum)).setDate(1),D.setMonth(0),D=D.getTime()):Et(k)?M?(D=M.minimum,f=M.maximum):d&&(D=d.minimum,f=d.maximum):d.viewportMaximum-k<(M?M.minimum:d.minimum)?(f=M.minimum-(d.viewportMaximum-k),D=M.minimum,f=Math.min(M.maximum,d.viewportMaximum+f)):(D=d.viewportMaximum-k,f=d.viewportMaximum)),Et(this._axisXMin)&&Et(this._axisXMax)||(c.state="off"),this._axisXMin=Et(this._axisXMin)?D:this._axisXMin,this._axisXMax=Et(this._axisXMax)?f:this._axisXMax):c.cursor="not-allowed",c.mousemove=function(R){this.enabled&&"off"===this.state&&(this.textBlock.backgroundColor=R.stockChart.rangeSelector.buttonStyle.backgroundColorOnHover,this.textBlock.fontColor=R.stockChart.rangeSelector.buttonStyle.labelFontColorOnHover,this.textBlock.render(!0))},c.mouseover=function(R){this.enabled&&"off"===this.state&&(this.textBlock.backgroundColor=R.stockChart.rangeSelector.buttonStyle.backgroundColorOnHover,this.textBlock.fontColor=R.stockChart.rangeSelector.buttonStyle.labelFontColorOnHover,this.textBlock.render(!0))},c.mouseout=function(R){this.enabled&&"off"===this.state&&(this.textBlock.backgroundColor=R.stockChart.rangeSelector.buttonStyle.backgroundColor,this.textBlock.fontColor=R.stockChart.rangeSelector.buttonStyle.labelFontColor,this.textBlock.render(!0))},c.click=function(R){if(this.enabled){for(var B=0,O=null,L=null,X=0;X<x.rangeSelector.buttons.length;X++)x.rangeSelector.buttons[X]!=this&&(x.rangeSelector.buttons[X].state="off"),x.rangeSelector.buttons[X].textBlock.fontWeight=x.rangeSelector.buttonStyle.labelFontWeight,x.rangeSelector.buttons[X].textBlock.fontColor=R.stockChart.rangeSelector.buttonStyle.labelFontColor,x.rangeSelector.buttons[X].textBlock.backgroundColor=R.stockChart.rangeSelector.buttonStyle.backgroundColor,x.rangeSelector.buttons[X].textBlock.render(!0);var E,Y;x.charts&&x.charts.length&&(E=x.charts[0].axisX&&x.charts[0].axisX.length?x.charts[0].axisX[0]:x.charts[0].axisX2[0]),x.navigator&&x.navigator.chart&&(Y=x.navigator.chart.axisX?x.navigator.chart.axisX[0]:x.navigator.chart.axisX2[0]),"year"===this.rangeType?B=31104e6*this.range:"month"===this.rangeType?B=2592e6*this.range:"week"===this.rangeType?B=6048e5*this.range:"day"===this.rangeType?B=864e5*this.range:"hour"===this.rangeType?B=36e5*this.range:"minute"===this.rangeType?B=6e4*this.range:"second"===this.rangeType?B=1e3*this.range:"millisecond"===this.rangeType?B=this.range:"all"===this.rangeType?B=null:"number"===this.rangeType&&(B=this.range),"ytd"===this.rangeType&&E?((O=new Date(E.viewportMaximum)).setDate(1),O.setMonth(0),B=O.getTime(),O=Math.max(B,Y?Y.minimum:E.minimum),L=E.viewportMaximum):Et(B)?Y?(O=Y.minimum,L=Y.maximum):E&&(O=E.minimum,L=E.maximum):Y&&E.viewportMaximum-B<(Y?Y.minimum:E.minimum)?(Y=x.navigator.chart.axisX[0].minimum-(E.viewportMaximum-B),O=x.navigator.chart.axisX[0].minimum,L=Math.min(x.navigator.chart.axisX[0].maximum,E.viewportMaximum+Y)):(O=E.viewportMaximum-B,L=E.viewportMaximum),x._rangeEventParameter={stockChart:x,source:"buttons",index:this._index,minimum:O,maximum:L},"on"!=this.state&&(x._rangeEventParameter.type="rangeChanging",x.dispatchEvent("rangeChanging",x._rangeEventParameter,x),x._syncCharts(O,L),x.sessionVariables._axisXMin=O,x.sessionVariables._axisXMax=L,x._rangeEventParameter.type="rangeChanged",x.dispatchEvent("rangeChanged",x._rangeEventParameter,x),this.state="on"),this.textBlock.fontWeight="bold",this.textBlock.fontColor=R.stockChart.rangeSelector.buttonStyle.labelFontColorOnHover,this.textBlock.backgroundColor=R.stockChart.rangeSelector.buttonStyle.backgroundColorOnSelect,this.textBlock.render(!0)}}}if(this.rangeSelector.inputFields&&this.rangeSelector.inputFields.enabled){for(this.rangeSelector.inputFields.valueType=this.options.rangeSelector&&this.options.rangeSelector.inputFields&&this.options.rangeSelector.inputFields.valueType?this.options.rangeSelector.inputFields.valueType:this.isDateTime?"dateTime":"number",g=0;g<this.rangeSelector.inputFields._textBlocks.length;g++)(d=this.rangeSelector.inputFields._textBlocks[g]).mousemove=function(C){x.rangeSelector&&x.rangeSelector.inputFields&&!x.rangeSelector.inputFields.enabled||(C.inputField.cursor=C.stockChart.rangeSelector.inputFields.style.cursor)},d.mouseover=function(C){x.rangeSelector&&x.rangeSelector.inputFields&&!x.rangeSelector.inputFields.enabled||(C.inputField.cursor=C.stockChart.rangeSelector.inputFields.style.cursor)},d.mouseout=function(C){x.rangeSelector&&x.rangeSelector.inputFields&&!x.rangeSelector.inputFields.enabled||(C.inputField.cursor="auto")},d.click=function(C){x.rangeSelector&&x.rangeSelector.inputFields&&!x.rangeSelector.inputFields.enabled||(C.stockChart.rangeSelector.inputFields.elements[C.inputFieldIndex].style.display="inline",C.stockChart.rangeSelector.inputFields.elements[C.inputFieldIndex].focus())};if(isFinite(w)&&isFinite(o)){if("dateTime"===this.rangeSelector.inputFields.valueType?(this.rangeSelector.inputFields.valueFormatString=this.options.rangeSelector&&this.options.rangeSelector.inputFields&&this.options.rangeSelector.inputFields.valueFormatString?this.options.rangeSelector.inputFields.valueFormatString:"MMM DD YYYY",this.rangeSelector.inputFields.startValue=Et(this.rangeSelector.inputFields.options.startValue)?Et(D)?w:D:Es(this.rangeSelector.inputFields.options.startValue,this.rangeSelector.inputFields.valueFormatString),this.rangeSelector.inputFields.endValue=Et(this.rangeSelector.inputFields.options.endValue)?Et(f)?o:f:Es(this.rangeSelector.inputFields.options.endValue,this.rangeSelector.inputFields.valueFormatString)):(this.rangeSelector.inputFields.valueFormatString=this.options.rangeSelector&&this.options.rangeSelector.inputFields&&this.options.rangeSelector.inputFields.valueFormatString?this.options.rangeSelector.inputFields.valueFormatString:"#,##0.##",this.rangeSelector.inputFields.startValue=Et(this.rangeSelector.inputFields.options.startValue)?Et(D)?w:D:this.rangeSelector.inputFields.options.startValue,this.rangeSelector.inputFields.endValue=Et(this.rangeSelector.inputFields.options.endValue)?Et(f)?o:f:this.rangeSelector.inputFields.options.endValue),!(Et(this._axisXMin)&&Et(this._axisXMax)&&Et(this.rangeSelector.inputFields.options.startValue)&&Et(this.rangeSelector.inputFields.options.endValue)))for(y=0;y<this.rangeSelector.buttons.length;y++)c=this.rangeSelector.buttons[y];g=Es(this.rangeSelector.inputFields.startValue,"YYYY-MM-DD'T'HH:mm:ssZ"),d=Es(this.rangeSelector.inputFields.endValue,"YYYY-MM-DD'T'HH:mm:ssZ"),rt||(g=g.replace(/-/g,"/"),d=d.replace(/-/g,"/"),g=g.replace("T"," "),d=d.replace("T"," "),g=g.replace(/(\+[0-9]{2})(\:)([0-9]{2}$)/," UTC$1$3"),d=d.replace(/(\+[0-9]{2})(\:)([0-9]{2}$)/," UTC$1$3")),this._axisXMin=Et(this._axisXMin)?"dateTime"===this.rangeSelector.inputFields.valueType?new Date(g).getTime():this.rangeSelector.inputFields.startValue:this._axisXMin,this._axisXMax=Et(this._axisXMax)?"dateTime"===this.rangeSelector.inputFields.valueType?new Date(d).getTime():this.rangeSelector.inputFields.endValue:this._axisXMax}for(g=0;g<this.rangeSelector.inputFields.elements.length;g++)this.rangeSelector.inputFields.elements[g].title="dateTime"===this.rangeSelector.inputFields.valueType?"YYYY-MM-DD":this.rangeSelector.inputFields.valueFormatString}this.rangeSelector.render()}Et(this._axisXMin)&&(this._axisXMin=w),Et(this._axisXMax)&&(this._axisXMax=o),this._axisXMin=!Et(this.sessionVariables._axisXMin)&&this.navigator&&this.navigator.slider&&!this.navigator.slider.hasOptionChanged("minimum")?this.sessionVariables._axisXMin:this._axisXMin,this._axisXMax=!Et(this.sessionVariables._axisXMax)&&this.navigator&&this.navigator.slider&&!this.navigator.slider.hasOptionChanged("maximum")?this.sessionVariables._axisXMax:this._axisXMax,Et(M)||(this.navigator.slider.hasOptionChanged("minimum")&&(this._axisXMin=this.sessionVariables._axisXMin=this.navigator.slider.sessionVariables.minimum=this.navigator.slider.minimum=this.navigator.slider.options.minimum),this.navigator.slider.hasOptionChanged("maximum")&&(this._axisXMax=this.sessionVariables._axisXMax=this.navigator.slider.sessionVariables.maximum=this.navigator.slider.maximum=this.navigator.slider.options.maximum),(this._axisXMin<M.minimum||this._axisXMin>M.maximum)&&(this._axisXMin=M.minimum),(this._axisXMax<M.minimum||this._axisXMax>M.maximum)&&(this._axisXMax=M.maximum)),!Et(M)&&M.reversed?this._syncCharts(this._axisXMax,this._axisXMin):this._syncCharts(this._axisXMin,this._axisXMax)},Pt.prototype.setChartsLayout=function(){var g,x,w=0,D=this.width;this.isPlotAreaSet=this.isDateTime=!1;for(var o=0;o<this.charts.length;o++){if((g=this.charts[o])._initialize(),g.setLayout(),x={},(g.axisX[0]||g.axisX2[0])&&(g.axisY[0]||g.axisY2[0])){var y=g.axisX[0]?g.axisX[0].lineCoordinates:g.axisX2[0].lineCoordinates;if(g.axisY&&0<g.axisY.length&&g.axisY[0]){var f=g.axisY[0];x.x1=y.x1<y.x2?y.x1:f.lineCoordinates.x1,x.x2=y.x2>f.lineCoordinates.x2?y.x2:f.lineCoordinates.x2}g.axisY2&&0<g.axisY2.length&&g.axisY2[0]&&(f=g.axisY2[0],x.x1=y.x1<y.x2?y.x1:f.lineCoordinates.x1,x.x2=y.x2>f.lineCoordinates.x2?y.x2:f.lineCoordinates.x2)}for(y=0;y<g.data.length;y++)"dateTime"===g.data[y].xValueType&&(this.isDateTime=!0);w=Math.max(w,x.x1),D=Math.min(D,x.x2),g.sessionVariables.plotAreaBounds=x}this._chartsPlotAreaX1=w,this._chartsPlotAreaX2=D},Pt.prototype._updateSize=function(){return La.call(this,[this.canvas,this.overlaidCanvas])},Pt.prototype._syncCharts=function(g,x){for(var w=this,D=null,o=Math.min(g,x),y=Math.max(g,x),f=0;f<this.charts.length;f++){(D=this.charts[f]).toolTip&&D.toolTip.enabled&&D.toolTip.hide();for(var c=0;c<D.axisX.length;c++)D.axisX[c].setViewPortRange(g,x),D.axisX[c].options.labelAngle=Et(D.axisX[c].options.labelAngle)?0:D.axisX[c].options.labelAngle,this.charts[f].axisX[c].crosshair&&this.charts[f].axisX[c].crosshair.enabled&&(this.charts[f].axisX[c].crosshair.options.updated||(this.charts[f].axisX[c].crosshair.options.updated=function(d){for(var M=0;M<w.charts.length;M++)if(w.charts[M]!=d.chart)for(var k=0;k<w.charts[M].axisX.length;k++)w.charts[M].axisX[k].crosshair&&w.charts[M].axisX[k].crosshair.showAt(d.value)}),this.charts[f].axisX[c].crosshair.options.hidden||(this.charts[f].axisX[c].crosshair.options.hidden=function(d){for(var M=0;M<w.charts.length;M++)if(w.charts[M]!=d.chart)for(var k=0;k<w.charts[M].axisX.length;k++)w.charts[M].axisX[k].crosshair&&w.charts[M].axisX[k].crosshair.hide()}));for(c=0;c<D.axisX2.length;c++)D.axisX2[c].setViewPortRange(g,x),D.axisX2[c].options.labelAngle=Et(D.axisX2[c].options.labelAngle)?0:D.axisX2[c].options.labelAngle,this.charts[f].axisX2[c].crosshair&&this.charts[f].axisX2[c].crosshair.enabled&&(this.charts[f].axisX2[c].crosshair.options.updated||(this.charts[f].axisX2[c].crosshair.options.updated=function(d){for(var M=0;M<w.charts.length;M++)if(w.charts[M]!=d.chart)for(var k=0;k<w.charts[M].axisX2.length;k++)w.charts[M].axisX2[k].crosshair&&w.charts[M].axisX2[k].crosshair.showAt(d.value)}),this.charts[f].axisX2[c].crosshair.options.hidden||(this.charts[f].axisX2[c].crosshair.options.hidden=function(d){for(var M=0;M<w.charts.length;M++)if(w.charts[M]!=d.chart)for(var k=0;k<w.charts[M].axisX2.length;k++)w.charts[M].axisX2[k].crosshair&&w.charts[M].axisX2[k].crosshair.hide()}));D.options.toolbar?D.options.toolbar=D.options.toolbar:w.options.toolbar&&(D.options.toolbar=w.options.toolbar),D._initialize(),D.setLayout(),D.panEnabled=!(D.options.zoomEnabled&&D.zoomEnabled),D.renderElements(),(Et(this.charts[f].options.toolTip)||!Et(this.charts[f].options.toolTip)&&Et(this.charts[f].options.toolTip.updated))&&this.charts[f].toolTip&&(this.charts[f].toolTip.updated=function(d){for(var M=0;M<w.charts.length;M++)w.charts[M]!=d.chart&&w.charts[M].toolTip.showAtX(d.entries[0].xValue,d.entries[0].dataSeriesIndex)}),(Et(this.charts[f].options.toolTip)||!Et(this.charts[f].options.toolTip)&&Et(this.charts[f].options.toolTip.hidden))&&this.charts[f].toolTip&&(this.charts[f].toolTip.hidden=function(d){for(var M=0;M<w.charts.length;M++)w.charts[M]!=d.chart&&w.charts[M].toolTip.hide()})}this.rangeSelector&&this.rangeSelector.enabled&&this.rangeSelector.inputFields&&this.rangeSelector.inputFields.enabled&&this.rangeSelector._updateInputFields(o,y),this.navigator&&this.navigator.enabled&&this.navigator._updateSlider(o,y)},Pt.prototype.destroy=function(){for(var g=this.allDOMEventHandlers,x=0;x<this.charts.length;x++)this.charts[x].destroy();for(this.navigator&&this.navigator.enabled&&this.navigator.chart.destroy(),x=0;x<g.length;x++)xi(g[x][0],g[x][1],g[x][2],g[x][3]);for(this.allDOMEventHandlers=[];this.navigator&&this.navigator.enabled&&this.navigator.panel.hasChildNodes();)this.navigator.panel.removeChild(this.navigator.panel.lastChild);for(;this._canvasJSContainer&&this._canvasJSContainer.hasChildNodes();)this._canvasJSContainer.removeChild(this._canvasJSContainer.lastChild);for(;this.container&&this.container.hasChildNodes();)this.container.removeChild(this.container.lastChild);this.container=this._canvasJSContainer=null,$s(this.canvas),$s(this.overlaidCanvas),this._eventManager&&this._eventManager.ghostCanvas&&$s(this._eventManager.ghostCanvas),this.navigator.panel=null,this.rangeSelector.panel=null},Pt.prototype.exportChart=function(g){var x=(g=typeof g>"u"?{}:g).format?g.format:"png",w=g.fileName?g.fileName:this.exportFileName,D=this.canvas.cloneNode();D.setAttribute("class",D.getAttribute("class")+"-clone");var o=D.getContext("2d");o.drawImage(this.canvas,0,0);for(var y=[],f=0;f<this.charts.length;f++){var c=this.charts[f];y.push({canvas:c.canvas,position:{x:c.container.offsetLeft,y:c.container.offsetTop}}),y.push({canvas:c.overlaidCanvas,position:{x:c.container.offsetLeft,y:c.container.offsetTop}})}for(this.navigator&&this.navigator.enabled&&(y.push({canvas:(f=this.navigator).chart.canvas,position:{x:f.panel.offsetLeft,y:f.panel.offsetTop}}),y.push({canvas:f.chart.overlaidCanvas,position:{x:f.panel.offsetLeft,y:f.panel.offsetTop}})),f=0;f<y.length;f++)o.drawImage(y[f].canvas,y[f].position.x*Js,y[f].position.y*Js);if(g.toDataURL)return D.toDataURL("image/"+x);bi(D,x,w)},Pt.prototype.print=function(){var g=this.exportChart({toDataURL:!0}),x=document.createElement("iframe");x.setAttribute("class","canvasjs-chart-print-frame"),un(x,{position:"absolute",width:"100%",border:0,margin:0,padding:0}),x.style.height=this.height+"px",this._canvasJSContainer.appendChild(x);var w=this,D=x.contentWindow||x.contentDocument.document||x.contentDocument;D.document.open(),D.document.write('<!DOCTYPE HTML>\n<html><body><img src="'+g+'"/><body/></html>'),D.document.body&&D.document.body.style&&(D.document.body.style.margin="0px 0px 0px 0px",D.document.body.style.padding="0px 0px 0px 0px"),D.document.close(),setTimeout(function(){D.focus(),D.print(),setTimeout(function(){w._canvasJSContainer.removeChild(x)},1e3)},500)},Pt.prototype.getObjectAtXY=function(g,x,w){if(w=null,!Et(this.rangeSelector)){for(var D=0;D<this.rangeSelector.buttons.length;D++){var o=this.rangeSelector.buttons[D];g>=o.bounds.x1&&g<=o.bounds.x2&&x>=o.bounds.y1&&x<=o.bounds.y2&&(w=o.id)}for(D=0;D<this.rangeSelector.inputFields._textBlocks.length;D++)g>=(o=this.rangeSelector.inputFields._textBlocks[D]).bounds.x1&&g<=o.bounds.x2&&x>=o.bounds.y1&&x<=o.bounds.y2&&(w=o.id)}return w},Pt.prototype._touchEventHandler=function(g){if(g.changedTouches){var x=[],w=g.changedTouches,D=w?w[0]:g,o=null;switch(g.type){case"touchstart":case"MSPointerDown":x=["mousemove","mousedown"],this._lastTouchData=ls(D),this._lastTouchData.time=new Date;break;case"touchmove":case"MSPointerMove":x=["mousemove"];break;case"touchend":case"MSPointerUp":var y=this._lastTouchData&&this._lastTouchData.time?new Date-this._lastTouchData.time:0;x="touchstart"===this._lastTouchEventType||"MSPointerDown"===this._lastTouchEventType||300>y?["mouseup","click"]:["mouseup"];break;default:return}if(!(w&&1<w.length)){(o=ls(D)).time=new Date;try{var f=o.y-this._lastTouchData.y;y=o.time-this._lastTouchData.time,(1<Math.abs(f)&&this._lastTouchData.scroll||5<Math.abs(f)&&250>y)&&(this._lastTouchData.scroll=!0)}catch{}if(this._lastTouchEventType=g.type,this._lastTouchData&&this._lastTouchData.scroll)this.isDrag&&this.resetOverlayedCanvas(),this.isDrag=!1;else for(w=0;w<x.length;w++)o=x[w],(f=document.createEvent("MouseEvent")).initMouseEvent(o,!0,!0,window,1,D.screenX,D.screenY,D.clientX,D.clientY,!1,!1,!1,!1,0,null),D.target.dispatchEvent(f),(this._lastTouchData&&!Et(this._lastTouchData.scroll)&&!this._lastTouchData.scroll||this._lastTouchData&&!this._lastTouchData.scroll&&250<y||"click"===o)&&(g.preventManipulation&&g.preventManipulation(),g.preventDefault&&g.cancelable&&g.preventDefault())}}},Pt.prototype._mouseEventHandler=function(g){typeof g.target>"u"&&g.srcElement&&(g.target=g.srcElement);var D,o,x=ls(g),w=g.type;if(g.which?o=3==g.which:g.button&&(o=2==g.button),Pt.capturedEventParam&&(D=Pt.capturedEventParam,"mouseup"===w&&(Pt.capturedEventParam=null,D.stockChart.overlaidCanvas.releaseCapture?D.stockChart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",D.stockChart._mouseEventHandler,!1)),D.hasOwnProperty(w)&&("mouseup"!==w||D.stockChart.overlaidCanvas.releaseCapture?g.target!==D.stockChart.overlaidCanvas&&rt||D[w].call(D.context,x.x,x.y):g.target!==D.stockChart.overlaidCanvas&&(D.stockChart.isDrag=!1))),this._ignoreNextEvent)this._ignoreNextEvent=!1;else if(g.preventManipulation&&g.preventManipulation(),g.preventDefault&&g.preventDefault(),Ze&&window.console&&(window.console.log(w+" --\x3e x: "+x.x+"; y:"+x.y),o&&window.console.log(g.which),"mouseup"===w&&window.console.log("mouseup")),!o){if(!Pt.capturedEventParam&&this._events){for(var y=0;y<this._events.length;y++)if(this._events[y].hasOwnProperty(w)){if(x.x>=(o=(D=this._events[y]).bounds).x1&&x.x<=o.x2&&x.y>=o.y1&&x.y<=o.y2){D[w].call(D.context,x.x,x.y),"mousedown"===w&&!0===D.capture?(Chart.capturedEventParam=D,this.overlaidCanvas.setCapture?this.overlaidCanvas.setCapture():document.documentElement.addEventListener("mouseup",this._mouseEventHandler,!1)):"mouseup"===w&&(D.stockChart.overlaidCanvas.releaseCapture?D.stockChart.overlaidCanvas.releaseCapture():document.documentElement.removeEventListener("mouseup",this._mouseEventHandler,!1));break}D=null}g.target.style.cursor=D&&D.cursor?D.cursor:this._defaultCursor}(x.x<(w=this.bounds).x1||x.x>w.x2||x.y<w.y1||x.y>w.y2)&&this.resetOverlayedCanvas(),!this.isDrag&&this._eventManager&&this._eventManager.mouseEventHandler(g)}},Pt.prototype.resetOverlayedCanvas=function(){this.overlaidCanvasCtx.clearRect(0,0,this.width,this.height)},Pt.prototype.clearCanvas=Ps,Pt.prototype.getAutoFontSize=Zo,On(yt,Ys),On(ct,Mn),ri.prototype.alignVerticalAxes=function(){if(!this.isNavigator&&this.stockChart){for(var g=this.stockChart._chartsPlotAreaX1-(x=this.sessionVariables.plotAreaBounds).x1,x=x.x2-this.stockChart._chartsPlotAreaX2,w=0;w<this.axisX.length;w++)this.axisX[w].lineCoordinates.x1+=g,this.axisX[w].lineCoordinates.x2-=x,this.axisX[w].lineCoordinates.width=this.axisX[w].lineCoordinates.x2-this.axisX[w].lineCoordinates.x1,this.axisX[w].bounds.x1+=g,this.axisX[w].bounds.x2-=x,this.axisX[w].calculateValueToPixelConversionParameters();for(w=0;w<this.axisX2.length;w++)this.axisX2[w].lineCoordinates.x1+=g,this.axisX2[w].lineCoordinates.x2-=x,this.axisX2[w].lineCoordinates.width=this.axisX2[w].lineCoordinates.x2-this.axisX2[w].lineCoordinates.x1,this.axisX2[w].bounds.x1+=g,this.axisX2[w].bounds.x2-=x,this.axisX2[w].calculateValueToPixelConversionParameters();for(w=0;w<this.axisY.length;w++)this.axisY[w].lineCoordinates.x1+=g,this.axisY[w].lineCoordinates.x2+=g,this.axisY[w].bounds.x1+=g,this.axisY[w].bounds.x2+=g;for(w=0;w<this.axisY2.length;w++)this.axisY2[w].lineCoordinates.x1-=x,this.axisY2[w].lineCoordinates.x2-=x,this.axisY2[w].bounds.x1-=x,this.axisY2[w].bounds.x2-=x}},ri.prototype.syncCharts=function(g,x){this.stockChart&&(g=Et(g)?this.stockChart._axisXMin:g,x=Et(x)?this.stockChart._axisXMax:x,this.stockChart._syncCharts(g,x),this.stockChart.sessionVariables._axisXMin=g,this.stockChart.sessionVariables._axisXMax=x,this.stockChart.rangeSelector&&"zoom"!==this._zoomButton.getAttribute("state")&&this.stockChart.rangeSelector.resetRangeButtons())},pt.prototype.reset=function(){this.lastObjectId=0,this.objectMap=[],this.rectangularRegionEventSubscriptions=[],this.eventObjects=[],rt&&(this.ghostCtx.clearRect(0,0,this.stockChart.width,this.stockChart.height),this.ghostCtx.beginPath())},pt.prototype.getNewObjectTrackingId=function(){return++this.lastObjectId},pt.prototype.mouseEventHandler=function(g){if("mousemove"===g.type||"click"===g.type){var x=[],w=ls(g),D=null;if((D=this.stockChart.getObjectAtXY(w.x,w.y,!1))&&typeof this.objectMap[D]<"u")if("rangeButton"===(D=this.objectMap[D]).objectType){var o=this.stockChart.rangeSelector.buttons[D.rangeButtonIndex];D.eventParameter={x:w.x,y:w.y,rangeButton:o,rangeButtonIndex:D.rangeButtonIndex,stockChart:this.stockChart},D.eventContext={context:this.stockChart.rangeSelector,userContext:o,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},x.push(D)}else"inputFields"===D.objectType&&(D.eventParameter={x:w.x,y:w.y,inputField:o=this.stockChart.rangeSelector.inputFields._textBlocks[D.inputFieldIndex],inputFieldIndex:D.inputFieldIndex,stockChart:this.stockChart},D.eventContext={context:this.stockChart.rangeSelector,userContext:o,mouseover:"mouseover",mousemove:"mousemove",mouseout:"mouseout",click:"click"},x.push(D));for(o=[],w=0;w<this.mouseoveredObjectMaps.length;w++){var y=!0;for(D=0;D<x.length;D++)if(x[D].id===this.mouseoveredObjectMaps[w].id){y=!1;break}y?this.fireEvent(this.mouseoveredObjectMaps[w],"mouseout",g):o.push(this.mouseoveredObjectMaps[w])}for(this.mouseoveredObjectMaps=o,w=0;w<x.length;w++){for(o=!1,D=0;D<this.mouseoveredObjectMaps.length;D++)if(x[w].id===this.mouseoveredObjectMaps[D].id){o=!0;break}o||(this.fireEvent(x[w],"mouseover",g),this.mouseoveredObjectMaps.push(x[w])),"click"===g.type?this.fireEvent(x[w],"click",g):"mousemove"===g.type&&this.fireEvent(x[w],"mousemove",g)}}},pt.prototype.fireEvent=function(g,x,w){if(g&&x){var o=g.eventContext,y=g.eventContext.userContext;y&&o&&y[o[x]]&&y[o[x]].call(y,g.eventParameter),"mouseout"!==x?y.cursor&&y.cursor!==w.target.style.cursor&&(w.target.style.cursor=y.cursor):(w.target.style.cursor=this.stockChart._defaultCursor,delete g.eventParameter,delete g.eventContext)}},On(wt,fn),wt.prototype._updateOptions=function(){this.updateOption("enabled"),this.updateOption("backgroundColor"),this.options.backgroundColor||(this.backgroundColor=this.stockChart.backgroundColor),this.updateOption("animationEnabled"),this.animationEnabled=this.animationEnabled&&rt,this.updateOption("animationDuration"),this.updateOption("theme"),this.updateOption("verticalAlign"),this.updateOption("horizontalAlign"),this.updateOption("width"),this.updateOption("height"),this.updateOption("dynamicUpdate")},wt.prototype._initialize=function(){var g;if(this._updateOptions(),this.enabled&&!this.panel&&(this.panel=Q("canvasjs-navigator-panel"),(g=!Et(this.panel)&&this.stockChart._canvasJSContainer.contains(this.panel))||this.stockChart._canvasJSContainer.appendChild(this.panel)),g=!Et(this.panel)&&this.stockChart._canvasJSContainer.contains(this.panel),this.enabled){this.height=this.options.height?parseInt(this.options.height):.14*this.stockChart.height,g||this.stockChart._canvasJSContainer.appendChild(this.panel);var x=this.stockChart.layoutManager.getFreeSpace(),w=x.x1,D=x.y1;this.width=this.options.width?this.width:x.width,"top"===this.verticalAlign?(D=x.y1+2,g="top"):(D=x.y2-this.height-2,g="bottom"),"left"===this.horizontalAlign?w=x.x1+2:"center"===this.horizontalAlign?w=x.x1+x.width/2-this.width/2:"right"===this.horizontalAlign&&(w=x.x2-2-this.width),this.panel.style.top=D+"px",this.panel.style.left=w+"px",this.panel.style.height=this.height+"px",this.panel.style.width=this.width+"px",this.stockChart.layoutManager.registerSpace(g,{width:this.width,height:this.height+2}),this.bounds={x1:w,y1:D,x2:w+this.width,y2:D+this.height}}else g&&this.stockChart._canvasJSContainer.removeChild(this.panel)},wt.prototype._updateSlider=function(g,x){var w=this.chart.axisX&&this.chart.axisX.length?this.chart.axisX[0]:this.chart.axisX2[0];if(!Et(w)){var D=Math.max(w.bounds.x1,w.convertValueToPixel(w.reversed?Math.max(g,Math.min(w.maximum,x)):Math.min(g,Math.min(w.maximum,x)))),o=w.convertValueToPixel(w.reversed?Math.min(g,Math.min(w.maximum,x)):Math.max(g,Math.min(w.maximum,x)));this.slider.panel.style.left=D+"px",this.slider.left=D,this.slider.panel.style.width=o-D+"px",this.slider.width=o-D,this.slider.minimum=g,this.slider.maximum=x,this.chart.resetOverlayedCanvas(),this.slider.maskInverted?is(this.chart.overlaidCanvasCtx,D,0,o,this.height,this.slider.maskColor,0,this.slider.outlineColor,0,0,0,0,this.slider.maskOpacity):(is(this.chart.overlaidCanvasCtx,w.bounds.x1,0,D,this.height,this.slider.maskColor,0,this.slider.outlineColor,!1,!1,!1,!1,this.slider.maskOpacity),is(this.chart.overlaidCanvasCtx,o,0,this.width,this.height,this.slider.maskColor,0,this.slider.outlineColor,!1,!1,!1,!1,this.slider.maskOpacity)),this.chart.overlaidCanvasCtx.lineWidth=this.slider.outlineThickness,this.chart.overlaidCanvasCtx.strokeStyle=this.slider.outlineColor,this.chart.overlaidCanvasCtx.save(),this.chart.overlaidCanvasCtx.beginPath(),0<this.slider.outlineThickness&&(this.slider.outlineInverted?(this.chart.overlaidCanvasCtx.moveTo(w.bounds.x1,this.height-this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(D-this.slider.outlineThickness/2<<0):D,this.height-this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(D-this.slider.outlineThickness/2<<0):D,this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(o-this.slider.outlineThickness/2<<0):o,this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(o-this.slider.outlineThickness/2<<0):o,this.height-this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.width,this.height-this.slider.outlineThickness)):(this.chart.overlaidCanvasCtx.moveTo(w.bounds.x1,this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(D-this.slider.outlineThickness/2<<0):D,this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(D-this.slider.outlineThickness/2<<0):D,this.height-this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(o-this.slider.outlineThickness/2<<0):o,this.height-this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.slider.outlineThickness%2==1?.5+(o-this.slider.outlineThickness/2<<0):o,this.slider.outlineThickness/2),this.chart.overlaidCanvasCtx.lineTo(this.width,this.slider.outlineThickness/2))),this.chart.overlaidCanvasCtx.stroke(),this.chart.overlaidCanvasCtx.restore(),is(this.chart.overlaidCanvasCtx,this.slider.handleBorderThickness%2==1?D-this.slider.handleWidth/2<<.5:D-this.slider.handleWidth/2<<0,this.slider.handleBorderThickness%2==1?this.height/2-this.slider.handleHeight/2<<.5:this.height/2-this.slider.handleHeight/2<<0,this.slider.handleBorderThickness%2==1?D+this.slider.handleWidth/2<<.5:D+this.slider.handleWidth/2<<0,this.slider.handleBorderThickness%2==1?this.height/2+this.slider.handleHeight/2<<.5:this.height/2+this.slider.handleHeight/2<<0,this.slider.handleColor,this.slider.handleBorderThickness,this.slider.handleBorderColor,!1,!1,!1,!1,1),is(this.chart.overlaidCanvasCtx,this.slider.handleBorderThickness%2==1?o-this.slider.handleWidth/2<<.5:o-this.slider.handleWidth/2<<0,this.slider.handleBorderThickness%2==1?this.height/2-this.slider.handleHeight/2<<.5:this.height/2-this.slider.handleHeight/2<<0,this.slider.handleBorderThickness%2==1?o+this.slider.handleWidth/2<<.5:o+this.slider.handleWidth/2<<0,this.slider.handleBorderThickness%2==1?this.height/2+this.slider.handleHeight/2<<.5:this.height/2+this.slider.handleHeight/2<<0,this.slider.handleColor,this.slider.handleBorderThickness,this.slider.handleBorderColor,!1,!1,!1,!1,1),this.chart.overlaidCanvasCtx.lineWidth=this.slider.handleBorderThickness,this.chart.overlaidCanvasCtx.strokeStyle=this.slider.handleBorderColor,this.chart.overlaidCanvasCtx.save(),this.chart.overlaidCanvasCtx.beginPath(),this.chart.overlaidCanvasCtx.moveTo((this.slider.handleBorderThickness%2==1?.5+(D-this.slider.handleBorderThickness/2<<0):D)-Math.round(this.slider.handleBorderThickness),this.height/2-this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.lineTo((this.slider.handleBorderThickness%2==1?.5+(D-this.slider.handleBorderThickness/2<<0):D)-Math.round(this.slider.handleBorderThickness),this.height/2+this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.moveTo((this.slider.handleBorderThickness%2==1?.5+(D+this.slider.handleBorderThickness/2<<0):D)+Math.round(this.slider.handleBorderThickness),this.height/2-this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.lineTo((this.slider.handleBorderThickness%2==1?.5+(D+this.slider.handleBorderThickness/2<<0):D)+Math.round(this.slider.handleBorderThickness),this.height/2+this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.moveTo((this.slider.handleBorderThickness%2==1?.5+(o-this.slider.handleBorderThickness/2<<0):o)-Math.round(this.slider.handleBorderThickness),this.height/2-this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.lineTo((this.slider.handleBorderThickness%2==1?.5+(o-this.slider.handleBorderThickness/2<<0):o)-Math.round(this.slider.handleBorderThickness),this.height/2+this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.moveTo((this.slider.handleBorderThickness%2==1?.5+(o+this.slider.handleBorderThickness/2<<0):o)+Math.round(this.slider.handleBorderThickness),this.height/2-this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.lineTo((this.slider.handleBorderThickness%2==1?.5+(o+this.slider.handleBorderThickness/2<<0):o)+Math.round(this.slider.handleBorderThickness),this.height/2+this.slider.handleHeight/4),this.chart.overlaidCanvasCtx.stroke(),this.chart.overlaidCanvasCtx.restore()}},On(It,fn),It.prototype._updateOptions=function(){this.updateOption("maskColor"),this.updateOption("maskInverted"),this.updateOption("maskOpacity"),this.updateOption("handleColor"),this.updateOption("handleBorderColor"),this.updateOption("handleBorderThickness"),this.updateOption("handleWidth"),this.updateOption("handleHeight"),this.updateOption("outlineColor"),this.updateOption("outlineThickness"),this.updateOption("outlineInverted"),this.updateOption("minimum"),this.updateOption("maximum")},It.prototype._attachEvents=function(){var g=this;Li(this.panel,"mousedown",function(x){g.stockChart.isDrag=!0,x.target!==g.leftHandle&&x.target!==g.rightHandle&&(g.stockChart.navigatorClicked=!0,g.currentHandle=g.leftHandle,g.panMode=!0,g.startPosition=ls(x),x.target===g.currentHandle?g.startPosition.x+=g.currentHandle.offsetLeft+g.currentHandle.clientWidth/2+g.panel.offsetLeft:x.target===g.panel&&(g.startPosition.x+=g.panel.offsetLeft),g.startWidth=g.panel.clientWidth,g.startLeft=g.panel.offsetLeft)},this.stockChart.allDOMEventHandlers),Li(this.panel,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(x){g.stockChart._touchEventHandler(x)},this.stockChart.allDOMEventHandlers),Li(this.navigator.panel,"mousedown",function(x){if(x.target!==g.navigator.slider.panel&&x.target!==g.leftHandle&&x.target!==g.rightHandle){g.stockChart.navigatorClicked=!0;var D,o,w=ls(x);D=0;var y=g.navigator.chart.axisX&&g.navigator.chart.axisX.length?g.navigator.chart.axisX[0]:g.navigator.chart.axisX2[0];if(x=g.navigator.slider.left,Et(g.startLeft)&&(g.startLeft=x),o=w.x-(x+(D=x+g.navigator.slider.width))/2,w.x<x||w.x>D){w=Math.max(0,x+o);var f=Math.min(D+o,g.navigator.width);D+o>g.navigator.width&&(w-=D=D+o-g.navigator.width),0>x+o&&(f+=D=Math.abs(x+o)),g.stockChart._rangeEventParameter={stockChart:g.stockChart,source:"navigator",index:null,minimum:y.convertPixelToValue(w),maximum:y.convertPixelToValue(f)},g.stockChart.sessionVariables._axisXMin=y.convertPixelToValue(w),g.stockChart.sessionVariables._axisXMax=y.convertPixelToValue(f),g.navigator.dynamicUpdate?(g.stockChart._rangeEventParameter.type="rangeChanging",g.stockChart.dispatchEvent("rangeChanging",g.stockChart._rangeEventParameter,g.stockChart),g.stockChart._syncCharts(y.convertPixelToValue(w),y.convertPixelToValue(f)),g.stockChart._rangeEventParameter.type="rangeChanged",g.stockChart.dispatchEvent("rangeChanged",g.stockChart._rangeEventParameter,g.stockChart)):g.navigator._updateSlider(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax)}}},this.navigator.stockChart.allDOMEventHandlers),Li(this.navigator.panel,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(x){g.stockChart._touchEventHandler(x)},this.navigator.stockChart.allDOMEventHandlers),Li(this.navigator.stockChart.container,"mousemove",function(x){var w=g.navigator.chart.axisX&&g.navigator.chart.axisX.length?g.navigator.chart.axisX[0]:g.navigator.chart.axisX2[0];if(!Et(g.currentHandle)&&g.startPosition){var D;g.navigator.chart.overlaidCanvas.style.cursor=g.navigator.chart.container.style.cursor=g.navigator.panel.style.cursor="ew-resize",D=g.currentHandle===g.leftHandle?1:-1;var o=ls(x);o.x=(x=x.target||x.srcElement)===g.currentHandle?o.x+(g.currentHandle.offsetLeft+g.currentHandle.clientWidth/2+g.panel.offsetLeft):x===g.mask||x===g.panel?o.x+g.panel.offsetLeft:x===g.rightHandle&&g.currentHandle===g.leftHandle?o.x+(g.rightHandle.offsetLeft+g.rightHandle.clientWidth/2+g.panel.offsetLeft):x===g.leftHandle&&g.currentHandle===g.rightHandle?o.x+g.panel.offsetLeft:o.x+("canvasjs-chart-toolbar"===x.parentElement.className?x.offsetParent.offsetLeft+x.offsetLeft-g.stockChart._chartsPlotAreaX1:x.parentElement.parentElement.parentElement===g.navigator.panel?x.offsetLeft:x.offsetLeft-g.stockChart._chartsPlotAreaX1);var y=o.x-g.startPosition.x;if(0!==y){x=g.panel.offsetLeft;var f=g.panel.clientWidth;0<D&&(x=Math.max(g.startLeft+D*y,g._left)),g.panMode||(f=Math.min(g.startWidth-D*y,g.fullWidth),D*y>g.startWidth?(x=0<D?g.startLeft+g.startWidth:Math.max(o.x,g._left),f=(0<D?o.x:g.startLeft)-parseFloat(x)):0>D&&(x=g.startLeft)),x+f<=g._left+g.fullWidth&&(2<Math.abs(g.startLeft-x)||2<Math.abs(g.startWidth-parseFloat(f)))&&(0<D&&(g.left=x,g.panel.style.left=g.left+"px"),g.panMode||(g.panel.style.width=g.width=f+"px"),Et(w)||(D=w.convertPixelToValue(Math.max(w.bounds.x1,parseFloat(x))),w=w.convertPixelToValue(parseFloat(x)+parseFloat(f)),g.stockChart.sessionVariables._axisXMin=D,g.stockChart.sessionVariables._axisXMax=w,g.stockChart.rangeSelector&&!g.panMode&&g.stockChart.rangeSelector.resetRangeButtons(),g.stockChart._rangeEventParameter={stockChart:g.stockChart,source:"navigator",index:null,minimum:D,maximum:w},g.navigator.dynamicUpdate?(g.stockChart._rangeEventParameter.type="rangeChanging",g.stockChart.dispatchEvent("rangeChanging",g.stockChart._rangeEventParameter,g.stockChart),g.stockChart._syncCharts(D,w),g.stockChart._rangeEventParameter.type="rangeChanged",g.stockChart.dispatchEvent("rangeChanged",g.stockChart._rangeEventParameter,g.stockChart)):g.navigator._updateSlider(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax)))}}else g.navigator.chart.overlaidCanvas.style.cursor=g.navigator.chart.container.style.cursor=g.navigator.panel.style.cursor="auto"},this.navigator.stockChart.allDOMEventHandlers),Li(this.navigator.stockChart.container,window.navigator.msPointerEnabled?"MSPointerMove":"touchmove",function(x){g.stockChart._touchEventHandler(x)},this.navigator.stockChart.allDOMEventHandlers)},It.prototype._initialize=function(){var x,g=this;this._updateOptions(),I&&(this.eventsAttached||(this._attachEvents(),this.eventsAttached=!0),this.handleWidth=this.options.handleWidth?this.handleWidth:8,this.handleHeight=this.options.handleHeight?Math.min(this.navigator.height,this.options.handleHeight):.25*this.navigator.height,this.leftHandle?un(this.leftHandle,{height:this.navigator.height+"px",width:this.handleWidth+10+"px",position:"absolute",left:"-"+(this.handleWidth/2+8)+"px",top:0,cursor:"ew-resize",borderStyle:"solid",borderWidth:this.handleBorderThickness+"px",borderColor:"transparent",outline:"none",padding:0,backgroundColor:"transparent",color:"transparent",fontSize:"12px",fontFamily:"Arial",userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",opacity:1,zIndex:999}):(this.leftHandle=xt("button","canvasjs-slider-handle","button"),this.leftHandle.innerHTML="||",un(this.leftHandle,{height:this.navigator.height+"px",width:this.handleWidth+10+"px",position:"absolute",left:"-"+(this.handleWidth/2+8)+"px",top:0,cursor:"ew-resize",borderStyle:"solid",borderWidth:this.handleBorderThickness+"px",borderColor:"transparent",outline:"none",padding:0,backgroundColor:"transparent",color:"transparent",fontSize:"12px",fontFamily:"Arial",userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",opacity:1,zIndex:999}),this.panel.appendChild(this.leftHandle),this.initHandle(this.leftHandle,1)),this.rightHandle?un(this.rightHandle,{height:this.navigator.height+"px",width:this.handleWidth+10+"px",position:"absolute",right:"-"+(this.handleWidth/2+8)+"px",top:0,cursor:"ew-resize",borderStyle:"solid",borderWidth:this.handleBorderThickness+"px",borderColor:"transparent",outline:"none",padding:"0px",backgroundColor:"transparent",color:"transparent",fontSize:"12px",fontFamily:"Arial",userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",opacity:1,zIndex:"999"}):(this.rightHandle=xt("button","canvasjs-slider-handle","button"),this.rightHandle.innerHTML="||",un(this.rightHandle,{height:this.navigator.height+"px",width:this.handleWidth+10+"px",position:"absolute",right:"-"+(this.handleWidth/2+8)+"px",top:0,cursor:"ew-resize",borderStyle:"solid",borderWidth:this.handleBorderThickness+"px",borderColor:"transparent",outline:"none",padding:"0px",backgroundColor:"transparent",color:"transparent",fontSize:"12px",fontFamily:"Arial",userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",msUserSelect:"none",opacity:1,zIndex:"999"}),this.panel.appendChild(this.rightHandle),this.initHandle(this.rightHandle,-1)),un(this.panel,{position:"absolute",height:this.navigator.height+"px",width:"100%",cursor:"move"}),this.fullWidth=this.panel.clientWidth,this._left=this.navigator.panel.offsetLeft,Li(document,"mousedown",function(w){if(g.stockChart.rangeSelector&&g.stockChart.rangeSelector.inputFields&&g.stockChart.rangeSelector.inputFields.enabled)for(var D=0;D<g.stockChart.rangeSelector.inputFields.elements.length;D++)w.target!=g.stockChart.rangeSelector.inputFields.elements[D]&&g.stockChart.rangeSelector.inputFields.elements[D].focused&&g.stockChart.rangeSelector.inputFields.elements[D].blur()},this.navigator.stockChart.allDOMEventHandlers),Li(document,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(w){t:{var D=(D=w.changedTouches)?D[0]:w,o="";switch(w.type){case"touchstart":case"MSPointerDown":o="mousedown";break;case"touchmove":case"MSPointerMove":o="mousemove";break;case"touchend":case"MSPointerUp":o="mouseup";break;default:break t}(w=document.createEvent("MouseEvent")).initMouseEvent(o,!0,!0,window,1,D.screenX,D.screenY,D.clientX,D.clientY,!1,!1,!1,!1,0,null),D.target.dispatchEvent(w)}},this.navigator.stockChart.allDOMEventHandlers),Li(document,"mouseup",function(w){if(g.panMode=!1,g.navigator.stockChart.isDrag=!1,g.stockChart.navigatorClicked){w=Math.min(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax);var D=Math.max(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax);if(Et(g.stockChart._rangeEventParameter)&&(g.stockChart._rangeEventParameter={stockChart:g.stockChart,source:"navigator",index:null,minimum:w,maximum:D}),2<Math.abs(g.startLeft-g.left)||2<Math.abs(g.startWidth-parseFloat(g.width))){g.navigator.dynamicUpdate||(g.stockChart._rangeEventParameter.type="rangeChanging",g.stockChart.dispatchEvent("rangeChanging",g.stockChart._rangeEventParameter,g.stockChart));for(var o=0;o<g.stockChart.charts.length;o++){(x=g.stockChart.charts[o]).toolTip&&x.toolTip.enabled&&x.toolTip.hide();for(var y=0;y<x.axisX.length;y++)x.axisX[y].setViewPortRange(w,D);for(y=0;y<x.axisX2.length;y++)x.axisX2[y].setViewPortRange(w,D);x.render()}g.stockChart.rangeSelector&&g.stockChart.rangeSelector.enabled&&g.stockChart.rangeSelector.inputFields&&g.stockChart.rangeSelector.inputFields.enabled&&g.stockChart.rangeSelector._updateInputFields(w,D),g.navigator.dynamicUpdate||(g.stockChart._rangeEventParameter.type="rangeChanged",g.stockChart.dispatchEvent("rangeChanged",g.stockChart._rangeEventParameter,g.stockChart))}}g.stockChart.navigatorClicked=g.currentHandle=g.startPosition=g.startWidth=g.startLeft=null},this.navigator.stockChart.allDOMEventHandlers),Li(document,window.navigator.msPointerEnabled?"MSPointerUp":"touchend",function(w){if(g.panMode=!1,g.navigator.stockChart.isDrag=!1,g.stockChart.navigatorClicked){w=Math.min(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax);var D=Math.max(g.stockChart.sessionVariables._axisXMin,g.stockChart.sessionVariables._axisXMax);Et(g.stockChart._rangeEventParameter)&&(g.stockChart._rangeEventParameter={stockChart:g.stockChart,source:"navigator",index:null,minimum:w,maximum:D}),g.navigator.dynamicUpdate||(g.stockChart._rangeEventParameter.type="rangeChanging",g.stockChart.dispatchEvent("rangeChanging",g.stockChart._rangeEventParameter,g.stockChart));for(var o=0;o<g.stockChart.charts.length;o++){(x=g.stockChart.charts[o]).toolTip&&x.toolTip.enabled&&x.toolTip.hide();for(var y=0;y<x.axisX.length;y++)x.axisX[y].setViewPortRange(w,D);for(y=0;y<x.axisX2.length;y++)x.axisX2[y].setViewPortRange(w,D);x.render()}g.stockChart.rangeSelector&&g.stockChart.rangeSelector.enabled&&g.stockChart.rangeSelector.inputFields&&g.stockChart.rangeSelector.inputFields.enabled&&g.stockChart.rangeSelector._updateInputFields(w,D),g.navigator.dynamicUpdate||(g.stockChart._rangeEventParameter.type="rangeChanged",g.stockChart.dispatchEvent("rangeChanged",g.stockChart._rangeEventParameter,g.stockChart))}g.stockChart.navigatorClicked=g.currentHandle=g.startPosition=g.startWidth=g.startLeft=null},this.navigator.stockChart.allDOMEventHandlers))},It.prototype.initHandle=function(g,x){var w=this;g&&(Li(g,"mousedown",function(D){w.stockChart.navigatorClicked=!0,w.currentHandle=this,w.startPosition=ls(D),D.target===w.currentHandle?w.startPosition.x+=w.currentHandle.offsetLeft+w.currentHandle.clientWidth/2+w.panel.offsetLeft:D.target===w.panel&&(w.startPosition.x+=w.panel.offsetLeft),w.startWidth=w.panel.clientWidth,w.startLeft=w.panel.offsetLeft,D.preventDefault&&D.preventDefault(),D.stopPropagation&&D.stopPropagation()},this.navigator.stockChart.allDOMEventHandlers),Li(g,window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",function(D){w.stockChart._touchEventHandler(D)},this.navigator.stockChart.allDOMEventHandlers))},On(Gt,fn),Gt.prototype._updateOptions=function(){this.updateOption("enabled"),this.updateOption("verticalAlign"),this.updateOption("horizontalAlign"),this.updateOption("width"),this.updateOption("height"),this.updateOption("label"),this.updateOption("selectedRangeButtonIndex")},Gt.prototype._initialize=function(){var g=0;if(this._updateOptions(),this._label={},this.buttons=[],I&&this.enabled){if(this.options.buttons)for(var D=0;D<this.options.buttons.length;D++)this.buttons.push(new re(this.stockChart,D,this.options.buttons[D]));else{for(D=0;6>D;D++)this.buttons.push(new re(this.stockChart,D));this.buttonLabels="1m 3m 6m YTD 1y All".split(" ")}this._wrapElements=!1;var x=this.stockChart.layoutManager.getFreeSpace(),w=x.x1;if(D=x.y1,this.width=this.options.width?this.width:x.width,Et(this.buttonStyle.options.labelFontSize)&&(this.buttonStyle.labelFontSize=this.stockChart.getAutoFontSize(this.buttonStyle.labelFontSize)),this.rangeButtonsWidth=0,this.buttonStyle.maxWidth=this.buttonStyle.options.maxWidth?this.buttonStyle.options.maxWidth:this.stockChart.width/this.buttons.length,this.buttons&&0<this.buttons.length){var o=new En(this.ctx,{x:0,y:0,backgroundColor:this.stockChart.backgroundColor,borderThickness:0,cornerRadius:0,maxWidth:.2*this.stockChart.width,maxHeight:2*this.buttonStyle.labelFontSize,angle:0,padding:{left:5,right:5,top:2,bottom:2},text:Et(this.stockChart.options.culture)||Et(this.stockChart._cultureInfo.rangeSelector.rangeText)?this.label:this.stockChart._cultureInfo.rangeSelector.rangeText,horizontalAlign:"left",fontSize:this.buttonStyle.labelFontSize,fontFamily:this.buttonStyle.labelFontFamily,fontWeight:this.buttonStyle.labelFontWeight,fontColor:this.buttonStyle.labelFontColor,fontStyle:this.buttonStyle.labelFontStyle,textBaseline:"middle"});this._label.textBlock=o}for(D=0;D<this.buttons.length;D++){var y=this.buttons[D];y._index=D,o=new En(this.ctx,{x:0,y:0,backgroundColor:this.buttonStyle.backgroundColor,borderColor:this.buttonStyle.borderColor,borderThickness:this.buttonStyle.borderThickness,cornerRadius:0,maxWidth:this.buttonStyle.options.width?this.buttonStyle.width:this.buttonStyle.maxWidth,maxHeight:2*this.buttonStyle.labelFontSize,angle:0,padding:this.buttonStyle.padding,text:this.options.buttons&&this.options.buttons.length?Et(y.label)?"":y.label:this.buttonLabels[D],horizontalAlign:"center",textAlign:"center",fontSize:this.buttonStyle.labelFontSize,fontFamily:this.buttonStyle.labelFontFamily,fontWeight:this.buttonStyle.labelFontWeight,fontColor:this.buttonStyle.labelFontColor,fontStyle:this.buttonStyle.labelFontStyle,textBaseline:"middle"}),y.state=Et(this.selectedRangeButtonIndex)||this.selectedRangeButtonIndex!==D?"off":"on",y.textBlock=o,y.bounds={x1:null,x2:null,y1:null,y2:null,width:null,height:null},o.measureText(),this.rangeButtonsWidth+=o.width+this.buttonStyle.spacing,this.rangeButtonsHeight=o.height,g=g<o.height?o.height:g,(y=this.buttons[D]).id=++this.stockChart._eventManager.lastObjectId,this.stockChart._eventManager.objectMap[y.id]={id:y.id,objectType:"rangeButton",rangeButtonIndex:D}}for(this.height<this.inputFieldsHeight+2*this.inputFields.style.borderThickness&&(this.height=this.inputFieldsHeight+2*this.inputFields.style.borderThickness),this.height<g+2*this.buttonStyle.borderThickness+5&&(this.height=g+2*this.buttonStyle.borderThickness+5),this._label&&this._label.textBlock&&this.rangeButtonsWidth&&this.inputFieldsWidth&&this.rangeButtonsWidth+this._label.textBlock.measureText().width+this.inputFieldsWidth>=this.stockChart.width&&(this.height=this.options.height?this.height:2*this.height,this._wrapElements=!0),"bottom"===this.verticalAlign?(D=x.y2-this.height,g="bottom"):(D=x.y1,g="top"),"left"===this.horizontalAlign?w=x.x1+2:"center"===this.horizontalAlign?w=x.x1+x.width/2-this.width/2:"right"===this.horizontalAlign&&(w=x.x2-2-this.width),this.stockChart.layoutManager.registerSpace(g,{width:this.width,height:this.height}),this.bounds={x1:w,y1:D,x2:w+this.width,y2:D+this.height,width:this.width,height:this.height},D=0;D<this.buttons.length;D++)this.buttons[D]._initialize(D)}},Gt.prototype.render=function(){var g;for(this.setButtonsLayout(),is(this.ctx,this.bounds.x1,this.bounds.y1,this.bounds.x2,this.bounds.y2,this.stockChart.backgroundColor,0,null,0,0,0,0,1),this._label&&this._label.textBlock&&this._label.textBlock.render(!0),g=0;g<this.buttons.length;g++)this.buttons[g].enabled||(this.buttons[g].textBlock.backgroundColor=this.buttons[g].backgroundColorDisabled,this.buttons[g].textBlock.borderColor=this.buttons[g].backgroundColorDisabled),this.buttons[g].render(!0);this.inputFields&&this.inputFields.enabled&&this.renderInputFields(!0)},Gt.prototype.setButtonsLayout=function(){var g,x,D,o,w=this.bounds.x1+5;for(this._label&&this._label.textBlock&&0<this.buttons.length&&(this._label.textBlock.x=w,this._label.textBlock.y=o=this.bounds.y1+this._label.textBlock.measureText().height/2+2*this.buttons[0].textBlock.borderThickness,this._label.bounds={x1:w,y1:o-this._label.textBlock.fontSize/2,x2:w+this._label.textBlock.measureText().width,y2:o+this._label.textBlock.measureText().height,width:this._label.textBlock.measureText().width,height:this._label.textBlock.measureText().height},w+=this._label.bounds.width),g=0;g<this.buttons.length;g++)(x=this.buttons[g]).textBlock.width=x.textBlock.maxWidth=this.buttonStyle.width=this.buttonStyle.options.width?this.buttonStyle.width:x.textBlock.width,D=w+x.textBlock.width,x.textBlock.x=x.bounds.x1=x.textBlock.borderThickness%2==1?.5+(w<<0):w,x.bounds.x2=D,x.textBlock.y=o=x.textBlock.borderThickness%2==1?this.bounds.y1+x.textBlock.height/2+2*x.textBlock.borderThickness<<.5:this.bounds.y1+x.textBlock.height/2+2*x.textBlock.borderThickness,x.bounds.y1=o-x.textBlock.height/2,x.bounds.y2=x.bounds.y1+x.textBlock.height,x.bounds.width=D-w,x.bounds.height=x.bounds.y2-x.bounds.y1,w=D+this.buttonStyle.spacing,x.textBlock.maxWidth=this.buttonStyle.maxWidth},Gt.prototype.resetRangeButtons=function(){for(var g=0;g<this.buttons.length;g++)this.buttons[g].enabled&&(this.buttons[g].state="off",this.buttons[g].textBlock.backgroundColor=this.buttonStyle.backgroundColor,this.buttons[g].textBlock.fontColor=this.buttonStyle.labelFontColor,this.buttons[g].textBlock.fontWeight=this.buttonStyle.labelFontWeight,this.buttons[g].textBlock.render(!0))},Gt.prototype.renderInputFields=function(){this.inputFields._textBlocks[0].text="dateTime"===this.inputFields.valueType?Es(this.inputFields.startValue,this.inputFields.valueFormatString,this.stockChart._cultureInfo):Gn(this.inputFields.startValue,this.inputFields.valueFormatString,this.stockChart._cultureInfo),this.inputFields._textBlocks[1].text="dateTime"===this.inputFields.valueType?Es(this.inputFields.endValue,this.inputFields.valueFormatString,this.stockChart._cultureInfo):Gn(this.inputFields.endValue,this.inputFields.valueFormatString,this.stockChart._cultureInfo),this.inputFields._labels[0].text=Et(this.stockChart._cultureInfo.rangeSelector.fromText)?"From":this.stockChart._cultureInfo.rangeSelector.fromText,this.inputFields._labels[1].text=Et(this.stockChart._cultureInfo.rangeSelector.toText)?"To":this.stockChart._cultureInfo.rangeSelector.toText;var g=0,x=!0;if((this.stockChart.title&&this.stockChart.title.text&&("top"===this.stockChart.title.verticalAlign||"right"===this.stockChart.title.horizontalAlign&&"center"===this.stockChart.title.verticalAlign&&this.stockChart.exportEnabled)||"bottom"===this.verticalAlign)&&(x=!1),this.stockChart.subtitles)for(var w=0;w<this.stockChart.subtitles.length;w++)this.stockChart.subtitles[w]&&this.stockChart.subtitles[w].text&&("top"===this.stockChart.subtitles[w].verticalAlign||"right"===this.stockChart.subtitles[w].horizontalAlign&&"center"===this.stockChart.subtitles[w].verticalAlign&&this.stockChart.exportEnabled)&&(x=!1);for(w=this.inputFields._textBlocks.length-1;0<=w;w--){var D=this.inputFields._textBlocks[w],o=D.measureText();D._width=this.inputFields.style.options.width?this.inputFields.style.width:Math.abs(o.width-D._width)<=("dateTime"===this.inputFields.valueType?10:5)?D._width:o.width+10,g+=D._width+this.inputFields.style.spacing,this.inputFields.elements[w].style.width=D._width-this.inputFields.style.spacing-2*this.inputFields.style.borderThickness-5+"px",D.x=D.bounds.x1=D.borderThickness%2==1?.5+(this.bounds.x2-g-(this.stockChart.exportEnabled&&x?40:0)<<0):this.bounds.x2-g-(this.stockChart.exportEnabled&&x?40:0),D.bounds.x2=D.bounds.x1+D._width,this.inputFields.elements[w].style.left=this.bounds.x2-g-(this.stockChart.exportEnabled&&x?40:0)+this.inputFields.style.borderThickness+"px",g+=this.inputFields._labels[w].measureText().width,this.inputFields._labels[w].x=this.inputFields._labels[w].bounds.x1=this.bounds.x2-g-(this.stockChart.exportEnabled&&x?40:0),this.inputFields._labels[w].bounds.x2=this.inputFields._labels[w].bounds.x1+this.inputFields._labels[w].measureText().width,D.width=D._width,D.y=D.borderThickness%2==1?(this._wrapElements?this.bounds.y1+this.rangeButtonsHeight+10:this.bounds.y1)+o.height/2+2*D.borderThickness<<.5:(this._wrapElements?this.bounds.y1+this.rangeButtonsHeight+10:this.bounds.y1)+o.height/2+2*D.borderThickness,this.inputFields._labels[w].y=(this._wrapElements?this.bounds.y1+this.rangeButtonsHeight+10:this.bounds.y1)+o.height/2+2*D.borderThickness,D.bounds.y1=this.inputFields._labels[w].bounds.y1=D.y-o.height/2+2*D.borderThickness,D.bounds.y2=this.inputFields._labels[w].bounds.y2=D.bounds.y1+o.height,this.inputFields.elements[w].style.top=this.inputFields._labels[w].bounds.y1+"px",D.render(!0),this.inputFields._labels[w].render(!0)}},Gt.prototype._updateInputFields=function(g,x){this.inputFields.elements[0].focused||(this.inputFields.elements[0].value="dateTime"===this.inputFields.valueType?Es(g,"YYYY-MM-DD"):Gn(g,this.inputFields.valueFormatString)),this.inputFields.elements[1].focused||(this.inputFields.elements[1].value="dateTime"===this.inputFields.valueType?Es(x,"YYYY-MM-DD"):Gn(x,this.inputFields.valueFormatString));for(var w=0;w<this.inputFields.elements.length;w++)this.inputFields.elements[w].focused&&this.inputFields.elements[w].focus();this.inputFields.startValue=g,this.inputFields.endValue=x,this.render()},On(re,fn),re.prototype._updateOptions=function(){this.updateOption("style"),this.updateOption("label"),this.updateOption("range"),this.updateOption("rangeType")},re.prototype._initialize=function(g){this._updateOptions();var x="1m 3m 6m YTD 1y All".split(" "),w=[1,3,6,null,1,null],D="month month month ytd year all".split(" ");this.range=typeof this.options.range<"u"?this.range:Et(w[g])?null:w[g],this.rangeType=typeof this.options.rangeType<"u"?this.rangeType:D[g],this.label=this.textBlock.text=Et(this.options.label)?x[g]:this.label},re.prototype.render=function(){this.textBlock.render(!0)},On(te,fn),te.prototype._updateOptions=function(){this.updateOption("enabled"),this.updateOption("startValue"),this.updateOption("endValue"),this.updateOption("valueType"),this.updateOption("valueFormatString")},te.prototype._initialize=function(){if(this._updateOptions(),Et(this.style.options.fontSize)&&(this.style.fontSize=this.stockChart.getAutoFontSize(this.style.fontSize)),this.enabled){for(var g=0;g<this.elements.length;g++)this.elements[g].style.position="absolute",this.elements[g].style.display=this.elements[g].focused?"inline":"none",this.elements[g].style.backgroundColor=this.style.backgroundColor,this.elements[g].style.border="none",this.elements[g].style.outline="none",this.elements[g].style.outlineOffset=0,this.elements[g].style.textAlign="center",this.elements[g].style.color=this.style.fontColor,this.elements[g].style.fontSize=this.elements[g].style.height=this.style.fontSize+"px",this.elements[g].style.fontStyle=this.style.fontStyle,this.elements[g].style.fontFamily=this.style.fontFamily,this.elements[g].style.fontWeight=this.style.fontWeight,this.elements[g].style.lineHeight=1,isNaN(this.style.padding)?(this.elements[g].style.paddingTop=this.style.padding.top+"px",this.elements[g].style.paddingRight=this.style.padding.right+"px",this.elements[g].style.paddingBottom=this.style.padding.bottom+"px",this.elements[g].style.paddingLeft=this.style.padding.left+"px"):this.elements[g].style.padding=this.style.padding+"px",this.elements[g].style.mozAppearance=this.elements[g].style.webkitAppearance=this.elements[g].style.appearance="none",this.elements[g].style.webkitBorderRadius=0,this.elements[g].style.mozBorderRadius=0,this.elements[g].style.borderRadius=0,this.elements[g].style.boxSizing="content-box";this.parent=this.rangeSelector=this.stockChart.rangeSelector}},On(ie,fn),ie.prototype._updateOptions=function(){this.updateOption("backgroundColor"),this.updateOption("backgroundColorOnHover"),this.updateOption("backgroundColorOnSelect"),this.updateOption("borderColor"),this.updateOption("borderThickness"),this.updateOption("labelFontColor"),this.updateOption("labelFontColorOnHover"),this.updateOption("labelFontSize"),this.updateOption("labelFontStyle"),this.updateOption("labelFontFamily"),this.updateOption("labelFontWeight"),this.updateOption("width"),this.updateOption("maxWidth"),this.updateOption("padding"),this.updateOption("spacing"),this.updateOption("cursor")},On(u,fn),u.prototype._updateOptions=function(){this.updateOption("backgroundColor"),this.updateOption("borderColor"),this.updateOption("borderThickness"),this.updateOption("borderColorOnFocus"),this.updateOption("fontColor"),this.updateOption("fontSize"),this.updateOption("fontStyle"),this.updateOption("fontFamily"),this.updateOption("fontWeight"),this.updateOption("width"),this.updateOption("maxWidth"),this.updateOption("padding"),this.updateOption("spacing"),this.updateOption("cursor")},Pt}(),Vi.version="v1.6.4 GA",window.CanvasJS&&(Vi&&!window.CanvasJS.StockChart&&window.CanvasJS.Chart&&(window.CanvasJS.StockChart=Vi),Vi&&!window.CanvasJS.Chart&&(window.CanvasJS.Chart=ri,window.CanvasJS.StockChart=Vi))})(),document.createElement("canvas").getContext||function(){function On(){return this.context_||(this.context_=new tn(this))}function b(at){return String(at).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function De(at){at.namespaces.g_vml_||at.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),at.namespaces.g_o_||at.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),at.styleSheets.ex_canvas_||((at=at.createStyleSheet()).owningElement.id="ex_canvas_",at.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}")}function ho(at){var rt=at.srcElement;switch(at.propertyName){case"width":rt.getContext().clearRect(),rt.style.width=rt.attributes.width.nodeValue+"px",rt.firstChild.style.width=rt.clientWidth+"px";break;case"height":rt.getContext().clearRect(),rt.style.height=rt.attributes.height.nodeValue+"px",rt.firstChild.style.height=rt.clientHeight+"px"}}function ks(at){(at=at.srcElement).firstChild&&(at.firstChild.style.width=at.clientWidth+"px",at.firstChild.style.height=at.clientHeight+"px")}function bi(at,rt){for(var Yt=[[1,0,0],[0,1,0],[0,0,1]],Kt=0;3>Kt;Kt++)for(var Xt=0;3>Xt;Xt++){for(var xe=0,We=0;3>We;We++)xe+=at[Kt][We]*rt[We][Xt];Yt[Kt][Xt]=xe}return Yt}function an(at,rt){rt.fillStyle=at.fillStyle,rt.lineCap=at.lineCap,rt.lineJoin=at.lineJoin,rt.lineWidth=at.lineWidth,rt.miterLimit=at.miterLimit,rt.shadowBlur=at.shadowBlur,rt.shadowColor=at.shadowColor,rt.shadowOffsetX=at.shadowOffsetX,rt.shadowOffsetY=at.shadowOffsetY,rt.strokeStyle=at.strokeStyle,rt.globalAlpha=at.globalAlpha,rt.font=at.font,rt.textAlign=at.textAlign,rt.textBaseline=at.textBaseline,rt.arcScaleX_=at.arcScaleX_,rt.arcScaleY_=at.arcScaleY_,rt.lineScale_=at.lineScale_}function $t(at){var Yt=at.indexOf("(",3),rt=at.indexOf(")",Yt+1);return(4!=(Yt=at.substring(Yt+1,rt).split(",")).length||"a"!=at.charAt(3))&&(Yt[3]=1),Yt}function Et(at,rt,Yt){return Math.min(Yt,Math.max(rt,at))}function fo(at,rt,Yt){return 0>Yt&&Yt++,1<Yt&&Yt--,1>6*Yt?at+6*(rt-at)*Yt:1>2*Yt?rt:2>3*Yt?at+6*(rt-at)*(2/3-Yt):at}function Yo(at){if(at in Mn)return Mn[at];var rt,Yt=1;if("#"==(at=String(at)).charAt(0))rt=at;else if(/^rgb/.test(at)){Yt=$t(at),rt="#";for(var Kt,Xt=0;3>Xt;Xt++)Kt=-1!=Yt[Xt].indexOf("%")?Math.floor(parseFloat(Yt[Xt])/100*255):+Yt[Xt],rt+=En[Et(Kt,0,255)];Yt=+Yt[3]}else if(/^hsl/.test(at)){if(Xt=Yt=$t(at),0>(rt=parseFloat(Xt[0])/360%360)&&rt++,Kt=Et(parseFloat(Xt[1])/100,0,1),Xt=Et(parseFloat(Xt[2])/100,0,1),0==Kt)Kt=Xt=rt=Xt;else{var xe=.5>Xt?Xt*(1+Kt):Xt+Kt-Xt*Kt,We=2*Xt-xe;Kt=fo(We,xe,rt+1/3),Xt=fo(We,xe,rt),rt=fo(We,xe,rt-1/3)}rt="#"+En[Math.floor(255*Kt)]+En[Math.floor(255*Xt)]+En[Math.floor(255*rt)],Yt=Yt[3]}else rt=Ys[at]||at;return Mn[at]={color:rt,alpha:Yt}}function tn(at){this.m_=[[1,0,0],[0,1,0],[0,0,1]],this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*Ri,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=at;var rt="width:"+at.clientWidth+"px;height:"+at.clientHeight+"px;overflow:hidden;position:absolute",Yt=at.ownerDocument.createElement("div");Yt.style.cssText=rt,at.appendChild(Yt),(rt=Yt.cloneNode(!1)).style.backgroundColor="red",rt.style.filter="alpha(opacity=0)",at.appendChild(rt),this.element_=Yt,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function Ti(at,rt,Yt,Kt){at.currentPath_.push({type:"bezierCurveTo",cp1x:rt.x,cp1y:rt.y,cp2x:Yt.x,cp2y:Yt.y,x:Kt.x,y:Kt.y}),at.currentX_=Kt.x,at.currentY_=Kt.y}function Li(at,rt){var Yt=(Kt=Yo(at.strokeStyle)).color,Kt=Kt.alpha*at.globalAlpha,Xt=at.lineScale_*at.lineWidth;1>Xt&&(Kt*=Xt),rt.push("<g_vml_:stroke",' opacity="',Kt,'"',' joinstyle="',at.lineJoin,'"',' miterlimit="',at.miterLimit,'"',' endcap="',Ls[at.lineCap]||"square",'"',' weight="',Xt,'px"',' color="',Yt,'" />')}function xi(at,rt,Yt,Kt){var Xt=at.fillStyle,xe=at.arcScaleX_,We=at.arcScaleY_,Ke=Kt.x-Yt.x,Vi=Kt.y-Yt.y;if(Xt instanceof yo){var $e=0,hi=Kt=0,ai=0,Qi=1;if("gradient"==Xt.type_){$e=Xt.x1_/xe,Yt=Xt.y1_/We;var Pi=en(at,Xt.x0_/xe,Xt.y0_/We);$e=en(at,$e,Yt),0>($e=180*Math.atan2($e.x-Pi.x,$e.y-Pi.y)/Math.PI)&&($e+=360),1e-6>$e&&($e=0)}else Kt=((Pi=en(at,Xt.x0_,Xt.y0_)).x-Yt.x)/Ke,hi=(Pi.y-Yt.y)/Vi,Qi=$n.max(Ke/=xe*Ri,Vi/=We*Ri),Qi=2*Xt.r1_/Qi-(ai=2*Xt.r0_/Qi);(xe=Xt.colors_).sort(function(Hs,In){return Hs.offset-In.offset}),Pi=xe[0].color,Yt=xe[(We=xe.length)-1].color,Ke=xe[0].alpha*at.globalAlpha,at=xe[We-1].alpha*at.globalAlpha,Vi=[];for(var Ei=0;Ei<We;Ei++){var ys=xe[Ei];Vi.push(ys.offset*Qi+ai+" "+ys.color)}rt.push('<g_vml_:fill type="',Xt.type_,'"',' method="none" focus="100%"',' color="',Pi,'"',' color2="',Yt,'"',' colors="',Vi.join(","),'"',' opacity="',at,'"',' g_o_:opacity2="',Ke,'"',' angle="',$e,'"',' focusposition="',Kt,",",hi,'" />')}else Xt instanceof Xi?Ke&&Vi&&rt.push("<g_vml_:fill",' position="',-Yt.x/Ke*xe*xe,",",-Yt.y/Vi*We*We,'"',' type="tile"',' src="',Xt.src_,'" />'):(Xt=Yo(at.fillStyle),rt.push('<g_vml_:fill color="',Xt.color,'" opacity="',Xt.alpha*at.globalAlpha,'" />'))}function en(at,rt,Yt){return{x:Ri*(rt*(at=at.m_)[0][0]+Yt*at[1][0]+at[2][0])-Us,y:Ri*(rt*at[0][1]+Yt*at[1][1]+at[2][1])-Us}}function ro(at,rt,Yt){isFinite(rt[0][0])&&isFinite(rt[0][1])&&isFinite(rt[1][0])&&isFinite(rt[1][1])&&isFinite(rt[2][0])&&isFinite(rt[2][1])&&(at.m_=rt,Yt&&(at.lineScale_=As(Wi(rt[0][0]*rt[1][1]-rt[0][1]*rt[1][0]))))}function yo(at){this.type_=at,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function Xi(at,rt){if(!at||1!=at.nodeType||"IMG"!=at.tagName)throw new cn("TYPE_MISMATCH_ERR");if("complete"!=at.readyState)throw new cn("INVALID_STATE_ERR");switch(rt){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=rt;break;default:throw new cn("SYNTAX_ERR")}this.src_=at.src,this.width_=at.width,this.height_=at.height}function cn(at){this.code=this[at],this.message=at+": DOM Exception "+this.code}var $n=Math,zi=$n.round,un=$n.sin,js=$n.cos,Wi=$n.abs,As=$n.sqrt,Ri=10,Us=Ri/2;navigator.userAgent.match(/MSIE ([\d.]+)?/);var fn=Array.prototype.slice;De(document);var ln={init:function(at){(at=at||document).createElement("canvas"),at.attachEvent("onreadystatechange",function qa(at,rt,Yt){var Kt=fn.call(arguments,2);return function(){return at.apply(rt,Kt.concat(fn.call(arguments)))}}(this.init_,this,at))},init_:function(at){at=at.getElementsByTagName("canvas");for(var rt=0;rt<at.length;rt++)this.initElement(at[rt])},initElement:function(at){if(!at.getContext){at.getContext=On,De(at.ownerDocument),at.innerHTML="",at.attachEvent("onpropertychange",ho),at.attachEvent("onresize",ks);var rt=at.attributes;rt.width&&rt.width.specified?at.style.width=rt.width.nodeValue+"px":at.width=at.clientWidth,rt.height&&rt.height.specified?at.style.height=rt.height.nodeValue+"px":at.height=at.clientHeight}return at}};ln.init();for(var En=[],Ze=0;16>Ze;Ze++)for(var ao=0;16>ao;ao++)En[16*Ze+ao]=Ze.toString(16)+ao.toString(16);var Ys={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},Mn={},oe={},Ls={butt:"flat",round:"round"};(Ze=tn.prototype).clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},Ze.beginPath=function(){this.currentPath_=[]},Ze.moveTo=function(at,rt){var Yt=en(this,at,rt);this.currentPath_.push({type:"moveTo",x:Yt.x,y:Yt.y}),this.currentX_=Yt.x,this.currentY_=Yt.y},Ze.lineTo=function(at,rt){var Yt=en(this,at,rt);this.currentPath_.push({type:"lineTo",x:Yt.x,y:Yt.y}),this.currentX_=Yt.x,this.currentY_=Yt.y},Ze.bezierCurveTo=function(at,rt,Yt,Kt,Xt,xe){Xt=en(this,Xt,xe),Ti(this,at=en(this,at,rt),Yt=en(this,Yt,Kt),Xt)},Ze.quadraticCurveTo=function(at,rt,Yt,Kt){at=en(this,at,rt),Yt=en(this,Yt,Kt),Ti(this,Kt={x:this.currentX_+2/3*(at.x-this.currentX_),y:this.currentY_+2/3*(at.y-this.currentY_)},{x:Kt.x+(Yt.x-this.currentX_)/3,y:Kt.y+(Yt.y-this.currentY_)/3},Yt)},Ze.arc=function(at,rt,Yt,Kt,Xt,xe){Yt*=Ri;var We=xe?"at":"wa",Ke=at+js(Kt)*Yt-Us,Vi=rt+un(Kt)*Yt-Us;Kt=at+js(Xt)*Yt-Us,Xt=rt+un(Xt)*Yt-Us,Ke!=Kt||xe||(Ke+=.125),at=en(this,at,rt),Ke=en(this,Ke,Vi),Kt=en(this,Kt,Xt),this.currentPath_.push({type:We,x:at.x,y:at.y,radius:Yt,xStart:Ke.x,yStart:Ke.y,xEnd:Kt.x,yEnd:Kt.y})},Ze.rect=function(at,rt,Yt,Kt){this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath()},Ze.strokeRect=function(at,rt,Yt,Kt){var Xt=this.currentPath_;this.beginPath(),this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath(),this.stroke(),this.currentPath_=Xt},Ze.fillRect=function(at,rt,Yt,Kt){var Xt=this.currentPath_;this.beginPath(),this.moveTo(at,rt),this.lineTo(at+Yt,rt),this.lineTo(at+Yt,rt+Kt),this.lineTo(at,rt+Kt),this.closePath(),this.fill(),this.currentPath_=Xt},Ze.createLinearGradient=function(at,rt,Yt,Kt){var Xt=new yo("gradient");return Xt.x0_=at,Xt.y0_=rt,Xt.x1_=Yt,Xt.y1_=Kt,Xt},Ze.createRadialGradient=function(at,rt,Yt,Kt,Xt,xe){var We=new yo("gradientradial");return We.x0_=at,We.y0_=rt,We.r0_=Yt,We.x1_=Kt,We.y1_=Xt,We.r1_=xe,We},Ze.drawImage=function(at,rt){var Yt,Kt,Xt,xe,We,Ke,Vi,$e;Xt=at.runtimeStyle.width,xe=at.runtimeStyle.height,at.runtimeStyle.width="auto",at.runtimeStyle.height="auto";var hi=at.width,ai=at.height;if(at.runtimeStyle.width=Xt,at.runtimeStyle.height=xe,3==arguments.length)Yt=arguments[1],Kt=arguments[2],We=Ke=0,Vi=Xt=hi,$e=xe=ai;else if(5==arguments.length)Yt=arguments[1],Kt=arguments[2],Xt=arguments[3],xe=arguments[4],We=Ke=0,Vi=hi,$e=ai;else{if(9!=arguments.length)throw Error("Invalid number of arguments");We=arguments[1],Ke=arguments[2],Vi=arguments[3],$e=arguments[4],Yt=arguments[5],Kt=arguments[6],Xt=arguments[7],xe=arguments[8]}var Qi=en(this,Yt,Kt),Pi=[];if(Pi.push(" <g_vml_:group",' coordsize="',10*Ri,",",10*Ri,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var Ei=[];Ei.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",zi(Qi.x/Ri),",","Dy=",zi(Qi.y/Ri),"");var ys=en(this,Yt+Xt,Kt),Hs=en(this,Yt,Kt+xe);Yt=en(this,Yt+Xt,Kt+xe),Qi.x=$n.max(Qi.x,ys.x,Hs.x,Yt.x),Qi.y=$n.max(Qi.y,ys.y,Hs.y,Yt.y),Pi.push("padding:0 ",zi(Qi.x/Ri),"px ",zi(Qi.y/Ri),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",Ei.join(""),", sizingmethod='clip');")}else Pi.push("top:",zi(Qi.y/Ri),"px;left:",zi(Qi.x/Ri),"px;");Pi.push(' ">','<g_vml_:image src="',at.src,'"',' style="width:',Ri*Xt,"px;"," height:",Ri*xe,'px"',' cropleft="',We/hi,'"',' croptop="',Ke/ai,'"',' cropright="',(hi-We-Vi)/hi,'"',' cropbottom="',(ai-Ke-$e)/ai,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",Pi.join(""))},Ze.stroke=function(at){var rt=[];rt.push("<g_vml_:shape",' filled="',!!at,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0,0"',' coordsize="',10*Ri,",",10*Ri,'"',' stroked="',!at,'"',' path="');for(var Yt={x:null,y:null},Kt={x:null,y:null},Xt=0;Xt<this.currentPath_.length;Xt++){var xe=this.currentPath_[Xt];switch(xe.type){case"moveTo":rt.push(" m ",zi(xe.x),",",zi(xe.y));break;case"lineTo":rt.push(" l ",zi(xe.x),",",zi(xe.y));break;case"close":rt.push(" x "),xe=null;break;case"bezierCurveTo":rt.push(" c ",zi(xe.cp1x),",",zi(xe.cp1y),",",zi(xe.cp2x),",",zi(xe.cp2y),",",zi(xe.x),",",zi(xe.y));break;case"at":case"wa":rt.push(" ",xe.type," ",zi(xe.x-this.arcScaleX_*xe.radius),",",zi(xe.y-this.arcScaleY_*xe.radius)," ",zi(xe.x+this.arcScaleX_*xe.radius),",",zi(xe.y+this.arcScaleY_*xe.radius)," ",zi(xe.xStart),",",zi(xe.yStart)," ",zi(xe.xEnd),",",zi(xe.yEnd))}xe&&((null==Yt.x||xe.x<Yt.x)&&(Yt.x=xe.x),(null==Kt.x||xe.x>Kt.x)&&(Kt.x=xe.x),(null==Yt.y||xe.y<Yt.y)&&(Yt.y=xe.y),(null==Kt.y||xe.y>Kt.y)&&(Kt.y=xe.y))}rt.push(' ">'),at?xi(this,rt,Yt,Kt):Li(this,rt),rt.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",rt.join(""))},Ze.fill=function(){this.stroke(!0)},Ze.closePath=function(){this.currentPath_.push({type:"close"})},Ze.save=function(){var at={};an(this,at),this.aStack_.push(at),this.mStack_.push(this.m_),this.m_=bi([[1,0,0],[0,1,0],[0,0,1]],this.m_)},Ze.restore=function(){this.aStack_.length&&(an(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},Ze.translate=function(at,rt){ro(this,bi([[1,0,0],[0,1,0],[at,rt,1]],this.m_),!1)},Ze.rotate=function(at){var rt=js(at);ro(this,bi([[rt,at=un(at),0],[-at,rt,0],[0,0,1]],this.m_),!1)},Ze.scale=function(at,rt){this.arcScaleX_*=at,this.arcScaleY_*=rt,ro(this,bi([[at,0,0],[0,rt,0],[0,0,1]],this.m_),!0)},Ze.transform=function(at,rt,Yt,Kt,Xt,xe){ro(this,bi([[at,rt,0],[Yt,Kt,0],[Xt,xe,1]],this.m_),!0)},Ze.setTransform=function(at,rt,Yt,Kt,Xt,xe){ro(this,[[at,rt,0],[Yt,Kt,0],[Xt,xe,1]],!0)},Ze.drawText_=function(at,rt,Yt,Kt,Xt){var xe=this.m_;Kt=0;var $e,We=1e3,Ke=0,Vi=[];if(oe[$e=this.font])$e=oe[$e];else{var hi=document.createElement("div").style;try{hi.font=$e}catch{}$e=oe[$e]={style:hi.fontStyle||"normal",variant:hi.fontVariant||"normal",weight:hi.fontWeight||"normal",size:hi.fontSize||10,family:hi.fontFamily||"sans-serif"}}hi=$e;var ai=this.element_;for(var Qi in $e={},hi)$e[Qi]=hi[Qi];switch(Qi=parseFloat(ai.currentStyle.fontSize),ai=parseFloat(hi.size),$e.size="number"==typeof hi.size?hi.size:-1!=hi.size.indexOf("px")?ai:-1!=hi.size.indexOf("em")?Qi*ai:-1!=hi.size.indexOf("%")?Qi/100*ai:-1!=hi.size.indexOf("pt")?ai/.75:Qi,$e.size*=.981,Qi=$e.style+" "+$e.variant+" "+$e.weight+" "+$e.size+"px "+$e.family,ai=this.element_.currentStyle,hi=this.textAlign.toLowerCase()){case"left":case"center":case"right":break;case"end":hi="ltr"==ai.direction?"right":"left";break;case"start":hi="rtl"==ai.direction?"right":"left";break;default:hi="left"}switch(this.textBaseline){case"hanging":case"top":Ke=$e.size/1.75;break;case"middle":break;default:Ke=-$e.size/2.25}switch(hi){case"right":Kt=1e3,We=.05;break;case"center":Kt=We=500}rt=en(this,rt+0,Yt+Ke),Vi.push('<g_vml_:line from="',-Kt,' 0" to="',We,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!Xt,'" stroked="',!!Xt,'" style="position:absolute;width:1px;height:1px;">'),Xt?Li(this,Vi):xi(this,Vi,{x:-Kt,y:0},{x:We,y:$e.size}),Xt=xe[0][0].toFixed(3)+","+xe[1][0].toFixed(3)+","+xe[0][1].toFixed(3)+","+xe[1][1].toFixed(3)+",0,0",rt=zi(rt.x/Ri)+","+zi(rt.y/Ri),Vi.push('<g_vml_:skew on="t" matrix="',Xt,'" ',' offset="',rt,'" origin="',Kt,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',b(at),'" style="v-text-align:',hi,";font:",b(Qi),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",Vi.join(""))},Ze.fillText=function(at,rt,Yt,Kt){this.drawText_(at,rt,Yt,Kt,!1)},Ze.strokeText=function(at,rt,Yt,Kt){this.drawText_(at,rt,Yt,Kt,!0)},Ze.measureText=function(at){this.textMeasureEl_||(this.element_.insertAdjacentHTML("beforeEnd",'<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>'),this.textMeasureEl_=this.element_.lastChild);var rt=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(rt.createTextNode(at)),{width:this.textMeasureEl_.offsetWidth}},Ze.clip=function(){},Ze.arcTo=function(){},Ze.createPattern=function(at,rt){return new Xi(at,rt)},yo.prototype.addColorStop=function(at,rt){rt=Yo(rt),this.colors_.push({offset:at,color:rt.color,alpha:rt.alpha})},(Ze=cn.prototype=Error()).INDEX_SIZE_ERR=1,Ze.DOMSTRING_SIZE_ERR=2,Ze.HIERARCHY_REQUEST_ERR=3,Ze.WRONG_DOCUMENT_ERR=4,Ze.INVALID_CHARACTER_ERR=5,Ze.NO_DATA_ALLOWED_ERR=6,Ze.NO_MODIFICATION_ALLOWED_ERR=7,Ze.NOT_FOUND_ERR=8,Ze.NOT_SUPPORTED_ERR=9,Ze.INUSE_ATTRIBUTE_ERR=10,Ze.INVALID_STATE_ERR=11,Ze.SYNTAX_ERR=12,Ze.INVALID_MODIFICATION_ERR=13,Ze.NAMESPACE_ERR=14,Ze.INVALID_ACCESS_ERR=15,Ze.VALIDATION_ERR=16,Ze.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=ln,CanvasRenderingContext2D=tn,CanvasGradient=yo,CanvasPattern=Xi,DOMException=cn}()},158:function(Qa){Qa.exports=function(){"use strict";var _l,ia,ss;function On(b,De){if(_l)if(ia){var ho="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+_l+")(sharedChunk); ("+ia+")(sharedChunk); self.onerror = null;",ks={};_l(ks),ss=De(ks),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(ss.workerUrl=window.URL.createObjectURL(new Blob([ho],{type:"text/javascript"})))}else ia=De;else _l=De}return On(0,function(b){var De=typeof self<"u"?self:{},ho="2.14.1";let ks;const pn={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==ks){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ks=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):r}catch{ks=r}}return ks},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!pn.API_URL)return null;try{const r=new URL(pn.API_URL);return"api.mapbox.cn"===r.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===r.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},bi={supported:!1,testSupport:function(r){!Et&&$t&&(fo?Yo(r):an=r)}};let an,$t,Et=!1,fo=!1;function Yo(r){const s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,$t),r.isContextLost())return;bi.supported=!0}catch{}r.deleteTexture(s),Et=!0}De.document&&($t=De.document.createElement("img"),$t.onload=function(){an&&Yo(an),an=null,fo=!0},$t.onerror=function(){Et=!0,an=null},$t.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tn="01";var Ti=Li;function Li(r,s,l,p){this.cx=3*r,this.bx=3*(l-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(p-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=l,this.p2y=p}Li.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(void 0===s&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var l=r,p=0;p<8;p++){var v=this.sampleCurveX(l)-r;if(Math.abs(v)<s)return l;var A=this.sampleCurveDerivativeX(l);if(Math.abs(A)<1e-6)break;l-=v/A}var F=0,N=1;for(l=r,p=0;p<20&&(v=this.sampleCurveX(l),!(Math.abs(v-r)<s));p++)r>v?F=l:N=l,l=.5*(N-F)+F;return l},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}};var xi=en;function en(r,s){this.x=r,this.y=s}en.prototype={clone:function(){return new en(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,s){return this.clone()._rotateAround(r,s)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var s=r.x-this.x,l=r.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,s){return Math.atan2(this.x*s-this.y*r,this.x*r+this.y*s)},_matMult:function(r){var s=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=s,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var s=Math.cos(r),l=Math.sin(r),p=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=p,this},_rotateAround:function(r,s){var l=Math.cos(r),p=Math.sin(r),v=s.y+p*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-p*(this.y-s.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},en.convert=function(r){return r instanceof en?r:Array.isArray(r)?new en(r[0],r[1]):r};const ro=Math.PI/180,yo=180/Math.PI;function Xi(r){return r*ro}function cn(r){return r*yo}const $n=[[0,0],[1,0],[1,1],[0,1]];function zi(r){if(r<=0)return 0;if(r>=1)return 1;const s=r*r,l=s*r;return 4*(r<.5?l:3*(r-s)+l-.75)}function un(r,s,l,p){const v=new Ti(r,s,l,p);return function(A){return v.solve(A)}}const js=un(.25,.1,.25,1);function Wi(r,s,l){return Math.min(l,Math.max(s,r))}function As(r,s,l){return(l=Wi((l-r)/(s-r),0,1))*l*(3-2*l)}function Ri(r,s,l){const p=l-s,v=((r-s)%p+p)%p+s;return v===s?l:v}function Us(r,s,l){if(!r.length)return l(null,[]);let p=r.length;const v=new Array(r.length);let A=null;r.forEach((F,N)=>{s(F,(U,H)=>{U&&(A=U),v[N]=H,0==--p&&l(A,v)})})}function fn(r){const s=[];for(const l in r)s.push(r[l]);return s}function ln(r,...s){for(const l of s)for(const p in l)r[p]=l[p];return r}let En=1;function ao(){return En++}function Ys(){return function r(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Mn(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function oe(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function Ls(r,s){r.forEach(l=>{s[l]&&(s[l]=s[l].bind(s))})}function Ze(r,s){return-1!==r.indexOf(s,r.length-s.length)}function at(r,s,l){const p={};for(const v in r)p[v]=s.call(l||this,r[v],v,r);return p}function rt(r,s,l){const p={};for(const v in r)s.call(l||this,r[v],v,r)&&(p[v]=r[v]);return p}function Yt(r){return Array.isArray(r)?r.map(Yt):"object"==typeof r&&r?at(r,Yt):r}const Kt={};function Xt(r){Kt[r]||(typeof console<"u"&&console.warn(r),Kt[r]=!0)}function xe(r,s,l){return(l.y-r.y)*(s.x-r.x)>(s.y-r.y)*(l.x-r.x)}function We(r){let s=0;for(let l,p,v=0,A=r.length,F=A-1;v<A;F=v++)l=r[v],p=r[F],s+=(p.x-l.x)*(l.y+p.y);return s}function Ke(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Vi(r){const s={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,v,A)=>{const F=v||A;return s[p]=!F||F.toLowerCase(),""}),s["max-age"]){const l=parseInt(s["max-age"],10);isNaN(l)?delete s["max-age"]:s["max-age"]=l}return s}let $e=null;function hi(r){if(null==$e){const s=r.navigator?r.navigator.userAgent:null;$e=!!r.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return $e}function ai(r){try{const s=De[r];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function Qi(r,s){return[r[4*s],r[4*s+1],r[4*s+2],r[4*s+3]]}const Pi="mapbox-tiles";let Ei,ys,Hs=500,In=50;function Sr(){try{return De.caches}catch{}}function Lr(){Sr()&&!Ei&&(Ei=De.caches.open(Pi))}function _o(r){const s=r.indexOf("?");if(s<0)return r;const p=function(v){const A=v.indexOf("?");return A>0?v.slice(A+1).split("&"):[]}(r).filter(v=>{const A=v.split("=");return"language"===A[0]||"worldview"===A[0]});return p.length?`${r.slice(0,s)}?${p.join("&")}`:r.slice(0,s)}let La=1/0;const Ps={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ps);class $s extends Error{constructor(s,l,p){401===l&&ut(p)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=l,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Zo=Ke()?()=>self.worker&&self.worker.referrer:()=>("blob:"===De.location.protocol?De.parent:De).location.href,Es=function(r,s){if(!(/^file:/.test(l=r.url)||/^file:/.test(Zo())&&!/^\w+:/.test(l))){if(De.fetch&&De.Request&&De.AbortController&&De.Request.prototype.hasOwnProperty("signal"))return function(p,v){const A=new De.AbortController,F=new De.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:Zo(),referrerPolicy:p.referrerPolicy,signal:A.signal});let N=!1,U=!1;const H=(K=F.url).indexOf("sku=")>0&&ut(K);var K;"json"===p.type&&F.headers.set("Accept","application/json");const et=(ft,_t,St)=>{if(U)return;if(ft&&"SecurityError"!==ft.message&&Xt(ft),_t&&St)return ot(_t);const Lt=Date.now();De.fetch(F).then(Zt=>{if(Zt.ok){const he=H?Zt.clone():null;return ot(Zt,he,Lt)}return v(new $s(Zt.statusText,Zt.status,p.url))}).catch(Zt=>{"AbortError"!==Zt.name&&v(new Error(`${Zt.message} ${p.url}`))})},ot=(ft,_t,St)=>{("arrayBuffer"===p.type?ft.arrayBuffer():"json"===p.type?ft.json():ft.text()).then(Lt=>{U||(_t&&St&&function(Zt,he,Ut){if(Lr(),!Ei)return;const ae={status:he.status,statusText:he.statusText,headers:new De.Headers};he.headers.forEach((Ce,ke)=>ae.headers.set(ke,Ce));const de=Vi(he.headers.get("Cache-Control")||"");if(de["no-store"])return;de["max-age"]&&ae.headers.set("Expires",new Date(Ut+1e3*de["max-age"]).toUTCString());const ce=ae.headers.get("Expires");ce&&(new Date(ce).getTime()-Ut<42e4||function(Ce,ke){if(void 0===ys)try{new Response(new ReadableStream),ys=!0}catch{ys=!1}ys?ke(Ce.body):Ce.blob().then(ke)}(he,Ce=>{const ke=new De.Response(Ce,ae);Lr(),Ei&&Ei.then(je=>je.put(_o(Zt.url),ke)).catch(je=>Xt(je.message))}))}(F,_t,St),N=!0,v(null,Lt,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(Lt=>{U||v(new Error(Lt.message))})};return H?function(ft,_t){if(Lr(),!Ei)return _t(null);const St=_o(ft.url);Ei.then(Lt=>{Lt.match(St).then(Zt=>{const he=function(Ut){if(!Ut)return!1;const ae=new Date(Ut.headers.get("Expires")||0),de=Vi(Ut.headers.get("Cache-Control")||"");return ae>Date.now()&&!de["no-cache"]}(Zt);Lt.delete(St),he&&Lt.put(St,Zt.clone()),_t(null,Zt,he)}).catch(_t)}).catch(_t)}(F,et):et(null,null),{cancel:()=>{U=!0,N||A.abort()}}}(r,s);if(Ke()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,s,void 0,!0)}var l;return function(p,v){const A=new De.XMLHttpRequest;A.open(p.method||"GET",p.url,!0),"arrayBuffer"===p.type&&(A.responseType="arraybuffer");for(const F in p.headers)A.setRequestHeader(F,p.headers[F]);return"json"===p.type&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials="include"===p.credentials,A.onerror=()=>{v(new Error(A.statusText))},A.onload=()=>{if((A.status>=200&&A.status<300||0===A.status)&&null!==A.response){let F=A.response;if("json"===p.type)try{F=JSON.parse(A.response)}catch(N){return v(N)}v(null,F,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else v(new $s(A.statusText,A.status,p.url))},A.send(p.body),{cancel:()=>A.abort()}}(r,s)},Gn=function(r,s){return Es(ln(r,{type:"arrayBuffer"}),s)};function ls(r){const s=De.document.createElement("a");return s.href=r,s.protocol===De.document.location.protocol&&s.host===De.document.location.host}const ps="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let co,Br;co=[],Br=0;const Js=function(r,s){if(bi.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Br>=pn.MAX_PARALLEL_IMAGE_REQUESTS){const A={requestParameters:r,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return co.push(A),A}Br++;let l=!1;const p=()=>{if(!l)for(l=!0,Br--;co.length&&Br<pn.MAX_PARALLEL_IMAGE_REQUESTS;){const A=co.shift(),{requestParameters:F,callback:N,cancelled:U}=A;U||(A.cancel=Js(F,N).cancel)}},v=Gn(r,(A,F,N,U)=>{p(),A?s(A):F&&(De.createImageBitmap?function(H,K){const et=new De.Blob([new Uint8Array(H)],{type:"image/png"});De.createImageBitmap(et).then(ot=>{K(null,ot)}).catch(ot=>{K(new Error(`Could not load image because of ${ot.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(F,(H,K)=>s(H,K,N,U)):function(H,K){const et=new De.Image,ot=De.URL;et.onload=()=>{K(null,et),ot.revokeObjectURL(et.src),et.onload=null,De.requestAnimationFrame(()=>{et.src=ps})},et.onerror=()=>K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ft=new De.Blob([new Uint8Array(H)],{type:"image/png"});et.src=H.byteLength?ot.createObjectURL(ft):ps}(F,(H,K)=>s(H,K,N,U)))});return{cancel:()=>{v.cancel(),p()}}},is="NO_ACCESS_TOKEN";function Vs(r){return 0===r.indexOf("mapbox:")}function ut(r){return pn.API_URL_REGEX.test(r)}function Ct(r){return pn.API_CDN_URL_REGEX.test(r)}function Vt(r){return pn.API_STYLE_REGEX.test(r)&&!Le(r)}function Le(r){return pn.API_SPRITE_REGEX.test(r)}const ri=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mi(r){const s=r.match(ri);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Q(r){const s=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${s}`}function xt(r){if(!r)return null;const s=r.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(De.atob(s[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Pt{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const l=xt(pn.ACCESS_TOKEN);let p="";return p=l&&l.u?De.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(v,A)=>String.fromCharCode(Number("0x"+A)))):pn.ACCESS_TOKEN||"",s?`mapbox.eventData.${s}:${p}`:`mapbox.eventData:${p}`}fetchEventData(){const s=ai("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(s)try{const v=De.localStorage.getItem(l);v&&(this.eventData=JSON.parse(v));const A=De.localStorage.getItem(p);A&&(this.anonId=A)}catch{Xt("Unable to read from LocalStorage")}}saveEventData(){const s=ai("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(s)try{De.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&De.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{Xt("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,l,p,v){if(!pn.EVENTS_URL)return;const A=mi(pn.EVENTS_URL);A.params.push(`access_token=${v||pn.ACCESS_TOKEN||""}`);const F={event:this.type,created:new Date(s).toISOString()},N=l?ln(F,l):F,U={url:Q(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([N])};var K;this.pendingRequest=(K=H=>{this.pendingRequest=null,p(H),this.saveEventData(),this.processRequests(v)},Es(ln(U,{method:"POST"}),K))}queueRequest(s,l){this.queue.push(s),this.processRequests(l)}}const yt=new class extends Pt{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,s){pn.EVENTS_URL&&pn.ACCESS_TOKEN&&Array.isArray(r)&&r.some(l=>Vs(l)||ut(l))&&this.queueRequest(Date.now(),s)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=xt(pn.ACCESS_TOKEN),l=s?s.u:pn.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;oe(this.anonId)||(this.anonId=Ys(),p=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),F=new Date(v),N=(v-this.eventData.lastSuccess)/864e5;p=p||N>=1||N<-1||A.getDate()!==F.getDate()}else p=!0;p?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ho,skuId:tn,"enabled.telemetry":!1,userId:this.anonId},A=>{A||(this.eventData.lastSuccess=v,this.eventData.tokenU=l)},r):this.processRequests()}},ct=yt.postTurnstileEvent.bind(yt),pt=new class extends Pt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,s,l,p){this.skuToken=s,this.errorCb=p,pn.EVENTS_URL&&(l||pn.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},l):this.errorCb(new Error(is)))}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:l}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),oe(this.anonId)||(this.anonId=Ys()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ho,skuId:tn,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):s&&(this.success[s]=!0)},r))}},wt=pt.postMapLoadEvent.bind(pt),It=new class extends Pt{constructor(){super("gljs.performance")}postPerformanceEvent(r,s){pn.EVENTS_URL&&(r||pn.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},r)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:l}=this.queue.shift(),p=function(v){const A=De.performance.getEntriesByType("resource"),F=De.performance.getEntriesByType("mark"),N=function(ot){const ft={};if(ot)for(const _t in ot)if("other"!==_t)for(const St of ot[_t]){const Lt=`${_t}ResolveRangeMin`,Zt=`${_t}ResolveRangeMax`,he=`${_t}RequestCount`,Ut=`${_t}RequestCachedCount`;ft[Lt]=Math.min(ft[Lt]||1/0,St.startTime),ft[Zt]=Math.max(ft[Zt]||-1/0,St.responseEnd);const ae=de=>{void 0===ft[de]&&(ft[de]=0),++ft[de]};void 0!==St.transferSize&&0===St.transferSize&&ae(Ut),ae(he)}return ft}(function(ot,ft){const _t={};if(ot)for(const St of ot){const Lt=ft(St);void 0===_t[Lt]&&(_t[Lt]=[]),_t[Lt].push(St)}return _t}(A,g)),U=De.devicePixelRatio,H=De.navigator.connection||De.navigator.mozConnection||De.navigator.webkitConnection,K={counters:[],metadata:[],attributes:[]},et=(ot,ft,_t)=>{null!=_t&&ot.push({name:ft,value:_t.toString()})};for(const ot in N)et(K.counters,ot,N[ot]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(et(K.counters,"interactionRangeMin",v.interactionRange[0]),et(K.counters,"interactionRangeMax",v.interactionRange[1])),F)for(const ot of Object.keys(u)){const ft=u[ot],_t=F.find(St=>St.name===ft);_t&&et(K.counters,ft,_t.startTime)}return et(K.counters,"visibilityHidden",v.visibilityHidden),et(K.attributes,"style",function(ot){if(ot)for(const ft of ot){const _t=ft.name.split("?")[0];if(Vt(_t)){const St=_t.split("/").slice(-2);if(2===St.length)return`mapbox://styles/${St[0]}/${St[1]}`}}}(A)),et(K.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),et(K.attributes,"fogEnabled",v.fogEnabled?"true":"false"),et(K.attributes,"projection",v.projection),et(K.attributes,"zoom",v.zoom),et(K.metadata,"devicePixelRatio",U),et(K.metadata,"connectionEffectiveType",H?H.effectiveType:void 0),et(K.metadata,"navigatorUserAgent",De.navigator.userAgent),et(K.metadata,"screenWidth",De.screen.width),et(K.metadata,"screenHeight",De.screen.height),et(K.metadata,"windowWidth",De.innerWidth),et(K.metadata,"windowHeight",De.innerHeight),et(K.metadata,"mapWidth",v.width/U),et(K.metadata,"mapHeight",v.height/U),et(K.metadata,"webglRenderer",v.renderer),et(K.metadata,"webglVendor",v.vendor),et(K.metadata,"sdkVersion",ho),et(K.metadata,"sdkIdentifier","mapbox-gl-js"),K}(l);for(const v of p.metadata);for(const v of p.counters);for(const v of p.attributes);this.postEvent(s,p,()=>{},r)}},Gt=It.postPerformanceEvent.bind(It),re=new class extends Pt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,s,l,p){if(!pn.API_URL||!pn.SESSION_PATH)return;const v=mi(pn.API_URL+pn.SESSION_PATH);v.params.push(`sku=${s||""}`),v.params.push(`access_token=${p||pn.ACCESS_TOKEN||""}`);const A={url:Q(v),headers:{"Content-Type":"text/plain"}};var N;this.pendingRequest=(N=F=>{this.pendingRequest=null,l(F),this.saveEventData(),this.processRequests(p)},Es(ln(A,{method:"GET"}),N))}getSessionAPI(r,s,l,p){this.skuToken=s,this.errorCb=p,pn.SESSION_PATH&&pn.API_URL&&(l||pn.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},l):this.errorCb(new Error(is)))}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:l}=this.queue.shift();s&&this.success[s]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):s&&(this.success[s]=!0)},r)}},te=re.getSessionAPI.bind(re),ie=new Set,u={create:"create",load:"load",fullLoad:"fullLoad"},I={mark(r){De.performance.mark(r)},measure(r,s,l){De.performance.measure(r,s,l)}};function g(r){const s=r.name.split("?")[0];return Ct(s)&&s.includes("mapbox-gl.js")?"javascript":Ct(s)&&s.includes("mapbox-gl.css")?"css":pn.API_FONTS_REGEX.test(s)?"fontRange":Le(s)?"sprite":Vt(s)?"style":pn.API_TILEJSON_REGEX.test(s)?"tilejson":"other"}const x=De.performance;function w(r){const s=r?r.url.toString():void 0;return x.getEntriesByName(s)}let D,o,y,f;const c={now:()=>void 0!==y?y:De.performance.now(),setNow(r){y=r},restoreNow(){y=void 0},frame(r){const s=De.requestAnimationFrame(r);return{cancel:()=>De.cancelAnimationFrame(s)}},getImageData(r,s=0){const{width:l,height:p}=r;f||(f=De.document.createElement("canvas"));const v=f.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(l>f.width||p>f.height)&&(f.width=l,f.height=p),v.clearRect(-s,-s,l+2*s,p+2*s),v.drawImage(r,0,0,l,p),v.getImageData(-s,-s,l+2*s,p+2*s)},resolveURL:r=>(D||(D=De.document.createElement("a")),D.href=r,D.href),get devicePixelRatio(){return De.devicePixelRatio},get prefersReducedMotion(){return!!De.matchMedia&&(null==o&&(o=De.matchMedia("(prefers-reduced-motion: reduce)")),o.matches)}};function d(r,s,l){l[r]&&-1!==l[r].indexOf(s)||(l[r]=l[r]||[],l[r].push(s))}function M(r,s,l){if(l&&l[r]){const p=l[r].indexOf(s);-1!==p&&l[r].splice(p,1)}}class k{constructor(s,l={}){ln(this,l),this.type=s}}class C extends k{constructor(s,l={}){super("error",ln({error:s},l))}}class R{on(s,l){return this._listeners=this._listeners||{},d(s,l,this._listeners),this}off(s,l){return M(s,l,this._listeners),M(s,l,this._oneTimeListeners),this}once(s,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},d(s,l,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,l){"string"==typeof s&&(s=new k(s,l||{}));const p=s.type;if(this.listens(p)){s.target=this;const v=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const N of v)N.call(this,s);const A=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const N of A)M(p,N,this._oneTimeListeners),N.call(this,s);const F=this._eventedParent;F&&(ln(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),F.fire(s))}else s instanceof C&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,l){return this._eventedParent=s,this._eventedParentData=l,this}}var B=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function O(r,...s){for(const l of s)for(const p in l)r[p]=l[p];return r}function L(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function X(r){if(Array.isArray(r))return r.map(X);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const s={};for(const l in r)s[l]=X(r[l]);return s}return L(r)}class E extends Error{constructor(s,l){super(l),this.message=l,this.key=s}}var Y=E;class it{constructor(s,l=[]){this.parent=s,this.bindings={};for(const[p,v]of l)this.bindings[p]=v}concat(s){return new it(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var J=it;const q={kind:"null"},nt={kind:"number"},dt={kind:"string"},gt={kind:"boolean"},kt={kind:"color"},mt={kind:"object"},Tt={kind:"value"},ee={kind:"collator"},Ft={kind:"formatted"},vt={kind:"resolvedImage"};function le(r,s){return{kind:"array",itemType:r,N:s}}function Ht(r){if("array"===r.kind){const s=Ht(r.itemType);return"number"==typeof r.N?`array<${s}, ${r.N}>`:"value"===r.itemType.kind?"array":`array<${s}>`}return r.kind}const jt=[q,nt,dt,gt,kt,Ft,mt,le(Tt),vt];function ye(r,s){if("error"===s.kind)return null;if("array"===r.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!ye(r.itemType,s.itemType))&&("number"!=typeof r.N||r.N===s.N))return null}else{if(r.kind===s.kind)return null;if("value"===r.kind)for(const l of jt)if(!ye(l,s))return null}return`Expected ${Ht(r)} but found ${Ht(s)} instead.`}function Rt(r,s){return s.some(l=>l.kind===r.kind)}function se(r,s){return s.some(l=>"null"===l?null===r:"array"===l?Array.isArray(r):"object"===l?r&&!Array.isArray(r)&&"object"==typeof r:l===typeof r)}var Ue,ni={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function li(r){return(r=Math.round(r))<0?0:r>255?255:r}function $i(r){return li("%"===r[r.length-1]?parseFloat(r)/100*255:parseInt(r))}function wi(r){return(s="%"===r[r.length-1]?parseFloat(r)/100:parseFloat(r))<0?0:s>1?1:s;var s}function wn(r,s,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?r+(s-r)*l*6:2*l<1?s:3*l<2?r+(s-r)*(2/3-l)*6:r}try{Ue={}.parseCSSColor=function(r){var s,l=r.replace(/ /g,"").toLowerCase();if(l in ni)return ni[l].slice();if("#"===l[0])return 4===l.length?(s=parseInt(l.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===l.length&&(s=parseInt(l.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var p=l.indexOf("("),v=l.indexOf(")");if(-1!==p&&v+1===l.length){var A=l.substr(0,p),F=l.substr(p+1,v-(p+1)).split(","),N=1;switch(A){case"rgba":if(4!==F.length)return null;N=wi(F.pop());case"rgb":return 3!==F.length?null:[$i(F[0]),$i(F[1]),$i(F[2]),N];case"hsla":if(4!==F.length)return null;N=wi(F.pop());case"hsl":if(3!==F.length)return null;var U=(parseFloat(F[0])%360+360)%360/360,H=wi(F[1]),K=wi(F[2]),et=K<=.5?K*(H+1):K+H-K*H,ot=2*K-et;return[li(255*wn(ot,et,U+1/3)),li(255*wn(ot,et,U)),li(255*wn(ot,et,U-1/3)),N];default:return null}}return null}}catch{}class Ni{constructor(s,l,p,v=1){this.r=s,this.g=l,this.b=p,this.a=v}static parse(s){if(!s)return;if(s instanceof Ni)return s;if("string"!=typeof s)return;const l=Ue(s);return l?new Ni(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[s,l,p,v]=this.toArray();return`rgba(${Math.round(s)},${Math.round(l)},${Math.round(p)},${v})`}toArray(){const{r:s,g:l,b:p,a:v}=this;return 0===v?[0,0,0,0]:[255*s/v,255*l/v,255*p/v,v]}toArray01(){const{r:s,g:l,b:p,a:v}=this;return 0===v?[0,0,0,0]:[s/v,l/v,p/v,v]}toArray01PremultipliedAlpha(){const{r:s,g:l,b:p,a:v}=this;return[s,l,p,v]}}Ni.black=new Ni(0,0,0,1),Ni.white=new Ni(1,1,1,1),Ni.transparent=new Ni(0,0,0,0),Ni.red=new Ni(1,0,0,1),Ni.blue=new Ni(0,0,1,1);var ji=Ni;class _e{constructor(s,l,p){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,l){return this.collator.compare(s,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class os{constructor(s,l,p,v,A){this.text=s.normalize?s.normalize():s,this.image=l,this.scale=p,this.fontStack=v,this.textColor=A}}class yn{constructor(s){this.sections=s}static fromString(s){return new yn([new os(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof yn?s:yn.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const l of this.sections){if(l.image){s.push(["image",l.image.name]);continue}s.push(l.text);const p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),s.push(p)}return s}}class Zn{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Zn({name:s,available:!1}):null}serialize(){return["image",this.name]}}function Qe(r,s,l,p){return"number"==typeof r&&r>=0&&r<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===p||"number"==typeof p&&p>=0&&p<=1?null:`Invalid rgba value [${[r,s,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof p?[r,s,l,p]:[r,s,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function qe(r){if(null===r||"string"==typeof r||"boolean"==typeof r||"number"==typeof r||r instanceof ji||r instanceof _e||r instanceof yn||r instanceof Zn)return!0;if(Array.isArray(r)){for(const s of r)if(!qe(s))return!1;return!0}if("object"==typeof r){for(const s in r)if(!qe(r[s]))return!1;return!0}return!1}function fe(r){if(null===r)return q;if("string"==typeof r)return dt;if("boolean"==typeof r)return gt;if("number"==typeof r)return nt;if(r instanceof ji)return kt;if(r instanceof _e)return ee;if(r instanceof yn)return Ft;if(r instanceof Zn)return vt;if(Array.isArray(r)){const s=r.length;let l;for(const p of r){const v=fe(p);if(l){if(l===v)continue;l=Tt;break}l=v}return le(l||Tt,s)}return mt}function Rn(r){const s=typeof r;return null===r?"":"string"===s||"number"===s||"boolean"===s?String(r):r instanceof ji||r instanceof yn||r instanceof Zn?r.toString():JSON.stringify(r)}class pi{constructor(s,l){this.type=s,this.value=l}static parse(s,l){if(2!==s.length)return l.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!qe(s[1]))return l.error("invalid value");const p=s[1];let v=fe(p);const A=l.expectedType;return"array"!==v.kind||0!==v.N||!A||"array"!==A.kind||"number"==typeof A.N&&0!==A.N||(v=A),new pi(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ji?["rgba"].concat(this.value.toArray()):this.value instanceof yn?this.value.serialize():this.value}}var mn=pi,ze=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Re={string:dt,number:nt,boolean:gt,object:mt};class ve{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let p,v=1;const A=s[0];if("array"===A){let N,U;if(s.length>2){const H=s[1];if("string"!=typeof H||!(H in Re)||"object"===H)return l.error('The item type argument of "array" must be one of string, number, boolean',1);N=Re[H],v++}else N=Tt;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);U=s[2],v++}p=le(N,U)}else p=Re[A];const F=[];for(;v<s.length;v++){const N=l.parse(s[v],v,Tt);if(!N)return null;F.push(N)}return new ve(p,F)}evaluate(s){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(s);if(!ye(this.type,fe(p)))return p;if(l===this.args.length-1)throw new ze(`Expected value to be of type ${Ht(this.type)}, but found ${Ht(fe(p))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,l=[s.kind];if("array"===s.kind){const p=s.itemType;if("string"===p.kind||"number"===p.kind||"boolean"===p.kind){l.push(p.kind);const v=s.N;("number"==typeof v||this.args.length>1)&&l.push(v)}}return l.concat(this.args.map(p=>p.serialize()))}}var Zi=ve;class ui{constructor(s){this.type=Ft,this.sections=s}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&"object"==typeof p)return l.error("First argument must be an image or text section.");const v=[];let A=!1;for(let F=1;F<=s.length-1;++F){const N=s[F];if(A&&"object"==typeof N&&!Array.isArray(N)){A=!1;let U=null;if(N["font-scale"]&&(U=l.parse(N["font-scale"],1,nt),!U))return null;let H=null;if(N["text-font"]&&(H=l.parse(N["text-font"],1,le(dt)),!H))return null;let K=null;if(N["text-color"]&&(K=l.parse(N["text-color"],1,kt),!K))return null;const et=v[v.length-1];et.scale=U,et.font=H,et.textColor=K}else{const U=l.parse(s[F],1,Tt);if(!U)return null;const H=U.type.kind;if("string"!==H&&"value"!==H&&"null"!==H&&"resolvedImage"!==H)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");A=!0,v.push({content:U,scale:null,font:null,textColor:null})}}return new ui(v)}evaluate(s){return new yn(this.sections.map(l=>{const p=l.content.evaluate(s);return fe(p)===vt?new os("",p,null,null,null):new os(Rn(p),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null)}))}eachChild(s){for(const l of this.sections)s(l.content),l.scale&&s(l.scale),l.font&&s(l.font),l.textColor&&s(l.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const l of this.sections){s.push(l.content.serialize());const p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),s.push(p)}return s}}class Ii{constructor(s){this.type=vt,this.input=s}static parse(s,l){if(2!==s.length)return l.error("Expected two arguments.");const p=l.parse(s[1],1,dt);return p?new Ii(p):l.error("No image name provided.")}evaluate(s){const l=this.input.evaluate(s),p=Zn.fromString(l);return p&&s.availableImages&&(p.available=s.availableImages.indexOf(l)>-1),p}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ne={"to-boolean":gt,"to-color":kt,"to-number":nt,"to-string":dt};class Ui{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[0];if(("to-boolean"===p||"to-string"===p)&&2!==s.length)return l.error("Expected one argument.");const v=Ne[p],A=[];for(let F=1;F<s.length;F++){const N=l.parse(s[F],F,Tt);if(!N)return null;A.push(N)}return new Ui(v,A)}evaluate(s){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(s));if("color"===this.type.kind){let l,p;for(const v of this.args){if(l=v.evaluate(s),p=null,l instanceof ji)return l;if("string"==typeof l){const A=s.parseColor(l);if(A)return A}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Qe(l[0],l[1],l[2],l[3]),!p))return new ji(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new ze(p||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const p of this.args){if(l=p.evaluate(s),null===l)return 0;const v=Number(l);if(!isNaN(v))return v}throw new ze(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?yn.fromString(Rn(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?Zn.fromString(Rn(this.args[0].evaluate(s))):Rn(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if("formatted"===this.type.kind)return new ui([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ii(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(l=>{s.push(l.serialize())}),s}}var Te=Ui;const Ki=["Unknown","Point","LineString","Polygon"];var Vn=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ki[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:l,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*s-r[0])+this.featureDistanceData.bearing[1]*(p*s-r[1])}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=ji.parse(r)),s}};class bn{constructor(s,l,p,v){this.name=s,this.type=l,this._evaluate=p,this.args=v}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,l){const p=s[0],v=bn.definitions[p];if(!v)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const A=Array.isArray(v)?v[0]:v.type,F=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,N=F.filter(([H])=>!Array.isArray(H)||H.length===s.length-1);let U=null;for(const[H,K]of N){U=new Mu(l.registry,l.path,null,l.scope);const et=[];let ot=!1;for(let ft=1;ft<s.length;ft++){const _t=s[ft],St=Array.isArray(H)?H[ft-1]:H.type,Lt=U.parse(_t,1+et.length,St);if(!Lt){ot=!0;break}et.push(Lt)}if(!ot)if(Array.isArray(H)&&H.length!==et.length)U.error(`Expected ${H.length} arguments, but found ${et.length} instead.`);else{for(let ft=0;ft<et.length;ft++){const _t=Array.isArray(H)?H[ft]:H.type,St=et[ft];U.concat(ft+1).checkSubtype(_t,St.type)}if(0===U.errors.length)return new bn(p,A,K,et)}}if(1===N.length)l.errors.push(...U.errors);else{const H=(N.length?N:F).map(([et])=>{return ot=et,Array.isArray(ot)?`(${ot.map(Ht).join(", ")})`:`(${Ht(ot.type)}...)`;var ot}).join(" | "),K=[];for(let et=1;et<s.length;et++){const ot=l.parse(s[et],1+K.length);if(!ot)return null;K.push(Ht(ot.type))}l.error(`Expected arguments of type ${H}, but found (${K.join(", ")}) instead.`)}return null}static register(s,l){bn.definitions=l;for(const p in l)s[p]=bn}}var Di=bn;class Mi{constructor(s,l,p){this.type=ee,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=l}static parse(s,l){if(2!==s.length)return l.error("Expected one argument.");const p=s[1];if("object"!=typeof p||Array.isArray(p))return l.error("Collator options argument must be an object.");const v=l.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,gt);if(!v)return null;const A=l.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,gt);if(!A)return null;let F=null;return p.locale&&(F=l.parse(p.locale,1,dt),!F)?null:new Mi(v,A,F)}evaluate(s){return new _e(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const _i=8192;function Tn(r,s){r[0]=Math.min(r[0],s[0]),r[1]=Math.min(r[1],s[1]),r[2]=Math.max(r[2],s[0]),r[3]=Math.max(r[3],s[1])}function uo(r,s){return!(r[0]<=s[0]||r[2]>=s[2]||r[1]<=s[1]||r[3]>=s[3])}function zo(r,s){const l=(180+r[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(l*v*_i),Math.round(p*v*_i)]}function ko(r,s,l){const p=r[0]-s[0],v=r[1]-s[1],A=r[0]-l[0],F=r[1]-l[1];return p*F-A*v==0&&p*A<=0&&v*F<=0}function vi(r,s){let l=!1;for(let F=0,N=s.length;F<N;F++){const U=s[F];for(let H=0,K=U.length;H<K-1;H++){if(ko(r,U[H],U[H+1]))return!1;(v=U[H])[1]>(p=r)[1]!=(A=U[H+1])[1]>p[1]&&p[0]<(A[0]-v[0])*(p[1]-v[1])/(A[1]-v[1])+v[0]&&(l=!l)}}var p,v,A;return l}function vo(r,s){for(let l=0;l<s.length;l++)if(vi(r,s[l]))return!0;return!1}function bu(r,s,l,p){const v=p[0]-l[0],A=p[1]-l[1],F=(r[0]-l[0])*A-v*(r[1]-l[1]),N=(s[0]-l[0])*A-v*(s[1]-l[1]);return F>0&&N<0||F<0&&N>0}function Or(r,s,l){for(const H of l)for(let K=0;K<H.length-1;++K)if((N=[(F=H[K+1])[0]-(A=H[K])[0],F[1]-A[1]])[0]*(U=[(v=s)[0]-(p=r)[0],v[1]-p[1]])[1]-N[1]*U[0]!=0&&bu(p,v,A,F)&&bu(A,F,p,v))return!0;var p,v,A,F,N,U;return!1}function Yl(r,s){for(let l=0;l<r.length;++l)if(!vi(r[l],s))return!1;for(let l=0;l<r.length-1;++l)if(Or(r[l],r[l+1],s))return!1;return!0}function jf(r,s){for(let l=0;l<s.length;l++)if(Yl(r,s[l]))return!0;return!1}function Qs(r,s,l){const p=[];for(let v=0;v<r.length;v++){const A=[];for(let F=0;F<r[v].length;F++){const N=zo(r[v][F],l);Tn(s,N),A.push(N)}p.push(A)}return p}function wu(r,s,l){const p=[];for(let v=0;v<r.length;v++){const A=Qs(r[v],s,l);p.push(A)}return p}function $p(r,s,l,p){if(r[0]<l[0]||r[0]>l[2]){const v=.5*p;let A=r[0]-l[0]>v?-p:l[0]-r[0]>v?p:0;0===A&&(A=r[0]-l[2]>v?-p:l[2]-r[0]>v?p:0),r[0]+=A}Tn(s,r)}function bh(r,s,l,p){const v=Math.pow(2,p.z)*_i,A=[p.x*_i,p.y*_i],F=[];if(!r)return F;for(const N of r)for(const U of N){const H=[U.x+A[0],U.y+A[1]];$p(H,s,l,v),F.push(H)}return F}function hs(r,s,l,p){const v=Math.pow(2,p.z)*_i,A=[p.x*_i,p.y*_i],F=[];if(!r)return F;for(const U of r){const H=[];for(const K of U){const et=[K.x+A[0],K.y+A[1]];Tn(s,et),H.push(et)}F.push(H)}if(s[2]-s[0]<=v/2){(N=s)[0]=N[1]=1/0,N[2]=N[3]=-1/0;for(const U of F)for(const H of U)$p(H,s,l,v)}var N;return F}class Hl{constructor(s,l){this.type=gt,this.geojson=s,this.geometries=l}static parse(s,l){if(2!==s.length)return l.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(qe(s[1])){const p=s[1];if("FeatureCollection"===p.type)for(let v=0;v<p.features.length;++v){const A=p.features[v].geometry.type;if("Polygon"===A||"MultiPolygon"===A)return new Hl(p,p.features[v].geometry)}else if("Feature"===p.type){const v=p.geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new Hl(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new Hl(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(l,p){const v=[1/0,1/0,-1/0,-1/0],A=[1/0,1/0,-1/0,-1/0],F=l.canonicalID();if(!F)return!1;if("Polygon"===p.type){const N=Qs(p.coordinates,A,F),U=bh(l.geometry(),v,A,F);if(!uo(v,A))return!1;for(const H of U)if(!vi(H,N))return!1}if("MultiPolygon"===p.type){const N=wu(p.coordinates,A,F),U=bh(l.geometry(),v,A,F);if(!uo(v,A))return!1;for(const H of U)if(!vo(H,N))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(l,p){const v=[1/0,1/0,-1/0,-1/0],A=[1/0,1/0,-1/0,-1/0],F=l.canonicalID();if(!F)return!1;if("Polygon"===p.type){const N=Qs(p.coordinates,A,F),U=hs(l.geometry(),v,A,F);if(!uo(v,A))return!1;for(const H of U)if(!Yl(H,N))return!1}if("MultiPolygon"===p.type){const N=wu(p.coordinates,A,F),U=hs(l.geometry(),v,A,F);if(!uo(v,A))return!1;for(const H of U)if(!jf(H,N))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var wh=Hl;function yc(r){if(r instanceof Di&&("get"===r.name&&1===r.args.length||"feature-state"===r.name||"has"===r.name&&1===r.args.length||"properties"===r.name||"geometry-type"===r.name||"id"===r.name||/^filter-/.test(r.name))||r instanceof wh)return!1;let s=!0;return r.eachChild(l=>{s&&!yc(l)&&(s=!1)}),s}function _c(r){if(r instanceof Di&&"feature-state"===r.name)return!1;let s=!0;return r.eachChild(l=>{s&&!_c(l)&&(s=!1)}),s}function md(r,s){if(r instanceof Di&&s.indexOf(r.name)>=0)return!1;let l=!0;return r.eachChild(p=>{l&&!md(p,s)&&(l=!1)}),l}class vc{constructor(s,l){this.type=l.type,this.name=s,this.boundExpression=l}static parse(s,l){if(2!==s.length||"string"!=typeof s[1])return l.error("'var' expression requires exactly one string literal argument.");const p=s[1];return l.scope.has(p)?new vc(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var $l=vc;class tl{constructor(s,l=[],p,v=new J,A=[]){this.registry=s,this.path=l,this.key=l.map(F=>`[${F}]`).join(""),this.scope=v,this.errors=A,this.expectedType=p}parse(s,l,p,v,A={}){return l?this.concat(l,p,v)._parse(s,A):this._parse(s,A)}_parse(s,l){function p(v,A,F){return"assert"===F?new Zi(A,[v]):"coerce"===F?new Te(A,[v]):v}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=s[0];if("string"!=typeof v)return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const A=this.registry[v];if(A){let F=A.parse(s,this);if(!F)return null;if(this.expectedType){const N=this.expectedType,U=F.type;if("string"!==N.kind&&"number"!==N.kind&&"boolean"!==N.kind&&"object"!==N.kind&&"array"!==N.kind||"value"!==U.kind)if("color"!==N.kind&&"formatted"!==N.kind&&"resolvedImage"!==N.kind||"value"!==U.kind&&"string"!==U.kind){if(this.checkSubtype(N,U))return null}else F=p(F,N,l.typeAnnotation||"coerce");else F=p(F,N,l.typeAnnotation||"assert")}if(!(F instanceof mn)&&"resolvedImage"!==F.type.kind&&fi(F)){const N=new Vn;try{F=new mn(F.type,F.evaluate(N))}catch(U){return this.error(U.message),null}}return F}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,l,p){const v="number"==typeof s?this.path.concat(s):this.path,A=p?this.scope.concat(p):this.scope;return new tl(this.registry,v,l||null,A,this.errors)}error(s,...l){const p=`${this.key}${l.map(v=>`[${v}]`).join("")}`;this.errors.push(new Y(p,s))}checkSubtype(s,l){const p=ye(s,l);return p&&this.error(p),p}}var Mu=tl;function fi(r){if(r instanceof $l)return fi(r.boundExpression);if(r instanceof Di&&"error"===r.name||r instanceof Mi||r instanceof wh)return!1;const s=r instanceof Te||r instanceof Zi;let l=!0;return r.eachChild(p=>{l=s?l&&fi(p):l&&p instanceof mn}),!!l&&yc(r)&&md(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function vl(r,s){const l=r.length-1;let p,v,A=0,F=l,N=0;for(;A<=F;)if(N=Math.floor((A+F)/2),p=r[N],v=r[N+1],p<=s){if(N===l||s<v)return N;A=N+1}else{if(!(p>s))throw new ze("Input is not a number.");F=N-1}return 0}class Fn{constructor(s,l,p){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(const[v,A]of p)this.labels.push(v),this.outputs.push(A)}static parse(s,l){if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(s[1],1,nt);if(!p)return null;const v=[];let A=null;l.expectedType&&"value"!==l.expectedType.kind&&(A=l.expectedType);for(let F=1;F<s.length;F+=2){const N=1===F?-1/0:s[F],U=s[F+1],H=F,K=F+1;if("number"!=typeof N)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(v.length&&v[v.length-1][0]>=N)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',H);const et=l.parse(U,K,A);if(!et)return null;A=A||et.type,v.push([N,et])}return new Fn(A,p,v)}evaluate(s){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=l[0])return p[0].evaluate(s);const A=l.length;return v>=l[A-1]?p[A-1].evaluate(s):p[vl(l,v)].evaluate(s)}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&s.push(this.labels[l]),s.push(this.outputs[l].serialize());return s}}var Mh=Fn;function rs(r,s,l){return r*(1-l)+s*l}var el=Object.freeze({__proto__:null,number:rs,color:function(r,s,l){return new ji(rs(r.r,s.r,l),rs(r.g,s.g,l),rs(r.b,s.b,l),rs(r.a,s.a,l))},array:function(r,s,l){return r.map((p,v)=>rs(p,s[v],l))}});const Gp=.95047,Zp=1.08883,Cu=4/29,xa=6/29,na=3*xa*xa,sa=Math.PI/180,il=180/Math.PI;function _s(r){return r>.008856451679035631?Math.pow(r,1/3):r/na+Cu}function Ch(r){return r>xa?r*r*r:na*(r-Cu)}function Th(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Sh(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Tu(r){const s=Sh(r.r),l=Sh(r.g),p=Sh(r.b),v=_s((.4124564*s+.3575761*l+.1804375*p)/Gp),A=_s((.2126729*s+.7151522*l+.072175*p)/1);return{l:116*A-16,a:500*(v-A),b:200*(A-_s((.0193339*s+.119192*l+.9503041*p)/Zp)),alpha:r.a}}function Ba(r){let s=(r.l+16)/116,l=isNaN(r.a)?s:s+r.a/500,p=isNaN(r.b)?s:s-r.b/200;return s=1*Ch(s),l=Gp*Ch(l),p=Zp*Ch(p),new ji(Th(3.2404542*l-1.5371385*s-.4985314*p),Th(-.969266*l+1.8760108*s+.041556*p),Th(.0556434*l-.2040259*s+1.0572252*p),r.alpha)}function bc(r,s,l){const p=s-r;return r+l*(p>180||p<-180?p-360*Math.round(p/360):p)}const wc={forward:Tu,reverse:Ba,interpolate:function(r,s,l){return{l:rs(r.l,s.l,l),a:rs(r.a,s.a,l),b:rs(r.b,s.b,l),alpha:rs(r.alpha,s.alpha,l)}}},po={forward:function(r){const{l:s,a:l,b:p}=Tu(r),v=Math.atan2(p,l)*il;return{h:v<0?v+360:v,c:Math.sqrt(l*l+p*p),l:s,alpha:r.a}},reverse:function(r){const s=r.h*sa,l=r.c;return Ba({l:r.l,a:Math.cos(s)*l,b:Math.sin(s)*l,alpha:r.alpha})},interpolate:function(r,s,l){return{h:bc(r.h,s.h,l),c:rs(r.c,s.c,l),l:rs(r.l,s.l,l),alpha:rs(r.alpha,s.alpha,l)}}};var Kp=Object.freeze({__proto__:null,lab:wc,hcl:po});class Mc{constructor(s,l,p,v,A){this.type=s,this.operator=l,this.interpolation=p,this.input=v,this.labels=[],this.outputs=[];for(const[F,N]of A)this.labels.push(F),this.outputs.push(N)}static interpolationFactor(s,l,p,v){let A=0;if("exponential"===s.name)A=Su(l,s.base,p,v);else if("linear"===s.name)A=Su(l,1,p,v);else if("cubic-bezier"===s.name){const F=s.controlPoints;A=new Ti(F[0],F[1],F[2],F[3]).solve(Su(l,1,p,v))}return A}static parse(s,l){let[p,v,A,...F]=s;if(!Array.isArray(v)||0===v.length)return l.error("Expected an interpolation type expression.",1);if("linear"===v[0])v={name:"linear"};else if("exponential"===v[0]){const H=v[1];if("number"!=typeof H)return l.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:H}}else{if("cubic-bezier"!==v[0])return l.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const H=v.slice(1);if(4!==H.length||H.some(K=>"number"!=typeof K||K<0||K>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:H}}}if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(A=l.parse(A,2,nt),!A)return null;const N=[];let U=null;"interpolate-hcl"===p||"interpolate-lab"===p?U=kt:l.expectedType&&"value"!==l.expectedType.kind&&(U=l.expectedType);for(let H=0;H<F.length;H+=2){const K=F[H],et=F[H+1],ot=H+3,ft=H+4;if("number"!=typeof K)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ot);if(N.length&&N[N.length-1][0]>=K)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ot);const _t=l.parse(et,ft,U);if(!_t)return null;U=U||_t.type,N.push([K,_t])}return"number"===U.kind||"color"===U.kind||"array"===U.kind&&"number"===U.itemType.kind&&"number"==typeof U.N?new Mc(U,p,v,A,N):l.error(`Type ${Ht(U)} is not interpolatable.`)}evaluate(s){const l=this.labels,p=this.outputs;if(1===l.length)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=l[0])return p[0].evaluate(s);const A=l.length;if(v>=l[A-1])return p[A-1].evaluate(s);const F=vl(l,v),N=Mc.interpolationFactor(this.interpolation,v,l[F],l[F+1]),U=p[F].evaluate(s),H=p[F+1].evaluate(s);return"interpolate"===this.operator?el[this.type.kind.toLowerCase()](U,H,N):"interpolate-hcl"===this.operator?po.reverse(po.interpolate(po.forward(U),po.forward(H),N)):wc.reverse(wc.interpolate(wc.forward(U),wc.forward(H),N))}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,s,this.input.serialize()];for(let p=0;p<this.labels.length;p++)l.push(this.labels[p],this.outputs[p].serialize());return l}}function Su(r,s,l,p){const v=p-l,A=r-l;return 0===v?0:1===s?A/v:(Math.pow(s,A)-1)/(Math.pow(s,v)-1)}var ws=Mc;class ku{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expectected at least one argument.");let p=null;const v=l.expectedType;v&&"value"!==v.kind&&(p=v);const A=[];for(const N of s.slice(1)){const U=l.parse(N,1+A.length,p,void 0,{typeAnnotation:"omit"});if(!U)return null;p=p||U.type,A.push(U)}const F=v&&A.some(N=>ye(v,N.type));return new ku(F?Tt:p,A)}evaluate(s){let l,p=null,v=0;for(const A of this.args){if(v++,p=A.evaluate(s),p&&p instanceof Zn&&!p.available&&(l||(l=p),p=null,v===this.args.length))return l;if(null!==p)break}return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(l=>{s.push(l.serialize())}),s}}var Au=ku;class Ji{constructor(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const l of this.bindings)s(l[1]);s(this.result)}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let A=1;A<s.length-1;A+=2){const F=s[A];if("string"!=typeof F)return l.error(`Expected string, but found ${typeof F} instead.`,A);if(/[^a-zA-Z0-9_]/.test(F))return l.error("Variable names must contain only alphanumeric characters or '_'.",A);const N=l.parse(s[A+1],A+1);if(!N)return null;p.push([F,N])}const v=l.parse(s[s.length-1],s.length-1,l.expectedType,p);return v?new Ji(p,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[l,p]of this.bindings)s.push(l,p.serialize());return s.push(this.result.serialize()),s}}var dr=Ji;class Ms{constructor(s,l,p){this.type=s,this.index=l,this.input=p}static parse(s,l){if(3!==s.length)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,nt),v=l.parse(s[2],2,le(l.expectedType||Tt));return p&&v?new Ms(v.type.itemType,p,v):null}evaluate(s){const l=this.index.evaluate(s),p=this.input.evaluate(s);if(l<0)throw new ze(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new ze(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new ze(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ur=Ms;class pr{constructor(s,l){this.type=gt,this.needle=s,this.haystack=l}static parse(s,l){if(3!==s.length)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Tt),v=l.parse(s[2],2,Tt);return p&&v?Rt(p.type,[gt,dt,nt,q,Tt])?new pr(p,v):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ht(p.type)} instead`):null}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(null==p)return!1;if(!se(l,["boolean","string","number","null"]))throw new ze(`Expected first argument to be of type boolean, string, number or null, but found ${Ht(fe(l))} instead.`);if(!se(p,["string","array"]))throw new ze(`Expected second argument to be of type array or string, but found ${Ht(fe(p))} instead.`);return p.indexOf(l)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Gl=pr;class Ko{constructor(s,l,p){this.type=nt,this.needle=s,this.haystack=l,this.fromIndex=p}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Tt),v=l.parse(s[2],2,Tt);if(!p||!v)return null;if(!Rt(p.type,[gt,dt,nt,q,Tt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ht(p.type)} instead`);if(4===s.length){const A=l.parse(s[3],3,nt);return A?new Ko(p,v,A):null}return new Ko(p,v)}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!se(l,["boolean","string","number","null"]))throw new ze(`Expected first argument to be of type boolean, string, number or null, but found ${Ht(fe(l))} instead.`);if(!se(p,["string","array"]))throw new ze(`Expected second argument to be of type array or string, but found ${Ht(fe(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return p.indexOf(l,v)}return p.indexOf(l)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Pu=Ko;class fd{constructor(s,l,p,v,A,F){this.inputType=s,this.type=l,this.input=p,this.cases=v,this.outputs=A,this.otherwise=F}static parse(s,l){if(s.length<5)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return l.error("Expected an even number of arguments.");let p,v;l.expectedType&&"value"!==l.expectedType.kind&&(v=l.expectedType);const A={},F=[];for(let H=2;H<s.length-1;H+=2){let K=s[H];const et=s[H+1];Array.isArray(K)||(K=[K]);const ot=l.concat(H);if(0===K.length)return ot.error("Expected at least one branch label.");for(const _t of K){if("number"!=typeof _t&&"string"!=typeof _t)return ot.error("Branch labels must be numbers or strings.");if("number"==typeof _t&&Math.abs(_t)>Number.MAX_SAFE_INTEGER)return ot.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof _t&&Math.floor(_t)!==_t)return ot.error("Numeric branch labels must be integer values.");if(p){if(ot.checkSubtype(p,fe(_t)))return null}else p=fe(_t);if(void 0!==A[String(_t)])return ot.error("Branch labels must be unique.");A[String(_t)]=F.length}const ft=l.parse(et,H,v);if(!ft)return null;v=v||ft.type,F.push(ft)}const N=l.parse(s[1],1,Tt);if(!N)return null;const U=l.parse(s[s.length-1],s.length-1,v);return U?"value"!==N.type.kind&&l.concat(1).checkSubtype(p,N.type)?null:new fd(p,v,N,A,F,U):null}evaluate(s){const l=this.input.evaluate(s);return(fe(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),p=[],v={};for(const F of l){const N=v[this.cases[F]];void 0===N?(v[this.cases[F]]=p.length,p.push([this.cases[F],[F]])):p[N][1].push(F)}const A=F=>"number"===this.inputType.kind?Number(F):F;for(const[F,N]of p)s.push(1===N.length?A(N[0]):N.map(A)),s.push(this.outputs[F].serialize());return s.push(this.otherwise.serialize()),s}}var gd=fd;class ya{constructor(s,l,p){this.type=s,this.branches=l,this.otherwise=p}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);const v=[];for(let F=1;F<s.length-1;F+=2){const N=l.parse(s[F],F,gt);if(!N)return null;const U=l.parse(s[F+1],F+1,p);if(!U)return null;v.push([N,U]),p=p||U.type}const A=l.parse(s[s.length-1],s.length-1,p);return A?new ya(p,v,A):null}evaluate(s){for(const[l,p]of this.branches)if(l.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[l,p]of this.branches)s(l),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(l=>{s.push(l.serialize())}),s}}var on=ya;class zn{constructor(s,l,p,v){this.type=s,this.input=l,this.beginIndex=p,this.endIndex=v}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Tt),v=l.parse(s[2],2,nt);if(!p||!v)return null;if(!Rt(p.type,[le(Tt),dt,Tt]))return l.error(`Expected first argument to be of type array or string, but found ${Ht(p.type)} instead`);if(4===s.length){const A=l.parse(s[3],3,nt);return A?new zn(p.type,p,v,A):null}return new zn(p.type,p,v)}evaluate(s){const l=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!se(l,["string","array"]))throw new ze(`Expected first argument to be of type array or string, but found ${Ht(fe(l))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return l.slice(p,v)}return l.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var wo=zn;function Gr(r,s){return"=="===r||"!="===r?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function bl(r,s,l,p){return 0===p.compare(s,l)}function Ao(r,s,l){const p="=="!==r&&"!="!==r;return class wD{constructor(A,F,N){this.type=gt,this.lhs=A,this.rhs=F,this.collator=N,this.hasUntypedArgument="value"===A.type.kind||"value"===F.type.kind}static parse(A,F){if(3!==A.length&&4!==A.length)return F.error("Expected two or three arguments.");const N=A[0];let U=F.parse(A[1],1,Tt);if(!U)return null;if(!Gr(N,U.type))return F.concat(1).error(`"${N}" comparisons are not supported for type '${Ht(U.type)}'.`);let H=F.parse(A[2],2,Tt);if(!H)return null;if(!Gr(N,H.type))return F.concat(2).error(`"${N}" comparisons are not supported for type '${Ht(H.type)}'.`);if(U.type.kind!==H.type.kind&&"value"!==U.type.kind&&"value"!==H.type.kind)return F.error(`Cannot compare types '${Ht(U.type)}' and '${Ht(H.type)}'.`);p&&("value"===U.type.kind&&"value"!==H.type.kind?U=new Zi(H.type,[U]):"value"!==U.type.kind&&"value"===H.type.kind&&(H=new Zi(U.type,[H])));let K=null;if(4===A.length){if("string"!==U.type.kind&&"string"!==H.type.kind&&"value"!==U.type.kind&&"value"!==H.type.kind)return F.error("Cannot use collator to compare non-string types.");if(K=F.parse(A[3],3,ee),!K)return null}return new wD(U,H,K)}evaluate(A){const F=this.lhs.evaluate(A),N=this.rhs.evaluate(A);if(p&&this.hasUntypedArgument){const U=fe(F),H=fe(N);if(U.kind!==H.kind||"string"!==U.kind&&"number"!==U.kind)throw new ze(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${U.kind}, ${H.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const U=fe(F),H=fe(N);if("string"!==U.kind||"string"!==H.kind)return s(A,F,N)}return this.collator?l(A,F,N,this.collator.evaluate(A)):s(A,F,N)}eachChild(A){A(this.lhs),A(this.rhs),this.collator&&A(this.collator)}outputDefined(){return!0}serialize(){const A=[r];return this.eachChild(F=>{A.push(F.serialize())}),A}}}const kh=Ao("==",function(r,s,l){return s===l},bl),Co=Ao("!=",function(r,s,l){return s!==l},function(r,s,l,p){return!bl(0,s,l,p)}),Cc=Ao("<",function(r,s,l){return s<l},function(r,s,l,p){return p.compare(s,l)<0}),Tc=Ao(">",function(r,s,l){return s>l},function(r,s,l,p){return p.compare(s,l)>0}),qn=Ao("<=",function(r,s,l){return s<=l},function(r,s,l,p){return p.compare(s,l)<=0}),Eu=Ao(">=",function(r,s,l){return s>=l},function(r,s,l,p){return p.compare(s,l)>=0});class Zl{constructor(s,l,p,v,A,F){this.type=dt,this.number=s,this.locale=l,this.currency=p,this.unit=v,this.minFractionDigits=A,this.maxFractionDigits=F}static parse(s,l){if(3!==s.length)return l.error("Expected two arguments.");const p=l.parse(s[1],1,nt);if(!p)return null;const v=s[2];if("object"!=typeof v||Array.isArray(v))return l.error("NumberFormat options argument must be an object.");let A=null;if(v.locale&&(A=l.parse(v.locale,1,dt),!A))return null;let F=null;if(v.currency&&(F=l.parse(v.currency,1,dt),!F))return null;let N=null;if(v.unit&&(N=l.parse(v.unit,1,dt),!N))return null;let U=null;if(v["min-fraction-digits"]&&(U=l.parse(v["min-fraction-digits"],1,nt),!U))return null;let H=null;return v["max-fraction-digits"]&&(H=l.parse(v["max-fraction-digits"],1,nt),!H)?null:new Zl(p,A,F,N,U,H)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class xd{constructor(s){this.type=nt,this.input=s}static parse(s,l){if(2!==s.length)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=l.parse(s[1],1);return p?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?l.error(`Expected argument of type string or array, but found ${Ht(p.type)} instead.`):new xd(p):null}evaluate(s){const l=this.input.evaluate(s);if("string"==typeof l||Array.isArray(l))return l.length;throw new ze(`Expected value to be of type string or array, but found ${Ht(fe(l))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(l=>{s.push(l.serialize())}),s}}const Kl={"==":kh,"!=":Co,">":Tc,"<":Cc,">=":Eu,"<=":qn,array:Zi,at:ur,boolean:Zi,case:on,coalesce:Au,collator:Mi,format:ui,image:Ii,in:Gl,"index-of":Pu,interpolate:ws,"interpolate-hcl":ws,"interpolate-lab":ws,length:xd,let:dr,literal:mn,match:gd,number:Zi,"number-format":Zl,object:Zi,slice:wo,step:Mh,string:Zi,"to-boolean":Te,"to-color":Te,"to-number":Te,"to-string":Te,var:$l,within:wh};function Jo(r,[s,l,p,v]){s=s.evaluate(r),l=l.evaluate(r),p=p.evaluate(r);const A=v?v.evaluate(r):1,F=Qe(s,l,p,A);if(F)throw new ze(F);return new ji(s/255*A,l/255*A,p/255*A,A)}function Ah(r,s){return r in s}function wl(r,s){const l=s[r];return void 0===l?null:l}function Qo(r){return{type:r}}Di.register(Kl,{error:[{kind:"error"},[dt],(r,[s])=>{throw new ze(s.evaluate(r))}],typeof:[dt,[Tt],(r,[s])=>Ht(fe(s.evaluate(r)))],"to-rgba":[le(nt,4),[kt],(r,[s])=>s.evaluate(r).toArray()],rgb:[kt,[nt,nt,nt],Jo],rgba:[kt,[nt,nt,nt,nt],Jo],has:{type:gt,overloads:[[[dt],(r,[s])=>Ah(s.evaluate(r),r.properties())],[[dt,mt],(r,[s,l])=>Ah(s.evaluate(r),l.evaluate(r))]]},get:{type:Tt,overloads:[[[dt],(r,[s])=>wl(s.evaluate(r),r.properties())],[[dt,mt],(r,[s,l])=>wl(s.evaluate(r),l.evaluate(r))]]},"feature-state":[Tt,[dt],(r,[s])=>wl(s.evaluate(r),r.featureState||{})],properties:[mt,[],r=>r.properties()],"geometry-type":[dt,[],r=>r.geometryType()],id:[Tt,[],r=>r.id()],zoom:[nt,[],r=>r.globals.zoom],pitch:[nt,[],r=>r.globals.pitch||0],"distance-from-center":[nt,[],r=>r.distanceFromCenter()],"heatmap-density":[nt,[],r=>r.globals.heatmapDensity||0],"line-progress":[nt,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[nt,[],r=>r.globals.skyRadialProgress||0],accumulated:[Tt,[],r=>void 0===r.globals.accumulated?null:r.globals.accumulated],"+":[nt,Qo(nt),(r,s)=>{let l=0;for(const p of s)l+=p.evaluate(r);return l}],"*":[nt,Qo(nt),(r,s)=>{let l=1;for(const p of s)l*=p.evaluate(r);return l}],"-":{type:nt,overloads:[[[nt,nt],(r,[s,l])=>s.evaluate(r)-l.evaluate(r)],[[nt],(r,[s])=>-s.evaluate(r)]]},"/":[nt,[nt,nt],(r,[s,l])=>s.evaluate(r)/l.evaluate(r)],"%":[nt,[nt,nt],(r,[s,l])=>s.evaluate(r)%l.evaluate(r)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(r,[s,l])=>Math.pow(s.evaluate(r),l.evaluate(r))],sqrt:[nt,[nt],(r,[s])=>Math.sqrt(s.evaluate(r))],log10:[nt,[nt],(r,[s])=>Math.log(s.evaluate(r))/Math.LN10],ln:[nt,[nt],(r,[s])=>Math.log(s.evaluate(r))],log2:[nt,[nt],(r,[s])=>Math.log(s.evaluate(r))/Math.LN2],sin:[nt,[nt],(r,[s])=>Math.sin(s.evaluate(r))],cos:[nt,[nt],(r,[s])=>Math.cos(s.evaluate(r))],tan:[nt,[nt],(r,[s])=>Math.tan(s.evaluate(r))],asin:[nt,[nt],(r,[s])=>Math.asin(s.evaluate(r))],acos:[nt,[nt],(r,[s])=>Math.acos(s.evaluate(r))],atan:[nt,[nt],(r,[s])=>Math.atan(s.evaluate(r))],min:[nt,Qo(nt),(r,s)=>Math.min(...s.map(l=>l.evaluate(r)))],max:[nt,Qo(nt),(r,s)=>Math.max(...s.map(l=>l.evaluate(r)))],abs:[nt,[nt],(r,[s])=>Math.abs(s.evaluate(r))],round:[nt,[nt],(r,[s])=>{const l=s.evaluate(r);return l<0?-Math.round(-l):Math.round(l)}],floor:[nt,[nt],(r,[s])=>Math.floor(s.evaluate(r))],ceil:[nt,[nt],(r,[s])=>Math.ceil(s.evaluate(r))],"filter-==":[gt,[dt,Tt],(r,[s,l])=>r.properties()[s.value]===l.value],"filter-id-==":[gt,[Tt],(r,[s])=>r.id()===s.value],"filter-type-==":[gt,[dt],(r,[s])=>r.geometryType()===s.value],"filter-<":[gt,[dt,Tt],(r,[s,l])=>{const p=r.properties()[s.value],v=l.value;return typeof p==typeof v&&p<v}],"filter-id-<":[gt,[Tt],(r,[s])=>{const l=r.id(),p=s.value;return typeof l==typeof p&&l<p}],"filter->":[gt,[dt,Tt],(r,[s,l])=>{const p=r.properties()[s.value],v=l.value;return typeof p==typeof v&&p>v}],"filter-id->":[gt,[Tt],(r,[s])=>{const l=r.id(),p=s.value;return typeof l==typeof p&&l>p}],"filter-<=":[gt,[dt,Tt],(r,[s,l])=>{const p=r.properties()[s.value],v=l.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[gt,[Tt],(r,[s])=>{const l=r.id(),p=s.value;return typeof l==typeof p&&l<=p}],"filter->=":[gt,[dt,Tt],(r,[s,l])=>{const p=r.properties()[s.value],v=l.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[gt,[Tt],(r,[s])=>{const l=r.id(),p=s.value;return typeof l==typeof p&&l>=p}],"filter-has":[gt,[Tt],(r,[s])=>s.value in r.properties()],"filter-has-id":[gt,[],r=>null!==r.id()&&void 0!==r.id()],"filter-type-in":[gt,[le(dt)],(r,[s])=>s.value.indexOf(r.geometryType())>=0],"filter-id-in":[gt,[le(Tt)],(r,[s])=>s.value.indexOf(r.id())>=0],"filter-in-small":[gt,[dt,le(Tt)],(r,[s,l])=>l.value.indexOf(r.properties()[s.value])>=0],"filter-in-large":[gt,[dt,le(Tt)],(r,[s,l])=>function(p,v,A,F){for(;A<=F;){const N=A+F>>1;if(v[N]===p)return!0;v[N]>p?F=N-1:A=N+1}return!1}(r.properties()[s.value],l.value,0,l.value.length-1)],all:{type:gt,overloads:[[[gt,gt],(r,[s,l])=>s.evaluate(r)&&l.evaluate(r)],[Qo(gt),(r,s)=>{for(const l of s)if(!l.evaluate(r))return!1;return!0}]]},any:{type:gt,overloads:[[[gt,gt],(r,[s,l])=>s.evaluate(r)||l.evaluate(r)],[Qo(gt),(r,s)=>{for(const l of s)if(l.evaluate(r))return!0;return!1}]]},"!":[gt,[gt],(r,[s])=>!s.evaluate(r)],"is-supported-script":[gt,[dt],(r,[s])=>{const l=r.globals&&r.globals.isSupportedScript;return!l||l(s.evaluate(r))}],upcase:[dt,[dt],(r,[s])=>s.evaluate(r).toUpperCase()],downcase:[dt,[dt],(r,[s])=>s.evaluate(r).toLowerCase()],concat:[dt,Qo(Tt),(r,s)=>s.map(l=>Rn(l.evaluate(r))).join("")],"resolved-locale":[dt,[ee],(r,[s])=>s.evaluate(r).resolvedLocale()]});var Oa=Kl;function Ph(r){return{result:"success",value:r}}function zs(r){return{result:"error",value:r}}function Sc(r){return"data-driven"===r["property-type"]}function _a(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function kc(r){return!!r.expression&&r.expression.interpolated}function ts(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":null===r?"null":typeof r}function Jl(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function Eh(r){return r}function qo(r,s){const l="color"===s.type,p=r.stops&&"object"==typeof r.stops[0][0],v=p||!(p||void 0!==r.property),A=r.type||(kc(s)?"exponential":"interval");if(l&&((r=O({},r)).stops&&(r.stops=r.stops.map(H=>[H[0],ji.parse(H[1])])),r.default=ji.parse(r.default?r.default:s.default)),r.colorSpace&&"rgb"!==r.colorSpace&&!Kp[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let F,N,U;if("exponential"===A)F=Dh;else if("interval"===A)F=oa;else if("categorical"===A){F=kr,N=Object.create(null);for(const H of r.stops)N[H[0]]=H[1];U=typeof r.stops[0][0]}else{if("identity"!==A)throw new Error(`Unknown function type "${A}"`);F=Ih}if(p){const H={},K=[];for(let ft=0;ft<r.stops.length;ft++){const _t=r.stops[ft],St=_t[0].zoom;void 0===H[St]&&(H[St]={zoom:St,type:r.type,property:r.property,default:r.default,stops:[]},K.push(St)),H[St].stops.push([_t[0].value,_t[1]])}const et=[];for(const ft of K)et.push([H[ft].zoom,qo(H[ft],s)]);const ot={name:"linear"};return{kind:"composite",interpolationType:ot,interpolationFactor:ws.interpolationFactor.bind(void 0,ot),zoomStops:et.map(ft=>ft[0]),evaluate:({zoom:ft},_t)=>Dh({stops:et,base:r.base},s,ft).evaluate(ft,_t)}}if(v){const H="exponential"===A?{name:"exponential",base:void 0!==r.base?r.base:1}:null;return{kind:"camera",interpolationType:H,interpolationFactor:ws.interpolationFactor.bind(void 0,H),zoomStops:r.stops.map(K=>K[0]),evaluate:({zoom:K})=>F(r,s,K,N,U)}}return{kind:"source",evaluate(H,K){const et=K&&K.properties?K.properties[r.property]:void 0;return void 0===et?yd(r.default,s.default):F(r,s,et,N,U)}}}function yd(r,s,l){return void 0!==r?r:void 0!==s?s:void 0!==l?l:void 0}function kr(r,s,l,p,v){return yd(typeof l===v?p[l]:void 0,r.default,s.default)}function oa(r,s,l){if("number"!==ts(l))return yd(r.default,s.default);const p=r.stops.length;if(1===p||l<=r.stops[0][0])return r.stops[0][1];if(l>=r.stops[p-1][0])return r.stops[p-1][1];const v=vl(r.stops.map(A=>A[0]),l);return r.stops[v][1]}function Dh(r,s,l){const p=void 0!==r.base?r.base:1;if("number"!==ts(l))return yd(r.default,s.default);const v=r.stops.length;if(1===v||l<=r.stops[0][0])return r.stops[0][1];if(l>=r.stops[v-1][0])return r.stops[v-1][1];const A=vl(r.stops.map(K=>K[0]),l),F=function(K,et,ot,ft){const _t=ft-ot,St=K-ot;return 0===_t?0:1===et?St/_t:(Math.pow(et,St)-1)/(Math.pow(et,_t)-1)}(l,p,r.stops[A][0],r.stops[A+1][0]),N=r.stops[A][1],U=r.stops[A+1][1];let H=el[s.type]||Eh;if(r.colorSpace&&"rgb"!==r.colorSpace){const K=Kp[r.colorSpace];H=(et,ot)=>K.reverse(K.interpolate(K.forward(et),K.forward(ot),F))}return"function"==typeof N.evaluate?{evaluate(...K){const et=N.evaluate.apply(void 0,K),ot=U.evaluate.apply(void 0,K);if(void 0!==et&&void 0!==ot)return H(et,ot,F)}}:H(N,U,F)}function Ih(r,s,l){return"color"===s.type?l=ji.parse(l):"formatted"===s.type?l=yn.fromString(l.toString()):"resolvedImage"===s.type?l=Zn.fromString(l.toString()):ts(l)===s.type||"enum"===s.type&&s.values[l]||(l=void 0),yd(l,r.default,s.default)}class Ql{constructor(s,l){var p;this.expression=s,this._warningHistory={},this._evaluator=new Vn,this._defaultValue=l?"color"===(p=l).type&&(Jl(p.default)||Array.isArray(p.default))?new ji(0,0,0,0):"color"===p.type?ji.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(s,l,p,v,A,F,N,U){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=v||null,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=F,this._evaluator.featureTileCoord=N||null,this._evaluator.featureDistanceData=U||null,this.expression.evaluate(this._evaluator)}evaluate(s,l,p,v,A,F,N,U){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=F||null,this._evaluator.featureTileCoord=N||null,this._evaluator.featureDistanceData=U||null;try{const H=this.expression.evaluate(this._evaluator);if(null==H||"number"==typeof H&&H!=H)return this._defaultValue;if(this._enumValues&&!(H in this._enumValues))throw new ze(`Expected value to be one of ${Object.keys(this._enumValues).map(K=>JSON.stringify(K)).join(", ")}, but found ${JSON.stringify(H)} instead.`);return H}catch(H){return this._warningHistory[H.message]||(this._warningHistory[H.message]=!0,typeof console<"u"&&console.warn(H.message)),this._defaultValue}}}function mr(r){return Array.isArray(r)&&r.length>0&&"string"==typeof r[0]&&r[0]in Oa}function Fh(r,s){const l=new Mu(Oa,[],s?function(v){const A={color:kt,string:dt,number:nt,enum:dt,boolean:gt,formatted:Ft,resolvedImage:vt};return"array"===v.type?le(A[v.value]||Tt,v.length):A[v.type]}(s):void 0),p=l.parse(r,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return p?Ph(new Ql(p,s)):zs(l.errors)}class Du{constructor(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent="constant"!==s&&!_c(l.expression)}evaluateWithoutErrorHandling(s,l,p,v,A,F){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,v,A,F)}evaluate(s,l,p,v,A,F){return this._styleExpression.evaluate(s,l,p,v,A,F)}}class ql{constructor(s,l,p,v){this.kind=s,this.zoomStops=p,this._styleExpression=l,this.isStateDependent="camera"!==s&&!_c(l.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,l,p,v,A,F){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,v,A,F)}evaluate(s,l,p,v,A,F){return this._styleExpression.evaluate(s,l,p,v,A,F)}interpolationFactor(s,l,p){return this.interpolationType?ws.interpolationFactor(this.interpolationType,s,l,p):0}}function th(r,s){if("error"===(r=Fh(r,s)).result)return r;const l=r.value.expression,p=yc(l);if(!p&&!Sc(s))return zs([new Y("","data expressions not supported")]);const v=md(l,["zoom","pitch","distance-from-center"]);if(!v&&!_a(s))return zs([new Y("","zoom expressions not supported")]);const A=vd(l);return A||v?A instanceof Y?zs([A]):A instanceof ws&&!kc(s)?zs([new Y("",'"interpolate" expressions cannot be used with this property')]):Ph(A?new ql(p?"camera":"composite",r.value,A.labels,A instanceof ws?A.interpolation:void 0):new Du(p?"constant":"source",r.value)):zs([new Y("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _d{constructor(s,l){this._parameters=s,this._specification=l,O(this,qo(this._parameters,this._specification))}static deserialize(s){return new _d(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function vd(r){let s=null;if(r instanceof dr)s=vd(r.result);else if(r instanceof Au){for(const l of r.args)if(s=vd(l),s)break}else(r instanceof Mh||r instanceof ws)&&r.input instanceof Di&&"zoom"===r.input.name&&(s=r);return s instanceof Y||r.eachChild(l=>{const p=vd(l);p instanceof Y?s=p:!s&&p?s=new Y("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&p&&s!==p&&(s=new Y("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class Oi{constructor(s,l,p,v){this.message=(s?`${s}: `:"")+p,v&&(this.identifier=v),null!=l&&l.__line__&&(this.line=l.__line__)}}function va(r){const s=r.key,l=r.value,p=r.valueSpec||{},v=r.objectElementValidators||{},A=r.style,F=r.styleSpec;let N=[];const U=ts(l);if("object"!==U)return[new Oi(s,l,`object expected, ${U} found`)];for(const H in l){const K=H.split(".")[0];let ot;v[K]?ot=v[K]:p[K]?ot=Eo:v["*"]?ot=v["*"]:p["*"]&&(ot=Eo),ot?N=N.concat(ot({key:(s&&`${s}.`)+H,value:l[H],valueSpec:p[K]||p["*"],style:A,styleSpec:F,object:l,objectKey:H},l)):N.push(new Oi(s,l[H],`unknown property "${H}"`))}for(const H in p)v[H]||p[H].required&&void 0===p[H].default&&void 0===l[H]&&N.push(new Oi(s,l,`missing required property "${H}"`));return N}function Uf(r){const s=r.value,l=r.valueSpec,p=r.style,v=r.styleSpec,A=r.key,F=r.arrayElementValidator||Eo;if("array"!==ts(s))return[new Oi(A,s,`array expected, ${ts(s)} found`)];if(l.length&&s.length!==l.length)return[new Oi(A,s,`array length ${l.length} expected, length ${s.length} found`)];if(l["min-length"]&&s.length<l["min-length"])return[new Oi(A,s,`array length at least ${l["min-length"]} expected, length ${s.length} found`)];let N={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};v.$version<7&&(N.function=l.function),"object"===ts(l.value)&&(N=l.value);let U=[];for(let H=0;H<s.length;H++)U=U.concat(F({array:s,arrayIndex:H,value:s[H],valueSpec:N,style:p,styleSpec:v,key:`${A}[${H}]`}));return U}function Jp(r){const s=r.key,l=r.value,p=r.valueSpec;let v=ts(l);if("number"===v&&l!=l&&(v="NaN"),"number"!==v)return[new Oi(s,l,`number expected, ${v} found`)];if("minimum"in p){let A=p.minimum;if("array"===ts(p.minimum)&&(A=p.minimum[r.arrayIndex]),l<A)return[new Oi(s,l,`${l} is less than the minimum value ${A}`)]}if("maximum"in p){let A=p.maximum;if("array"===ts(p.maximum)&&(A=p.maximum[r.arrayIndex]),l>A)return[new Oi(s,l,`${l} is greater than the maximum value ${A}`)]}return[]}function bd(r){const s=r.valueSpec,l=L(r.value.type);let p,v,A,F={};const N="categorical"!==l&&void 0===r.value.property,U=!N,H="array"===ts(r.value.stops)&&"array"===ts(r.value.stops[0])&&"object"===ts(r.value.stops[0][0]),K=va({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(ft){if("identity"===l)return[new Oi(ft.key,ft.value,'identity function may not have a "stops" property')];let _t=[];const St=ft.value;return _t=_t.concat(Uf({key:ft.key,value:St,valueSpec:ft.valueSpec,style:ft.style,styleSpec:ft.styleSpec,arrayElementValidator:et})),"array"===ts(St)&&0===St.length&&_t.push(new Oi(ft.key,St,"array must have at least one stop")),_t},default:function(ft){return Eo({key:ft.key,value:ft.value,valueSpec:s,style:ft.style,styleSpec:ft.styleSpec})}}});return"identity"===l&&N&&K.push(new Oi(r.key,r.value,'missing required property "property"')),"identity"===l||r.value.stops||K.push(new Oi(r.key,r.value,'missing required property "stops"')),"exponential"===l&&r.valueSpec.expression&&!kc(r.valueSpec)&&K.push(new Oi(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(U&&!Sc(r.valueSpec)?K.push(new Oi(r.key,r.value,"property functions not supported")):N&&!_a(r.valueSpec)&&K.push(new Oi(r.key,r.value,"zoom functions not supported"))),"categorical"!==l&&!H||void 0!==r.value.property||K.push(new Oi(r.key,r.value,'"property" property is required')),K;function et(ft){let _t=[];const St=ft.value,Lt=ft.key;if("array"!==ts(St))return[new Oi(Lt,St,`array expected, ${ts(St)} found`)];if(2!==St.length)return[new Oi(Lt,St,`array length 2 expected, length ${St.length} found`)];if(H){if("object"!==ts(St[0]))return[new Oi(Lt,St,`object expected, ${ts(St[0])} found`)];if(void 0===St[0].zoom)return[new Oi(Lt,St,"object stop key must have zoom")];if(void 0===St[0].value)return[new Oi(Lt,St,"object stop key must have value")];const Zt=L(St[0].zoom);if("number"!=typeof Zt)return[new Oi(Lt,St[0].zoom,"stop zoom values must be numbers")];if(A&&A>Zt)return[new Oi(Lt,St[0].zoom,"stop zoom values must appear in ascending order")];Zt!==A&&(A=Zt,v=void 0,F={}),_t=_t.concat(va({key:`${Lt}[0]`,value:St[0],valueSpec:{zoom:{}},style:ft.style,styleSpec:ft.styleSpec,objectElementValidators:{zoom:Jp,value:ot}}))}else _t=_t.concat(ot({key:`${Lt}[0]`,value:St[0],valueSpec:{},style:ft.style,styleSpec:ft.styleSpec},St));return mr(X(St[1]))?_t.concat([new Oi(`${Lt}[1]`,St[1],"expressions are not allowed in function stops.")]):_t.concat(Eo({key:`${Lt}[1]`,value:St[1],valueSpec:s,style:ft.style,styleSpec:ft.styleSpec}))}function ot(ft,_t){const St=ts(ft.value),Lt=L(ft.value),Zt=null!==ft.value?ft.value:_t;if(p){if(St!==p)return[new Oi(ft.key,Zt,`${St} stop domain type must match previous stop domain type ${p}`)]}else p=St;if("number"!==St&&"string"!==St&&"boolean"!==St&&"number"!=typeof Lt&&"string"!=typeof Lt&&"boolean"!=typeof Lt)return[new Oi(ft.key,Zt,"stop domain value must be a number, string, or boolean")];if("number"!==St&&"categorical"!==l){let he=`number expected, ${St} found`;return Sc(s)&&void 0===l&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Oi(ft.key,Zt,he)]}return"categorical"!==l||"number"!==St||"number"==typeof Lt&&isFinite(Lt)&&Math.floor(Lt)===Lt?"categorical"!==l&&"number"===St&&"number"==typeof Lt&&"number"==typeof v&&void 0!==v&&Lt<v?[new Oi(ft.key,Zt,"stop domain values must appear in ascending order")]:(v=Lt,"categorical"===l&&Lt in F?[new Oi(ft.key,Zt,"stop domain values must be unique")]:(F[Lt]=!0,[])):[new Oi(ft.key,Zt,`integer expected, found ${String(Lt)}`)]}}function Ac(r){const s=("property"===r.expressionContext?th:Fh)(X(r.value),r.valueSpec);if("error"===s.result)return s.value.map(p=>new Oi(`${r.key}${p.key}`,r.value,p.message));const l=s.value.expression||s.value._styleExpression.expression;if("property"===r.expressionContext&&"text-font"===r.propertyKey&&!l.outputDefined())return[new Oi(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===r.expressionContext&&"layout"===r.propertyType&&!_c(l))return[new Oi(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===r.expressionContext)return Yf(l,r);if(r.expressionContext&&0===r.expressionContext.indexOf("cluster")){if(!md(l,["zoom","feature-state"]))return[new Oi(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===r.expressionContext&&!yc(l))return[new Oi(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yf(r,s){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const v of s.valueSpec.expression.parameters)l.delete(v);if(0===l.size)return[];const p=[];return r instanceof Di&&l.has(r.name)?[new Oi(s.key,s.value,`["${r.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(r.eachChild(v=>{p.push(...Yf(v,s))}),p)}function Iu(r){const s=r.key,l=r.value,p=r.valueSpec,v=[];return Array.isArray(p.values)?-1===p.values.indexOf(L(l))&&v.push(new Oi(s,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(p.values).indexOf(L(l))&&v.push(new Oi(s,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),v}function Qp(r){if(!0===r||!1===r)return!0;if(!Array.isArray(r)||0===r.length)return!1;switch(r[0]){case"has":return r.length>=2&&"$id"!==r[1]&&"$type"!==r[1];case"in":return r.length>=3&&("string"!=typeof r[1]||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==r.length||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const s of r.slice(1))if(!Qp(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}function Fu(r,s="fill"){if(null==r)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Qp(r)||(r=wd(r));const l=r;let p=!0;try{p=function(H){if(!tr(H))return H;let K=X(H);return Bh(K),K=Lh(K),K}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(l,null,2)}\n        `)}const v=B[`filter_${s}`],A=Fh(p,v);let F=null;if("error"===A.result)throw new Error(A.value.map(H=>`${H.key}: ${H.message}`).join(", "));F=(H,K,et)=>A.value.evaluate(H,K,{},et);let N=null,U=null;if(p!==l){const H=Fh(l,v);if("error"===H.result)throw new Error(H.value.map(K=>`${K.key}: ${K.message}`).join(", "));N=(K,et,ot,ft,_t)=>H.value.evaluate(K,et,{},ot,void 0,void 0,ft,_t),U=!yc(H.value.expression)}return{filter:F,dynamicFilter:N||void 0,needGeometry:Ml(p),needFeature:!!U}}function Lh(r){if(!Array.isArray(r))return r;const s=function(l){if(Lu.has(l[0]))for(let p=1;p<l.length;p++)if(tr(l[p]))return!0;return l}(r);return!0===s?s:s.map(l=>Lh(l))}function Bh(r){let s=!1;const l=[];if("case"===r[0]){for(let p=1;p<r.length-1;p+=2)s=s||tr(r[p]),l.push(r[p+1]);l.push(r[r.length-1])}else if("match"===r[0]){s=s||tr(r[1]);for(let p=2;p<r.length-1;p+=2)l.push(r[p+1]);l.push(r[r.length-1])}else if("step"===r[0]){s=s||tr(r[1]);for(let p=1;p<r.length-1;p+=2)l.push(r[p+1])}s&&(r.length=0,r.push("any",...l));for(let p=1;p<r.length;p++)Bh(r[p])}function tr(r){if(!Array.isArray(r))return!1;if("pitch"===(s=r[0])||"distance-from-center"===s)return!0;var s;for(let l=1;l<r.length;l++)if(tr(r[l]))return!0;return!1}const Lu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function uy(r,s){return r<s?-1:r>s?1:0}function Ml(r){if(!Array.isArray(r))return!1;if("within"===r[0])return!0;for(let s=1;s<r.length;s++)if(Ml(r[s]))return!0;return!1}function wd(r){if(!r)return!0;const s=r[0];return r.length<=1?"any"!==s:"=="===s?er(r[1],r[2],"=="):"!="===s?Oh(er(r[1],r[2],"==")):"<"===s||">"===s||"<="===s||">="===s?er(r[1],r[2],s):"any"===s?(l=r.slice(1),["any"].concat(l.map(wd))):"all"===s?["all"].concat(r.slice(1).map(wd)):"none"===s?["all"].concat(r.slice(1).map(wd).map(Oh)):"in"===s?Pc(r[1],r.slice(2)):"!in"===s?Oh(Pc(r[1],r.slice(2))):"has"===s?qp(r[1]):"!has"===s?Oh(qp(r[1])):"within"!==s||r;var l}function er(r,s,l){switch(r){case"$type":return[`filter-type-${l}`,s];case"$id":return[`filter-id-${l}`,s];default:return[`filter-${l}`,r,s]}}function Pc(r,s){if(0===s.length)return!1;switch(r){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(l=>typeof l!=typeof s[0])?["filter-in-large",r,["literal",s.sort(uy)]]:["filter-in-small",r,["literal",s]]}}function qp(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Oh(r){return["!",r]}function Md(r){return Qp(X(r.value))?Ac(O({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):Bu(r)}function Bu(r){const s=r.value,l=r.key;if("array"!==ts(s))return[new Oi(l,s,`array expected, ${ts(s)} found`)];const p=r.styleSpec;let v,A=[];if(s.length<1)return[new Oi(l,s,"filter array must have at least 1 element")];switch(A=A.concat(Iu({key:`${l}[0]`,value:s[0],valueSpec:p.filter_operator,style:r.style,styleSpec:r.styleSpec})),L(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===L(s[1])&&A.push(new Oi(l,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&A.push(new Oi(l,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(v=ts(s[1]),"string"!==v&&A.push(new Oi(`${l}[1]`,s[1],`string expected, ${v} found`)));for(let F=2;F<s.length;F++)v=ts(s[F]),"$type"===L(s[1])?A=A.concat(Iu({key:`${l}[${F}]`,value:s[F],valueSpec:p.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==v&&"number"!==v&&"boolean"!==v&&A.push(new Oi(`${l}[${F}]`,s[F],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let F=1;F<s.length;F++)A=A.concat(Bu({key:`${l}[${F}]`,value:s[F],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":v=ts(s[1]),2!==s.length?A.push(new Oi(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==v&&A.push(new Oi(`${l}[1]`,s[1],`string expected, ${v} found`));break;case"within":v=ts(s[1]),2!==s.length?A.push(new Oi(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==v&&A.push(new Oi(`${l}[1]`,s[1],`object expected, ${v} found`))}return A}function Cd(r,s){const l=r.key,p=r.style,v=r.styleSpec,A=r.value,F=r.objectKey,N=v[`${s}_${r.layerType}`];if(!N)return[];const U=F.match(/^(.*)-transition$/);if("paint"===s&&U&&N[U[1]]&&N[U[1]].transition)return Eo({key:l,value:A,valueSpec:v.transition,style:p,styleSpec:v});const H=r.valueSpec||N[F];if(!H)return[new Oi(l,A,`unknown property "${F}"`)];let K;if("string"===ts(A)&&Sc(H)&&!H.tokens&&(K=/^{([^}]+)}$/.exec(A))){const ot=`\`{ "type": "identity", "property": ${K?JSON.stringify(K[1]):'"_"'} }\``;return[new Oi(l,A,`"${F}" does not support interpolation syntax\nUse an identity property function instead: ${ot}.`)]}const et=[];return"symbol"===r.layerType&&("text-field"===F&&p&&!p.glyphs&&et.push(new Oi(l,A,'use of "text-field" requires a style "glyphs" property')),"text-font"===F&&Jl(X(A))&&"identity"===L(A.type)&&et.push(new Oi(l,A,'"text-font" does not support identity functions'))),et.concat(Eo({key:r.key,value:A,valueSpec:H,style:p,styleSpec:v,expressionContext:"property",propertyType:s,propertyKey:F}))}function Td(r){return Cd(r,"paint")}function Ou(r){return Cd(r,"layout")}function Rr(r){let s=[];const l=r.value,p=r.key,v=r.style,A=r.styleSpec;l.type||l.ref||s.push(new Oi(p,l,'either "type" or "ref" is required'));let F=L(l.type);const N=L(l.ref);if(l.id){const U=L(l.id);for(let H=0;H<r.arrayIndex;H++){const K=v.layers[H];L(K.id)===U&&s.push(new Oi(p,l.id,`duplicate layer id "${l.id}", previously used at line ${K.id.__line__}`))}}if("ref"in l){let U;["type","source","source-layer","filter","layout"].forEach(H=>{H in l&&s.push(new Oi(p,l[H],`"${H}" is prohibited for ref layers`))}),v.layers.forEach(H=>{L(H.id)===N&&(U=H)}),U?U.ref?s.push(new Oi(p,l.ref,"ref cannot reference another ref layer")):F=L(U.type):"string"==typeof N&&s.push(new Oi(p,l.ref,`ref layer "${N}" not found`))}else if("background"!==F&&"sky"!==F)if(l.source){const U=v.sources&&v.sources[l.source],H=U&&L(U.type);U?"vector"===H&&"raster"===F?s.push(new Oi(p,l.source,`layer "${l.id}" requires a raster source`)):"raster"===H&&"raster"!==F?s.push(new Oi(p,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==H||l["source-layer"]?"raster-dem"===H&&"hillshade"!==F?s.push(new Oi(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==F||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||"geojson"===H&&U.lineMetrics||s.push(new Oi(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Oi(p,l,`layer "${l.id}" must specify a "source-layer"`)):s.push(new Oi(p,l.source,`source "${l.source}" not found`))}else s.push(new Oi(p,l,'missing required property "source"'));return s=s.concat(va({key:p,value:l,valueSpec:A.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Eo({key:`${p}.type`,value:l.type,valueSpec:A.layer.type,style:r.style,styleSpec:r.styleSpec,object:l,objectKey:"type"}),filter:U=>Md(O({layerType:F},U)),layout:U=>va({layer:l,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":H=>Ou(O({layerType:F},H))}}),paint:U=>va({layer:l,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":H=>Td(O({layerType:F},H))}})}})),s}function eh(r){const s=r.value,l=r.key,p=ts(s);return"string"!==p?[new Oi(l,s,`string expected, ${p} found`)]:[]}const Ec={promoteId:function({key:r,value:s}){if("string"===ts(s))return eh({key:r,value:s});{const l=[];for(const p in s)l.push(...eh({key:`${r}.${p}`,value:s[p]}));return l}}};function Po(r){const s=r.value,l=r.key,p=r.styleSpec,v=r.style;if(!s.type)return[new Oi(l,s,'"type" is required')];const A=L(s.type);let F;switch(A){case"vector":case"raster":case"raster-dem":return F=va({key:l,value:s,valueSpec:p[`source_${A.replace("-","_")}`],style:r.style,styleSpec:p,objectElementValidators:Ec}),F;case"geojson":if(F=va({key:l,value:s,valueSpec:p.source_geojson,style:v,styleSpec:p,objectElementValidators:Ec}),s.cluster)for(const N in s.clusterProperties){const[U,H]=s.clusterProperties[N],K="string"==typeof U?[U,["accumulated"],["get",N]]:U;F.push(...Ac({key:`${l}.${N}.map`,value:H,expressionContext:"cluster-map"})),F.push(...Ac({key:`${l}.${N}.reduce`,value:K,expressionContext:"cluster-reduce"}))}return F;case"video":return va({key:l,value:s,valueSpec:p.source_video,style:v,styleSpec:p});case"image":return va({key:l,value:s,valueSpec:p.source_image,style:v,styleSpec:p});case"canvas":return[new Oi(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Iu({key:`${l}.type`,value:s.type,valueSpec:{values:tm(p)},style:v,styleSpec:p})}}function tm(r){return r.source.reduce((s,l)=>{const p=r[l];return"enum"===p.type.type&&(s=s.concat(Object.keys(p.type.values))),s},[])}function Dc(r){const s=r.value,l=r.styleSpec,p=l.light,v=r.style;let A=[];const F=ts(s);if(void 0===s)return A;if("object"!==F)return A=A.concat([new Oi("light",s,`object expected, ${F} found`)]),A;for(const N in s){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&p[U[1]]&&p[U[1]].transition?Eo({key:N,value:s[N],valueSpec:l.transition,style:v,styleSpec:l}):p[N]?Eo({key:N,value:s[N],valueSpec:p[N],style:v,styleSpec:l}):[new Oi(N,s[N],`unknown property "${N}"`)])}return A}function Ar(r){const s=r.value,l=r.key,p=r.style,v=r.styleSpec,A=v.terrain;let F=[];const N=ts(s);if(void 0===s)return F;if("object"!==N)return F=F.concat([new Oi("terrain",s,`object expected, ${N} found`)]),F;for(const U in s){const H=U.match(/^(.*)-transition$/);F=F.concat(H&&A[H[1]]&&A[H[1]].transition?Eo({key:U,value:s[U],valueSpec:v.transition,style:p,styleSpec:v}):A[U]?Eo({key:U,value:s[U],valueSpec:A[U],style:p,styleSpec:v}):[new Oi(U,s[U],`unknown property "${U}"`)])}if(s.source){const U=p.sources&&p.sources[s.source],H=U&&L(U.type);U?"raster-dem"!==H&&F.push(new Oi(l,s.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):F.push(new Oi(l,s.source,`source "${s.source}" not found`))}else F.push(new Oi(l,s,'terrain is missing required property "source"'));return F}function em(r){const s=r.value,l=r.style,p=r.styleSpec,v=p.fog;let A=[];const F=ts(s);if(void 0===s)return A;if("object"!==F)return A=A.concat([new Oi("fog",s,`object expected, ${F} found`)]),A;for(const N in s){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&v[U[1]]&&v[U[1]].transition?Eo({key:N,value:s[N],valueSpec:p.transition,style:l,styleSpec:p}):v[N]?Eo({key:N,value:s[N],valueSpec:v[N],style:l,styleSpec:p}):[new Oi(N,s[N],`unknown property "${N}"`)])}return A}const Ic={"*":()=>[],array:Uf,boolean:function(r){const s=r.value,l=r.key,p=ts(s);return"boolean"!==p?[new Oi(l,s,`boolean expected, ${p} found`)]:[]},number:Jp,color:function(r){const s=r.key,l=r.value,p=ts(l);return"string"!==p?[new Oi(s,l,`color expected, ${p} found`)]:null===Ue(l)?[new Oi(s,l,`color expected, "${l}" found`)]:[]},enum:Iu,filter:Md,function:bd,layer:Rr,object:va,source:Po,light:Dc,terrain:Ar,fog:em,string:eh,formatted:function(r){return 0===eh(r).length?[]:Ac(r)},resolvedImage:function(r){return 0===eh(r).length?[]:Ac(r)},projection:function(r){const s=r.value,l=r.styleSpec,p=l.projection,v=r.style;let A=[];const F=ts(s);if("object"===F)for(const N in s)A=A.concat(Eo({key:N,value:s[N],valueSpec:p[N],style:v,styleSpec:l}));else"string"!==F&&(A=A.concat([new Oi("projection",s,`object or string expected, ${F} found`)]));return A}};function Eo(r){const s=r.value,l=r.valueSpec,p=r.styleSpec;return l.expression&&Jl(L(s))?bd(r):l.expression&&mr(X(s))?Ac(r):l.type&&Ic[l.type]?Ic[l.type](r):va(O({},r,{valueSpec:l.type?p[l.type]:l}))}function Vr(r){const s=r.value,l=r.key,p=eh(r);return p.length||(-1===s.indexOf("{fontstack}")&&p.push(new Oi(l,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&p.push(new Oi(l,s,'"glyphs" url must include a "{range}" token'))),p}function im(r,s=B){return fr(Eo({key:"",value:r,valueSpec:s.$root,styleSpec:s,style:r,objectElementValidators:{glyphs:Vr,"*":()=>[]}}))}const Sd=r=>fr(Td(r)),nm=r=>fr(Ou(r));function fr(r){return r.slice().sort((s,l)=>s.line&&l.line?s.line-l.line:0)}function Ru(r,s){let l=!1;if(s&&s.length)for(const p of s)r.fire(new C(new Error(p.message))),l=!0;return l}var Cl=Sn;function Sn(r,s,l){var p=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var v=new Int32Array(this.arrayBuffer);r=v[0],this.d=(s=v[1])+2*(l=v[2]);for(var A=0;A<this.d*this.d;A++){var F=v[3+A],N=v[3+A+1];p.push(F===N?null:v.subarray(F,N))}var U=v[3+p.length+1];this.keys=v.subarray(v[3+p.length],U),this.bboxes=v.subarray(U),this.insert=this._insertReadonly}else{this.d=s+2*l;for(var H=0;H<this.d*this.d;H++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=l,this.scale=s/r,this.uid=0;var K=l/s*r;this.min=-K,this.max=r+K}Sn.prototype.insert=function(r,s,l,p,v){this._forEachCell(s,l,p,v,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(v)},Sn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Sn.prototype._insertCell=function(r,s,l,p,v,A){this.cells[v].push(A)},Sn.prototype.query=function(r,s,l,p,v){var A=this.min,F=this.max;if(r<=A&&s<=A&&F<=l&&F<=p&&!v)return Array.prototype.slice.call(this.keys);var N=[];return this._forEachCell(r,s,l,p,this._queryCell,N,{},v),N},Sn.prototype._queryCell=function(r,s,l,p,v,A,F,N){var U=this.cells[v];if(null!==U)for(var H=this.keys,K=this.bboxes,et=0;et<U.length;et++){var ot=U[et];if(void 0===F[ot]){var ft=4*ot;(N?N(K[ft+0],K[ft+1],K[ft+2],K[ft+3]):r<=K[ft+2]&&s<=K[ft+3]&&l>=K[ft+0]&&p>=K[ft+1])?(F[ot]=!0,A.push(H[ot])):F[ot]=!1}}},Sn.prototype._forEachCell=function(r,s,l,p,v,A,F,N){for(var U=this._convertToCellCoord(r),H=this._convertToCellCoord(s),K=this._convertToCellCoord(l),et=this._convertToCellCoord(p),ot=U;ot<=K;ot++)for(var ft=H;ft<=et;ft++){var _t=this.d*ft+ot;if((!N||N(this._convertFromCellCoord(ot),this._convertFromCellCoord(ft),this._convertFromCellCoord(ot+1),this._convertFromCellCoord(ft+1)))&&v.call(this,r,s,l,p,_t,A,F,N))return}},Sn.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Sn.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Sn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,s=3+this.cells.length+1+1,l=0,p=0;p<this.cells.length;p++)l+=this.cells[p].length;var v=new Int32Array(s+l+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var A=s,F=0;F<r.length;F++){var N=r[F];v[3+F]=A,v.set(N,A),A+=N.length}return v[3+r.length]=A,v.set(this.keys,A),v[3+r.length+1]=A+=this.keys.length,v.set(this.bboxes,A),A+=this.bboxes.length,v.buffer};const Fc={};function Hi(r,s,l={}){Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),Fc[s]={klass:r,omit:l.omit||[]}}Hi(Object,"Object"),Cl.serialize=function(r,s){const l=r.toArrayBuffer();return s&&s.push(l),{buffer:l}},Cl.deserialize=function(r){return new Cl(r.buffer)},Object.defineProperty(Cl,"name",{value:"Grid"}),Hi(Cl,"Grid"),Hi(ji,"Color"),Hi(Error,"Error"),Hi($s,"AJAXError"),Hi(Zn,"ResolvedImage"),Hi(_d,"StylePropertyFunction"),Hi(Ql,"StyleExpression",{omit:["_evaluator"]}),Hi(ql,"ZoomDependentExpression"),Hi(Du,"ZoomConstantExpression"),Hi(Di,"CompoundExpression",{omit:["_evaluate"]});for(const r in Oa)Fc[Oa[r]._classRegistryKey]||Hi(Oa[r],`Expression${r}`);function sm(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function Lc(r){return De.ImageBitmap&&r instanceof De.ImageBitmap}function Bc(r,s){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(sm(r)||Lc(r))return s&&s.push(r),r;if(ArrayBuffer.isView(r)){const l=r;return s&&s.push(l.buffer),l}if(r instanceof De.ImageData)return s&&s.push(r.data.buffer),r;if(Array.isArray(r)){const l=[];for(const p of r)l.push(Bc(p,s));return l}if("object"==typeof r){const l=r.constructor,p=l._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const v=l.serialize?l.serialize(r,s):{};if(!l.serialize){for(const A in r)r.hasOwnProperty(A)&&(Fc[p].omit.indexOf(A)>=0||(v[A]=Bc(r[A],s)));r instanceof Error&&(v.message=r.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==p&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof r)}function Rh(r){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||sm(r)||Lc(r)||ArrayBuffer.isView(r)||r instanceof De.ImageData)return r;if(Array.isArray(r))return r.map(Rh);if("object"==typeof r){const s=r.$name||"Object",{klass:l}=Fc[s];if(!l)throw new Error(`can't deserialize unregistered class ${s}`);if(l.deserialize)return l.deserialize(r);const p=Object.create(l.prototype);for(const v of Object.keys(r))"$name"!==v&&(p[v]=Rh(r[v]));return p}throw new Error("can't deserialize object of type "+typeof r)}const Oc=r=>r>=1536&&r<=1791,om=r=>r>=1872&&r<=1919,gi=r=>r>=2208&&r<=2303,ms=r=>r>=11904&&r<=12031,ih=r=>r>=12032&&r<=12255,nh=r=>r>=12272&&r<=12287,Do=r=>r>=12288&&r<=12351,Rc=r=>r>=12352&&r<=12447,Ra=r=>r>=12448&&r<=12543,Zr=r=>r>=12544&&r<=12591,kd=r=>r>=12704&&r<=12735,Ad=r=>r>=12736&&r<=12783,Vu=r=>r>=12784&&r<=12799,Hf=r=>r>=12800&&r<=13055,zu=r=>r>=13056&&r<=13311,gr=r=>r>=13312&&r<=19903,ba=r=>r>=19968&&r<=40959,Nu=r=>r>=40960&&r<=42127,sh=r=>r>=42128&&r<=42191,Va=r=>r>=44032&&r<=55215,rm=r=>r>=63744&&r<=64255,Vc=r=>r>=64336&&r<=65023,zc=r=>r>=65040&&r<=65055,S=r=>r>=65072&&r<=65103,h=r=>r>=65104&&r<=65135,_=r=>r>=65136&&r<=65279,P=r=>r>=65280&&r<=65519;function V(r){for(const s of r)if(G(s.charCodeAt(0)))return!0;return!1}function W(r){for(const s of r)if(!$(s.charCodeAt(0)))return!1;return!0}function $(r){return!(Oc(r)||om(r)||gi(r)||Vc(r)||_(r))}function G(r){return!(746!==r&&747!==r&&(r<4352||!(kd(r)||Zr(r)||S(r)&&!(r>=65097&&r<=65103)||rm(r)||zu(r)||ms(r)||Ad(r)||!(!Do(r)||r>=12296&&r<=12305||r>=12308&&r<=12319||12336===r)||gr(r)||ba(r)||Hf(r)||(s=r,s>=12592&&s<=12687)||(s=>s>=43360&&s<=43391)(r)||(s=>s>=55216&&s<=55295)(r)||(s=>s>=4352&&s<=4607)(r)||Va(r)||Rc(r)||nh(r)||(s=>s>=12688&&s<=12703)(r)||ih(r)||Vu(r)||Ra(r)&&12540!==r||!(!P(r)||65288===r||65289===r||65293===r||r>=65306&&r<=65310||65339===r||65341===r||65343===r||r>=65371&&r<=65503||65507===r||r>=65512&&r<=65519)||!(!h(r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||(s=>s>=5120&&s<=5759)(r)||(s=>s>=6320&&s<=6399)(r)||zc(r)||(s=>s>=19904&&s<=19967)(r)||Nu(r)||sh(r))));var s}function tt(r){return!(G(r)||(s=r,(l=s)>=128&&l<=255&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||(l=>l>=8192&&l<=8303)(s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||(l=>l>=8448&&l<=8527)(s)||(l=>l>=8528&&l<=8591)(s)||(l=>l>=8960&&l<=9215)(s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||(l=>l>=9216&&l<=9279)(s)&&9251!==s||(l=>l>=9280&&l<=9311)(s)||(l=>l>=9312&&l<=9471)(s)||(l=>l>=9632&&l<=9727)(s)||(l=>l>=9728&&l<=9983)(s)&&!(s>=9754&&s<=9759)||(l=>l>=11008&&l<=11263)(s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Do(s)||Ra(s)||(l=>l>=57344&&l<=63743)(s)||S(s)||h(s)||P(s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s,l}function ht(r){return r>=1424&&r<=2303||Vc(r)||_(r)}function lt(r,s){return!(!s&&ht(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||(l=r,l>=6016&&l<=6143));var l}function bt(r){for(const s of r)if(ht(s.charCodeAt(0)))return!0;return!1}const Dt="deferred",Bt="loading",Nt="loaded";let Ot=null,zt="unavailable",At=null;const Qt=function(r){r&&"string"==typeof r&&r.indexOf("NetworkError")>-1&&(zt="error"),Ot&&Ot(r)};function Jt(){ne.fire(new k("pluginStateChange",{pluginStatus:zt,pluginURL:At}))}const ne=new R,me=function(){return zt},ue=function(){if(zt!==Dt||!At)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");zt=Bt,Jt(),At&&Gn({url:At},r=>{r?Qt(r):(zt=Nt,Jt())})},ge={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>zt===Nt||null!=ge.applyArabicShaping,isLoading:()=>zt===Bt,setState(r){zt=r.pluginStatus,At=r.pluginURL},isParsed:()=>null!=ge.applyArabicShaping&&null!=ge.processBidirectionalText&&null!=ge.processStyledBidirectionalText,getPluginURL:()=>At};class be{constructor(s,l){this.zoom=s,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(l,p){for(const v of l)if(!lt(v.charCodeAt(0),p))return!1;return!0}(s,ge.isLoaded())}}class Pe{constructor(s,l){this.property=s,this.value=l,this.expression=function(p,v){if(Jl(p))return new _d(p,v);if(mr(p)){const A=th(p,v);if("error"===A.result)throw new Error(A.value.map(F=>`${F.key}: ${F.message}`).join(", "));return A.value}{let A=p;return"string"==typeof p&&"color"===v.type&&(A=ji.parse(p)),{kind:"constant",evaluate:()=>A}}}(void 0===l?s.specification.default:l,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,l,p){return this.property.possiblyEvaluate(this,s,l,p)}}class Ie{constructor(s){this.property=s,this.value=new Pe(s,void 0)}transitioned(s,l){return new Se(this.property,this.value,l,ln({},s.transition,this.transition),s.now)}untransitioned(){return new Se(this.property,this.value,null,{},0)}}class yi{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Yt(this._values[s].value.value)}setValue(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Ie(this._values[s].property)),this._values[s].value=new Pe(this._values[s].property,null===l?void 0:Yt(l))}getTransition(s){return Yt(this._values[s].transition)}setTransition(s,l){this._values.hasOwnProperty(s)||(this._values[s]=new Ie(this._values[s].property)),this._values[s].transition=Yt(l)||void 0}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(s[l]=p);const v=this.getTransition(l);void 0!==v&&(s[`${l}-transition`]=v)}return s}transitioned(s,l){const p=new Je(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(s,l._values[v]);return p}untransitioned(){const s=new Je(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].untransitioned();return s}}class Se{constructor(s,l,p,v,A){const F=v.delay||0,N=v.duration||0;A=A||0,this.property=s,this.value=l,this.begin=A+F,this.end=this.begin+N,s.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(s,l,p){const v=s.now||0,A=this.value.possiblyEvaluate(s,l,p),F=this.prior;if(F){if(v>this.end)return this.prior=null,A;if(this.value.isDataDriven())return this.prior=null,A;if(v<this.begin)return F.possiblyEvaluate(s,l,p);{const N=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(s,l,p),A,zi(N))}}return A}}class Je{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,l,p){const v=new Fe(this._properties);for(const A of Object.keys(this._values))v._values[A]=this._values[A].possiblyEvaluate(s,l,p);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Ve{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return Yt(this._values[s].value)}setValue(s,l){this._values[s]=new Pe(this._values[s].property,null===l?void 0:Yt(l))}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);void 0!==p&&(s[l]=p)}return s}possiblyEvaluate(s,l,p){const v=new Fe(this._properties);for(const A of Object.keys(this._values))v._values[A]=this._values[A].possiblyEvaluate(s,l,p);return v}}class ti{constructor(s,l,p){this.property=s,this.value=l,this.parameters=p}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,l,p,v){return this.property.evaluate(this.value,this.parameters,s,l,p,v)}}class Fe{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class we{constructor(s){this.specification=s}possiblyEvaluate(s,l){return s.expression.evaluate(l)}interpolate(s,l,p){const v=el[this.specification.type];return v?v(s,l,p):s}}class Be{constructor(s,l){this.specification=s,this.overrides=l}possiblyEvaluate(s,l,p,v){return new ti(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(l,null,{},p,v)}:s.expression,l)}interpolate(s,l,p){if("constant"!==s.value.kind||"constant"!==l.value.kind)return s;if(void 0===s.value.value||void 0===l.value.value)return new ti(this,{kind:"constant",value:void 0},s.parameters);const v=el[this.specification.type];return v?new ti(this,{kind:"constant",value:v(s.value.value,l.value.value,p)},s.parameters):s}evaluate(s,l,p,v,A,F){return"constant"===s.kind?s.value:s.evaluate(l,p,v,A,F)}}class ei{constructor(s){this.specification=s}possiblyEvaluate(s,l,p,v){return!!s.expression.evaluate(l,null,{},p,v)}interpolate(){return!1}}class ci{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new be(0,{});for(const p in s){const v=s[p];v.specification.overridable&&this.overridableProperties.push(p);const A=this.defaultPropertyValues[p]=new Pe(v,void 0),F=this.defaultTransitionablePropertyValues[p]=new Ie(v);this.defaultTransitioningPropertyValues[p]=F.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=A.possiblyEvaluate(l)}}}function qi(r,s){return 256*(r=Wi(Math.floor(r),0,255))+Wi(Math.floor(s),0,255)}Hi(Be,"DataDrivenProperty"),Hi(we,"DataConstantProperty"),Hi(ei,"ColorRampProperty");const Xn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gi{constructor(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function nn(r,s=1){let l=0,p=0;return{members:r.map(v=>{const A=Xn[v.type].BYTES_PER_ELEMENT,F=l=Kn(l,Math.max(s,A)),N=v.components||1;return p=Math.max(p,A),l+=A*N,{name:v.name,type:v.type,components:N,offset:F}}),size:Kn(l,Math.max(p,s)),alignment:s}}function Kn(r,s){return Math.ceil(r/s)*s}class sn extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const v=2*s;return this.int16[v+0]=l,this.int16[v+1]=p,s}}sn.prototype.bytesPerElement=4,Hi(sn,"StructArrayLayout2i4");class fs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,p)}emplace(s,l,p,v){const A=3*s;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=v,s}}fs.prototype.bytesPerElement=6,Hi(fs,"StructArrayLayout3i6");class vs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,v){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,p,v)}emplace(s,l,p,v,A){const F=4*s;return this.int16[F+0]=l,this.int16[F+1]=p,this.int16[F+2]=v,this.int16[F+3]=A,s}}vs.prototype.bytesPerElement=8,Hi(vs,"StructArrayLayout4i8");class Ds extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N){const U=this.length;return this.resize(U+1),this.emplace(U,s,l,p,v,A,F,N)}emplace(s,l,p,v,A,F,N,U){const H=6*s,K=12*s,et=3*s;return this.int16[H+0]=l,this.int16[H+1]=p,this.uint8[K+4]=v,this.uint8[K+5]=A,this.uint8[K+6]=F,this.uint8[K+7]=N,this.float32[et+2]=U,s}}Ds.prototype.bytesPerElement=12,Hi(Ds,"StructArrayLayout2i4ub1f12");class Ns extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,p,v)}emplace(s,l,p,v,A){const F=4*s;return this.float32[F+0]=l,this.float32[F+1]=p,this.float32[F+2]=v,this.float32[F+3]=A,s}}Ns.prototype.bytesPerElement=16,Hi(Ns,"StructArrayLayout4f16");class bo extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A){const F=this.length;return this.resize(F+1),this.emplace(F,s,l,p,v,A)}emplace(s,l,p,v,A,F){const N=6*s,U=3*s;return this.uint16[N+0]=l,this.uint16[N+1]=p,this.uint16[N+2]=v,this.uint16[N+3]=A,this.float32[U+2]=F,s}}bo.prototype.bytesPerElement=12,Hi(bo,"StructArrayLayout4ui1f12");class xr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,v){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,p,v)}emplace(s,l,p,v,A){const F=4*s;return this.uint16[F+0]=l,this.uint16[F+1]=p,this.uint16[F+2]=v,this.uint16[F+3]=A,s}}xr.prototype.bytesPerElement=8,Hi(xr,"StructArrayLayout4ui8");class zr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F){const N=this.length;return this.resize(N+1),this.emplace(N,s,l,p,v,A,F)}emplace(s,l,p,v,A,F,N){const U=6*s;return this.int16[U+0]=l,this.int16[U+1]=p,this.int16[U+2]=v,this.int16[U+3]=A,this.int16[U+4]=F,this.int16[U+5]=N,s}}zr.prototype.bytesPerElement=12,Hi(zr,"StructArrayLayout6i12");class Tl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N,U,H,K,et,ot){const ft=this.length;return this.resize(ft+1),this.emplace(ft,s,l,p,v,A,F,N,U,H,K,et,ot)}emplace(s,l,p,v,A,F,N,U,H,K,et,ot,ft){const _t=12*s;return this.int16[_t+0]=l,this.int16[_t+1]=p,this.int16[_t+2]=v,this.int16[_t+3]=A,this.uint16[_t+4]=F,this.uint16[_t+5]=N,this.uint16[_t+6]=U,this.uint16[_t+7]=H,this.int16[_t+8]=K,this.int16[_t+9]=et,this.int16[_t+10]=ot,this.int16[_t+11]=ft,s}}Tl.prototype.bytesPerElement=24,Hi(Tl,"StructArrayLayout4i4ui4i24");class qs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F){const N=this.length;return this.resize(N+1),this.emplace(N,s,l,p,v,A,F)}emplace(s,l,p,v,A,F,N){const U=10*s,H=5*s;return this.int16[U+0]=l,this.int16[U+1]=p,this.int16[U+2]=v,this.float32[H+2]=A,this.float32[H+3]=F,this.float32[H+4]=N,s}}qs.prototype.bytesPerElement=20,Hi(qs,"StructArrayLayout3i3f20");class Bs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint32[1*s+0]=l,s}}Bs.prototype.bytesPerElement=4,Hi(Bs,"StructArrayLayout1ul4");class ds extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N,U,H,K,et,ot,ft){const _t=this.length;return this.resize(_t+1),this.emplace(_t,s,l,p,v,A,F,N,U,H,K,et,ot,ft)}emplace(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t){const St=20*s,Lt=10*s;return this.int16[St+0]=l,this.int16[St+1]=p,this.int16[St+2]=v,this.int16[St+3]=A,this.int16[St+4]=F,this.float32[Lt+3]=N,this.float32[Lt+4]=U,this.float32[Lt+5]=H,this.float32[Lt+6]=K,this.int16[St+14]=et,this.uint32[Lt+8]=ot,this.uint16[St+18]=ft,this.uint16[St+19]=_t,s}}ds.prototype.bytesPerElement=40,Hi(ds,"StructArrayLayout5i4f1i1ul2ui40");class Is extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N){const U=this.length;return this.resize(U+1),this.emplace(U,s,l,p,v,A,F,N)}emplace(s,l,p,v,A,F,N,U){const H=8*s;return this.int16[H+0]=l,this.int16[H+1]=p,this.int16[H+2]=v,this.int16[H+4]=A,this.int16[H+5]=F,this.int16[H+6]=N,this.int16[H+7]=U,s}}Is.prototype.bytesPerElement=16,Hi(Is,"StructArrayLayout3i2i2i16");class yr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A){const F=this.length;return this.resize(F+1),this.emplace(F,s,l,p,v,A)}emplace(s,l,p,v,A,F){const N=4*s,U=8*s;return this.float32[N+0]=l,this.float32[N+1]=p,this.float32[N+2]=v,this.int16[U+6]=A,this.int16[U+7]=F,s}}yr.prototype.bytesPerElement=16,Hi(yr,"StructArrayLayout2f1f2i16");class Os extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,p,v)}emplace(s,l,p,v,A){const F=12*s,N=3*s;return this.uint8[F+0]=l,this.uint8[F+1]=p,this.float32[N+1]=v,this.float32[N+2]=A,s}}Os.prototype.bytesPerElement=12,Hi(Os,"StructArrayLayout2ub2f12");class Ho extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,p)}emplace(s,l,p,v){const A=3*s;return this.float32[A+0]=l,this.float32[A+1]=p,this.float32[A+2]=v,s}}Ho.prototype.bytesPerElement=12,Hi(Ho,"StructArrayLayout3f12");class ir extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,l,p)}emplace(s,l,p,v){const A=3*s;return this.uint16[A+0]=l,this.uint16[A+1]=p,this.uint16[A+2]=v,s}}ir.prototype.bytesPerElement=6,Hi(ir,"StructArrayLayout3ui6");class za extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de){const ce=this.length;return this.resize(ce+1),this.emplace(ce,s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de)}emplace(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de,ce){const Ce=30*s,ke=15*s,je=60*s;return this.int16[Ce+0]=l,this.int16[Ce+1]=p,this.int16[Ce+2]=v,this.float32[ke+2]=A,this.float32[ke+3]=F,this.uint16[Ce+8]=N,this.uint16[Ce+9]=U,this.uint32[ke+5]=H,this.uint32[ke+6]=K,this.uint32[ke+7]=et,this.uint16[Ce+16]=ot,this.uint16[Ce+17]=ft,this.uint16[Ce+18]=_t,this.float32[ke+10]=St,this.float32[ke+11]=Lt,this.uint8[je+48]=Zt,this.uint8[je+49]=he,this.uint8[je+50]=Ut,this.uint32[ke+13]=ae,this.int16[Ce+28]=de,this.uint8[je+58]=ce,s}}za.prototype.bytesPerElement=60,Hi(za,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Sl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de,ce,Ce,ke,je,si,Ae,Ye,Ge,oi){const di=this.length;return this.resize(di+1),this.emplace(di,s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de,ce,Ce,ke,je,si,Ae,Ye,Ge,oi)}emplace(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt,Zt,he,Ut,ae,de,ce,Ce,ke,je,si,Ae,Ye,Ge,oi,di){const Oe=38*s,Ci=19*s;return this.int16[Oe+0]=l,this.int16[Oe+1]=p,this.int16[Oe+2]=v,this.float32[Ci+2]=A,this.float32[Ci+3]=F,this.int16[Oe+8]=N,this.int16[Oe+9]=U,this.int16[Oe+10]=H,this.int16[Oe+11]=K,this.int16[Oe+12]=et,this.int16[Oe+13]=ot,this.uint16[Oe+14]=ft,this.uint16[Oe+15]=_t,this.uint16[Oe+16]=St,this.uint16[Oe+17]=Lt,this.uint16[Oe+18]=Zt,this.uint16[Oe+19]=he,this.uint16[Oe+20]=Ut,this.uint16[Oe+21]=ae,this.uint16[Oe+22]=de,this.uint16[Oe+23]=ce,this.uint16[Oe+24]=Ce,this.uint16[Oe+25]=ke,this.uint16[Oe+26]=je,this.uint16[Oe+27]=si,this.uint16[Oe+28]=Ae,this.uint32[Ci+15]=Ye,this.float32[Ci+16]=Ge,this.float32[Ci+17]=oi,this.float32[Ci+18]=di,s}}Sl.prototype.bytesPerElement=76,Hi(Sl,"StructArrayLayout3i2f6i15ui1ul3f76");class Kr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.float32[1*s+0]=l,s}}Kr.prototype.bytesPerElement=4,Hi(Kr,"StructArrayLayout1f4");class Jr extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,v,A){const F=this.length;return this.resize(F+1),this.emplace(F,s,l,p,v,A)}emplace(s,l,p,v,A,F){const N=5*s;return this.float32[N+0]=l,this.float32[N+1]=p,this.float32[N+2]=v,this.float32[N+3]=A,this.float32[N+4]=F,s}}Jr.prototype.bytesPerElement=20,Hi(Jr,"StructArrayLayout5f20");class Na extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,v){const A=this.length;return this.resize(A+1),this.emplace(A,s,l,p,v)}emplace(s,l,p,v,A){const F=6*s;return this.uint32[3*s+0]=l,this.uint16[F+2]=p,this.uint16[F+3]=v,this.uint16[F+4]=A,s}}Na.prototype.bytesPerElement=12,Hi(Na,"StructArrayLayout1ul3ui12");class nl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const v=2*s;return this.uint16[v+0]=l,this.uint16[v+1]=p,s}}nl.prototype.bytesPerElement=4,Hi(nl,"StructArrayLayout2ui4");class sl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint16[1*s+0]=l,s}}sl.prototype.bytesPerElement=2,Hi(sl,"StructArrayLayout1ui2");class Vh extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const v=2*s;return this.float32[v+0]=l,this.float32[v+1]=p,s}}Vh.prototype.bytesPerElement=8,Hi(Vh,"StructArrayLayout2f8");class Wu extends Gi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Wu.prototype.size=40;class oh extends ds{get(s){return new Wu(this,s)}}Hi(oh,"CollisionBoxArray");class py extends Gi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}py.prototype.size=60;class $f extends za{get(s){return new py(this,s)}}Hi($f,"PlacedSymbolArray");class Gf extends Gi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Gf.prototype.size=76;class Nc extends Sl{get(s){return new Gf(this,s)}}Hi(Nc,"SymbolInstanceArray");class my extends Kr{getoffsetX(s){return this.float32[1*s+0]}}Hi(my,"GlyphOffsetArray");class Ro extends sn{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Hi(Ro,"SymbolLineVertexArray");class am extends Gi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}am.prototype.size=12;class fy extends Na{get(s){return new am(this,s)}}Hi(fy,"FeatureIndexArray");class Zf extends nl{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Hi(Zf,"FillExtrusionCentroidArray");const Xu=nn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Pd=nn([{name:"a_dash",components:4,type:"Uint16"}]);var Wa={},Ed={get exports(){return Wa},set exports(r){Wa=r}},lm={};({get exports(){return lm},set exports(r){lm=r}}).exports=function(r,s){var l,p,v,A,F,N,U,H;for(p=r.length-(l=3&r.length),v=s,F=3432918353,N=461845907,H=0;H<p;)U=255&r.charCodeAt(H)|(255&r.charCodeAt(++H))<<8|(255&r.charCodeAt(++H))<<16|(255&r.charCodeAt(++H))<<24,++H,v=27492+(65535&(A=5*(65535&(v=(v^=U=(65535&(U=(U=(65535&U)*F+(((U>>>16)*F&65535)<<16)&4294967295)<<15|U>>>17))*N+(((U>>>16)*N&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(U=0,l){case 3:U^=(255&r.charCodeAt(H+2))<<16;case 2:U^=(255&r.charCodeAt(H+1))<<8;case 1:v^=U=(65535&(U=(U=(65535&(U^=255&r.charCodeAt(H)))*F+(((U>>>16)*F&65535)<<16)&4294967295)<<15|U>>>17))*N+(((U>>>16)*N&65535)<<16)&4294967295}return v^=r.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0};var ju={};({get exports(){return ju},set exports(r){ju=r}}).exports=function(r,s){for(var l,p=r.length,v=s^p,A=0;p>=4;)l=1540483477*(65535&(l=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24))+((1540483477*(l>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++A;switch(p){case 3:v^=(255&r.charCodeAt(A+2))<<16;case 2:v^=(255&r.charCodeAt(A+1))<<8;case 1:v=1540483477*(65535&(v^=255&r.charCodeAt(A)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};var Wc=lm,gC=ju;Ed.exports=Wc,Wa.murmur3=Wc,Wa.murmur2=gC;class hm{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,l,p,v){this.ids.push(Bi(s)),this.positions.push(l,p,v)}getPositions(s){const l=Bi(s);let p=0,v=this.ids.length-1;for(;p<v;){const F=p+v>>1;this.ids[F]>=l?v=F:p=F+1}const A=[];for(;this.ids[p]===l;)A.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return A}static serialize(s,l){const p=new Float64Array(s.ids),v=new Uint32Array(s.positions);return gy(p,v,0,p.length-1),l&&l.push(p.buffer,v.buffer),{ids:p,positions:v}}static deserialize(s){const l=new hm;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l}}function Bi(r){const s=+r;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:Wa(String(r))}function gy(r,s,l,p){for(;l<p;){const v=r[l+p>>1];let A=l-1,F=p+1;for(;;){do{A++}while(r[A]<v);do{F--}while(r[F]>v);if(A>=F)break;Kf(r,A,F),Kf(s,3*A,3*F),Kf(s,3*A+1,3*F+1),Kf(s,3*A+2,3*F+2)}F-l<p-F?(gy(r,s,l,F),l=F+1):(gy(r,s,F+1,p),p=F)}}function Kf(r,s,l){const p=r[s];r[s]=r[l],r[l]=p}Hi(hm,"FeaturePositionMap");class zh{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,l),this.initialized=!0),!!this.location}}class Jf extends zh{constructor(s){super(s),this.current=0}set(s,l,p){this.fetchUniformLocation(s,l)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class Zv extends zh{constructor(s){super(s),this.current=[0,0,0,0]}set(s,l,p){this.fetchUniformLocation(s,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Kv extends zh{constructor(s){super(s),this.current=ji.transparent}set(s,l,p){this.fetchUniformLocation(s,l)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const xC=new Float32Array(16),Uu=new Float32Array(9),yC=new Float32Array(4);function xy(r){return[qi(255*r.r,255*r.g),qi(255*r.b,255*r.a)]}class Io{constructor(s,l,p){this.value=s,this.uniformNames=l.map(v=>`u_${v}`),this.type=p}setUniform(s,l,p,v,A){l.set(s,A,v.constantOr(this.value))}getBinding(s,l){return"color"===this.type?new Kv(s):new Jf(s)}}class Nh{constructor(s,l){this.uniformNames=l.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,l,p,v,A){const F="u_pattern"===A||"u_dash"===A?this.pattern:"u_pixel_ratio"===A?this.pixelRatio:null;F&&l.set(s,A,F)}getBinding(s,l){return"u_pattern"===l||"u_dash"===l?new Zv(s):new Jf(s)}}class wa{constructor(s,l,p,v){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(A=>({name:`a_${A}`,type:"Float32",components:"color"===p?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,l,p,v,A,F){const N=this.paintVertexArray.length,U=this.expression.evaluate(new be(0),l,{},A,v,F);this.paintVertexArray.resize(s),this._setPaintValue(N,s,U)}updatePaintArray(s,l,p,v,A){const F=this.expression.evaluate({zoom:0},p,v,void 0,A);this._setPaintValue(s,l,F)}_setPaintValue(s,l,p){if("color"===this.type){const v=xy(p);for(let A=s;A<l;A++)this.paintVertexArray.emplace(A,v[0],v[1])}else{for(let v=s;v<l;v++)this.paintVertexArray.emplace(v,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ol{constructor(s,l,p,v,A,F){this.expression=s,this.uniformNames=l.map(N=>`u_${N}_t`),this.type=p,this.useIntegerZoom=v,this.zoom=A,this.maxValue=0,this.paintVertexAttributes=l.map(N=>({name:`a_${N}`,type:"Float32",components:"color"===p?4:2,offset:0})),this.paintVertexArray=new F}populatePaintArray(s,l,p,v,A,F){const N=this.expression.evaluate(new be(this.zoom),l,{},A,v,F),U=this.expression.evaluate(new be(this.zoom+1),l,{},A,v,F),H=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(H,s,N,U)}updatePaintArray(s,l,p,v,A){const F=this.expression.evaluate({zoom:this.zoom},p,v,void 0,A),N=this.expression.evaluate({zoom:this.zoom+1},p,v,void 0,A);this._setPaintValue(s,l,F,N)}_setPaintValue(s,l,p,v){if("color"===this.type){const A=xy(p),F=xy(v);for(let N=s;N<l;N++)this.paintVertexArray.emplace(N,A[0],A[1],F[0],F[1])}else{for(let A=s;A<l;A++)this.paintVertexArray.emplace(A,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,l,p,v,A){const F=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,N=Wi(this.expression.interpolationFactor(F,this.zoom,this.zoom+1),0,1);l.set(s,A,N)}getBinding(s,l){return new Jf(s)}}class nr{constructor(s,l,p,v,A){this.expression=s,this.layerId=A,this.paintVertexAttributes=("array"===p?Pd:Xu).members;for(let F=0;F<l.length;++F);this.paintVertexArray=new v}populatePaintArray(s,l,p){const v=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(v,s,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(s,l,p,v,A,F){this._setPaintValues(s,l,p.patterns&&p.patterns[this.layerId],F)}_setPaintValues(s,l,p,v){if(!v||!p)return;const A=v[p];if(!A)return;const{tl:F,br:N,pixelRatio:U}=A;for(let H=s;H<l;H++)this.paintVertexArray.emplace(H,F[0],F[1],N[0],N[1],U)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ra{constructor(s,l,p=(()=>!0)){this.binders={},this._buffers=[];const v=[];for(const A in s.paint._values){if(!p(A))continue;const F=s.paint.get(A);if(!(F instanceof ti&&Sc(F.property.specification)))continue;const N=Yu(A,s.type),U=F.value,H=F.property.specification.type,K=!!F.property.useIntegerZoom,et="line-dasharray"===A||A.endsWith("pattern"),ot="line-dasharray"===A&&"constant"!==s.layout.get("line-cap").value.kind;if("constant"!==U.kind||ot)if("source"===U.kind||ot||et){const ft=yy(A,H,"source");this.binders[A]=et?new nr(U,N,H,ft,s.id):new wa(U,N,H,ft),v.push(`/a_${A}`)}else{const ft=yy(A,H,"composite");this.binders[A]=new ol(U,N,H,K,l,ft),v.push(`/z_${A}`)}else this.binders[A]=et?new Nh(U.value,N):new Io(U.value,N,H),v.push(`/u_${A}`)}this.cacheKey=v.sort().join("")}getMaxValue(s){const l=this.binders[s];return l instanceof wa||l instanceof ol?l.maxValue:0}populatePaintArrays(s,l,p,v,A,F){for(const N in this.binders){const U=this.binders[N];(U instanceof wa||U instanceof ol||U instanceof nr)&&U.populatePaintArray(s,l,p,v,A,F)}}setConstantPatternPositions(s){for(const l in this.binders){const p=this.binders[l];p instanceof Nh&&p.setConstantPatternPositions(s)}}updatePaintArrays(s,l,p,v,A,F){let N=!1;for(const U in s){const H=l.getPositions(U);for(const K of H){const et=p.feature(K.index);for(const ot in this.binders){const ft=this.binders[ot];if((ft instanceof wa||ft instanceof ol||ft instanceof nr)&&!0===ft.expression.isStateDependent){const _t=v.paint.get(ot);ft.expression=_t.value,ft.updatePaintArray(K.start,K.end,et,s[U],A,F),N=!0}}}}return N}defines(){const s=[];for(const l in this.binders){const p=this.binders[l];(p instanceof Io||p instanceof Nh)&&s.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof wa||p instanceof ol||p instanceof nr)for(let v=0;v<p.paintVertexAttributes.length;v++)s.push(p.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof Io||p instanceof Nh||p instanceof ol)for(const v of p.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const l=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof Io||v instanceof Nh||v instanceof ol)for(const A of v.uniformNames)l.push({name:A,property:p,binding:v.getBinding(s,A)})}return l}setUniforms(s,l,p,v,A){for(const{name:F,property:N,binding:U}of p)this.binders[N].setUniform(s,U,A,v.get(N),F)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const l=this.binders[s];(l instanceof wa||l instanceof ol||l instanceof nr)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(s){for(const l in this.binders){const p=this.binders[l];(p instanceof wa||p instanceof ol||p instanceof nr)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const l=this.binders[s];(l instanceof wa||l instanceof ol||l instanceof nr)&&l.destroy()}}}class Wh{constructor(s,l,p=(()=>!0)){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new ra(v,l,p);this.needsUpload=!1,this._featureMap=new hm,this._bufferOffset=0}populatePaintArrays(s,l,p,v,A,F,N){for(const U in this.programConfigurations)this.programConfigurations[U].populatePaintArrays(s,l,v,A,F,N);void 0!==l.id&&this._featureMap.add(l.id,p,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,l,p,v,A){for(const F of p)this.needsUpload=this.programConfigurations[F.id].updatePaintArrays(s,this._featureMap,l,F,v,A)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const cm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Yu(r,s){return cm[r]||[r.replace(`${s}-`,"").replace(/-/g,"_")]}const Jv={"line-pattern":{source:bo,composite:bo},"fill-pattern":{source:bo,composite:bo},"fill-extrusion-pattern":{source:bo,composite:bo},"line-dasharray":{source:xr,composite:xr}},_C={color:{source:Vh,composite:Ns},number:{source:Kr,composite:Vh}};function yy(r,s,l){const p=Jv[r];return p&&p[l]||_C[s][l]}Hi(Io,"ConstantBinder"),Hi(Nh,"PatternConstantBinder"),Hi(wa,"SourceExpressionBinder"),Hi(nr,"PatternCompositeBinder"),Hi(ol,"CompositeExpressionBinder"),Hi(ra,"ProgramConfiguration",{omit:["_buffers"]}),Hi(Wh,"ProgramConfigurationSet");const Qf="-transition";class Fo extends R{constructor(s,l){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&"sky"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),l.layout&&(this._unevaluatedLayout=new Ve(l.layout)),l.paint)){this._transitionablePaint=new yi(l.paint);for(const p in s.paint)this.setPaintProperty(p,s.paint[p],{validate:!1});for(const p in s.layout)this.setLayoutProperty(p,s.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fe(l.paint)}}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,l,p={}){null!=l&&this._validate(nm,`layers.${this.id}.layout.${s}`,s,l,p)||("visibility"!==s?this._unevaluatedLayout.setValue(s,l):this.visibility=l)}getPaintProperty(s){return Ze(s,Qf)?this._transitionablePaint.getTransition(s.slice(0,-Qf.length)):this._transitionablePaint.getValue(s)}setPaintProperty(s,l,p={}){if(null!=l&&this._validate(Sd,`layers.${this.id}.paint.${s}`,s,l,p))return!1;if(Ze(s,Qf))return this._transitionablePaint.setTransition(s.slice(0,-Qf.length),l||void 0),!1;{const v=this._transitionablePaint._values[s],A=v.value.isDataDriven(),F=v.value;this._transitionablePaint.setValue(s,l),this._handleSpecialPaintPropertyUpdate(s);const N=this._transitionablePaint._values[s].value,U=N.isDataDriven(),H=Ze(s,"pattern")||"line-dasharray"===s;return U||A||H||this._handleOverridablePaintPropertyUpdate(s,F,N)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,l,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,l)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),rt(s,(l,p)=>!(void 0===l||"layout"===p&&!Object.keys(l).length||"paint"===p&&!Object.keys(l).length))}_validate(s,l,p,v,A={}){return(!A||!1!==A.validate)&&Ru(this,s.call(im,{key:l,layerType:this.type,objectKey:p,value:v,styleSpec:B,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const l=this.paint.get(s);if(l instanceof ti&&Sc(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Fu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const qf=nn([{name:"a_pos",components:2,type:"Int16"}],4),Dd=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Vo{constructor(s=[]){this.segments=s}prepareSegment(s,l,p,v){let A=this.segments[this.segments.length-1];return s>Vo.MAX_VERTEX_ARRAY_LENGTH&&Xt(`Max vertices per segment is ${Vo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!A||A.vertexLength+s>Vo.MAX_VERTEX_ARRAY_LENGTH||A.sortKey!==v)&&(A={vertexOffset:l.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},void 0!==v&&(A.sortKey=v),this.segments.push(A)),A}get(){return this.segments}destroy(){for(const s of this.segments)for(const l in s.vaos)s.vaos[l].destroy()}static simpleSegment(s,l,p,v){return new Vo([{vertexOffset:s,primitiveOffset:l,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}Vo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hi(Vo,"SegmentVector");var _n=8192;class Xh{constructor(s,l){s&&(l?this.setSouthWest(s).setNorthEast(l):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof ns?new ns(s.lng,s.lat):ns.convert(s),this}setSouthWest(s){return this._sw=s instanceof ns?new ns(s.lng,s.lat):ns.convert(s),this}extend(s){const l=this._sw,p=this._ne;let v,A;if(s instanceof ns)v=s,A=s;else{if(!(s instanceof Xh))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(Xh.convert(s)):this.extend(ns.convert(s)):"object"==typeof s&&null!==s&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(ns.convert(s)):this;if(v=s._sw,A=s._ne,!v||!A)return this}return l||p?(l.lng=Math.min(v.lng,l.lng),l.lat=Math.min(v.lat,l.lat),p.lng=Math.max(A.lng,p.lng),p.lat=Math.max(A.lat,p.lat)):(this._sw=new ns(v.lng,v.lat),this._ne=new ns(A.lng,A.lat)),this}getCenter(){return new ns((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ns(this.getWest(),this.getNorth())}getSouthEast(){return new ns(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:l,lat:p}=ns.convert(s);let v=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(s){return!s||s instanceof Xh?s:new Xh(s)}}var dm=1e-6,aa=typeof Float32Array<"u"?Float32Array:Array;function _y(){var r=new aa(9);return aa!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function vy(r,s,l){var p=s[0],v=s[1],A=s[2],F=s[3],N=s[4],U=s[5],H=s[6],K=s[7],et=s[8],ot=l[0],ft=l[1],_t=l[2],St=l[3],Lt=l[4],Zt=l[5],he=l[6],Ut=l[7],ae=l[8];return r[0]=ot*p+ft*F+_t*H,r[1]=ot*v+ft*N+_t*K,r[2]=ot*A+ft*U+_t*et,r[3]=St*p+Lt*F+Zt*H,r[4]=St*v+Lt*N+Zt*K,r[5]=St*A+Lt*U+Zt*et,r[6]=he*p+Ut*F+ae*H,r[7]=he*v+Ut*N+ae*K,r[8]=he*A+Ut*U+ae*et,r}function rl(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Hu(r,s){var l=s[0],p=s[1],v=s[2],A=s[3],F=s[4],N=s[5],U=s[6],H=s[7],K=s[8],et=s[9],ot=s[10],ft=s[11],_t=s[12],St=s[13],Lt=s[14],Zt=s[15],he=l*N-p*F,Ut=l*U-v*F,ae=l*H-A*F,de=p*U-v*N,ce=p*H-A*N,Ce=v*H-A*U,ke=K*St-et*_t,je=K*Lt-ot*_t,si=K*Zt-ft*_t,Ae=et*Lt-ot*St,Ye=et*Zt-ft*St,Ge=ot*Zt-ft*Lt,oi=he*Ge-Ut*Ye+ae*Ae+de*si-ce*je+Ce*ke;return oi?(r[0]=(N*Ge-U*Ye+H*Ae)*(oi=1/oi),r[1]=(v*Ye-p*Ge-A*Ae)*oi,r[2]=(St*Ce-Lt*ce+Zt*de)*oi,r[3]=(ot*ce-et*Ce-ft*de)*oi,r[4]=(U*si-F*Ge-H*je)*oi,r[5]=(l*Ge-v*si+A*je)*oi,r[6]=(Lt*ae-_t*Ce-Zt*Ut)*oi,r[7]=(K*Ce-ot*ae+ft*Ut)*oi,r[8]=(F*Ye-N*si+H*ke)*oi,r[9]=(p*si-l*Ye-A*ke)*oi,r[10]=(_t*ce-St*ae+Zt*he)*oi,r[11]=(et*ae-K*ce-ft*he)*oi,r[12]=(N*je-F*Ae-U*ke)*oi,r[13]=(l*Ae-p*je+v*ke)*oi,r[14]=(St*Ut-_t*de-Lt*he)*oi,r[15]=(K*de-et*Ut+ot*he)*oi,r):null}function kl(r,s,l){var p=s[0],v=s[1],A=s[2],F=s[3],N=s[4],U=s[5],H=s[6],K=s[7],et=s[8],ot=s[9],ft=s[10],_t=s[11],St=s[12],Lt=s[13],Zt=s[14],he=s[15],Ut=l[0],ae=l[1],de=l[2],ce=l[3];return r[0]=Ut*p+ae*N+de*et+ce*St,r[1]=Ut*v+ae*U+de*ot+ce*Lt,r[2]=Ut*A+ae*H+de*ft+ce*Zt,r[3]=Ut*F+ae*K+de*_t+ce*he,r[4]=(Ut=l[4])*p+(ae=l[5])*N+(de=l[6])*et+(ce=l[7])*St,r[5]=Ut*v+ae*U+de*ot+ce*Lt,r[6]=Ut*A+ae*H+de*ft+ce*Zt,r[7]=Ut*F+ae*K+de*_t+ce*he,r[8]=(Ut=l[8])*p+(ae=l[9])*N+(de=l[10])*et+(ce=l[11])*St,r[9]=Ut*v+ae*U+de*ot+ce*Lt,r[10]=Ut*A+ae*H+de*ft+ce*Zt,r[11]=Ut*F+ae*K+de*_t+ce*he,r[12]=(Ut=l[12])*p+(ae=l[13])*N+(de=l[14])*et+(ce=l[15])*St,r[13]=Ut*v+ae*U+de*ot+ce*Lt,r[14]=Ut*A+ae*H+de*ft+ce*Zt,r[15]=Ut*F+ae*K+de*_t+ce*he,r}function Xc(r,s,l){var p,v,A,F,N,U,H,K,et,ot,ft,_t,St=l[0],Lt=l[1],Zt=l[2];return s===r?(r[12]=s[0]*St+s[4]*Lt+s[8]*Zt+s[12],r[13]=s[1]*St+s[5]*Lt+s[9]*Zt+s[13],r[14]=s[2]*St+s[6]*Lt+s[10]*Zt+s[14],r[15]=s[3]*St+s[7]*Lt+s[11]*Zt+s[15]):(v=s[1],A=s[2],F=s[3],N=s[4],U=s[5],H=s[6],K=s[7],et=s[8],ot=s[9],ft=s[10],_t=s[11],r[0]=p=s[0],r[1]=v,r[2]=A,r[3]=F,r[4]=N,r[5]=U,r[6]=H,r[7]=K,r[8]=et,r[9]=ot,r[10]=ft,r[11]=_t,r[12]=p*St+N*Lt+et*Zt+s[12],r[13]=v*St+U*Lt+ot*Zt+s[13],r[14]=A*St+H*Lt+ft*Zt+s[14],r[15]=F*St+K*Lt+_t*Zt+s[15]),r}function la(r,s,l){var p=l[0],v=l[1],A=l[2];return r[0]=s[0]*p,r[1]=s[1]*p,r[2]=s[2]*p,r[3]=s[3]*p,r[4]=s[4]*v,r[5]=s[5]*v,r[6]=s[6]*v,r[7]=s[7]*v,r[8]=s[8]*A,r[9]=s[9]*A,r[10]=s[10]*A,r[11]=s[11]*A,r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r}function um(r,s,l){var p=Math.sin(l),v=Math.cos(l),A=s[4],F=s[5],N=s[6],U=s[7],H=s[8],K=s[9],et=s[10],ot=s[11];return s!==r&&(r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15]),r[4]=A*v+H*p,r[5]=F*v+K*p,r[6]=N*v+et*p,r[7]=U*v+ot*p,r[8]=H*v-A*p,r[9]=K*v-F*p,r[10]=et*v-N*p,r[11]=ot*v-U*p,r}function rh(r,s,l){var p=Math.sin(l),v=Math.cos(l),A=s[0],F=s[1],N=s[2],U=s[3],H=s[8],K=s[9],et=s[10],ot=s[11];return s!==r&&(r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15]),r[0]=A*v-H*p,r[1]=F*v-K*p,r[2]=N*v-et*p,r[3]=U*v-ot*p,r[8]=A*p+H*v,r[9]=F*p+K*v,r[10]=N*p+et*v,r[11]=U*p+ot*v,r}function by(r,s){return r[0]=s[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=s[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function tg(r,s,l){var p,v,A,F=l[0],N=l[1],U=l[2],H=Math.hypot(F,N,U);return H<dm?null:(F*=H=1/H,N*=H,U*=H,p=Math.sin(s),v=Math.cos(s),r[0]=F*F*(A=1-v)+v,r[1]=N*F*A+U*p,r[2]=U*F*A-N*p,r[3]=0,r[4]=F*N*A-U*p,r[5]=N*N*A+v,r[6]=U*N*A+F*p,r[7]=0,r[8]=F*U*A+N*p,r[9]=N*U*A-F*p,r[10]=U*U*A+v,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,s=arguments.length;s--;)r+=arguments[s]*arguments[s];return Math.sqrt(r)});var $u=kl;function Id(){var r=new aa(3);return aa!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function eg(r){var s=new aa(3);return s[0]=r[0],s[1]=r[1],s[2]=r[2],s}function Gu(r){return Math.hypot(r[0],r[1],r[2])}function Fd(r,s,l){var p=new aa(3);return p[0]=r,p[1]=s,p[2]=l,p}function ha(r,s,l){return r[0]=s[0]+l[0],r[1]=s[1]+l[1],r[2]=s[2]+l[2],r}function jc(r,s,l){return r[0]=s[0]-l[0],r[1]=s[1]-l[1],r[2]=s[2]-l[2],r}function wy(r,s,l){return r[0]=s[0]*l[0],r[1]=s[1]*l[1],r[2]=s[2]*l[2],r}function pm(r,s,l){return r[0]=Math.min(s[0],l[0]),r[1]=Math.min(s[1],l[1]),r[2]=Math.min(s[2],l[2]),r}function Ld(r,s,l){return r[0]=Math.max(s[0],l[0]),r[1]=Math.max(s[1],l[1]),r[2]=Math.max(s[2],l[2]),r}function Ma(r,s,l){return r[0]=s[0]*l,r[1]=s[1]*l,r[2]=s[2]*l,r}function mm(r,s,l,p){return r[0]=s[0]+l[0]*p,r[1]=s[1]+l[1]*p,r[2]=s[2]+l[2]*p,r}function Nr(r,s){var l=s[0],p=s[1],v=s[2],A=l*l+p*p+v*v;return A>0&&(A=1/Math.sqrt(A)),r[0]=s[0]*A,r[1]=s[1]*A,r[2]=s[2]*A,r}function Xa(r,s){return r[0]*s[0]+r[1]*s[1]+r[2]*s[2]}function ig(r,s,l){var p=s[0],v=s[1],A=s[2],F=l[0],N=l[1],U=l[2];return r[0]=v*U-A*N,r[1]=A*F-p*U,r[2]=p*N-v*F,r}function go(r,s,l){var p=s[0],v=s[1],A=s[2],F=l[3]*p+l[7]*v+l[11]*A+l[15];return r[0]=(l[0]*p+l[4]*v+l[8]*A+l[12])/(F=F||1),r[1]=(l[1]*p+l[5]*v+l[9]*A+l[13])/F,r[2]=(l[2]*p+l[6]*v+l[10]*A+l[14])/F,r}function ng(r,s,l){var p=l[0],v=l[1],A=l[2],F=s[0],N=s[1],U=s[2],H=v*U-A*N,K=A*F-p*U,et=p*N-v*F,ot=v*et-A*K,ft=A*H-p*et,_t=p*K-v*H,St=2*l[3];return K*=St,et*=St,ft*=2,_t*=2,r[0]=F+(H*=St)+(ot*=2),r[1]=N+K+ft,r[2]=U+et+_t,r}var Zu,ja=jc,vC=wy,My=Gu;function Qv(r,s,l){return r[0]=s[0]*l,r[1]=s[1]*l,r[2]=s[2]*l,r[3]=s[3]*l,r}function Cy(r,s){var l=s[0],p=s[1],v=s[2],A=s[3],F=l*l+p*p+v*v+A*A;return F>0&&(F=1/Math.sqrt(F)),r[0]=l*F,r[1]=p*F,r[2]=v*F,r[3]=A*F,r}function Uc(r,s,l){var p=s[0],v=s[1],A=s[2],F=s[3];return r[0]=l[0]*p+l[4]*v+l[8]*A+l[12]*F,r[1]=l[1]*p+l[5]*v+l[9]*A+l[13]*F,r[2]=l[2]*p+l[6]*v+l[10]*A+l[14]*F,r[3]=l[3]*p+l[7]*v+l[11]*A+l[15]*F,r}function fm(){var r=new aa(4);return aa!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function qv(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function tb(r,s,l){l*=.5;var p=s[0],v=s[1],A=s[2],F=s[3],N=Math.sin(l),U=Math.cos(l);return r[0]=p*U+F*N,r[1]=v*U+A*N,r[2]=A*U-v*N,r[3]=F*U-p*N,r}function gm(r,s,l){l*=.5;var p=s[0],v=s[1],A=s[2],F=s[3],N=Math.sin(l),U=Math.cos(l);return r[0]=p*U-A*N,r[1]=v*U+F*N,r[2]=A*U+p*N,r[3]=F*U-v*N,r}Id(),Zu=new aa(4),aa!=Float32Array&&(Zu[0]=0,Zu[1]=0,Zu[2]=0,Zu[3]=0);var bC=Cy;Id(),Fd(1,0,0),Fd(0,1,0),fm(),fm(),_y();const wC=nn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:eb}=wC,ib=nn([{name:"a_pos_3",components:3,type:"Int16"}]);var xm=nn([{name:"a_pos",type:"Int16",components:2}]);class sg{constructor(s,l){this.pos=s,this.dir=l}intersectsPlane(s,l,p){const v=Xa(l,this.dir);if(Math.abs(v)<1e-6)return!1;const A=((s[0]-this.pos[0])*l[0]+(s[1]-this.pos[1])*l[1]+(s[2]-this.pos[2])*l[2])/v;return p[0]=this.pos[0]+this.dir[0]*A,p[1]=this.pos[1]+this.dir[1]*A,p[2]=this.pos[2]+this.dir[2]*A,!0}closestPointOnSphere(s,l,p){if(St=(ft=this.pos)[0],Lt=ft[1],Zt=ft[2],he=(_t=s)[0],Ut=_t[1],ae=_t[2],Math.abs(St-he)<=dm*Math.max(1,Math.abs(St),Math.abs(he))&&Math.abs(Lt-Ut)<=dm*Math.max(1,Math.abs(Lt),Math.abs(Ut))&&Math.abs(Zt-ae)<=dm*Math.max(1,Math.abs(Zt),Math.abs(ae))||0===l)return p[0]=p[1]=p[2]=0,!1;var ft,_t,St,Lt,Zt,he,Ut,ae;const[v,A,F]=this.dir,N=this.pos[0]-s[0],U=this.pos[1]-s[1],H=this.pos[2]-s[2],K=v*v+A*A+F*F,et=2*(N*v+U*A+H*F),ot=et*et-4*K*(N*N+U*U+H*H-l*l);if(ot<0){const ft=Math.max(-et/2,0),_t=N+v*ft,St=U+A*ft,Lt=H+F*ft,Zt=Math.hypot(_t,St,Lt);return p[0]=_t*l/Zt,p[1]=St*l/Zt,p[2]=Lt*l/Zt,!1}{const ft=(-et-Math.sqrt(ot))/(2*K);if(ft<0){const _t=Math.hypot(N,U,H);return p[0]=N*l/_t,p[1]=U*l/_t,p[2]=H*l/_t,!1}return p[0]=N+v*ft,p[1]=U+A*ft,p[2]=H+F*ft,!0}}}class ym{constructor(s,l,p,v,A){this.TL=s,this.TR=l,this.BR=p,this.BL=v,this.horizon=A}static fromInvProjectionMatrix(s,l,p){const v=[-1,1,1],A=[1,1,1],F=[1,-1,1],N=[-1,-1,1],U=go(v,v,s),H=go(A,A,s),K=go(F,F,s),et=go(N,N,s);return new ym(U,H,K,et,l/p)}}class Ku{constructor(s,l){this.points=s,this.planes=l}static fromInvProjectionMatrix(s,l,p,v){const A=Math.pow(2,p),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>{const H=Uc([],U,s),K=1/H[3]/l*A;return(et=H)[0]=(ot=H)[0]*(ft=[K,K,v?1/H[3]:K,K])[0],et[1]=ot[1]*ft[1],et[2]=ot[2]*ft[2],et[3]=ot[3]*ft[3],et;var et,ot,ft}),N=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(U=>{const H=Nr([],ig([],ja([],F[U[0]],F[U[1]]),ja([],F[U[2]],F[U[1]]))),K=-Xa(H,F[U[1]]);return H.concat(K)});return new Ku(F,N)}}class Pr{static fromPoints(s){const l=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const v of s)pm(l,l,v),Ld(p,p,v);return new Pr(l,p)}static applyTransform(s,l){const p=s.getCorners();for(let v=0;v<p.length;++v)go(p[v],p[v],l);return Pr.fromPoints(p)}constructor(s,l){this.min=s,this.max=l,this.center=Ma([],ha([],this.min,this.max),.5)}quadrant(s){const l=[s%2==0,s<2],p=eg(this.min),v=eg(this.max);for(let A=0;A<l.length;A++)p[A]=l[A]?this.min[A]:this.center[A],v[A]=l[A]?this.center[A]:this.max[A];return v[2]=this.max[2],new Pr(p,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,l=this.max;return[[s[0],s[1],s[2]],[l[0],s[1],s[2]],[l[0],l[1],s[2]],[s[0],l[1],s[2]],[s[0],s[1],l[2]],[l[0],s[1],l[2]],[l[0],l[1],l[2]],[s[0],l[1],l[2]]]}intersects(s){const l=this.getCorners();let p=!0;for(let v=0;v<s.planes.length;v++){const A=s.planes[v];let F=0;for(let N=0;N<l.length;N++)F+=Xa(A,l[N])+A[3]>=0;if(0===F)return 0;F!==l.length&&(p=!1)}if(p)return 2;for(let v=0;v<3;v++){let A=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let N=0;N<s.points.length;N++){const U=s.points[N][v]-this.min[v];A=Math.min(A,U),F=Math.max(F,U)}if(F<0||A>this.max[v]-this.min[v])return 0}return 1}}const al=_n/Math.PI/2,_r=[64,32,16],Ua=-al,Ya=al,nb=[new Pr([Ua,Ua,Ua],[Ya,Ya,Ya]),new Pr([Ua,Ua,Ua],[0,0,Ya]),new Pr([0,Ua,Ua],[Ya,0,Ya]),new Pr([Ua,0,Ua],[0,Ya,Ya]),new Pr([0,0,Ua],[Ya,Ya,Ya])];function Ju(r){return r*al/Hc}function _m(r,s,l,p=!0){const v=Ma([],r._camera.position,r.worldSize),A=[s,l,1,1];Uc(A,A,r.pixelMatrixInverse),Qv(A,A,1/A[3]);const F=Nr([],ja([],A,v)),N=r.globeMatrix,U=[N[12],N[13],N[14]],H=ja([],U,v),K=Gu(H),et=Nr([],H),ot=r.worldSize/(2*Math.PI),ft=Xa(et,F),_t=Math.asin(ot/K);if(_t<Math.acos(ft)){if(!p)return null;const si=[],Ae=[];Ma(si,F,K/ft),Nr(Ae,ja(Ae,si,H)),Nr(F,ha(F,H,Ma(F,Ae,Math.tan(_t)*K)))}const St=[];new sg(v,F).closestPointOnSphere(U,ot,St);const Lt=Nr([],Qi(N,0)),Zt=Nr([],Qi(N,1)),he=Nr([],Qi(N,2)),Ut=Xa(Lt,St),ae=Xa(Zt,St),de=Xa(he,St),ce=cn(Math.asin(-ae/ot));let Ce=cn(Math.atan2(Ut,de));Ce=r.center.lng+function(si,Ae){const Ye=(Ae-si+180)%360-180;return Ye<-180?Ye+360:Ye}(r.center.lng,Ce);const ke=Pl(Ce),je=Wi(Ha(ce),0,1);return new Hh(ke,je)}class sb{constructor(s,l,p){this.a=ja([],s,p),this.b=ja([],l,p),this.center=p;const v=Nr([],this.a),A=Nr([],this.b);this.angle=Math.acos(Xa(v,A))}}function og(r,s){if(0===r.angle)return null;let l;return l=0===r.a[s]?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[s]/r.a[s]/Math.sin(r.angle)-1/Math.tan(r.angle)),l<0||l>1?null:function(p,v,A,F){const N=Math.sin(A);return p*(Math.sin((1-F)*A)/N)+v*(Math.sin(F*A)/N)}(r.a[s],r.b[s],r.angle,Wi(l,0,1))+r.center[s]}function Al(r){if(r.z<=1)return nb[r.z+2*r.y+r.x];const s=vm(Bd(r));return Pr.fromPoints(s)}function Uh(r,s,l){return Ma(r,r,1-l),mm(r,r,s,l)}function Ty(r,s){const l=Yc(s.zoom);if(0===l)return Al(r);const p=Bd(r),v=vm(p),A=Pl(p.getWest())*s.worldSize,F=Pl(p.getEast())*s.worldSize,N=Ha(p.getNorth())*s.worldSize,U=Ha(p.getSouth())*s.worldSize,H=[A,N,0],K=[F,N,0],et=[A,U,0],ot=[F,U,0],ft=Hu([],s.globeMatrix);return go(H,H,ft),go(K,K,ft),go(et,et,ft),go(ot,ot,ft),v[0]=Uh(v[0],et,l),v[1]=Uh(v[1],ot,l),v[2]=Uh(v[2],K,l),v[3]=Uh(v[3],H,l),Pr.fromPoints(v)}function Sy(r,s,l){for(const p of r)go(p,p,s),Ma(p,p,l)}function Bd({x:r,y:s,z:l}){const p=1/(1<<l),v=new ns(da(r*p),Lo((s+1)*p)),A=new ns(da((r+1)*p),Lo(s*p));return new Xh(v,A)}function vm(r){const s=Xi(r.getNorth()),l=Xi(r.getSouth()),p=Math.cos(s),v=Math.cos(l),A=Math.sin(s),F=Math.sin(l),N=r.getWest(),U=r.getEast();return[Yh(v,F,N),Yh(v,F,U),Yh(p,A,U),Yh(p,A,N)]}function Yh(r,s,l,p=al){return l=Xi(l),[r*Math.sin(l)*p,-s*p,r*Math.cos(l)*p]}function No(r,s,l){return Yh(Math.cos(Xi(r)),Math.sin(Xi(r)),s,l)}function ah(r,s,l,p){const v=1<<l.z,A=(r/_n+l.x)/v;return No(Lo((s/_n+l.y)/v),da(A),p)}function Qu({min:r,max:s}){return 16383/Math.max(s[0]-r[0],s[1]-r[1],s[2]-r[2])}const rg=new Float64Array(16);function qu(r){const s=Qu(r),l=by(rg,[s,s,s]);return Xc(l,l,((p=[])[0]=-(v=r.min)[0],p[1]=-v[1],p[2]=-v[2],p));var p,v}function bm(r){const s=(p=r.min,(l=rg)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=p[0],l[13]=p[1],l[14]=p[2],l[15]=1,l);var l,p;const v=1/Qu(r);return la(s,s,[v,v,v])}function ky(r,s,l,p,v){const A=function(U){const H=_n/(2*Math.PI);return U/(2*Math.PI)/H}(l),F=[r,s,-l/(2*Math.PI)],N=rl(new Float64Array(16));return Xc(N,N,F),la(N,N,[A,A,A]),um(N,N,Xi(-v)),rh(N,N,Xi(-p)),N}function Yc(r){return As(5,6,r)}function Ay(r,s){const l=No(s.lat,s.lng);return F=(v=jc([],function(_t){const St=No(_t._center.lat,_t._center.lng);let Lt=ig([],Fd(0,1,0),St);const Zt=tg([],-_t.angle,St);Lt=go(Lt,Lt,Zt),tg(Zt,-_t._pitch,Lt);const he=Nr([],St);return Ma(he,he,Ju(_t.cameraToCenterDistance/_t.pixelsPerMeter)),go(he,he,Zt),ha([],St,he)}(r),l))[0],N=v[1],U=v[2],H=(A=l)[0],K=A[1],et=A[2],ft=(ot=Math.sqrt(F*F+N*N+U*U)*Math.sqrt(H*H+K*K+et*et))&&Xa(v,A)/ot,Math.acos(Math.min(Math.max(ft,-1),1));var v,A,F,N,U,H,K,et,ot,ft}function wm(r,s){return Ay(r,s)>Math.PI/2*1.01}const Py=Xi(85),ob=Math.cos(Py),ag=Math.sin(Py),Hc=6371008.8,Ey=2*Math.PI*Hc;class ns{constructor(s,l){if(isNaN(s)||isNaN(l))throw new Error(`Invalid LngLat object: (${s}, ${l})`);if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ns(Ri(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const l=Math.PI/180,p=this.lat*l,v=s.lat*l,A=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((s.lng-this.lng)*l);return Hc*Math.acos(Math.min(A,1))}toBounds(s=0){const l=360*s/40075017,p=l/Math.cos(Math.PI/180*this.lat);return new Xh(new ns(this.lng-p,this.lat-l),new ns(this.lng+p,this.lat+l))}toEcef(s){const l=Ju(s);return No(this.lat,this.lng,al+l)}static convert(s){if(s instanceof ns)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new ns(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new ns(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function lg(r){return Ey*Math.cos(r*Math.PI/180)}function Pl(r){return(180+r)/360}function Ha(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ca(r,s){return r/lg(s)}function da(r){return 360*r-180}function Lo(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Mm(r,s){return r*lg(Lo(s))}const sr=85.051129;function Dy(r){return 1/Math.cos(r*Math.PI/180)}class Hh{constructor(s,l,p=0){this.x=+s,this.y=+l,this.z=+p}static fromLngLat(s,l=0){const p=ns.convert(s);return new Hh(Pl(p.lng),Ha(p.lat),Ca(l,p.lat))}toLngLat(){return new ns(da(this.x),Lo(this.y))}toAltitude(){return Mm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ey*Dy(Lo(this.y))}}function hg(r,s,l,p,v,A,F,N,U){const H=(s+p)/2,K=(l+v)/2,et=new xi(H,K);N(et),function(ot,ft,_t,St,Lt,Zt){const he=_t-Lt,Ut=St-Zt;return Math.abs((St-ft)*he-(_t-ot)*Ut)/Math.hypot(he,Ut)}(et.x,et.y,A.x,A.y,F.x,F.y)>=U?(hg(r,s,l,H,K,A,et,N,U),hg(r,H,K,p,v,et,F,N,U)):r.push(F)}function Iy(r,s,l){let p=r[0],v=p.x,A=p.y;s(p);const F=[p];for(let N=1;N<r.length;N++){const U=r[N],{x:H,y:K}=U;s(U),hg(F,v,A,H,K,p,U,s,l),v=H,A=K,p=U}return F}function cg(r,s,l,p){if(p(s,l)){const v=s.add(l)._mult(.5);cg(r,s,v,p),cg(r,v,l,p)}else r.push(l)}function rb(r,s){let l=r[0];const p=[l];for(let v=1;v<r.length;v++){const A=r[v];cg(p,l,A,s),l=A}return p}const dg=Math.pow(2,14)-1,Fy=-dg-1;function Ly(r,s){const l=Math.round(r.x*s),p=Math.round(r.y*s);return r.x=Wi(l,Fy,dg),r.y=Wi(p,Fy,dg),(l<r.x||l>r.x+1||p<r.y||p>r.y+1)&&Xt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function ll(r,s,l){const p=r.loadGeometry(),v=r.extent,A=_n/v;if(s&&l&&l.projection.isReprojectedInTileSpace){const F=1<<s.z,{scale:N,x:U,y:H,projection:K}=l,et=ot=>{const ft=da((s.x+ot.x/v)/F),_t=Lo((s.y+ot.y/v)/F),St=K.project(ft,_t);ot.x=(St.x*N-U)*v,ot.y=(St.y*N-H)*v};for(let ot=0;ot<p.length;ot++)if(1!==r.type)p[ot]=Iy(p[ot],et,1);else{const ft=[];for(const _t of p[ot])_t.x<0||_t.x>=v||_t.y<0||_t.y>=v||(et(_t),ft.push(_t));p[ot]=ft}}for(const F of p)for(const N of F)Ly(N,A);return p}function $h(r,s){return{type:r.type,id:r.id,properties:r.properties,geometry:s?ll(r):[]}}function Od(r,s,l,p,v){r.emplaceBack(2*s+(p+1)/2,2*l+(v+1)/2)}function Cm(r,s,l){r.emplaceBack(s.x,s.y,s.z,16384*l[0],16384*l[1],16384*l[2])}class ug{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new sn,this.indexArray=new ir,this.segments=new Vo,this.programConfigurations=new Wh(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,p,v){const A=this.layers[0],F=[];let N=null;"circle"===A.type&&(N=A.layout.get("circle-sort-key"));for(const{feature:H,id:K,index:et,sourceLayerIndex:ot}of s){const ft=this.layers[0]._featureFilter.needGeometry,_t=$h(H,ft);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),_t,p))continue;const St=N?N.evaluate(_t,{},p):void 0,Lt={id:K,properties:H.properties,type:H.type,sourceLayerIndex:ot,index:et,geometry:ft?_t.geometry:ll(H,p,v),patterns:{},sortKey:St};F.push(Lt)}N&&F.sort((H,K)=>H.sortKey-K.sortKey);let U=null;"globe"===v.projection.name&&(this.globeExtVertexArray=new zr,U=v.projection);for(const H of F){const{geometry:K,index:et,sourceLayerIndex:ot}=H,ft=s[et].feature;this.addFeature(H,K,et,l.availableImages,p,U),l.featureIndex.insert(ft,K,et,ot,this.index)}}update(s,l,p,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,p,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,qf.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Dd.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,l,p,v,A,F){for(const N of l)for(const U of N){const H=U.x,K=U.y;if(H<0||H>=_n||K<0||K>=_n)continue;if(F){const ft=F.projectTilePoint(H,K,A),_t=F.upVector(A,H,K),St=this.globeExtVertexArray;Cm(St,ft,_t),Cm(St,ft,_t),Cm(St,ft,_t),Cm(St,ft,_t)}const et=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),ot=et.vertexLength;Od(this.layoutVertexArray,H,K,-1,-1),Od(this.layoutVertexArray,H,K,1,-1),Od(this.layoutVertexArray,H,K,1,1),Od(this.layoutVertexArray,H,K,-1,1),this.indexArray.emplaceBack(ot,ot+1,ot+2),this.indexArray.emplaceBack(ot,ot+2,ot+3),et.vertexLength+=4,et.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},v,A)}}function pg(r,s){for(let l=0;l<r.length;l++)if(Zh(s,r[l]))return!0;for(let l=0;l<s.length;l++)if(Zh(r,s[l]))return!0;return!!Tm(r,s)}function By(r,s,l){return!!Zh(r,s)||!!Ry(s,r,l)}function Gh(r,s){if(1===r.length)return Vy(s,r[0]);for(let l=0;l<s.length;l++){const p=s[l];for(let v=0;v<p.length;v++)if(Zh(r,p[v]))return!0}for(let l=0;l<r.length;l++)if(Vy(s,r[l]))return!0;for(let l=0;l<s.length;l++)if(Tm(r,s[l]))return!0;return!1}function Oy(r,s,l){if(r.length>1){if(Tm(r,s))return!0;for(let p=0;p<s.length;p++)if(Ry(s[p],r,l))return!0}for(let p=0;p<r.length;p++)if(Ry(r[p],s,l))return!0;return!1}function Tm(r,s){if(0===r.length||0===s.length)return!1;for(let l=0;l<r.length-1;l++){const p=r[l],v=r[l+1];for(let A=0;A<s.length-1;A++)if(ab(p,v,s[A],s[A+1]))return!0}return!1}function ab(r,s,l,p){return xe(r,l,p)!==xe(s,l,p)&&xe(r,s,l)!==xe(r,s,p)}function Ry(r,s,l){const p=l*l;if(1===s.length)return r.distSqr(s[0])<p;for(let v=1;v<s.length;v++)if(tp(r,s[v-1],s[v])<p)return!0;return!1}function tp(r,s,l){const p=s.distSqr(l);if(0===p)return r.distSqr(s);const v=((r.x-s.x)*(l.x-s.x)+(r.y-s.y)*(l.y-s.y))/p;return r.distSqr(v<0?s:v>1?l:l.sub(s)._mult(v)._add(s))}function Vy(r,s){let l,p,v,A=!1;for(let F=0;F<r.length;F++){l=r[F];for(let N=0,U=l.length-1;N<l.length;U=N++)p=l[N],v=l[U],p.y>s.y!=v.y>s.y&&s.x<(v.x-p.x)*(s.y-p.y)/(v.y-p.y)+p.x&&(A=!A)}return A}function Zh(r,s){let l=!1;for(let p=0,v=r.length-1;p<r.length;v=p++){const A=r[p],F=r[v];A.y>s.y!=F.y>s.y&&s.x<(F.x-A.x)*(s.y-A.y)/(F.y-A.y)+A.x&&(l=!l)}return l}function mg(r,s,l,p,v){for(const F of r)if(s<=F.x&&l<=F.y&&p>=F.x&&v>=F.y)return!0;const A=[new xi(s,l),new xi(s,v),new xi(p,v),new xi(p,l)];if(r.length>2)for(const F of A)if(Zh(r,F))return!0;for(let F=0;F<r.length-1;F++)if(zy(r[F],r[F+1],A))return!0;return!1}function zy(r,s,l){const p=l[0],v=l[2];if(r.x<p.x&&s.x<p.x||r.x>v.x&&s.x>v.x||r.y<p.y&&s.y<p.y||r.y>v.y&&s.y>v.y)return!1;const A=xe(r,s,l[0]);return A!==xe(r,s,l[1])||A!==xe(r,s,l[2])||A!==xe(r,s,l[3])}function Kh(r,s,l){const p=s.paint.get(r).value;return"constant"===p.kind?p.value:l.programConfigurations.get(s.id).getMaxValue(r)}function ep(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ip(r,s,l,p,v){if(!s[0]&&!s[1])return r;const A=xi.convert(s)._mult(v);"viewport"===l&&A._rotate(-p);const F=[];for(let N=0;N<r.length;N++)F.push(r[N].sub(A));return F}function np(r,s,l,p){const v=xi.convert(r)._mult(p);return"viewport"===s&&v._rotate(-l),v}Hi(ug,"CircleBucket",{omit:["layers"]});const Ny=new ci({"circle-sort-key":new Be(B.layout_circle["circle-sort-key"])});var fg={paint:new ci({"circle-radius":new Be(B.paint_circle["circle-radius"]),"circle-color":new Be(B.paint_circle["circle-color"]),"circle-blur":new Be(B.paint_circle["circle-blur"]),"circle-opacity":new Be(B.paint_circle["circle-opacity"]),"circle-translate":new we(B.paint_circle["circle-translate"]),"circle-translate-anchor":new we(B.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new we(B.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new we(B.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Be(B.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Be(B.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Be(B.paint_circle["circle-stroke-opacity"])}),layout:Ny};function Sm(r,s,l,p,v,A,F,N,U){if(A&&r.queryGeometry.isAboveHorizon)return!1;A&&(U*=r.pixelToTileUnitsFactor);const H=r.tileID.canonical,K=l.projection.upVectorScale(H,l.center.lat,l.worldSize).metersToTile;for(const et of s)for(const ot of et){const ft=ot.add(N),_t=v&&l.elevation?l.elevation.exaggeration()*v.getElevationAt(ft.x,ft.y,!0):0,St=l.projection.projectTilePoint(ft.x,ft.y,H);if(_t>0){const Ut=l.projection.upVector(H,ft.x,ft.y);St.x+=Ut[0]*K*_t,St.y+=Ut[1]*K*_t,St.z+=Ut[2]*K*_t}const Lt=A?ft:gg(St.x,St.y,St.z,p),Zt=A?r.tilespaceRays.map(Ut=>Wy(Ut,_t)):r.queryGeometry.screenGeometry,he=Uc([],[St.x,St.y,St.z,1],p);if(!F&&A?U*=he[3]/l.cameraToCenterDistance:F&&!A&&(U*=l.cameraToCenterDistance/he[3]),A){const Ut=Lo((ot.y/_n+H.y)/(1<<H.z));U/=l.projection.pixelsPerMeter(Ut,1)/Ca(1,Ut)}if(By(Zt,Lt,U))return!0}return!1}function gg(r,s,l,p){const v=Uc([],[r,s,l,1],p);return new xi(v[0]/v[3],v[1]/v[3])}const Rd=Fd(0,0,0),lb=Fd(0,0,1);function Wy(r,s){const l=Id();return Rd[2]=s,r.intersectsPlane(Rd,lb,l),new xi(l[0],l[1])}class Xy extends ug{}function jy(r,{width:s,height:l},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*l*p)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*l*p);return r.width=s,r.height=l,r.data=v,r}function Uy(r,s,l){const{width:p,height:v}=s;p===r.width&&v===r.height||(km(r,s,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,p),height:Math.min(r.height,v)},l),r.width=p,r.height=v,r.data=s.data)}function km(r,s,l,p,v,A){if(0===v.width||0===v.height)return s;if(v.width>r.width||v.height>r.height||l.x>r.width-v.width||l.y>r.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||p.x>s.width-v.width||p.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const F=r.data,N=s.data;for(let U=0;U<v.height;U++){const H=((l.y+U)*r.width+l.x)*A,K=((p.y+U)*s.width+p.x)*A;for(let et=0;et<v.width*A;et++)N[K+et]=F[H+et]}return s}Hi(Xy,"HeatmapBucket",{omit:["layers"]});class El{constructor(s,l){jy(this,s,1,l)}resize(s){Uy(this,new El(s),1)}clone(){return new El({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,v,A){km(s,l,p,v,A,1)}}class Er{constructor(s,l){jy(this,s,4,l)}resize(s){Uy(this,new Er(s),4)}replace(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Er({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,v,A){km(s,l,p,v,A,4)}}Hi(El,"AlphaImage"),Hi(Er,"RGBAImage");var xg={paint:new ci({"heatmap-radius":new Be(B.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Be(B.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new we(B.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ei(B.paint_heatmap["heatmap-color"]),"heatmap-opacity":new we(B.paint_heatmap["heatmap-opacity"])})};function Jh(r){const s={},l=r.resolution||256,p=r.clips?r.clips.length:1,v=r.image||new Er({width:l,height:p}),A=(F,N,U)=>{s[r.evaluationKey]=U;const H=r.expression.evaluate(s);v.data[F+N+0]=Math.floor(255*H.r/H.a),v.data[F+N+1]=Math.floor(255*H.g/H.a),v.data[F+N+2]=Math.floor(255*H.b/H.a),v.data[F+N+3]=Math.floor(255*H.a)};if(r.clips)for(let F=0,N=0;F<p;++F,N+=4*l)for(let U=0,H=0;U<l;U++,H+=4){const K=U/(l-1),{start:et,end:ot}=r.clips[F];A(N,H,et*(1-K)+ot*K)}else for(let F=0,N=0;F<l;F++,N+=4)A(0,N,F/(l-1));return v}var hb={paint:new ci({"hillshade-illumination-direction":new we(B.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new we(B.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new we(B.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new we(B.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new we(B.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new we(B.paint_hillshade["hillshade-accent-color"])})};const cb=nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:MC}=cb;var Vd={};function zd(r,s,l){l=l||2;var p,v,A,F,N,U,H,K=s&&s.length,et=K?s[0]*l:r.length,ot=Yy(r,0,et,l,!0),ft=[];if(!ot||ot.next===ot.prev)return ft;if(K&&(ot=function(St,Lt,Zt,he){var Ut,ae,de,ce=[];for(Ut=0,ae=Lt.length;Ut<ae;Ut++)(de=Yy(St,Lt[Ut]*he,Ut<ae-1?Lt[Ut+1]*he:St.length,he,!1))===de.next&&(de.steiner=!0),ce.push(pb(de));for(ce.sort($c),Ut=0;Ut<ce.length;Ut++)Zt=db(ce[Ut],Zt);return Zt}(r,s,ot,l)),r.length>80*l){p=A=r[0],v=F=r[1];for(var _t=l;_t<et;_t+=l)(N=r[_t])<p&&(p=N),(U=r[_t+1])<v&&(v=U),N>A&&(A=N),U>F&&(F=U);H=0!==(H=Math.max(A-p,F-v))?32767/H:0}return qh(ot,ft,l,p,v,H,0),ft}function Yy(r,s,l,p,v){var A,F;if(v===wg(r,s,l,p)>0)for(A=s;A<l;A+=p)F=vg(A,r[A],r[A+1],F);else for(A=l-p;A>=s;A-=p)F=vg(A,r[A],r[A+1],F);return F&&Am(F,F.next)&&(op(F),F=F.next),F}function Qh(r,s){if(!r)return r;s||(s=r);var l,p=r;do{if(l=!1,p.steiner||!Am(p,p.next)&&0!==Ws(p.prev,p,p.next))p=p.next;else{if(op(p),(p=s=p.prev)===p.next)break;l=!0}}while(l||p!==s);return s}function qh(r,s,l,p,v,A,F){if(r){!F&&A&&function(K,et,ot,ft){var _t=K;do{0===_t.z&&(_t.z=_g(_t.x,_t.y,et,ot,ft)),_t.prevZ=_t.prev,_t.nextZ=_t.next,_t=_t.next}while(_t!==K);_t.prevZ.nextZ=null,_t.prevZ=null,function(St){var Lt,Zt,he,Ut,ae,de,ce,Ce,ke=1;do{for(Zt=St,St=null,ae=null,de=0;Zt;){for(de++,he=Zt,ce=0,Lt=0;Lt<ke&&(ce++,he=he.nextZ);Lt++);for(Ce=ke;ce>0||Ce>0&&he;)0!==ce&&(0===Ce||!he||Zt.z<=he.z)?(Ut=Zt,Zt=Zt.nextZ,ce--):(Ut=he,he=he.nextZ,Ce--),ae?ae.nextZ=Ut:St=Ut,Ut.prevZ=ae,ae=Ut;Zt=he}ae.nextZ=null,ke*=2}while(de>1)}(_t)}(r,p,v,A);for(var N,U,H=r;r.prev!==r.next;)if(N=r.prev,U=r.next,A?Hy(r,p,v,A):yg(r))s.push(N.i/l|0),s.push(r.i/l|0),s.push(U.i/l|0),op(r),r=U.next,H=U.next;else if((r=U)===H){F?1===F?qh(r=$y(Qh(r),s,l),s,l,p,v,A,2):2===F&&Gy(r,s,l,p,v,A):qh(Qh(r),s,l,p,v,A,1);break}}}function yg(r){var s=r.prev,l=r,p=r.next;if(Ws(s,l,p)>=0)return!1;for(var v=s.x,A=l.x,F=p.x,N=s.y,U=l.y,H=p.y,K=v<A?v<F?v:F:A<F?A:F,et=N<U?N<H?N:H:U<H?U:H,ot=v>A?v>F?v:F:A>F?A:F,ft=N>U?N>H?N:H:U>H?U:H,_t=p.next;_t!==s;){if(_t.x>=K&&_t.x<=ot&&_t.y>=et&&_t.y<=ft&&Nd(v,N,A,U,F,H,_t.x,_t.y)&&Ws(_t.prev,_t,_t.next)>=0)return!1;_t=_t.next}return!0}function Hy(r,s,l,p){var v=r.prev,A=r,F=r.next;if(Ws(v,A,F)>=0)return!1;for(var N=v.x,U=A.x,H=F.x,K=v.y,et=A.y,ot=F.y,ft=N<U?N<H?N:H:U<H?U:H,_t=K<et?K<ot?K:ot:et<ot?et:ot,St=N>U?N>H?N:H:U>H?U:H,Lt=K>et?K>ot?K:ot:et>ot?et:ot,Zt=_g(ft,_t,s,l,p),he=_g(St,Lt,s,l,p),Ut=r.prevZ,ae=r.nextZ;Ut&&Ut.z>=Zt&&ae&&ae.z<=he;){if(Ut.x>=ft&&Ut.x<=St&&Ut.y>=_t&&Ut.y<=Lt&&Ut!==v&&Ut!==F&&Nd(N,K,U,et,H,ot,Ut.x,Ut.y)&&Ws(Ut.prev,Ut,Ut.next)>=0||(Ut=Ut.prevZ,ae.x>=ft&&ae.x<=St&&ae.y>=_t&&ae.y<=Lt&&ae!==v&&ae!==F&&Nd(N,K,U,et,H,ot,ae.x,ae.y)&&Ws(ae.prev,ae,ae.next)>=0))return!1;ae=ae.nextZ}for(;Ut&&Ut.z>=Zt;){if(Ut.x>=ft&&Ut.x<=St&&Ut.y>=_t&&Ut.y<=Lt&&Ut!==v&&Ut!==F&&Nd(N,K,U,et,H,ot,Ut.x,Ut.y)&&Ws(Ut.prev,Ut,Ut.next)>=0)return!1;Ut=Ut.prevZ}for(;ae&&ae.z<=he;){if(ae.x>=ft&&ae.x<=St&&ae.y>=_t&&ae.y<=Lt&&ae!==v&&ae!==F&&Nd(N,K,U,et,H,ot,ae.x,ae.y)&&Ws(ae.prev,ae,ae.next)>=0)return!1;ae=ae.nextZ}return!0}function $y(r,s,l){var p=r;do{var v=p.prev,A=p.next.next;!Am(v,A)&&Zy(v,p,p.next,A)&&sp(v,A)&&sp(A,v)&&(s.push(v.i/l|0),s.push(p.i/l|0),s.push(A.i/l|0),op(p),op(p.next),p=r=A),p=p.next}while(p!==r);return Qh(p)}function Gy(r,s,l,p,v,A){var F=r;do{for(var N=F.next.next;N!==F.prev;){if(F.i!==N.i&&Ta(F,N)){var U=Ky(F,N);return F=Qh(F,F.next),U=Qh(U,U.next),qh(F,s,l,p,v,A,0),void qh(U,s,l,p,v,A,0)}N=N.next}F=F.next}while(F!==r)}function $c(r,s){return r.x-s.x}function db(r,s){var l=function(v,A){var F,N=A,U=v.x,H=v.y,K=-1/0;do{if(H<=N.y&&H>=N.next.y&&N.next.y!==N.y){var et=N.x+(H-N.y)*(N.next.x-N.x)/(N.next.y-N.y);if(et<=U&&et>K&&(K=et,F=N.x<N.next.x?N:N.next,et===U))return F}N=N.next}while(N!==A);if(!F)return null;var ot,ft=F,_t=F.x,St=F.y,Lt=1/0;N=F;do{U>=N.x&&N.x>=_t&&U!==N.x&&Nd(H<St?U:K,H,_t,St,H<St?K:U,H,N.x,N.y)&&(ot=Math.abs(H-N.y)/(U-N.x),sp(N,v)&&(ot<Lt||ot===Lt&&(N.x>F.x||N.x===F.x&&ub(F,N)))&&(F=N,Lt=ot)),N=N.next}while(N!==ft);return F}(r,s);if(!l)return s;var p=Ky(l,r);return Qh(p,p.next),Qh(l,l.next)}function ub(r,s){return Ws(r.prev,r,s.prev)<0&&Ws(s.next,r,r.next)<0}function _g(r,s,l,p,v){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-l)*v|0)|r<<8))|r<<4))|r<<2))|r<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function pb(r){var s=r,l=r;do{(s.x<l.x||s.x===l.x&&s.y<l.y)&&(l=s),s=s.next}while(s!==r);return l}function Nd(r,s,l,p,v,A,F,N){return(v-F)*(s-N)>=(r-F)*(A-N)&&(r-F)*(p-N)>=(l-F)*(s-N)&&(l-F)*(A-N)>=(v-F)*(p-N)}function Ta(r,s){return r.next.i!==s.i&&r.prev.i!==s.i&&!function(l,p){var v=l;do{if(v.i!==l.i&&v.next.i!==l.i&&v.i!==p.i&&v.next.i!==p.i&&Zy(v,v.next,l,p))return!0;v=v.next}while(v!==l);return!1}(r,s)&&(sp(r,s)&&sp(s,r)&&function(l,p){var v=l,A=!1,F=(l.x+p.x)/2,N=(l.y+p.y)/2;do{v.y>N!=v.next.y>N&&v.next.y!==v.y&&F<(v.next.x-v.x)*(N-v.y)/(v.next.y-v.y)+v.x&&(A=!A),v=v.next}while(v!==l);return A}(r,s)&&(Ws(r.prev,r,s.prev)||Ws(r,s.prev,s))||Am(r,s)&&Ws(r.prev,r,r.next)>0&&Ws(s.prev,s,s.next)>0)}function Ws(r,s,l){return(s.y-r.y)*(l.x-s.x)-(s.x-r.x)*(l.y-s.y)}function Am(r,s){return r.x===s.x&&r.y===s.y}function Zy(r,s,l,p){var v=Em(Ws(r,s,l)),A=Em(Ws(r,s,p)),F=Em(Ws(l,p,r)),N=Em(Ws(l,p,s));return v!==A&&F!==N||!(0!==v||!Pm(r,l,s))||!(0!==A||!Pm(r,p,s))||!(0!==F||!Pm(l,r,p))||!(0!==N||!Pm(l,s,p))}function Pm(r,s,l){return s.x<=Math.max(r.x,l.x)&&s.x>=Math.min(r.x,l.x)&&s.y<=Math.max(r.y,l.y)&&s.y>=Math.min(r.y,l.y)}function Em(r){return r>0?1:r<0?-1:0}function sp(r,s){return Ws(r.prev,r,r.next)<0?Ws(r,s,r.next)>=0&&Ws(r,r.prev,s)>=0:Ws(r,s,r.prev)<0||Ws(r,r.next,s)<0}function Ky(r,s){var l=new bg(r.i,r.x,r.y),p=new bg(s.i,s.x,s.y),v=r.next,A=s.prev;return r.next=s,s.prev=r,l.next=v,v.prev=l,p.next=l,l.prev=p,A.next=p,p.prev=A,p}function vg(r,s,l,p){var v=new bg(r,s,l);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function op(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function bg(r,s,l){this.i=r,this.x=s,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wg(r,s,l,p){for(var v=0,A=s,F=l-p;A<l;A+=p)v+=(r[F]-r[A])*(r[A+1]+r[F+1]),F=A;return v}function mb(r,s,l,p,v){rp(r,s,l||0,p||r.length-1,v||ap)}function rp(r,s,l,p,v){for(;p>l;){if(p-l>600){var A=p-l+1,F=s-l+1,N=Math.log(A),U=.5*Math.exp(2*N/3),H=.5*Math.sqrt(N*U*(A-U)/A)*(F-A/2<0?-1:1);rp(r,s,Math.max(l,Math.floor(s-F*U/A+H)),Math.min(p,Math.floor(s+(A-F)*U/A+H)),v)}var K=r[s],et=l,ot=p;for(Sa(r,l,s),v(r[p],K)>0&&Sa(r,l,p);et<ot;){for(Sa(r,et,ot),et++,ot--;v(r[et],K)<0;)et++;for(;v(r[ot],K)>0;)ot--}0===v(r[l],K)?Sa(r,l,ot):Sa(r,++ot,p),ot<=s&&(l=ot+1),s<=ot&&(p=ot-1)}}function Sa(r,s,l){var p=r[s];r[s]=r[l],r[l]=p}function ap(r,s){return r<s?-1:r>s?1:0}function Dm(r,s){const l=r.length;if(l<=1)return[r];const p=[];let v,A;for(let F=0;F<l;F++){const N=We(r[F]);0!==N&&(r[F].area=Math.abs(N),void 0===A&&(A=N<0),A===N<0?(v&&p.push(v),v=[r[F]]):v.push(r[F]))}if(v&&p.push(v),s>1)for(let F=0;F<p.length;F++)p[F].length<=s||(mb(p[F],s,1,p[F].length-1,Jy),p[F]=p[F].slice(0,s));return p}function Jy(r,s){return s.area-r.area}function Im(r,s,l){const p=l.patternDependencies;let v=!1;for(const A of s){const F=A.paint.get(`${r}-pattern`);F.isConstant()||(v=!0);const N=F.constantOr(null);N&&(v=!0,p[N]=!0)}return v}function Qy(r,s,l,p,v){const A=v.patternDependencies;for(const F of s){const N=F.paint.get(`${r}-pattern`).value;if("constant"!==N.kind){let U=N.evaluate({zoom:p},l,{},v.availableImages);U=U&&U.name?U.name:U,A[U]=!0,l.patterns[F.id]=U}}return l}({get exports(){return Vd},set exports(r){Vd=r}}).exports=zd,Vd.default=zd,zd.deviation=function(r,s,l,p){var v=s&&s.length,A=Math.abs(wg(r,0,v?s[0]*l:r.length,l));if(v)for(var F=0,N=s.length;F<N;F++)A-=Math.abs(wg(r,s[F]*l,F<N-1?s[F+1]*l:r.length,l));var U=0;for(F=0;F<p.length;F+=3){var H=p[F]*l,K=p[F+1]*l,et=p[F+2]*l;U+=Math.abs((r[H]-r[et])*(r[K+1]-r[H+1])-(r[H]-r[K])*(r[et+1]-r[H+1]))}return 0===A&&0===U?0:Math.abs((U-A)/A)},zd.flatten=function(r){for(var s=r[0][0].length,l={vertices:[],holes:[],dimensions:s},p=0,v=0;v<r.length;v++){for(var A=0;A<r[v].length;A++)for(var F=0;F<s;F++)l.vertices.push(r[v][A][F]);v>0&&l.holes.push(p+=r[v-1].length)}return l};class Mg{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new sn,this.indexArray=new ir,this.indexArray2=new nl,this.programConfigurations=new Wh(s.layers,s.zoom),this.segments=new Vo,this.segments2=new Vo,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=s.projection}populate(s,l,p,v){this.hasPattern=Im("fill",this.layers,l);const A=this.layers[0].layout.get("fill-sort-key"),F=[];for(const{feature:N,id:U,index:H,sourceLayerIndex:K}of s){const et=this.layers[0]._featureFilter.needGeometry,ot=$h(N,et);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),ot,p))continue;const ft=A?A.evaluate(ot,{},p,l.availableImages):void 0,_t={id:U,properties:N.properties,type:N.type,sourceLayerIndex:K,index:H,geometry:et?ot.geometry:ll(N,p,v),patterns:{},sortKey:ft};F.push(_t)}A&&F.sort((N,U)=>N.sortKey-U.sortKey);for(const N of F){const{geometry:U,index:H,sourceLayerIndex:K}=N;if(this.hasPattern){const et=Qy("fill",this.layers,N,this.zoom,l);this.patternFeatures.push(et)}else this.addFeature(N,U,H,p,{},l.availableImages);l.featureIndex.insert(s[H].feature,U,H,K,this.index)}}update(s,l,p,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,p,v)}addFeatures(s,l,p,v,A){for(const F of this.patternFeatures)this.addFeature(F,F.geometry,F.index,l,p,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,MC),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,l,p,v,A,F=[]){for(const N of Dm(l,500)){let U=0;for(const _t of N)U+=_t.length;const H=this.segments.prepareSegment(U,this.layoutVertexArray,this.indexArray),K=H.vertexLength,et=[],ot=[];for(const _t of N){if(0===_t.length)continue;_t!==N[0]&&ot.push(et.length/2);const St=this.segments2.prepareSegment(_t.length,this.layoutVertexArray,this.indexArray2),Lt=St.vertexLength;this.layoutVertexArray.emplaceBack(_t[0].x,_t[0].y),this.indexArray2.emplaceBack(Lt+_t.length-1,Lt),et.push(_t[0].x),et.push(_t[0].y);for(let Zt=1;Zt<_t.length;Zt++)this.layoutVertexArray.emplaceBack(_t[Zt].x,_t[Zt].y),this.indexArray2.emplaceBack(Lt+Zt-1,Lt+Zt),et.push(_t[Zt].x),et.push(_t[Zt].y);St.vertexLength+=_t.length,St.primitiveLength+=_t.length}const ft=Vd(et,ot);for(let _t=0;_t<ft.length;_t+=3)this.indexArray.emplaceBack(K+ft[_t],K+ft[_t+1],K+ft[_t+2]);H.vertexLength+=U,H.primitiveLength+=ft.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,A,F,v)}}Hi(Mg,"FillBucket",{omit:["layers","patternFeatures"]});const CC=new ci({"fill-sort-key":new Be(B.layout_fill["fill-sort-key"])});var Cg={paint:new ci({"fill-antialias":new we(B.paint_fill["fill-antialias"]),"fill-opacity":new Be(B.paint_fill["fill-opacity"]),"fill-color":new Be(B.paint_fill["fill-color"]),"fill-outline-color":new Be(B.paint_fill["fill-outline-color"]),"fill-translate":new we(B.paint_fill["fill-translate"]),"fill-translate-anchor":new we(B.paint_fill["fill-translate-anchor"]),"fill-pattern":new Be(B.paint_fill["fill-pattern"])}),layout:CC};const Tg=nn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),TC=nn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),SC=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:qy}=Tg;var Fm={},fb=xi,t_=Wd;function Wd(r,s,l,p,v){this.properties={},this.extent=l,this.type=0,this._pbf=r,this._geometry=-1,this._keys=p,this._values=v,r.readFields(e_,this,s)}function e_(r,s,l){1==r?s.id=l.readVarint():2==r?function(p,v){for(var A=p.readVarint()+p.pos;p.pos<A;){var F=v._keys[p.readVarint()],N=v._values[p.readVarint()];v.properties[F]=N}}(l,s):3==r?s.type=l.readVarint():4==r&&(s._geometry=l.pos)}function Lm(r){for(var s,l,p=0,v=0,A=r.length,F=A-1;v<A;F=v++)p+=((l=r[F]).x-(s=r[v]).x)*(s.y+l.y);return p}Wd.types=["Unknown","Point","LineString","Polygon"],Wd.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var s,l=r.readVarint()+r.pos,p=1,v=0,A=0,F=0,N=[];r.pos<l;){if(v<=0){var U=r.readVarint();p=7&U,v=U>>3}if(v--,1===p||2===p)A+=r.readSVarint(),F+=r.readSVarint(),1===p&&(s&&N.push(s),s=[]),s.push(new fb(A,F));else{if(7!==p)throw new Error("unknown command "+p);s&&s.push(s[0].clone())}}return s&&N.push(s),N},Wd.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var s=r.readVarint()+r.pos,l=1,p=0,v=0,A=0,F=1/0,N=-1/0,U=1/0,H=-1/0;r.pos<s;){if(p<=0){var K=r.readVarint();l=7&K,p=K>>3}if(p--,1===l||2===l)(v+=r.readSVarint())<F&&(F=v),v>N&&(N=v),(A+=r.readSVarint())<U&&(U=A),A>H&&(H=A);else if(7!==l)throw new Error("unknown command "+l)}return[F,U,N,H]},Wd.prototype.toGeoJSON=function(r,s,l){var p,v,A=this.extent*Math.pow(2,l),F=this.extent*r,N=this.extent*s,U=this.loadGeometry(),H=Wd.types[this.type];function K(ft){for(var _t=0;_t<ft.length;_t++){var St=ft[_t];ft[_t]=[360*(St.x+F)/A-180,360/Math.PI*Math.atan(Math.exp((180-360*(St.y+N)/A)*Math.PI/180))-90]}}switch(this.type){case 1:var et=[];for(p=0;p<U.length;p++)et[p]=U[p][0];K(U=et);break;case 2:for(p=0;p<U.length;p++)K(U[p]);break;case 3:for(U=function(ft){var _t=ft.length;if(_t<=1)return[ft];for(var St,Lt,Zt=[],he=0;he<_t;he++){var Ut=Lm(ft[he]);0!==Ut&&(void 0===Lt&&(Lt=Ut<0),Lt===Ut<0?(St&&Zt.push(St),St=[ft[he]]):St.push(ft[he]))}return St&&Zt.push(St),Zt}(U),p=0;p<U.length;p++)for(v=0;v<U[p].length;v++)K(U[p][v])}1===U.length?U=U[0]:H="Multi"+H;var ot={type:"Feature",geometry:{type:H,coordinates:U},properties:this.properties};return"id"in this&&(ot.id=this.id),ot};var i_=t_,Bm=n_;function n_(r,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Gs,this,s),this.length=this._features.length}function Gs(r,s,l){15===r?s.version=l.readVarint():1===r?s.name=l.readString():5===r?s.extent=l.readVarint():2===r?s._features.push(l.pos):3===r?s._keys.push(l.readString()):4===r&&s._values.push(function(p){for(var v=null,A=p.readVarint()+p.pos;p.pos<A;){var F=p.readVarint()>>3;v=1===F?p.readString():2===F?p.readFloat():3===F?p.readDouble():4===F?p.readVarint64():5===F?p.readVarint():6===F?p.readSVarint():7===F?p.readBoolean():null}return v}(l))}n_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var s=this._pbf.readVarint()+this._pbf.pos;return new i_(this._pbf,s,this.extent,this._keys,this._values)};var gb=Bm;function xb(r,s,l){if(3===r){var p=new gb(l,l.readVarint()+l.pos);p.length&&(s[p.name]=p)}}var lp=Fm.VectorTile=function(r,s){this.layers=r.readFields(xb,{},s)},hp=Fm.VectorTileFeature=t_;function Om(r,s,l,p){const v=[],A=0===p?(F,N,U,H,K,et)=>{F.push(new xi(et,U+(et-N)/(H-N)*(K-U)))}:(F,N,U,H,K,et)=>{F.push(new xi(N+(et-U)/(K-U)*(H-N),et))};for(const F of r){const N=[];for(const U of F){if(U.length<=2)continue;const H=[];for(let ot=0;ot<U.length-1;ot++){const ft=U[ot].x,_t=U[ot].y,St=U[ot+1].x,Lt=U[ot+1].y,Zt=0===p?ft:_t,he=0===p?St:Lt;Zt<s?he>s&&A(H,ft,_t,St,Lt,s):Zt>l?he<l&&A(H,ft,_t,St,Lt,l):H.push(U[ot]),he<s&&Zt>=s&&A(H,ft,_t,St,Lt,s),he>l&&Zt<=l&&A(H,ft,_t,St,Lt,l)}let K=U[U.length-1];const et=0===p?K.x:K.y;et>=s&&et<=l&&H.push(K),H.length&&(K=H[H.length-1],H[0].x===K.x&&H[0].y===K.y||H.push(H[0]),N.push(H))}N.length&&v.push(N)}return v}Fm.VectorTileLayer=Bm;const yb=hp.types,_b=Math.pow(2,13);function cp(r,s,l,p,v,A,F,N){r.emplaceBack((s<<1)+F,(l<<1)+A,(Math.floor(p*_b)<<1)+v,Math.round(N))}function Xd(r,s,l){r.emplaceBack(s.x,s.y,s.z,16384*l[0],16384*l[1],16384*l[2])}class vb{constructor(){this.acc=new xi(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new xi(s.x,s.y),this.max=new xi(s.x,s.y))}append(s,l){this.currentPolyCount.edges++,this.acc._add(s);const p=this.min,v=this.max;s.x<p.x?p.x=s.x:s.x>v.x&&(v.x=s.x),s.y<p.y?p.y=s.y:s.y>v.y&&(v.y=s.y),((0===s.x||s.x===_n)&&s.x===l.x)!=((0===s.y||s.y===_n)&&s.y===l.y)&&this.processBorderOverlap(s,l),l.x<0!=s.x<0&&this.addBorderIntersection(0,rs(l.y,s.y,(0-l.x)/(s.x-l.x))),l.x>_n!=s.x>_n&&this.addBorderIntersection(1,rs(l.y,s.y,(_n-l.x)/(s.x-l.x))),l.y<0!=s.y<0&&this.addBorderIntersection(2,rs(l.x,s.x,(0-l.y)/(s.y-l.y))),l.y>_n!=s.y>_n&&this.addBorderIntersection(3,rs(l.x,s.x,(_n-l.y)/(s.y-l.y)))}addBorderIntersection(s,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[s];l<p[0]&&(p[0]=l),l>p[1]&&(p[1]=l)}processBorderOverlap(s,l){if(s.x===l.x){if(s.y===l.y)return;const p=0===s.x?0:1;this.addBorderIntersection(p,l.y),this.addBorderIntersection(p,s.y)}else{const p=0===s.y?2:3;this.addBorderIntersection(p,l.x),this.addBorderIntersection(p,s.x)}}centroid(){const s=this.polyCount.reduce((l,p)=>l+p.edges,0);return 0!==s?this.acc.div(s)._round():new xi(0,0)}span(){return new xi(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,l)=>s+ +(l[0]!==Number.MAX_VALUE),0)}}class Rm{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new vs,this.centroidVertexArray=new Zf,this.indexArray=new ir,this.programConfigurations=new Wh(s.layers,s.zoom),this.segments=new Vo,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=s.enableTerrain}populate(s,l,p,v){this.features=[],this.hasPattern=Im("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(A){const F=Math.exp(Math.PI*(1-A.y/(1<<A.z)*2));return 80150034*F/(F*F+1)/_n/(1<<A.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:A,id:F,index:N,sourceLayerIndex:U}of s){const H=this.layers[0]._featureFilter.needGeometry,K=$h(A,H);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),K,p))continue;const et={id:F,sourceLayerIndex:U,index:N,geometry:H?K.geometry:ll(A,p,v),properties:A.properties,type:A.type,patterns:{}},ot=this.layoutVertexArray.length;this.hasPattern?this.features.push(Qy("fill-extrusion",this.layers,et,this.zoom,l)):this.addFeature(et,et.geometry,N,p,{},l.availableImages,v),l.featureIndex.insert(A,et.geometry,N,U,this.index,ot)}this.sortBorders()}addFeatures(s,l,p,v,A){for(const F of this.features){const{geometry:N}=F;this.addFeature(F,N,F.index,l,p,v,A)}this.sortBorders()}update(s,l,p,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,p,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,qy),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,SC.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,TC.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,l,p,v,A,F,N){const U=[new xi(0,0),new xi(_n,_n)],H=N.projection,K="globe"===H.name,et=this.enableTerrain&&!K?new vb:null,ot="Polygon"===yb[s.type];K&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new zr);const ft=Dm(l,500);for(let Zt=ft.length-1;Zt>=0;Zt--){const he=ft[Zt];(0===he.length||(_t=he[0]).every(Ut=>Ut.x<=0)||_t.every(Ut=>Ut.x>=_n)||_t.every(Ut=>Ut.y<=0)||_t.every(Ut=>Ut.y>=_n))&&ft.splice(Zt,1)}var _t;let St;if(K)St=Pg(ft,U,v);else{St=[];for(const Zt of ft)St.push({polygon:Zt,bounds:U})}const Lt=ot?this.edgeRadius:0;for(const{polygon:Zt,bounds:he}of St){let Ut=0,ae=0;for(const ce of Zt)ot&&!ce[0].equals(ce[ce.length-1])&&ce.push(ce[0]),ae+=ot?ce.length-1:ce.length;const de=this.segments.prepareSegment((ot?5:4)*ae,this.layoutVertexArray,this.indexArray);if(ot){const ce=[],Ce=[];Ut=de.vertexLength;for(const je of Zt){let si,Ae;je.length&&je!==Zt[0]&&Ce.push(ce.length/2),si=je[1].sub(je[0])._perp()._unit();for(let Ye=1;Ye<je.length;Ye++){const Ge=je[Ye],oi=je[Ye===je.length-1?1:Ye+1];let{x:di,y:Oe}=Ge;if(Lt){Ae=oi.sub(Ge)._perp()._unit();const Ci=si.add(Ae)._unit(),hn=Lt*Math.min(4,1/(si.x*Ci.x+si.y*Ci.y));di+=hn*Ci.x,Oe+=hn*Ci.y,si=Ae}cp(this.layoutVertexArray,di,Oe,0,0,1,1,0),de.vertexLength++,ce.push(Ge.x,Ge.y),K&&Xd(this.layoutVertexExtArray,H.projectTilePoint(di,Oe,v),H.upVector(v,di,Oe))}}const ke=Vd(ce,Ce);for(let je=0;je<ke.length;je+=3)this.indexArray.emplaceBack(Ut+ke[je],Ut+ke[je+2],Ut+ke[je+1]),de.primitiveLength++}for(const ce of Zt){et&&ce.length&&et.startRing(ce[0]);let Ce,ke,je,si=ce.length>4&&Ag(ce[ce.length-2],ce[0],ce[1]),Ae=Lt?Vm(ce[ce.length-2],ce[0],ce[1],Lt):0;ke=ce[1].sub(ce[0])._perp()._unit();let Ye=!0;for(let Ge=1,oi=0;Ge<ce.length;Ge++){let di=ce[Ge-1],Oe=ce[Ge];const Ci=ce[Ge===ce.length-1?1:Ge+1];if(et&&ot&&et.currentPolyCount.top++,kg(Oe,di,he)){Lt&&(ke=Ci.sub(Oe)._perp()._unit(),Ye=!Ye);continue}et&&et.append(Oe,di);const hn=Oe.sub(di)._perp(),ki=hn.x/(Math.abs(hn.x)+Math.abs(hn.y)),Yi=hn.y>0?1:0,Si=di.dist(Oe);if(oi+Si>32768&&(oi=0),Lt){je=Ci.sub(Oe)._perp()._unit();let jn=Sg(di,Oe,Ci,jd(ke,je),Lt);isNaN(jn)&&(jn=0);const xn=Oe.sub(di)._unit();di=di.add(xn.mult(Ae))._round(),Oe=Oe.add(xn.mult(-jn))._round(),Ae=jn,ke=je}const gn=de.vertexLength,Jn=ce.length>4&&Ag(di,Oe,Ci);let Hn=s_(oi,si,Ye);if(cp(this.layoutVertexArray,di.x,di.y,ki,Yi,0,0,Hn),cp(this.layoutVertexArray,di.x,di.y,ki,Yi,0,1,Hn),oi+=Si,Hn=s_(oi,Jn,!Ye),si=Jn,cp(this.layoutVertexArray,Oe.x,Oe.y,ki,Yi,0,0,Hn),cp(this.layoutVertexArray,Oe.x,Oe.y,ki,Yi,0,1,Hn),de.vertexLength+=4,this.indexArray.emplaceBack(gn+0,gn+1,gn+2),this.indexArray.emplaceBack(gn+1,gn+3,gn+2),de.primitiveLength+=2,Lt){const jn=Ut+(1===Ge?ce.length-2:Ge-2),xn=1===Ge?Ut:jn+1;if(this.indexArray.emplaceBack(gn+1,jn,gn+3),this.indexArray.emplaceBack(jn,xn,gn+3),de.primitiveLength+=2,void 0===Ce&&(Ce=gn),!kg(Ci,ce[Ge],he)){const Cs=Ge===ce.length-1?Ce:de.vertexLength;this.indexArray.emplaceBack(gn+2,gn+3,Cs),this.indexArray.emplaceBack(gn+3,Cs+1,Cs),this.indexArray.emplaceBack(gn+3,xn,Cs+1),de.primitiveLength+=3}Ye=!Ye}if(K){const jn=this.layoutVertexExtArray,xn=H.projectTilePoint(di.x,di.y,v),Cs=H.projectTilePoint(Oe.x,Oe.y,v),kn=H.upVector(v,di.x,di.y),Qn=H.upVector(v,Oe.x,Oe.y);Xd(jn,xn,kn),Xd(jn,xn,kn),Xd(jn,Cs,Qn),Xd(jn,Cs,Qn)}}ot&&(Ut+=ce.length-1)}}if(et&&et.polyCount.length>0){if(et.borders){et.vertexArrayOffset=this.centroidVertexArray.length;const Zt=et.borders,he=this.featuresOnBorder.push(et)-1;for(let Ut=0;Ut<4;Ut++)Zt[Ut][0]!==Number.MAX_VALUE&&this.borders[Ut].push(he)}this.encodeCentroid(et.borders?void 0:et.centroid(),et)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,A,F,v)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((l,p)=>this.featuresOnBorder[l].borders[s][0]-this.featuresOnBorder[p].borders[s][0])}encodeCentroid(s,l,p=!0){let v,A;if(s)if(0!==s.y){const N=l.span()._mult(this.tileToMeter);v=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(N.x/10)),A=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(N.y/10))}else v=Math.ceil(7*(s.x+450)),A=0;else v=0,A=+p;let F=p?this.centroidVertexArray.length:l.vertexArrayOffset;for(const N of l.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*N.edges+N.top);for(let U=0;U<N.top;U++)this.centroidVertexArray.emplace(F++,v,A);for(let U=0;U<2*N.edges;U++)this.centroidVertexArray.emplace(F++,0,A),this.centroidVertexArray.emplace(F++,v,A)}}}function jd(r,s){const l=r.add(s)._unit();return r.x*l.x+r.y*l.y}function Vm(r,s,l,p){const v=s.sub(r)._perp()._unit(),A=l.sub(s)._perp()._unit();return Sg(r,s,l,jd(v,A),p)}function Sg(r,s,l,p,v){const A=Math.sqrt(1-p*p);return Math.min(r.dist(s)/3,s.dist(l)/3,v*A/p)}function kg(r,s,l){return r.x<l[0].x&&s.x<l[0].x||r.x>l[1].x&&s.x>l[1].x||r.y<l[0].y&&s.y<l[0].y||r.y>l[1].y&&s.y>l[1].y}function Ag(r,s,l){if(r.x<0||r.x>=_n||s.x<0||s.x>=_n||l.x<0||l.x>=_n)return!1;const p=l.sub(s),v=p.perp(),A=r.sub(s);return(p.x*A.x+p.y*A.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(A.x*A.x+A.y*A.y))>-.866&&v.x*A.x+v.y*A.y<0}function s_(r,s,l){const p=s?2|r:-3&r;return l?1|p:-2&p}function o_(){const r=Math.PI/32,s=Math.tan(r),l=Hc;return l*Math.sqrt(1+2*s*s)-l}function Pg(r,s,l){const p=1<<l.z,v=da(l.x/p),A=da((l.x+1)/p),F=Lo(l.y/p),N=Lo((l.y+1)/p);return function(U,H,K,et,ot=0,ft){const _t=[];if(!U.length||!K||!et)return _t;const St=(ce,Ce)=>{for(const ke of ce)_t.push({polygon:ke,bounds:Ce})},Lt=Math.ceil(Math.log2(K)),Zt=Math.ceil(Math.log2(et)),he=Lt-Zt,Ut=[];for(let ce=0;ce<Math.abs(he);ce++)Ut.push(he>0?0:1);for(let ce=0;ce<Math.min(Lt,Zt);ce++)Ut.push(0),Ut.push(1);let ae=U;if(ae=Om(ae,H[0].y-ot,H[1].y+ot,1),ae=Om(ae,H[0].x-ot,H[1].x+ot,0),!ae.length)return _t;const de=[];for(Ut.length?de.push({polygons:ae,bounds:H,depth:0}):St(ae,H);de.length;){const ce=de.pop(),Ce=ce.depth,ke=Ut[Ce],je=ce.bounds[0],si=ce.bounds[1],Ae=0===ke?je.x:je.y,Ye=0===ke?si.x:si.y,Ge=ft?ft(ke,Ae,Ye):.5*(Ae+Ye),oi=Om(ce.polygons,Ae-ot,Ge+ot,ke),di=Om(ce.polygons,Ge-ot,Ye+ot,ke);if(oi.length){const Oe=[je,new xi(0===ke?Ge:si.x,1===ke?Ge:si.y)];Ut.length>Ce+1?de.push({polygons:oi,bounds:Oe,depth:Ce+1}):St(oi,Oe)}if(di.length){const Oe=[new xi(0===ke?Ge:je.x,1===ke?Ge:je.y),si];Ut.length>Ce+1?de.push({polygons:di,bounds:Oe,depth:Ce+1}):St(di,Oe)}}return _t}(r,s,Math.ceil((A-v)/11.25),Math.ceil((F-N)/11.25),1,(U,H,K)=>{if(0===U)return.5*(H+K);{const et=Lo((l.y+H/_n)/p);return(Ha(.5*(Lo((l.y+K/_n)/p)+et))*p-l.y)*_n}})}Hi(Rm,"FillExtrusionBucket",{omit:["layers","features"]}),Hi(vb,"PartMetadata");const r_=new ci({"fill-extrusion-edge-radius":new we(B["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Eg={paint:new ci({"fill-extrusion-opacity":new we(B["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Be(B["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new we(B["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new we(B["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Be(B["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Be(B["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Be(B["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new we(B["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new we(B["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new we(B["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:r_};function bb(r,s,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[r*p-2*Math.PI*6378137/2,s*p-2*Math.PI*6378137/2]}class Ud{constructor(s,l,p){this.z=s,this.x=l,this.y=p,this.key=Yd(0,s,s,l,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,l){const p=(F=this.y,N=this.z,U=bb(256*(A=this.x),256*(F=Math.pow(2,N)-F-1),N),H=bb(256*(A+1),256*(F+1),N),U[0]+","+U[1]+","+H[0]+","+H[1]),v=function(A,F,N){let U,H="";for(let K=A;K>0;K--)U=1<<K-1,H+=(F&U?1:0)+(N&U?2:0);return H}(this.z,this.x,this.y);var A,F,N,U,H;return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class a_{constructor(s,l){this.wrap=s,this.canonical=l,this.key=Yd(s,l.z,l.z,l.x,l.y)}}class vr{constructor(s,l,p,v,A){this.overscaledZ=s,this.wrap=l,this.canonical=new Ud(p,+v,+A),this.key=0===l&&s===p?this.canonical.key:Yd(l,s,p,v,A)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const l=this.canonical.z-s;return s>this.canonical.z?new vr(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new vr(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(s,l=!0){if(this.overscaledZ===s&&l)return this.key;if(s>this.canonical.z)return Yd(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-s;return Yd(this.wrap*+l,s,s,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const l=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l}children(s){if(this.overscaledZ>=s)return[new vr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new vr(l,this.wrap,l,p,v),new vr(l,this.wrap,l,p+1,v),new vr(l,this.wrap,l,p,v+1),new vr(l,this.wrap,l,p+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new vr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new vr(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new a_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Yd(r,s,l,p,v){const A=1<<Math.min(l,22);let F=A*(v%A)+p%A;return r&&l<22&&(F+=A*A*((r<0?-2*r-1:2*r)%(1<<2*(22-l)))),16*(32*F+l)+(s-l)}Hi(Ud,"CanonicalTileID"),Hi(vr,"OverscaledTileID",{omit:["projMatrix"]});class Gc extends xi{constructor(s,l,p){super(s,l),this.z=p}}function hl(r,s){return r.x*s.x+r.y*s.y}function l_(r,s){if(1===r.length){let l=0;const p=s[l++];let v;for(;!v||p.equals(v);)if(v=s[l++],!v)return 1/0;for(;l<s.length;l++){const A=s[l],F=r[0],N=v.sub(p),U=A.sub(p),H=F.sub(p),K=hl(N,N),et=hl(N,U),ot=hl(U,U),ft=hl(H,N),_t=hl(H,U),St=K*ot-et*et,Lt=(ot*ft-et*_t)/St,Zt=(K*_t-et*ft)/St,he=p.z*(1-Lt-Zt)+v.z*Lt+A.z*Zt;if(isFinite(he))return he}return 1/0}{let l=1/0;for(const p of s)l=Math.min(l,p.z);return l}}function zm(r,s,l,p,v,A,F,N){const U=F*v.getElevationAt(r,s,!0,!0),H=0!==A[0],K=H?0===A[1]?F*(A[0]/7-450):F*function(et,ot,ft){const _t=Math.floor(ot[0]/8),St=Math.floor(ot[1]/8),Lt=10*(ot[0]-8*_t),Zt=10*(ot[1]-8*St),he=et.getElevationAt(_t,St,!0,!0),Ut=et.getMeterToDEM(ft),ae=Math.floor(.5*(Lt*Ut-1)),de=Math.floor(.5*(Zt*Ut-1)),ce=et.tileCoordToPixel(_t,St),Ce=2*ae+1,ke=2*de+1,je=(hn=Ce,ki=ke,[(di=et).getElevationAtPixel(Oe=ce.x-ae,Ci=ce.y-de,!0),di.getElevationAtPixel(Oe+ki,Ci,!0),di.getElevationAtPixel(Oe,Ci+ki,!0),di.getElevationAtPixel(Oe+hn,Ci+ki,!0)]),si=Math.abs(je[0]-je[1]),Ae=Math.abs(je[2]-je[3]),Ye=Math.abs(je[0]-je[2])+Math.abs(je[1]-je[3]),Ge=Math.min(.25,.5*Ut*(si+Ae)/Ce),oi=Math.min(.25,.5*Ut*Ye/ke);var di,Oe,Ci,hn,ki;return he+Math.max(Ge*Lt,oi*Zt)}(v,A,N):U;return{base:U+(0===l)?-1:l,top:H?Math.max(K+p,U+l+2):U+p}}const Nm=nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:wb}=Nm,Dg=nn([{name:"a_packed",components:4,type:"Float32"}]),{members:Wm}=Dg,Dl=hp.types,h_=Math.cos(Math.PI/180*37.5);class Hd{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(l=>l.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Ds,this.layoutVertexArray2=new Ns,this.indexArray=new ir,this.programConfigurations=new Wh(s.layers,s.zoom),this.segments=new Vo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(s,l,p,v){this.hasPattern=Im("line",this.layers,l);const A=this.layers[0].layout.get("line-sort-key"),F=[];for(const{feature:K,id:et,index:ot,sourceLayerIndex:ft}of s){const _t=this.layers[0]._featureFilter.needGeometry,St=$h(K,_t);if(!this.layers[0]._featureFilter.filter(new be(this.zoom),St,p))continue;const Lt=A?A.evaluate(St,{},p):void 0,Zt={id:et,properties:K.properties,type:K.type,sourceLayerIndex:ft,index:ot,geometry:_t?St.geometry:ll(K,p,v),patterns:{},sortKey:Lt};F.push(Zt)}A&&F.sort((K,et)=>K.sortKey-et.sortKey);const{lineAtlas:N,featureIndex:U}=l,H=this.addConstantDashes(N);for(const K of F){const{geometry:et,index:ot,sourceLayerIndex:ft}=K;if(H&&this.addFeatureDashes(K,N),this.hasPattern){const _t=Qy("line",this.layers,K,this.zoom,l);this.patternFeatures.push(_t)}else this.addFeature(K,et,ot,p,N.positions,l.availableImages);U.insert(s[ot].feature,et,ot,ft,this.index)}}addConstantDashes(s){let l=!1;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,A=p.layout.get("line-cap").value;if("constant"!==v.kind||"constant"!==A.kind)l=!0;else{const F=A.value,N=v.value;if(!N)continue;s.addDash(N,F)}}return l}addFeatureDashes(s,l){const p=this.zoom;for(const v of this.layers){const A=v.paint.get("line-dasharray").value,F=v.layout.get("line-cap").value;if("constant"===A.kind&&"constant"===F.kind)continue;let N,U;if("constant"===A.kind){if(N=A.value,!N)continue}else N=A.evaluate({zoom:p},s);U="constant"===F.kind?F.value:F.evaluate({zoom:p},s),l.addDash(N,U),s.patterns[v.id]=l.getKey(N,U)}}update(s,l,p,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,p,v)}addFeatures(s,l,p,v,A){for(const F of this.patternFeatures)this.addFeature(F,F.geometry,F.index,l,p,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Wm)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,wb),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,l,p,v,A,F){const N=this.layers[0].layout,U=N.get("line-join").evaluate(s,{}),H=N.get("line-cap").evaluate(s,{}),K=N.get("line-miter-limit"),et=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const ot of l)this.addLine(ot,s,U,H,K,et);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,A,F,v)}addLine(s,l,p,v,A,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Zt=0;Zt<s.length-1;Zt++)this.totalDistance+=s[Zt].dist(s[Zt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const N="Polygon"===Dl[l.type];let U=s.length;for(;U>=2&&s[U-1].equals(s[U-2]);)U--;let H=0;for(;H<U-1&&s[H].equals(s[H+1]);)H++;if(U<(N?3:2))return;"bevel"===p&&(A=1.05);const K=this.overscaling<=16?122880/(512*this.overscaling):0,et=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray);let ot,ft,_t,St,Lt;this.e1=this.e2=-1,N&&(ot=s[U-2],Lt=s[H].sub(ot)._unit()._perp());for(let Zt=H;Zt<U;Zt++){if(_t=Zt===U-1?N?s[H+1]:void 0:s[Zt+1],_t&&s[Zt].equals(_t))continue;Lt&&(St=Lt),ot&&(ft=ot),ot=s[Zt],Lt=_t?_t.sub(ot)._unit()._perp():St,St=St||Lt;let he=St.add(Lt);0===he.x&&0===he.y||he._unit();const Ut=St.x*Lt.x+St.y*Lt.y,ae=he.x*Lt.x+he.y*Lt.y,de=0!==ae?1/ae:1/0,ce=2*Math.sqrt(2-2*ae),Ce=ae<h_&&ft&&_t,ke=St.x*Lt.y-St.y*Lt.x>0;if(Ce&&Zt>H){const Ae=ot.dist(ft);if(Ae>2*K){const Ye=ot.sub(ot.sub(ft)._mult(K/Ae)._round());this.updateDistance(ft,Ye),this.addCurrentVertex(Ye,St,0,0,et),ft=Ye}}const je=ft&&_t;let si=je?p:N?"butt":v;if(je&&"round"===si&&(de<F?si="miter":de<=2&&(si="fakeround")),"miter"===si&&de>A&&(si="bevel"),"bevel"===si&&(de>2&&(si="flipbevel"),de<A&&(si="miter")),ft&&this.updateDistance(ft,ot),"miter"===si)he._mult(de),this.addCurrentVertex(ot,he,0,0,et);else if("flipbevel"===si){if(de>100)he=Lt.mult(-1);else{const Ae=de*St.add(Lt).mag()/St.sub(Lt).mag();he._perp()._mult(Ae*(ke?-1:1))}this.addCurrentVertex(ot,he,0,0,et),this.addCurrentVertex(ot,he.mult(-1),0,0,et)}else if("bevel"===si||"fakeround"===si){const Ae=-Math.sqrt(de*de-1),Ye=ke?Ae:0,Ge=ke?0:Ae;if(ft&&this.addCurrentVertex(ot,St,Ye,Ge,et),"fakeround"===si){const oi=Math.round(180*ce/Math.PI/20);for(let di=1;di<oi;di++){let Oe=di/oi;if(.5!==Oe){const hn=Oe-.5;Oe+=Oe*hn*(Oe-1)*((1.0904+Ut*(Ut*(3.55645-1.43519*Ut)-3.2452))*hn*hn+(.848013+Ut*(.215638*Ut-1.06021)))}const Ci=Lt.sub(St)._mult(Oe)._add(St)._unit()._mult(ke?-1:1);this.addHalfVertex(ot,Ci.x,Ci.y,!1,ke,0,et)}}_t&&this.addCurrentVertex(ot,Lt,-Ye,-Ge,et)}else if("butt"===si)this.addCurrentVertex(ot,he,0,0,et);else if("square"===si){const Ae=ft?1:-1;ft||this.addCurrentVertex(ot,he,Ae,Ae,et),this.addCurrentVertex(ot,he,0,0,et),ft&&this.addCurrentVertex(ot,he,Ae,Ae,et)}else"round"===si&&(ft&&(this.addCurrentVertex(ot,St,0,0,et),this.addCurrentVertex(ot,St,1,1,et,!0)),_t&&(this.addCurrentVertex(ot,Lt,-1,-1,et,!0),this.addCurrentVertex(ot,Lt,0,0,et)));if(Ce&&Zt<U-1){const Ae=ot.dist(_t);if(Ae>2*K){const Ye=ot.add(_t.sub(ot)._mult(K/Ae)._round());this.updateDistance(ot,Ye),this.addCurrentVertex(Ye,Lt,0,0,et),ot=Ye}}}}addCurrentVertex(s,l,p,v,A,F=!1){const N=l.y*v-l.x,U=-l.y-l.x*v;this.addHalfVertex(s,l.x+l.y*p,l.y-l.x*p,F,!1,p,A),this.addHalfVertex(s,N,U,F,!0,-v,A)}addHalfVertex({x:s,y:l},p,v,A,F,N,U){this.layoutVertexArray.emplaceBack((s<<1)+(A?1:0),(l<<1)+(F?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(0===N?0:N<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const H=U.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,H),U.primitiveLength++),F?this.e2=H:this.e1=H}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,l){this.distance+=s.dist(l),this.updateScaledDistance()}}Hi(Hd,"LineBucket",{omit:["layers","patternFeatures"]});const Mb=new ci({"line-cap":new Be(B.layout_line["line-cap"]),"line-join":new Be(B.layout_line["line-join"]),"line-miter-limit":new we(B.layout_line["line-miter-limit"]),"line-round-limit":new we(B.layout_line["line-round-limit"]),"line-sort-key":new Be(B.layout_line["line-sort-key"])});var c_={paint:new ci({"line-opacity":new Be(B.paint_line["line-opacity"]),"line-color":new Be(B.paint_line["line-color"]),"line-translate":new we(B.paint_line["line-translate"]),"line-translate-anchor":new we(B.paint_line["line-translate-anchor"]),"line-width":new Be(B.paint_line["line-width"]),"line-gap-width":new Be(B.paint_line["line-gap-width"]),"line-offset":new Be(B.paint_line["line-offset"]),"line-blur":new Be(B.paint_line["line-blur"]),"line-dasharray":new Be(B.paint_line["line-dasharray"]),"line-pattern":new Be(B.paint_line["line-pattern"]),"line-gradient":new ei(B.paint_line["line-gradient"]),"line-trim-offset":new we(B.paint_line["line-trim-offset"])}),layout:Mb};const Ig=new class extends Be{possiblyEvaluate(r,s){return s=new be(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,l,p){return s=ln({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,l,p)}}(c_.paint.properties["line-width"].specification);function Zc(r,s){return s>0?s+2*r:r}Ig.useIntegerZoom=!0;const Cb=nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Tb=nn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Sb=nn([{name:"a_projected_pos",components:4,type:"Float32"}],4);nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Fg=nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),kb=nn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Lg=nn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ab=nn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);nn([{name:"triangle",components:3,type:"Uint16"}]),nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),nn([{type:"Float32",name:"offsetX"}]),nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var or=24;const lh=128;function Bg(r,s){const{expression:l}=s;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new be(r+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:p,interpolationType:v}=l;let A=0;for(;A<p.length&&p[A]<=r;)A++;A=Math.max(0,A-1);let F=A;for(;F<p.length&&p[F]<r+1;)F++;F=Math.min(p.length-1,F);const N=p[A],U=p[F];return"composite"===l.kind?{kind:"composite",minZoom:N,maxZoom:U,interpolationType:v}:{kind:"camera",minZoom:N,maxZoom:U,minSize:l.evaluate(new be(N)),maxSize:l.evaluate(new be(U)),interpolationType:v}}}function tc(r,{uSize:s,uSizeT:l},{lowerSize:p,upperSize:v}){return"source"===r.kind?p/lh:"composite"===r.kind?rs(p/lh,v/lh,l):s}function $d(r,s){let l=0,p=0;if("constant"===r.kind)p=r.layoutSize;else if("source"!==r.kind){const{interpolationType:v,minZoom:A,maxZoom:F}=r,N=v?Wi(ws.interpolationFactor(v,s,A,F),0,1):0;"camera"===r.kind?p=rs(r.minSize,r.maxSize,N):l=N}return{uSizeT:l,uSize:p}}var Gd=Object.freeze({__proto__:null,getSizeData:Bg,evaluateSizeForFeature:tc,evaluateSizeForZoom:$d,SIZE_PACK_FACTOR:lh});function to(r,s,l){return r.sections.forEach(p=>{p.text=function(v,A,F){const N=A.layout.get("text-transform").evaluate(F,{});return"uppercase"===N?v=v.toLocaleUpperCase():"lowercase"===N&&(v=v.toLocaleLowerCase()),ge.applyArabicShaping&&(v=ge.applyArabicShaping(v)),v}(p.text,s,l)}),r}const dp={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function up(r){return"\ufe36"===r||"\ufe48"===r||"\ufe38"===r||"\ufe44"===r||"\ufe42"===r||"\ufe3e"===r||"\ufe3c"===r||"\ufe3a"===r||"\ufe18"===r||"\ufe40"===r||"\ufe10"===r||"\ufe13"===r||"\ufe14"===r||"\uff40"===r||"\uffe3"===r||"\ufe11"===r||"\ufe12"===r}function hh(r){return"\ufe35"===r||"\ufe47"===r||"\ufe37"===r||"\ufe43"===r||"\ufe41"===r||"\ufe3d"===r||"\ufe3b"===r||"\ufe39"===r||"\ufe17"===r||"\ufe3f"===r}var pp=Zs,d_=function(r,s,l,p,v){var A,F,N=8*v-p-1,U=(1<<N)-1,H=U>>1,K=-7,et=l?v-1:0,ot=l?-1:1,ft=r[s+et];for(et+=ot,A=ft&(1<<-K)-1,ft>>=-K,K+=N;K>0;A=256*A+r[s+et],et+=ot,K-=8);for(F=A&(1<<-K)-1,A>>=-K,K+=p;K>0;F=256*F+r[s+et],et+=ot,K-=8);if(0===A)A=1-H;else{if(A===U)return F?NaN:1/0*(ft?-1:1);F+=Math.pow(2,p),A-=H}return(ft?-1:1)*F*Math.pow(2,A-p)},ec=function(r,s,l,p,v,A){var F,N,U,H=8*A-v-1,K=(1<<H)-1,et=K>>1,ot=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,ft=p?0:A-1,_t=p?1:-1,St=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(N=isNaN(s)?1:0,F=K):(F=Math.floor(Math.log(s)/Math.LN2),s*(U=Math.pow(2,-F))<1&&(F--,U*=2),(s+=F+et>=1?ot/U:ot*Math.pow(2,1-et))*U>=2&&(F++,U/=2),F+et>=K?(N=0,F=K):F+et>=1?(N=(s*U-1)*Math.pow(2,v),F+=et):(N=s*Math.pow(2,et-1)*Math.pow(2,v),F=0));v>=8;r[l+ft]=255&N,ft+=_t,N/=256,v-=8);for(F=F<<v|N,H+=v;H>0;r[l+ft]=255&F,ft+=_t,F/=256,H-=8);r[l+ft-_t]|=128*St};function Zs(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Zs.Varint=0,Zs.Fixed64=1,Zs.Bytes=2,Zs.Fixed32=5;var mp=4294967296,Xm=1/mp,u_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function cl(r){return r.type===Zs.Bytes?r.readVarint()+r.pos:r.pos+1}function p_(r,s,l){var p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));l.realloc(p);for(var v=l.pos-1;v>=r;v--)l.buf[v+p]=l.buf[v]}function Pb(r,s){for(var l=0;l<r.length;l++)s.writeVarint(r[l])}function Eb(r,s){for(var l=0;l<r.length;l++)s.writeSVarint(r[l])}function Db(r,s){for(var l=0;l<r.length;l++)s.writeFloat(r[l])}function Ib(r,s){for(var l=0;l<r.length;l++)s.writeDouble(r[l])}function Fb(r,s){for(var l=0;l<r.length;l++)s.writeBoolean(r[l])}function Lb(r,s){for(var l=0;l<r.length;l++)s.writeFixed32(r[l])}function Zd(r,s){for(var l=0;l<r.length;l++)s.writeSFixed32(r[l])}function ch(r,s){for(var l=0;l<r.length;l++)s.writeFixed64(r[l])}function Bb(r,s){for(var l=0;l<r.length;l++)s.writeSFixed64(r[l])}function jm(r,s){return(r[s]|r[s+1]<<8|r[s+2]<<16)+16777216*r[s+3]}function fp(r,s,l){r[l]=s,r[l+1]=s>>>8,r[l+2]=s>>>16,r[l+3]=s>>>24}function Ob(r,s){return(r[s]|r[s+1]<<8|r[s+2]<<16)+(r[s+3]<<24)}function m_(r,s,l){s.glyphs=[],1===r&&l.readMessage(kC,s)}function kC(r,s,l){if(3===r){const{id:p,bitmap:v,width:A,height:F,left:N,top:U,advance:H}=l.readMessage(f_,{});s.glyphs.push({id:p,bitmap:new El({width:A+6,height:F+6},v),metrics:{width:A,height:F,left:N,top:U,advance:H}})}else 4===r?s.ascender=l.readSVarint():5===r&&(s.descender=l.readSVarint())}function f_(r,s,l){1===r?s.id=l.readVarint():2===r?s.bitmap=l.readBytes():3===r?s.width=l.readVarint():4===r?s.height=l.readVarint():5===r?s.left=l.readSVarint():6===r?s.top=l.readSVarint():7===r&&(s.advance=l.readVarint())}function Um(r){let s=0,l=0;for(const F of r)s+=F.w*F.h,l=Math.max(l,F.w);r.sort((F,N)=>N.h-F.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),l),h:1/0}];let v=0,A=0;for(const F of r)for(let N=p.length-1;N>=0;N--){const U=p[N];if(!(F.w>U.w||F.h>U.h)){if(F.x=U.x,F.y=U.y,A=Math.max(A,F.y+F.h),v=Math.max(v,F.x+F.w),F.w===U.w&&F.h===U.h){const H=p.pop();N<p.length&&(p[N]=H)}else F.h===U.h?(U.x+=F.w,U.w-=F.w):F.w===U.w?(U.y+=F.h,U.h-=F.h):(p.push({x:U.x+F.w,y:U.y,w:U.w-F.w,h:F.h}),U.y+=F.h,U.h-=F.h);break}}return{w:v,h:A,fill:s/(v*A)||0}}Zs.prototype={destroy:function(){this.buf=null},readFields:function(r,s,l){for(l=l||this.length;this.pos<l;){var p=this.readVarint(),v=p>>3,A=this.pos;this.type=7&p,r(v,s,this),this.pos===A&&this.skip(p)}return s},readMessage:function(r,s){return this.readFields(r,s,this.readVarint()+this.pos)},readFixed32:function(){var r=jm(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=Ob(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=jm(this.buf,this.pos)+jm(this.buf,this.pos+4)*mp;return this.pos+=8,r},readSFixed64:function(){var r=jm(this.buf,this.pos)+Ob(this.buf,this.pos+4)*mp;return this.pos+=8,r},readFloat:function(){var r=d_(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=d_(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var s,l,p=this.buf;return s=127&(l=p[this.pos++]),l<128?s:(s|=(127&(l=p[this.pos++]))<<7,l<128?s:(s|=(127&(l=p[this.pos++]))<<14,l<128?s:(s|=(127&(l=p[this.pos++]))<<21,l<128?s:function(v,A,F){var N,U,H=F.buf;if(N=(112&(U=H[F.pos++]))>>4,U<128||(N|=(127&(U=H[F.pos++]))<<3,U<128)||(N|=(127&(U=H[F.pos++]))<<10,U<128)||(N|=(127&(U=H[F.pos++]))<<17,U<128)||(N|=(127&(U=H[F.pos++]))<<24,U<128)||(N|=(1&(U=H[F.pos++]))<<31,U<128))return function ua(r,s,l){return l?4294967296*s+(r>>>0):4294967296*(s>>>0)+(r>>>0)}(v,N,A);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(l=p[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,s=this.pos;return this.pos=r,r-s>=12&&u_?u_.decode(this.buf.subarray(s,r)):function(l,p,v){for(var A="",F=p;F<v;){var N,U,H,K=l[F],et=null,ot=K>239?4:K>223?3:K>191?2:1;if(F+ot>v)break;1===ot?K<128&&(et=K):2===ot?128==(192&(N=l[F+1]))&&(et=(31&K)<<6|63&N)<=127&&(et=null):3===ot?(U=l[F+2],128==(192&(N=l[F+1]))&&128==(192&U)&&((et=(15&K)<<12|(63&N)<<6|63&U)<=2047||et>=55296&&et<=57343)&&(et=null)):4===ot&&(U=l[F+2],H=l[F+3],128==(192&(N=l[F+1]))&&128==(192&U)&&128==(192&H)&&((et=(15&K)<<18|(63&N)<<12|(63&U)<<6|63&H)<=65535||et>=1114112)&&(et=null)),null===et?(et=65533,ot=1):et>65535&&(et-=65536,A+=String.fromCharCode(et>>>10&1023|55296),et=56320|1023&et),A+=String.fromCharCode(et),F+=ot}return A}(this.buf,s,r)},readBytes:function(){var r=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,r);return this.pos=r,s},readPackedVarint:function(r,s){if(this.type!==Zs.Bytes)return r.push(this.readVarint(s));var l=cl(this);for(r=r||[];this.pos<l;)r.push(this.readVarint(s));return r},readPackedSVarint:function(r){if(this.type!==Zs.Bytes)return r.push(this.readSVarint());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Zs.Bytes)return r.push(this.readBoolean());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Zs.Bytes)return r.push(this.readFloat());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Zs.Bytes)return r.push(this.readDouble());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Zs.Bytes)return r.push(this.readFixed32());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Zs.Bytes)return r.push(this.readSFixed32());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Zs.Bytes)return r.push(this.readFixed64());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Zs.Bytes)return r.push(this.readSFixed64());var s=cl(this);for(r=r||[];this.pos<s;)r.push(this.readSFixed64());return r},skip:function(r){var s=7&r;if(s===Zs.Varint)for(;this.buf[this.pos++]>127;);else if(s===Zs.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Zs.Fixed32)this.pos+=4;else{if(s!==Zs.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(r,s){this.writeVarint(r<<3|s)},realloc:function(r){for(var s=this.length||16;s<this.pos+r;)s*=2;if(s!==this.length){var l=new Uint8Array(s);l.set(this.buf),this.buf=l,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),fp(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),fp(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),fp(this.buf,-1&r,this.pos),fp(this.buf,Math.floor(r*Xm),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),fp(this.buf,-1&r,this.pos),fp(this.buf,Math.floor(r*Xm),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(s,l){var p,v,A,N;if(s>=0?(p=s%4294967296|0,v=s/4294967296|0):(v=~(-s/4294967296),4294967295^(p=~(-s%4294967296))?p=p+1|0:(p=0,v=v+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),A=p,(N=l).buf[N.pos++]=127&A|128,A>>>=7,N.buf[N.pos++]=127&A|128,A>>>=7,N.buf[N.pos++]=127&A|128,A>>>=7,N.buf[N.pos++]=127&A|128,N.buf[N.pos]=127&(A>>>=7),function(A,F){var N=(7&A)<<4;F.buf[F.pos++]|=N|((A>>>=3)?128:0),A&&(F.buf[F.pos++]=127&A|((A>>>=7)?128:0),A&&(F.buf[F.pos++]=127&A|((A>>>=7)?128:0),A&&(F.buf[F.pos++]=127&A|((A>>>=7)?128:0),A&&(F.buf[F.pos++]=127&A|((A>>>=7)?128:0),A&&(F.buf[F.pos++]=127&A)))))}(v,l)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var s=this.pos;this.pos=function(p,v,A){for(var F,N,U=0;U<v.length;U++){if((F=v.charCodeAt(U))>55295&&F<57344){if(!N){F>56319||U+1===v.length?(p[A++]=239,p[A++]=191,p[A++]=189):N=F;continue}if(F<56320){p[A++]=239,p[A++]=191,p[A++]=189,N=F;continue}F=N-55296<<10|F-56320|65536,N=null}else N&&(p[A++]=239,p[A++]=191,p[A++]=189,N=null);F<128?p[A++]=F:(F<2048?p[A++]=F>>6|192:(F<65536?p[A++]=F>>12|224:(p[A++]=F>>18|240,p[A++]=F>>12&63|128),p[A++]=F>>6&63|128),p[A++]=63&F|128)}return A}(this.buf,r,this.pos);var l=this.pos-s;l>=128&&p_(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeFloat:function(r){this.realloc(4),ec(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),ec(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var s=r.length;this.writeVarint(s),this.realloc(s);for(var l=0;l<s;l++)this.buf[this.pos++]=r[l]},writeRawMessage:function(r,s){this.pos++;var l=this.pos;r(s,this);var p=this.pos-l;p>=128&&p_(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p},writeMessage:function(r,s,l){this.writeTag(r,Zs.Bytes),this.writeRawMessage(s,l)},writePackedVarint:function(r,s){s.length&&this.writeMessage(r,Pb,s)},writePackedSVarint:function(r,s){s.length&&this.writeMessage(r,Eb,s)},writePackedBoolean:function(r,s){s.length&&this.writeMessage(r,Fb,s)},writePackedFloat:function(r,s){s.length&&this.writeMessage(r,Db,s)},writePackedDouble:function(r,s){s.length&&this.writeMessage(r,Ib,s)},writePackedFixed32:function(r,s){s.length&&this.writeMessage(r,Lb,s)},writePackedSFixed32:function(r,s){s.length&&this.writeMessage(r,Zd,s)},writePackedFixed64:function(r,s){s.length&&this.writeMessage(r,ch,s)},writePackedSFixed64:function(r,s){s.length&&this.writeMessage(r,Bb,s)},writeBytesField:function(r,s){this.writeTag(r,Zs.Bytes),this.writeBytes(s)},writeFixed32Field:function(r,s){this.writeTag(r,Zs.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(r,s){this.writeTag(r,Zs.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(r,s){this.writeTag(r,Zs.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(r,s){this.writeTag(r,Zs.Fixed64),this.writeSFixed64(s)},writeVarintField:function(r,s){this.writeTag(r,Zs.Varint),this.writeVarint(s)},writeSVarintField:function(r,s){this.writeTag(r,Zs.Varint),this.writeSVarint(s)},writeStringField:function(r,s){this.writeTag(r,Zs.Bytes),this.writeString(s)},writeFloatField:function(r,s){this.writeTag(r,Zs.Fixed32),this.writeFloat(s)},writeDoubleField:function(r,s){this.writeTag(r,Zs.Fixed64),this.writeDouble(s)},writeBooleanField:function(r,s){this.writeVarintField(r,Boolean(s))}};class Og{constructor(s,{pixelRatio:l,version:p,stretchX:v,stretchY:A,content:F}){this.paddedRect=s,this.pixelRatio=l,this.stretchX=v,this.stretchY=A,this.content=F,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Rg{constructor(s,l){const p={},v={};this.haveRenderCallbacks=[];const A=[];this.addImages(s,p,A),this.addImages(l,v,A);const{w:F,h:N}=Um(A),U=new Er({width:F||1,height:N||1});for(const H in s){const K=s[H],et=p[H].paddedRect;Er.copy(K.data,U,{x:0,y:0},{x:et.x+1,y:et.y+1},K.data)}for(const H in l){const K=l[H],et=v[H].paddedRect,ot=et.x+1,ft=et.y+1,_t=K.data.width,St=K.data.height;Er.copy(K.data,U,{x:0,y:0},{x:ot,y:ft},K.data),Er.copy(K.data,U,{x:0,y:St-1},{x:ot,y:ft-1},{width:_t,height:1}),Er.copy(K.data,U,{x:0,y:0},{x:ot,y:ft+St},{width:_t,height:1}),Er.copy(K.data,U,{x:_t-1,y:0},{x:ot-1,y:ft},{width:1,height:St}),Er.copy(K.data,U,{x:0,y:0},{x:ot+_t,y:ft},{width:1,height:St})}this.image=U,this.iconPositions=p,this.patternPositions=v}addImages(s,l,p){for(const v in s){const A=s[v],F={x:0,y:0,w:A.data.width+2,h:A.data.height+2};p.push(F),l[v]=new Og(F,A),A.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(s,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>s.hasImage(p)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in s.updatedImages)this.patchUpdatedImage(this.iconPositions[p],s.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],s.getImage(p),l)}patchUpdatedImage(s,l,p){if(!s||!l||s.version===l.version)return;s.version=l.version;const[v,A]=s.tl;p.update(l.data,void 0,{x:v,y:A})}}Hi(Og,"ImagePosition"),Hi(Rg,"ImageAtlas");const ka={horizontal:1,vertical:2,horizontalOnly:3};class gp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,l){const p=new gp;return p.scale=s||1,p.fontStack=l,p}static forImage(s){const l=new gp;return l.imageName=s,l}}class Wr{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,l){const p=new Wr;for(let v=0;v<s.sections.length;v++){const A=s.sections[v];A.image?p.addImageSection(A):p.addTextSection(A,l)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(l,p){let v="";for(let A=0;A<l.length;A++){const F=l.charCodeAt(A+1)||null,N=l.charCodeAt(A-1)||null;v+=!p&&(F&&tt(F)&&!dp[l[A+1]]||N&&tt(N)&&!dp[l[A-1]])||!dp[l[A]]?l[A]:dp[l[A]]}return v}(this.text,s)}trim(){let s=0;for(let p=0;p<this.text.length&&xp[this.text.charCodeAt(p)];p++)s++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&xp[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(s,l),this.sectionIndex=this.sectionIndex.slice(s,l)}substring(s,l){const p=new Wr;return p.text=this.text.substring(s,l),p.sectionIndex=this.sectionIndex.slice(s,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,l)=>Math.max(s,this.sections[l].scale),0)}addTextSection(s,l){this.text+=s.text,this.sections.push(gp.forText(s.scale,s.fontStack||l));const p=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(p)}addImageSection(s){const l=s.image?s.image.name:"";if(0===l.length)return void Xt("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(gp.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Xt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Vg(r,s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t){const St=Wr.fromFeature(r,v);et===ka.vertical&&St.verticalizePunctuation(ot);let Lt=[];const Zt=function(ce,Ce,ke,je,si,Ae){if(!ce)return[];const Ye=[],Ge=function(Ci,hn,ki,Yi,Si,gn){let Jn=0;for(let Hn=0;Hn<Ci.length();Hn++){const jn=Ci.getSection(Hn);Jn+=g_(Ci.getCharCode(Hn),jn,Yi,Si,hn,gn)}return Jn/Math.max(1,Math.ceil(Jn/ki))}(ce,Ce,ke,je,si,Ae),oi=ce.text.indexOf("\u200b")>=0;let di=0;for(let Ci=0;Ci<ce.length();Ci++){const hn=ce.getSection(Ci),ki=ce.getCharCode(Ci);if(xp[ki]||(di+=g_(ki,hn,je,si,Ce,Ae)),Ci<ce.length()-1){const Yi=!((Oe=ki)<11904||!(kd(Oe)||Zr(Oe)||S(Oe)||rm(Oe)||zu(Oe)||ms(Oe)||Ad(Oe)||Do(Oe)||gr(Oe)||ba(Oe)||Hf(Oe)||P(Oe)||Rc(Oe)||nh(Oe)||ih(Oe)||Vu(Oe)||Ra(Oe)||zc(Oe)||sh(Oe)||Nu(Oe)));(Rb[ki]||Yi||hn.imageName)&&Ye.push(zg(Ci+1,di,Ge,Ye,Vb(ki,ce.getCharCode(Ci+1),Yi&&oi),!1))}}var Oe;return y_(zg(ce.length(),di,Ge,Ye,0,!0))}(St,H,A,s,p,ft),{processBidirectionalText:he,processStyledBidirectionalText:Ut}=ge;if(he&&1===St.sections.length){const ce=he(St.toString(),Zt);for(const Ce of ce){const ke=new Wr;ke.text=Ce,ke.sections=St.sections;for(let je=0;je<Ce.length;je++)ke.sectionIndex.push(0);Lt.push(ke)}}else if(Ut){const ce=Ut(St.text,St.sectionIndex,Zt);for(const Ce of ce){const ke=new Wr;ke.text=Ce[0],ke.sectionIndex=Ce[1],ke.sections=St.sections,Lt.push(ke)}}else Lt=function(ce,Ce){const ke=[],je=ce.text;let si=0;for(const Ae of Ce)ke.push(ce.substring(si,Ae)),si=Ae;return si<je.length&&ke.push(ce.substring(si,je.length)),ke}(St,Zt);const ae=[],de={positionedLines:ae,text:St.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:et,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ce,Ce,ke,je,si,Ae,Ye,Ge,oi,di,Oe,Ci){let hn=0,ki=0,Yi=0;const Si="right"===Ge?1:"left"===Ge?0:.5;let gn=!1;for(const kn of si){const Qn=kn.getSections();for(const Rs of Qn){if(Rs.imageName)continue;const eo=Ce[Rs.fontStack];if(eo&&(gn=void 0!==eo.ascender&&void 0!==eo.descender,!gn))break}if(!gn)break}let Jn=0;for(const kn of si){kn.trim();const Qn=kn.getMaxScale(),Rs=(Qn-1)*or,eo={positionedGlyphs:[],lineOffset:0};ce.positionedLines[Jn]=eo;const Dn=eo.positionedGlyphs;let io=0;if(!kn.length()){ki+=Ae,++Jn;continue}let bs=0,Ln=0;for(let Fs=0;Fs<kn.length();Fs++){const Pn=kn.getSection(Fs),Nn=kn.getSectionIndex(Fs),An=kn.getCharCode(Fs);let xo=Pn.scale,Bo=null,Ts=null,Mo=null,Xo=or,Oo=0;const $o=!(oi===ka.horizontal||!Oe&&!G(An)||Oe&&(xp[An]||(Hn=An,Oc(Hn)||om(Hn)||gi(Hn)||Vc(Hn)||_(Hn))));if(Pn.imageName){const br=je[Pn.imageName];if(!br)continue;Mo=Pn.imageName,ce.iconsInText=ce.iconsInText||!0,Ts=br.paddedRect;const gs=br.displaySize;xo=xo*or/Ci,Bo={width:gs[0],height:gs[1],left:1,top:-3,advance:$o?gs[1]:gs[0],localGlyph:!1},Oo=gn?-Bo.height*xo:Qn*or-17-gs[1]*xo,Xo=Bo.advance;const pl=($o?gs[0]:gs[1])*xo-or*Qn;pl>0&&pl>io&&(io=pl)}else{const br=ke[Pn.fontStack];if(!br)continue;br[An]&&(Ts=br[An]);const gs=Ce[Pn.fontStack];if(!gs)continue;const pl=gs.glyphs[An];if(!pl)continue;if(Bo=pl.metrics,Xo=8203!==An?or:0,gn){const nu=void 0!==gs.ascender?Math.abs(gs.ascender):0,su=void 0!==gs.descender?Math.abs(gs.descender):0,ou=(nu+su)*xo;bs<ou&&(bs=ou,Ln=(nu-su)/2*xo),Oo=-nu*xo}else Oo=(Qn-xo)*or-17}$o?(ce.verticalizable=!0,Dn.push({glyph:An,imageName:Mo,x:hn,y:ki+Oo,vertical:$o,scale:xo,localGlyph:Bo.localGlyph,fontStack:Pn.fontStack,sectionIndex:Nn,metrics:Bo,rect:Ts}),hn+=Xo*xo+di):(Dn.push({glyph:An,imageName:Mo,x:hn,y:ki+Oo,vertical:$o,scale:xo,localGlyph:Bo.localGlyph,fontStack:Pn.fontStack,sectionIndex:Nn,metrics:Bo,rect:Ts}),hn+=Bo.advance*xo+di)}0!==Dn.length&&(Yi=Math.max(hn-di,Yi),gn?__(Dn,Si,io,Ln,Ae*Qn/2):__(Dn,Si,io,0,Ae/2)),hn=0;const Wo=Ae*Qn+io;eo.lineOffset=Math.max(io,Rs),ki+=Wo,++Jn}var Hn;const jn=ki,{horizontalAlign:xn,verticalAlign:Cs}=Ng(Ye);(function(kn,Qn,Rs,eo,Dn,io){const bs=(Qn-Rs)*Dn,Ln=-io*eo;for(const Wo of kn)for(const Fs of Wo.positionedGlyphs)Fs.x+=bs,Fs.y+=Ln})(ce.positionedLines,Si,xn,Cs,Yi,jn),ce.top+=-Cs*jn,ce.bottom=ce.top+jn,ce.left+=-xn*Yi,ce.right=ce.left+Yi,ce.hasBaseline=gn}(de,s,l,p,Lt,F,N,U,et,H,ot,_t),!function(ce){for(const Ce of ce)if(0!==Ce.positionedGlyphs.length)return!1;return!0}(ae)&&de}const xp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Rb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function g_(r,s,l,p,v,A){if(s.imageName){const F=p[s.imageName];return F?F.displaySize[0]*s.scale*or/A+v:0}{const F=l[s.fontStack],N=F&&F.glyphs[r];return N?N.metrics.advance*s.scale+v:0}}function x_(r,s,l,p){const v=Math.pow(r-s,2);return p?r<s?v/2:2*v:v+Math.abs(l)*l}function Vb(r,s,l){let p=0;return 10===r&&(p-=1e4),l&&(p+=150),40!==r&&65288!==r||(p+=50),41!==s&&65289!==s||(p+=50),p}function zg(r,s,l,p,v,A){let F=null,N=x_(s,l,v,A);for(const U of p){const H=x_(s-U.x,l,v,A)+U.badness;H<=N&&(F=U,N=H)}return{index:r,x:s,priorBreak:F,badness:N}}function y_(r){return r?y_(r.priorBreak).concat(r.index):[]}function Ng(r){let s=.5,l=.5;switch(r){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:s,verticalAlign:l}}function __(r,s,l,p,v){if(!(s||l||p||v))return;const A=r.length-1,F=r[A],N=(F.x+F.metrics.advance*F.scale)*s;for(let U=0;U<=A;U++)r[U].x-=N,r[U].y+=l+p+v}function es(r,s,l){const{horizontalAlign:p,verticalAlign:v}=Ng(l),A=s[0]-r.displaySize[0]*p,F=s[1]-r.displaySize[1]*v;return{image:r,top:F,bottom:F+r.displaySize[1],left:A,right:A+r.displaySize[0]}}function To(r,s,l,p,v,A){const F=r.image;let N;if(F.content){const Lt=F.content,Zt=F.pixelRatio||1;N=[Lt[0]/Zt,Lt[1]/Zt,F.displaySize[0]-Lt[2]/Zt,F.displaySize[1]-Lt[3]/Zt]}const U=s.left*A,H=s.right*A;let K,et,ot,ft;"width"===l||"both"===l?(ft=v[0]+U-p[3],et=v[0]+H+p[1]):(ft=v[0]+(U+H-F.displaySize[0])/2,et=ft+F.displaySize[0]);const _t=s.top*A,St=s.bottom*A;return"height"===l||"both"===l?(K=v[1]+_t-p[0],ot=v[1]+St+p[2]):(K=v[1]+(_t+St-F.displaySize[1])/2,ot=K+F.displaySize[1]),{image:F,top:K,right:et,bottom:ot,left:ft,collisionPadding:N}}class Il extends xi{constructor(s,l,p,v,A){super(s,l),this.angle=v,this.z=p,void 0!==A&&(this.segment=A)}clone(){return new Il(this.x,this.y,this.z,this.angle,this.segment)}}function Wg(r,s,l,p,v){if(void 0===s.segment)return!0;let A=s,F=s.segment+1,N=0;for(;N>-l/2;){if(F--,F<0)return!1;N-=r[F].dist(A),A=r[F]}N+=r[F].dist(r[F+1]),F++;const U=[];let H=0;for(;N<l/2;){const K=r[F],et=r[F+1];if(!et)return!1;let ot=r[F-1].angleTo(K)-K.angleTo(et);for(ot=Math.abs((ot+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:N,angleDelta:ot}),H+=ot;N-U[0].distance>p;)H-=U.shift().angleDelta;if(H>v)return!1;F++,N+=K.dist(et)}return!0}function v_(r){let s=0;for(let l=0;l<r.length-1;l++)s+=r[l].dist(r[l+1]);return s}function b_(r,s,l){return r?.6*s*l:0}function Xg(r,s){return Math.max(r?r.right-r.left:0,s?s.right-s.left:0)}function zb(r,s,l,p,v,A){const F=b_(l,v,A),N=Xg(l,p)*A;let U=0;const H=v_(r)/2;for(let K=0;K<r.length-1;K++){const et=r[K],ot=r[K+1],ft=et.dist(ot);if(U+ft>H){const _t=(H-U)/ft,St=rs(et.x,ot.x,_t),Lt=rs(et.y,ot.y,_t),Zt=new Il(St,Lt,0,ot.angleTo(et),K);return!F||Wg(r,Zt,N,F,s)?Zt:void 0}U+=ft}}function w_(r,s,l,p,v,A,F,N,U){const H=b_(p,A,F),K=Xg(p,v),et=K*F,ot=0===r[0].x||r[0].x===U||0===r[0].y||r[0].y===U;return s-et<s/4&&(s=et+s/4),M_(r,ot?s/2*N%s:(K/2+2*A)*F*N%s,s,H,l,et,ot,!1,U)}function M_(r,s,l,p,v,A,F,N,U){const H=A/2,K=v_(r);let et=0,ot=s-l,ft=[];for(let _t=0;_t<r.length-1;_t++){const St=r[_t],Lt=r[_t+1],Zt=St.dist(Lt),he=Lt.angleTo(St);for(;ot+l<et+Zt;){ot+=l;const Ut=(ot-et)/Zt,ae=rs(St.x,Lt.x,Ut),de=rs(St.y,Lt.y,Ut);if(ae>=0&&ae<U&&de>=0&&de<U&&ot-H>=0&&ot+H<=K){const ce=new Il(ae,de,0,he,_t);ce._round(),p&&!Wg(r,ce,A,p,v)||ft.push(ce)}}et+=Zt}return N||ft.length||F||(ft=M_(r,et/2,l,p,v,A,F,!0,U)),ft}function C_(r,s,l,p,v){const A=[];for(let F=0;F<r.length;F++){const N=r[F];let U;for(let H=0;H<N.length-1;H++){let K=N[H],et=N[H+1];K.x<s&&et.x<s||(K.x<s?K=new xi(s,K.y+(s-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x<s&&(et=new xi(s,K.y+(s-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y<l&&et.y<l||(K.y<l?K=new xi(K.x+(l-K.y)/(et.y-K.y)*(et.x-K.x),l)._round():et.y<l&&(et=new xi(K.x+(l-K.y)/(et.y-K.y)*(et.x-K.x),l)._round()),K.x>=p&&et.x>=p||(K.x>=p?K=new xi(p,K.y+(p-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x>=p&&(et=new xi(p,K.y+(p-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y>=v&&et.y>=v||(K.y>=v?K=new xi(K.x+(v-K.y)/(et.y-K.y)*(et.x-K.x),v)._round():et.y>=v&&(et=new xi(K.x+(v-K.y)/(et.y-K.y)*(et.x-K.x),v)._round()),U&&K.equals(U[U.length-1])||(U=[K],A.push(U)),U.push(et)))))}}return A}Hi(Il,"Anchor");const Ym=1e20;function jg(r,s,l,p,v,A,F,N,U){for(let H=s;H<s+p;H++)Ug(r,l*A+H,A,v,F,N,U);for(let H=l;H<l+v;H++)Ug(r,H*A+s,1,p,F,N,U)}function Ug(r,s,l,p,v,A,F){A[0]=0,F[0]=-Ym,F[1]=Ym,v[0]=r[s];for(let N=1,U=0,H=0;N<p;N++){v[N]=r[s+N*l];const K=N*N;do{const et=A[U];H=(v[N]-v[et]+K-et*et)/(N-et)/2}while(H<=F[U]&&--U>-1);U++,A[U]=N,F[U]=H,F[U+1]=Ym}for(let N=0,U=0;N<p;N++){for(;F[U+1]<N;)U++;const H=A[U],K=N-H;r[s+N*l]=v[H]+K*K}}const Aa={none:0,ideographs:1,all:2};class Kd{constructor(s,l,p){this.requestManager=s,this.localGlyphMode=l,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,l){const p=[];for(const v in s)for(const A of s[v])p.push({stack:v,id:A});Us(p,({stack:v,id:A},F)=>{let N=this.entries[v];N||(N=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let U=N.glyphs[A];if(void 0!==U)return void F(null,{stack:v,id:A,glyph:U});if(U=this._tinySDF(N,v,A),U)return N.glyphs[A]=U,void F(null,{stack:v,id:A,glyph:U});const H=Math.floor(A/256);if(256*H>65535)return void F(new Error("glyphs > 65535 not supported"));if(N.ranges[H])return void F(null,{stack:v,id:A,glyph:U});let K=N.requests[H];K||(K=N.requests[H]=[],Kd.loadGlyphRange(v,H,this.url,this.requestManager,(et,ot)=>{if(ot){N.ascender=ot.ascender,N.descender=ot.descender;for(const ft in ot.glyphs)this._doesCharSupportLocalGlyph(+ft)||(N.glyphs[+ft]=ot.glyphs[+ft]);N.ranges[H]=!0}for(const ft of K)ft(et,ot);delete N.requests[H]})),K.push((et,ot)=>{et?F(et):ot&&F(null,{stack:v,id:A,glyph:ot.glyphs[A]||null})})},(v,A)=>{if(v)l(v);else if(A){const F={};for(const{stack:N,id:U,glyph:H}of A)void 0===F[N]&&(F[N]={}),void 0===F[N].glyphs&&(F[N].glyphs={}),F[N].glyphs[U]=H&&{id:H.id,bitmap:H.bitmap.clone(),metrics:H.metrics},F[N].ascender=this.entries[N].ascender,F[N].descender=this.entries[N].descender;l(null,F)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==Aa.none&&(this.localGlyphMode===Aa.all?!!this.localFontFamily:!!this.localFontFamily&&(ba(s)||Va(s)||Rc(s)||Ra(s)||Do(s)))}_tinySDF(s,l,p){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let A=s.tinySDF;if(!A){let St="400";/bold/i.test(l)?St="900":/medium/i.test(l)?St="500":/light/i.test(l)&&(St="200"),A=s.tinySDF=new Kd.TinySDF({fontFamily:v,fontWeight:St,fontSize:48,buffer:6,radius:16}),A.fontWeight=St}if(this.localGlyphs[A.fontWeight][p])return this.localGlyphs[A.fontWeight][p];const F=String.fromCharCode(p),{data:N,width:U,height:H,glyphWidth:K,glyphHeight:et,glyphLeft:ot,glyphTop:ft,glyphAdvance:_t}=A.draw(F);return this.localGlyphs[A.fontWeight][p]={id:p,bitmap:new El({width:U,height:H},N),metrics:{width:K/2,height:et/2,left:ot/2,top:ft/2-27,advance:_t/2,localGlyph:!0}}}}function Hm(r,s,l,p){const v=[],A=r.image,F=A.pixelRatio,N=A.paddedRect.w-2,U=A.paddedRect.h-2,H=r.right-r.left,K=r.bottom-r.top,et=A.stretchX||[[0,N]],ot=A.stretchY||[[0,U]],ft=(Ae,Ye)=>Ae+Ye[1]-Ye[0],_t=et.reduce(ft,0),St=ot.reduce(ft,0),Lt=N-_t,Zt=U-St;let he=0,Ut=_t,ae=0,de=St,ce=0,Ce=Lt,ke=0,je=Zt;if(A.content&&p){const Ae=A.content;he=Jd(et,0,Ae[0]),ae=Jd(ot,0,Ae[1]),Ut=Jd(et,Ae[0],Ae[2]),de=Jd(ot,Ae[1],Ae[3]),ce=Ae[0]-he,ke=Ae[1]-ae,Ce=Ae[2]-Ae[0]-Ut,je=Ae[3]-Ae[1]-de}const si=(Ae,Ye,Ge,oi)=>{const di=Yg(Ae.stretch-he,Ut,H,r.left),Oe=Hg(Ae.fixed-ce,Ce,Ae.stretch,_t),Ci=Yg(Ye.stretch-ae,de,K,r.top),hn=Hg(Ye.fixed-ke,je,Ye.stretch,St),ki=Yg(Ge.stretch-he,Ut,H,r.left),Yi=Hg(Ge.fixed-ce,Ce,Ge.stretch,_t),Si=Yg(oi.stretch-ae,de,K,r.top),gn=Hg(oi.fixed-ke,je,oi.stretch,St),Jn=new xi(di,Ci),Hn=new xi(ki,Ci),jn=new xi(ki,Si),xn=new xi(di,Si),Cs=new xi(Oe/F,hn/F),kn=new xi(Yi/F,gn/F),Qn=s*Math.PI/180;if(Qn){const Dn=Math.sin(Qn),io=Math.cos(Qn),bs=[io,-Dn,Dn,io];Jn._matMult(bs),Hn._matMult(bs),xn._matMult(bs),jn._matMult(bs)}const Rs=Ae.stretch+Ae.fixed,eo=Ye.stretch+Ye.fixed;return{tl:Jn,tr:Hn,bl:xn,br:jn,tex:{x:A.paddedRect.x+1+Rs,y:A.paddedRect.y+1+eo,w:Ge.stretch+Ge.fixed-Rs,h:oi.stretch+oi.fixed-eo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Cs,pixelOffsetBR:kn,minFontScaleX:Ce/F/H,minFontScaleY:je/F/K,isSDF:l}};if(p&&(A.stretchX||A.stretchY)){const Ae=T_(et,Lt,_t),Ye=T_(ot,Zt,St);for(let Ge=0;Ge<Ae.length-1;Ge++){const oi=Ae[Ge],di=Ae[Ge+1];for(let Oe=0;Oe<Ye.length-1;Oe++)v.push(si(oi,Ye[Oe],di,Ye[Oe+1]))}}else v.push(si({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:N+1},{fixed:0,stretch:U+1}));return v}function Jd(r,s,l){let p=0;for(const v of r)p+=Math.max(s,Math.min(l,v[1]))-Math.max(s,Math.min(l,v[0]));return p}function T_(r,s,l){const p=[{fixed:-1,stretch:0}];for(const[v,A]of r){const F=p[p.length-1];p.push({fixed:v-F.stretch,stretch:F.stretch}),p.push({fixed:v-F.stretch,stretch:F.stretch+(A-v)})}return p.push({fixed:s+1,stretch:l}),p}function Yg(r,s,l,p){return r/s*l+p}function Hg(r,s,l,p){return r-s*l/p}function AC(r,s,l,p){const v=s+r.positionedLines[p].lineOffset;return 0===p?l+v/2:l+(v+(s+r.positionedLines[p-1].lineOffset))/2}Kd.loadGlyphRange=function(r,s,l,p,v){const A=256*s,F=A+255,N=p.transformRequest(p.normalizeGlyphsURL(l).replace("{fontstack}",r).replace("{range}",`${A}-${F}`),Ps.Glyphs);Gn(N,(U,H)=>{if(U)v(U);else if(H){const K={},et=new pp(H).readFields(m_,{});for(const ot of et.glyphs)K[ot.id]=ot;v(null,{glyphs:K,ascender:et.ascender,descender:et.descender})}})},Kd.TinySDF=class{constructor({fontSize:r=24,buffer:s=3,radius:l=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:A="normal",fontStyle:F="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=l;const N=this.size=r+4*s,U=this._createCanvas(N),H=this.ctx=U.getContext("2d",{willReadFrequently:!0});H.font=`${F} ${A} ${r}px ${v}`,H.textBaseline="alphabetic",H.textAlign="left",H.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(r){const s=document.createElement("canvas");return s.width=s.height=r,s}draw(r){const{width:s,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:A}=this.ctx.measureText(r),F=Math.ceil(l),N=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-v))),U=Math.min(this.size-this.buffer,F+Math.ceil(p)),H=N+2*this.buffer,K=U+2*this.buffer,et=Math.max(H*K,0),ot=new Uint8ClampedArray(et),ft={data:ot,width:H,height:K,glyphWidth:N,glyphHeight:U,glyphTop:F,glyphLeft:0,glyphAdvance:s};if(0===N||0===U)return ft;const{ctx:_t,buffer:St,gridInner:Lt,gridOuter:Zt}=this;_t.clearRect(St,St,N,U),_t.fillText(r,St,St+F);const he=_t.getImageData(St,St,N,U);Zt.fill(Ym,0,et),Lt.fill(0,0,et);for(let Ut=0;Ut<U;Ut++)for(let ae=0;ae<N;ae++){const de=he.data[4*(Ut*N+ae)+3]/255;if(0===de)continue;const ce=(Ut+St)*H+ae+St;if(1===de)Zt[ce]=0,Lt[ce]=Ym;else{const Ce=.5-de;Zt[ce]=Ce>0?Ce*Ce:0,Lt[ce]=Ce<0?Ce*Ce:0}}jg(Zt,0,0,H,K,H,this.f,this.v,this.z),jg(Lt,St,St,N,U,H,this.f,this.v,this.z);for(let Ut=0;Ut<et;Ut++){const ae=Math.sqrt(Zt[Ut])-Math.sqrt(Lt[Ut]);ot[Ut]=Math.round(255-255*(ae/this.radius+this.cutoff))}return ft}};class Nb{constructor(s=[],l=S_){if(this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:l,compare:p}=this,v=l[s];for(;s>0;){const A=s-1>>1,F=l[A];if(p(v,F)>=0)break;l[s]=F,s=A}l[s]=v}_down(s){const{data:l,compare:p}=this,v=this.length>>1,A=l[s];for(;s<v;){let F=1+(s<<1),N=l[F];const U=F+1;if(U<this.length&&p(l[U],N)<0&&(F=U,N=l[U]),p(N,A)>=0)break;l[s]=N,s=F}l[s]=A}}function S_(r,s){return r<s?-1:r>s?1:0}function PC(r,s=1,l=!1){let p=1/0,v=1/0,A=-1/0,F=-1/0;const N=r[0];for(let ft=0;ft<N.length;ft++){const _t=N[ft];(!ft||_t.x<p)&&(p=_t.x),(!ft||_t.y<v)&&(v=_t.y),(!ft||_t.x>A)&&(A=_t.x),(!ft||_t.y>F)&&(F=_t.y)}const U=Math.min(A-p,F-v);let H=U/2;const K=new Nb([],Wb);if(0===U)return new xi(p,v);for(let ft=p;ft<A;ft+=U)for(let _t=v;_t<F;_t+=U)K.push(new dl(ft+H,_t+H,H,r));let et=function(ft){let _t=0,St=0,Lt=0;const Zt=ft[0];for(let he=0,Ut=Zt.length,ae=Ut-1;he<Ut;ae=he++){const de=Zt[he],ce=Zt[ae],Ce=de.x*ce.y-ce.x*de.y;St+=(de.x+ce.x)*Ce,Lt+=(de.y+ce.y)*Ce,_t+=3*Ce}return new dl(St/_t,Lt/_t,0,ft)}(r),ot=K.length;for(;K.length;){const ft=K.pop();(ft.d>et.d||!et.d)&&(et=ft,l&&console.log("found best %d after %d probes",Math.round(1e4*ft.d)/1e4,ot)),ft.max-et.d<=s||(H=ft.h/2,K.push(new dl(ft.p.x-H,ft.p.y-H,H,r)),K.push(new dl(ft.p.x+H,ft.p.y-H,H,r)),K.push(new dl(ft.p.x-H,ft.p.y+H,H,r)),K.push(new dl(ft.p.x+H,ft.p.y+H,H,r)),ot+=4)}return l&&(console.log(`num probes: ${ot}`),console.log(`best distance: ${et.d}`)),et.p}function Wb(r,s){return s.max-r.max}class dl{constructor(s,l,p,v){this.p=new xi(s,l),this.h=p,this.d=function(A,F){let N=!1,U=1/0;for(let H=0;H<F.length;H++){const K=F[H];for(let et=0,ot=K.length,ft=ot-1;et<ot;ft=et++){const _t=K[et],St=K[ft];_t.y>A.y!=St.y>A.y&&A.x<(St.x-_t.x)*(A.y-_t.y)/(St.y-_t.y)+_t.x&&(N=!N),U=Math.min(U,tp(A,_t,St))}}return(N?1:-1)*Math.sqrt(U)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const $g=Number.POSITIVE_INFINITY,k_=Math.sqrt(2);function yp(r,[s,l]){let p=0,v=0;if(l===$g){s<0&&(s=0);const A=s/k_;switch(r){case"top-right":case"top-left":v=A-7;break;case"bottom-right":case"bottom-left":v=7-A;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(r){case"top-right":case"bottom-right":p=-A;break;case"top-left":case"bottom-left":p=A;break;case"left":p=s;break;case"right":p=-s}}else{switch(s=Math.abs(s),l=Math.abs(l),r){case"top-right":case"top-left":case"top":v=l-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-l}switch(r){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}}return[p,v]}function Xb(r,s,l,p,v,A,F,N,U,H){r.createArrays(),r.tilePixelRatio=_n/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const K=r.layers[0].layout,et=r.layers[0]._unevaluatedLayout._values,ot={};if("composite"===r.textSizeData.kind){const{minZoom:St,maxZoom:Lt}=r.textSizeData;ot.compositeTextSizes=[et["text-size"].possiblyEvaluate(new be(St),N),et["text-size"].possiblyEvaluate(new be(Lt),N)]}if("composite"===r.iconSizeData.kind){const{minZoom:St,maxZoom:Lt}=r.iconSizeData;ot.compositeIconSizes=[et["icon-size"].possiblyEvaluate(new be(St),N),et["icon-size"].possiblyEvaluate(new be(Lt),N)]}ot.layoutTextSize=et["text-size"].possiblyEvaluate(new be(U+1),N),ot.layoutIconSize=et["icon-size"].possiblyEvaluate(new be(U+1),N),ot.textMaxSize=et["text-size"].possiblyEvaluate(new be(18),N);const ft="map"===K.get("text-rotation-alignment")&&"point"!==K.get("symbol-placement"),_t=K.get("text-size");for(const St of r.features){const Lt=K.get("text-font").evaluate(St,{},N).join(","),Zt=_t.evaluate(St,{},N),he=ot.layoutTextSize.evaluate(St,{},N),Ut=(ot.layoutIconSize.evaluate(St,{},N),{horizontal:{},vertical:void 0}),ae=St.text;let de,ce=[0,0];if(ae){const je=ae.toString(),si=K.get("text-letter-spacing").evaluate(St,{},N)*or,Ae=K.get("text-line-height").evaluate(St,{},N)*or,Ye=W(je)?si:0,Ge=K.get("text-anchor").evaluate(St,{},N),oi=K.get("text-variable-anchor");if(!oi){const ki=K.get("text-radial-offset").evaluate(St,{},N);ce=ki?yp(Ge,[ki*or,$g]):K.get("text-offset").evaluate(St,{},N).map(Yi=>Yi*or)}let di=ft?"center":K.get("text-justify").evaluate(St,{},N);const Oe="point"===K.get("symbol-placement"),Ci=Oe?K.get("text-max-width").evaluate(St,{},N)*or:1/0,hn=ki=>{r.allowVerticalPlacement&&V(je)&&(Ut.vertical=Vg(ae,s,l,v,Lt,Ci,Ae,Ge,ki,Ye,ce,ka.vertical,!0,he,Zt))};if(!ft&&oi){const ki="auto"===di?oi.map(Si=>$m(Si)):[di];let Yi=!1;for(let Si=0;Si<ki.length;Si++){const gn=ki[Si];if(!Ut.horizontal[gn])if(Yi)Ut.horizontal[gn]=Ut.horizontal[0];else{const Jn=Vg(ae,s,l,v,Lt,Ci,Ae,"center",gn,Ye,ce,ka.horizontal,!1,he,Zt);Jn&&(Ut.horizontal[gn]=Jn,Yi=1===Jn.positionedLines.length)}}hn("left")}else{if("auto"===di&&(di=$m(Ge)),Oe||K.get("text-writing-mode").indexOf("horizontal")>=0||!V(je)){const ki=Vg(ae,s,l,v,Lt,Ci,Ae,Ge,di,Ye,ce,ka.horizontal,!1,he,Zt);ki&&(Ut.horizontal[di]=ki)}hn(Oe?"left":di)}}let Ce=!1;if(St.icon&&St.icon.name){const je=p[St.icon.name];je&&(de=es(v[St.icon.name],K.get("icon-offset").evaluate(St,{},N),K.get("icon-anchor").evaluate(St,{},N)),Ce=je.sdf,void 0===r.sdfIcons?r.sdfIcons=je.sdf:r.sdfIcons!==je.sdf&&Xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(je.pixelRatio!==r.pixelRatio||0!==K.get("icon-rotate").constantOr(1))&&(r.iconsNeedLinear=!0))}const ke=P_(Ut.horizontal)||Ut.vertical;r.iconsInText||(r.iconsInText=!!ke&&ke.iconsInText),(ke||de)&&jb(r,St,Ut,de,p,ot,he,0,ce,Ce,F,N,H)}A&&r.generateCollisionDebugBuffers(U,r.collisionBoxArray)}function $m(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jb(r,s,l,p,v,A,F,N,U,H,K,et,ot){let ft=A.textMaxSize.evaluate(s,{},et);void 0===ft&&(ft=F);const _t=r.layers[0].layout,St=_t.get("icon-offset").evaluate(s,{},et),Lt=P_(l.horizontal)||l.vertical,Zt="globe"===ot.name,he=F/24,Ut=r.tilePixelRatio*ft/24,ae=(Ye=r.overscaling,r.zoom>18&&Ye>2&&(Ye>>=1),Math.max(_n/(512*Ye),1)*_t.get("symbol-spacing")),de=_t.get("text-padding")*r.tilePixelRatio,ce=_t.get("icon-padding")*r.tilePixelRatio,Ce=Xi(_t.get("text-max-angle")),ke="map"===_t.get("text-rotation-alignment")&&"point"!==_t.get("symbol-placement"),je="map"===_t.get("icon-rotation-alignment")&&"point"!==_t.get("symbol-placement"),si=_t.get("symbol-placement"),Ae=ae/2;var Ye;const Ge=_t.get("icon-text-fit");let oi;p&&"none"!==Ge&&(r.allowVerticalPlacement&&l.vertical&&(oi=To(p,l.vertical,Ge,_t.get("icon-text-fit-padding"),St,he)),Lt&&(p=To(p,Lt,Ge,_t.get("icon-text-fit-padding"),St,he)));const di=(Oe,Ci,hn)=>{if(Ci.x<0||Ci.x>=_n||Ci.y<0||Ci.y>=_n)return;let ki=null;if(Zt){const{x:Yi,y:Si,z:gn}=ot.projectTilePoint(Ci.x,Ci.y,hn);ki={anchor:new Il(Yi,Si,gn,0,void 0),up:ot.upVector(hn,Ci.x,Ci.y)}}!function(Yi,Si,gn,Jn,Hn,jn,xn,Cs,kn,Qn,Rs,eo,Dn,io,bs,Ln,Wo,Fs,Pn,Nn,An,xo,Bo,Ts,Mo){const Xo=Yi.addToLineVertexArray(Si,Jn);let Oo,$o,br,gs,pl,nu,su,ou=0,ax=0,Xr=0,Z_=0,Dr=-1,no=-1;const Ea={};let Sp=Wa("");const lc=gn?gn.anchor:Si;let uf=0,pf=0;if(void 0===kn._unevaluatedLayout.getValue("text-radial-offset")?[uf,pf]=kn.layout.get("text-offset").evaluate(An,{},Mo).map(qr=>qr*or):(uf=kn.layout.get("text-radial-offset").evaluate(An,{},Mo)*or,pf=$g),Yi.allowVerticalPlacement&&Hn.vertical){const qr=Hn.vertical;if(bs)nu=Zm(qr),Cs&&(su=Zm(Cs));else{const ta=kn.layout.get("text-rotate").evaluate(An,{},Mo)+90;br=Gm(Qn,lc,Si,Rs,eo,Dn,qr,io,ta,Ln),Cs&&(gs=Gm(Qn,lc,Si,Rs,eo,Dn,Cs,Fs,ta))}}if(jn){const qr=kn.layout.get("icon-rotate").evaluate(An,{},Mo),ta="none"!==kn.layout.get("icon-text-fit"),hc=Hm(jn,qr,Bo,ta),Ol=Cs?Hm(Cs,qr,Bo,ta):void 0;$o=Gm(Qn,lc,Si,Rs,eo,Dn,jn,Fs,qr),ou=4*hc.length;const J_=Yi.iconSizeData;let td=null;"source"===J_.kind?(td=[lh*kn.layout.get("icon-size").evaluate(An,{},Mo)],td[0]>ic&&Xt(`${Yi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===J_.kind&&(td=[lh*xo.compositeIconSizes[0].evaluate(An,{},Mo),lh*xo.compositeIconSizes[1].evaluate(An,{},Mo)],(td[0]>ic||td[1]>ic)&&Xt(`${Yi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Yi.addSymbols(Yi.icon,hc,td,Nn,Pn,An,!1,gn,Si,Xo.lineStartIndex,Xo.lineLength,-1,Ts,Mo),Dr=Yi.icon.placedSymbolArray.length-1,Ol&&(ax=4*Ol.length,Yi.addSymbols(Yi.icon,Ol,td,Nn,Pn,An,ka.vertical,gn,Si,Xo.lineStartIndex,Xo.lineLength,-1,Ts,Mo),no=Yi.icon.placedSymbolArray.length-1)}for(const qr in Hn.horizontal){const ta=Hn.horizontal[qr];Oo||(Sp=Wa(ta.text),bs?pl=Zm(ta):Oo=Gm(Qn,lc,Si,Rs,eo,Dn,ta,io,kn.layout.get("text-rotate").evaluate(An,{},Mo),Ln));const hc=1===ta.positionedLines.length;if(Xr+=A_(Yi,gn,Si,ta,xn,kn,bs,An,Ln,Xo,Hn.vertical?ka.horizontal:ka.horizontalOnly,hc?Object.keys(Hn.horizontal):[qr],Ea,Dr,xo,Ts,Mo),hc)break}Hn.vertical&&(Z_+=A_(Yi,gn,Si,Hn.vertical,xn,kn,bs,An,Ln,Xo,ka.vertical,["vertical"],Ea,no,xo,Ts,Mo));let uh=-1;const mf=(qr,ta)=>qr?Math.max(qr,ta):ta;uh=mf(pl,uh),uh=mf(nu,uh),uh=mf(su,uh);const K_=uh>-1?1:0;Yi.glyphOffsetArray.length>=sc.MAX_GLYPHS&&Xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==An.sortKey&&Yi.addToSortKeyRanges(Yi.symbolInstances.length,An.sortKey),Yi.symbolInstances.emplaceBack(lc.x,lc.y,lc.z,Si.x,Si.y,Ea.right>=0?Ea.right:-1,Ea.center>=0?Ea.center:-1,Ea.left>=0?Ea.left:-1,Ea.vertical>=0?Ea.vertical:-1,Dr,no,Sp,void 0!==Oo?Oo:Yi.collisionBoxArray.length,void 0!==Oo?Oo+1:Yi.collisionBoxArray.length,void 0!==br?br:Yi.collisionBoxArray.length,void 0!==br?br+1:Yi.collisionBoxArray.length,void 0!==$o?$o:Yi.collisionBoxArray.length,void 0!==$o?$o+1:Yi.collisionBoxArray.length,gs||Yi.collisionBoxArray.length,gs?gs+1:Yi.collisionBoxArray.length,Rs,Xr,Z_,ou,ax,K_,0,uf,pf,uh)}(r,Ci,ki,Oe,l,p,v,oi,r.layers[0],r.collisionBoxArray,s.index,s.sourceLayerIndex,r.index,de,ke,U,0,ce,je,St,s,A,H,K,et)};if("line"===si)for(const Oe of C_(s.geometry,0,0,_n,_n)){const Ci=w_(Oe,ae,Ce,l.vertical||Lt,p,24,Ut,r.overscaling,_n);for(const hn of Ci)Lt&&Ub(r,Lt.text,Ae,hn)||di(Oe,hn,et)}else if("line-center"===si){for(const Oe of s.geometry)if(Oe.length>1){const Ci=zb(Oe,Ce,l.vertical||Lt,p,24,Ut);Ci&&di(Oe,Ci,et)}}else if("Polygon"===s.type)for(const Oe of Dm(s.geometry,0)){const Ci=PC(Oe,16);di(Oe[0],new Il(Ci.x,Ci.y,0,0,void 0),et)}else if("LineString"===s.type)for(const Oe of s.geometry)di(Oe,new Il(Oe[0].x,Oe[0].y,0,0,void 0),et);else if("Point"===s.type)for(const Oe of s.geometry)for(const Ci of Oe)di([Ci],new Il(Ci.x,Ci.y,0,0,void 0),et)}const ic=32640;function A_(r,s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t,St,Lt){const Zt=function(ae,de,ce,Ce,ke,je,si,Ae){const Ye=[];if(0===de.positionedLines.length)return Ye;const Ge=Ce.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,oi=function(ki){const Yi=ki[0],Si=ki[1],gn=Yi*Si;return gn>0?[Yi,-Si]:gn<0?[-Yi,Si]:0===Yi?[Si,Yi]:[Si,-Yi]}(ce);let di=Math.abs(de.top-de.bottom);for(const ki of de.positionedLines)di-=ki.lineOffset;const Oe=de.positionedLines.length,Ci=di/Oe;let hn=de.top-ce[1];for(let ki=0;ki<Oe;++ki){const Yi=de.positionedLines[ki];hn=AC(de,Ci,hn,ki);for(const Si of Yi.positionedGlyphs){if(!Si.rect)continue;const gn=Si.rect||{};let Jn=4,Hn=!0,jn=1,xn=0;if(Si.imageName){const Ts=si[Si.imageName];if(!Ts)continue;if(Ts.sdf){Xt("SDF images are not supported in formatted text and will be ignored.");continue}Hn=!1,jn=Ts.pixelRatio,Jn=1/jn}const Cs=(ke||Ae)&&Si.vertical,kn=Si.metrics.advance*Si.scale/2,Qn=Si.metrics,Rs=Si.rect;if(null===Rs)continue;Ae&&de.verticalizable&&(xn=Si.imageName?kn-Si.metrics.width*Si.scale/2:0);const eo=ke?[Si.x+kn,Si.y]:[0,0];let Dn=[0,0],io=[0,0],bs=!1;ke||(Cs?(io=[Si.x+kn+oi[0],Si.y+oi[1]-xn],bs=!0):Dn=[Si.x+kn+ce[0],Si.y+ce[1]-xn]);const Ln=Rs.w*Si.scale/(jn*(Si.localGlyph?2:1)),Wo=Rs.h*Si.scale/(jn*(Si.localGlyph?2:1));let Fs,Pn,Nn,An;if(Cs){const Ts=Si.y-hn,Mo=new xi(-kn,kn-Ts),Xo=-Math.PI/2,Oo=new xi(...io);Fs=new xi(-kn+Dn[0],Dn[1]),Fs._rotateAround(Xo,Mo)._add(Oo),Fs.x+=-Ts+kn,Fs.y-=(Qn.left-Jn)*Si.scale;const $o=Si.imageName?Qn.advance*Si.scale:or*Si.scale,br=String.fromCharCode(Si.glyph);up(br)?Fs.x+=(1-Jn)*Si.scale:hh(br)?Fs.x+=$o-Qn.height*Si.scale+(-Jn-1)*Si.scale:Fs.x+=Si.imageName||Qn.width+2*Jn===Rs.w&&Qn.height+2*Jn===Rs.h?($o-Wo)/2:($o-(Qn.height+2*Jn)*Si.scale)/2,Pn=new xi(Fs.x,Fs.y-Ln),Nn=new xi(Fs.x+Wo,Fs.y),An=new xi(Fs.x+Wo,Fs.y-Ln)}else{const Ts=(Qn.left-Jn)*Si.scale-kn+Dn[0],Mo=(-Qn.top-Jn)*Si.scale+Dn[1],Xo=Ts+Ln,Oo=Mo+Wo;Fs=new xi(Ts,Mo),Pn=new xi(Xo,Mo),Nn=new xi(Ts,Oo),An=new xi(Xo,Oo)}if(Ge){let Ts;Ts=ke?new xi(0,0):bs?new xi(oi[0],oi[1]):new xi(ce[0],ce[1]),Fs._rotateAround(Ge,Ts),Pn._rotateAround(Ge,Ts),Nn._rotateAround(Ge,Ts),An._rotateAround(Ge,Ts)}const xo=new xi(0,0),Bo=new xi(0,0);Ye.push({tl:Fs,tr:Pn,bl:Nn,br:An,tex:gn,writingMode:de.writingMode,glyphOffset:eo,sectionIndex:Si.sectionIndex,isSDF:Hn,pixelOffsetTL:xo,pixelOffsetBR:Bo,minFontScaleX:0,minFontScaleY:0})}}return Ye}(0,p,U,A,F,N,v,r.allowVerticalPlacement),he=r.textSizeData;let Ut=null;"source"===he.kind?(Ut=[lh*A.layout.get("text-size").evaluate(N,{},Lt)],Ut[0]>ic&&Xt(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===he.kind&&(Ut=[lh*_t.compositeTextSizes[0].evaluate(N,{},Lt),lh*_t.compositeTextSizes[1].evaluate(N,{},Lt)],(Ut[0]>ic||Ut[1]>ic)&&Xt(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,Zt,Ut,U,F,N,K,s,l,H.lineStartIndex,H.lineLength,ft,St,Lt);for(const ae of et)ot[ae]=r.text.placedSymbolArray.length-1;return 4*Zt.length}function P_(r){for(const s in r)return r[s];return null}function Gm(r,s,l,p,v,A,F,N,U,H){let K=F.top,et=F.bottom,ot=F.left,ft=F.right;const _t=F.collisionPadding;if(_t&&(ot-=_t[0],K-=_t[1],ft+=_t[2],et+=_t[3]),U){const St=new xi(ot,K),Lt=new xi(ft,K),Zt=new xi(ot,et),he=new xi(ft,et),Ut=Xi(U);let ae=new xi(0,0);H&&(ae=new xi(H[0],H[1])),St._rotateAround(Ut,ae),Lt._rotateAround(Ut,ae),Zt._rotateAround(Ut,ae),he._rotateAround(Ut,ae),ot=Math.min(St.x,Lt.x,Zt.x,he.x),ft=Math.max(St.x,Lt.x,Zt.x,he.x),K=Math.min(St.y,Lt.y,Zt.y,he.y),et=Math.max(St.y,Lt.y,Zt.y,he.y)}return r.emplaceBack(s.x,s.y,s.z,l.x,l.y,ot,K,ft,et,N,p,v,A),r.length-1}function Zm(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const s=r.bottom-r.top;return s>0?Math.max(10,s):null}function Ub(r,s,l,p){const v=r.compareText;if(s in v){const A=v[s];for(let F=A.length-1;F>=0;F--)if(p.dist(A[F])<l)return!0}else v[s]=[];return v[s].push(p),!1}function Gg(r,s){const l=r.fovAboveCenter,p=r.elevation?r.elevation.getMinElevationBelowMSL()*s:0,v=(r._camera.position[2]*r.worldSize-p)/Math.cos(r._pitch),A=Math.sin(l)*v/Math.sin(Math.max(Math.PI/2-r._pitch-l,.01)),F=Math.sin(r._pitch)*A+v;return Math.min(1.01*F,v*(1/r._horizonShift))}function nc(r,s){if(!s.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:s};const l=Math.pow(2,-r.z),p=r.x*l,v=(r.x+1)*l,A=r.y*l,F=(r.y+1)*l,N=da(p),U=da(v),H=Lo(A),K=Lo(F),et=s.project(N,H),ot=s.project(U,H),ft=s.project(U,K),_t=s.project(N,K);let St=Math.min(et.x,ot.x,ft.x,_t.x),Lt=Math.min(et.y,ot.y,ft.y,_t.y),Zt=Math.max(et.x,ot.x,ft.x,_t.x),he=Math.max(et.y,ot.y,ft.y,_t.y);const Ut=l/16;function ae(ce,Ce,ke,je,si,Ae){const Ye=(ke+si)/2,Ge=(je+Ae)/2,oi=s.project(da(Ye),Lo(Ge)),di=Math.max(0,St-oi.x,Lt-oi.y,oi.x-Zt,oi.y-he);St=Math.min(St,oi.x),Zt=Math.max(Zt,oi.x),Lt=Math.min(Lt,oi.y),he=Math.max(he,oi.y),di>Ut&&(ae(ce,oi,ke,je,Ye,Ge),ae(oi,Ce,Ye,Ge,si,Ae))}ae(et,ot,p,A,v,A),ae(ot,ft,v,A,v,F),ae(ft,_t,v,F,p,F),ae(_t,et,p,F,p,A),St-=Ut,Lt-=Ut,Zt+=Ut,he+=Ut;const de=1/Math.max(Zt-St,he-Lt);return{scale:de,x:St*de,y:Lt*de,x2:Zt*de,y2:he*de,projection:s}}const Zg=rl(new Float32Array(16));class Kc{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,l){return{x:0,y:0,z:0}}unproject(s,l){return new ns(0,0)}projectTilePoint(s,l,p){return{x:s,y:l,z:0}}locationPoint(s,l,p=!0){return s._coordinatePoint(s.locationCoordinate(l),p)}pixelsPerMeter(s,l){return Ca(1,s)*l}pixelSpaceConversion(s,l,p){return 1}farthestPixelDistance(s){return Gg(s,s.pixelsPerMeter)}pointCoordinate(s,l,p,v){const A=s.horizonLineFromTop(!1),F=new xi(l,Math.max(A,p));return s.rayIntersectionCoordinate(s.pointRayIntersection(F,v))}pointCoordinate3D(s,l,p){const v=new xi(l,p);if(s.elevation)return s.elevation.pointCoordinate(v);{const A=this.pointCoordinate(s,v.x,v.y,0);return[A.x,A.y,A.z]}}isPointAboveHorizon(s,l){if(s.elevation)return!this.pointCoordinate3D(s,l.x,l.y);const p=s.horizonLineFromTop();return l.y<p}createInversionMatrix(s,l){return Zg}createTileMatrix(s,l,p){let v,A,F;const N=p.canonical,U=rl(new Float64Array(16));if(this.isReprojectedInTileSpace){const H=nc(N,this);v=1,A=H.x+p.wrap*H.scale,F=H.y,la(U,U,[v/H.scale,v/H.scale,s.pixelsPerMeter/l])}else v=l/s.zoomScale(N.z),A=(N.x+Math.pow(2,N.z)*p.wrap)*v,F=N.y*v;return Xc(U,U,[A,F,0]),la(U,U,[v/_n,v/_n,1]),U}upVector(s,l,p){return[0,0,1]}upVectorScale(s,l,p){return{metersToTile:1}}}class Kg extends Kc{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[l,p]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(Xi(l));this.n=(v+Math.sin(Xi(p)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,l){const{n:p,c:v,r0:A}=this,F=Xi(s-this.center[0]),N=Xi(l),U=Math.sqrt(v-2*p*Math.sin(N))/p;return{x:U*Math.sin(F*p),y:U*Math.cos(F*p)-A,z:0}}unproject(s,l){const{n:p,c:v,r0:A}=this,F=A+l;let N=Math.atan2(s,Math.abs(F))*Math.sign(F);F*p<0&&(N-=Math.PI*Math.sign(s)*Math.sign(F));const U=Xi(this.center[0])*p;N=Ri(N,-Math.PI-U,Math.PI-U);const H=Wi(cn(N/p)+this.center[0],-180,180),K=Math.asin(Wi((v-(s*s+F*F)*p*p)/(2*p),-1,1)),et=Wi(cn(K),-sr,sr);return new ns(H,et)}}const _p=1.340264,Km=-.081106,Ee=893e-6,Jc=.003796,Jm=Math.sqrt(3)/2;class E_ extends Kc{project(s,l){l=l/180*Math.PI,s=s/180*Math.PI;const p=Math.asin(Jm*Math.sin(l)),v=p*p,A=v*v*v;return{x:.5*(s*Math.cos(p)/(Jm*(_p+3*Km*v+A*(7*Ee+9*Jc*v)))/Math.PI+.5),y:1-.5*(p*(_p+Km*v+A*(Ee+Jc*v))/Math.PI+1),z:0}}unproject(s,l){s=(2*s-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,v=p*p,A=v*v*v;for(let K,et,ot,ft=0;ft<12&&(et=p*(_p+Km*v+A*(Ee+Jc*v))-l,ot=_p+3*Km*v+A*(7*Ee+9*Jc*v),K=et/ot,p=Wi(p-K,-Math.PI/3,Math.PI/3),v=p*p,A=v*v*v,!(Math.abs(K)<1e-12));++ft);const F=Jm*s*(_p+3*Km*v+A*(7*Ee+9*Jc*v))/Math.cos(p),N=Math.asin(Math.sin(p)/Jm),U=Wi(180*F/Math.PI,-180,180),H=Wi(180*N/Math.PI,-sr,sr);return new ns(U,H)}}class Yb extends Kc{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,l){return{x:.5+s/360,y:.5-l/360,z:0}}unproject(s,l){const p=360*(s-.5),v=Wi(360*(.5-l),-sr,sr);return new ns(p,v)}}const Qd=Math.PI/2;function Qc(r){return Math.tan((Qd+r)/2)}class qd extends Kc{constructor(s){super(s),this.center=s.center||[0,30];const[l,p]=this.parallels=s.parallels||[30,30];let v=Xi(l),A=Xi(p);this.southernCenter=v+A<0,this.southernCenter&&(v=-v,A=-A);const F=Math.cos(v),N=Qc(v);this.n=v===A?Math.sin(v):Math.log(F/Math.cos(A))/Math.log(Qc(A)/N),this.f=F*Math.pow(Qc(v),this.n)/this.n}project(s,l){l=Xi(l),this.southernCenter&&(l=-l),s=Xi(s-this.center[0]);const p=1e-6,{n:v,f:A}=this;A>0?l<-Qd+p&&(l=-Qd+p):l>Qd-p&&(l=Qd-p);const F=A/Math.pow(Qc(l),v);let N=F*Math.sin(v*s),U=A-F*Math.cos(v*s);return N=.5*(N/Math.PI+.5),U=.5*(U/Math.PI+.5),{x:N,y:this.southernCenter?U:1-U,z:0}}unproject(s,l){s=(2*s-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:p,f:v}=this,A=v-l,F=Math.sign(A),N=Math.sign(p)*Math.sqrt(s*s+A*A);let U=Math.atan2(s,Math.abs(A))*F;A*p<0&&(U-=Math.PI*Math.sign(s)*F);const H=Wi(cn(U/p)+this.center[0],-180,180),K=Wi(cn(2*Math.atan(Math.pow(v/N,1/p))-Qd),-sr,sr);return new ns(H,this.southernCenter?-K:K)}}class Qm extends Kc{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,l){return{x:Pl(s),y:Ha(l),z:0}}unproject(s,l){const p=da(s),v=Lo(l);return new ns(p,v)}}const tu=Xi(sr);class Jg extends Kc{project(s,l){const p=(l=Xi(l))*l,v=p*p;return{x:.5*((s=Xi(s))*(.8707-.131979*p+v*(v*(.003971*p-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+p*(.015085+v*(.028874*p-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,l){s=(2*s-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,v=25,A=0,F=p*p;do{F=p*p;const H=F*F;A=(p*(1.007226+F*(.015085+H*(.028874*F-.044475-.005916*H)))-l)/(1.007226+F*(.045255+H*(.259866*F-.311325-.005916*11*H))),p=Wi(p-A,-tu,tu)}while(Math.abs(A)>1e-6&&--v>0);F=p*p;const N=Wi(cn(s/(.8707+F*(F*(F*F*F*(.003971-.001529*F)-.013791)-.131979))),-180,180),U=cn(p);return new ns(N,U)}}const vp=Xi(sr);class D_ extends Kc{project(s,l){l=Xi(l),s=Xi(s);const p=Math.cos(l),v=2/Math.PI,A=Math.acos(p*Math.cos(s/2)),F=Math.sin(A)/A,N=.5*(s*v+2*p*Math.sin(s/2)/F)||0,U=.5*(l+Math.sin(l)/F)||0;return{x:.5*(N/Math.PI+.5),y:1-.5*(U/Math.PI+1),z:0}}unproject(s,l){let p=s=(2*s-.5)*Math.PI,v=l=(2*(1-l)-1)*Math.PI,A=25;const F=1e-6;let N=0,U=0;do{const H=Math.cos(v),K=Math.sin(v),et=2*K*H,ot=K*K,ft=H*H,_t=Math.cos(p/2),St=Math.sin(p/2),Lt=2*_t*St,Zt=St*St,he=1-ft*_t*_t,Ut=he?1/he:0,ae=he?Math.acos(H*_t)*Math.sqrt(1/he):0,de=.5*(2*ae*H*St+2*p/Math.PI)-s,ce=.5*(ae*K+v)-l,Ce=.5*Ut*(ft*Zt+ae*H*_t*ot)+1/Math.PI,ke=Ut*(Lt*et/4-ae*K*St),je=.125*Ut*(et*St-ae*K*ft*Lt),si=.5*Ut*(ot*_t+ae*Zt*H)+.5,Ae=ke*je-si*Ce;N=(ce*ke-de*si)/Ae,U=(de*je-ce*Ce)/Ae,p=Wi(p-N,-Math.PI,Math.PI),v=Wi(v-U,-vp,vp)}while((Math.abs(N)>F||Math.abs(U)>F)&&--A>0);return new ns(cn(p),cn(v))}}class qm extends Kc{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Xi(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,l){const{scale:p,cosPhi:v}=this;return{x:Xi(s)*v*p+.5,y:-Math.sin(Xi(l))/v*p+.5,z:0}}unproject(s,l){const{scale:p,cosPhi:v}=this,A=-(l-.5)/p,F=Wi(cn((s-.5)/p)/v,-180,180),N=Math.asin(Wi(A*v,-1,1)),U=Wi(cn(N),-sr,sr);return new ns(F,U)}}class Qg extends Qm{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,l,p){const v=ah(s,l,p);return go(v,v,qu(Al(p))),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,l){const p=No(l.lat,l.lng),v=Nr([],p),A=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(l),s._centerAltitude):s._centerAltitude;mm(p,p,v,Ca(1,0)*_n*A);const F=rl(new Float64Array(16));return kl(F,s.pixelMatrix,s.globeMatrix),go(p,p,F),new xi(p[0],p[1])}pixelsPerMeter(s,l){return Ca(1,0)*l}pixelSpaceConversion(s,l,p){const v=Ca(1,s)*l,A=rs(Ca(1,45)*l,v,p);return this.pixelsPerMeter(s,l)/A}createTileMatrix(s,l,p){const v=bm(Al(p.canonical));return kl(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,l){const{center:p}=s,v=qu(Al(l));return rh(v,v,Xi(p.lng)),um(v,v,Xi(p.lat)),la(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,l,p,v){return _m(s,l,p,!0)||new Hh(0,0)}pointCoordinate3D(s,l,p){const v=this.pointCoordinate(s,l,p,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,l){return!_m(s,l.x,l.y,!1)}farthestPixelDistance(s){const l=function(v,A){const F=v.cameraToCenterDistance,N=v._centerAltitude*A,U=v._camera,H=v._camera.forward(),K=ha([],Ma([],H,-F),[0,0,N]),et=v.worldSize/(2*Math.PI),ot=[0,0,-et],ft=v.width/v.height,_t=Math.tan(v.fovAboveCenter),St=Ma([],U.up(),_t),Lt=Ma([],U.right(),_t*ft),Zt=Nr([],ha([],ha([],H,St),Lt)),he=[];let Ut;if(new sg(K,Zt).closestPointOnSphere(ot,et,he)){const ae=ha([],he,ot),de=ja([],ae,K);Ut=Math.cos(v.fovAboveCenter)*Gu(de)}else{const ae=ja([],K,ot),de=ja([],ot,K);Nr(de,de);const ce=Gu(ae)-et;Ut=Math.sqrt(ce*(ce+2*et));const Ce=Math.acos(Ut/(et+ce))-Math.acos(Xa(H,de));Ut*=Math.cos(Ce)}return 1.01*Ut}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),p=Yc(s.zoom);if(p>0){const v=Gg(s,Ca(1,s.center.lat)*s.worldSize),A=s.worldSize/(2*Math.PI),F=Math.max(s.width,s.height)/s.worldSize*Math.PI;return rs(l,v+A*(1-Math.cos(F)),Math.pow(p,10))}return l}upVector(s,l,p){return ah(l,p,s,1)}upVectorScale(s){return{metersToTile:Ju(Qu(Al(s)))}}}function tf(r){const s=r.parallels,l=!!s&&Math.abs(s[0]+s[1])<.01;switch(r.name){case"mercator":return new Qm(r);case"equirectangular":return new Yb(r);case"naturalEarth":return new Jg(r);case"equalEarth":return new E_(r);case"winkelTripel":return new D_(r);case"albers":return l?new qm(r):new Kg(r);case"lambertConformalConic":return l?new qm(r):new qd(r);case"globe":return new Qg(r)}throw new Error(`Invalid projection name: ${r.name}`)}const I_=hp.types,qg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ef(r,s,l,p,v,A,F,N,U,H,K,et,ot){const ft=N?Math.min(ic,Math.round(N[0])):0,_t=N?Math.min(ic,Math.round(N[1])):0;r.emplaceBack(s,l,Math.round(32*p),Math.round(32*v),A,F,(ft<<1)+(U?1:0),_t,16*H,16*K,256*et,256*ot)}function nf(r,s,l,p,v,A,F){r.emplaceBack(s,l,p,v,A,F)}function bp(r,s,l,p,v){r.emplaceBack(s,l,p,v),r.emplaceBack(s,l,p,v),r.emplaceBack(s,l,p,v),r.emplaceBack(s,l,p,v)}function Hb(r){for(const s of r.sections)if(bt(s.text))return!0;return!1}class sf{constructor(s){this.layoutVertexArray=new Tl,this.indexArray=new ir,this.programConfigurations=s,this.segments=new Vo,this.dynamicLayoutVertexArray=new Ns,this.opacityVertexArray=new Bs,this.placedSymbolArray=new $f,this.globeExtVertexArray=new qs}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,l,p,v){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Cb.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,Sb.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,qg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Tb.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Hi(sf,"SymbolBuffers");class rf{constructor(s,l,p){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Vo,this.collisionVertexArray=new Os,this.collisionVertexArrayExt=new Ho}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,Fg.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,kb.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Hi(rf,"CollisionBuffers");class sc{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(F=>F.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=rl([]),this.placementViewportMatrix=rl([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Bg(this.zoom,l["text-size"]),this.iconSizeData=Bg(this.zoom,l["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),A=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==A&&void 0!==v.constantOr(1),this.sortFeaturesByY=("viewport-y"===A||"auto"===A&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(F=>ka[F]),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new sf(new Wh(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new sf(new Wh(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new my,this.lineVertexArray=new Ro,this.symbolInstances=new Nc}calculateGlyphDependencies(s,l,p,v,A){for(let F=0;F<s.length;F++)if(l[s.charCodeAt(F)]=!0,v&&A){const N=dp[s.charAt(F)];N&&(l[N.charCodeAt(0)]=!0)}}populate(s,l,p,v){const A=this.layers[0],F=A.layout,N="globe"===this.projection.name,U=F.get("text-font"),H=F.get("text-field"),K=F.get("icon-image"),et=("constant"!==H.value.kind||H.value.value instanceof yn&&!H.value.value.isEmpty()||H.value.value.toString().length>0)&&("constant"!==U.value.kind||U.value.value.length>0),ot="constant"!==K.value.kind||!!K.value.value||Object.keys(K.parameters).length>0,ft=F.get("symbol-sort-key");if(this.features=[],!et&&!ot)return;const _t=l.iconDependencies,St=l.glyphDependencies,Lt=l.availableImages,Zt=new be(this.zoom);for(const{feature:he,id:Ut,index:ae,sourceLayerIndex:de}of s){const ce=A._featureFilter.needGeometry,Ce=$h(he,ce);if(!A._featureFilter.filter(Zt,Ce,p))continue;if(ce||(Ce.geometry=ll(he,p,v)),N&&1!==he.type&&p.z<=5){const Ae=Ce.geometry,Ye=.98078528056,Ge=(oi,di)=>Xa(ah(oi.x,oi.y,p,1),ah(di.x,di.y,p,1))<Ye;for(let oi=0;oi<Ae.length;oi++)Ae[oi]=rb(Ae[oi],Ge)}let ke,je;if(et){const Ae=A.getValueAndResolveTokens("text-field",Ce,p,Lt),Ye=yn.factory(Ae);Hb(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===me()||this.hasRTLText&&ge.isParsed())&&(ke=to(Ye,A,Ce))}if(ot){const Ae=A.getValueAndResolveTokens("icon-image",Ce,p,Lt);je=Ae instanceof Zn?Ae:Zn.fromString(Ae)}if(!ke&&!je)continue;const si=this.sortFeaturesByKey?ft.evaluate(Ce,{},p):void 0;if(this.features.push({id:Ut,text:ke,icon:je,index:ae,sourceLayerIndex:de,geometry:Ce.geometry,properties:he.properties,type:I_[he.type],sortKey:si}),je&&(_t[je.name]=!0),ke){const Ae=U.evaluate(Ce,{},p).join(","),Ye="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ka.vertical)>=0;for(const Ge of ke.sections)if(Ge.image)_t[Ge.image.name]=!0;else{const oi=V(ke.toString()),di=Ge.fontStack||Ae,Oe=St[di]=St[di]||{};this.calculateGlyphDependencies(Ge.text,Oe,Ye,this.allowVerticalPlacement,oi)}}}"line"===F.get("symbol-placement")&&(this.features=function(he){const Ut={},ae={},de=[];let ce=0;function Ce(Ae){de.push(he[Ae]),ce++}function ke(Ae,Ye,Ge){const oi=ae[Ae];return delete ae[Ae],ae[Ye]=oi,de[oi].geometry[0].pop(),de[oi].geometry[0]=de[oi].geometry[0].concat(Ge[0]),oi}function je(Ae,Ye,Ge){const oi=Ut[Ye];return delete Ut[Ye],Ut[Ae]=oi,de[oi].geometry[0].shift(),de[oi].geometry[0]=Ge[0].concat(de[oi].geometry[0]),oi}function si(Ae,Ye,Ge){const oi=Ge?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Ae}:${oi.x}:${oi.y}`}for(let Ae=0;Ae<he.length;Ae++){const Ye=he[Ae],Ge=Ye.geometry,oi=Ye.text?Ye.text.toString():null;if(!oi){Ce(Ae);continue}const di=si(oi,Ge),Oe=si(oi,Ge,!0);if(di in ae&&Oe in Ut&&ae[di]!==Ut[Oe]){const Ci=je(di,Oe,Ge),hn=ke(di,Oe,de[Ci].geometry);delete Ut[di],delete ae[Oe],ae[si(oi,de[hn].geometry,!0)]=hn,de[Ci].geometry=null}else di in ae?ke(di,Oe,Ge):Oe in Ut?je(di,Oe,Ge):(Ce(Ae),Ut[di]=ce-1,ae[Oe]=ce-1)}return de.filter(Ae=>Ae.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,Ut)=>he.sortKey-Ut.sortKey)}update(s,l,p,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,p,v),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,p,v))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=tf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,l){const p=this.lineVertexArray.length;if(void 0!==s.segment)for(const{x:v,y:A}of l)this.lineVertexArray.emplaceBack(v,A);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,l,p,v,A,F,N,U,H,K,et,ot,ft,_t){const St=s.indexArray,Lt=s.layoutVertexArray,Zt=s.globeExtVertexArray,he=s.segments.prepareSegment(4*l.length,Lt,St,this.canOverlap?F.sortKey:void 0),Ut=this.glyphOffsetArray.length,ae=he.vertexLength,de=this.allowVerticalPlacement&&N===ka.vertical?Math.PI/2:0,ce=F.text&&F.text.sections;for(let ke=0;ke<l.length;ke++){const{tl:je,tr:si,bl:Ae,br:Ye,tex:Ge,pixelOffsetTL:oi,pixelOffsetBR:di,minFontScaleX:Oe,minFontScaleY:Ci,glyphOffset:hn,isSDF:ki,sectionIndex:Yi}=l[ke],Si=he.vertexLength,gn=hn[1];if(ef(Lt,H.x,H.y,je.x,gn+je.y,Ge.x,Ge.y,p,ki,oi.x,oi.y,Oe,Ci),ef(Lt,H.x,H.y,si.x,gn+si.y,Ge.x+Ge.w,Ge.y,p,ki,di.x,oi.y,Oe,Ci),ef(Lt,H.x,H.y,Ae.x,gn+Ae.y,Ge.x,Ge.y+Ge.h,p,ki,oi.x,di.y,Oe,Ci),ef(Lt,H.x,H.y,Ye.x,gn+Ye.y,Ge.x+Ge.w,Ge.y+Ge.h,p,ki,di.x,di.y,Oe,Ci),U){const{x:Jn,y:Hn,z:jn}=U.anchor,[xn,Cs,kn]=U.up;nf(Zt,Jn,Hn,jn,xn,Cs,kn),nf(Zt,Jn,Hn,jn,xn,Cs,kn),nf(Zt,Jn,Hn,jn,xn,Cs,kn),nf(Zt,Jn,Hn,jn,xn,Cs,kn),bp(s.dynamicLayoutVertexArray,Jn,Hn,jn,de)}else bp(s.dynamicLayoutVertexArray,H.x,H.y,H.z,de);St.emplaceBack(Si,Si+1,Si+2),St.emplaceBack(Si+1,Si+2,Si+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(hn[0]),ke!==l.length-1&&Yi===l[ke+1].sectionIndex||s.programConfigurations.populatePaintArrays(Lt.length,F,F.index,{},ft,_t,ce&&ce[Yi])}const Ce=U?U.anchor:H;s.placedSymbolArray.emplaceBack(Ce.x,Ce.y,Ce.z,H.x,H.y,Ut,this.glyphOffsetArray.length-Ut,ae,K,et,H.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],N,0,!1,0,ot,0)}_commitLayoutVertex(s,l,p,v,A,F,N){s.emplaceBack(l,p,v,A,F,Math.round(N.x),Math.round(N.y))}_addCollisionDebugVertices(s,l,p,v,A,F,N){const U=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),H=U.vertexLength,K=N.tileAnchorX,et=N.tileAnchorY;for(let ft=0;ft<4;ft++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(l,-s.padding,-s.padding),p.collisionVertexArrayExt.emplaceBack(l,s.padding,-s.padding),p.collisionVertexArrayExt.emplaceBack(l,s.padding,s.padding),p.collisionVertexArrayExt.emplaceBack(l,-s.padding,s.padding),this._commitLayoutVertex(p.layoutVertexArray,v,A,F,K,et,new xi(s.x1,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,A,F,K,et,new xi(s.x2,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,A,F,K,et,new xi(s.x2,s.y2)),this._commitLayoutVertex(p.layoutVertexArray,v,A,F,K,et,new xi(s.x1,s.y2)),U.vertexLength+=4;const ot=p.indexArray;ot.emplaceBack(H,H+1),ot.emplaceBack(H+1,H+2),ot.emplaceBack(H+2,H+3),ot.emplaceBack(H+3,H),U.primitiveLength+=4}_addTextDebugCollisionBoxes(s,l,p,v,A,F){for(let N=v;N<A;N++){const U=p.get(N),H=this.getSymbolInstanceTextSize(s,F,l,N);this._addCollisionDebugVertices(U,H,this.textCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,F)}}_addIconDebugCollisionBoxes(s,l,p,v,A,F){for(let N=v;N<A;N++){const U=p.get(N),H=this.getSymbolInstanceIconSize(s,l,F.placedIconSymbolIndex);this._addCollisionDebugVertices(U,H,this.iconCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,F)}}generateCollisionDebugBuffers(s,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rf(Is,Lg.members,nl),this.iconCollisionBox=new rf(Is,Lg.members,nl);const p=$d(this.iconSizeData,s),v=$d(this.textSizeData,s);for(let A=0;A<this.symbolInstances.length;A++){const F=this.symbolInstances.get(A);this._addTextDebugCollisionBoxes(v,s,l,F.textBoxStartIndex,F.textBoxEndIndex,F),this._addTextDebugCollisionBoxes(v,s,l,F.verticalTextBoxStartIndex,F.verticalTextBoxEndIndex,F),this._addIconDebugCollisionBoxes(p,s,l,F.iconBoxStartIndex,F.iconBoxEndIndex,F),this._addIconDebugCollisionBoxes(p,s,l,F.verticalIconBoxStartIndex,F.verticalIconBoxEndIndex,F)}}getSymbolInstanceTextSize(s,l,p,v){const A=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:v),F=tc(this.textSizeData,s,A)/or;return this.tilePixelRatio*F}getSymbolInstanceIconSize(s,l,p){const v=this.icon.placedSymbolArray.get(p),A=tc(this.iconSizeData,s,v);return this.tilePixelRatio*A}_commitDebugCollisionVertexUpdate(s,l,p){s.emplaceBack(l,-p,-p),s.emplaceBack(l,p,-p),s.emplaceBack(l,p,p),s.emplaceBack(l,-p,p)}_updateTextDebugCollisionBoxes(s,l,p,v,A,F){for(let N=v;N<A;N++){const U=p.get(N),H=this.getSymbolInstanceTextSize(s,F,l,N);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,H,U.padding)}}_updateIconDebugCollisionBoxes(s,l,p,v,A,F){for(let N=v;N<A;N++){const U=p.get(N),H=this.getSymbolInstanceIconSize(s,l,F);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,H,U.padding)}}updateCollisionDebugBuffers(s,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=$d(this.iconSizeData,s),v=$d(this.textSizeData,s);for(let A=0;A<this.symbolInstances.length;A++){const F=this.symbolInstances.get(A);this._updateTextDebugCollisionBoxes(v,s,l,F.textBoxStartIndex,F.textBoxEndIndex,F),this._updateTextDebugCollisionBoxes(v,s,l,F.verticalTextBoxStartIndex,F.verticalTextBoxEndIndex,F),this._updateIconDebugCollisionBoxes(p,s,l,F.iconBoxStartIndex,F.iconBoxEndIndex,F.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,s,l,F.verticalIconBoxStartIndex,F.verticalIconBoxEndIndex,F.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,l,p,v,A,F,N,U,H){const K={};if(l<p){const{x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae,featureIndex:de}=s.get(l);K.textBox={x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae},K.textFeatureIndex=de}if(v<A){const{x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae,featureIndex:de}=s.get(v);K.verticalTextBox={x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae},K.verticalTextFeatureIndex=de}if(F<N){const{x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae,featureIndex:de}=s.get(F);K.iconBox={x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae},K.iconFeatureIndex=de}if(U<H){const{x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae,featureIndex:de}=s.get(U);K.verticalIconBox={x1:et,y1:ot,x2:ft,y2:_t,padding:St,projectedAnchorX:Lt,projectedAnchorY:Zt,projectedAnchorZ:he,tileAnchorX:Ut,tileAnchorY:ae},K.verticalIconFeatureIndex=de}return K}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,l){const p=s.placedSymbolArray.get(l),v=p.vertexStartIndex+4*p.numGlyphs;for(let A=p.vertexStartIndex;A<v;A+=4)s.indexArray.emplaceBack(A,A+1,A+2),s.indexArray.emplaceBack(A+1,A+2,A+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(s),p=Math.cos(s),v=[],A=[],F=[];for(let N=0;N<this.symbolInstances.length;++N){F.push(N);const U=this.symbolInstances.get(N);v.push(0|Math.round(l*U.tileAnchorX+p*U.tileAnchorY)),A.push(U.featureIndex)}return F.sort((N,U)=>v[N]-v[U]||A[U]-A[N]),F}addToSortKeyRanges(s,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:A,leftJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:N,placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:H}=p;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),A>=0&&A!==v&&this.addIndicesForPlacedSymbol(this.text,A),F>=0&&F!==A&&F!==v&&this.addIndicesForPlacedSymbol(this.text,F),N>=0&&this.addIndicesForPlacedSymbol(this.text,N),U>=0&&this.addIndicesForPlacedSymbol(this.icon,U),H>=0&&this.addIndicesForPlacedSymbol(this.icon,H)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Hi(sc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sc.MAX_GLYPHS=65535,sc.addDynamicAttributes=bp;const $b=new ci({"symbol-placement":new we(B.layout_symbol["symbol-placement"]),"symbol-spacing":new we(B.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new we(B.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Be(B.layout_symbol["symbol-sort-key"]),"symbol-z-order":new we(B.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new we(B.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new we(B.layout_symbol["icon-ignore-placement"]),"icon-optional":new we(B.layout_symbol["icon-optional"]),"icon-rotation-alignment":new we(B.layout_symbol["icon-rotation-alignment"]),"icon-size":new Be(B.layout_symbol["icon-size"]),"icon-text-fit":new we(B.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new we(B.layout_symbol["icon-text-fit-padding"]),"icon-image":new Be(B.layout_symbol["icon-image"]),"icon-rotate":new Be(B.layout_symbol["icon-rotate"]),"icon-padding":new we(B.layout_symbol["icon-padding"]),"icon-keep-upright":new we(B.layout_symbol["icon-keep-upright"]),"icon-offset":new Be(B.layout_symbol["icon-offset"]),"icon-anchor":new Be(B.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new we(B.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new we(B.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new we(B.layout_symbol["text-rotation-alignment"]),"text-field":new Be(B.layout_symbol["text-field"]),"text-font":new Be(B.layout_symbol["text-font"]),"text-size":new Be(B.layout_symbol["text-size"]),"text-max-width":new Be(B.layout_symbol["text-max-width"]),"text-line-height":new Be(B.layout_symbol["text-line-height"]),"text-letter-spacing":new Be(B.layout_symbol["text-letter-spacing"]),"text-justify":new Be(B.layout_symbol["text-justify"]),"text-radial-offset":new Be(B.layout_symbol["text-radial-offset"]),"text-variable-anchor":new we(B.layout_symbol["text-variable-anchor"]),"text-anchor":new Be(B.layout_symbol["text-anchor"]),"text-max-angle":new we(B.layout_symbol["text-max-angle"]),"text-writing-mode":new we(B.layout_symbol["text-writing-mode"]),"text-rotate":new Be(B.layout_symbol["text-rotate"]),"text-padding":new we(B.layout_symbol["text-padding"]),"text-keep-upright":new we(B.layout_symbol["text-keep-upright"]),"text-transform":new Be(B.layout_symbol["text-transform"]),"text-offset":new Be(B.layout_symbol["text-offset"]),"text-allow-overlap":new we(B.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new we(B.layout_symbol["text-ignore-placement"]),"text-optional":new we(B.layout_symbol["text-optional"])});var Qr={paint:new ci({"icon-opacity":new Be(B.paint_symbol["icon-opacity"]),"icon-color":new Be(B.paint_symbol["icon-color"]),"icon-halo-color":new Be(B.paint_symbol["icon-halo-color"]),"icon-halo-width":new Be(B.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Be(B.paint_symbol["icon-halo-blur"]),"icon-translate":new we(B.paint_symbol["icon-translate"]),"icon-translate-anchor":new we(B.paint_symbol["icon-translate-anchor"]),"text-opacity":new Be(B.paint_symbol["text-opacity"]),"text-color":new Be(B.paint_symbol["text-color"],{runtimeType:kt,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Be(B.paint_symbol["text-halo-color"]),"text-halo-width":new Be(B.paint_symbol["text-halo-width"]),"text-halo-blur":new Be(B.paint_symbol["text-halo-blur"]),"text-translate":new we(B.paint_symbol["text-translate"]),"text-translate-anchor":new we(B.paint_symbol["text-translate-anchor"])}),layout:$b};class F_{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:q,this.defaultValue=s}evaluate(s){if(s.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Hi(F_,"FormatSectionOverride",{omit:["defaultValue"]});class af extends Fo{constructor(s){super(s,Qr)}recalculate(s,l){super.recalculate(s,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const A of p)v.indexOf(A)<0&&v.push(A);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,l,p,v){const A=this.layout.get(s).evaluate(l,{},p,v),F=this._unevaluatedLayout._values[s];return F.isDataDriven()||mr(F.value)||!A?A:(N=l.properties,A.replace(/{([^{}]+)}/g,(H,K)=>K in N?String(N[K]):""));var N}createBucket(s){return new sc(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of Qr.paint.overridableProperties){if(!af.hasPaintOverride(this.layout,s))continue;const l=this.paint.get(s),p=new F_(l),v=new Ql(p,l.property.specification);let A=null;A="constant"===l.value.kind||"source"===l.value.kind?new Du("source",v):new ql("composite",v,l.value.zoomStops,l.value._interpolationType),this.paint._values[s]=new ti(l.property,A,l.parameters)}}_handleOverridablePaintPropertyUpdate(s,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&af.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,l){const p=s.get("text-field"),v=Qr.paint.properties[l];let A=!1;const F=N=>{for(const U of N)if(v.overrides&&v.overrides.hasOverride(U))return void(A=!0)};if("constant"===p.value.kind&&p.value.value instanceof yn)F(p.value.value.sections);else if("source"===p.value.kind){const N=H=>{A||(H instanceof mn&&fe(H.value)===Ft?F(H.value.sections):H instanceof ui?F(H.sections):H.eachChild(N))},U=p.value;U._styleExpression&&N(U._styleExpression.expression)}return A}getProgramConfiguration(s){return new ra(this,s)}}var EC={paint:new ci({"background-color":new we(B.paint_background["background-color"]),"background-pattern":new we(B.paint_background["background-pattern"]),"background-opacity":new we(B.paint_background["background-opacity"])})},tx={paint:new ci({"raster-opacity":new we(B.paint_raster["raster-opacity"]),"raster-hue-rotate":new we(B.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new we(B.paint_raster["raster-brightness-min"]),"raster-brightness-max":new we(B.paint_raster["raster-brightness-max"]),"raster-saturation":new we(B.paint_raster["raster-saturation"]),"raster-contrast":new we(B.paint_raster["raster-contrast"]),"raster-resampling":new we(B.paint_raster["raster-resampling"]),"raster-fade-duration":new we(B.paint_raster["raster-fade-duration"])})};class L_ extends Fo{constructor(s){super(s,{}),this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var Gb={paint:new ci({"sky-type":new we(B.paint_sky["sky-type"]),"sky-atmosphere-sun":new we(B.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new we(B.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new we(B.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new we(B.paint_sky["sky-gradient-radius"]),"sky-gradient":new ei(B.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new we(B.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new we(B.paint_sky["sky-atmosphere-color"]),"sky-opacity":new we(B.paint_sky["sky-opacity"])})};function ex(r,s,l){const p=[0,0,1],v=qv([]);return gm(v,v,l?-Xi(r)+Math.PI:Xi(r)),tb(v,v,-Xi(s)),ng(p,p,v),Nr(p,p)}const Zb={circle:class extends Fo{constructor(r){super(r,fg)}createBucket(r){return new ug(r)}queryRadius(r){const s=r;return Kh("circle-radius",this,s)+Kh("circle-stroke-width",this,s)+ep(this.paint.get("circle-translate"))}queryIntersectsFeature(r,s,l,p,v,A,F,N){const U=np(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,r.pixelToTileUnitsFactor),H=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l);return Sm(r,p,A,F,N,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),U,H)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new ra(this,r)}},heatmap:class extends Fo{createBucket(r){return new Xy(r)}constructor(r){super(r,xg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){"heatmap-color"===r&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Jh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return Kh("heatmap-radius",this,r)}queryIntersectsFeature(r,s,l,p,v,A,F,N){const U=this.paint.get("heatmap-radius").evaluate(s,l);return Sm(r,p,A,F,N,!0,!0,new xi(0,0),U)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new ra(this,r)}},hillshade:class extends Fo{constructor(r){super(r,hb)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Fo{constructor(r){super(r,Cg)}getProgramIds(){const r=this.paint.get("fill-pattern"),s=r&&r.constantOr(1),l=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(r){return new ra(this,r)}recalculate(r,s){super.recalculate(r,s);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Mg(r)}queryRadius(){return ep(this.paint.get("fill-translate"))}queryIntersectsFeature(r,s,l,p,v,A){return!r.queryGeometry.isAboveHorizon&&Gh(ip(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,r.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Fo{constructor(r){super(r,Eg)}createBucket(r){return new Rm(r)}queryRadius(){return ep(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new ra(this,r)}queryIntersectsFeature(r,s,l,p,v,A,F,N,U){const H=np(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,r.pixelToTileUnitsFactor),K=this.paint.get("fill-extrusion-height").evaluate(s,l),et=this.paint.get("fill-extrusion-base").evaluate(s,l),ot=[0,0],ft=N&&A.elevation,_t=A.elevation?A.elevation.exaggeration():1,St=r.tile.getBucket(this);if(ft&&St instanceof Rm){const ae=St.centroidVertexArray,de=U+1;de<ae.length&&(ot[0]=ae.geta_centroid_pos0(de),ot[1]=ae.geta_centroid_pos1(de))}if(0===ot[0]&&1===ot[1])return!1;"globe"===A.projection.name&&(p=Pg([p],[new xi(0,0),new xi(_n,_n)],r.tileID.canonical).map(ae=>ae.polygon).flat());const Lt=ft?N:null,[Zt,he]=(de=p,ce=et,Ce=K,ke=H,je=F,si=Lt,Ae=ot,Ye=_t,Ge=A.center.lat,"globe"===(ae=A).projection.name?function(di,Oe,Ci,hn,ki,Yi,Si,gn,Jn,Hn,jn){const xn=[],Cs=[],kn=di.projection.upVectorScale(jn,di.center.lat,di.worldSize).metersToTile,Qn=[0,0,0,1],Rs=[0,0,0,1],eo=(io,bs,Ln,Wo)=>{io[0]=bs,io[1]=Ln,io[2]=Wo,io[3]=1},Dn=o_();Ci>0&&(Ci+=Dn),hn+=Dn;for(const io of Oe){const bs=[],Ln=[];for(const Wo of io){const Fs=Wo.x+ki.x,Pn=Wo.y+ki.y,Nn=di.projection.projectTilePoint(Fs,Pn,jn),An=di.projection.upVector(jn,Wo.x,Wo.y);let xo=Ci,Bo=hn;if(Si){const Ts=zm(Fs,Pn,Ci,hn,Si,gn,Jn,Hn);xo+=Ts.base,Bo+=Ts.top}0!==Ci?eo(Qn,Nn.x+An[0]*kn*xo,Nn.y+An[1]*kn*xo,Nn.z+An[2]*kn*xo):eo(Qn,Nn.x,Nn.y,Nn.z),eo(Rs,Nn.x+An[0]*kn*Bo,Nn.y+An[1]*kn*Bo,Nn.z+An[2]*kn*Bo),go(Qn,Qn,Yi),go(Rs,Rs,Yi),bs.push(new Gc(Qn[0],Qn[1],Qn[2])),Ln.push(new Gc(Rs[0],Rs[1],Rs[2]))}xn.push(bs),Cs.push(Ln)}return[xn,Cs]}(ae,de,ce,Ce,ke,je,si,Ae,Ye,Ge,r.tileID.canonical):si?function(di,Oe,Ci,hn,ki,Yi,Si,gn,Jn){const Hn=[],jn=[],xn=[0,0,0,1];for(const Cs of di){const kn=[],Qn=[];for(const Rs of Cs){const eo=Rs.x+hn.x,Dn=Rs.y+hn.y,io=zm(eo,Dn,Oe,Ci,Yi,Si,gn,Jn);xn[0]=eo,xn[1]=Dn,xn[2]=io.base,xn[3]=1,Uc(xn,xn,ki),xn[3]=Math.max(xn[3],1e-5);const bs=new Gc(xn[0]/xn[3],xn[1]/xn[3],xn[2]/xn[3]);xn[0]=eo,xn[1]=Dn,xn[2]=io.top,xn[3]=1,Uc(xn,xn,ki),xn[3]=Math.max(xn[3],1e-5);const Ln=new Gc(xn[0]/xn[3],xn[1]/xn[3],xn[2]/xn[3]);kn.push(bs),Qn.push(Ln)}Hn.push(kn),jn.push(Qn)}return[Hn,jn]}(de,ce,Ce,ke,je,si,Ae,Ye,Ge):function(di,Oe,Ci,hn,ki){const Yi=[],Si=[],gn=ki[8]*Oe,Jn=ki[9]*Oe,Hn=ki[10]*Oe,jn=ki[11]*Oe,xn=ki[8]*Ci,Cs=ki[9]*Ci,kn=ki[10]*Ci,Qn=ki[11]*Ci;for(const Rs of di){const eo=[],Dn=[];for(const io of Rs){const bs=io.x+hn.x,Ln=io.y+hn.y,Wo=ki[0]*bs+ki[4]*Ln+ki[12],Fs=ki[1]*bs+ki[5]*Ln+ki[13],Pn=ki[2]*bs+ki[6]*Ln+ki[14],Nn=ki[3]*bs+ki[7]*Ln+ki[15],An=Wo+gn,xo=Fs+Jn,Bo=Pn+Hn,Ts=Math.max(Nn+jn,1e-5),Mo=Wo+xn,Xo=Fs+Cs,Oo=Pn+kn,$o=Math.max(Nn+Qn,1e-5);eo.push(new Gc(An/Ts,xo/Ts,Bo/Ts)),Dn.push(new Gc(Mo/$o,Xo/$o,Oo/$o))}Yi.push(eo),Si.push(Dn)}return[Yi,Si]}(de,ce,Ce,ke,je)),Ut=r.queryGeometry;var ae,de,ce,Ce,ke,je,si,Ae,Ye,Ge;return function(ae,de,ce){let Ce=1/0;Gh(ce,de)&&(Ce=l_(ce,de[0]));for(let ke=0;ke<de.length;ke++){const je=de[ke],si=ae[ke];for(let Ae=0;Ae<je.length-1;Ae++){const Ye=je[Ae],Ge=[Ye,je[Ae+1],si[Ae+1],si[Ae],Ye];pg(ce,Ge)&&(Ce=Math.min(Ce,l_(ce,Ge)))}}return Ce!==1/0&&Ce}(Zt,he,Ut.isPointQuery()?Ut.screenBounds:Ut.screenGeometry)}},line:class extends Fo{constructor(r){super(r,c_),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if("line-gradient"===r){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof Mh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=Ig.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Hd(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new ra(this,r)}queryRadius(r){const s=r,l=Zc(Kh("line-width",this,s),Kh("line-gap-width",this,s)),p=Kh("line-offset",this,s);return l/2+Math.abs(p)+ep(this.paint.get("line-translate"))}queryIntersectsFeature(r,s,l,p,v,A){if(r.queryGeometry.isAboveHorizon)return!1;const F=ip(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,r.pixelToTileUnitsFactor),N=r.pixelToTileUnitsFactor/2*Zc(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),U=this.paint.get("line-offset").evaluate(s,l);return U&&(p=function(H,K){const et=[],ot=new xi(0,0);for(let ft=0;ft<H.length;ft++){const _t=H[ft],St=[];for(let Lt=0;Lt<_t.length;Lt++){const he=_t[Lt],Ut=_t[Lt+1],ae=0===Lt?ot:he.sub(_t[Lt-1])._unit()._perp(),de=Lt===_t.length-1?ot:Ut.sub(he)._unit()._perp(),ce=ae._add(de)._unit();ce._mult(1/(ce.x*de.x+ce.y*de.y)),St.push(ce._mult(K)._add(he))}et.push(St)}return et}(p,U*r.pixelToTileUnitsFactor)),function(H,K,et){for(let ot=0;ot<K.length;ot++){const ft=K[ot];if(H.length>=3)for(let _t=0;_t<ft.length;_t++)if(Zh(H,ft[_t]))return!0;if(Oy(H,ft,et))return!0}return!1}(F,p,N)}isTileClipped(){return!0}},symbol:af,background:class extends Fo{constructor(r){super(r,EC)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Fo{constructor(r){super(r,tx)}getProgramIds(){return["raster"]}},sky:class extends Fo{constructor(r){super(r,Gb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){"sky-gradient"===r?this._updateColorRamp():"sky-atmosphere-sun"!==r&&"sky-atmosphere-halo-color"!==r&&"sky-atmosphere-color"!==r&&"sky-atmosphere-sun-intensity"!==r||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Jh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(r,s){if("atmosphere"===this.paint.get("sky-type")){const p=this.paint.get("sky-atmosphere-sun"),v=!p,A=r.style.light,F=A.properties.get("position");return v&&"viewport"===A.properties.get("anchor")&&Xt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?ex(F.azimuthal,90-F.polar,s):ex(p[0],90-p[1],s)}const l=this.paint.get("sky-gradient-center");return ex(l[0],90-l[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return"atmosphere"===r?["skyboxCapture","skybox"]:"gradient"===r?["skyboxGradient"]:null}}};class eu{constructor(s,l,p,v){this.context=s,this.format=p,this.texture=s.gl.createTexture(),this.update(l,v)}update(s,l,p){const{width:v,height:A}=s,{context:F}=this,{gl:N}=F,{HTMLImageElement:U,HTMLCanvasElement:H,HTMLVideoElement:K,ImageData:et,ImageBitmap:ot}=De;if(N.bindTexture(N.TEXTURE_2D,this.texture),F.pixelStoreUnpackFlipY.set(!1),F.pixelStoreUnpack.set(1),F.pixelStoreUnpackPremultiplyAlpha.set(this.format===N.RGBA&&(!l||!1!==l.premultiply)),p||this.size&&this.size[0]===v&&this.size[1]===A){const{x:ft,y:_t}=p||{x:0,y:0};s instanceof U||s instanceof H||s instanceof K||s instanceof et||ot&&s instanceof ot?N.texSubImage2D(N.TEXTURE_2D,0,ft,_t,N.RGBA,N.UNSIGNED_BYTE,s):N.texSubImage2D(N.TEXTURE_2D,0,ft,_t,v,A,N.RGBA,N.UNSIGNED_BYTE,s.data)}else this.size=[v,A],s instanceof U||s instanceof H||s instanceof K||s instanceof et||ot&&s instanceof ot?N.texImage2D(N.TEXTURE_2D,0,this.format,this.format,N.UNSIGNED_BYTE,s):N.texImage2D(N.TEXTURE_2D,0,this.format,v,A,0,this.format,N.UNSIGNED_BYTE,s.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&N.generateMipmap(N.TEXTURE_2D)}bind(s,l){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?s===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_NEAREST:s),this.filter=s),l!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,l),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class Kb{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Jb{constructor(){this.tasks={},this.taskQueue=[],Ls(["process"],this),this.invoker=new Kb(this.process),this.nextId=0}add(s,l){const p=this.nextId++,v=function({type:A,isSymbolTile:F,zoom:N}){return N=N||0,"message"===A?0:"maybePrepare"!==A||F?"parseTile"!==A||F?"parseTile"===A&&F?300-N:"maybePrepare"===A&&F?400-N:500:200-N:100-N}(l);if(0===v){Ke();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:s,metadata:l,priority:v,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){Ke();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const s=this.pick();if(null===s)return;const l=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let s=null,l=1/0;for(let v=0;v<this.taskQueue.length;v++){const A=this.tasks[this.taskQueue[v]];A.priority<l&&(l=A.priority,s=v)}if(null===s)return null;const p=this.taskQueue[s];return this.taskQueue.splice(s,1),p}remove(){this.invoker.remove()}}class lf{constructor(s){this._stringToNumber={},this._numberToString=[];for(let l=0;l<s.length;l++){const p=s[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const Qb=["tile","layer","source","sourceLayer","state"];class B_{constructor(s,l,p,v,A){this.type="Feature",this._vectorTileFeature=s,this._z=l,this._x=p,this._y=v,this.properties=s.properties,this.id=A}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(s.id=this.id);for(const l of Qb)void 0!==this[l]&&(s[l]=this[l]);return s}}const $a=32,Fl=33,oc=new Uint16Array(8184);for(let r=0;r<2046;r++){let s=r+2,l=0,p=0,v=0,A=0,F=0,N=0;for(1&s?v=A=F=$a:l=p=N=$a;(s>>=1)>1;){const H=l+v>>1,K=p+A>>1;1&s?(v=l,A=p,l=F,p=N):(l=v,p=A,v=F,A=N),F=H,N=K}const U=4*r;oc[U+0]=l,oc[U+1]=p,oc[U+2]=v,oc[U+3]=A}const rr=new Uint16Array(2178),Ll=new Uint8Array(1089),hf=new Uint16Array(1089);function O_(r){return 0===r?-.03125:32===r?.03125:0}var ix=nn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const R_={type:2,extent:_n,loadGeometry:()=>[[new xi(0,0),new xi(8193,0),new xi(8193,8193),new xi(0,8193),new xi(0,0)]]};class nx{constructor(s,l,p,v,A){this.tileID=s,this.uid=ao(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection)}registerFadeDuration(s){const l=s+this.timeAdded;l<c.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=nc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,l,p){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(v,A){const F={};if(!A)return F;for(const N of v){const U=N.layerIds.map(H=>A.getLayer(H)).filter(Boolean);if(0!==U.length){N.layers=U,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(H=>U.filter(K=>K.id===H)[0]));for(const H of U)F[H.id]=N}}return F}(s.buckets,l.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const A=this.buckets[v];if(A instanceof sc){if(this.hasSymbolBuckets=!0,!p)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const A=this.buckets[v];if(A instanceof sc&&A.hasRTLText){this.hasRTLText=!0,ge.isLoading()||ge.isLoaded()||"deferred"!==me()||ue();break}}this.queryPadding=0;for(const v in this.buckets){const A=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(v).queryRadius(A))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new oh}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const p in this.buckets){const v=this.buckets[p];v.uploadPending()&&v.upload(s)}const l=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new eu(s,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new eu(s,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new eu(s,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,l,p,v,A,F,N,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:v,pixelPosMatrix:N,transform:F,params:A,tileTransform:this.tileTransform},s,l,p):{}}querySourceFeatures(s,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),A=l?l.sourceLayer:"",F=v._geojsonTileLayer||v[A];if(!F)return;const N=Fu(l&&l.filter),{z:U,x:H,y:K}=this.tileID.canonical,et={z:U,x:H,y:K};for(let ot=0;ot<F.length;ot++){const ft=F.feature(ot);if(N.needGeometry){const Lt=$h(ft,!0);if(!N.filter(new be(this.tileID.overscaledZ),Lt,this.tileID.canonical))continue}else if(!N.filter(new be(this.tileID.overscaledZ),ft))continue;const _t=p.getId(ft,A),St=new B_(ft,U,H,K,_t);St.tile=et,s.push(St)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const l=this.expirationTime;if(s.cacheControl){const p=Vi(s.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(l)if(this.expirationTime<l)v=!0;else{const A=this.expirationTime-l;A?this.expirationTime=p+Math.max(A,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length||!l)return;const p=this.latestFeatureIndex.loadVTLayers(),v=l.style.listImages();for(const A in this.buckets){if(!l.style.hasLayer(A))continue;const F=this.buckets[A],N=F.layers[0].sourceLayer||"_geojsonTileLayer",U=p[N],H=s[N];if(!U||!H||0===Object.keys(H).length)continue;if(F.update(H,U,v,this.imageAtlas&&this.imageAtlas.patternPositions||{}),F instanceof Hd||F instanceof Mg){const et=l.style._getSourceCache(F.layers[0].source);l._terrain&&l._terrain.enabled&&et&&F.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(et.id,this.tileID)}const K=l&&l.style&&l.style.getLayer(A);K&&(this.queryPadding=Math.max(this.queryPadding,K.queryRadius(F)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=c.now()+s}setTexture(s,l){const p=l.context,v=p.gl;this.texture=this.texture||l.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new eu(p,s,v.RGBA,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(s,l){const p={};for(const v of l)p[v]=!0;this.dependencies[s]=p}hasDependency(s,l){for(const p of s){const v=this.dependencies[p];if(v)for(const A of l)if(v[A])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,l){if(!l||"mercator"===l.name||this._tileDebugBuffer)return;const p=ll(R_,this.tileID.canonical,this.tileTransform)[0],v=new sn,A=new sl;for(let F=0;F<p.length;F++){const{x:N,y:U}=p[F];v.emplaceBack(N,U),A.emplaceBack(F)}A.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(A),this._tileDebugBuffer=s.createVertexBuffer(v,xm.members),this._tileDebugSegments=Vo.simpleSegment(0,0,v.length,A.length)}_makeTileBoundsBuffers(s,l){if(this._tileBoundsBuffer||!l||"mercator"===l.name)return;const p=ll(R_,this.tileID.canonical,this.tileTransform)[0];let v,A;if(this.isRaster){const F=function(N,U){const H=nc(N,U),K=Math.pow(2,N.z);for(let Lt=0;Lt<Fl;Lt++)for(let Zt=0;Zt<Fl;Zt++){const he=da((N.x+(Zt+O_(Zt))/$a)/K),Ut=Lo((N.y+(Lt+O_(Lt))/$a)/K),ae=U.project(he,Ut),de=Lt*Fl+Zt;rr[2*de+0]=Math.round((ae.x*H.scale-H.x)*_n),rr[2*de+1]=Math.round((ae.y*H.scale-H.y)*_n)}Ll.fill(0),hf.fill(0);for(let Lt=2045;Lt>=0;Lt--){const Zt=4*Lt,he=oc[Zt+0],Ut=oc[Zt+1],ae=oc[Zt+2],de=oc[Zt+3],ce=he+ae>>1,Ce=Ut+de>>1,ke=ce+Ce-Ut,je=Ce+he-ce,si=Ut*Fl+he,Ae=de*Fl+ae,Ye=Ce*Fl+ce,Ge=Math.hypot((rr[2*si+0]+rr[2*Ae+0])/2-rr[2*Ye+0],(rr[2*si+1]+rr[2*Ae+1])/2-rr[2*Ye+1])>=16;Ll[Ye]=Ll[Ye]||(Ge?1:0),Lt<1022&&(Ll[Ye]=Ll[Ye]||Ll[(Ut+je>>1)*Fl+(he+ke>>1)]||Ll[(de+je>>1)*Fl+(ae+ke>>1)])}const et=new vs,ot=new ir;let ft=0;function _t(Lt,Zt){const he=Zt*Fl+Lt;return 0===hf[he]&&(et.emplaceBack(rr[2*he+0],rr[2*he+1],Lt*_n/$a,Zt*_n/$a),hf[he]=++ft),hf[he]-1}function St(Lt,Zt,he,Ut,ae,de){const ce=Lt+he>>1,Ce=Zt+Ut>>1;if(Math.abs(Lt-ae)+Math.abs(Zt-de)>1&&Ll[Ce*Fl+ce])St(ae,de,Lt,Zt,ce,Ce),St(he,Ut,ae,de,ce,Ce);else{const ke=_t(Lt,Zt),je=_t(he,Ut),si=_t(ae,de);ot.emplaceBack(ke,je,si)}}return St(0,0,$a,$a,$a,0),St($a,$a,0,0,0,$a),{vertices:et,indices:ot}}(this.tileID.canonical,l);v=F.vertices,A=F.indices}else{v=new vs,A=new ir;for(const{x:N,y:U}of p)v.emplaceBack(N,U,0,0);const F=Vd(v.int16,void 0,4);for(let N=0;N<F.length;N+=3)A.emplaceBack(F[N],F[N+1],F[N+2])}this._tileBoundsBuffer=s.createVertexBuffer(v,ix.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(A),this._tileBoundsSegments=Vo.simpleSegment(0,0,v.length,A.length)}_makeGlobeTileDebugBuffers(s,l){const p=l.projection;if(!p||"globe"!==p.name||l.freezeTileCoverage)return;const v=this.tileID.canonical,A=qu(Ty(v,l)),F=Yc(l.zoom);let N;F>0&&(N=Hu(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,v,l,A,N,F),this._makeGlobeTileDebugTextBuffer(s,v,l,A,N,F)}_globePoint(s,l,p,v,A,F,N){let U=ah(s,l,p);if(F){const H=1<<p.z,K=Pl(v.center.lng),et=Ha(v.center.lat),ot=(p.x+.5)/H-K;let ft=0;ot>.5?ft=-1:ot<-.5&&(ft=1);let _t=(s/_n+p.x)/H+ft,St=(l/_n+p.y)/H;_t=(_t-K)*v._pixelsPerMercatorPixel+K,St=(St-et)*v._pixelsPerMercatorPixel+et;const Lt=[_t*v.worldSize,St*v.worldSize,0];go(Lt,Lt,F),U=Uh(U,Lt,N)}return go(U,U,A)}_makeGlobeTileDebugBorderBuffer(s,l,p,v,A,F){const N=new sn,U=new sl,H=new fs,K=(ot,ft,_t,St,Lt)=>{const Zt=(_t-ot)/(Lt-1),he=(St-ft)/(Lt-1),Ut=N.length;for(let ae=0;ae<Lt;ae++){const de=ot+ae*Zt,ce=ft+ae*he;N.emplaceBack(de,ce);const Ce=this._globePoint(de,ce,l,p,v,A,F);H.emplaceBack(Ce[0],Ce[1],Ce[2]),U.emplaceBack(Ut+ae)}},et=_n;K(0,0,et,0,16),K(et,0,et,et,16),K(et,et,0,et,16),K(0,et,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(U),this._tileDebugBuffer=s.createVertexBuffer(N,xm.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(H,ib.members),this._tileDebugSegments=Vo.simpleSegment(0,0,N.length,U.length)}_makeGlobeTileDebugTextBuffer(s,l,p,v,A,F){const N=new sn,U=new ir,H=new fs,K=25;U.reserve(32),N.reserve(K),H.reserve(K);const et=(ot,ft)=>K*ot+ft;for(let ot=0;ot<K;ot++){const ft=2048*ot;for(let _t=0;_t<K;_t++){const St=2048*_t;N.emplaceBack(St,ft);const Lt=this._globePoint(St,ft,l,p,v,A,F);H.emplaceBack(Lt[0],Lt[1],Lt[2])}}for(let ot=0;ot<4;ot++)for(let ft=0;ft<4;ft++){const _t=et(ot,ft),St=et(ot,ft+1),Lt=et(ot+1,ft),Zt=et(ot+1,ft+1);U.emplaceBack(_t,St,Lt),U.emplaceBack(Lt,St,Zt)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(U),this._tileDebugTextBuffer=s.createVertexBuffer(N,xm.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(H,ib.members),this._tileDebugTextSegments=Vo.simpleSegment(0,0,K,32)}}class qb{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,l,p){const v=String(l);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][v]=this.stateChanges[s][v]||{},ln(this.stateChanges[s][v],p),null===this.deletedStates[s]){this.deletedStates[s]={};for(const A in this.state[s])A!==v&&(this.deletedStates[s][A]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][v]){this.deletedStates[s][v]={};for(const A in this.state[s][v])p[A]||(this.deletedStates[s][v][A]=null)}else for(const A in p)this.deletedStates[s]&&this.deletedStates[s][v]&&null===this.deletedStates[s][v][A]&&delete this.deletedStates[s][v][A]}removeFeatureState(s,l,p){if(null===this.deletedStates[s])return;const v=String(l);if(this.deletedStates[s]=this.deletedStates[s]||{},p&&void 0!==l)null!==this.deletedStates[s][v]&&(this.deletedStates[s][v]=this.deletedStates[s][v]||{},this.deletedStates[s][v][p]=null);else if(void 0!==l)if(this.stateChanges[s]&&this.stateChanges[s][v])for(p in this.deletedStates[s][v]={},this.stateChanges[s][v])this.deletedStates[s][v][p]=null;else this.deletedStates[s][v]=null;else this.deletedStates[s]=null}getState(s,l){const p=String(l),v=ln({},(this.state[s]||{})[p],(this.stateChanges[s]||{})[p]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const A=this.deletedStates[s][l];if(null===A)return{};for(const F in A)delete v[F]}return v}initializeTileState(s,l){s.setFeatureState(this.state,l)}coalesceChanges(s,l){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const A={};for(const F in this.stateChanges[v])this.state[v][F]||(this.state[v][F]={}),ln(this.state[v][F],this.stateChanges[v][F]),A[F]=this.state[v][F];p[v]=A}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const A={};if(null===this.deletedStates[v])for(const F in this.state[v])A[F]={},this.state[v][F]={};else for(const F in this.deletedStates[v]){if(null===this.deletedStates[v][F])this.state[v][F]={};else if(this.state[v][F])for(const N of Object.keys(this.deletedStates[v][F]))delete this.state[v][F][N];A[F]=this.state[v][F]}p[v]=p[v]||{},ln(p[v],A)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(p).length)for(const v in s)s[v].setFeatureState(p,l)}}class cf{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,l){const p=this.toIdx(s,l);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(s,l){return this.leaves[this.toIdx(s,l)]}toIdx(s,l){return l*this.size+s}}function V_(r,s,l,p){let v=0,A=Number.MAX_VALUE;for(let F=0;F<3;F++)if(Math.abs(p[F])<1e-15){if(l[F]<r[F]||l[F]>s[F])return null}else{const N=1/p[F];let U=(r[F]-l[F])*N,H=(s[F]-l[F])*N;if(U>H){const K=U;U=H,H=K}if(U>v&&(v=U),H<A&&(A=H),v>A)return null}return v}function z_(r,s,l,p,v,A,F,N,U,H,K){const et=p-r,ot=v-s,ft=A-l,_t=F-r,St=N-s,Lt=U-l,Zt=K[1]*Lt-K[2]*St,he=K[2]*_t-K[0]*Lt,Ut=K[0]*St-K[1]*_t,ae=et*Zt+ot*he+ft*Ut;if(Math.abs(ae)<1e-15)return null;const de=1/ae,ce=H[0]-r,Ce=H[1]-s,ke=H[2]-l,je=(ce*Zt+Ce*he+ke*Ut)*de;if(je<0||je>1)return null;const si=Ce*ft-ke*ot,Ae=ke*et-ce*ft,Ye=ce*ot-Ce*et,Ge=(K[0]*si+K[1]*Ae+K[2]*Ye)*de;return Ge<0||je+Ge>1?null:(_t*si+St*Ae+Lt*Ye)*de}function wp(r,s,l){return(r-s)/(l-s)}function Mp(r,s,l,p,v,A,F,N,U){const H=1<<l,K=A-p,et=F-v,ot=(r+1)/H*K+p,ft=(s+0)/H*et+v,_t=(s+1)/H*et+v;N[0]=(r+0)/H*K+p,N[1]=ft,U[0]=ot,U[1]=_t}class Cp{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(A){const F=Math.ceil(Math.log2(A.dim/8)),N=[];let U=Math.ceil(Math.pow(2,F));const H=1/U,K=(ft,_t,St,Lt,Zt)=>{const he=Lt?1:0,Ut=(ft+1)*St-he,ae=_t*St,de=(_t+1)*St-he;Zt[0]=ft*St,Zt[1]=ae,Zt[2]=Ut,Zt[3]=de};let et=new cf(U);const ot=[];for(let ft=0;ft<U*U;ft++){K(ft%U,Math.floor(ft/U),H,!1,ot);const _t=Bl(ot[0],ot[1],A),St=Bl(ot[2],ot[1],A),Lt=Bl(ot[2],ot[3],A),Zt=Bl(ot[0],ot[3],A);et.minimums.push(Math.min(_t,St,Lt,Zt)),et.maximums.push(Math.max(_t,St,Lt,Zt)),et.leaves.push(1)}for(N.push(et),U/=2;U>=1;U/=2){const ft=N[N.length-1];et=new cf(U);for(let _t=0;_t<U*U;_t++){K(_t%U,Math.floor(_t/U),2,!0,ot);const St=ft.getElevation(ot[0],ot[1]),Lt=ft.getElevation(ot[2],ot[1]),Zt=ft.getElevation(ot[2],ot[3]),he=ft.getElevation(ot[0],ot[3]),Ut=ft.isLeaf(ot[0],ot[1]),ae=ft.isLeaf(ot[2],ot[1]),de=ft.isLeaf(ot[2],ot[3]),ce=ft.isLeaf(ot[0],ot[3]),Ce=Math.min(St.min,Lt.min,Zt.min,he.min),ke=Math.max(St.max,Lt.max,Zt.max,he.max),je=Ut&&ae&&de&&ce;et.maximums.push(ke),et.minimums.push(Ce),et.leaves.push(ke-Ce<=5&&je?1:0)}N.push(et)}return N}(this.dem),p=l.length-1,v=l[p];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(l,0,0,p,0)}raycastRoot(s,l,p,v,A,F,N=1){return V_([s,l,-100],[p,v,this.maximums[0]*N],A,F)}raycast(s,l,p,v,A,F,N=1){if(!this.nodeCount)return null;const U=this.raycastRoot(s,l,p,v,A,F,N);if(null==U)return null;const H=[],K=[],et=[],ot=[],ft=[{idx:0,t:U,nodex:0,nodey:0,depth:0}];for(;ft.length>0;){const{idx:_t,t:St,nodex:Lt,nodey:Zt,depth:he}=ft.pop();if(this.leaves[_t]){Mp(Lt,Zt,he,s,l,p,v,et,ot);const ae=1<<he,de=(Lt+0)/ae,ce=(Lt+1)/ae,Ce=(Zt+0)/ae,ke=(Zt+1)/ae,je=Bl(de,Ce,this.dem)*N,si=Bl(ce,Ce,this.dem)*N,Ae=Bl(ce,ke,this.dem)*N,Ye=Bl(de,ke,this.dem)*N,Ge=z_(et[0],et[1],je,ot[0],et[1],si,ot[0],ot[1],Ae,A,F),oi=z_(ot[0],ot[1],Ae,et[0],ot[1],Ye,et[0],et[1],je,A,F),di=Math.min(null!==Ge?Ge:Number.MAX_VALUE,null!==oi?oi:Number.MAX_VALUE);if(di!==Number.MAX_VALUE)return di;{const Oe=mm([],A,F,St);if(t1(je,si,Ye,Ae,wp(Oe[0],et[0],ot[0]),wp(Oe[1],et[1],ot[1]))>=Oe[2])return St}continue}let Ut=0;for(let ae=0;ae<this._siblingOffset.length;ae++){Mp((Lt<<1)+this._siblingOffset[ae][0],(Zt<<1)+this._siblingOffset[ae][1],he+1,s,l,p,v,et,ot),et[2]=-100,ot[2]=this.maximums[this.childOffsets[_t]+ae]*N;const de=V_(et,ot,A,F);if(null!=de){const ce=de;H[ae]=ce;let Ce=!1;for(let ke=0;ke<Ut&&!Ce;ke++)ce>=H[K[ke]]&&(K.splice(ke,0,ae),Ce=!0);Ce||(K[Ut]=ae),Ut++}}for(let ae=0;ae<Ut;ae++){const de=K[ae];ft.push({idx:this.childOffsets[_t]+de,t:H[de],nodex:(Lt<<1)+this._siblingOffset[de][0],nodey:(Zt<<1)+this._siblingOffset[de][1],depth:he+1})}}return null}_addNode(s,l,p){return this.minimums.push(s),this.maximums.push(l),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(s,l,p,v,A){if(1===s[v].isLeaf(l,p))return;this.childOffsets[A]||(this.childOffsets[A]=this.nodeCount);const F=v-1,N=s[F];let U=0,H=0;for(let K=0;K<this._siblingOffset.length;K++){const et=2*l+this._siblingOffset[K][0],ot=2*p+this._siblingOffset[K][1],ft=N.getElevation(et,ot),_t=N.isLeaf(et,ot),St=this._addNode(ft.min,ft.max,_t);_t&&(U|=1<<K),H||(H=St)}for(let K=0;K<this._siblingOffset.length;K++)U&1<<K||this._construct(s,2*l+this._siblingOffset[K][0],2*p+this._siblingOffset[K][1],F,H+K)}}function t1(r,s,l,p,v,A){return rs(rs(r,l,A),rs(s,p,A),v)}function Bl(r,s,l){const p=l.dim,v=Wi(r*p-.5,0,p-1),A=Wi(s*p-.5,0,p-1),F=Math.floor(v),N=Math.floor(A),U=Math.min(F+1,p-1),H=Math.min(N+1,p-1);return t1(l.get(F,N),l.get(U,N),l.get(F,H),l.get(U,H),v-F,A-N)}const e1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function N_(r,s,l){return(256*r*256+256*s+l)/10-1e4}function W_(r,s,l){return 256*r+s+l/256-32768}class Tp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,l,p,v=!1,A=!1){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&"mapbox"!==p&&"terrarium"!==p)return Xt(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const F=this.dim=l.height-2,N=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=p||"mapbox",this.borderReady=v,!v){for(let U=0;U<F;U++)N[this._idx(-1,U)]=N[this._idx(0,U)],N[this._idx(F,U)]=N[this._idx(F-1,U)],N[this._idx(U,-1)]=N[this._idx(U,0)],N[this._idx(U,F)]=N[this._idx(U,F-1)];N[this._idx(-1,-1)]=N[this._idx(0,0)],N[this._idx(F,-1)]=N[this._idx(F-1,0)],N[this._idx(-1,F)]=N[this._idx(0,F-1)],N[this._idx(F,F)]=N[this._idx(F-1,F-1)],A&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Cp(this)}get(s,l,p=!1){p&&(s=Wi(s,-1,this.dim),l=Wi(l,-1,this.dim));const v=4*this._idx(s,l);return("terrarium"===this.encoding?W_:N_)(this.pixels[v],this.pixels[v+1],this.pixels[v+2])}static getUnpackVector(s){return e1[s]}get unpackVector(){return e1[this.encoding]}_idx(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)}static pack(s,l){const p=[0,0,0,0],v=Tp.getUnpackVector(l);let A=Math.floor((s+v[3])/v[2]);return p[2]=A%256,A=Math.floor(A/256),p[1]=A%256,A=Math.floor(A/256),p[0]=A,p}getPixels(){return new Er({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,l,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=l*this.dim,A=l*this.dim+this.dim,F=p*this.dim,N=p*this.dim+this.dim;switch(l){case-1:v=A-1;break;case 1:A=v+1}switch(p){case-1:F=N-1;break;case 1:N=F+1}const U=-l*this.dim,H=-p*this.dim;for(let K=F;K<N;K++)for(let et=v;et<A;et++){const ot=4*this._idx(et,K),ft=4*this._idx(et+U,K+H);this.pixels[ot+0]=s.pixels[ft+0],this.pixels[ot+1]=s.pixels[ft+1],this.pixels[ot+2]=s.pixels[ft+2],this.pixels[ot+3]=s.pixels[ft+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Hi(Tp,"DEMData"),Hi(Cp,"DemMinMaxQuadTree",{omit:["dem"]});class X_{constructor(s,l){this.max=s,this.onRemove=l,this.reset()}reset(){for(const s in this.data)for(const l of this.data[s])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(s,l,p){const v=s.wrapped().key;void 0===this.data[v]&&(this.data[v]=[]);const A={value:l,timeout:void 0};if(void 0!==p&&(A.timeout=setTimeout(()=>{this.remove(s,A)},p)),this.data[v].push(A),this.order.push(v),this.order.length>this.max){const F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const l=this.data[s].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),l.value}getByKey(s){const l=this.data[s];return l?l[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,l){if(!this.has(s))return this;const p=s.wrapped().key,v=void 0===l?0:this.data[p].indexOf(l),A=this.data[p][v];return this.data[p].splice(v,1),A.timeout&&clearTimeout(A.timeout),0===this.data[p].length&&delete this.data[p],this.onRemove(A.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(s){const l=[];for(const p in this.data)for(const v of this.data[p])s(v.value)||l.push(v);for(const p of l)this.remove(p.value.tileID,p)}}class rc{constructor(s,l,p){this.func=s,this.mask=l,this.range=p}}rc.ReadOnly=!1,rc.ReadWrite=!0,rc.disabled=new rc(519,rc.ReadOnly,[0,1]);class iu{constructor(s,l,p,v,A,F){this.test=s,this.ref=l,this.mask=p,this.fail=v,this.depthFail=A,this.pass=F}}iu.disabled=new iu({func:519,mask:0},0,0,7680,7680,7680);class Pa{constructor(s,l,p){this.blendFunction=s,this.blendColor=l,this.mask=p}}Pa.Replace=[1,0],Pa.disabled=new Pa(Pa.Replace,ji.transparent,[!1,!1,!1,!1]),Pa.unblended=new Pa(Pa.Replace,ji.transparent,[!0,!0,!0,!0]),Pa.alphaBlended=new Pa([1,771],ji.transparent,[!0,!0,!0,!0]);class Ga{constructor(s,l,p){this.enable=s,this.mode=l,this.frontFace=p}}Ga.disabled=new Ga(!1,1029,2305),Ga.backCCW=new Ga(!0,1029,2305),Ga.backCW=new Ga(!0,1029,2304),Ga.frontCW=new Ga(!0,1028,2304),Ga.frontCCW=new Ga(!0,1028,2305);class ac extends R{constructor(s,l,p){super(),this.id=s,this._onlySymbols=p,l.on("data",v=>{"source"===v.dataType&&"metadata"===v.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===v.dataType&&"content"===v.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new X_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new qb,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(s){this.map=s,this._minTileCacheSize=void 0===this._minTileCacheSize&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const l=this._tiles[s];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,l){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,l)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(s),p.prepare(this.map.style.imageManager)}}getIds(){return fn(this._tiles).map(s=>s.tileID).sort(j_).map(s=>s.key)}getRenderableIds(s){const l=[];for(const p in this._tiles)this._isIdRenderable(+p,s)&&l.push(this._tiles[p]);return s?l.sort((p,v)=>{const A=p.tileID,F=v.tileID,N=new xi(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),U=new xi(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-F.overscaledZ||U.y-N.y||U.x-N.x}).map(p=>p.tileID.key):l.map(p=>p.tileID).sort(j_).map(p=>p.key)}hasRenderableParent(s){const l=this.findLoadedParent(s,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(s,l){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(l||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(+s,"reloading")}}_reloadTile(s,l){const p=this._tiles[s];p&&("loading"!==p.state&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,s,l)))}_tileLoaded(s,l,p,v){if(v)if(s.state="errored",404!==v.status)this._source.fire(new C(v,{tile:s}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=c.now(),"expired"===p&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(l,s),"raster-dem"===this._source.type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new k("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const l=this.getRenderableIds();for(let v=0;v<l.length;v++){const A=l[v];if(s.neighboringTiles&&s.neighboringTiles[A]){const F=this.getTileByID(A);p(s,F),p(F,s)}}function p(v,A){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let F=A.tileID.canonical.x-v.tileID.canonical.x;const N=A.tileID.canonical.y-v.tileID.canonical.y,U=Math.pow(2,v.tileID.canonical.z),H=A.tileID.key;0===F&&0===N||Math.abs(N)>1||(Math.abs(F)>1&&(1===Math.abs(F+U)?F+=U:1===Math.abs(F-U)&&(F-=U)),A.dem&&v.dem&&(v.dem.backfillBorder(A.dem,F,N),v.neighboringTiles&&v.neighboringTiles[H]&&(v.neighboringTiles[H].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,l,p,v){for(const A in this._tiles){let F=this._tiles[A];if(v[A]||!F.hasData()||F.tileID.overscaledZ<=l||F.tileID.overscaledZ>p)continue;let N=F.tileID;for(;F&&F.tileID.overscaledZ>l+1;){const H=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[H.key],F&&F.hasData()&&(N=H)}let U=N;for(;U.overscaledZ>l;)if(U=U.scaledTo(U.overscaledZ-1),s[U.key]){v[N.key]=N;break}}}findLoadedParent(s,l){if(s.key in this._loadedParentTiles){const p=this._loadedParentTiles[s.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=s.overscaledZ-1;p>=l;p--){const v=s.scaledTo(p),A=this._getLoadedTile(v);if(A)return A}}_getLoadedTile(s){const l=this._tiles[s.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,l){l=l||this._source.tileSize;const p=Math.ceil(s.width/l)+1,v=Math.ceil(s.height/l)+1,A=Math.floor(p*v*5),F="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,A):A,N="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,F):F;this._cache.setMaxSize(N)}handleWrapJump(s){const l=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,l){const p={};for(const v in this._tiles){const A=this._tiles[v];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+l),p[A.tileID.key]=A}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(s,l,p){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let v;this.updateCacheSize(s,l),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(N=>new vr(N.canonical.z,N.wrap,N.canonical.z,N.canonical.x,N.canonical.y)):(v=s.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(v=v.filter(N=>this._source.hasTile(N)))):v=[];const A=this._updateRetainedTiles(v);if(U_(this._source.type)&&0!==v.length){const N={},U={},H=Object.keys(A);for(const et of H){const ot=A[et],ft=this._tiles[et];if(!ft||ft.fadeEndTime&&ft.fadeEndTime<=c.now())continue;const _t=this.findLoadedParent(ot,Math.max(ot.overscaledZ-ac.maxOverzooming,this._source.minzoom));_t&&(this._addTile(_t.tileID),N[_t.tileID.key]=_t.tileID),U[et]=ot}const K=v[v.length-1].overscaledZ;for(const et in this._tiles){const ot=this._tiles[et];if(A[et]||!ot.hasData())continue;let ft=ot.tileID;for(;ft.overscaledZ>K;){ft=ft.scaledTo(ft.overscaledZ-1);const _t=this._tiles[ft.key];if(_t&&_t.hasData()&&U[ft.key]){A[et]=ot.tileID;break}}}for(const et in N)A[et]||(this._coveredTiles[et]=!0,A[et]=N[et])}for(const N in A)this._tiles[N].clearFadeHold();const F=function(N,U){const H=[];for(const K in N)K in U||H.push(K);return H}(this._tiles,A);for(const N of F){const U=this._tiles[N];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(+N)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const l={};if(0===s.length)return l;const p={},v=s.reduce((H,K)=>Math.min(H,K.overscaledZ),1/0),A=s[0].overscaledZ,F=Math.max(A-ac.maxOverzooming,this._source.minzoom),N=Math.max(A+ac.maxUnderzooming,this._source.minzoom),U={};for(const H of s){const K=this._addTile(H);l[H.key]=H,K.hasData()||v<this._source.maxzoom&&(U[H.key]=H)}this._retainLoadedChildren(U,v,N,l);for(const H of s){let K=this._tiles[H.key];if(K.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const ot=H.children(this._source.maxzoom)[0],ft=this.getTile(ot);if(ft&&ft.hasData()){l[ot.key]=ot;continue}}else{const ot=H.children(this._source.maxzoom);if(l[ot[0].key]&&l[ot[1].key]&&l[ot[2].key]&&l[ot[3].key])continue}let et=K.wasRequested();for(let ot=H.overscaledZ-1;ot>=F;--ot){const ft=H.scaledTo(ot);if(p[ft.key]||(p[ft.key]=!0,K=this.getTile(ft),!K&&et&&(K=this._addTile(ft)),K&&(l[ft.key]=ft,et=K.wasRequested(),K.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const l=[];let p,v=this._tiles[s].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){p=this._loadedParentTiles[v.key];break}l.push(v.key);const A=v.scaledTo(v.overscaledZ-1);if(p=this._getLoadedTile(A),p)break;v=A}for(const A of l)this._loadedParentTiles[A]=p}}_addTile(s){let l=this._tiles[s.key];if(l)return l;l=this._cache.getAndRemove(s),l&&(this._setTileReloadTimer(s.key,l),l.tileID=s,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,l)));const p=Boolean(l);if(!p){const v=this.map?this.map.painter:null;l=new nx(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,v,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,s.key,l.state))}return l?(l.uses++,this._tiles[s.key]=l,p||this._source.fire(new k("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(s,l){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const p=l.getExpiryTimeout();p&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},p))}_removeTile(s){const l=this._tiles[s];l&&(l.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,l,p){const v=[],A=this.transform;if(!A)return v;const F="globe"===A.projection.name,N=Pl(A.center.lng);for(const U in this._tiles){const H=this._tiles[U];if(p&&H.clearQueryDebugViz(),H.holdingForFade())continue;let K;if(F){const et=H.tileID.canonical;if(0===et.z){const ot=[Math.abs(Wi(N,...dh(et,-1))-N),Math.abs(Wi(N,...dh(et,1))-N)];K=[0,2*ot.indexOf(Math.min(...ot))-1]}else{const ot=[Math.abs(Wi(N,...dh(et,-1))-N),Math.abs(Wi(N,...dh(et,0))-N),Math.abs(Wi(N,...dh(et,1))-N)];K=[ot.indexOf(Math.min(...ot))-1]}}else K=[0];for(const et of K){const ot=s.containsTile(H,A,l,et);ot&&v.push(ot)}}return v}getVisibleCoordinates(s){const l=this.getRenderableIds(s).map(p=>this._tiles[p].tileID);for(const p of l)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(U_(this._source.type))for(const s in this._tiles){const l=this._tiles[s];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=c.now())return!0}return!1}setFeatureState(s,l,p){this._state.updateState(s=s||"_geojsonTileLayer",l,p)}removeFeatureState(s,l,p){this._state.removeFeatureState(s=s||"_geojsonTileLayer",l,p)}getFeatureState(s,l){return this._state.getState(s=s||"_geojsonTileLayer",l)}setDependencies(s,l,p){const v=this._tiles[s];v&&v.setDependencies(l,p)}reloadTilesForDependencies(s,l){for(const p in this._tiles)this._tiles[p].hasDependency(s,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(s,l))}_preloadTiles(s,l){const p=new Map,v=Array.isArray(s)?s:[s],A=this.map.painter.terrain,F=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const N of v){const U=N.coveringTiles({tileSize:F,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const H of U)p.set(H.key,H);this.usedForTerrain&&N.updateElevation(!1)}Us(Array.from(p.values()),(N,U)=>{const H=new nx(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(H,K=>{"raster-dem"===this._source.type&&H.dem&&this._backfillDEM(H),U(K,H)})},l)}}function j_(r,s){const l=Math.abs(2*r.wrap)-+(r.wrap<0),p=Math.abs(2*s.wrap)-+(s.wrap<0);return r.overscaledZ-s.overscaledZ||p-l||s.canonical.y-r.canonical.y||s.canonical.x-r.canonical.x}function U_(r){return"raster"===r||"image"===r||"video"===r||"custom"===r}function dh(r,s){const l=1<<r.z;return[r.x/l+s,(r.x+1)/l+s]}ac.maxOverzooming=10,ac.maxUnderzooming=3;class df{constructor(s,l,p){this._demTile=s,this._dem=this._demTile.dem,this._scale=l,this._offset=p}static create(s,l,p){const v=p||s.findDEMTileFor(l);if(!v||!v.dem)return;const A=v.dem,F=v.tileID,N=1<<l.canonical.z-F.canonical.z;return new df(v,v.tileSize/_n/N,[(l.canonical.x/N-F.canonical.x)*A.dim,(l.canonical.y/N-F.canonical.y)*A.dim])}tileCoordToPixel(s,l){const p=l*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),A=Math.floor(p);return new xi(v,A)}getElevationAt(s,l,p,v){const A=s*this._scale+this._offset[0],F=l*this._scale+this._offset[1],N=Math.floor(A),U=Math.floor(F),H=this._dem;return v=!!v,p?rs(rs(H.get(N,U,v),H.get(N,U+1,v),F-U),rs(H.get(N+1,U,v),H.get(N+1,U+1,v),F-U),A-N):H.get(N,U,v)}getElevationAtPixel(s,l,p){return this._dem.get(s,l,!!p)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Ca(1,s)*this._dem.stride}}class n1{constructor(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Cl(_n,16,0),this.featureIndexArray=new fy,this.promoteId=l}insert(s,l,p,v,A,F=0){const N=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,A,F);const U=this.grid;for(let H=0;H<l.length;H++){const K=l[H],et=[1/0,1/0,-1/0,-1/0];for(let ot=0;ot<K.length;ot++){const ft=K[ot];et[0]=Math.min(et[0],ft.x),et[1]=Math.min(et[1],ft.y),et[2]=Math.max(et[2],ft.x),et[3]=Math.max(et[3],ft.y)}et[0]<_n&&et[1]<_n&&et[2]>=0&&et[3]>=0&&U.insert(N,et[0],et[1],et[2],et[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new lp(new pp(this.rawTileData)).layers,this.sourceLayerCoder=new lf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,l,p,v){this.loadVTLayers();const A=s.params||{},F=Fu(A.filter),N=s.tileResult,U=s.transform,H=N.bufferedTilespaceBounds,K=this.grid.query(H.min.x,H.min.y,H.max.x,H.max.y,(_t,St,Lt,Zt)=>mg(N.bufferedTilespaceGeometry,_t,St,Lt,Zt));K.sort(s1);let et=null;U.elevation&&K.length>0&&(et=df.create(U.elevation,this.tileID));const ot={};let ft;for(let _t=0;_t<K.length;_t++){const St=K[_t];if(St===ft)continue;ft=St;const Lt=this.featureIndexArray.get(St);let Zt=null;this.loadMatchingFeature(ot,Lt,F,A.layers,A.availableImages,l,p,v,(he,Ut,ae,de=0)=>(Zt||(Zt=ll(he,this.tileID.canonical,s.tileTransform)),Ut.queryIntersectsFeature(N,he,ae,Zt,this.z,s.transform,s.pixelPosMatrix,et,de)))}return ot}loadMatchingFeature(s,l,p,v,A,F,N,U,H){const{featureIndex:K,bucketIndex:et,sourceLayerIndex:ot,layoutVertexArrayOffset:ft}=l,_t=this.bucketLayerIDs[et];if(v&&!function(he,Ut){for(let ae=0;ae<he.length;ae++)if(Ut.indexOf(he[ae])>=0)return!0;return!1}(v,_t))return;const St=this.sourceLayerCoder.decode(ot),Lt=this.vtLayers[St].feature(K);if(p.needGeometry){const he=$h(Lt,!0);if(!p.filter(new be(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!p.filter(new be(this.tileID.overscaledZ),Lt))return;const Zt=this.getId(Lt,St);for(let he=0;he<_t.length;he++){const Ut=_t[he];if(v&&v.indexOf(Ut)<0)continue;const ae=F[Ut];if(!ae)continue;let de={};void 0!==Zt&&U&&(de=U.getState(ae.sourceLayer||"_geojsonTileLayer",Zt));const ce=ln({},N[Ut]);ce.paint=Y_(ce.paint,ae.paint,Lt,de,A),ce.layout=Y_(ce.layout,ae.layout,Lt,de,A);const Ce=!H||H(Lt,ae,de,ft);if(!Ce)continue;const ke=new B_(Lt,this.z,this.x,this.y,Zt);ke.layer=ce;let je=s[Ut];void 0===je&&(je=s[Ut]=[]),je.push({featureIndex:K,feature:ke,intersectionZ:Ce})}}lookupSymbolFeatures(s,l,p,v,A,F,N,U){const H={};this.loadVTLayers();const K=Fu(A);for(const et of s)this.loadMatchingFeature(H,{bucketIndex:p,sourceLayerIndex:v,featureIndex:et,layoutVertexArrayOffset:0},K,F,N,U,l);return H}loadFeature(s){const{featureIndex:l,sourceLayerIndex:p}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(p),A=this.vtFeatures[v];if(A[l])return A[l];const F=this.vtLayers[v].feature(l);return A[l]=F,F}hasLayer(s){for(const l of this.bucketLayerIDs)for(const p of l)if(s===p)return!0;return!1}getId(s,l){let p=s.id;if(this.promoteId){const v="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=v&&(p=s.properties[v]),"boolean"==typeof p&&(p=Number(p))}return p}}function Y_(r,s,l,p,v){return at(r,(A,F)=>{const N=s instanceof Fe?s.get(F):null;return N&&N.evaluate?N.evaluate(l,p,v):N})}function s1(r,s){return s-r}Hi(n1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class H_{constructor(s,l){this.width=s,this.height=l,this.nextRow=0,this.image=new El({width:s,height:l}),this.positions={},this.uploaded=!1}getDash(s,l){const p=this.getKey(s,l);return this.positions[p]}trim(){const s=this.width,l=this.height=Mn(this.nextRow);this.image.resize({width:s,height:l})}getKey(s,l){return s.join(",")+l}getDashRanges(s,l,p){const v=[];let A=s.length%2==1?-s[s.length-1]*p:0,F=s[0]*p,N=!0;v.push({left:A,right:F,isDash:N,zeroLength:0===s[0]});let U=s[0];for(let H=1;H<s.length;H++){N=!N;const K=s[H];A=U*p,U+=K,F=U*p,v.push({left:A,right:F,isDash:N,zeroLength:0===K})}return v}addRoundDash(s,l,p){const v=l/2;for(let A=-p;A<=p;A++){const F=this.width*(this.nextRow+p+A);let N=0,U=s[N];for(let H=0;H<this.width;H++){H/U.right>1&&(U=s[++N]);const K=Math.abs(H-U.left),et=Math.abs(H-U.right),ot=Math.min(K,et);let ft;const _t=A/p*(v+1);if(U.isDash){const St=v-Math.abs(_t);ft=Math.sqrt(ot*ot+St*St)}else ft=v-Math.sqrt(ot*ot+_t*_t);this.image.data[F+H]=Math.max(0,Math.min(255,ft+128))}}}addRegularDash(s,l){for(let U=s.length-1;U>=0;--U){const H=s[U],K=s[U+1];H.zeroLength?s.splice(U,1):K&&K.isDash===H.isDash&&(K.left=H.left,s.splice(U,1))}const p=s[0],v=s[s.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const A=this.width*this.nextRow;let F=0,N=s[F];for(let U=0;U<this.width;U++){U/N.right>1&&(N=s[++F]);const H=Math.abs(U-N.left),K=Math.abs(U-N.right),et=Math.min(H,K);this.image.data[A+U]=Math.max(0,Math.min(255,(N.isDash?et:-et)+l+128))}}addDash(s,l){const p=this.getKey(s,l);if(this.positions[p])return this.positions[p];const v="round"===l,A=v?7:0,F=2*A+1;if(this.nextRow+F>this.height)return Xt("LineAtlas out of space"),null;0===s.length&&s.push(1);let N=0;for(let K=0;K<s.length;K++)s[K]<0&&(Xt("Negative value is found in line dasharray, replacing values with 0"),s[K]=0),N+=s[K];if(0!==N){const K=this.width/N,et=this.getDashRanges(s,this.width,K);v?this.addRoundDash(et,K,A):this.addRegularDash(et,"square"===l?.5*K:0)}const U=this.nextRow+A;this.nextRow+=F;const H={tl:[U,A],br:[N,0]};return this.positions[p]=H,H}}Hi(H_,"LineAtlas");class $_{constructor(s){const l={},p=[];for(const N in s){const U=s[N],H=l[N]={};for(const K in U.glyphs){const et=U.glyphs[+K];if(!et||0===et.bitmap.width||0===et.bitmap.height)continue;const ot=et.metrics.localGlyph?2:1,ft={x:0,y:0,w:et.bitmap.width+2*ot,h:et.bitmap.height+2*ot};p.push(ft),H[K]=ft}}const{w:v,h:A}=Um(p),F=new El({width:v||1,height:A||1});for(const N in s){const U=s[N];for(const H in U.glyphs){const K=U.glyphs[+H];if(!K||0===K.bitmap.width||0===K.bitmap.height)continue;const et=l[N][H],ot=K.metrics.localGlyph?2:1;El.copy(K.bitmap,F,{x:0,y:0},{x:et.x+ot,y:et.y+ot},K.bitmap)}}this.image=F,this.positions=l}}Hi($_,"GlyphAtlas");class o1{constructor(s){this.tileID=new vr(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=nc(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,l,p,v,A){this.status="parsing",this.data=s,this.collisionBoxArray=new oh;const F=new lf(Object.keys(s.layers).sort()),N=new n1(this.tileID,this.promoteId);N.bucketLayerIDs=[];const U={},H=new H_(256,256),K={featureIndex:N,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:H,availableImages:p},et=l.familiesBySource[this.source];for(const de in et){const ce=s.layers[de];if(!ce)continue;let Ce=!1,ke=!1;for(const Ae of et[de])"symbol"===Ae[0].type?Ce=!0:ke=!0;if(!0===this.isSymbolTile&&!Ce||!1===this.isSymbolTile&&!ke)continue;1===ce.version&&Xt(`Vector tile source "${this.source}" layer "${de}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const je=F.encode(de),si=[];for(let Ae=0;Ae<ce.length;Ae++){const Ye=ce.feature(Ae),Ge=N.getId(Ye,de);si.push({feature:Ye,id:Ge,index:Ae,sourceLayerIndex:je})}for(const Ae of et[de]){const Ye=Ae[0];void 0!==this.isSymbolTile&&"symbol"===Ye.type!==this.isSymbolTile||Ye.minzoom&&this.zoom<Math.floor(Ye.minzoom)||Ye.maxzoom&&this.zoom>=Ye.maxzoom||"none"!==Ye.visibility&&(ox(Ae,this.zoom,p),(U[Ye.id]=Ye.createBucket({index:N.bucketLayerIDs.length,layers:Ae,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:je,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(si,K,this.tileID.canonical,this.tileTransform),N.bucketLayerIDs.push(Ae.map(Ge=>Ge.id)))}}let ot,ft,_t,St;H.trim();const Lt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Zt=at(K.glyphDependencies,de=>Object.keys(de).map(Number));Object.keys(Zt).length?v.send("getGlyphs",{uid:this.uid,stacks:Zt},(de,ce)=>{ot||(ot=de,ft=ce,ae.call(this))},void 0,!1,Lt):ft={};const he=Object.keys(K.iconDependencies);he.length?v.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(de,ce)=>{ot||(ot=de,_t=ce,ae.call(this))},void 0,!1,Lt):_t={};const Ut=Object.keys(K.patternDependencies);function ae(){if(ot)return A(ot);if(ft&&_t&&St){const de=new $_(ft),ce=new Rg(_t,St);for(const Ce in U){const ke=U[Ce];ke instanceof sc?(ox(ke.layers,this.zoom,p),Xb(ke,ft,de.positions,_t,ce.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):ke.hasPattern&&(ke instanceof Hd||ke instanceof Mg||ke instanceof Rm)&&(ox(ke.layers,this.zoom,p),ke.addFeatures(K,this.tileID.canonical,ce.patternPositions,p,this.tileTransform))}this.status="done",A(null,{buckets:fn(U).filter(Ce=>!Ce.isEmpty()),featureIndex:N,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:de.image,lineAtlas:H,imageAtlas:ce,glyphMap:this.returnDependencies?ft:null,iconMap:this.returnDependencies?_t:null,glyphPositions:this.returnDependencies?de.positions:null})}}Ut.length?v.send("getImages",{icons:Ut,source:this.source,tileID:this.tileID,type:"patterns"},(de,ce)=>{ot||(ot=de,St=ce,ae.call(this))},void 0,!1,Lt):St={},ae.call(this)}}function ox(r,s,l){const p=new be(s);for(const v of r)v.recalculate(p,l)}class G_{constructor(s){this.entries={},this.scheduler=s}request(s,l,p,v){const A=this.entries[s]=this.entries[s]||{callbacks:[]};if(A.result){const[F,N]=A.result;return this.scheduler?this.scheduler.add(()=>{v(F,N)},l):v(F,N),()=>{}}return A.callbacks.push(v),A.cancel||(A.cancel=p((F,N)=>{A.result=[F,N];for(const U of A.callbacks)this.scheduler?this.scheduler.add(()=>{U(F,N)},l):U(F,N);setTimeout(()=>delete this.entries[s],3e3)})),()=>{A.result||(A.callbacks=A.callbacks.filter(F=>F!==v),A.callbacks.length||(A.cancel(),delete this.entries[s]))}}}function rx(r,s,l){const p=JSON.stringify(r.request);return r.data&&(this.deduped.entries[p]={result:[null,r.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},v=>{const A=Gn(r.request,(F,N,U,H)=>{F?v(F):N&&v(null,{vectorTile:l?void 0:new lp(new pp(N)),rawData:N,cacheControl:U,expires:H})});return()=>{A.cancel(),v()}},s)}b.ARRAY_TYPE=aa,b.AUTH_ERR_MSG=is,b.Aabb=Pr,b.Actor=class{constructor(r,s,l){this.target=r,this.parent=s,this.mapId=l,this.callbacks={},this.cancelCallbacks={},Ls(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ke()?r:De,this.scheduler=new Jb}send(r,s,l,p,v=!1,A){const F=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=A,this.callbacks[F]=l);const N=hi(this.globalScope)?void 0:[];return this.target.postMessage({id:F,type:r,hasCallback:!!l,targetMapId:p,mustQueue:v,sourceMapId:this.mapId,data:Bc(s,N)},N),{cancel:()=>{l&&delete this.callbacks[F],this.target.postMessage({id:F,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(r){const s=r.data,l=s.id;if(l&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){const p=this.cancelCallbacks[l];delete this.cancelCallbacks[l],p&&p.cancel()}else if(s.mustQueue||Ke()){const p=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,s),p&&p.metadata||{type:"message"})}else this.processTask(l,s)}processTask(r,s){if("<response>"===s.type){const l=this.callbacks[r];delete this.callbacks[r],l&&(s.error?l(Rh(s.error)):l(null,Rh(s.data)))}else{const l=hi(this.globalScope)?void 0:[],p=s.hasCallback?(A,F)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:A?Bc(A):null,data:Bc(F,l)},l)}:A=>{},v=Rh(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,v,p);else if(this.parent.getWorkerSource){const A=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,A[0],v.source)[A[1]](v,p)}else p(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},b.CanonicalTileID=Ud,b.Color=ji,b.ColorMode=Pa,b.CullFaceMode=Ga,b.DEMData=Tp,b.DataConstantProperty=we,b.DedupedRequest=G_,b.DepthMode=rc,b.EXTENT=_n,b.Elevation=class{isDataAvailableAtPoint(r){const s=this._source();if(this.isUsingMockSource()||!s||r.y<0||r.y>1)return!1;const l=s.getSource().maxzoom,p=1<<l,v=Math.floor(r.x),A=Math.floor((r.x-v)*p),F=Math.floor(r.y*p),N=this.findDEMTileFor(new vr(l,v,l,A,F));return!(!N||!N.dem)}getAtPointOrZero(r,s=0){return this.getAtPoint(r,s)||0}getAtPoint(r,s,l=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const p=this._source();if(!p||r.y<0||r.y>1)return s;const v=p.getSource().maxzoom,A=1<<v,F=Math.floor(r.x),N=r.x-F,U=new vr(v,F,v,Math.floor(N*A),Math.floor(r.y*A)),H=this.findDEMTileFor(U);if(!H||!H.dem)return s;const K=H.dem,et=1<<H.tileID.canonical.z,ot=(N*et-H.tileID.canonical.x)*K.dim,ft=(r.y*et-H.tileID.canonical.y)*K.dim,_t=Math.floor(ot),St=Math.floor(ft);return(l?this.exaggeration():1)*rs(rs(K.get(_t,St),K.get(_t,St+1),ft-St),rs(K.get(_t+1,St),K.get(_t+1,St+1),ft-St),ot-_t)}getAtTileOffset(r,s,l){const p=1<<r.canonical.z;return this.getAtPointOrZero(new Hh(r.wrap+(r.canonical.x+s/_n)/p,(r.canonical.y+l/_n)/p))}getAtTileOffsetFunc(r,s,l,p){return v=>{const A=this.getAtTileOffset(r,v.x,v.y),F=p.upVector(r.canonical,v.x,v.y);return Ma(F,F,A*p.upVectorScale(r.canonical,s,l).metersToTile),F}}getForTilePoints(r,s,l,p){if(this.isUsingMockSource())return!1;const v=df.create(this,r,p);return!!v&&(s.forEach(A=>{A[2]=this.exaggeration()*v.getElevationAt(A[0],A[1],l)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(r);if(!s||!s.dem)return null;const l=s.dem.tree,p=s.tileID,v=1<<r.canonical.z-p.canonical.z;let A=r.canonical.x/v-p.canonical.x,F=r.canonical.y/v-p.canonical.y,N=0;for(let U=0;U<r.canonical.z-p.canonical.z&&!l.leaves[N];U++){A*=2,F*=2;const H=2*Math.floor(F)+Math.floor(A);N=l.childOffsets[N]+H,A%=1,F%=1}return{min:this.exaggeration()*l.minimums[N],max:this.exaggeration()*l.maximums[N]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,s,l){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},b.ErrorEvent=C,b.EvaluationParameters=be,b.Event=k,b.Evented=R,b.FillExtrusionBucket=Rm,b.Frustum=Ku,b.FrustumCorners=ym,b.GLOBE_RADIUS=al,b.GLOBE_SCALE_MATCH_LATITUDE=45,b.GLOBE_ZOOM_THRESHOLD_MAX=6,b.GLOBE_ZOOM_THRESHOLD_MIN=5,b.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_fillGridMeshWithLods(r,s){const l=new sn,p=new ir,v=[],A=r+1+2,F=s[0]+1,N=s[0]+1+(1+s.length),U=(H,K,et)=>{let ot=H===A-1?H-2:0===H?H:H-1;return ot+=et?24575:0,[ot,K]};for(let H=0;H<A;++H)l.emplaceBack(...U(H,0,!0));for(let H=0;H<F;++H)for(let K=0;K<A;++K)l.emplaceBack(...U(K,H,(0===K||K===A-1)&&!0));for(let H=0;H<s.length;++H){const K=s[H];for(let et=0;et<A;++et)l.emplaceBack(...U(et,K,!0))}for(let H=0;H<s.length;++H){const K=p.length,et=s[H]+1+2,ot=new ir;for(let St=0;St<et-1;St++){const Lt=St===et-2,Zt=Lt?A*(N-s.length+H-St):A;for(let he=0;he<A-1;he++){const Ut=St*A+he;0===St||Lt||0===he||he===A-2?(ot.emplaceBack(Ut+1,Ut,Ut+Zt),ot.emplaceBack(Ut+Zt,Ut+Zt+1,Ut+1)):(p.emplaceBack(Ut+1,Ut,Ut+Zt),p.emplaceBack(Ut+Zt,Ut+Zt+1,Ut+1))}}const ft=Vo.simpleSegment(0,K,l.length,p.length-K);for(let St=0;St<ot.uint16.length;St+=3)p.emplaceBack(ot.uint16[St],ot.uint16[St+1],ot.uint16[St+2]);const _t=Vo.simpleSegment(0,K,l.length,p.length-K);v.push({withoutSkirts:ft,withSkirts:_t})}return{vertices:l,indices:p,segments:v}}_createGrid(r){const s=this._fillGridMeshWithLods(64,_r);this._gridSegments=s.segments,this._gridBuffer=r.createVertexBuffer(s.vertices,xm.members),this._gridIndexBuffer=r.createIndexBuffer(s.indices,!0)}_createPoles(r){const s=new ir;for(let v=0;v<=64;v++)s.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=r.createIndexBuffer(s,!0);const l=new Jr,p=new Jr;this._poleSegments=[];for(let v=0,A=0;v<5;v++){const F=360/(1<<v);l.emplaceBack(0,-al,0,.5,0),p.emplaceBack(0,-al,0,.5,1);for(let N=0;N<=64;N++){const U=N/64,H=rs(0,F,U),[K,et,ot]=Yh(ob,ag,H,al);l.emplaceBack(K,et,ot,U,0),p.emplaceBack(K,et,ot,U,1)}this._poleSegments.push(Vo.simpleSegment(A,0,66,64)),A+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(l,eb,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(p,eb,!1)}getGridBuffers(r,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,s){if(!this._wireframeSegments){const l=new nl,p=64,v=p+1+2,A=1;this._wireframeSegments=[];for(let F=0,N=0;F<_r.length;F++){const U=_r[F];for(let K=A;K<U+A;K++)for(let et=A;et<p+A;et++){const ot=K*v+et;l.emplaceBack(ot,ot+1),l.emplaceBack(ot,ot+v),l.emplaceBack(ot,ot+v+1)}const H=U*p*3;this._wireframeSegments.push(Vo.simpleSegment(0,N,(U+1)*v,H)),N+=H}this._wireframeIndexBuffer=r.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},b.GlyphManager=Kd,b.ImagePosition=Og,b.LivePerformanceUtils=I,b.LngLat=ns,b.LngLatBounds=Xh,b.LocalGlyphMode=Aa,b.MAX_MERCATOR_LATITUDE=sr,b.MercatorCoordinate=Hh,b.ONE_EM=or,b.OverscaledTileID=vr,b.PerformanceMarkers=u,b.Properties=ci,b.RGBAImage=Er,b.Ray=sg,b.RequestManager=class{constructor(r,s,l){this._transformRequestFn=r,this._customAccessToken=s,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const r=function(){let s="";for(let l=0;l<10;l++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tn,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}}normalizeStyleURL(r,s){if(!Vs(r))return r;const l=mi(r);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeGlyphsURL(r,s){if(!Vs(r))return r;const l=mi(r);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||s)}normalizeSourceURL(r,s,l,p){if(!Vs(r))return r;const v=mi(r);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),l&&v.params.push(`language=${l}`),p&&v.params.push(`worldview=${p}`),this._makeAPIURL(v,this._customAccessToken||s)}normalizeSpriteURL(r,s,l,p){const v=mi(r);return Vs(r)?(v.path=`/styles/v1${v.path}/sprite${s}${l}`,this._makeAPIURL(v,this._customAccessToken||p)):(v.path+=`${s}${l}`,Q(v))}normalizeTileURL(r,s,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Vs(r))return r;const p=mi(r);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||l&&"raster"!==p.authority&&512===l?"@2x":""}${bi.supported?".webp":"$1"}`),"raster"===p.authority?p.path=`/${pn.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${pn.TILE_URL_VERSION}${p.path}`);const v=this._customAccessToken||function(A){for(const F of A){const N=F.match(/^access_token=(.*)$/);if(N)return N[1]}return null}(p.params)||pn.ACCESS_TOKEN;return pn.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,v)}canonicalizeTileURL(r,s){const l=mi(r);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return r;let p="mapbox://";l.path.match(/^\/raster\/v1\//)?p+=`raster/${l.path.replace(`/${pn.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${l.path.replace(`/${pn.TILE_URL_VERSION}/`,"")}`;let v=l.params;return s&&(v=v.filter(A=>!A.match(/^access_token=/))),v.length&&(p+=`?${v.join("&")}`),p}canonicalizeTileset(r,s){const l=!!s&&Vs(s),p=[];for(const v of r.tiles||[])ut(v)?p.push(this.canonicalizeTileURL(v,l)):p.push(v);return p}_makeAPIURL(r,s){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=mi(pn.API_URL);if(r.protocol=p.protocol,r.authority=p.authority,"http"===r.protocol){const v=r.params.indexOf("secure");v>=0&&r.params.splice(v,1)}if("/"!==p.path&&(r.path=`${p.path}${r.path}`),!pn.REQUIRE_ACCESS_TOKEN)return Q(r);if(s=s||pn.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return r.params=r.params.filter(v=>-1===v.indexOf("access_token")),r.params.push(`access_token=${s||""}`),Q(r)}},b.ResourceType=Ps,b.SegmentVector=Vo,b.SourceCache=ac,b.StencilMode=iu,b.StructArrayLayout1ui2=sl,b.StructArrayLayout2f1f2i16=yr,b.StructArrayLayout2i4=sn,b.StructArrayLayout2ui4=nl,b.StructArrayLayout3f12=Ho,b.StructArrayLayout3ui6=ir,b.StructArrayLayout4i8=vs,b.StructArrayLayout5f20=Jr,b.Texture=eu,b.Tile=nx,b.Transitionable=yi,b.Uniform1f=Jf,b.Uniform1i=class extends zh{constructor(r){super(r),this.current=0}set(r,s,l){this.fetchUniformLocation(r,s)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},b.Uniform2f=class extends zh{constructor(r){super(r),this.current=[0,0]}set(r,s,l){this.fetchUniformLocation(r,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},b.Uniform3f=class extends zh{constructor(r){super(r),this.current=[0,0,0]}set(r,s,l){this.fetchUniformLocation(r,s)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},b.Uniform4f=Zv,b.UniformColor=Kv,b.UniformMatrix2f=class extends zh{constructor(r){super(r),this.current=yC}set(r,s,l){if(this.fetchUniformLocation(r,s))for(let p=0;p<4;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},b.UniformMatrix3f=class extends zh{constructor(r){super(r),this.current=Uu}set(r,s,l){if(this.fetchUniformLocation(r,s))for(let p=0;p<9;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},b.UniformMatrix4f=class extends zh{constructor(r){super(r),this.current=xC}set(r,s,l){if(this.fetchUniformLocation(r,s)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let p=1;p<16;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},b.UnwrappedTileID=a_,b.ValidationError=Oi,b.VectorTileFeature=hp,b.VectorTileWorkerSource=class extends R{constructor(r,s,l,p,v){super(),this.actor=r,this.layerIndex=s,this.availableImages=l,this.loadVectorData=v||rx,this.loading={},this.loaded={},this.deduped=new G_(r.scheduler),this.isSpriteLoaded=p,this.scheduler=r.scheduler}loadTile(r,s){const l=r.uid,p=r&&r.request,v=p&&p.collectResourceTiming,A=this.loading[l]=new o1(r);A.abort=this.loadVectorData(r,(F,N)=>{const U=!this.loading[l];if(delete this.loading[l],U||F||!N)return A.status="done",U||(this.loaded[l]=A),s(F);const H=N.rawData,K={};N.expires&&(K.expires=N.expires),N.cacheControl&&(K.cacheControl=N.cacheControl),A.vectorTile=N.vectorTile||new lp(new pp(H));const et=()=>{A.parse(A.vectorTile,this.layerIndex,this.availableImages,this.actor,(ot,ft)=>{if(ot||!ft)return s(ot);const _t={};if(v){const St=w(p);St.length>0&&(_t.resourceTiming=JSON.parse(JSON.stringify(St)))}s(null,ln({rawTileData:H.slice(0)},ft,K,_t))})};this.isSpriteLoaded?et():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(et,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):et()}),this.loaded=this.loaded||{},this.loaded[l]=A})}reloadTile(r,s){const l=this.loaded,p=r.uid,v=this;if(l&&l[p]){const A=l[p];A.showCollisionBoxes=r.showCollisionBoxes,A.enableTerrain=!!r.enableTerrain,A.projection=r.projection,A.tileTransform=nc(r.tileID.canonical,r.projection);const F=(N,U)=>{const H=A.reloadCallback;H&&(delete A.reloadCallback,A.parse(A.vectorTile,v.layerIndex,this.availableImages,v.actor,H)),s(N,U)};"parsing"===A.status?A.reloadCallback=F:"done"===A.status&&(A.vectorTile?A.parse(A.vectorTile,this.layerIndex,this.availableImages,this.actor,F):F())}}abortTile(r,s){const l=r.uid,p=this.loading[l];p&&(p.abort&&p.abort(),delete this.loading[l]),s()}removeTile(r,s){const l=this.loaded,p=r.uid;l&&l[p]&&delete l[p],s()}},b.WritingMode=ka,b.ZoomDependentExpression=ql,b.add=ha,b.addDynamicAttributes=bp,b.adjoint=function(r,s){var l=s[0],p=s[1],v=s[2],A=s[3],F=s[4],N=s[5],U=s[6],H=s[7],K=s[8];return r[0]=F*K-N*H,r[1]=v*H-p*K,r[2]=p*N-v*F,r[3]=N*U-A*K,r[4]=l*K-v*U,r[5]=v*A-l*N,r[6]=A*H-F*U,r[7]=p*U-l*H,r[8]=l*F-p*A,r},b.asyncAll=Us,b.bezier=un,b.bindAll=Ls,b.boundsAttributes=ix,b.bufferConvexPolygon=function(r,s){const l=[];for(let p=0;p<r.length;p++){const v=Ri(p-1,-1,r.length-1),A=Ri(p+1,-1,r.length-1),F=r[p],N=r[A],U=r[v].sub(F).unit(),H=N.sub(F).unit(),K=H.angleWithSep(U.x,U.y),et=U.add(H).unit().mult(-1*s/Math.sin(K/2));l.push(F.add(et))}return l},b.cacheEntryPossiblyAdded=function(r){La++,La>In&&(r.getActor().send("enforceCacheSizeLimit",Hs),La=0)},b.calculateGlobeLabelMatrix=function(r,s){const{x:l,y:p}=r.point,v=ky(l,p,r.worldSize/r._pixelsPerMercatorPixel,0,0);return kl(v,v,bm(Al(s)))},b.calculateGlobeMatrix=function(r){const{x:s,y:l}=r.point,{lng:p,lat:v}=r._center;return ky(s,l,r.worldSize,p,v)},b.calculateGlobeMercatorMatrix=function(r){const s=r.pixelsPerMeter,l=s/Ca(1,r.center.lat),p=rl(new Float64Array(16));return Xc(p,p,[r.point.x,r.point.y,0]),la(p,p,[l,l,s]),Float32Array.from(p)},b.circumferenceAtLatitude=lg,b.clamp=Wi,b.clearTileCache=function(r){if(!Sr())return;const s=De.caches.delete(Pi);r&&s.catch(r).then(()=>r())},b.clipLine=C_,b.clone=function(r){var s=new aa(16);return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},b.clone$1=Yt,b.collisionCircleLayout=Ab,b.config=pn,b.conjugate=function(r,s){return r[0]=-s[0],r[1]=-s[1],r[2]=-s[2],r[3]=s[3],r},b.create=function(){var r=new aa(16);return aa!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},b.create$1=_y,b.createExpression=Fh,b.createLayout=nn,b.createStyleLayer=function(r){return"custom"===r.type?new L_(r):new Zb[r.type](r)},b.cross=ig,b.degToRad=Xi,b.distance=function(r,s){return Math.hypot(s[0]-r[0],s[1]-r[1],s[2]-r[2])},b.div=function(r,s,l){return r[0]=s[0]/l[0],r[1]=s[1]/l[1],r[2]=s[2]/l[2],r},b.dot=Xa,b.earthRadius=Hc,b.ease=js,b.easeCubicInOut=zi,b.ecefToLatLng=function([r,s,l]){const p=Math.hypot(r,s,l),v=Math.atan2(r,l),A=.5*Math.PI-Math.acos(-s/p);return new ns(cn(v),cn(A))},b.emitValidationErrors=Ru,b.endsWith=Ze,b.enforceCacheSizeLimit=function(r){Lr(),Ei&&Ei.then(s=>{s.keys().then(l=>{for(let p=0;p<l.length-r;p++)s.delete(l[p])})})},b.evaluateSizeForFeature=tc,b.evaluateSizeForZoom=$d,b.evaluateVariableOffset=yp,b.evented=ne,b.exactEquals=function(r,s){return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]&&r[3]===s[3]},b.exactEquals$1=function(r,s){return r[0]===s[0]&&r[1]===s[1]&&r[2]===s[2]},b.exported=c,b.exported$1=bi,b.extend=ln,b.extend$1=O,b.fillExtrusionHeightLift=o_,b.filterObject=rt,b.fromMat4=function(r,s){return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[4],r[4]=s[5],r[5]=s[6],r[6]=s[8],r[7]=s[9],r[8]=s[10],r},b.fromQuat=function(r,s){var l=s[0],p=s[1],v=s[2],A=s[3],F=l+l,N=p+p,U=v+v,H=l*F,K=p*F,et=p*N,ot=v*F,ft=v*N,_t=v*U,St=A*F,Lt=A*N,Zt=A*U;return r[0]=1-et-_t,r[1]=K+Zt,r[2]=ot-Lt,r[3]=0,r[4]=K-Zt,r[5]=1-H-_t,r[6]=ft+St,r[7]=0,r[8]=ot+Lt,r[9]=ft-St,r[10]=1-H-et,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},b.fromRotation=function(r,s){var l=Math.sin(s),p=Math.cos(s);return r[0]=p,r[1]=l,r[2]=0,r[3]=-l,r[4]=p,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},b.fromScaling=by,b.furthestTileCorner=function(r){const s=Math.round((r+45+360)%360/90)%4;return $n[s]},b.getAABBPointSquareDist=function(r,s,l){let p=0;for(let v=0;v<2;++v){const A=l?l[v]:0;r[v]>A&&(p+=(r[v]-A)*(r[v]-A)),s[v]<A&&(p+=(A-s[v])*(A-s[v]))}return p},b.getAnchorAlignment=Ng,b.getAnchorJustification=$m,b.getBounds=function(r){let s=1/0,l=1/0,p=-1/0,v=-1/0;for(const A of r)s=Math.min(s,A.x),l=Math.min(l,A.y),p=Math.max(p,A.x),v=Math.max(v,A.y);return{min:new xi(s,l),max:new xi(p,v)}},b.getColumn=Qi,b.getGridMatrix=function(r,s,l,p){const v=s.getNorth(),A=s.getSouth(),F=s.getWest(),N=s.getEast(),U=1<<r.z,H=N-F,K=v-A,et=H/64,ot=-K/_r[l],ft=[0,et,0,ot,0,0,v,F,0];if(r.z>0){const _t=180/p;vy(ft,ft,[_t/H+1,0,0,0,_t/K+1,0,-.5*_t/et,.5*_t/ot,1])}return ft[2]=U,ft[5]=r.x,ft[8]=r.y,ft},b.getImage=Js,b.getJSON=function(r,s){return Es(ln(r,{type:"json"}),s)},b.getLatitudinalLod=function(r){const s=sr-5;r=Wi(r,-s,s)/s*90;const l=Math.pow(Math.abs(Math.sin(Xi(r))),3);return Math.round(l*(_r.length-1))},b.getMapSessionAPI=te,b.getPerformanceMeasurement=w,b.getProjection=tf,b.getRTLTextPluginStatus=me,b.getReferrer=Zo,b.getTilePoint=function(r,{x:s,y:l},p=0){return new xi(((s-p)*r.scale-r.x)*_n,(l*r.scale-r.y)*_n)},b.getTileVec3=function(r,s,l=0){return Fd(((s.x-l)*r.scale-r.x)*_n,(s.y*r.scale-r.y)*_n,Mm(s.z,s.y))},b.getVideo=function(r,s){const l=De.document.createElement("video");l.muted=!0,l.onloadstart=function(){s(null,l)};for(let p=0;p<r.length;p++){const v=De.document.createElement("source");ls(r[p])||(l.crossOrigin="Anonymous"),v.src=r[p],l.appendChild(v)}return{cancel:()=>{}}},b.globeCenterToScreenPoint=function(r){const s=[0,0,0],l=rl(new Float64Array(16));return kl(l,r.pixelMatrix,r.globeMatrix),go(s,s,l),new xi(s[0],s[1])},b.globeDenormalizeECEF=bm,b.globeECEFOrigin=function(r,s){const l=[0,0,0];return go(l,l,qu(Al(s.canonical))),go(l,l,r),l},b.globeMetersToEcef=Ju,b.globeNormalizeECEF=qu,b.globePixelsToTileUnits=function(r,s){return _n/(512*Math.pow(2,r))*Qu(Al(s))},b.globePoleMatrixForTile=function(r,s,l){const p=rl(new Float64Array(16)),v=(s/(1<<r)-.5)*Math.PI*2;return rh(p,l.globeMatrix,v),Float32Array.from(p)},b.globeTileBounds=Al,b.globeTiltAtLngLat=Ay,b.globeToMercatorTransition=Yc,b.globeUseCustomAntiAliasing=function(r,s,l){const p=Yc(l.zoom),v=r.style.map._antialias,A=!!s.extStandardDerivatives,F=s.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return 0===p&&!v&&!F&&A},b.identity=rl,b.identity$1=qv,b.invert=Hu,b.isFullscreen=function(){return!!De.document.fullscreenElement||!!De.document.webkitFullscreenElement},b.isLngLatBehindGlobe=wm,b.isMapAuthenticated=function(r){return ie.has(r)},b.isMapboxURL=Vs,b.isSafariWithAntialiasingBug=function(r){const s=r.navigator?r.navigator.userAgent:null;return!!hi(r)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},b.latFromMercatorY=Lo,b.latLngToECEF=No,b.len=My,b.length=Gu,b.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},b.lngFromMercatorX=da,b.loadVectorTile=rx,b.makeRequest=Es,b.mapValue=function(r,s,l,p,v){return Wi((r-s)/(l-s)*(v-p)+p,p,v)},b.mercatorScale=Dy,b.mercatorXfromLng=Pl,b.mercatorYfromLat=Ha,b.mercatorZfromAltitude=Ca,b.mul=$u,b.mul$1=vC,b.multiply=kl,b.multiply$1=vy,b.multiply$2=wy,b.nextPowerOfTwo=Mn,b.normalize=Nr,b.normalize$1=bC,b.normalize$2=Cy,b.number=rs,b.ortho=function(r,s,l,p,v,A,F){var N=1/(s-l),U=1/(p-v),H=1/(A-F);return r[0]=-2*N,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*U,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*H,r[11]=0,r[12]=(s+l)*N,r[13]=(v+p)*U,r[14]=(F+A)*H,r[15]=1,r},b.pbf=pp,b.perspective=function(r,s,l,p,v){var A,F=1/Math.tan(s/2);return r[0]=F/l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=F,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=v&&v!==1/0?(r[10]=(v+p)*(A=1/(p-v)),r[14]=2*v*p*A):(r[10]=-1,r[14]=-2*p),r},b.pick=function(r,s){const l={};for(let p=0;p<s.length;p++){const v=s[p];v in r&&(l[v]=r[v])}return l},b.plugin=ge,b.pointGeometry=xi,b.polesInViewport=function(r){const s=rl(new Float64Array(16));kl(s,r.pixelMatrix,r.globeMatrix);const l=[0,Ua,0],p=[0,Ya,0];return go(l,l,s),go(p,p,s),[l[0]>0&&l[0]<=r.width&&l[1]>0&&l[1]<=r.height&&!wm(r,new ns(r.center.lat,90)),p[0]>0&&p[0]<=r.width&&p[1]>0&&p[1]<=r.height&&!wm(r,new ns(r.center.lat,-90))]},b.polygonContainsPoint=Zh,b.polygonIntersectsBox=mg,b.polygonIntersectsPolygon=pg,b.polygonizeBounds=function(r,s,l=0,p=!0){const v=new xi(l,l),A=r.sub(v),F=s.add(v),N=[A,new xi(F.x,A.y),F,new xi(A.x,F.y)];return p&&N.push(A.clone()),N},b.posAttributes=xm,b.postMapLoadEvent=wt,b.postPerformanceEvent=Gt,b.postTurnstileEvent=ct,b.potpack=Um,b.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},b.radToDeg=cn,b.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],b.registerForPluginStateChange=function(r){return r({pluginStatus:zt,pluginURL:At}),ne.on("pluginStateChange",r),r},b.removeAuthState=function(r){ie.delete(r)},b.renderColorRamp=Jh,b.resample=Iy,b.rotateX=um,b.rotateX$1=tb,b.rotateY=rh,b.rotateY$1=gm,b.rotateZ=function(r,s,l){var p=Math.sin(l),v=Math.cos(l),A=s[0],F=s[1],N=s[2],U=s[3],H=s[4],K=s[5],et=s[6],ot=s[7];return s!==r&&(r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15]),r[0]=A*v+H*p,r[1]=F*v+K*p,r[2]=N*v+et*p,r[3]=U*v+ot*p,r[4]=H*v-A*p,r[5]=K*v-F*p,r[6]=et*v-N*p,r[7]=ot*v-U*p,r},b.rotateZ$1=function(r,s,l){l*=.5;var p=s[0],v=s[1],A=s[2],F=s[3],N=Math.sin(l),U=Math.cos(l);return r[0]=p*U+v*N,r[1]=v*U-p*N,r[2]=A*U+F*N,r[3]=F*U-A*N,r},b.scale=la,b.scale$1=Qv,b.scale$2=Ma,b.scaleAndAdd=mm,b.set=function(r,s,l,p){return r[0]=s,r[1]=l,r[2]=p,r},b.setCacheLimits=function(r,s){Hs=r,In=s},b.setColumn=function(r,s,l){r[4*s+0]=l[0],r[4*s+1]=l[1],r[4*s+2]=l[2],r[4*s+3]=l[3]},b.setRTLTextPlugin=function(r,s,l=!1){if(zt===Dt||zt===Bt||zt===Nt)throw new Error("setRTLTextPlugin cannot be called multiple times.");At=c.resolveURL(r),zt=Dt,Ot=s,Jt(),l||ue()},b.smoothstep=As,b.spec=B,b.squaredLength=function(r){var s=r[0],l=r[1],p=r[2];return s*s+l*l+p*p},b.storeAuthState=function(r,s){s?ie.add(r):ie.delete(r)},b.sub=ja,b.subtract=jc,b.symbolSize=Gd,b.tileAABB=function(r,s,l,p,v,A,F,N,U){if("globe"===U.name)return function ca(r,s,l){const p=s/r.worldSize,v=r.globeMatrix;if(l.z<=1){const ke=Al(l).getCorners();return Sy(ke,v,p),Pr.fromPoints(ke)}const A=Bd(l),F=vm(A);Sy(F,v,p);const N=Number.MAX_VALUE,U=[-N,-N,-N],H=[N,N,N];if(A.contains(r.center)){for(const si of F)pm(H,H,si),Ld(U,U,si);U[2]=0;const ke=r.point,je=[ke.x*p,ke.y*p,0];return pm(H,H,je),Ld(U,U,je),new Pr(H,U)}const K=[v[12]*p,v[13]*p,v[14]*p],et=A.getCenter(),ot=Wi(r.center.lat,-sr,sr),ft=Wi(et.lat,-sr,sr),_t=Pl(r.center.lng),St=Ha(ot);let Lt=_t-Pl(et.lng);const Zt=St-Ha(ft);Lt>.5?Lt-=1:Lt<-.5&&(Lt+=1);let he=0;Math.abs(Lt)>Math.abs(Zt)?he=Lt>=0?1:3:(he=Zt>=0?0:2,mm(K,K,[v[4]*p,v[5]*p,v[6]*p],-Math.sin(Xi(Zt>=0?A.getSouth():A.getNorth()))*al));const Ut=F[he],ae=F[(he+1)%4],de=new sb(Ut,ae,K),ce=[og(de,0)||Ut[0],og(de,1)||Ut[1],og(de,2)||Ut[2]],Ce=Yc(r.zoom);if(Ce>0){const ke=function({x:si,y:Ae,z:Ye},Ge,oi,di,Oe){const Ci=1/(1<<Ye);let hn=si*Ci,ki=hn+Ci,Yi=Ae*Ci,Si=Yi+Ci,gn=0;const Jn=(hn+ki)/2-di;return Jn>.5?gn=-1:Jn<-.5&&(gn=1),hn=((hn+gn)*Ge-(di*=Ge))*oi+di,ki=((ki+gn)*Ge-di)*oi+di,Yi=(Yi*Ge-(Oe*=Ge))*oi+Oe,Si=(Si*Ge-Oe)*oi+Oe,[[hn,Si,0],[ki,Si,0],[ki,Yi,0],[hn,Yi,0]]}(l,s,r._pixelsPerMercatorPixel,_t,St);for(let si=0;si<F.length;si++)Uh(F[si],ke[si],Ce);const je=ha([],ke[he],ke[(he+1)%4]);Ma(je,je,.5),Uh(ce,je,Ce)}for(const ke of F)pm(H,H,ke),Ld(U,U,ke);return H[2]=Math.min(Ut[2],ae[2]),pm(H,H,ce),Ld(U,U,ce),new Pr(H,U)}(r,s,new Ud(l,p,v));const H=nc({z:l,x:p,y:v},U);return new Pr([(A+H.x/H.scale)*s,s*(H.y/H.scale),F],[(A+H.x2/H.scale)*s,s*(H.y2/H.scale),N])},b.tileCornersToBounds=Bd,b.tileTransform=nc,b.transformMat3=function(r,s,l){var p=s[0],v=s[1],A=s[2];return r[0]=p*l[0]+v*l[3]+A*l[6],r[1]=p*l[1]+v*l[4]+A*l[7],r[2]=p*l[2]+v*l[5]+A*l[8],r},b.transformMat4=go,b.transformMat4$1=Uc,b.transformQuat=ng,b.transitionTileAABBinECEF=Ty,b.translate=Xc,b.transpose=function(r,s){if(r===s){var l=s[1],p=s[2],v=s[5];r[1]=s[3],r[2]=s[6],r[3]=l,r[5]=s[7],r[6]=p,r[7]=v}else r[0]=s[0],r[1]=s[3],r[2]=s[6],r[3]=s[1],r[4]=s[4],r[5]=s[7],r[6]=s[2],r[7]=s[5],r[8]=s[8];return r},b.triggerPluginCompletionEvent=Qt,b.uniqueId=ao,b.updateGlobeVertexNormal=function(r,s,l,p,v){const A=5*s+2;r.float32[A+0]=l,r.float32[A+1]=p,r.float32[A+2]=v},b.validateCustomStyleLayer=function(r){const s=[],l=r.id;return void 0===l&&s.push({message:`layers.${l}: missing required property "id"`}),void 0===r.render&&s.push({message:`layers.${l}: missing required method "render"`}),r.renderingMode&&"2d"!==r.renderingMode&&"3d"!==r.renderingMode&&s.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),s},b.validateFilter=r=>fr(Md(r)),b.validateFog=r=>fr(em(r)),b.validateLayer=r=>fr(Rr(r)),b.validateLight=r=>fr(Dc(r)),b.validateSource=r=>fr(Po(r)),b.validateStyle=im,b.validateTerrain=r=>fr(Ar(r)),b.values=fn,b.vectorTile=Fm,b.version=ho,b.warnOnce=Xt,b.window=De,b.wrap=Ri}),On(0,function(b){function De(yt){if("number"==typeof yt||"boolean"==typeof yt||"string"==typeof yt||null==yt)return JSON.stringify(yt);if(Array.isArray(yt)){let pt="[";for(const wt of yt)pt+=`${De(wt)},`;return`${pt}]`}let ct="{";for(const pt of Object.keys(yt).sort())ct+=`${pt}:${De(yt[pt])},`;return`${ct}}`}function ho(yt){let ct="";for(const pt of b.refProperties)ct+=`/${De(yt[pt])}`;return ct}class ks{constructor(ct){this.keyCache={},ct&&this.replace(ct)}replace(ct){this._layerConfigs={},this._layers={},this.update(ct,[])}update(ct,pt){for(const It of ct)this._layerConfigs[It.id]=It,(this._layers[It.id]=b.createStyleLayer(It)).compileFilter(),this.keyCache[It.id]&&delete this.keyCache[It.id];for(const It of pt)delete this.keyCache[It],delete this._layerConfigs[It],delete this._layers[It];this.familiesBySource={};const wt=function(It,Gt){const re={};for(let ie=0;ie<It.length;ie++){const u=Gt&&Gt[It[ie].id]||ho(It[ie]);Gt&&(Gt[It[ie].id]=u);let I=re[u];I||(I=re[u]=[]),I.push(It[ie])}const te=[];for(const ie in re)te.push(re[ie]);return te}(b.values(this._layerConfigs),this.keyCache);for(const It of wt){const Gt=It.map(g=>this._layers[g.id]),re=Gt[0];if("none"===re.visibility)continue;const te=re.source||"";let ie=this.familiesBySource[te];ie||(ie=this.familiesBySource[te]={});const u=re.sourceLayer||"_geojsonTileLayer";let I=ie[u];I||(I=ie[u]=[]),I.push(Gt)}}}class pn{loadTile(ct,pt){const{uid:wt,encoding:It,rawImageData:Gt,padding:re,buildQuadTree:te}=ct,ie=b.window.ImageBitmap&&Gt instanceof b.window.ImageBitmap?this.getImageData(Gt,re):Gt;pt(null,new b.DEMData(wt,ie,It,re<1,te))}getImageData(ct,pt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ct.width,ct.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ct.width,this.offscreenCanvas.height=ct.height,this.offscreenCanvasContext.drawImage(ct,0,0,ct.width,ct.height);const wt=this.offscreenCanvasContext.getImageData(-pt,-pt,ct.width+2*pt,ct.height+2*pt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),wt}}var bi=function yt(ct,pt){var wt,It=ct&&ct.type;if("FeatureCollection"===It)for(wt=0;wt<ct.features.length;wt++)yt(ct.features[wt],pt);else if("GeometryCollection"===It)for(wt=0;wt<ct.geometries.length;wt++)yt(ct.geometries[wt],pt);else if("Feature"===It)yt(ct.geometry,pt);else if("Polygon"===It)an(ct.coordinates,pt);else if("MultiPolygon"===It)for(wt=0;wt<ct.coordinates.length;wt++)an(ct.coordinates[wt],pt);return ct};function an(yt,ct){if(0!==yt.length){$t(yt[0],ct);for(var pt=1;pt<yt.length;pt++)$t(yt[pt],!ct)}}function $t(yt,ct){for(var pt=0,wt=0,It=0,Gt=yt.length,re=Gt-1;It<Gt;re=It++){var te=(yt[It][0]-yt[re][0])*(yt[re][1]+yt[It][1]),ie=pt+te;wt+=Math.abs(pt)>=Math.abs(te)?pt-ie+te:te-ie+pt,pt=ie}pt+wt>=0!=!!ct&&yt.reverse()}const Et=b.VectorTileFeature.prototype.toGeoJSON;class fo{constructor(ct){this._feature=ct,this.extent=b.EXTENT,this.type=ct.type,this.properties=ct.tags,"id"in ct&&!isNaN(ct.id)&&(this.id=parseInt(ct.id,10))}loadGeometry(){if(1===this._feature.type){const ct=[];for(const pt of this._feature.geometry)ct.push([new b.pointGeometry(pt[0],pt[1])]);return ct}{const ct=[];for(const pt of this._feature.geometry){const wt=[];for(const It of pt)wt.push(new b.pointGeometry(It[0],It[1]));ct.push(wt)}return ct}}toGeoJSON(ct,pt,wt){return Et.call(this,ct,pt,wt)}}class Yo{constructor(ct){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=b.EXTENT,this.length=ct.length,this._features=ct}feature(ct){return new fo(this._features[ct])}}var tn={},Ti={get exports(){return tn},set exports(yt){tn=yt}},Li=b.pointGeometry,xi=b.vectorTile.VectorTileFeature,en=ro;function ro(yt,ct){this.options=ct||{},this.features=yt,this.length=yt.length}function yo(yt,ct){this.id="number"==typeof yt.id?yt.id:void 0,this.type=yt.type,this.rawGeometry=1===yt.type?[yt.geometry]:yt.geometry,this.properties=yt.tags,this.extent=ct||4096}ro.prototype.feature=function(yt){return new yo(this.features[yt],this.options.extent)},yo.prototype.loadGeometry=function(){var yt=this.rawGeometry;this.geometry=[];for(var ct=0;ct<yt.length;ct++){for(var pt=yt[ct],wt=[],It=0;It<pt.length;It++)wt.push(new Li(pt[It][0],pt[It][1]));this.geometry.push(wt)}return this.geometry},yo.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var yt=this.geometry,ct=1/0,pt=-1/0,wt=1/0,It=-1/0,Gt=0;Gt<yt.length;Gt++)for(var re=yt[Gt],te=0;te<re.length;te++){var ie=re[te];ct=Math.min(ct,ie.x),pt=Math.max(pt,ie.x),wt=Math.min(wt,ie.y),It=Math.max(It,ie.y)}return[ct,wt,pt,It]},yo.prototype.toGeoJSON=xi.prototype.toGeoJSON;var Xi=b.pbf,cn=en;function $n(yt){var ct=new Xi;return function(pt,wt){for(var It in pt.layers)wt.writeMessage(3,zi,pt.layers[It])}(yt,ct),ct.finish()}function zi(yt,ct){var pt;ct.writeVarintField(15,yt.version||1),ct.writeStringField(1,yt.name||""),ct.writeVarintField(5,yt.extent||4096);var wt={keys:[],values:[],keycache:{},valuecache:{}};for(pt=0;pt<yt.length;pt++)wt.feature=yt.feature(pt),ct.writeMessage(2,un,wt);var It=wt.keys;for(pt=0;pt<It.length;pt++)ct.writeStringField(3,It[pt]);var Gt=wt.values;for(pt=0;pt<Gt.length;pt++)ct.writeMessage(4,Us,Gt[pt])}function un(yt,ct){var pt=yt.feature;void 0!==pt.id&&ct.writeVarintField(1,pt.id),ct.writeMessage(2,js,yt),ct.writeVarintField(3,pt.type),ct.writeMessage(4,Ri,pt)}function js(yt,ct){var pt=yt.feature,wt=yt.keys,It=yt.values,Gt=yt.keycache,re=yt.valuecache;for(var te in pt.properties){var ie=pt.properties[te],u=Gt[te];if(null!==ie){void 0===u&&(wt.push(te),Gt[te]=u=wt.length-1),ct.writeVarint(u);var I=typeof ie;"string"!==I&&"boolean"!==I&&"number"!==I&&(ie=JSON.stringify(ie));var g=I+":"+ie,x=re[g];void 0===x&&(It.push(ie),re[g]=x=It.length-1),ct.writeVarint(x)}}}function Wi(yt,ct){return(ct<<3)+(7&yt)}function As(yt){return yt<<1^yt>>31}function Ri(yt,ct){for(var pt=yt.loadGeometry(),wt=yt.type,It=0,Gt=0,re=pt.length,te=0;te<re;te++){var ie=pt[te],u=1;1===wt&&(u=ie.length),ct.writeVarint(Wi(1,u));for(var I=3===wt?ie.length-1:ie.length,g=0;g<I;g++){1===g&&1!==wt&&ct.writeVarint(Wi(2,I-1));var x=ie[g].x-It,w=ie[g].y-Gt;ct.writeVarint(As(x)),ct.writeVarint(As(w)),It+=x,Gt+=w}3===wt&&ct.writeVarint(Wi(7,1))}}function Us(yt,ct){var pt=typeof yt;"string"===pt?ct.writeStringField(1,yt):"boolean"===pt?ct.writeBooleanField(7,yt):"number"===pt&&(yt%1!=0?ct.writeDoubleField(3,yt):yt<0?ct.writeSVarintField(6,yt):ct.writeVarintField(5,yt))}function fn(yt,ct,pt,wt,It,Gt){if(It-wt<=pt)return;const re=wt+It>>1;ln(yt,ct,re,wt,It,Gt%2),fn(yt,ct,pt,wt,re-1,Gt+1),fn(yt,ct,pt,re+1,It,Gt+1)}function ln(yt,ct,pt,wt,It,Gt){for(;It>wt;){if(It-wt>600){const u=It-wt+1,I=pt-wt+1,g=Math.log(u),x=.5*Math.exp(2*g/3),w=.5*Math.sqrt(g*x*(u-x)/u)*(I-u/2<0?-1:1);ln(yt,ct,pt,Math.max(wt,Math.floor(pt-I*x/u+w)),Math.min(It,Math.floor(pt+(u-I)*x/u+w)),Gt)}const re=ct[2*pt+Gt];let te=wt,ie=It;for(En(yt,ct,wt,pt),ct[2*It+Gt]>re&&En(yt,ct,wt,It);te<ie;){for(En(yt,ct,te,ie),te++,ie--;ct[2*te+Gt]<re;)te++;for(;ct[2*ie+Gt]>re;)ie--}ct[2*wt+Gt]===re?En(yt,ct,wt,ie):(ie++,En(yt,ct,ie,It)),ie<=pt&&(wt=ie+1),pt<=ie&&(It=ie-1)}}function En(yt,ct,pt,wt){ao(yt,pt,wt),ao(ct,2*pt,2*wt),ao(ct,2*pt+1,2*wt+1)}function ao(yt,ct,pt){const wt=yt[ct];yt[ct]=yt[pt],yt[pt]=wt}function Ys(yt,ct,pt,wt){const It=yt-pt,Gt=ct-wt;return It*It+Gt*Gt}Ti.exports=$n,tn.fromVectorTileJs=$n,tn.fromGeojsonVt=function(yt,ct){ct=ct||{};var pt={};for(var wt in yt)pt[wt]=new cn(yt[wt].features,ct),pt[wt].name=wt,pt[wt].version=ct.version,pt[wt].extent=ct.extent;return $n({layers:pt})},tn.GeoJSONWrapper=cn;const Mn=yt=>yt[0],oe=yt=>yt[1];class Ls{constructor(ct,pt=Mn,wt=oe,It=64,Gt=Float64Array){this.nodeSize=It,this.points=ct;const re=ct.length<65536?Uint16Array:Uint32Array,te=this.ids=new re(ct.length),ie=this.coords=new Gt(2*ct.length);for(let u=0;u<ct.length;u++)te[u]=u,ie[2*u]=pt(ct[u]),ie[2*u+1]=wt(ct[u]);fn(te,ie,It,0,te.length-1,0)}range(ct,pt,wt,It){return function(Gt,re,te,ie,u,I,g){const x=[0,Gt.length-1,0],w=[];let D,o;for(;x.length;){const y=x.pop(),f=x.pop(),c=x.pop();if(f-c<=g){for(let k=c;k<=f;k++)D=re[2*k],o=re[2*k+1],D>=te&&D<=u&&o>=ie&&o<=I&&w.push(Gt[k]);continue}const d=Math.floor((c+f)/2);D=re[2*d],o=re[2*d+1],D>=te&&D<=u&&o>=ie&&o<=I&&w.push(Gt[d]);const M=(y+1)%2;(0===y?te<=D:ie<=o)&&(x.push(c),x.push(d-1),x.push(M)),(0===y?u>=D:I>=o)&&(x.push(d+1),x.push(f),x.push(M))}return w}(this.ids,this.coords,ct,pt,wt,It,this.nodeSize)}within(ct,pt,wt){return function(It,Gt,re,te,ie,u){const I=[0,It.length-1,0],g=[],x=ie*ie;for(;I.length;){const w=I.pop(),D=I.pop(),o=I.pop();if(D-o<=u){for(let M=o;M<=D;M++)Ys(Gt[2*M],Gt[2*M+1],re,te)<=x&&g.push(It[M]);continue}const y=Math.floor((o+D)/2),f=Gt[2*y],c=Gt[2*y+1];Ys(f,c,re,te)<=x&&g.push(It[y]);const d=(w+1)%2;(0===w?re-ie<=f:te-ie<=c)&&(I.push(o),I.push(y-1),I.push(d)),(0===w?re+ie>=f:te+ie>=c)&&(I.push(y+1),I.push(D),I.push(d))}return g}(this.ids,this.coords,ct,pt,wt,this.nodeSize)}}const Ze={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:yt=>yt},at=Math.fround||(rt=new Float32Array(1),yt=>(rt[0]=+yt,rt[0]));var rt;class Yt{constructor(ct){this.options=hi(Object.create(Ze),ct),this.trees=new Array(this.options.maxZoom+1)}load(ct){const{log:pt,minZoom:wt,maxZoom:It,nodeSize:Gt}=this.options;pt&&console.time("total time");const re=`prepare ${ct.length} points`;pt&&console.time(re),this.points=ct;let te=[];for(let ie=0;ie<ct.length;ie++)ct[ie].geometry&&te.push(Xt(ct[ie],ie));this.trees[It+1]=new Ls(te,ai,Qi,Gt,Float32Array),pt&&console.timeEnd(re);for(let ie=It;ie>=wt;ie--){const u=+Date.now();te=this._cluster(te,ie),this.trees[ie]=new Ls(te,ai,Qi,Gt,Float32Array),pt&&console.log("z%d: %d clusters in %dms",ie,te.length,+Date.now()-u)}return pt&&console.timeEnd("total time"),this}getClusters(ct,pt){let wt=((ct[0]+180)%360+360)%360-180;const It=Math.max(-90,Math.min(90,ct[1]));let Gt=180===ct[2]?180:((ct[2]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,ct[3]));if(ct[2]-ct[0]>=360)wt=-180,Gt=180;else if(wt>Gt){const I=this.getClusters([wt,It,180,re],pt),g=this.getClusters([-180,It,Gt,re],pt);return I.concat(g)}const te=this.trees[this._limitZoom(pt)],ie=te.range(Ke(wt),Vi(re),Ke(Gt),Vi(It)),u=[];for(const I of ie){const g=te.points[I];u.push(g.numPoints?xe(g):this.points[g.index])}return u}getChildren(ct){const pt=this._getOriginId(ct),wt=this._getOriginZoom(ct),It="No cluster with the specified id.",Gt=this.trees[wt];if(!Gt)throw new Error(It);const re=Gt.points[pt];if(!re)throw new Error(It);const te=this.options.radius/(this.options.extent*Math.pow(2,wt-1)),ie=Gt.within(re.x,re.y,te),u=[];for(const I of ie){const g=Gt.points[I];g.parentId===ct&&u.push(g.numPoints?xe(g):this.points[g.index])}if(0===u.length)throw new Error(It);return u}getLeaves(ct,pt,wt){const It=[];return this._appendLeaves(It,ct,pt=pt||10,wt=wt||0,0),It}getTile(ct,pt,wt){const It=this.trees[this._limitZoom(ct)],Gt=Math.pow(2,ct),{extent:re,radius:te}=this.options,ie=te/re,u=(wt-ie)/Gt,I=(wt+1+ie)/Gt,g={features:[]};return this._addTileFeatures(It.range((pt-ie)/Gt,u,(pt+1+ie)/Gt,I),It.points,pt,wt,Gt,g),0===pt&&this._addTileFeatures(It.range(1-ie/Gt,u,1,I),It.points,Gt,wt,Gt,g),pt===Gt-1&&this._addTileFeatures(It.range(0,u,ie/Gt,I),It.points,-1,wt,Gt,g),g.features.length?g:null}getClusterExpansionZoom(ct){let pt=this._getOriginZoom(ct)-1;for(;pt<=this.options.maxZoom;){const wt=this.getChildren(ct);if(pt++,1!==wt.length)break;ct=wt[0].properties.cluster_id}return pt}_appendLeaves(ct,pt,wt,It,Gt){const re=this.getChildren(pt);for(const te of re){const ie=te.properties;if(ie&&ie.cluster?Gt+ie.point_count<=It?Gt+=ie.point_count:Gt=this._appendLeaves(ct,ie.cluster_id,wt,It,Gt):Gt<It?Gt++:ct.push(te),ct.length===wt)break}return Gt}_addTileFeatures(ct,pt,wt,It,Gt,re){for(const te of ct){const ie=pt[te],u=ie.numPoints;let I,g,x;if(u)I=We(ie),g=ie.x,x=ie.y;else{const o=this.points[ie.index];I=o.properties,g=Ke(o.geometry.coordinates[0]),x=Vi(o.geometry.coordinates[1])}const w={type:1,geometry:[[Math.round(this.options.extent*(g*Gt-wt)),Math.round(this.options.extent*(x*Gt-It))]],tags:I};let D;u?D=ie.id:this.options.generateId?D=ie.index:this.points[ie.index].id&&(D=this.points[ie.index].id),void 0!==D&&(w.id=D),re.features.push(w)}}_limitZoom(ct){return Math.max(this.options.minZoom,Math.min(Math.floor(+ct),this.options.maxZoom+1))}_cluster(ct,pt){const wt=[],{radius:It,extent:Gt,reduce:re,minPoints:te}=this.options,ie=It/(Gt*Math.pow(2,pt));for(let u=0;u<ct.length;u++){const I=ct[u];if(I.zoom<=pt)continue;I.zoom=pt;const g=this.trees[pt+1],x=g.within(I.x,I.y,ie),w=I.numPoints||1;let D=w;for(const o of x){const y=g.points[o];y.zoom>pt&&(D+=y.numPoints||1)}if(D>w&&D>=te){let o=I.x*w,y=I.y*w,f=re&&w>1?this._map(I,!0):null;const c=(u<<5)+(pt+1)+this.points.length;for(const d of x){const M=g.points[d];if(M.zoom<=pt)continue;M.zoom=pt;const k=M.numPoints||1;o+=M.x*k,y+=M.y*k,M.parentId=c,re&&(f||(f=this._map(I,!0)),re(f,this._map(M)))}I.parentId=c,wt.push(Kt(o/D,y/D,c,D,f))}else if(wt.push(I),D>1)for(const o of x){const y=g.points[o];y.zoom<=pt||(y.zoom=pt,wt.push(y))}}return wt}_getOriginId(ct){return ct-this.points.length>>5}_getOriginZoom(ct){return(ct-this.points.length)%32}_map(ct,pt){if(ct.numPoints)return pt?hi({},ct.properties):ct.properties;const wt=this.points[ct.index].properties,It=this.options.map(wt);return pt&&It===wt?hi({},It):It}}function Kt(yt,ct,pt,wt,It){return{x:at(yt),y:at(ct),zoom:1/0,id:pt,parentId:-1,numPoints:wt,properties:It}}function Xt(yt,ct){const[pt,wt]=yt.geometry.coordinates;return{x:at(Ke(pt)),y:at(Vi(wt)),zoom:1/0,index:ct,parentId:-1}}function xe(yt){return{type:"Feature",id:yt.id,properties:We(yt),geometry:{type:"Point",coordinates:[(ct=yt.x,360*(ct-.5)),$e(yt.y)]}};var ct}function We(yt){const ct=yt.numPoints,pt=ct>=1e4?`${Math.round(ct/1e3)}k`:ct>=1e3?Math.round(ct/100)/10+"k":ct;return hi(hi({},yt.properties),{cluster:!0,cluster_id:yt.id,point_count:ct,point_count_abbreviated:pt})}function Ke(yt){return yt/360+.5}function Vi(yt){const ct=Math.sin(yt*Math.PI/180),pt=.5-.25*Math.log((1+ct)/(1-ct))/Math.PI;return pt<0?0:pt>1?1:pt}function $e(yt){const ct=(180-360*yt)*Math.PI/180;return 360*Math.atan(Math.exp(ct))/Math.PI-90}function hi(yt,ct){for(const pt in ct)yt[pt]=ct[pt];return yt}function ai(yt){return yt.x}function Qi(yt){return yt.y}function Pi(yt,ct,pt,wt){for(var It,Gt=wt,re=pt-ct>>1,te=pt-ct,ie=yt[ct],u=yt[ct+1],I=yt[pt],g=yt[pt+1],x=ct+3;x<pt;x+=3){var w=Ei(yt[x],yt[x+1],ie,u,I,g);if(w>Gt)It=x,Gt=w;else if(w===Gt){var D=Math.abs(x-re);D<te&&(It=x,te=D)}}Gt>wt&&(It-ct>3&&Pi(yt,ct,It,wt),yt[It+2]=Gt,pt-It>3&&Pi(yt,It,pt,wt))}function Ei(yt,ct,pt,wt,It,Gt){var re=It-pt,te=Gt-wt;if(0!==re||0!==te){var ie=((yt-pt)*re+(ct-wt)*te)/(re*re+te*te);ie>1?(pt=It,wt=Gt):ie>0&&(pt+=re*ie,wt+=te*ie)}return(re=yt-pt)*re+(te=ct-wt)*te}function ys(yt,ct,pt,wt){var It={id:void 0===yt?null:yt,type:ct,geometry:pt,tags:wt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Gt){var re=Gt.geometry,te=Gt.type;if("Point"===te||"MultiPoint"===te||"LineString"===te)Hs(Gt,re);else if("Polygon"===te||"MultiLineString"===te)for(var ie=0;ie<re.length;ie++)Hs(Gt,re[ie]);else if("MultiPolygon"===te)for(ie=0;ie<re.length;ie++)for(var u=0;u<re[ie].length;u++)Hs(Gt,re[ie][u])}(It),It}function Hs(yt,ct){for(var pt=0;pt<ct.length;pt+=3)yt.minX=Math.min(yt.minX,ct[pt]),yt.minY=Math.min(yt.minY,ct[pt+1]),yt.maxX=Math.max(yt.maxX,ct[pt]),yt.maxY=Math.max(yt.maxY,ct[pt+1])}function In(yt,ct,pt,wt){if(ct.geometry){var It=ct.geometry.coordinates,Gt=ct.geometry.type,re=Math.pow(pt.tolerance/((1<<pt.maxZoom)*pt.extent),2),te=[],ie=ct.id;if(pt.promoteId?ie=ct.properties[pt.promoteId]:pt.generateId&&(ie=wt||0),"Point"===Gt)Sr(It,te);else if("MultiPoint"===Gt)for(var u=0;u<It.length;u++)Sr(It[u],te);else if("LineString"===Gt)Lr(It,te,re,!1);else if("MultiLineString"===Gt){if(pt.lineMetrics){for(u=0;u<It.length;u++)Lr(It[u],te=[],re,!1),yt.push(ys(ie,"LineString",te,ct.properties));return}_o(It,te,re,!1)}else if("Polygon"===Gt)_o(It,te,re,!0);else{if("MultiPolygon"!==Gt){if("GeometryCollection"===Gt){for(u=0;u<ct.geometry.geometries.length;u++)In(yt,{id:ie,geometry:ct.geometry.geometries[u],properties:ct.properties},pt,wt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<It.length;u++){var I=[];_o(It[u],I,re,!0),te.push(I)}}yt.push(ys(ie,Gt,te,ct.properties))}}function Sr(yt,ct){ct.push(La(yt[0])),ct.push(Ps(yt[1])),ct.push(0)}function Lr(yt,ct,pt,wt){for(var It,Gt,re=0,te=0;te<yt.length;te++){var ie=La(yt[te][0]),u=Ps(yt[te][1]);ct.push(ie),ct.push(u),ct.push(0),te>0&&(re+=wt?(It*u-ie*Gt)/2:Math.sqrt(Math.pow(ie-It,2)+Math.pow(u-Gt,2))),It=ie,Gt=u}var I=ct.length-3;ct[2]=1,Pi(ct,0,I,pt),ct[I+2]=1,ct.size=Math.abs(re),ct.start=0,ct.end=ct.size}function _o(yt,ct,pt,wt){for(var It=0;It<yt.length;It++){var Gt=[];Lr(yt[It],Gt,pt,wt),ct.push(Gt)}}function La(yt){return yt/360+.5}function Ps(yt){var ct=Math.sin(yt*Math.PI/180),pt=.5-.25*Math.log((1+ct)/(1-ct))/Math.PI;return pt<0?0:pt>1?1:pt}function $s(yt,ct,pt,wt,It,Gt,re,te){if(wt/=ct,Gt>=(pt/=ct)&&re<wt)return yt;if(re<pt||Gt>=wt)return null;for(var ie=[],u=0;u<yt.length;u++){var I=yt[u],g=I.geometry,x=I.type,w=0===It?I.minX:I.minY,D=0===It?I.maxX:I.maxY;if(w>=pt&&D<wt)ie.push(I);else if(!(D<pt||w>=wt)){var o=[];if("Point"===x||"MultiPoint"===x)Zo(g,o,pt,wt,It);else if("LineString"===x)Es(g,o,pt,wt,It,!1,te.lineMetrics);else if("MultiLineString"===x)ls(g,o,pt,wt,It,!1);else if("Polygon"===x)ls(g,o,pt,wt,It,!0);else if("MultiPolygon"===x)for(var y=0;y<g.length;y++){var f=[];ls(g[y],f,pt,wt,It,!0),f.length&&o.push(f)}if(o.length){if(te.lineMetrics&&"LineString"===x){for(y=0;y<o.length;y++)ie.push(ys(I.id,x,o[y],I.tags));continue}"LineString"!==x&&"MultiLineString"!==x||(1===o.length?(x="LineString",o=o[0]):x="MultiLineString"),"Point"!==x&&"MultiPoint"!==x||(x=3===o.length?"Point":"MultiPoint"),ie.push(ys(I.id,x,o,I.tags))}}}return ie.length?ie:null}function Zo(yt,ct,pt,wt,It){for(var Gt=0;Gt<yt.length;Gt+=3){var re=yt[Gt+It];re>=pt&&re<=wt&&(ct.push(yt[Gt]),ct.push(yt[Gt+1]),ct.push(yt[Gt+2]))}}function Es(yt,ct,pt,wt,It,Gt,re){for(var te,ie,u=Gn(yt),I=0===It?co:Br,g=yt.start,x=0;x<yt.length-3;x+=3){var w=yt[x],D=yt[x+1],o=yt[x+2],y=yt[x+3],f=yt[x+4],c=0===It?w:D,d=0===It?y:f,M=!1;re&&(te=Math.sqrt(Math.pow(w-y,2)+Math.pow(D-f,2))),c<pt?d>pt&&(ie=I(u,w,D,y,f,pt),re&&(u.start=g+te*ie)):c>wt?d<wt&&(ie=I(u,w,D,y,f,wt),re&&(u.start=g+te*ie)):ps(u,w,D,o),d<pt&&c>=pt&&(ie=I(u,w,D,y,f,pt),M=!0),d>wt&&c<=wt&&(ie=I(u,w,D,y,f,wt),M=!0),!Gt&&M&&(re&&(u.end=g+te*ie),ct.push(u),u=Gn(yt)),re&&(g+=te)}var k=yt.length-3;w=yt[k],D=yt[k+1],o=yt[k+2],(c=0===It?w:D)>=pt&&c<=wt&&ps(u,w,D,o),k=u.length-3,Gt&&k>=3&&(u[k]!==u[0]||u[k+1]!==u[1])&&ps(u,u[0],u[1],u[2]),u.length&&ct.push(u)}function Gn(yt){var ct=[];return ct.size=yt.size,ct.start=yt.start,ct.end=yt.end,ct}function ls(yt,ct,pt,wt,It,Gt){for(var re=0;re<yt.length;re++)Es(yt[re],ct,pt,wt,It,Gt,!1)}function ps(yt,ct,pt,wt){yt.push(ct),yt.push(pt),yt.push(wt)}function co(yt,ct,pt,wt,It,Gt){var re=(Gt-ct)/(wt-ct);return yt.push(Gt),yt.push(pt+(It-pt)*re),yt.push(1),re}function Br(yt,ct,pt,wt,It,Gt){var re=(Gt-pt)/(It-pt);return yt.push(ct+(wt-ct)*re),yt.push(Gt),yt.push(1),re}function Js(yt,ct){for(var pt=[],wt=0;wt<yt.length;wt++){var It,Gt=yt[wt],re=Gt.type;if("Point"===re||"MultiPoint"===re||"LineString"===re)It=is(Gt.geometry,ct);else if("MultiLineString"===re||"Polygon"===re){It=[];for(var te=0;te<Gt.geometry.length;te++)It.push(is(Gt.geometry[te],ct))}else if("MultiPolygon"===re)for(It=[],te=0;te<Gt.geometry.length;te++){for(var ie=[],u=0;u<Gt.geometry[te].length;u++)ie.push(is(Gt.geometry[te][u],ct));It.push(ie)}pt.push(ys(Gt.id,re,It,Gt.tags))}return pt}function is(yt,ct){var pt=[];pt.size=yt.size,void 0!==yt.start&&(pt.start=yt.start,pt.end=yt.end);for(var wt=0;wt<yt.length;wt+=3)pt.push(yt[wt]+ct,yt[wt+1],yt[wt+2]);return pt}function Vs(yt,ct){if(yt.transformed)return yt;var pt,wt,It,Gt=1<<yt.z,re=yt.x,te=yt.y;for(pt=0;pt<yt.features.length;pt++){var ie=yt.features[pt],u=ie.geometry,I=ie.type;if(ie.geometry=[],1===I)for(wt=0;wt<u.length;wt+=2)ie.geometry.push(ut(u[wt],u[wt+1],ct,Gt,re,te));else for(wt=0;wt<u.length;wt++){var g=[];for(It=0;It<u[wt].length;It+=2)g.push(ut(u[wt][It],u[wt][It+1],ct,Gt,re,te));ie.geometry.push(g)}}return yt.transformed=!0,yt}function ut(yt,ct,pt,wt,It,Gt){return[Math.round(pt*(yt*wt-It)),Math.round(pt*(ct*wt-Gt))]}function Ct(yt,ct,pt,wt,It){for(var Gt=ct===It.maxZoom?0:It.tolerance/((1<<ct)*It.extent),re={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pt,y:wt,z:ct,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},te=0;te<yt.length;te++){re.numFeatures++,Vt(re,yt[te],Gt,It);var ie=yt[te].minX,u=yt[te].minY,I=yt[te].maxX,g=yt[te].maxY;ie<re.minX&&(re.minX=ie),u<re.minY&&(re.minY=u),I>re.maxX&&(re.maxX=I),g>re.maxY&&(re.maxY=g)}return re}function Vt(yt,ct,pt,wt){var It=ct.geometry,Gt=ct.type,re=[];if("Point"===Gt||"MultiPoint"===Gt)for(var te=0;te<It.length;te+=3)re.push(It[te]),re.push(It[te+1]),yt.numPoints++,yt.numSimplified++;else if("LineString"===Gt)Le(re,It,yt,pt,!1,!1);else if("MultiLineString"===Gt||"Polygon"===Gt)for(te=0;te<It.length;te++)Le(re,It[te],yt,pt,"Polygon"===Gt,0===te);else if("MultiPolygon"===Gt)for(var ie=0;ie<It.length;ie++){var u=It[ie];for(te=0;te<u.length;te++)Le(re,u[te],yt,pt,!0,0===te)}if(re.length){var I=ct.tags||null;if("LineString"===Gt&&wt.lineMetrics){for(var g in I={},ct.tags)I[g]=ct.tags[g];I.mapbox_clip_start=It.start/It.size,I.mapbox_clip_end=It.end/It.size}var x={geometry:re,type:"Polygon"===Gt||"MultiPolygon"===Gt?3:"LineString"===Gt||"MultiLineString"===Gt?2:1,tags:I};null!==ct.id&&(x.id=ct.id),yt.features.push(x)}}function Le(yt,ct,pt,wt,It,Gt){var re=wt*wt;if(wt>0&&ct.size<(It?re:wt))pt.numPoints+=ct.length/3;else{for(var te=[],ie=0;ie<ct.length;ie+=3)(0===wt||ct[ie+2]>re)&&(pt.numSimplified++,te.push(ct[ie]),te.push(ct[ie+1])),pt.numPoints++;It&&function(u,I){for(var g=0,x=0,w=u.length,D=w-2;x<w;D=x,x+=2)g+=(u[x]-u[D])*(u[x+1]+u[D+1]);if(g>0===I)for(x=0,w=u.length;x<w/2;x+=2){var o=u[x],y=u[x+1];u[x]=u[w-2-x],u[x+1]=u[w-1-x],u[w-2-x]=o,u[w-1-x]=y}}(te,Gt),yt.push(te)}}function ri(yt,ct){var pt=(ct=this.options=function(It,Gt){for(var re in Gt)It[re]=Gt[re];return It}(Object.create(this.options),ct)).debug;if(pt&&console.time("preprocess data"),ct.maxZoom<0||ct.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ct.promoteId&&ct.generateId)throw new Error("promoteId and generateId cannot be used together.");var It,Gt,re,te,ie,u,wt=function(It,Gt){var re=[];if("FeatureCollection"===It.type)for(var te=0;te<It.features.length;te++)In(re,It.features[te],Gt,te);else In(re,"Feature"===It.type?It:{geometry:It},Gt);return re}(yt,ct);this.tiles={},this.tileCoords=[],pt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ct.indexMaxZoom,ct.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=It=wt,ie=$s(It,1,-1-(re=(Gt=ct).buffer/Gt.extent),re,0,-1,2,Gt),u=$s(It,1,1-re,2+re,0,-1,2,Gt),(ie||u)&&(te=$s(It,1,-re,1+re,0,-1,2,Gt)||[],ie&&(te=Js(ie,1).concat(te)),u&&(te=te.concat(Js(u,-1)))),(wt=te).length&&this.splitTile(wt,0,0,0),pt&&(wt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function mi(yt,ct,pt){return 32*((1<<yt)*pt+ct)+yt}function Q(yt,ct){const pt=yt.tileID.canonical;if(!this._geoJSONIndex)return ct(null,null);const wt=this._geoJSONIndex.getTile(pt.z,pt.x,pt.y);if(!wt)return ct(null,null);const It=new Yo(wt.features);let Gt=tn(It);0===Gt.byteOffset&&Gt.byteLength===Gt.buffer.byteLength||(Gt=new Uint8Array(Gt)),ct(null,{vectorTile:It,rawData:Gt.buffer})}ri.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ri.prototype.splitTile=function(yt,ct,pt,wt,It,Gt,re){for(var te=[yt,ct,pt,wt],ie=this.options,u=ie.debug;te.length;){wt=te.pop(),pt=te.pop(),ct=te.pop(),yt=te.pop();var I=1<<ct,g=mi(ct,pt,wt),x=this.tiles[g];if(!x&&(u>1&&console.time("creation"),x=this.tiles[g]=Ct(yt,ct,pt,wt,ie),this.tileCoords.push({z:ct,x:pt,y:wt}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ct,pt,wt,x.numFeatures,x.numPoints,x.numSimplified),console.timeEnd("creation"));var w="z"+ct;this.stats[w]=(this.stats[w]||0)+1,this.total++}if(x.source=yt,It){if(ct===ie.maxZoom||ct===It)continue;var D=1<<It-ct;if(pt!==Math.floor(Gt/D)||wt!==Math.floor(re/D))continue}else if(ct===ie.indexMaxZoom||x.numPoints<=ie.indexMaxPoints)continue;if(x.source=null,0!==yt.length){u>1&&console.time("clipping");var o,y,f,c,d,M,k=.5*ie.buffer/ie.extent,C=.5-k,R=.5+k,B=1+k;o=y=f=c=null,d=$s(yt,I,pt-k,pt+R,0,x.minX,x.maxX,ie),M=$s(yt,I,pt+C,pt+B,0,x.minX,x.maxX,ie),yt=null,d&&(o=$s(d,I,wt-k,wt+R,1,x.minY,x.maxY,ie),y=$s(d,I,wt+C,wt+B,1,x.minY,x.maxY,ie),d=null),M&&(f=$s(M,I,wt-k,wt+R,1,x.minY,x.maxY,ie),c=$s(M,I,wt+C,wt+B,1,x.minY,x.maxY,ie),M=null),u>1&&console.timeEnd("clipping"),te.push(o||[],ct+1,2*pt,2*wt),te.push(y||[],ct+1,2*pt,2*wt+1),te.push(f||[],ct+1,2*pt+1,2*wt),te.push(c||[],ct+1,2*pt+1,2*wt+1)}}},ri.prototype.getTile=function(yt,ct,pt){var wt=this.options,It=wt.extent,Gt=wt.debug;if(yt<0||yt>24)return null;var re=1<<yt,te=mi(yt,ct=(ct%re+re)%re,pt);if(this.tiles[te])return Vs(this.tiles[te],It);Gt>1&&console.log("drilling down to z%d-%d-%d",yt,ct,pt);for(var ie,u=yt,I=ct,g=pt;!ie&&u>0;)u--,I=Math.floor(I/2),g=Math.floor(g/2),ie=this.tiles[mi(u,I,g)];return ie&&ie.source?(Gt>1&&console.log("found parent tile z%d-%d-%d",u,I,g),Gt>1&&console.time("drilling down"),this.splitTile(ie.source,u,I,g,yt,ct,pt),Gt>1&&console.timeEnd("drilling down"),this.tiles[te]?Vs(this.tiles[te],It):null):null};class xt extends b.VectorTileWorkerSource{constructor(ct,pt,wt,It,Gt){super(ct,pt,wt,It,Q),Gt&&(this.loadGeoJSON=Gt)}loadData(ct,pt){const wt=ct&&ct.request,It=wt&&wt.collectResourceTiming;this.loadGeoJSON(ct,(Gt,re)=>{if(Gt||!re)return pt(Gt);if("object"!=typeof re)return pt(new Error(`Input data given to '${ct.source}' is not a valid GeoJSON object.`));{bi(re,!0);try{if(ct.filter){const ie=b.createExpression(ct.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ie.result)throw new Error(ie.value.map(I=>`${I.key}: ${I.message}`).join(", "));re={type:"FeatureCollection",features:re.features.filter(I=>ie.value.evaluate({zoom:0},I))}}this._geoJSONIndex=ct.cluster?new Yt(function({superclusterOptions:ie,clusterProperties:u}){if(!u||!ie)return ie;const I={},g={},x={accumulated:null,zoom:0},w={properties:null},D=Object.keys(u);for(const o of D){const[y,f]=u[o],c=b.createExpression(f),d=b.createExpression("string"==typeof y?[y,["accumulated"],["get",o]]:y);I[o]=c.value,g[o]=d.value}return ie.map=o=>{w.properties=o;const y={};for(const f of D)y[f]=I[f].evaluate(x,w);return y},ie.reduce=(o,y)=>{w.properties=y;for(const f of D)x.accumulated=o[f],o[f]=g[f].evaluate(x,w)},ie}(ct)).load(re.features):new ri(ie=re,ct.geojsonVtOptions)}catch(ie){return pt(ie)}this.loaded={};const te={};if(It){const ie=b.getPerformanceMeasurement(wt);ie&&(te.resourceTiming={},te.resourceTiming[ct.source]=JSON.parse(JSON.stringify(ie)))}pt(null,te)}var ie})}reloadTile(ct,pt){const wt=this.loaded;return wt&&wt[ct.uid]?super.reloadTile(ct,pt):this.loadTile(ct,pt)}loadGeoJSON(ct,pt){if(ct.request)b.getJSON(ct.request,pt);else{if("string"!=typeof ct.data)return pt(new Error(`Input data given to '${ct.source}' is not a valid GeoJSON object.`));try{return pt(null,JSON.parse(ct.data))}catch{return pt(new Error(`Input data given to '${ct.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ct,pt){try{pt(null,this._geoJSONIndex.getClusterExpansionZoom(ct.clusterId))}catch(wt){pt(wt)}}getClusterChildren(ct,pt){try{pt(null,this._geoJSONIndex.getChildren(ct.clusterId))}catch(wt){pt(wt)}}getClusterLeaves(ct,pt){try{pt(null,this._geoJSONIndex.getLeaves(ct.clusterId,ct.limit,ct.offset))}catch(wt){pt(wt)}}}class Pt{constructor(ct){this.self=ct,this.actor=new b.Actor(ct,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=b.getProjection({name:"mercator"}),this.workerSourceTypes={vector:b.VectorTileWorkerSource,geojson:xt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pt,wt)=>{if(this.workerSourceTypes[pt])throw new Error(`Worker source with name "${pt}" already registered.`);this.workerSourceTypes[pt]=wt},this.self.registerRTLTextPlugin=pt=>{if(b.plugin.isParsed())throw new Error("RTL text plugin already registered.");b.plugin.applyArabicShaping=pt.applyArabicShaping,b.plugin.processBidirectionalText=pt.processBidirectionalText,b.plugin.processStyledBidirectionalText=pt.processStyledBidirectionalText}}clearCaches(ct,pt,wt){delete this.layerIndexes[ct],delete this.availableImages[ct],delete this.workerSources[ct],delete this.demWorkerSources[ct],wt()}checkIfReady(ct,pt,wt){wt()}setReferrer(ct,pt){this.referrer=pt}spriteLoaded(ct,pt){this.isSpriteLoaded[ct]=pt;for(const wt in this.workerSources[ct]){const It=this.workerSources[ct][wt];for(const Gt in It)It[Gt]instanceof b.VectorTileWorkerSource&&(It[Gt].isSpriteLoaded=pt,It[Gt].fire(new b.Event("isSpriteLoaded")))}}setImages(ct,pt,wt){this.availableImages[ct]=pt;for(const It in this.workerSources[ct]){const Gt=this.workerSources[ct][It];for(const re in Gt)Gt[re].availableImages=pt}wt()}enableTerrain(ct,pt,wt){this.terrain=pt,wt()}setProjection(ct,pt){this.projections[ct]=b.getProjection(pt)}setLayers(ct,pt,wt){this.getLayerIndex(ct).replace(pt),wt()}updateLayers(ct,pt,wt){this.getLayerIndex(ct).update(pt.layers,pt.removedIds),wt()}loadTile(ct,pt,wt){const It=this.enableTerrain?b.extend({enableTerrain:this.terrain},pt):pt;It.projection=this.projections[ct]||this.defaultProjection,this.getWorkerSource(ct,pt.type,pt.source).loadTile(It,wt)}loadDEMTile(ct,pt,wt){const It=this.enableTerrain?b.extend({buildQuadTree:this.terrain},pt):pt;this.getDEMWorkerSource(ct,pt.source).loadTile(It,wt)}reloadTile(ct,pt,wt){const It=this.enableTerrain?b.extend({enableTerrain:this.terrain},pt):pt;It.projection=this.projections[ct]||this.defaultProjection,this.getWorkerSource(ct,pt.type,pt.source).reloadTile(It,wt)}abortTile(ct,pt,wt){this.getWorkerSource(ct,pt.type,pt.source).abortTile(pt,wt)}removeTile(ct,pt,wt){this.getWorkerSource(ct,pt.type,pt.source).removeTile(pt,wt)}removeSource(ct,pt,wt){if(!this.workerSources[ct]||!this.workerSources[ct][pt.type]||!this.workerSources[ct][pt.type][pt.source])return;const It=this.workerSources[ct][pt.type][pt.source];delete this.workerSources[ct][pt.type][pt.source],void 0!==It.removeSource?It.removeSource(pt,wt):wt()}loadWorkerSource(ct,pt,wt){try{this.self.importScripts(pt.url),wt()}catch(It){wt(It.toString())}}syncRTLPluginState(ct,pt,wt){try{b.plugin.setState(pt);const It=b.plugin.getPluginURL();if(b.plugin.isLoaded()&&!b.plugin.isParsed()&&null!=It){this.self.importScripts(It);const Gt=b.plugin.isParsed();wt(Gt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${It}`),Gt)}}catch(It){wt(It.toString())}}getAvailableImages(ct){let pt=this.availableImages[ct];return pt||(pt=[]),pt}getLayerIndex(ct){let pt=this.layerIndexes[ct];return pt||(pt=this.layerIndexes[ct]=new ks),pt}getWorkerSource(ct,pt,wt){return this.workerSources[ct]||(this.workerSources[ct]={}),this.workerSources[ct][pt]||(this.workerSources[ct][pt]={}),this.workerSources[ct][pt][wt]||(this.workerSources[ct][pt][wt]=new this.workerSourceTypes[pt]({send:(Gt,re,te,ie,u,I)=>{this.actor.send(Gt,re,te,ct,u,I)},scheduler:this.actor.scheduler},this.getLayerIndex(ct),this.getAvailableImages(ct),this.isSpriteLoaded[ct])),this.workerSources[ct][pt][wt]}getDEMWorkerSource(ct,pt){return this.demWorkerSources[ct]||(this.demWorkerSources[ct]={}),this.demWorkerSources[ct][pt]||(this.demWorkerSources[ct][pt]=new pn),this.demWorkerSources[ct][pt]}enforceCacheSizeLimit(ct,pt){b.enforceCacheSizeLimit(pt)}getWorkerPerformanceMetrics(ct,pt,wt){wt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pt(self)),Pt}),On(0,function(b){function De(S,h){if(Array.isArray(S)){if(!Array.isArray(h)||S.length!==h.length)return!1;for(let _=0;_<S.length;_++)if(!De(S[_],h[_]))return!1;return!0}if("object"==typeof S&&null!==S&&null!==h){if("object"!=typeof h||Object.keys(S).length!==Object.keys(h).length)return!1;for(const _ in S)if(!De(S[_],h[_]))return!1;return!0}return S===h}var ho=ks;function ks(S){return h=S,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var P,V,W=new Blob([""],{type:"text/javascript"}),$=URL.createObjectURL(W);try{V=new Worker($),P=!0}catch{P=!1}return V&&V.terminate(),URL.revokeObjectURL($),P}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var P=document.createElement("canvas");P.width=P.height=1;var V=P.getContext("2d");if(!V)return!1;var W=V.getImageData(0,0,1,1);return W&&W.width===P.width}()||(void 0===pn[_=h&&h.failIfMajorPerformanceCaveat]&&(pn[_]=function(P){var V,$,G,tt,W=($=P,G=document.createElement("canvas"),(tt=Object.create(ks.webGLContextAttributes)).failIfMajorPerformanceCaveat=$,G.getContext("webgl",tt)||G.getContext("experimental-webgl",tt));if(!W)return!1;try{V=W.createShader(W.VERTEX_SHADER)}catch{return!1}return!(!V||W.isContextLost())&&(W.shaderSource(V,"void main() {}"),W.compileShader(V),!0===W.getShaderParameter(V,W.COMPILE_STATUS))}(_)),!pn[_]||document.documentMode));var h,_}var pn={};function bi(S,h,_){const P=b.window.document.createElement(S);return void 0!==h&&(P.className=h),_&&_.appendChild(P),P}function an(S,h,_){const P=b.window.document.createElementNS("http://www.w3.org/2000/svg",S);for(const V of Object.keys(h))P.setAttributeNS(null,V,h[V]);return _&&_.appendChild(P),P}ks.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const $t=b.window.document&&b.window.document.documentElement.style,Et=$t&&void 0!==$t.userSelect?"userSelect":"WebkitUserSelect";let fo;function Yo(){$t&&Et&&(fo=$t[Et],$t[Et]="none")}function tn(){$t&&Et&&($t[Et]=fo)}function Ti(S){S.preventDefault(),S.stopPropagation(),b.window.removeEventListener("click",Ti,!0)}function Li(){b.window.addEventListener("click",Ti,!0),b.window.setTimeout(()=>{b.window.removeEventListener("click",Ti,!0)},0)}function xi(S,h){const _=S.getBoundingClientRect();return yo(S,_,h)}function en(S,h){const _=S.getBoundingClientRect(),P=[];for(let V=0;V<h.length;V++)P.push(yo(S,_,h[V]));return P}function ro(S){return void 0!==b.window.InstallTrigger&&2===S.button&&S.ctrlKey&&b.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:S.button}function yo(S,h,_){const P=S.offsetWidth===h.width?1:S.offsetWidth/h.width;return new b.pointGeometry((_.clientX-h.left)*P,(_.clientY-h.top)*P)}function Xi(S,h){var _=h[0],P=h[1],V=h[2],W=h[3],$=_*W-V*P;return $?(S[0]=W*($=1/$),S[1]=-P*$,S[2]=-V*$,S[3]=_*$,S):null}function cn(S){const{userImage:h}=S;return!!(h&&h.render&&h.render())&&(S.data.replace(new Uint8Array(h.data.buffer)),!0)}class $n extends b.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new b.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:_,callback:P}of this.requestors)this._notify(_,P);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,_){this._validate(h,_)&&(this.images[h]=_)}_validate(h,_){let P=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new b.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),P=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new b.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),P=!1),this._validateContent(_.content,_)||(this.fire(new b.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),P=!1),P}_validateStretch(h,_){if(!h)return!0;let P=0;for(const V of h){if(V[0]<P||V[1]<V[0]||_<V[1])return!1;P=V[1]}return!0}_validateContent(h,_){return!(h&&(4!==h.length||h[0]<0||_.data.width<h[0]||h[1]<0||_.data.height<h[1]||h[2]<0||_.data.width<h[2]||h[3]<0||_.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,_){_.version=this.images[h].version+1,this.images[h]=_,this.updatedImages[h]=!0}removeImage(h){const _=this.images[h];delete this.images[h],delete this.patterns[h],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,_){let P=!0;if(!this.isLoaded())for(const V of h)this.images[V]||(P=!1);this.isLoaded()||P?this._notify(h,_):this.requestors.push({ids:h,callback:_})}_notify(h,_){const P={};for(const V of h){this.images[V]||this.fire(new b.Event("styleimagemissing",{id:V}));const W=this.images[V];W?P[V]={data:W.data.clone(),pixelRatio:W.pixelRatio,sdf:W.sdf,version:W.version,stretchX:W.stretchX,stretchY:W.stretchY,content:W.content,hasRenderCallback:Boolean(W.userImage&&W.userImage.render)}:b.warnOnce(`Image "${V}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,P)}getPixelSize(){const{width:h,height:_}=this.atlasImage;return{width:h,height:_}}getPattern(h){const _=this.patterns[h],P=this.getImage(h);if(!P)return null;if(_&&_.position.version===P.version)return _.position;if(_)_.position.version=P.version;else{const V={w:P.data.width+2,h:P.data.height+2,x:0,y:0},W=new b.ImagePosition(V,P);this.patterns[h]={bin:V,position:W}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const _=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new b.Texture(h,this.atlasImage,_.RGBA),this.atlasTexture&&this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const W in this.patterns)h.push(this.patterns[W].bin);const{w:_,h:P}=b.potpack(h),V=this.atlasImage;V.resize({width:_||1,height:P||1});for(const W in this.patterns){const{bin:$}=this.patterns[W],G=$.x+1,tt=$.y+1,ht=this.images[W].data,lt=ht.width,bt=ht.height;b.RGBAImage.copy(ht,V,{x:0,y:0},{x:G,y:tt},{width:lt,height:bt}),b.RGBAImage.copy(ht,V,{x:0,y:bt-1},{x:G,y:tt-1},{width:lt,height:1}),b.RGBAImage.copy(ht,V,{x:0,y:0},{x:G,y:tt+bt},{width:lt,height:1}),b.RGBAImage.copy(ht,V,{x:lt-1,y:0},{x:G-1,y:tt},{width:1,height:bt}),b.RGBAImage.copy(ht,V,{x:0,y:0},{x:G+lt,y:tt},{width:1,height:bt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const _ of h){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const P=this.images[_];cn(P)&&this.updateImage(_,P)}}}const zi=new b.Properties({anchor:new b.DataConstantProperty(b.spec.light.anchor),position:new class{constructor(){this.specification=b.spec.light.position}possiblyEvaluate(S,h){return function([_,P,V]){const W=b.degToRad(P+90),$=b.degToRad(V);return{x:_*Math.cos(W)*Math.sin($),y:_*Math.sin(W)*Math.sin($),z:_*Math.cos($),azimuthal:P,polar:V}}(S.expression.evaluate(h))}interpolate(S,h,_){return{x:b.number(S.x,h.x,_),y:b.number(S.y,h.y,_),z:b.number(S.z,h.z,_),azimuthal:b.number(S.azimuthal,h.azimuthal,_),polar:b.number(S.polar,h.polar,_)}}},color:new b.DataConstantProperty(b.spec.light.color),intensity:new b.DataConstantProperty(b.spec.light.intensity)}),un="-transition";class js extends b.Evented{constructor(h){super(),this._transitionable=new b.Transitionable(zi),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,_={}){if(!this._validate(b.validateLight,h,_))for(const P in h){const V=h[P];b.endsWith(P,un)?this._transitionable.setTransition(P.slice(0,-un.length),V):this._transitionable.setValue(P,V)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,_,P){return(!P||!1!==P.validate)&&b.emitValidationErrors(this,h.call(b.validateStyle,b.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:b.spec})))}}const Wi=new b.Properties({source:new b.DataConstantProperty(b.spec.terrain.source),exaggeration:new b.DataConstantProperty(b.spec.terrain.exaggeration)}),As="-transition";class Ri extends b.Evented{constructor(h,_){super(),this._transitionable=new b.Transitionable(Wi),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=_}get(){return this._transitionable.serialize()}set(h){for(const _ in h){const P=h[_];b.endsWith(_,As)?this._transitionable.setTransition(_.slice(0,-As.length),P):this._transitionable.setValue(_,P)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}}function Us(S,h,_,P){const V=b.smoothstep(45,65,_),[W,$]=fn(S,P),G=b.length(h);let tt=1-Math.min(1,Math.exp((G-W)/($-W)*-6));return tt*=tt*tt,tt=Math.min(1,1.00747*tt),tt*V*S.alpha}function fn(S,h){const _=.5/Math.tan(.5*h);return[S.range[0]+_,S.range[1]+_]}const ln=new b.Properties({range:new b.DataConstantProperty(b.spec.fog.range),color:new b.DataConstantProperty(b.spec.fog.color),"high-color":new b.DataConstantProperty(b.spec.fog["high-color"]),"space-color":new b.DataConstantProperty(b.spec.fog["space-color"]),"horizon-blend":new b.DataConstantProperty(b.spec.fog["horizon-blend"]),"star-intensity":new b.DataConstantProperty(b.spec.fog["star-intensity"])}),En="-transition";class ao extends b.Evented{constructor(h,_){super(),this._transitionable=new b.Transitionable(ln),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=_}get state(){const h=this._transform,_="globe"===h.projection.name,P=b.globeToMercatorTransition(h.zoom),V=this.properties.get("range"),W=[.5,3];return{range:_?[b.number(W[0],V[0],P),b.number(W[1],V[1],P)]:V,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,_={}){if(!this._validate(b.validateFog,h,_)){for(const P of Object.keys(b.spec.fog))h&&void 0===h[P]&&(h[P]=b.spec.fog[P].default);for(const P in h){const V=h[P];b.endsWith(P,En)?this._transitionable.setTransition(P.slice(0,-En.length),V):this._transitionable.setValue(P,V)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const _=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:b.smoothstep(45,65,h))*_.a}getOpacityAtLatLng(h,_){return this._transform.projection.supportsFog?function(P,V,W){const $=b.MercatorCoordinate.fromLngLat(V),G=W.elevation?W.elevation.getAtPointOrZero($):0,tt=[$.x,$.y,G];return b.transformMat4(tt,tt,W.mercatorFogMatrix),Us(P,tt,W.pitch,W._fov)}(this.state,h,_):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?fn(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,_,P){return(!P||!1!==P.validate)&&b.emitValidationErrors(this,h.call(b.validateStyle,b.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:b.spec})))}}class Ys{constructor(h,_){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=b.uniqueId();const P=this.workerPool.acquire(this.id);for(let V=0;V<P.length;V++){const W=new Ys.Actor(P[V],_,this.id);W.name=`Worker ${V}`,this.actors.push(W)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,_,P){b.asyncAll(this.actors,(V,W)=>{V.send(h,_,W)},P=P||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Mn(S,h,_){return h*(b.EXTENT/(S.tileSize*Math.pow(2,_-S.tileID.overscaledZ)))}Ys.Actor=b.Actor;class oe{constructor(h,_,P,V){this.screenBounds=h,this.cameraPoint=_,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=P,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,V)}static createFromScreenPoints(h,_){let P,V;if(h instanceof b.pointGeometry||"number"==typeof h[0]){const W=b.pointGeometry.convert(h);P=[W],V=_.isPointAboveHorizon(W)}else{const W=b.pointGeometry.convert(h[0]),$=b.pointGeometry.convert(h[1]);P=[W,$],V=b.polygonizeBounds(W,$).every(G=>_.isPointAboveHorizon(G))}return new oe(P,_.getCameraPoint(),V,_)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(h){return b.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const _=this.screenBounds[0],P=1===this.screenBounds.length?this.screenBounds[0].add(new b.pointGeometry(1,1)):this.screenBounds[1],V=b.polygonizeBounds(_,P,0,!1);return this.cameraPoint.y>P.y&&(this.cameraPoint.x>_.x&&this.cameraPoint.x<P.x?V.splice(3,0,this.cameraPoint):this.cameraPoint.x>=P.x?V[2]=this.cameraPoint:this.cameraPoint.x<=_.x&&(V[3]=this.cameraPoint)),b.bufferConvexPolygon(V,h)}bufferedCameraGeometryGlobe(h){const _=this.screenBounds[0],P=1===this.screenBounds.length?this.screenBounds[0].add(new b.pointGeometry(1,1)):this.screenBounds[1],V=b.polygonizeBounds(_,P,h),W=this.cameraPoint.clone();switch(3*((W.y>_.y)+(W.y>P.y))+((W.x>_.x)+(W.x>P.x))){case 0:V[0]=W,V[4]=W.clone();break;case 1:V.splice(1,0,W);break;case 2:V[1]=W;break;case 3:V.splice(4,0,W);break;case 5:V.splice(2,0,W);break;case 6:V[3]=W;break;case 7:V.splice(3,0,W);break;case 8:V[2]=W}return V}containsTile(h,_,P,V=0){const W=h.queryPadding/_._pixelsPerMercatorPixel+1,$=P?this._bufferedCameraMercator(W,_):this._bufferedScreenMercator(W,_);let G=h.tileID.wrap+($.unwrapped?V:0);const tt=$.polygon.map(zt=>b.getTilePoint(h.tileTransform,zt,G));if(!b.polygonIntersectsBox(tt,0,0,b.EXTENT,b.EXTENT))return;G=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?V:0);const ht=this.screenGeometryMercator.polygon.map(zt=>b.getTileVec3(h.tileTransform,zt,G)),lt=ht.map(zt=>new b.pointGeometry(zt[0],zt[1])),bt=_.getFreeCameraOptions().position||new b.MercatorCoordinate(0,0,0),Dt=b.getTileVec3(h.tileTransform,bt,G),Bt=ht.map(zt=>{const At=b.sub(zt,zt,Dt);return b.normalize(At,At),new b.Ray(Dt,At)}),Nt=Mn(h,1,_.zoom)*_._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:lt,tilespaceRays:Bt,bufferedTilespaceGeometry:tt,bufferedTilespaceBounds:(Ot=b.getBounds(tt),Ot.min.x=b.clamp(Ot.min.x,0,b.EXTENT),Ot.min.y=b.clamp(Ot.min.y,0,b.EXTENT),Ot.max.x=b.clamp(Ot.max.x,0,b.EXTENT),Ot.max.y=b.clamp(Ot.max.y,0,b.EXTENT),Ot),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:Nt};var Ot}_bufferedScreenMercator(h,_){const P=at(h);if(this._screenRaycastCache[P])return this._screenRaycastCache[P];{let V;return V="globe"===_.projection.name?this._projectAndResample(this.bufferedScreenGeometry(h),_):{polygon:this.bufferedScreenGeometry(h).map(W=>_.pointCoordinate3D(W)),unwrapped:!0},this._screenRaycastCache[P]=V,V}}_bufferedCameraMercator(h,_){const P=at(h);if(this._cameraRaycastCache[P])return this._cameraRaycastCache[P];{let V;return V="globe"===_.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),_):{polygon:this.bufferedCameraGeometry(h).map(W=>_.pointCoordinate3D(W)),unwrapped:!0},this._cameraRaycastCache[P]=V,V}}_projectAndResample(h,_){const P=function(W,$){const G=b.multiply([],$.pixelMatrix,$.globeMatrix),tt=[0,-b.GLOBE_RADIUS,0,1],ht=[0,b.GLOBE_RADIUS,0,1],lt=[0,0,0,1];b.transformMat4$1(tt,tt,G),b.transformMat4$1(ht,ht,G),b.transformMat4$1(lt,lt,G);const bt=new b.pointGeometry(tt[0]/tt[3],tt[1]/tt[3]),Dt=new b.pointGeometry(ht[0]/ht[3],ht[1]/ht[3]),Bt=b.polygonContainsPoint(W,bt)&&tt[3]<lt[3],Nt=b.polygonContainsPoint(W,Dt)&&ht[3]<lt[3];if(!Bt&&!Nt)return null;const Ot=function(ge,be,Pe){for(let Ie=1;Ie<ge.length;Ie++){const yi=Ze(be.pointCoordinate3D(ge[Ie-1]).x),Se=Ze(be.pointCoordinate3D(ge[Ie]).x);if(Pe<0){if(yi<Se)return{idx:Ie,t:-yi/(Se-1-yi)}}else if(Se<yi)return{idx:Ie,t:(1-yi)/(Se+1-yi)}}return null}(W,$,Bt?-1:1);if(!Ot)return null;const{idx:zt,t:At}=Ot;let Qt=zt>1?Ls(W.slice(0,zt),$):[],Jt=zt<W.length?Ls(W.slice(zt),$):[];Qt=Qt.map(ge=>new b.pointGeometry(Ze(ge.x),ge.y)),Jt=Jt.map(ge=>new b.pointGeometry(Ze(ge.x),ge.y));const ne=[...Qt];0===ne.length&&ne.push(Jt[Jt.length-1]);const me=b.number(ne[ne.length-1].y,(0===Jt.length?Qt[0]:Jt[0]).y,At);let ue;return ue=Bt?[new b.pointGeometry(0,me),new b.pointGeometry(0,0),new b.pointGeometry(1,0),new b.pointGeometry(1,me)]:[new b.pointGeometry(1,me),new b.pointGeometry(1,1),new b.pointGeometry(0,1),new b.pointGeometry(0,me)],ne.push(...ue),0===Jt.length?ne.push(Qt[0]):ne.push(...Jt),{polygon:ne.map(ge=>new b.MercatorCoordinate(ge.x,ge.y)),unwrapped:!1}}(h,_);if(P)return P;const V=function(W,$){let G=!1,tt=-1/0,ht=0;for(let bt=0;bt<W.length-1;bt++)W[bt].x>tt&&(tt=W[bt].x,ht=bt);for(let bt=0;bt<W.length-1;bt++){const Dt=(ht+bt)%(W.length-1),Bt=W[Dt],Nt=W[Dt+1];Math.abs(Bt.x-Nt.x)>.5&&(Bt.x<Nt.x?(Bt.x+=1,0===Dt&&(W[W.length-1].x+=1)):(Nt.x+=1,Dt+1===W.length-1&&(W[0].x+=1)),G=!0)}const lt=b.mercatorXfromLng($.center.lng);return G&&lt<Math.abs(lt-1)&&W.forEach(bt=>{bt.x-=1}),{polygon:W,unwrapped:G}}(Ls(h,_).map(W=>new b.pointGeometry(Ze(W.x),W.y)),_);return{polygon:V.polygon.map(W=>new b.MercatorCoordinate(W.x,W.y)),unwrapped:V.unwrapped}}}function Ls(S,h){return b.resample(S,_=>{const P=h.pointCoordinate3D(_);_.x=P.x,_.y=P.y},1/256)}function Ze(S){return S<0?1+S%1:S%1}function at(S){return 100*S|0}function rt(S,h,_,P,V){const W=function($,G){if($)return V($);if(G){S.url&&G.tiles&&S.tiles&&delete S.tiles;const tt=b.pick(b.extend(G,S),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);G.vector_layers&&(tt.vectorLayers=G.vector_layers,tt.vectorLayerIds=tt.vectorLayers.map(ht=>ht.id)),tt.tiles=h.canonicalizeTileset(tt,S.url),V(null,tt)}};return S.url?b.getJSON(h.transformRequest(h.normalizeSourceURL(S.url,null,_,P),b.ResourceType.Source),W):b.exported.frame(()=>W(null,S))}class Yt{constructor(h,_,P){this.bounds=b.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=_||0,this.maxzoom=P||24}validateBounds(h){return Array.isArray(h)&&4===h.length?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const _=Math.pow(2,h.z),P=Math.floor(b.mercatorXfromLng(this.bounds.getWest())*_),V=Math.floor(b.mercatorYfromLat(this.bounds.getNorth())*_),W=Math.ceil(b.mercatorXfromLng(this.bounds.getEast())*_),$=Math.ceil(b.mercatorYfromLat(this.bounds.getSouth())*_);return h.x>=P&&h.x<W&&h.y>=V&&h.y<$}}class Kt{constructor(h,_,P){this.context=h;const V=h.gl;this.buffer=V.createBuffer(),this.dynamicDraw=Boolean(P),this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),V.bufferData(V.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?V.DYNAMIC_DRAW:V.STATIC_DRAW),this.dynamicDraw||_.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const _=this.context.gl;this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class xe{constructor(h,_,P,V){this.length=_.length,this.attributes=P,this.itemSize=_.bytesPerElement,this.dynamicDraw=V,this.context=h;const W=h.gl;this.buffer=W.createBuffer(),h.bindVertexBuffer.set(this.buffer),W.bufferData(W.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?W.DYNAMIC_DRAW:W.STATIC_DRAW),this.dynamicDraw||_.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,_){for(let P=0;P<this.attributes.length;P++){const V=_.attributes[this.attributes[P].name];void 0!==V&&h.enableVertexAttribArray(V)}}setVertexAttribPointers(h,_,P){for(let V=0;V<this.attributes.length;V++){const W=this.attributes[V],$=_.attributes[W.name];void 0!==$&&h.vertexAttribPointer($,W.components,h[Xt[W.type]],!1,this.itemSize,W.offset+this.itemSize*(P||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class We{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ke extends We{getDefault(){return b.Color.transparent}set(h){const _=this.current;(h.r!==_.r||h.g!==_.g||h.b!==_.b||h.a!==_.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Vi extends We{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class $e extends We{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class hi extends We{getDefault(){return[!0,!0,!0,!0]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||h[3]!==_[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class ai extends We{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class Qi extends We{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Pi extends We{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const _=this.current;(h.func!==_.func||h.ref!==_.ref||h.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class Ei extends We{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class ys extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=h,this.dirty=!1}}class Hs extends We{getDefault(){return[0,1]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class In extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=h,this.dirty=!1}}class Sr extends We{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class Lr extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.BLEND):_.disable(_.BLEND),this.current=h,this.dirty=!1}}class _o extends We{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class La extends We{getDefault(){return b.Color.transparent}set(h){const _=this.current;(h.r!==_.r||h.g!==_.g||h.b!==_.b||h.a!==_.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Ps extends We{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class $s extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;h?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=h,this.dirty=!1}}class Zo extends We{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class Es extends We{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}class Gn extends We{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}}class ls extends We{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class ps extends We{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const _=this.current;(h[0]!==_[0]||h[1]!==_[1]||h[2]!==_[2]||h[3]!==_[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class co extends We{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class Br extends We{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Js extends We{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class is extends We{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Vs extends We{getDefault(){return null}set(h){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class ut extends We{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class Ct extends We{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class Vt extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class Le extends We{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class ri extends We{constructor(h,_){super(h),this.context=h,this.parent=_}getDefault(){return null}}class mi extends ri{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class Q extends ri{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,this.attachment(),_.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class xt extends Q{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Pt{constructor(h,_,P,V){this.context=h,this.width=_,this.height=P;const W=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new mi(h,W),V&&(this.depthAttachment=new Q(h,W))}destroy(){const h=this.context.gl,_=this.colorAttachment.get();if(_&&h.deleteTexture(_),this.depthAttachment){const P=this.depthAttachment.get();P&&h.deleteRenderbuffer(P)}h.deleteFramebuffer(this.framebuffer)}}class yt{constructor(h,_=!1){if(this.gl=h,this.isWebGL2=_,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),_){const P=h;this.extVertexArrayObject={createVertexArrayOES:P.createVertexArray.bind(h),deleteVertexArrayOES:P.deleteVertexArray.bind(h),bindVertexArrayOES:P.bindVertexArray.bind(h)}}this.clearColor=new Ke(this),this.clearDepth=new Vi(this),this.clearStencil=new $e(this),this.colorMask=new hi(this),this.depthMask=new ai(this),this.stencilMask=new Qi(this),this.stencilFunc=new Pi(this),this.stencilOp=new Ei(this),this.stencilTest=new ys(this),this.depthRange=new Hs(this),this.depthTest=new In(this),this.depthFunc=new Sr(this),this.blend=new Lr(this),this.blendFunc=new _o(this),this.blendColor=new La(this),this.blendEquation=new Ps(this),this.cullFace=new $s(this),this.cullFaceSide=new Zo(this),this.frontFace=new Es(this),this.program=new Gn(this),this.activeTexture=new ls(this),this.viewport=new ps(this),this.bindFramebuffer=new co(this),this.bindRenderbuffer=new Br(this),this.bindTexture=new Js(this),this.bindVertexBuffer=new is(this),this.bindElementBuffer=new Vs(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ut(this),this.pixelStoreUnpack=new Ct(this),this.pixelStoreUnpackPremultiplyAlpha=new Vt(this),this.pixelStoreUnpackFlipY=new Le(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),_||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(_||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=_||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,_){return new Kt(this,h,_)}createVertexBuffer(h,_,P){return new xe(this,h,_,P)}createRenderbuffer(h,_,P){const V=this.gl,W=V.createRenderbuffer();return this.bindRenderbuffer.set(W),V.renderbufferStorage(V.RENDERBUFFER,h,_,P),this.bindRenderbuffer.set(null),W}createFramebuffer(h,_,P){return new Pt(this,h,_,P)}clear({color:h,depth:_,stencil:P}){const V=this.gl;let W=0;h&&(W|=V.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),void 0!==_&&(W|=V.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),void 0!==P&&(W|=V.STENCIL_BUFFER_BIT,this.clearStencil.set(P),this.stencilMask.set(255)),V.clear(W)}setCullFace(h){!1===h.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){De(h.blendFunction,b.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ct extends b.Evented{constructor(h,_,P,V){if(super(),this.id=h,this.dispatcher=P,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,b.extend(this,b.pick(_,["url","scheme","tileSize","promoteId"])),this._options=b.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(V),this._tileWorkers={},this._deduped=new b.DedupedRequest}load(h){this._loaded=!1,this.fire(new b.Event("dataloading",{dataType:"source"}));const _=Array.isArray(this.map._language)?this.map._language.join():this.map._language,P=this.map._worldview;this._tileJSONRequest=rt(this._options,this.map._requestManager,_,P,(V,W)=>{this._tileJSONRequest=null,this._loaded=!0,V?(_&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${_}`),P&&2!==P.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${P}`),this.fire(new b.ErrorEvent(V))):W&&(b.extend(this,W),W.bounds&&(this.tileBounds=new Yt(W.bounds,this.minzoom,this.maxzoom)),b.postTurnstileEvent(W.tiles,this.map._requestManager._customAccessToken),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(V)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return b.extend({},this._options)}loadTile(h,_){const P=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),V={request:this.map._requestManager.transformRequest(P,b.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:b.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(V.request.collectResourceTiming=this._collectResourceTiming,h.actor&&"expired"!==h.state)"loading"===h.state?h.reloadCallback=_:h.request=h.actor.send("reloadTile",V,W.bind(this));else if(h.actor=this._tileWorkers[P]=this._tileWorkers[P]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",V,W.bind(this),void 0,!0);else{const $=b.loadVectorTile.call({deduped:this._deduped},V,(G,tt)=>{G||!tt?W.call(this,G):(V.data={cacheControl:tt.cacheControl,expires:tt.expires,rawData:tt.rawData.slice(0)},h.actor&&h.actor.send("loadTile",V,W.bind(this),void 0,!0))},!0);h.request={cancel:$}}function W($,G){return delete h.request,h.aborted?_(null):$&&404!==$.status?_($):(G&&G.resourceTiming&&(h.resourceTiming=G.resourceTiming),this.map._refreshExpiredTiles&&G&&h.setExpiryData(G),h.loadVectorData(G,this.map.painter),b.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class pt extends b.Evented{constructor(h,_,P,V){super(),this.id=h,this.dispatcher=P,this.setEventedParent(V),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=b.extend({type:"raster"},_),b.extend(this,b.pick(_,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new b.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=rt(this._options,this.map._requestManager,null,null,(_,P)=>{this._tileJSONRequest=null,this._loaded=!0,_?this.fire(new b.ErrorEvent(_)):P&&(b.extend(this,P),P.bounds&&(this.tileBounds=new Yt(P.bounds,this.minzoom,this.maxzoom)),b.postTurnstileEvent(P.tiles),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(_)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return b.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,_){const P=b.exported.devicePixelRatio>=2,V=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),P,this.tileSize);h.request=b.getImage(this.map._requestManager.transformRequest(V,b.ResourceType.Tile),(W,$,G,tt)=>(delete h.request,h.aborted?(h.state="unloaded",_(null)):W?(h.state="errored",_(W)):$?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:G,expires:tt}),h.setTexture($,this.map.painter),h.state="loaded",b.cacheEntryPossiblyAdded(this.dispatcher),void _(null)):_(null)))}static loadTileData(h,_,P){h.setTexture(_,P)}static unloadTileData(h,_){h.texture&&_.saveTileTexture(h.texture)}abortTile(h,_){h.request&&(h.request.cancel(),delete h.request),_()}unloadTile(h,_){h.texture&&this.map.painter.saveTileTexture(h.texture),_()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let wt;function It(S,h,_,P,V,W,$,G){const tt=[S,_,V,h,P,W,1,1,1],ht=[$,G,1],lt=b.adjoint([],tt),[bt,Dt,Bt]=b.transformMat3(ht,ht,b.transpose(lt,lt));return b.multiply$1(tt,[bt,0,0,0,Dt,0,0,0,Bt],tt)}class Gt extends b.Evented{constructor(h,_,P,V){super(),this.id=h,this.dispatcher=P,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(V),this.options=_,this._dirty=!1}load(h,_){this._loaded=_||!1,this.fire(new b.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=b.getImage(this.map._requestManager.transformRequest(this.url,b.ResourceType.Image),(P,V)=>{if(this._imageRequest=null,this._loaded=!0,P)this.fire(new b.ErrorEvent(P));else if(V){const{HTMLImageElement:W}=b.window;this.image=V instanceof W?b.exported.getImageData(V):V,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const _=h.map(b.MercatorCoordinate.fromLngLat);return this.tileID=function(P){let V=1/0,W=1/0,$=-1/0,G=-1/0;for(const bt of P)V=Math.min(V,bt.x),W=Math.min(W,bt.y),$=Math.max($,bt.x),G=Math.max(G,bt.y);const tt=Math.max($-V,G-W),ht=Math.max(0,Math.floor(-Math.log(tt)/Math.LN2)),lt=Math.pow(2,ht);return new b.CanonicalTileID(ht,Math.floor((V+$)/2*lt),Math.floor((W+G)/2*lt))}(_),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new b.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const tt in this.tiles){const ht=this.tiles[tt];"loaded"!==ht.state&&(ht.state="loaded",ht.texture=this.texture)}if(this._boundsArray)return;const _=b.tileTransform(this.tileID,this.map.transform.projection),[P,V,W,$]=this.coordinates.map(tt=>{const ht=_.projection.project(tt[0],tt[1]);return b.getTilePoint(_,ht)._round()});this.perspectiveTransform=function(tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt,At){const Qt=It(0,0,tt,0,0,ht,tt,ht),Jt=It(lt,bt,Dt,Bt,Nt,Ot,zt,At);return b.multiply$1(Jt,b.adjoint(Qt,Qt),Jt),[Jt[6]/Jt[8]*tt/b.EXTENT,Jt[7]/Jt[8]*ht/b.EXTENT]}(this.width,this.height,P.x,P.y,V.x,V.y,$.x,$.y,W.x,W.y);const G=this._boundsArray=new b.StructArrayLayout4i8;G.emplaceBack(P.x,P.y,0,0),G.emplaceBack(V.x,V.y,b.EXTENT,0),G.emplaceBack($.x,$.y,0,b.EXTENT),G.emplaceBack(W.x,W.y,b.EXTENT,b.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(G,b.boundsAttributes.members),this.boundsSegments=b.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const h=this.map.painter.context,_=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new b.Texture(h,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,_){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},_(null)):(h.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const re={vector:ct,raster:pt,"raster-dem":class extends pt{constructor(S,h,_,P){super(S,h,_,P),this.type="raster-dem",this.maxzoom=22,this._options=b.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(S,h){const _=this.map._requestManager.normalizeTileURL(S.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function P(V,W){V&&(S.state="errored",h(V)),W&&(S.dem=W,S.dem.onDeserialize(),S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0,S.state="loaded",h(null))}S.request=b.getImage(this.map._requestManager.transformRequest(_,b.ResourceType.Tile),function(V,W,$,G){if(delete S.request,S.aborted)S.state="unloaded",h(null);else if(V)S.state="errored",h(V);else if(W){this.map._refreshExpiredTiles&&S.setExpiryData({cacheControl:$,expires:G});const tt=b.window.ImageBitmap&&W instanceof b.window.ImageBitmap&&(null==wt&&(wt=b.window.OffscreenCanvas&&new b.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof b.window.createImageBitmap),wt),ht=1-(W.width-b.prevPowerOfTwo(W.width))/2;ht<1||S.neighboringTiles||(S.neighboringTiles=this._getNeighboringTiles(S.tileID));const lt=tt?W:b.exported.getImageData(W,ht),bt={uid:S.uid,coord:S.tileID,source:this.id,rawImageData:lt,encoding:this.encoding,padding:ht};S.actor&&"expired"!==S.state||(S.actor=this.dispatcher.getActor(),S.actor.send("loadDEMTile",bt,P.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(S){const h=S.canonical,_=Math.pow(2,h.z),P=(h.x-1+_)%_,V=0===h.x?S.wrap-1:S.wrap,W=(h.x+1+_)%_,$=h.x+1===_?S.wrap+1:S.wrap,G={};return G[new b.OverscaledTileID(S.overscaledZ,V,h.z,P,h.y).key]={backfilled:!1},G[new b.OverscaledTileID(S.overscaledZ,$,h.z,W,h.y).key]={backfilled:!1},h.y>0&&(G[new b.OverscaledTileID(S.overscaledZ,V,h.z,P,h.y-1).key]={backfilled:!1},G[new b.OverscaledTileID(S.overscaledZ,S.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},G[new b.OverscaledTileID(S.overscaledZ,$,h.z,W,h.y-1).key]={backfilled:!1}),h.y+1<_&&(G[new b.OverscaledTileID(S.overscaledZ,V,h.z,P,h.y+1).key]={backfilled:!1},G[new b.OverscaledTileID(S.overscaledZ,S.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},G[new b.OverscaledTileID(S.overscaledZ,$,h.z,W,h.y+1).key]={backfilled:!1}),G}unloadTile(S){S.demTexture&&this.map.painter.saveTileTexture(S.demTexture),S.fbo&&(S.fbo.destroy(),delete S.fbo),S.dem&&delete S.dem,delete S.neighboringTiles,S.state="unloaded"}},geojson:class extends b.Evented{constructor(S,h,_,P){super(),this.id=S,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=_.getActor(),this.setEventedParent(P),this._data=h.data,this._options=b.extend({},h),this._collectResourceTiming=h.collectResourceTiming,void 0!==h.maxzoom&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const V=b.EXTENT/this.tileSize;this.workerOptions=b.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(void 0!==h.buffer?h.buffer:128)*V,tolerance:(void 0!==h.tolerance?h.tolerance:.375)*V,extent:b.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:void 0!==h.clusterMaxZoom?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:b.EXTENT,radius:(void 0!==h.clusterRadius?h.clusterRadius:50)*V,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(S){this.map=S,this.setData(this._data)}setData(S){return this._data=S,this._updateWorkerData(),this}getClusterExpansionZoom(S,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:S,source:this.id},h),this}getClusterChildren(S,h){return this.actor.send("geojson.getClusterChildren",{clusterId:S,source:this.id},h),this}getClusterLeaves(S,h,_,P){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:S,limit:h,offset:_},P),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new b.Event("dataloading",{dataType:"source"})),this._loaded=!1;const S=b.extend({},this.workerOptions),h=this._data;"string"==typeof h?(S.request=this.map._requestManager.transformRequest(b.exported.resolveURL(h),b.ResourceType.Source),S.request.collectResourceTiming=this._collectResourceTiming):S.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,S,(_,P)=>{if(this._loaded=!0,this._pendingLoad=null,_)this.fire(new b.ErrorEvent(_));else{const V={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&P&&P.resourceTiming&&P.resourceTiming[this.id]&&(V.resourceTiming=P.resourceTiming[this.id]),this.fire(new b.Event("data",V)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(S,h){const _=S.actor?"reloadTile":"loadTile";S.actor=this.actor,S.request=this.actor.send(_,{type:this.type,uid:S.uid,tileID:S.tileID,tileZoom:S.tileZoom,zoom:S.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:b.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(P,V)=>(delete S.request,S.unloadVectorData(),S.aborted?h(null):P?h(P):(S.loadVectorData(V,this.map.painter,"reloadTile"===_),h(null))),void 0,"loadTile"===_)}abortTile(S){S.request&&(S.request.cancel(),delete S.request),S.aborted=!0}unloadTile(S){S.unloadVectorData(),this.actor.send("removeTile",{uid:S.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return b.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Gt{constructor(S,h,_,P){super(S,h,_,P),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const S=this.options;this.urls=[];for(const h of S.urls)this.urls.push(this.map._requestManager.transformRequest(h,b.ResourceType.Source).url);b.getVideo(this.urls,(h,_)=>{this._loaded=!0,h?this.fire(new b.ErrorEvent(h)):_&&(this.video=_,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(S){if(this.video){const h=this.video.seekable;S<h.start(0)||S>h.end(0)?this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=S}}getVideo(){return this.video}onAdd(S){this.map||(this.map=S,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const S=this.map.painter.context,h=S.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new b.Texture(S,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(S)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Gt,canvas:class extends Gt{constructor(S,h,_,P){super(S,h,_,P),h.coordinates?Array.isArray(h.coordinates)&&4===h.coordinates.length&&!h.coordinates.some(V=>!Array.isArray(V)||2!==V.length||V.some(W=>"number"!=typeof W))||this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${S}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${S}`,null,'missing required property "coordinates"'))),h.animate&&"boolean"!=typeof h.animate&&this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${S}`,null,'optional "animate" property must be a boolean value'))),h.canvas?"string"==typeof h.canvas||h.canvas instanceof b.window.HTMLCanvasElement||this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${S}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new b.ErrorEvent(new b.ValidationError(`sources.${S}`,null,'missing required property "canvas"'))),this.options=h,this.animate=void 0===h.animate||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof b.window.HTMLCanvasElement?this.options.canvas:b.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new b.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(S){this.map=S,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let S=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,S=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,S=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const h=this.map.painter.context;this.texture?(S||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new b.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const S of[this.canvas.width,this.canvas.height])if(isNaN(S)||S<=0)return!0;return!1}},custom:class extends b.Evented{constructor(S,h,_,P){super(),this.id=S,this.type="custom",this._dataType="raster",this._dispatcher=_,this._implementation=h,this.setEventedParent(P),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new b.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new b.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Yt(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),b.extend(this,b.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return b.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new b.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new b.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(S){this._map=S,this._loaded=!1,this.fire(new b.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(S),this.load()}onRemove(S){this._implementation.onRemove&&this._implementation.onRemove(S)}hasTile(S){if(this._implementation.hasTile){const{x:h,y:_,z:P}=S.canonical;return this._implementation.hasTile({x:h,y:_,z:P})}return!this.tileBounds||this.tileBounds.contains(S.canonical)}loadTile(S,h){const{x:_,y:P,z:V}=S.tileID.canonical,W=new b.window.AbortController;S.request=Promise.resolve(this._implementation.loadTile({x:_,y:P,z:V},{signal:W.signal})).then(function($){return delete S.request,S.aborted?(S.state="unloaded",h(null)):void 0===$?(S.state="errored",h(null)):null===$?(this.loadTileData(S,{width:this.tileSize,height:this.tileSize,data:null}),S.state="loaded",h(null)):(G=$)instanceof b.window.ImageData||G instanceof b.window.HTMLCanvasElement||G instanceof b.window.ImageBitmap||G instanceof b.window.HTMLImageElement?(this.loadTileData(S,$),S.state="loaded",void h(null)):(S.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var G}.bind(this)).catch($=>{20!==$.code&&(S.state="errored",h($))}),S.request.cancel=()=>W.abort()}loadTileData(S,h){pt.loadTileData(S,h,this._map.painter)}unloadTileData(S){pt.unloadTileData(S,this._map.painter)}unloadTile(S,h){if(this.unloadTileData(S),this._implementation.unloadTile){const{x:_,y:P,z:V}=S.tileID.canonical;this._implementation.unloadTile({x:_,y:P,z:V})}h()}abortTile(S,h){S.request&&S.request.cancel&&(S.request.cancel(),delete S.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(S=>({x:S.canonical.x,y:S.canonical.y,z:S.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new b.Event("data",{dataType:"source",sourceDataType:"content"}))}}},te=function(S,h,_,P){const V=new re[h.type](S,h,_,P);if(V.id!==S)throw new Error(`Expected Source id to be ${S} instead of ${V.id}`);return b.bindAll(["load","abort","unload","serialize","prepare"],V),V};function ie(S,h){const _=b.identity([]);return b.scale(_,_,[.5*S.width,.5*-S.height,1]),b.translate(_,_,[1,-1,0]),b.multiply(_,_,S.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(_)}function u(S,h,_,P,V,W,$,G=!1){const tt=S.tilesIn(P,$,G);tt.sort(g);const ht=[];for(const bt of tt)ht.push({wrappedTileID:bt.tile.tileID.wrapped().key,queryResults:bt.tile.queryRenderedFeatures(h,_,S._state,bt,V,W,ie(S.transform,bt.tile.tileID),G)});const lt=function(bt){const Dt={},Bt={};for(const Nt of bt){const Ot=Nt.queryResults,zt=Nt.wrappedTileID,At=Bt[zt]=Bt[zt]||{};for(const Qt in Ot){const Jt=Ot[Qt],ne=At[Qt]=At[Qt]||{},me=Dt[Qt]=Dt[Qt]||[];for(const ue of Jt)ne[ue.featureIndex]||(ne[ue.featureIndex]=!0,me.push(ue))}}return Dt}(ht);for(const bt in lt)lt[bt].forEach(Dt=>{const Bt=Dt.feature,Nt=Bt.layer;Nt&&"background"!==Nt.type&&"sky"!==Nt.type&&(Bt.source=Nt.source,Nt["source-layer"]&&(Bt.sourceLayer=Nt["source-layer"]),Bt.state=void 0!==Bt.id?S.getFeatureState(Nt["source-layer"],Bt.id):{})});return lt}function I(S,h){const _=S.getRenderableIds().map(W=>S.getTileByID(W)),P=[],V={};for(let W=0;W<_.length;W++){const $=_[W],G=$.tileID.canonical.key;V[G]||(V[G]=!0,$.querySourceFeatures(P,h))}return P}function g(S,h){const _=S.tileID,P=h.tileID;return _.overscaledZ-P.overscaledZ||_.canonical.y-P.canonical.y||_.wrap-P.wrap||_.canonical.x-P.canonical.x}function x(){return null!=zc.workerClass?new zc.workerClass:new b.window.Worker(zc.workerUrl)}const w="mapboxgl_preloaded_worker_pool";class D{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<D.workerCount;)this.workers.push(new x);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],0===this.numActive()&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[w]}numActive(){return Object.keys(this.active).length}}let o;function y(){return o||(o=new D),o}function f(S,h){const _={};for(const P in S)"ref"!==P&&(_[P]=S[P]);return b.refProperties.forEach(P=>{P in h&&(_[P]=h[P])}),_}function c(S){S=S.slice();const h=Object.create(null);for(let _=0;_<S.length;_++)h[S[_].id]=S[_];for(let _=0;_<S.length;_++)"ref"in S[_]&&(S[_]=f(S[_],h[S[_].ref]));return S}D.workerCount=2;const d={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function M(S,h,_){_.push({command:d.addSource,args:[S,h[S]]})}function k(S,h,_){h.push({command:d.removeSource,args:[S]}),_[S]=!0}function C(S,h,_,P){k(S,_,P),M(S,h,_)}function R(S,h,_){let P;for(P in S[_])if(S[_].hasOwnProperty(P)&&"data"!==P&&!De(S[_][P],h[_][P]))return!1;for(P in h[_])if(h[_].hasOwnProperty(P)&&"data"!==P&&!De(S[_][P],h[_][P]))return!1;return!0}function B(S,h,_,P,V,W){let $;for($ in h=h||{},S=S||{})S.hasOwnProperty($)&&(De(S[$],h[$])||_.push({command:W,args:[P,$,h[$],V]}));for($ in h)h.hasOwnProperty($)&&!S.hasOwnProperty($)&&(De(S[$],h[$])||_.push({command:W,args:[P,$,h[$],V]}))}function O(S){return S.id}function L(S,h){return S[h.id]=h,S}class X{constructor(h,_){this.reset(h,_)}reset(h,_){this.points=h||[],this._distances=[0];for(let P=1;P<this.points.length;P++)this._distances[P]=this._distances[P-1]+this.points[P].dist(this.points[P-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(1===this.points.length)return this.points[0];h=b.clamp(h,0,1);let _=1,P=this._distances[_];const V=h*this.paddedLength+this.padding;for(;P<V&&_<this._distances.length;)P=this._distances[++_];const W=_-1,$=this._distances[W],G=P-$,tt=G>0?(V-$)/G:0;return this.points[W].mult(1-tt).add(this.points[_].mult(tt))}}class E{constructor(h,_,P){const V=this.boxCells=[],W=this.circleCells=[];this.xCellCount=Math.ceil(h/P),this.yCellCount=Math.ceil(_/P);for(let $=0;$<this.xCellCount*this.yCellCount;$++)V.push([]),W.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=_,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,_,P,V,W){this._forEachCell(_,P,V,W,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(_),this.bboxes.push(P),this.bboxes.push(V),this.bboxes.push(W)}insertCircle(h,_,P,V){this._forEachCell(_-V,P-V,_+V,P+V,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(_),this.circles.push(P),this.circles.push(V)}_insertBoxCell(h,_,P,V,W,$){this.boxCells[W].push($)}_insertCircleCell(h,_,P,V,W,$){this.circleCells[W].push($)}_query(h,_,P,V,W,$){if(P<0||h>this.width||V<0||_>this.height)return!W&&[];const G=[];if(h<=0&&_<=0&&this.width<=P&&this.height<=V){if(W)return!0;for(let tt=0;tt<this.boxKeys.length;tt++)G.push({key:this.boxKeys[tt],x1:this.bboxes[4*tt],y1:this.bboxes[4*tt+1],x2:this.bboxes[4*tt+2],y2:this.bboxes[4*tt+3]});for(let tt=0;tt<this.circleKeys.length;tt++){const ht=this.circles[3*tt],lt=this.circles[3*tt+1],bt=this.circles[3*tt+2];G.push({key:this.circleKeys[tt],x1:ht-bt,y1:lt-bt,x2:ht+bt,y2:lt+bt})}return $?G.filter($):G}return this._forEachCell(h,_,P,V,this._queryCell,G,{hitTest:W,seenUids:{box:{},circle:{}}},$),W?G.length>0:G}_queryCircle(h,_,P,V,W){const $=h-P,G=h+P,tt=_-P,ht=_+P;if(G<0||$>this.width||ht<0||tt>this.height)return!V&&[];const lt=[];return this._forEachCell($,tt,G,ht,this._queryCellCircle,lt,{hitTest:V,circle:{x:h,y:_,radius:P},seenUids:{box:{},circle:{}}},W),V?lt.length>0:lt}query(h,_,P,V,W){return this._query(h,_,P,V,!1,W)}hitTest(h,_,P,V,W){return this._query(h,_,P,V,!0,W)}hitTestCircle(h,_,P,V){return this._queryCircle(h,_,P,!0,V)}_queryCell(h,_,P,V,W,$,G,tt){const ht=G.seenUids,lt=this.boxCells[W];if(null!==lt){const Dt=this.bboxes;for(const Bt of lt)if(!ht.box[Bt]){ht.box[Bt]=!0;const Nt=4*Bt;if(h<=Dt[Nt+2]&&_<=Dt[Nt+3]&&P>=Dt[Nt+0]&&V>=Dt[Nt+1]&&(!tt||tt(this.boxKeys[Bt]))){if(G.hitTest)return $.push(!0),!0;$.push({key:this.boxKeys[Bt],x1:Dt[Nt],y1:Dt[Nt+1],x2:Dt[Nt+2],y2:Dt[Nt+3]})}}}const bt=this.circleCells[W];if(null!==bt){const Dt=this.circles;for(const Bt of bt)if(!ht.circle[Bt]){ht.circle[Bt]=!0;const Nt=3*Bt;if(this._circleAndRectCollide(Dt[Nt],Dt[Nt+1],Dt[Nt+2],h,_,P,V)&&(!tt||tt(this.circleKeys[Bt]))){if(G.hitTest)return $.push(!0),!0;{const Ot=Dt[Nt],zt=Dt[Nt+1],At=Dt[Nt+2];$.push({key:this.circleKeys[Bt],x1:Ot-At,y1:zt-At,x2:Ot+At,y2:zt+At})}}}}}_queryCellCircle(h,_,P,V,W,$,G,tt){const ht=G.circle,lt=G.seenUids,bt=this.boxCells[W];if(null!==bt){const Bt=this.bboxes;for(const Nt of bt)if(!lt.box[Nt]){lt.box[Nt]=!0;const Ot=4*Nt;if(this._circleAndRectCollide(ht.x,ht.y,ht.radius,Bt[Ot+0],Bt[Ot+1],Bt[Ot+2],Bt[Ot+3])&&(!tt||tt(this.boxKeys[Nt])))return $.push(!0),!0}}const Dt=this.circleCells[W];if(null!==Dt){const Bt=this.circles;for(const Nt of Dt)if(!lt.circle[Nt]){lt.circle[Nt]=!0;const Ot=3*Nt;if(this._circlesCollide(Bt[Ot],Bt[Ot+1],Bt[Ot+2],ht.x,ht.y,ht.radius)&&(!tt||tt(this.circleKeys[Nt])))return $.push(!0),!0}}}_forEachCell(h,_,P,V,W,$,G,tt){const ht=this._convertToXCellCoord(h),lt=this._convertToYCellCoord(_),bt=this._convertToXCellCoord(P),Dt=this._convertToYCellCoord(V);for(let Bt=ht;Bt<=bt;Bt++)for(let Nt=lt;Nt<=Dt;Nt++)if(W.call(this,h,_,P,V,this.xCellCount*Nt+Bt,$,G,tt))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,_,P,V,W,$){const G=V-h,tt=W-_,ht=P+$;return ht*ht>G*G+tt*tt}_circleAndRectCollide(h,_,P,V,W,$,G){const tt=($-V)/2,ht=Math.abs(h-(V+tt));if(ht>tt+P)return!1;const lt=(G-W)/2,bt=Math.abs(_-(W+lt));if(bt>lt+P)return!1;if(ht<=tt||bt<=lt)return!0;const Dt=ht-tt,Bt=bt-lt;return Dt*Dt+Bt*Bt<=P*P}}const Y=Math.tan(85*Math.PI/180);function it(S,h,_,P,V,W,$){const G=b.create();if(_)if("globe"===W.name){const tt=b.calculateGlobeLabelMatrix(V,h);b.multiply(G,G,tt)}else{const tt=Xi([],$);G[0]=tt[0],G[1]=tt[1],G[4]=tt[2],G[5]=tt[3],P||b.rotateZ(G,G,V.angle)}else b.multiply(G,V.labelPlaneMatrix,S);return G}function J(S,h,_,P,V,W,$){const G=it(S,h,_,P,V,W,$);return"globe"===W.name&&_||(G[2]=G[6]=G[10]=G[14]=0),G}function q(S,h,_,P,V,W,$){if(_){if("globe"===W.name){const G=it(S,h,_,P,V,W,$);return b.invert(G,G),b.multiply(G,S,G),G}{const G=b.clone(S),tt=b.identity([]);return tt[0]=$[0],tt[1]=$[1],tt[4]=$[2],tt[5]=$[3],b.multiply(G,G,tt),P||b.rotateZ(G,G,-V.angle),G}}return V.glCoordMatrix}function nt(S,h,_,P){const V=[S,h,_,1];_?b.transformMat4$1(V,V,P):jt(V,V,P);const W=V[3];return V[0]/=W,V[1]/=W,V[2]/=W,V}function dt(S,h){return Math.min(.5+S/h*.5,1.5)}function gt(S,h){const _=S[0]/S[3],P=S[1]/S[3];return _>=-h[0]&&_<=h[0]&&P>=-h[1]&&P<=h[1]}function kt(S,h,_,P,V,W,$,G,tt,ht){const lt=_.transform,bt=P?S.textSizeData:S.iconSizeData,Dt=b.evaluateSizeForZoom(bt,_.transform.zoom),Bt="globe"===lt.projection.name,Nt=[256/_.width*2+1,256/_.height*2+1],Ot=P?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;Ot.clear();let zt=null;Bt&&(zt=P?S.text.globeExtVertexArray:S.icon.globeExtVertexArray);const At=S.lineVertexArray,Qt=P?S.text.placedSymbolArray:S.icon.placedSymbolArray,Jt=_.transform.width/_.transform.height;let ne,me=!1;for(let ue=0;ue<Qt.length;ue++){const ge=Qt.get(ue),{numGlyphs:be,writingMode:Pe}=ge;if(Pe!==b.WritingMode.vertical||me||ne===b.WritingMode.horizontal||(me=!0),ne=Pe,(ge.hidden||Pe===b.WritingMode.vertical)&&!me){Ht(be,Ot);continue}me=!1;const Ie=new b.pointGeometry(ge.tileAnchorX,ge.tileAnchorY);let{x:yi,y:Se,z:Je}=lt.projection.projectTilePoint(Ie.x,Ie.y,ht.canonical);if(tt){const[Xn,Gi,Fi]=tt(Ie);yi+=Xn,Se+=Gi,Je+=Fi}const Ve=[yi,Se,Je,1];if(b.transformMat4$1(Ve,Ve,h),!gt(Ve,Nt)){Ht(be,Ot);continue}const ti=dt(_.transform.cameraToCenterDistance,Ve[3]),Fe=b.evaluateSizeForFeature(bt,Dt,ge),we=$?Fe/ti:Fe*ti,Be=nt(yi,Se,Je,V);if(Be[3]<=0){Ht(be,Ot);continue}let ei={};const ci=$?null:tt,qi=ee(ge,we,!1,G,h,V,W,S.glyphOffsetArray,At,Ot,zt,Be,Ie,ei,Jt,ci,lt.projection,ht,$);me=qi.useVertical,ci&&qi.needsFlipping&&(ei={}),(qi.notEnoughRoom||me||qi.needsFlipping&&ee(ge,we,!0,G,h,V,W,S.glyphOffsetArray,At,Ot,zt,Be,Ie,ei,Jt,ci,lt.projection,ht,$).notEnoughRoom)&&Ht(be,Ot)}P?(S.text.dynamicLayoutVertexBuffer.updateData(Ot),zt&&S.text.globeExtVertexBuffer.updateData(zt)):(S.icon.dynamicLayoutVertexBuffer.updateData(Ot),zt&&S.icon.globeExtVertexBuffer.updateData(zt))}function mt(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot){const{lineStartIndex:zt,glyphStartIndex:At,segment:Qt}=G,Jt=At+G.numGlyphs,ne=zt+G.lineLength,me=h.getoffsetX(At),ue=h.getoffsetX(Jt-1),ge=le(S*me,_,P,V,W,$,Qt,zt,ne,tt,ht,lt,bt,Dt,!0,Bt,Nt,Ot);if(!ge)return null;const be=le(S*ue,_,P,V,W,$,Qt,zt,ne,tt,ht,lt,bt,Dt,!0,Bt,Nt,Ot);return be?{first:ge,last:be}:null}function Tt(S,h,_,P){return S===b.WritingMode.horizontal&&Math.abs(P)>Math.abs(_)?{useVertical:!0}:S===b.WritingMode.vertical?P>0?{needsFlipping:!0}:null:0!==h&&(0===(V=_)||Math.abs(P/V)>Y)?1===h?{needsFlipping:!0}:null:_<0?{needsFlipping:!0}:null;var V}function ee(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt,At,Qt){const Jt=h/24,ne=S.lineOffsetX*Jt,me=S.lineOffsetY*Jt,{lineStartIndex:ue,glyphStartIndex:ge,numGlyphs:be,segment:Pe,writingMode:Ie,flipState:yi}=S,Se=ue+S.lineLength,Je=Ve=>{if(lt){const[Be,ei,ci]=Ve.up,qi=ht.length;b.updateGlobeVertexNormal(lt,qi+0,Be,ei,ci),b.updateGlobeVertexNormal(lt,qi+1,Be,ei,ci),b.updateGlobeVertexNormal(lt,qi+2,Be,ei,ci),b.updateGlobeVertexNormal(lt,qi+3,Be,ei,ci)}const[ti,Fe,we]=Ve.point;b.addDynamicAttributes(ht,ti,Fe,we,Ve.angle)};if(be>1){const Ve=mt(Jt,G,ne,me,_,bt,Dt,S,tt,W,Bt,Ot,!1,zt,At,Qt);if(!Ve)return{notEnoughRoom:!0};if(P&&!_){let[ti,Fe,we]=Ve.first.point,[Be,ei,ci]=Ve.last.point;[ti,Fe]=nt(ti,Fe,we,$),[Be,ei]=nt(Be,ei,ci,$);const qi=Tt(Ie,yi,(Be-ti)*Nt,ei-Fe);if(S.flipState=qi&&qi.needsFlipping?1:2,qi)return qi}Je(Ve.first);for(let ti=ge+1;ti<ge+be-1;ti++){const Fe=le(Jt*G.getoffsetX(ti),ne,me,_,bt,Dt,Pe,ue,Se,tt,W,Bt,Ot,!1,!1,zt,At,Qt);if(!Fe)return ht.length-=4*(ti-ge),{notEnoughRoom:!0};Je(Fe)}Je(Ve.last)}else{if(P&&!_){const ti=nt(Dt.x,Dt.y,0,V),Fe=ue+Pe+1,we=new b.pointGeometry(tt.getx(Fe),tt.gety(Fe)),Be=nt(we.x,we.y,0,V),ei=Be[3]>0?Be:vt(Dt,we,ti,1,V,void 0,zt,At.canonical),ci=Tt(Ie,yi,(ei[0]-ti[0])*Nt,ei[1]-ti[1]);if(S.flipState=ci&&ci.needsFlipping?1:2,ci)return ci}const Ve=le(Jt*G.getoffsetX(ge),ne,me,_,bt,Dt,Pe,ue,Se,tt,W,Bt,Ot,!1,!1,zt,At,Qt);if(!Ve)return{notEnoughRoom:!0};Je(Ve)}return{}}function Ft(S,h,_,P,V){const{x:W,y:$,z:G}=P.projectTilePoint(S.x,S.y,h);if(!V)return nt(W,$,G,_);const[tt,ht,lt]=V(S);return nt(W+tt,$+ht,G+lt,_)}function vt(S,h,_,P,V,W,$,G){const tt=Ft(S.sub(h)._unit()._add(S),G,V,$,W);return b.sub(tt,_,tt),b.normalize(tt,tt),b.scaleAndAdd(tt,_,tt,P)}function le(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt,At){const Qt=P?S-h:S+h;let Jt=Qt>0?1:-1,ne=0;P&&(Jt*=-1,ne=Math.PI),Jt<0&&(ne+=Math.PI);let me=G+$+(Jt>0?0:1)|0,ue=V,ge=V,be=0,Pe=0;const Ie=Math.abs(Qt),yi=[],Se=[];let Je=W,Ve=Je;const ti=()=>vt(Ve,Je,ge,Ie-be+1,lt,Dt,Ot,zt.canonical);for(;be+Pe<=Ie;){if(me+=Jt,me<G||me>=tt)return null;if(ge=ue,Ve=Je,yi.push(ge),Bt&&Se.push(Ve),Je=new b.pointGeometry(ht.getx(me),ht.gety(me)),ue=bt[me],!ue){const Fi=Ft(Je,zt.canonical,lt,Ot,Dt);ue=Fi[3]>0?bt[me]=Fi:ti()}be+=Pe,Pe=b.distance(ge,ue)}Nt&&Dt&&(bt[me]&&(ue=ti(),Pe=b.distance(ge,ue)),bt[me]=ue);const Fe=(Ie-be)/Pe,we=Je.sub(Ve)._mult(Fe)._add(Ve),Be=b.sub([],ue,ge),ei=b.scaleAndAdd([],ge,Be,Fe);let ci=[0,0,1],qi=Be[0],Xn=Be[1];if(At&&(ci=Ot.upVector(zt.canonical,we.x,we.y),0!==ci[0]||0!==ci[1]||1!==ci[2])){const Fi=[ci[2],0,-ci[0]],nn=b.cross([],ci,Fi);b.normalize(Fi,Fi),b.normalize(nn,nn),qi=b.dot(Be,Fi),Xn=b.dot(Be,nn)}if(_){const Fi=b.cross([],ci,Be);b.normalize(Fi,Fi),b.scaleAndAdd(ei,ei,Fi,_*Jt)}const Gi=ne+Math.atan2(Xn,qi);return yi.push(ei),Bt&&Se.push(we),{point:ei,angle:Gi,path:yi,tilePath:Se,up:ci}}function Ht(S,h){const _=h.length,P=_+4*S;h.resize(P),h.float32.fill(-1/0,4*_,4*P)}function jt(S,h,_){const P=h[0],V=h[1];return S[0]=_[0]*P+_[4]*V+_[12],S[1]=_[1]*P+_[5]*V+_[13],S[3]=_[3]*P+_[7]*V+_[15],S}const ye=100;class Rt{constructor(h,_,P=new E(h.width+200,h.height+200,25),V=new E(h.width+200,h.height+200,25)){this.transform=h,this.grid=P,this.ignoredGrid=V,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+ye,this.screenBottomBoundary=h.height+ye,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=_}placeCollisionBox(h,_,P,V,W,$,G,tt){let ht=P.projectedAnchorX,lt=P.projectedAnchorY,bt=P.projectedAnchorZ;const Dt=P.elevation,Bt=P.tileID,Nt=h.getProjection();if(Dt&&Bt){const[ue,ge,be]=Nt.upVector(Bt.canonical,P.tileAnchorX,P.tileAnchorY),Pe=Nt.upVectorScale(Bt.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ht+=ue*Dt*Pe,lt+=ge*Dt*Pe,bt+=be*Dt*Pe}const Ot=this.projectAndGetPerspectiveRatio(G,ht,lt,bt,P.tileID,"globe"===Nt.name||!!Dt||this.transform.pitch>0,Nt),zt=$*Ot.perspectiveRatio,At=(P.x1*_+V.x-P.padding)*zt+Ot.point.x,Qt=(P.y1*_+V.y-P.padding)*zt+Ot.point.y,Jt=(P.x2*_+V.x+P.padding)*zt+Ot.point.x,ne=(P.y2*_+V.y+P.padding)*zt+Ot.point.y,me=Ot.perspectiveRatio<=.55||Ot.occluded;return!this.isInsideGrid(At,Qt,Jt,ne)||!W&&this.grid.hitTest(At,Qt,Jt,ne,tt)||me?{box:[],offscreen:!1,occluded:Ot.occluded}:{box:[At,Qt,Jt,ne],offscreen:this.isOffscreen(At,Qt,Jt,ne),occluded:!1}}placeCollisionCircles(h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot){const zt=[],At=this.transform.elevation,Qt=h.getProjection(),Jt=At?At.getAtTileOffsetFunc(Ot,this.transform.center.lat,this.transform.worldSize,Qt):null,ne=new b.pointGeometry(P.tileAnchorX,P.tileAnchorY);let{x:me,y:ue,z:ge}=Qt.projectTilePoint(ne.x,ne.y,Ot.canonical);if(Jt){const[we,Be,ei]=Jt(ne);me+=we,ue+=Be,ge+=ei}const be="globe"===Qt.name,Pe=this.projectAndGetPerspectiveRatio(G,me,ue,ge,Ot,be||!!At||this.transform.pitch>0,Qt),{perspectiveRatio:Ie}=Pe,yi=(bt?$/Ie:$*Ie)/b.ONE_EM,Se=nt(me,ue,ge,tt),Je=Pe.signedDistanceFromCamera>0?mt(yi,W,P.lineOffsetX*yi,P.lineOffsetY*yi,!1,Se,ne,P,V,tt,{},At&&!bt?Jt:null,bt&&!!At,Qt,Ot,bt):null;let Ve=!1,ti=!1,Fe=!0;if(Je&&!Pe.occluded){const we=.5*Bt*Ie+Nt,Be=new b.pointGeometry(-100,-100),ei=new b.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ci=new X,{first:qi,last:Xn}=Je,Gi=qi.path.length;let Fi=[];for(let sn=Gi-1;sn>=1;sn--)Fi.push(qi.path[sn]);for(let sn=1;sn<Xn.path.length;sn++)Fi.push(Xn.path[sn]);const nn=2.5*we;ht&&(Fi=Fi.map(([sn,fs,vs],Ds)=>(Jt&&!be&&(vs=Jt(Ds<Gi-1?qi.tilePath[Gi-1-Ds]:Xn.tilePath[Ds-Gi+2])[2]),nt(sn,fs,vs,ht))),Fi.some(sn=>sn[3]<=0)&&(Fi=[]));let Kn=[];if(Fi.length>0){let sn=1/0,fs=-1/0,vs=1/0,Ds=-1/0;for(const Ns of Fi)sn=Math.min(sn,Ns[0]),vs=Math.min(vs,Ns[1]),fs=Math.max(fs,Ns[0]),Ds=Math.max(Ds,Ns[1]);fs>=Be.x&&sn<=ei.x&&Ds>=Be.y&&vs<=ei.y&&(Kn=[Fi.map(Ns=>new b.pointGeometry(Ns[0],Ns[1]))],(sn<Be.x||fs>ei.x||vs<Be.y||Ds>ei.y)&&(Kn=b.clipLine(Kn,Be.x,Be.y,ei.x,ei.y)))}for(const sn of Kn){ci.reset(sn,.25*we);let fs=0;fs=ci.length<=.5*we?1:Math.ceil(ci.paddedLength/nn)+1;for(let vs=0;vs<fs;vs++){const Ds=vs/Math.max(fs-1,1),Ns=ci.lerp(Ds),bo=Ns.x+ye,xr=Ns.y+ye;zt.push(bo,xr,we,0);const zr=bo-we,Tl=xr-we,qs=bo+we,Bs=xr+we;if(Fe=Fe&&this.isOffscreen(zr,Tl,qs,Bs),ti=ti||this.isInsideGrid(zr,Tl,qs,Bs),!_&&this.grid.hitTestCircle(bo,xr,we,Dt)&&(Ve=!0,!lt))return{circles:[],offscreen:!1,collisionDetected:Ve,occluded:!1}}}}return{circles:!lt&&Ve||!ti?[]:zt,offscreen:Fe,collisionDetected:Ve,occluded:Pe.occluded}}queryRenderedSymbols(h){if(0===h.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const _=[];let P=1/0,V=1/0,W=-1/0,$=-1/0;for(const lt of h){const bt=new b.pointGeometry(lt.x+ye,lt.y+ye);P=Math.min(P,bt.x),V=Math.min(V,bt.y),W=Math.max(W,bt.x),$=Math.max($,bt.y),_.push(bt)}const G=this.grid.query(P,V,W,$).concat(this.ignoredGrid.query(P,V,W,$)),tt={},ht={};for(const lt of G){const bt=lt.key;if(void 0===tt[bt.bucketInstanceId]&&(tt[bt.bucketInstanceId]={}),tt[bt.bucketInstanceId][bt.featureIndex])continue;const Dt=[new b.pointGeometry(lt.x1,lt.y1),new b.pointGeometry(lt.x2,lt.y1),new b.pointGeometry(lt.x2,lt.y2),new b.pointGeometry(lt.x1,lt.y2)];b.polygonIntersectsPolygon(_,Dt)&&(tt[bt.bucketInstanceId][bt.featureIndex]=!0,void 0===ht[bt.bucketInstanceId]&&(ht[bt.bucketInstanceId]=[]),ht[bt.bucketInstanceId].push(bt.featureIndex))}return ht}insertCollisionBox(h,_,P,V,W){(_?this.ignoredGrid:this.grid).insert({bucketInstanceId:P,featureIndex:V,collisionGroupID:W},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,_,P,V,W){const $=_?this.ignoredGrid:this.grid,G={bucketInstanceId:P,featureIndex:V,collisionGroupID:W};for(let tt=0;tt<h.length;tt+=4)$.insertCircle(G,h[tt],h[tt+1],h[tt+2])}projectAndGetPerspectiveRatio(h,_,P,V,W,$,G){const tt=[_,P,V,1];let ht=!1;V||this.transform.pitch>0?(b.transformMat4$1(tt,tt,h),this.fogState&&W&&"globe"!==G.name&&(ht=function(Bt,Nt,Ot,zt,At,Qt){const Jt=Qt.calculateFogTileMatrix(At),ne=[Nt,Ot,zt];return b.transformMat4(ne,ne,Jt),Us(Bt,ne,Qt.pitch,Qt._fov)}(this.fogState,_,P,V,W.toUnwrapped(),this.transform)>.9)):jt(tt,tt,h);const lt=tt[3];return{point:new b.pointGeometry((tt[0]/lt+1)/2*this.transform.width+ye,(-tt[1]/lt+1)/2*this.transform.height+ye),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(G)/lt*.5,1.5),signedDistanceFromCamera:lt,occluded:$&&tt[2]>lt||ht}}isOffscreen(h,_,P,V){return P<ye||h>=this.screenRightBoundary||V<ye||_>this.screenBottomBoundary}isInsideGrid(h,_,P,V){return P>=0&&h<this.gridRightBoundary&&V>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const h=b.identity([]);return b.translate(h,h,[-100,-100,0]),h}}function se(S,h,_){const P=h.createTileMatrix(S,S.worldSize,_.toUnwrapped());return b.multiply(new Float32Array(16),S.projMatrix,P)}function Ue(S,h,_){if(h.projection.name===_.projection.name)return S.projMatrix;const P=_.clone();return P.setProjection(h.projection),se(P,h.getProjection(),S)}function ni(S,h,_){return h.name===_.projection.name?S.projMatrix:se(_,h,S)}class li{constructor(h,_,P,V){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?_:-_))):V&&P?1:0,this.placed=P}isHidden(){return 0===this.opacity&&!this.placed}}class $i{constructor(h,_,P,V,W,$=!1){this.text=new li(h?h.text:null,_,P,W),this.icon=new li(h?h.icon:null,_,V,W),this.clipped=$}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wi{constructor(h,_,P,V=!1){this.text=h,this.icon=_,this.skipFade=P,this.clipped=V}}class wn{constructor(){this.invProjMatrix=b.create(),this.viewportMatrix=b.create(),this.circles=[]}}class Ni{constructor(h,_,P,V,W){this.bucketInstanceId=h,this.featureIndex=_,this.sourceLayerIndex=P,this.bucketIndex=V,this.tileID=W}}class ji{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const _=++this.maxGroupID;this.collisionGroups[h]={ID:_,predicate:P=>P.collisionGroupID===_}}return this.collisionGroups[h]}}function _e(S,h,_,P,V){const{horizontalAlign:W,verticalAlign:$}=b.getAnchorAlignment(S),G=-(W-.5)*h,tt=-($-.5)*_,ht=b.evaluateVariableOffset(S,P);return new b.pointGeometry(G+ht[0]*V,tt+ht[1]*V)}function os(S,h,_,P,V){const W=new b.pointGeometry(S,h);return _&&W._rotate(P?V:-V),W}class yn{constructor(h,_,P,V,W){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new Rt(this.transform,W),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=_,this.retainedQueryData={},this.collisionGroups=new ji(P),this.collisionCircleArrays={},this.prevPlacement=V,V&&(V.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,_,P,V){const W=P.getBucket(_),$=P.latestFeatureIndex;if(!W||!$||_.id!==W.layerIds[0])return;const G=W.layers[0].layout,tt=P.collisionBoxArray,ht=Math.pow(2,this.transform.zoom-P.tileID.overscaledZ),lt=P.tileSize/b.EXTENT,bt=P.tileID.toUnwrapped();this.transform.setProjection(W.projection);const Dt=(Bt=P.tileID,Nt=W.getProjection(),Ot=this.transform,Nt.name===this.projection?Ot.calculateProjMatrix(Bt.toUnwrapped()):se(Ot,Nt,Bt));var Bt,Nt,Ot;const zt="map"===G.get("text-pitch-alignment"),At="map"===G.get("text-rotation-alignment");_.compileFilter();const Qt=_.dynamicFilter(),Jt=_.dynamicFilterNeedsFeature(),ne=this.transform.calculatePixelsToTileUnitsMatrix(P),me=J(Dt,P.tileID.canonical,zt,At,this.transform,W.getProjection(),ne);let ue=null;if(zt){const Pe=q(Dt,P.tileID.canonical,zt,At,this.transform,W.getProjection(),ne);ue=b.multiply([],this.transform.labelPlaneMatrix,Pe)}let ge=null;Qt&&P.latestFeatureIndex&&(ge={unwrappedTileID:bt,dynamicFilter:Qt,dynamicFilterNeedsFeature:Jt,featureIndex:P.latestFeatureIndex}),this.retainedQueryData[W.bucketInstanceId]=new Ni(W.bucketInstanceId,$,W.sourceLayerIndex,W.index,P.tileID);const be={bucket:W,layout:G,posMatrix:Dt,textLabelPlaneMatrix:me,labelToScreenMatrix:ue,clippingData:ge,scale:ht,textPixelRatio:lt,holdingForFade:P.holdingForFade(),collisionBoxArray:tt,partiallyEvaluatedTextSize:b.evaluateSizeForZoom(W.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:b.evaluateSizeForZoom(W.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(W.sourceID)};if(V)for(const Pe of W.sortKeyRanges){const{sortKey:Ie,symbolInstanceStart:yi,symbolInstanceEnd:Se}=Pe;h.push({sortKey:Ie,symbolInstanceStart:yi,symbolInstanceEnd:Se,parameters:be})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:W.symbolInstances.length,parameters:be})}attemptAnchorPlacement(h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt,At,Qt){const{textOffset0:Jt,textOffset1:ne,crossTileID:me}=Dt,ue=[Jt,ne],ge=_e(h,P,V,ue,W),be=this.collisionIndex.placeCollisionBox(Nt,W,_,os(ge.x,ge.y,$,G,this.transform.angle),bt,tt,ht,lt.predicate);if(zt){const Pe=Nt.getSymbolInstanceIconSize(Qt,this.transform.zoom,Dt.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Nt,Pe,zt,os(ge.x,ge.y,$,G,this.transform.angle),bt,tt,ht,lt.predicate).box.length)return}if(be.box.length>0){let Pe;return this.prevPlacement&&this.prevPlacement.variableOffsets[me]&&this.prevPlacement.placements[me]&&this.prevPlacement.placements[me].text&&(Pe=this.prevPlacement.variableOffsets[me].anchor),this.variableOffsets[me]={textOffset:ue,width:P,height:V,anchor:h,textScale:W,prevAnchor:Pe},this.markUsedJustification(Nt,h,Dt,Ot),Nt.allowVerticalPlacement&&(this.markUsedOrientation(Nt,Ot,Dt),this.placedOrientations[me]=Ot),{shift:ge,placedGlyphBoxes:be}}}placeLayerBucketPart(h,_,P,V){const{bucket:W,layout:$,posMatrix:G,textLabelPlaneMatrix:tt,labelToScreenMatrix:ht,clippingData:lt,textPixelRatio:bt,holdingForFade:Dt,collisionBoxArray:Bt,partiallyEvaluatedTextSize:Nt,partiallyEvaluatedIconSize:Ot,collisionGroup:zt}=h.parameters,At=$.get("text-optional"),Qt=$.get("icon-optional"),Jt=$.get("text-allow-overlap"),ne=$.get("icon-allow-overlap"),me="map"===$.get("text-rotation-alignment"),ue="map"===$.get("text-pitch-alignment"),ge="none"!==$.get("icon-text-fit"),be="viewport-y"===$.get("symbol-z-order");this.transform.setProjection(W.projection);let Pe=Jt&&(ne||!W.hasIconData()||Qt),Ie=ne&&(Jt||!W.hasTextData()||At);!W.collisionArrays&&Bt&&W.deserializeCollisionBoxes(Bt),P&&V&&W.updateCollisionDebugBuffers(this.transform.zoom,Bt);const yi=(Se,Je,Ve)=>{const{crossTileID:ti,numVerticalGlyphVertices:Fe}=Se;if(lt){const qs={zoom:this.transform.zoom,pitch:this.transform.pitch};let Bs=null;if(lt.dynamicFilterNeedsFeature){const ds=this.retainedQueryData[W.bucketInstanceId];Bs=lt.featureIndex.loadFeature({featureIndex:Se.featureIndex,bucketIndex:ds.bucketIndex,sourceLayerIndex:ds.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,lt.dynamicFilter)(qs,Bs,this.retainedQueryData[W.bucketInstanceId].tileID.canonical,new b.pointGeometry(Se.tileAnchorX,Se.tileAnchorY),this.transform.calculateDistanceTileData(lt.unwrappedTileID)))return this.placements[ti]=new wi(!1,!1,!1,!0),void(_[ti]=!0)}if(_[ti])return;if(Dt)return void(this.placements[ti]=new wi(!1,!1,!1));let we=!1,Be=!1,ei=!0,ci=!1,qi=!1,Xn=null,Gi={box:null,offscreen:null,occluded:null},Fi={box:null,offscreen:null,occluded:null},nn=null,Kn=null,sn=null,fs=0,vs=0,Ds=0;Ve.textFeatureIndex?fs=Ve.textFeatureIndex:Se.useRuntimeCollisionCircles&&(fs=Se.featureIndex),Ve.verticalTextFeatureIndex&&(vs=Ve.verticalTextFeatureIndex);const Ns=qs=>{qs.tileID=this.retainedQueryData[W.bucketInstanceId].tileID;const Bs=this.transform.elevation;(Bs||qs.elevation)&&(qs.elevation=Bs?Bs.getAtTileOffset(qs.tileID,qs.tileAnchorX,qs.tileAnchorY):0)},bo=Ve.textBox;if(bo){Ns(bo);const qs=ds=>{let Is=b.WritingMode.horizontal;if(W.allowVerticalPlacement&&!ds&&this.prevPlacement){const yr=this.prevPlacement.placedOrientations[ti];yr&&(this.placedOrientations[ti]=yr,Is=yr,this.markUsedOrientation(W,Is,Se))}return Is},Bs=(ds,Is)=>{if(W.allowVerticalPlacement&&Fe>0&&Ve.verticalTextBox){for(const yr of W.writingModes)if(yr===b.WritingMode.vertical?(Gi=Is(),Fi=Gi):Gi=ds(),Gi&&Gi.box&&Gi.box.length)break}else Gi=ds()};if($.get("text-variable-anchor")){let ds=$.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ti]){const Os=this.prevPlacement.variableOffsets[ti];ds.indexOf(Os.anchor)>0&&(ds=ds.filter(Ho=>Ho!==Os.anchor),ds.unshift(Os.anchor))}const Is=(Os,Ho,ir)=>{const za=W.getSymbolInstanceTextSize(Nt,Se,this.transform.zoom,Je),Sl=(Os.x2-Os.x1)*za+2*Os.padding,Kr=(Os.y2-Os.y1)*za+2*Os.padding,Jr=ge&&!ne?Ho:null;Jr&&Ns(Jr);let Na={box:[],offscreen:!1,occluded:!1};const nl=Jt?2*ds.length:ds.length;for(let sl=0;sl<nl;++sl){const Vh=this.attemptAnchorPlacement(ds[sl%ds.length],Os,Sl,Kr,za,me,ue,bt,G,zt,sl>=ds.length,Se,Je,W,ir,Jr,Nt,Ot);if(Vh&&(Na=Vh.placedGlyphBoxes,Na&&Na.box&&Na.box.length)){we=!0,Xn=Vh.shift;break}}return Na};Bs(()=>Is(bo,Ve.iconBox,b.WritingMode.horizontal),()=>{const Os=Ve.verticalTextBox;return Os&&Ns(Os),W.allowVerticalPlacement&&!(Gi&&Gi.box&&Gi.box.length)&&Fe>0&&Os?Is(Os,Ve.verticalIconBox,b.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Gi&&(we=Gi.box,ei=Gi.offscreen,ci=Gi.occluded);const yr=qs(Gi&&Gi.box);if(!we&&this.prevPlacement){const Os=this.prevPlacement.variableOffsets[ti];Os&&(this.variableOffsets[ti]=Os,this.markUsedJustification(W,Os.anchor,Se,yr))}}else{const ds=(Is,yr)=>{const Os=W.getSymbolInstanceTextSize(Nt,Se,this.transform.zoom,Je),Ho=this.collisionIndex.placeCollisionBox(W,Os,Is,new b.pointGeometry(0,0),Jt,bt,G,zt.predicate);return Ho&&Ho.box&&Ho.box.length&&(this.markUsedOrientation(W,yr,Se),this.placedOrientations[ti]=yr),Ho};Bs(()=>ds(bo,b.WritingMode.horizontal),()=>{const Is=Ve.verticalTextBox;return W.allowVerticalPlacement&&Fe>0&&Is?(Ns(Is),ds(Is,b.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),qs(Gi&&Gi.box&&Gi.box.length)}}if(nn=Gi,we=nn&&nn.box&&nn.box.length>0,ei=nn&&nn.offscreen,ci=nn&&nn.occluded,Se.useRuntimeCollisionCircles){const qs=W.text.placedSymbolArray.get(Se.centerJustifiedTextSymbolIndex>=0?Se.centerJustifiedTextSymbolIndex:Se.verticalPlacedTextSymbolIndex),Bs=b.evaluateSizeForFeature(W.textSizeData,Nt,qs),ds=$.get("text-padding");Kn=this.collisionIndex.placeCollisionCircles(W,Jt,qs,W.lineVertexArray,W.glyphOffsetArray,Bs,G,tt,ht,P,ue,zt.predicate,Se.collisionCircleDiameter*Bs/b.ONE_EM,ds,this.retainedQueryData[W.bucketInstanceId].tileID),we=Jt||Kn.circles.length>0&&!Kn.collisionDetected,ei=ei&&Kn.offscreen,ci=Kn.occluded}if(Ve.iconFeatureIndex&&(Ds=Ve.iconFeatureIndex),Ve.iconBox){const qs=Bs=>{Ns(Bs);const ds=ge&&Xn?os(Xn.x,Xn.y,me,ue,this.transform.angle):new b.pointGeometry(0,0),Is=W.getSymbolInstanceIconSize(Ot,this.transform.zoom,Se.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(W,Is,Bs,ds,ne,bt,G,zt.predicate)};Fi&&Fi.box&&Fi.box.length&&Ve.verticalIconBox?(sn=qs(Ve.verticalIconBox),Be=sn.box.length>0):(sn=qs(Ve.iconBox),Be=sn.box.length>0),ei=ei&&sn.offscreen,qi=sn.occluded}const xr=At||0===Se.numHorizontalGlyphVertices&&0===Fe,zr=Qt||0===Se.numIconVertices;if(xr||zr?zr?xr||(Be=Be&&we):we=Be&&we:Be=we=Be&&we,we&&nn&&nn.box&&this.collisionIndex.insertCollisionBox(nn.box,$.get("text-ignore-placement"),W.bucketInstanceId,Fi&&Fi.box&&vs?vs:fs,zt.ID),Be&&sn&&this.collisionIndex.insertCollisionBox(sn.box,$.get("icon-ignore-placement"),W.bucketInstanceId,Ds,zt.ID),Kn&&(we&&this.collisionIndex.insertCollisionCircles(Kn.circles,$.get("text-ignore-placement"),W.bucketInstanceId,fs,zt.ID),P)){const qs=W.bucketInstanceId;let Bs=this.collisionCircleArrays[qs];void 0===Bs&&(Bs=this.collisionCircleArrays[qs]=new wn);for(let ds=0;ds<Kn.circles.length;ds+=4)Bs.circles.push(Kn.circles[ds+0]),Bs.circles.push(Kn.circles[ds+1]),Bs.circles.push(Kn.circles[ds+2]),Bs.circles.push(Kn.collisionDetected?1:0)}const Tl="globe"!==W.projection.name;Pe=Pe&&(Tl||!ci),Ie=Ie&&(Tl||!qi),this.placements[ti]=new wi(we||Pe,Be||Ie,ei||W.justReloaded),_[ti]=!0};if(be){const Se=W.getSortedSymbolIndexes(this.transform.angle);for(let Je=Se.length-1;Je>=0;--Je){const Ve=Se[Je];yi(W.symbolInstances.get(Ve),Ve,W.collisionArrays[Ve])}}else for(let Se=h.symbolInstanceStart;Se<h.symbolInstanceEnd;Se++)yi(W.symbolInstances.get(Se),Se,W.collisionArrays[Se]);if(P&&W.bucketInstanceId in this.collisionCircleArrays){const Se=this.collisionCircleArrays[W.bucketInstanceId];b.invert(Se.invProjMatrix,G),Se.viewportMatrix=this.collisionIndex.getViewportMatrix()}W.justReloaded=!1}markUsedJustification(h,_,P,V){const{leftJustifiedTextSymbolIndex:W,centerJustifiedTextSymbolIndex:$,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:tt,crossTileID:ht}=P,lt=b.getAnchorJustification(_),bt=V===b.WritingMode.vertical?tt:"left"===lt?W:"center"===lt?$:"right"===lt?G:-1;W>=0&&(h.text.placedSymbolArray.get(W).crossTileID=bt>=0&&W!==bt?0:ht),$>=0&&(h.text.placedSymbolArray.get($).crossTileID=bt>=0&&$!==bt?0:ht),G>=0&&(h.text.placedSymbolArray.get(G).crossTileID=bt>=0&&G!==bt?0:ht),tt>=0&&(h.text.placedSymbolArray.get(tt).crossTileID=bt>=0&&tt!==bt?0:ht)}markUsedOrientation(h,_,P){const V=_===b.WritingMode.horizontal||_===b.WritingMode.horizontalOnly?_:0,W=_===b.WritingMode.vertical?_:0,{leftJustifiedTextSymbolIndex:$,centerJustifiedTextSymbolIndex:G,rightJustifiedTextSymbolIndex:tt,verticalPlacedTextSymbolIndex:ht}=P,lt=h.text.placedSymbolArray;$>=0&&(lt.get($).placedOrientation=V),G>=0&&(lt.get(G).placedOrientation=V),tt>=0&&(lt.get(tt).placedOrientation=V),ht>=0&&(lt.get(ht).placedOrientation=W)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let P=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const V=_?_.symbolFadeChange(h):1,W=_?_.opacities:{},$=_?_.variableOffsets:{},G=_?_.placedOrientations:{};for(const tt in this.placements){const ht=this.placements[tt],lt=W[tt];lt?(this.opacities[tt]=new $i(lt,V,ht.text,ht.icon,null,ht.clipped),P=P||ht.text!==lt.text.placed||ht.icon!==lt.icon.placed):(this.opacities[tt]=new $i(null,V,ht.text,ht.icon,ht.skipFade,ht.clipped),P=P||ht.text||ht.icon)}for(const tt in W){const ht=W[tt];if(!this.opacities[tt]){const lt=new $i(ht,V,!1,!1);lt.isHidden()||(this.opacities[tt]=lt,P=P||ht.text.placed||ht.icon.placed)}}for(const tt in $)this.variableOffsets[tt]||!this.opacities[tt]||this.opacities[tt].isHidden()||(this.variableOffsets[tt]=$[tt]);for(const tt in G)this.placedOrientations[tt]||!this.opacities[tt]||this.opacities[tt].isHidden()||(this.placedOrientations[tt]=G[tt]);P?this.lastPlacementChangeTime=h:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:h)}updateLayerOpacities(h,_){const P={};for(const V of _){const W=V.getBucket(h);W&&V.latestFeatureIndex&&h.id===W.layerIds[0]&&this.updateBucketOpacities(W,P,V.collisionBoxArray)}}updateBucketOpacities(h,_,P){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const V=h.layers[0].layout,W=!!h.layers[0].dynamicFilter(),$=new $i(null,0,!1,!1,!0),G=V.get("text-allow-overlap"),tt=V.get("icon-allow-overlap"),ht=V.get("text-variable-anchor"),lt="map"===V.get("text-rotation-alignment"),bt="map"===V.get("text-pitch-alignment"),Dt="none"!==V.get("icon-text-fit"),Bt=new $i(null,0,G&&(tt||!h.hasIconData()||V.get("icon-optional")),tt&&(G||!h.hasTextData()||V.get("text-optional")),!0);!h.collisionArrays&&P&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(P);const Nt=(zt,At,Qt)=>{for(let Jt=0;Jt<At/4;Jt++)zt.opacityVertexArray.emplaceBack(Qt)};let Ot=0;for(let zt=0;zt<h.symbolInstances.length;zt++){const At=h.symbolInstances.get(zt),{numHorizontalGlyphVertices:Qt,numVerticalGlyphVertices:Jt,crossTileID:ne,numIconVertices:me}=At;let ue=this.opacities[ne];_[ne]?ue=$:ue||(ue=Bt,this.opacities[ne]=ue),_[ne]=!0;const ge=Qt>0||Jt>0,be=me>0,Pe=this.placedOrientations[ne],Ie=Pe===b.WritingMode.vertical,yi=Pe===b.WritingMode.horizontal||Pe===b.WritingMode.horizontalOnly;if(!ge&&!be||ue.isHidden()||Ot++,ge){const Se=Re(ue.text);Nt(h.text,Qt,Ie?ve:Se),Nt(h.text,Jt,yi?ve:Se);const Je=ue.text.isHidden(),{leftJustifiedTextSymbolIndex:Ve,centerJustifiedTextSymbolIndex:ti,rightJustifiedTextSymbolIndex:Fe,verticalPlacedTextSymbolIndex:we}=At,Be=h.text.placedSymbolArray,ei=Je||Ie?1:0;Ve>=0&&(Be.get(Ve).hidden=ei),ti>=0&&(Be.get(ti).hidden=ei),Fe>=0&&(Be.get(Fe).hidden=ei),we>=0&&(Be.get(we).hidden=Je||yi?1:0);const ci=this.variableOffsets[ne];ci&&this.markUsedJustification(h,ci.anchor,At,Pe);const qi=this.placedOrientations[ne];qi&&(this.markUsedJustification(h,"left",At,qi),this.markUsedOrientation(h,qi,At))}if(be){const Se=Re(ue.icon),{placedIconSymbolIndex:Je,verticalPlacedIconSymbolIndex:Ve}=At,ti=h.icon.placedSymbolArray,Fe=ue.icon.isHidden()?1:0;Je>=0&&(Nt(h.icon,me,Ie?ve:Se),ti.get(Je).hidden=Fe),Ve>=0&&(Nt(h.icon,At.numVerticalIconVertices,yi?ve:Se),ti.get(Ve).hidden=Fe)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const Se=h.collisionArrays[zt];if(Se){let Je=new b.pointGeometry(0,0),Ve=!0;if(Se.textBox||Se.verticalTextBox){if(ht){const Fe=this.variableOffsets[ne];Fe?(Je=_e(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textScale),lt&&Je._rotate(bt?this.transform.angle:-this.transform.angle)):Ve=!1}W&&(Ve=!ue.clipped),Se.textBox&&Zn(h.textCollisionBox.collisionVertexArray,ue.text.placed,!Ve||Ie,Je.x,Je.y),Se.verticalTextBox&&Zn(h.textCollisionBox.collisionVertexArray,ue.text.placed,!Ve||yi,Je.x,Je.y)}const ti=Ve&&Boolean(!yi&&Se.verticalIconBox);Se.iconBox&&Zn(h.iconCollisionBox.collisionVertexArray,ue.icon.placed,ti,Dt?Je.x:0,Dt?Je.y:0),Se.verticalIconBox&&Zn(h.iconCollisionBox.collisionVertexArray,ue.icon.placed,!ti,Dt?Je.x:0,Dt?Je.y:0)}}}if(h.fullyClipped=0===Ot,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const zt=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=zt.invProjMatrix,h.placementViewportMatrix=zt.viewportMatrix,h.collisionCircleArray=zt.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return 0===this.fadeDuration?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,_){const P=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*P>h}setStale(){this.stale=!0}}function Zn(S,h,_,P,V){S.emplaceBack(h?1:0,_?1:0,P||0,V||0),S.emplaceBack(h?1:0,_?1:0,P||0,V||0),S.emplaceBack(h?1:0,_?1:0,P||0,V||0),S.emplaceBack(h?1:0,_?1:0,P||0,V||0)}const Qe=Math.pow(2,25),qe=Math.pow(2,24),fe=Math.pow(2,17),Rn=Math.pow(2,16),pi=Math.pow(2,9),mn=Math.pow(2,8),ze=Math.pow(2,1);function Re(S){if(0===S.opacity&&!S.placed)return 0;if(1===S.opacity&&S.placed)return 4294967295;const h=S.placed?1:0,_=Math.floor(127*S.opacity);return _*Qe+h*qe+_*fe+h*Rn+_*pi+h*mn+_*ze+h}const ve=0;class Zi{constructor(h){this._sortAcrossTiles="viewport-y"!==h.layout.get("symbol-z-order")&&void 0!==h.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(h,_,P,V,W){const $=this._bucketParts;for(;this._currentTileIndex<h.length;)if(_.getBucketParts($,V,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,W())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,$.sort((G,tt)=>G.sortKey-tt.sortKey));this._currentPartIndex<$.length;){const G=$[this._currentPartIndex];if(_.placeLayerBucketPart(G,this._seenCrossTileIDs,P,0===G.symbolInstanceStart),this._currentPartIndex++,W())return!0}return!1}}class ui{constructor(h,_,P,V,W,$,G,tt){this.placement=new yn(h,W,$,G,tt),this._currentPlacementIndex=_.length-1,this._forceFullPlacement=P,this._showCollisionBoxes=V,this._done=!1}isDone(){return this._done}continuePlacement(h,_,P){const V=b.exported.now(),W=()=>{const $=b.exported.now()-V;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=_[h[this._currentPlacementIndex]],G=this.placement.collisionIndex.transform.zoom;if("symbol"===$.type&&(!$.minzoom||$.minzoom<=G)&&(!$.maxzoom||$.maxzoom>G)){if(this._inProgressLayer||(this._inProgressLayer=new Zi($)),this._inProgressLayer.continuePlacement(P[$.source],this.placement,this._showCollisionBoxes,$,W))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Ii=512/b.EXTENT/2;class Ne{constructor(h,_,P){this.tileID=h,this.indexedSymbolInstances={},this.bucketInstanceId=P;for(let V=0;V<_.length;V++){const W=_.get(V),$=W.key;this.indexedSymbolInstances[$]||(this.indexedSymbolInstances[$]=[]),this.indexedSymbolInstances[$].push({crossTileID:W.crossTileID,coord:this.getScaledCoordinates(W,h)})}}getScaledCoordinates(h,_){const P=Ii/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*b.EXTENT+h.tileAnchorX)*P),y:Math.floor((_.canonical.y*b.EXTENT+h.tileAnchorY)*P)}}findMatches(h,_,P){const V=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let W=0;W<h.length;W++){const $=h.get(W);if($.crossTileID)continue;const G=this.indexedSymbolInstances[$.key];if(!G)continue;const tt=this.getScaledCoordinates($,_);for(const ht of G)if(Math.abs(ht.coord.x-tt.x)<=V&&Math.abs(ht.coord.y-tt.y)<=V&&!P[ht.crossTileID]){P[ht.crossTileID]=!0,$.crossTileID=ht.crossTileID;break}}}}class Ui{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Te{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const _=Math.round((h-this.lng)/360);if(0!==_)for(const P in this.indexes){const V=this.indexes[P],W={};for(const $ in V){const G=V[$];G.tileID=G.tileID.unwrapTo(G.tileID.wrap+_),W[G.tileID.key]=G}this.indexes[P]=W}this.lng=h}addBucket(h,_,P){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let W=0;W<_.symbolInstances.length;W++)_.symbolInstances.get(W).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]={});const V=this.usedCrossTileIDs[h.overscaledZ];for(const W in this.indexes){const $=this.indexes[W];if(Number(W)>h.overscaledZ)for(const G in $){const tt=$[G];tt.tileID.isChildOf(h)&&tt.findMatches(_.symbolInstances,h,V)}else{const G=$[h.scaledTo(Number(W)).key];G&&G.findMatches(_.symbolInstances,h,V)}}for(let W=0;W<_.symbolInstances.length;W++){const $=_.symbolInstances.get(W);$.crossTileID||($.crossTileID=P.generate(),V[$.crossTileID]=!0)}return void 0===this.indexes[h.overscaledZ]&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new Ne(h,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(h,_){for(const P in _.indexedSymbolInstances)for(const V of _.indexedSymbolInstances[P])delete this.usedCrossTileIDs[h][V.crossTileID]}removeStaleBuckets(h){let _=!1;for(const P in this.indexes){const V=this.indexes[P];for(const W in V)h[V[W].bucketInstanceId]||(this.removeBucketCrossTileIDs(P,V[W]),delete V[W],_=!0)}return _}}class Ki{constructor(){this.layerIndexes={},this.crossTileIDs=new Ui,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,_,P,V){let W=this.layerIndexes[h.id];void 0===W&&(W=this.layerIndexes[h.id]=new Te);let $=!1;const G={};"globe"!==V.name&&W.handleWrapJump(P);for(const tt of _){const ht=tt.getBucket(h);ht&&h.id===ht.layerIds[0]&&(ht.bucketInstanceId||(ht.bucketInstanceId=++this.maxBucketInstanceId),W.addBucket(tt.tileID,ht,this.crossTileIDs)&&($=!0),G[ht.bucketInstanceId]=!0)}return W.removeStaleBuckets(G)&&($=!0),$}pruneUnusedLayers(h){const _={};h.forEach(P=>{_[P]=!0});for(const P in this.layerIndexes)_[P]||delete this.layerIndexes[P]}}const Vn=(S,h)=>b.emitValidationErrors(S,h&&h.filter(_=>"source.canvas"!==_.identifier)),bn=b.pick(d,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Di=b.pick(d,["setCenter","setZoom","setBearing","setPitch"]),Mi={version:8,layers:[],sources:{}},_i={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Tn extends b.Evented{constructor(h,_={}){super(),this.map=h,this.dispatcher=new Ys(y(),this),this.imageManager=new $n,this.imageManager.setEventedParent(this),this.glyphManager=new b.GlyphManager(h._requestManager,_.localFontFamily?b.LocalGlyphMode.all:_.localIdeographFontFamily?b.LocalGlyphMode.ideographs:b.LocalGlyphMode.none,_.localFontFamily||_.localIdeographFontFamily),this.crossTileSymbolIndex=new Ki,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",b.getReferrer());const P=this;this._rtlTextPluginCallback=Tn.registerForPluginStateChange(V=>{P.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:V.pluginStatus,pluginURL:V.pluginURL},(W,$)=>{if(b.triggerPluginCompletionEvent(W),$&&$.every(G=>G))for(const G in P._sourceCaches){const tt=P._sourceCaches[G],ht=tt.getSource().type;"vector"!==ht&&"geojson"!==ht||tt.reload()}})}),this.on("data",V=>{if("source"!==V.dataType||"metadata"!==V.sourceDataType)return;const W=this.getSource(V.sourceId);if(W&&W.vectorLayerIds)for(const $ in this._layers){const G=this._layers[$];G.source===W.id&&this._validateLayer(G)}})}loadURL(h,_={}){this.fire(new b.Event("dataloading",{dataType:"style"}));const P="boolean"==typeof _.validate?_.validate:!b.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,_.accessToken);const V=this.map._requestManager.transformRequest(h,b.ResourceType.Style);this._request=b.getJSON(V,(W,$)=>{this._request=null,W?this.fire(new b.ErrorEvent(W)):$&&this._load($,P)})}loadJSON(h,_={}){this.fire(new b.Event("dataloading",{dataType:"style"})),this._request=b.exported.frame(()=>{this._request=null,this._load(h,!1!==_.validate)})}loadEmpty(){this.fire(new b.Event("dataloading",{dataType:"style"})),this._load(Mi,!1)}_updateLayerCount(h,_){const P=_?1:-1;h.is3D()&&(this._num3DLayers+=P),"circle"===h.type&&(this._numCircleLayers+=P),"symbol"===h.type&&(this._numSymbolLayers+=P)}_load(h,_){if(_&&Vn(this,b.validateStyle(h)))return;this._loaded=!0,this.stylesheet=b.clone$1(h),this._updateMapProjection();for(const V in h.sources)this.addSource(V,h.sources[V],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const P=c(this.stylesheet.layers);this._order=P.map(V=>V.id),this._layers={},this._serializedLayers={};for(const V of P){const W=b.createStyleLayer(V);W.setEventedParent(this,{layer:{id:W.id}}),this._layers[W.id]=W,this._serializedLayers[W.id]=W.serialize(),this._updateLayerCount(W,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new js(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new b.Event("data",{dataType:"style"})),this.fire(new b.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(_,P,V){let W,$,G;const tt=b.exported.devicePixelRatio>1?"@2x":"";let ht=b.getJSON(P.transformRequest(P.normalizeSpriteURL(_,tt,".json"),b.ResourceType.SpriteJSON),(Dt,Bt)=>{ht=null,G||(G=Dt,W=Bt,bt())}),lt=b.getImage(P.transformRequest(P.normalizeSpriteURL(_,tt,".png"),b.ResourceType.SpriteImage),(Dt,Bt)=>{lt=null,G||(G=Dt,$=Bt,bt())});function bt(){if(G)V(G);else if(W&&$){const Dt=b.exported.getImageData($),Bt={};for(const Nt in W){const{width:Ot,height:zt,x:At,y:Qt,sdf:Jt,pixelRatio:ne,stretchX:me,stretchY:ue,content:ge}=W[Nt],be=new b.RGBAImage({width:Ot,height:zt});b.RGBAImage.copy(Dt,be,{x:At,y:Qt},{x:0,y:0},{width:Ot,height:zt}),Bt[Nt]={data:be,pixelRatio:ne,sdf:Jt,stretchX:me,stretchY:ue,content:ge}}V(null,Bt)}}return{cancel(){ht&&(ht.cancel(),ht=null),lt&&(lt.cancel(),lt=null)}}}(h,this.map._requestManager,(_,P)=>{if(this._spriteRequest=null,_)this.fire(new b.ErrorEvent(_));else if(P)for(const V in P)this.imageManager.addImage(V,P[V]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new b.Event("data",{dataType:"style"}))})}_validateLayer(h){const _=this.getSource(h.source);if(!_)return;const P=h.sourceLayer;P&&("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(P))&&this.fire(new b.ErrorEvent(new Error(`Source layer "${P}" does not exist on source "${_.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const _=[];for(const P of h){const V=this._layers[P];"custom"!==V.type&&_.push(V.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&("function"==typeof h.isLayerDraped?h.isLayerDraped():_i[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const _=this._changed;if(this._changed){const V=Object.keys(this._updatedLayers),W=Object.keys(this._removedLayers);(V.length||W.length)&&this._updateWorkerLayers(V,W);for(const $ in this._updatedSources){const G=this._updatedSources[$];"reload"===G?this._reloadSource($):"clear"===G&&this._clearSource($)}this._updateTilesForChangedImages();for(const $ in this._updatedPaintProps)this._layers[$].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const P={};for(const V in this._sourceCaches){const W=this._sourceCaches[V];P[V]=W.used,W.used=!1}for(const V of this._order){const W=this._layers[V];if(W.recalculate(h,this._availableImages),!W.isHidden(h.zoom)){const G=this._getLayerSourceCache(W);G&&(G.used=!0)}const $=this.map.painter;if($){const G=W.getProgramIds();if(!G)continue;const tt=W.getProgramConfiguration(h.zoom);for(const ht of G)$.useProgram(ht,tt)}}for(const V in P){const W=this._sourceCaches[V];P[V]!==W.used&&W.getSource().fire(new b.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:W.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),_&&this.fire(new b.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const _ in this._sourceCaches)this._sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),Vn(this,b.validateStyle(h)))return!1;(h=b.clone$1(h)).layers=c(h.layers);const _=function(V,W){if(!V)return[{command:d.setStyle,args:[W]}];let $=[];try{if(!De(V.version,W.version))return[{command:d.setStyle,args:[W]}];De(V.center,W.center)||$.push({command:d.setCenter,args:[W.center]}),De(V.zoom,W.zoom)||$.push({command:d.setZoom,args:[W.zoom]}),De(V.bearing,W.bearing)||$.push({command:d.setBearing,args:[W.bearing]}),De(V.pitch,W.pitch)||$.push({command:d.setPitch,args:[W.pitch]}),De(V.sprite,W.sprite)||$.push({command:d.setSprite,args:[W.sprite]}),De(V.glyphs,W.glyphs)||$.push({command:d.setGlyphs,args:[W.glyphs]}),De(V.transition,W.transition)||$.push({command:d.setTransition,args:[W.transition]}),De(V.light,W.light)||$.push({command:d.setLight,args:[W.light]}),De(V.fog,W.fog)||$.push({command:d.setFog,args:[W.fog]}),De(V.projection,W.projection)||$.push({command:d.setProjection,args:[W.projection]});const G={},tt=[];!function(bt,Dt,Bt,Nt){let Ot;for(Ot in Dt=Dt||{},bt=bt||{})bt.hasOwnProperty(Ot)&&(Dt.hasOwnProperty(Ot)||k(Ot,Bt,Nt));for(Ot in Dt){if(!Dt.hasOwnProperty(Ot))continue;const zt=Dt[Ot];bt.hasOwnProperty(Ot)?De(bt[Ot],zt)||("geojson"===bt[Ot].type&&"geojson"===zt.type&&R(bt,Dt,Ot)?Bt.push({command:d.setGeoJSONSourceData,args:[Ot,zt.data]}):C(Ot,Dt,Bt,Nt)):M(Ot,Dt,Bt)}}(V.sources,W.sources,tt,G);const ht=[];V.layers&&V.layers.forEach(bt=>{bt.source&&G[bt.source]?$.push({command:d.removeLayer,args:[bt.id]}):ht.push(bt)});let lt=V.terrain;lt&&G[lt.source]&&($.push({command:d.setTerrain,args:[void 0]}),lt=void 0),$=$.concat(tt),De(lt,W.terrain)||$.push({command:d.setTerrain,args:[W.terrain]}),function(bt,Dt,Bt){Dt=Dt||[];const Nt=(bt=bt||[]).map(O),Ot=Dt.map(O),zt=bt.reduce(L,{}),At=Dt.reduce(L,{}),Qt=Nt.slice(),Jt=Object.create(null);let ne,me,ue,ge,be,Pe,Ie;for(ne=0,me=0;ne<Nt.length;ne++)ue=Nt[ne],At.hasOwnProperty(ue)?me++:(Bt.push({command:d.removeLayer,args:[ue]}),Qt.splice(Qt.indexOf(ue,me),1));for(ne=0,me=0;ne<Ot.length;ne++)ue=Ot[Ot.length-1-ne],Qt[Qt.length-1-ne]!==ue&&(zt.hasOwnProperty(ue)?(Bt.push({command:d.removeLayer,args:[ue]}),Qt.splice(Qt.lastIndexOf(ue,Qt.length-me),1)):me++,Pe=Qt[Qt.length-ne],Bt.push({command:d.addLayer,args:[At[ue],Pe]}),Qt.splice(Qt.length-ne,0,ue),Jt[ue]=!0);for(ne=0;ne<Ot.length;ne++)if(ue=Ot[ne],ge=zt[ue],be=At[ue],!Jt[ue]&&!De(ge,be))if(De(ge.source,be.source)&&De(ge["source-layer"],be["source-layer"])&&De(ge.type,be.type)){for(Ie in B(ge.layout,be.layout,Bt,ue,null,d.setLayoutProperty),B(ge.paint,be.paint,Bt,ue,null,d.setPaintProperty),De(ge.filter,be.filter)||Bt.push({command:d.setFilter,args:[ue,be.filter]}),De(ge.minzoom,be.minzoom)&&De(ge.maxzoom,be.maxzoom)||Bt.push({command:d.setLayerZoomRange,args:[ue,be.minzoom,be.maxzoom]}),ge)ge.hasOwnProperty(Ie)&&"layout"!==Ie&&"paint"!==Ie&&"filter"!==Ie&&"metadata"!==Ie&&"minzoom"!==Ie&&"maxzoom"!==Ie&&(0===Ie.indexOf("paint.")?B(ge[Ie],be[Ie],Bt,ue,Ie.slice(6),d.setPaintProperty):De(ge[Ie],be[Ie])||Bt.push({command:d.setLayerProperty,args:[ue,Ie,be[Ie]]}));for(Ie in be)be.hasOwnProperty(Ie)&&!ge.hasOwnProperty(Ie)&&"layout"!==Ie&&"paint"!==Ie&&"filter"!==Ie&&"metadata"!==Ie&&"minzoom"!==Ie&&"maxzoom"!==Ie&&(0===Ie.indexOf("paint.")?B(ge[Ie],be[Ie],Bt,ue,Ie.slice(6),d.setPaintProperty):De(ge[Ie],be[Ie])||Bt.push({command:d.setLayerProperty,args:[ue,Ie,be[Ie]]}))}else Bt.push({command:d.removeLayer,args:[ue]}),Pe=Qt[Qt.lastIndexOf(ue)+1],Bt.push({command:d.addLayer,args:[be,Pe]})}(ht,W.layers,$)}catch(G){console.warn("Unable to compute style diff:",G),$=[{command:d.setStyle,args:[W]}]}return $}(this.serialize(),h).filter(V=>!(V.command in Di));if(0===_.length)return!1;const P=_.filter(V=>!(V.command in bn));if(P.length>0)throw new Error(`Unimplemented: ${P.map(V=>V.command).join(", ")}.`);return _.forEach(V=>{"setTransition"!==V.command&&"setProjection"!==V.command&&this[V.command].apply(this,V.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,_){return this.getImage(h)?this.fire(new b.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,_),this._afterImageUpdated(h),this)}updateImage(h,_){this.imageManager.updateImage(h,_)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new b.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new b.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,_,P={}){if(this._checkLoaded(),void 0!==this.getSource(h))throw new Error("There is already a source with this ID");if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(b.validateSource,`sources.${h}`,_,null,P))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const V=te(h,_,this.dispatcher,this);V.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:V.serialize(),sourceId:h}));const W=$=>{const G=($?"symbol:":"other:")+h,tt=this._sourceCaches[G]=new b.SourceCache(G,V,$);($?this._symbolSourceCaches:this._otherSourceCaches)[h]=tt,tt.style=this,tt.onAdd(this.map)};W(!1),"vector"!==_.type&&"geojson"!==_.type||W(!0),V.onAdd&&V.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const _=this.getSource(h);if(!_)throw new Error("There is no source with this ID");for(const V in this._layers)if(this._layers[V].source===h)return this.fire(new b.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${V}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new b.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const P=this._getSourceCaches(h);for(const V of P)delete this._sourceCaches[V.id],delete this._updatedSources[V.id],V.fire(new b.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:V.getSource().id})),V.setEventedParent(null),V.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],_.setEventedParent(null),_.onRemove&&_.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,_){this._checkLoaded(),this.getSource(h).setData(_),this._changed=!0}getSource(h){const _=this._getSourceCache(h);return _&&_.getSource()}_getSources(){const h=[];for(const _ in this._otherSourceCaches){const P=this._getSourceCache(_);P&&h.push(P.getSource())}return h}addLayer(h,_,P={}){this._checkLoaded();const V=h.id;if(this.getLayer(V))return void this.fire(new b.ErrorEvent(new Error(`Layer with id "${V}" already exists on this map`)));let W;if("custom"===h.type){if(Vn(this,b.validateCustomStyleLayer(h)))return;W=b.createStyleLayer(h)}else{if("object"==typeof h.source&&(this.addSource(V,h.source),h=b.clone$1(h),h=b.extend(h,{source:V})),this._validate(b.validateLayer,`layers.${V}`,h,{arrayIndex:-1},P))return;W=b.createStyleLayer(h),this._validateLayer(W),W.setEventedParent(this,{layer:{id:V}}),this._serializedLayers[W.id]=W.serialize(),this._updateLayerCount(W,!0)}const $=_?this._order.indexOf(_):this._order.length;if(_&&-1===$)return void this.fire(new b.ErrorEvent(new Error(`Layer with id "${_}" does not exist on this map.`)));this._order.splice($,0,V),this._layerOrderChanged=!0,this._layers[V]=W;const G=this._getLayerSourceCache(W);if(this._removedLayers[V]&&W.source&&G&&"custom"!==W.type){const tt=this._removedLayers[V];delete this._removedLayers[V],tt.type!==W.type?this._updatedSources[W.source]="clear":(this._updatedSources[W.source]="reload",G.pause())}this._updateLayer(W),W.onAdd&&W.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,_){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===_)return;const P=this._order.indexOf(h);this._order.splice(P,1);const V=_?this._order.indexOf(_):this._order.length;_&&-1===V?this.fire(new b.ErrorEvent(new Error(`Layer with id "${_}" does not exist on this map.`))):(this._order.splice(V,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const _=this._layers[h];if(!_)return void this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));_.setEventedParent(null),this._updateLayerCount(_,!1);const P=this._order.indexOf(h);this._order.splice(P,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=_,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],_.onRemove&&_.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const _ in this._layers)if(this._layers[_].type===h)return!0;return!1}setLayerZoomRange(h,_,P){this._checkLoaded();const V=this.getLayer(h);V?V.minzoom===_&&V.maxzoom===P||(null!=_&&(V.minzoom=_),null!=P&&(V.maxzoom=P),this._updateLayer(V)):this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,_,P={}){this._checkLoaded();const V=this.getLayer(h);if(V){if(!De(V.filter,_))return null==_?(V.filter=void 0,void this._updateLayer(V)):void(this._validate(b.validateFilter,`layers.${V.id}.filter`,_,{layerType:V.type},P)||(V.filter=b.clone$1(_),this._updateLayer(V)))}else this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const _=this.getLayer(h);return _&&b.clone$1(_.filter)}setLayoutProperty(h,_,P,V={}){this._checkLoaded();const W=this.getLayer(h);W?De(W.getLayoutProperty(_),P)||(W.setLayoutProperty(_,P,V),this._updateLayer(W)):this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,_){const P=this.getLayer(h);if(P)return P.getLayoutProperty(_);this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,_,P,V={}){this._checkLoaded();const W=this.getLayer(h);W?De(W.getPaintProperty(_),P)||(W.setPaintProperty(_,P,V)&&this._updateLayer(W),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new b.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,_){const P=this.getLayer(h);return P&&P.getPaintProperty(_)}setFeatureState(h,_){this._checkLoaded();const P=h.source,V=h.sourceLayer,W=this.getSource(P);if(!W)return void this.fire(new b.ErrorEvent(new Error(`The source '${P}' does not exist in the map's style.`)));const $=W.type;if("geojson"===$&&V)return void this.fire(new b.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===$&&!V)return void this.fire(new b.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===h.id&&this.fire(new b.ErrorEvent(new Error("The feature id parameter must be provided.")));const G=this._getSourceCaches(P);for(const tt of G)tt.setFeatureState(V,h.id,_)}removeFeatureState(h,_){this._checkLoaded();const P=h.source,V=this.getSource(P);if(!V)return void this.fire(new b.ErrorEvent(new Error(`The source '${P}' does not exist in the map's style.`)));const W=V.type,$="vector"===W?h.sourceLayer:void 0;if("vector"===W&&!$)return void this.fire(new b.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(_&&"string"!=typeof h.id&&"number"!=typeof h.id)return void this.fire(new b.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const G=this._getSourceCaches(P);for(const tt of G)tt.removeFeatureState($,h.id,_)}getFeatureState(h){this._checkLoaded();const _=h.source,P=h.sourceLayer,V=this.getSource(_);if(V){if("vector"!==V.type||P)return void 0===h.id&&this.fire(new b.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(_)[0].getFeatureState(P,h.id);this.fire(new b.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new b.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return b.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const _ in this._sourceCaches){const P=this._sourceCaches[_].getSource();h[P.id]||(h[P.id]=P.serialize())}return b.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},_=>void 0!==_)}_updateLayer(h){this._updatedLayers[h.id]=!0;const _=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&_&&"raster"!==_.getSource().type&&(this._updatedSources[h.source]="reload",_.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const _=$=>"fill-extrusion"===this._layers[$].type,P={},V=[];for(let $=this._order.length-1;$>=0;$--){const G=this._order[$];if(_(G)){P[G]=$;for(const tt of h){const ht=tt[G];if(ht)for(const lt of ht)V.push(lt)}}}V.sort(($,G)=>G.intersectionZ-$.intersectionZ);const W=[];for(let $=this._order.length-1;$>=0;$--){const G=this._order[$];if(_(G))for(let tt=V.length-1;tt>=0;tt--){const ht=V[tt].feature;if(P[ht.layer.id]<$)break;W.push(ht),V.pop()}else for(const tt of h){const ht=tt[G];if(ht)for(const lt of ht)W.push(lt.feature)}}return W}queryRenderedFeatures(h,_,P){_&&_.filter&&this._validate(b.validateFilter,"queryRenderedFeatures.filter",_.filter,null,_);const V={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new b.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const tt of _.layers){const ht=this._layers[tt];if(!ht)return this.fire(new b.ErrorEvent(new Error(`The layer '${tt}' does not exist in the map's style and cannot be queried for features.`))),[];V[ht.source]=!0}}const W=[];_.availableImages=this._availableImages;const $=_&&_.layers?_.layers.some(tt=>{const ht=this.getLayer(tt);return ht&&ht.is3D()}):this.has3DLayers(),G=oe.createFromScreenPoints(h,P);for(const tt in this._sourceCaches){const ht=this._sourceCaches[tt].getSource().id;_.layers&&!V[ht]||W.push(u(this._sourceCaches[tt],this._layers,this._serializedLayers,G,_,P,$,!!this.map._showQueryGeometry))}return this.placement&&W.push(function(tt,ht,lt,bt,Dt,Bt,Nt){const Ot={},zt=Bt.queryRenderedSymbols(bt),At=[];for(const Qt of Object.keys(zt).map(Number))At.push(Nt[Qt]);At.sort(g);for(const Qt of At){const Jt=Qt.featureIndex.lookupSymbolFeatures(zt[Qt.bucketInstanceId],ht,Qt.bucketIndex,Qt.sourceLayerIndex,Dt.filter,Dt.layers,Dt.availableImages,tt);for(const ne in Jt){const me=Ot[ne]=Ot[ne]||[],ue=Jt[ne];ue.sort((ge,be)=>{const Pe=Qt.featureSortOrder;if(Pe){const Ie=Pe.indexOf(ge.featureIndex);return Pe.indexOf(be.featureIndex)-Ie}return be.featureIndex-ge.featureIndex});for(const ge of ue)me.push(ge)}}for(const Qt in Ot)Ot[Qt].forEach(Jt=>{const ne=Jt.feature,me=lt(tt[Qt]);if(!me)return;const ue=me.getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=ue});return Ot}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),G.screenGeometry,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(W)}querySourceFeatures(h,_){_&&_.filter&&this._validate(b.validateFilter,"querySourceFeatures.filter",_.filter,null,_);const P=this._getSourceCaches(h);let V=[];for(const W of P)V=V.concat(I(W,_));return V}addSourceType(h,_,P){return Tn.getSourceType(h)?P(new Error(`A source type called "${h}" already exists.`)):(Tn.setSourceType(h,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:_.workerSourceURL},P):P(null,null))}getLight(){return this.light.getLight()}setLight(h,_={}){this._checkLoaded();const P=this.light.getLight();let V=!1;for(const $ in h)if(!De(h[$],P[$])){V=!0;break}if(!V)return;const W=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,_),this.light.updateTransitions(W)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,_=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let P=h;if(1===_){if("object"==typeof P.source){const V="terrain-dem-src";this.addSource(V,P.source),P=b.clone$1(P),P=b.extend(P,{source:V})}if(this._validate(b.validateTerrain,"terrain",P))return}if(!this.terrain||this.terrain&&_!==this.terrain.drapeRenderMode){if(!P)return;this._createTerrain(P,_)}else{const V=this.terrain,W=V.get();for(const $ of Object.keys(b.spec.terrain))!P.hasOwnProperty($)&&b.spec.terrain[$].default&&(P[$]=b.spec.terrain[$].default);for(const $ in P)if(!De(P[$],W[$])){V.set(P),this.stylesheet.terrain=P;const G=this._setTransitionParameters({duration:0});V.updateTransitions(G);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const _=this.fog=new ao(h,this.map.transform);this.stylesheet.fog=h;const P=this._setTransitionParameters({duration:0});_.updateTransitions(P)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const _=this.fog,P=_.get();0===Object.keys(h).length&&_.set(h);for(const V in h)if(!De(h[V],P[V])){_.set(h),this.stylesheet.fog=h;const W=this._setTransitionParameters({duration:0});_.updateTransitions(W);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:b.exported.now(),transition:b.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(P=>this.isLayerDraped(this._layers[P])),_=this._order.filter(P=>!this.isLayerDraped(this._layers[P]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(..._)}_createTerrain(h,_){const P=this.terrain=new Ri(h,_);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const V=this._setTransitionParameters({duration:0});P.updateTransitions(V)}_force3DLayerUpdate(){for(const h in this._layers){const _=this._layers[h];"fill-extrusion"===_.type&&this._updateLayer(_)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const _=this._layers[h];"symbol"===_.type&&this._updateLayer(_)}}_validate(h,_,P,V,W={}){return(!W||!1!==W.validate)&&Vn(this,h.call(b.validateStyle,b.extend({key:_,style:this.serialize(),value:P,styleSpec:b.spec},V)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),b.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const _=this._getSourceCaches(h);for(const P of _)P.clearTiles()}_reloadSource(h){const _=this._getSourceCaches(h);for(const P of _)P.resume(),P.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const _ in this._sourceCaches)this._sourceCaches[_].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const _=this._sourceCaches[h];_.resume(),_.reload()}}_updatePlacement(h,_,P,V,W=!1){let $=!1,G=!1;const tt={};for(const ht of this._order){const lt=this._layers[ht];if("symbol"!==lt.type)continue;if(!tt[lt.source]){const Dt=this._getLayerSourceCache(lt);if(!Dt)continue;tt[lt.source]=Dt.getRenderableIds(!0).map(Bt=>Dt.getTileByID(Bt)).sort((Bt,Nt)=>Nt.tileID.overscaledZ-Bt.tileID.overscaledZ||(Bt.tileID.isLessThan(Nt.tileID)?-1:1))}const bt=this.crossTileSymbolIndex.addLayer(lt,tt[lt.source],h.center.lng,h.projection);$=$||bt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),W=W||this._layerOrderChanged||0===P,this._layerOrderChanged&&this.fire(new b.Event("neworder")),(W||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(b.exported.now(),h.zoom))&&(this.pauseablePlacement=new ui(h,this._order,W,_,P,V,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,tt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(b.exported.now()),G=!0),$&&this.pauseablePlacement.placement.setStale()),G||$)for(const ht of this._order){const lt=this._layers[ht];"symbol"===lt.type&&this.placement.updateLayerOpacities(lt,tt[lt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(b.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,_,P){this.imageManager.getImages(_.icons,P),this._updateTilesForChangedImages();const V=W=>{W&&W.setDependencies(_.tileID.key,_.type,_.icons)};V(this._otherSourceCaches[_.source]),V(this._symbolSourceCaches[_.source])}getGlyphs(h,_,P){this.glyphManager.getGlyphs(_.stacks,P)}getResource(h,_,P){return b.makeRequest(_,P)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return"symbol"===h.type?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const _=[];return this._otherSourceCaches[h]&&_.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&_.push(this._symbolSourceCaches[h]),_}_isSourceCacheLoaded(h){const _=this._getSourceCaches(h);return 0===_.length?(this.fire(new b.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):_.every(P=>P.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Tn.getSourceType=function(S){return re[S]},Tn.setSourceType=function(S,h){re[S]=h},Tn.registerForPluginStateChange=b.registerForPluginStateChange;var uo="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",zo="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ko="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",vi="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",vo="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let bu={},Or={};const Yl=[];bh(uo,Yl),bh(ko,Yl),bh(vi,Yl),bh(vo,Yl),bu=hs("",ko),Or=hs(vo,vi);const jf=hs("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Qs=uo,wu="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var $p={background:hs("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hs("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hs("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hs("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hs("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hs("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hs("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hs("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hs("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hs("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hs("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hs("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hs("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hs("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hs("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hs("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hs("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hs("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hs("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hs("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hs("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hs("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hs("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hs("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hs("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hs("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zo),skyboxGradient:hs("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zo),skyboxCapture:hs("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hs("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hs("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function bh(S,h){const _=S.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let P of _)if(P=P.trim(),"#"===P[0]&&P.includes("if")&&!P.includes("endif")){P=P.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const V=P.split(" ");for(const W of V)h.includes(W)||h.push(W)}}function hs(S,h){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,P=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),V={},W=[...Yl];return bh(S,W),bh(h,W),{fragmentSource:S=S.replace(_,($,G,tt,ht,lt)=>(V[lt]=!0,"define"===G?`\n#ifndef HAS_UNIFORM_u_${lt}\nvarying ${tt} ${ht} ${lt};\n#else\nuniform ${tt} ${ht} u_${lt};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${lt}\n    ${tt} ${ht} ${lt} = u_${lt};\n#endif\n`)),vertexSource:h=h.replace(_,($,G,tt,ht,lt)=>{const bt="float"===ht?"vec2":"vec4",Dt=lt.match(/color/)?"color":bt;return V[lt]?"define"===G?`\n#ifndef HAS_UNIFORM_u_${lt}\nuniform lowp float u_${lt}_t;\nattribute ${tt} ${bt} a_${lt};\nvarying ${tt} ${ht} ${lt};\n#else\nuniform ${tt} ${ht} u_${lt};\n#endif\n`:"vec4"===Dt?`\n#ifndef HAS_UNIFORM_u_${lt}\n    ${lt} = a_${lt};\n#else\n    ${tt} ${ht} ${lt} = u_${lt};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${lt}\n    ${lt} = unpack_mix_${Dt}(a_${lt}, u_${lt}_t);\n#else\n    ${tt} ${ht} ${lt} = u_${lt};\n#endif\n`:"define"===G?`\n#ifndef HAS_UNIFORM_u_${lt}\nuniform lowp float u_${lt}_t;\nattribute ${tt} ${bt} a_${lt};\n#else\nuniform ${tt} ${ht} u_${lt};\n#endif\n`:"vec4"===Dt?`\n#ifndef HAS_UNIFORM_u_${lt}\n    ${tt} ${ht} ${lt} = a_${lt};\n#else\n    ${tt} ${ht} ${lt} = u_${lt};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${lt}\n    ${tt} ${ht} ${lt} = unpack_mix_${Dt}(a_${lt}, u_${lt}_t);\n#else\n    ${tt} ${ht} ${lt} = u_${lt};\n#endif\n`}),staticAttributes:P,usedDefines:W}}class Hl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,_,P,V,W,$,G){this.context=h;let tt=this.boundPaintVertexBuffers.length!==V.length;for(let lt=0;!tt&&lt<V.length;lt++)this.boundPaintVertexBuffers[lt]!==V[lt]&&(tt=!0);let ht=this.boundDynamicVertexBuffers.length!==G.length;for(let lt=0;!ht&&lt<G.length;lt++)this.boundDynamicVertexBuffers[lt]!==G[lt]&&(ht=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==_||this.boundLayoutVertexBuffer!==P||tt||ht||this.boundIndexBuffer!==W||this.boundVertexOffset!==$)this.freshBind(_,P,V,W,$,G);else{h.bindVertexArrayOES.set(this.vao);for(const lt of G)lt&&lt.bind();W&&W.dynamicDraw&&W.bind()}}freshBind(h,_,P,V,W,$){let G;const tt=h.numAttributes,ht=this.context,lt=ht.gl;if(ht.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ht.extVertexArrayObject.createVertexArrayOES(),ht.bindVertexArrayOES.set(this.vao),G=0,this.boundProgram=h,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=P,this.boundIndexBuffer=V,this.boundVertexOffset=W,this.boundDynamicVertexBuffers=$;else{G=ht.currentNumAttributes||0;for(let bt=tt;bt<G;bt++)lt.disableVertexAttribArray(bt)}_.enableAttributes(lt,h),_.bind(),_.setVertexAttribPointers(lt,h,W);for(const bt of P)bt.enableAttributes(lt,h),bt.bind(),bt.setVertexAttribPointers(lt,h,W);for(const bt of $)bt&&(bt.enableAttributes(lt,h),bt.bind(),bt.setVertexAttribPointers(lt,h,W));V&&V.bind(),ht.currentNumAttributes=tt}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function wh(S,h){const _=Math.pow(2,h.canonical.z),P=h.canonical.y;return[new b.MercatorCoordinate(0,P/_).toLngLat().lat,new b.MercatorCoordinate(0,(P+1)/_).toLngLat().lat]}function yc(S,h,_,P,V,W,$){const G=S.context,tt=G.gl,ht=_.fbo;if(!ht)return;S.prepareDrawTile();const lt=S.useProgram("hillshade");G.activeTexture.set(tt.TEXTURE0),tt.bindTexture(tt.TEXTURE_2D,ht.colorAttachment.get());const bt=((Ot,zt,At,Qt)=>{const Jt=At.paint.get("hillshade-shadow-color"),ne=At.paint.get("hillshade-highlight-color"),me=At.paint.get("hillshade-accent-color");let ue=At.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===At.paint.get("hillshade-illumination-anchor")&&(ue-=Ot.transform.angle);const ge=!Ot.options.moving;return{u_matrix:Qt||Ot.transform.calculateProjMatrix(zt.tileID.toUnwrapped(),ge),u_image:0,u_latrange:wh(0,zt.tileID),u_light:[At.paint.get("hillshade-exaggeration"),ue],u_shadow:Jt,u_highlight:ne,u_accent:me}})(S,_,P,S.terrain?h.projMatrix:null);S.prepareDrawProgram(G,lt,h.toUnwrapped());const{tileBoundsBuffer:Dt,tileBoundsIndexBuffer:Bt,tileBoundsSegments:Nt}=S.getTileBoundsBuffers(_);lt.draw(G,tt.TRIANGLES,V,W,$,b.CullFaceMode.disabled,bt,P.id,Dt,Bt,Nt)}function _c(S,h,_){if(!h.needsDEMTextureUpload)return;const P=S.context,V=P.gl;P.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||S.getTileTexture(_.stride);const W=_.getPixels();h.demTexture?h.demTexture.update(W,{premultiply:!1}):h.demTexture=new b.Texture(P,W,V.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function md(S,h,_,P,V,W){const $=S.context,G=$.gl;if(!h.dem)return;const tt=h.dem;if($.activeTexture.set(G.TEXTURE1),_c(S,h,tt),!h.demTexture)return;h.demTexture.bind(G.NEAREST,G.CLAMP_TO_EDGE);const ht=tt.dim;$.activeTexture.set(G.TEXTURE0);let lt=h.fbo;if(!lt){const Nt=new b.Texture($,{width:ht,height:ht,data:null},G.RGBA);Nt.bind(G.LINEAR,G.CLAMP_TO_EDGE),lt=h.fbo=$.createFramebuffer(ht,ht,!0),lt.colorAttachment.set(Nt.texture)}$.bindFramebuffer.set(lt.framebuffer),$.viewport.set([0,0,ht,ht]);const{tileBoundsBuffer:bt,tileBoundsIndexBuffer:Dt,tileBoundsSegments:Bt}=S.getMercatorTileBoundsBuffers();S.useProgram("hillshadePrepare").draw($,G.TRIANGLES,P,V,W,b.CullFaceMode.disabled,((Nt,Ot)=>{const zt=Ot.stride,At=b.create();return b.ortho(At,0,b.EXTENT,-b.EXTENT,0,0,1),b.translate(At,At,[0,-b.EXTENT,0]),{u_matrix:At,u_image:1,u_dimension:[zt,zt],u_zoom:Nt.overscaledZ,u_unpack:Ot.unpackVector}})(h.tileID,tt),_.id,bt,Dt,Bt),h.needsHillshadePrepare=!1}const vc=S=>({u_matrix:new b.UniformMatrix4f(S),u_image0:new b.Uniform1i(S),u_skirt_height:new b.Uniform1f(S)}),$l=(S,h)=>({u_matrix:S,u_image0:0,u_skirt_height:h}),tl=(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt)=>({u_proj_matrix:Float32Array.from(S),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(P),u_merc_matrix:_,u_zoom_transition:V,u_merc_center:W,u_image0:0,u_frustum_tl:$,u_frustum_tr:G,u_frustum_br:tt,u_frustum_bl:ht,u_globe_pos:lt,u_globe_radius:bt,u_viewport:Dt,u_grid_matrix:Nt?Float32Array.from(Nt):new Float32Array(9),u_skirt_height:Bt});function Mu(S,h){return null!=S&&null!=h&&!(!S.hasData()||!h.hasData())&&null!=S.demTexture&&null!=h.demTexture&&S.tileID.key!==h.tileID.key}const fi=new class{constructor(){this.operations={}}newMorphing(S,h,_,P,V){if(S in this.operations){const W=this.operations[S];W.to.tileID.key!==_.tileID.key&&(W.queued=_)}else this.operations[S]={startTime:P,phase:0,duration:V,from:h,to:_,queued:null}}getMorphValuesForProxy(S){if(!(S in this.operations))return null;const h=this.operations[S];return{from:h.from,to:h.to,phase:h.phase}}update(S){for(const h in this.operations){const _=this.operations[h];for(_.phase=(S-_.startTime)/_.duration;_.phase>=1||!this._validOp(_);)if(!this._nextOp(_,S)){delete this.operations[h];break}}}_nextOp(S,h){return!!S.queued&&(S.from=S.to,S.to=S.queued,S.queued=null,S.phase=0,S.startTime=h,!0)}_validOp(S){return S.from.hasData()&&S.to.hasData()}},vl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Fn(S){return 6*Math.pow(1.5,22-S)}function Mh(S,h){const _=1<<S.z;return!h&&(0===S.x||S.x===_-1)||0===S.y||S.y===_-1}const rs=S=>({u_matrix:S});function el(S,h,_,P,V){if(V>0){const W=b.exported.now(),$=(W-S.timeAdded)/V,G=h?(W-h.timeAdded)/V:-1,tt=_.getSource(),ht=P.coveringZoomLevel({tileSize:tt.tileSize,roundZoom:tt.roundZoom}),lt=!h||Math.abs(h.tileID.overscaledZ-ht)>Math.abs(S.tileID.overscaledZ-ht),bt=lt&&S.refreshedUponExpiration?1:b.clamp(lt?$:1-G,0,1);return S.refreshedUponExpiration&&$>=1&&(S.refreshedUponExpiration=!1),h?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}class Gp extends b.SourceCache{constructor(h){const _={type:"raster-dem",maxzoom:h.transform.maxZoom},P=new Ys(y(),null),V=te("mock-dem",_,P,h.style);super("mock-dem",V,!1),V.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,_){h.state="loaded",_(null)}}class Zp extends b.SourceCache{constructor(h){const _=te("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new Ys(y(),null),h.style);super("proxy",_,!1),_.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,_,P){if(h.freezeTileCoverage)return;this.transform=h;const V=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((W,$)=>{if(W[$.key]="",!this._tiles[$.key]){const G=new b.Tile($,this._source.tileSize*$.overscaleFactor(),h.tileZoom);G.state="loaded",this._tiles[$.key]=G}return W},{});for(const W in this._tiles)W in V||(this.freeFBO(W),this._tiles[W].unloadVectorData(),delete this._tiles[W])}freeFBO(h){const _=this.proxyCachedFBO[h];if(void 0!==_){const P=Object.values(_);this.renderCachePool.push(...P),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Cu extends b.OverscaledTileID{constructor(h,_,P){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=_,this.projMatrix=P}}class xa extends b.Elevation{constructor(h,_){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[P,V,W]=function(tt){const ht=new b.StructArrayLayout2i4,lt=new b.StructArrayLayout3ui6;ht.reserve(17161),lt.reserve(33800);const Dt=b.EXTENT/128,Bt=b.EXTENT+Dt/2,Nt=Bt+Dt;for(let zt=-Dt;zt<Nt;zt+=Dt)for(let At=-Dt;At<Nt;At+=Dt){const Qt=At<0||At>Bt||zt<0||zt>Bt?24575:0,Jt=b.clamp(Math.round(At),0,b.EXTENT),ne=b.clamp(Math.round(zt),0,b.EXTENT);ht.emplaceBack(Jt+Qt,ne)}const Ot=(zt,At)=>{const Qt=131*At+zt;lt.emplaceBack(Qt+1,Qt,Qt+131),lt.emplaceBack(Qt+131,Qt+131+1,Qt+1)};for(let zt=1;zt<129;zt++)for(let At=1;At<129;At++)Ot(At,zt);return[0,129].forEach(zt=>{for(let At=0;At<130;At++)Ot(At,zt),Ot(zt,At)}),[ht,lt,32768]}(),$=h.context;this.gridBuffer=$.createVertexBuffer(P,b.posAttributes.members),this.gridIndexBuffer=$.createIndexBuffer(V),this.gridSegments=b.SegmentVector.simpleSegment(0,0,P.length,V.length),this.gridNoSkirtSegments=b.SegmentVector.simpleSegment(0,0,P.length,W),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zp(_.map),this.orthoMatrix=b.create(),b.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,b.EXTENT,0,b.EXTENT,0,1);const G=$.gl;this._overlapStencilMode=new b.StencilMode({func:G.GEQUAL,mask:255},0,255,G.KEEP,G.KEEP,G.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=_,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Gp(_.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,_,P){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const V=h.terrain.properties;this.sourceCache=0===h.terrain.drapeRenderMode?this._mockSourceCache:h._getSourceCache(V.get("source")),this._exaggeration=V.get("exaggeration");const W=()=>{this.sourceCache.used&&b.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const $=this.getScaledDemTileSize();this.sourceCache.update(_,$,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,W(),this._initializing=!0),W(),_.updateElevation(!0,P),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(_),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==h.efficiency&&b.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&"source"===h.dataType?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):"style"===h.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const _=this.proxySourceCache,P=this.painter.transform;this._initializing&&(this._initializing=0===P._centerAltitude&&-1===this.getAtPointOrZero(b.MercatorCoordinate.fromLngLat(P.center),-1),this._emptyDEMTextureDirty=!this._initializing);const V=this.proxyCoords=_.getIds().map(tt=>{const ht=_.getTileByID(tt).tileID;return ht.projMatrix=P.calculateProjMatrix(ht.toUnwrapped()),ht});(function(tt,ht){const lt=ht.transform.pointCoordinate(ht.transform.getCameraPoint()),bt=new b.pointGeometry(lt.x,lt.y);tt.sort((Dt,Bt)=>{if(Bt.overscaledZ-Dt.overscaledZ)return Bt.overscaledZ-Dt.overscaledZ;const Nt=new b.pointGeometry(Dt.canonical.x+(1<<Dt.canonical.z)*Dt.wrap,Dt.canonical.y),Ot=new b.pointGeometry(Bt.canonical.x+(1<<Bt.canonical.z)*Bt.wrap,Bt.canonical.y),zt=bt.mult(1<<Dt.canonical.z);return zt.x-=.5,zt.y-=.5,zt.distSqr(Nt)-zt.distSqr(Ot)})})(V,this.painter),this._previousZoom=P.zoom;const W=this.proxyToSource||{};this.proxyToSource={},V.forEach(tt=>{this.proxyToSource[tt.key]={}}),this.terrainTileForTile={};const $=this._style._sourceCaches;for(const tt in $){const ht=$[tt];if(!ht.used||(ht!==this.sourceCache&&this.resetTileLookupCache(ht.id),this._setupProxiedCoordsForOrtho(ht,h[tt],W),ht.usedForTerrain))continue;const lt=h[tt];ht.getSource().reparseOverscaled&&this._assignTerrainTiles(lt)}this.proxiedCoords[_.id]=V.map(tt=>new Cu(tt,tt.key,this.orthoMatrix)),this._assignTerrainTiles(V),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(W),this.renderingToTexture=!1,this._updateTimestamp=b.exported.now();const G={};this._visibleDemTiles=[];for(const tt of this.proxyCoords){const ht=this.terrainTileForTile[tt.key];if(!ht)continue;const lt=ht.tileID.key;lt in G||(this._visibleDemTiles.push(ht),G[lt]=lt)}}_assignTerrainTiles(h){this._initializing||h.forEach(_=>{if(this.terrainTileForTile[_.key])return;const P=this._findTileCoveringTileID(_,this.sourceCache);P&&(this.terrainTileForTile[_.key]=P)})}_prepareDEMTextures(){const h=this.painter.context,_=h.gl;for(const P in this.terrainTileForTile){const V=this.terrainTileForTile[P],W=V.dem;!W||V.demTexture&&!V.needsDEMTextureUpload||(h.activeTexture.set(_.TEXTURE1),_c(this.painter,V,W))}}_prepareDemTileUniforms(h,_,P,V){if(!_||null==_.demTexture)return!1;const W=h.tileID.canonical,$=Math.pow(2,_.tileID.canonical.z-W.z),G=V||"";return P[`u_dem_tl${G}`]=[W.x*$%1,W.y*$%1],P[`u_dem_scale${G}`]=$,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,_=h.gl;if(!this._emptyDepthBufferTexture){const P=new b.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new b.Texture(h,P,_.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const _=this._visibleDemTiles.reduce((P,V)=>{if(!V.dem)return P;const W=V.dem.tree.minimums[0];return W>0&&h++,P+W},0);return h?_/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,_=h.gl;h.activeTexture.set(_.TEXTURE2);const P=this._getLoadedAreaMinimum(),V=new b.RGBAImage({width:1,height:1},new Uint8Array(b.DEMData.pack(P,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let W=this._emptyDEMTexture;return W?W.update(V,{premultiply:!1}):W=this._emptyDEMTexture=new b.Texture(h,V,_.RGBA,{premultiply:!1}),W}setupElevationDraw(h,_,P){const V=this.painter.context,W=V.gl,$=(G=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:b.DEMData.getUnpackVector(G),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var G;$.u_dem_size=this.sourceCache.getSource().tileSize,$.u_exaggeration=this.exaggeration();let tt=null,ht=null,lt=1;if(P&&P.morphing&&this._useVertexMorphing){const bt=P.morphing.srcDemTile,Dt=P.morphing.dstDemTile;lt=P.morphing.phase,bt&&Dt&&(this._prepareDemTileUniforms(h,bt,$,"_prev")&&(ht=bt),this._prepareDemTileUniforms(h,Dt,$)&&(tt=Dt))}if(ht&&tt?(V.activeTexture.set(W.TEXTURE2),tt.demTexture.bind(W.NEAREST,W.CLAMP_TO_EDGE,W.NEAREST),V.activeTexture.set(W.TEXTURE4),ht.demTexture.bind(W.NEAREST,W.CLAMP_TO_EDGE,W.NEAREST),$.u_dem_lerp=lt):(tt=this.terrainTileForTile[h.tileID.key],V.activeTexture.set(W.TEXTURE2),(this._prepareDemTileUniforms(h,tt,$)?tt.demTexture:this.emptyDEMTexture).bind(W.NEAREST,W.CLAMP_TO_EDGE)),V.activeTexture.set(W.TEXTURE3),P&&P.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(W.NEAREST,W.CLAMP_TO_EDGE),this._depthFBO&&($.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(W.NEAREST,W.CLAMP_TO_EDGE),$.u_depth_size_inv=[1,1]),P&&P.useMeterToDem&&tt){const bt=(1<<tt.tileID.canonical.z)*b.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;$.u_meter_to_dem=bt}if(P&&P.labelPlaneMatrixInv&&($.u_label_plane_matrix_inv=P.labelPlaneMatrixInv),_.setTerrainUniformValues(V,$),"globe"===this.painter.transform.projection.name){const bt=this.globeUniformValues(this.painter.transform,h.tileID.canonical,P&&P.useDenormalizedUpVectorScale);_.setGlobeUniformValues(V,bt)}}globeUniformValues(h,_,P){const V=h.projection;return{u_tile_tl_up:V.upVector(_,0,0),u_tile_tr_up:V.upVector(_,b.EXTENT,0),u_tile_br_up:V.upVector(_,b.EXTENT,b.EXTENT),u_tile_bl_up:V.upVector(_,0,b.EXTENT),u_tile_up_scale:P?b.globeMetersToEcef(1):V.upVectorScale(_,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const _=this.painter,P=this.painter.context;0!==h.length&&(P.bindFramebuffer.set(null),P.viewport.set([0,0,_.width,_.height]),_.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(V,W,$,G,tt){if("globe"===V.transform.projection.name)!function(ht,lt,bt,Dt,Bt){const Nt=ht.context,Ot=Nt.gl;let zt,At;const Qt=ht.options.showTerrainWireframe?2:0,Jt=ht.transform,ne=b.globeUseCustomAntiAliasing(ht,Nt,Jt),me=(ti,Fe)=>{if(At===ti)return;const we=[vl[ti],"PROJECTION_GLOBE_VIEW"];ne&&we.push("CUSTOM_ANTIALIASING"),Fe&&we.push(vl[Qt]),zt=ht.useProgram("globeRaster",null,we),At=ti},ue=ht.colorModeForRenderPass(),ge=new b.DepthMode(Ot.LEQUAL,b.DepthMode.ReadWrite,ht.depthRangeFor3D);fi.update(Bt);const be=b.calculateGlobeMercatorMatrix(Jt),Pe=[b.mercatorXfromLng(Jt.center.lng),b.mercatorYfromLat(Jt.center.lat)],Ie=Qt?[!1,!0]:[!1],yi=ht.globeSharedBuffers,Se=[Jt.width*b.exported.devicePixelRatio,Jt.height*b.exported.devicePixelRatio],Je=Float32Array.from(Jt.globeMatrix),Ve={useDenormalizedUpVectorScale:!0};if(Ie.forEach(ti=>{const Fe=ht.transform,we=Fn(Fe.zoom)*lt.exaggeration();At=-1;const Be=ti?Ot.LINES:Ot.TRIANGLES;for(const ei of Dt){const ci=bt.getTile(ei),qi=b.StencilMode.disabled,Xn=lt.prevTerrainTileForTile[ei.key],Gi=lt.terrainTileForTile[ei.key];Mu(Xn,Gi)&&fi.newMorphing(ei.key,Xn,Gi,Bt,250),Nt.activeTexture.set(Ot.TEXTURE0),ci.texture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE);const Fi=fi.getMorphValuesForProxy(ei.key),nn=Fi?1:0;Fi&&b.extend$1(Ve,{morphing:{srcDemTile:Fi.from,dstDemTile:Fi.to,phase:b.easeCubicInOut(Fi.phase)}});const Kn=b.tileCornersToBounds(ei.canonical),sn=b.getLatitudinalLod(Kn.getCenter().lat),fs=b.getGridMatrix(ei.canonical,Kn,sn,Fe.worldSize/Fe._pixelsPerMercatorPixel),vs=b.globeNormalizeECEF(b.globeTileBounds(ei.canonical)),Ds=tl(Fe.projMatrix,Je,be,vs,b.globeToMercatorTransition(Fe.zoom),Pe,Fe.frustumCorners.TL,Fe.frustumCorners.TR,Fe.frustumCorners.BR,Fe.frustumCorners.BL,Fe.globeCenterInViewSpace,Fe.globeRadius,Se,we,fs);if(me(nn,ti),lt.setupElevationDraw(ci,zt,Ve),ht.prepareDrawProgram(Nt,zt,ei.toUnwrapped()),yi){const[Ns,bo,xr]=ti?yi.getWirefameBuffers(ht.context,sn):yi.getGridBuffers(sn,0!==we);zt.draw(Nt,Be,ge,qi,ue,b.CullFaceMode.backCCW,Ds,"globe_raster",Ns,bo,xr)}}}),yi){const ti=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ne&&ti.push("CUSTOM_ANTIALIASING"),zt=ht.useProgram("globeRaster",null,ti);for(const Fe of Dt){const{x:we,y:Be,z:ei}=Fe.canonical,ci=0===Be,qi=Be===(1<<ei)-1,[Xn,Gi,Fi,nn]=yi.getPoleBuffers(ei);if(nn&&(ci||qi)){const Kn=bt.getTile(Fe);Nt.activeTexture.set(Ot.TEXTURE0),Kn.texture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE);let sn=b.globePoleMatrixForTile(ei,we,Jt);const fs=b.globeNormalizeECEF(b.globeTileBounds(Fe.canonical)),vs=(Ds,Ns)=>Ds.draw(Nt,Ot.TRIANGLES,ge,b.StencilMode.disabled,ue,b.CullFaceMode.disabled,tl(Jt.projMatrix,sn,sn,fs,0,Pe,Jt.frustumCorners.TL,Jt.frustumCorners.TR,Jt.frustumCorners.BR,Jt.frustumCorners.BL,Jt.globeCenterInViewSpace,Jt.globeRadius,Se,0),"globe_pole_raster",Ns,Fi,nn);lt.setupElevationDraw(Kn,zt,Ve),ht.prepareDrawProgram(Nt,zt,Fe.toUnwrapped()),ci&&vs(zt,Xn),qi&&(sn=b.scale(b.create(),sn,[1,-1,1]),vs(zt,Gi))}}}}(V,W,$,G,tt);else{const ht=V.context,lt=ht.gl;let bt,Dt;const Bt=V.options.showTerrainWireframe?2:0,Nt=(Jt,ne)=>{if(Dt===Jt)return;const me=[vl[Jt]];ne&&me.push(vl[Bt]),bt=V.useProgram("terrainRaster",null,me),Dt=Jt},Ot=V.colorModeForRenderPass(),zt=new b.DepthMode(lt.LEQUAL,b.DepthMode.ReadWrite,V.depthRangeFor3D);fi.update(tt);const At=V.transform,Qt=Fn(At.zoom)*W.exaggeration();(Bt?[!1,!0]:[!1]).forEach(Jt=>{Dt=-1;const ne=Jt?lt.LINES:lt.TRIANGLES,[me,ue]=Jt?W.getWirefameBuffer():[W.gridIndexBuffer,W.gridSegments];for(const ge of G){const be=$.getTile(ge),Pe=b.StencilMode.disabled,Ie=W.prevTerrainTileForTile[ge.key],yi=W.terrainTileForTile[ge.key];Mu(Ie,yi)&&fi.newMorphing(ge.key,Ie,yi,tt,250),ht.activeTexture.set(lt.TEXTURE0),be.texture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE,lt.LINEAR_MIPMAP_NEAREST);const Se=fi.getMorphValuesForProxy(ge.key),Je=Se?1:0;let Ve;Se&&(Ve={morphing:{srcDemTile:Se.from,dstDemTile:Se.to,phase:b.easeCubicInOut(Se.phase)}});const ti=$l(ge.projMatrix,Mh(ge.canonical,At.renderWorldCopies)?Qt/10:Qt);Nt(Je,Jt),W.setupElevationDraw(be,bt,Ve),V.prepareDrawProgram(ht,bt,ge.toUnwrapped()),bt.draw(ht,ne,zt,Pe,Ot,b.CullFaceMode.backCCW,ti,"terrain_raster",W.gridBuffer,me,ue)}})}}(_,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,_.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(0===this._drapedRenderBatches.length)return h+1;this.renderingToTexture=!0;const _=this.painter,P=this.painter.context,V=this.proxySourceCache,W=this.proxiedCoords[V.id],$=this._drapedRenderBatches.shift(),G=[],tt=_.style.order;let ht=0;for(const lt of W){const bt=V.getTileByID(lt.proxyTileKey),Dt=V.proxyCachedFBO[lt.key]?V.proxyCachedFBO[lt.key][h]:void 0,Bt=void 0!==Dt?V.renderCache[Dt]:this.pool[ht++],Nt=void 0!==Dt;if(bt.texture=Bt.tex,Nt&&!Bt.dirty){G.push(bt.tileID);continue}let Ot;P.bindFramebuffer.set(Bt.fb.framebuffer),this.renderedToTile=!1,Bt.dirty&&(P.clear({color:b.Color.transparent,stencil:0}),Bt.dirty=!1);for(let zt=$.start;zt<=$.end;++zt){const At=_.style._layers[tt[zt]];if(At.isHidden(_.transform.zoom))continue;const Qt=_.style._getLayerSourceCache(At),Jt=Qt?this.proxyToSource[lt.key][Qt.id]:[lt];if(!Jt)continue;const ne=Jt;P.viewport.set([0,0,Bt.fb.width,Bt.fb.height]),Ot!==(Qt?Qt.id:null)&&(this._setupStencil(Bt,Jt,At,Qt),Ot=Qt?Qt.id:null),_.renderLayer(_,Qt,At,ne)}this.renderedToTile?(Bt.dirty=!0,G.push(bt.tileID)):Nt||--ht,5===ht&&(ht=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,P.bindFramebuffer.set(null),P.viewport.set([0,0,_.width,_.height]),$.end+1}postRender(){}renderCacheEfficiency(h){const _=h.order.length;if(0===_)return{efficiency:100};let P,V=0,W=0,$=!1;for(let G=0;G<_;++G){const tt=h._layers[h.order[G]];this._style.isLayerDraped(tt)?($&&++V,++W):$||($=!0,P=tt.id)}return 0===W?{efficiency:100}:{efficiency:100*(1-V/W),firstUndrapedLayer:P}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(_=>_.dem).forEach(_=>{h=Math.min(h,_.dem.tree.minimums[0])}),0===h?h:(h-30)*this._exaggeration}raycast(h,_,P){if(!this._visibleDemTiles)return null;const V=this._visibleDemTiles.filter(W=>W.dem).map(W=>{const $=W.tileID,G=1<<$.overscaledZ,{x:tt,y:ht}=$.canonical,lt=tt/G,bt=(tt+1)/G,Dt=ht/G,Bt=(ht+1)/G;return{minx:lt,miny:Dt,maxx:bt,maxy:Bt,t:W.dem.tree.raycastRoot(lt,Dt,bt,Bt,h,_,P),tile:W}});V.sort((W,$)=>(null!==W.t?W.t:Number.MAX_VALUE)-(null!==$.t?$.t:Number.MAX_VALUE));for(const W of V){if(null==W.t)return null;const $=W.tile.dem.tree.raycast(W.minx,W.miny,W.maxx,W.maxy,h,_,P);if(null!=$)return $}return null}_createFBO(){const h=this.painter.context,_=h.gl,P=this.drapeBufferSize;h.activeTexture.set(_.TEXTURE0);const V=new b.Texture(h,{width:P[0],height:P[1],data:null},_.RGBA);V.bind(_.LINEAR,_.CLAMP_TO_EDGE);const W=h.createFramebuffer(P[0],P[1],!1);return W.colorAttachment.set(V.texture),W.depthAttachment=new xt(h,W.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,P[0],P[1]),this._stencilRef=0,W.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):W.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&_.texParameterf(_.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:W,tex:V,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const _=this._style._layers[h],P=_.isHidden(this.painter.transform.zoom);return"custom"===_.type?!P&&_.shouldRedrape():!P&&_.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const P of this._style._getSources())if(P instanceof ct){h=!0;break}if(!h)return;const _={};for(let P=0;P<this._style.order.length;++P){const V=this._style._layers[this._style.order[P]],W=this._style._getLayerSourceCache(V);if(W&&!_[W.id]&&!V.isHidden(this.painter.transform.zoom)&&"line"===V.type&&V.widthExpression()instanceof b.ZoomDependentExpression){_[W.id]=!0;for(const $ of this.proxyCoords){const G=this.proxyToSource[$.key][W.id];if(G)for(const tt of G)this._clearRenderCacheForTile(W.id,tt)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const P in this._style._sourceCaches)if(this._style._sourceCaches[P]._source instanceof pt){h=!0;break}if(!h)return;const _={};for(let P=0;P<this._style.order.length;++P){const V=this._style._layers[this._style.order[P]],W=this._style._getLayerSourceCache(V);if(!W||_[W.id]||V.isHidden(this.painter.transform.zoom)||"raster"!==V.type)continue;const $=V.paint.get("raster-fade-duration");for(const G of this.proxyCoords){const tt=this.proxyToSource[G.key][W.id];if(tt)for(const ht of tt){const lt=el(W.getTile(ht),W.findLoadedParent(ht,0),W,this.painter.transform,$);(1!==lt.opacity||0!==lt.mix)&&this._clearRenderCacheForTile(W.id,ht)}}}}_setupDrapedRenderBatches(){const h=this._style.order,_=h.length;if(0===_)return;const P=[];let V,W=0,$=this._style._layers[h[W]];for(;!this._style.isLayerDraped($)&&$.isHidden(this.painter.transform.zoom)&&++W<_;)$=this._style._layers[h[W]];for(;W<_;++W){const G=this._style._layers[h[W]];G.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(G)?void 0===V&&(V=W):void 0!==V&&(P.push({start:V,end:W-1}),V=void 0))}void 0!==V&&P.push({start:V,end:W-1}),this._drapedRenderBatches=P}_setupRenderCache(h){const _=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,_.renderCache.length>_.renderCachePool.length){const $=Object.values(_.proxyCachedFBO);_.proxyCachedFBO={};for(let G=0;G<$.length;++G){const tt=Object.values($[G]);_.renderCachePool.push(...tt)}}return}this._clearRasterLayersFromRenderCache();const P=this.proxyCoords,V=this._tilesDirty;for(let $=P.length-1;$>=0;$--){const G=P[$];if(_.getTileByID(G.key),void 0!==_.proxyCachedFBO[G.key]){const tt=h[G.key],ht=this.proxyToSource[G.key];let lt=0;for(const bt in ht){const Dt=ht[bt],Bt=tt[bt];if(!Bt||Bt.length!==Dt.length||Dt.some((Nt,Ot)=>Nt!==Bt[Ot]||V[bt]&&V[bt].hasOwnProperty(Nt.key))){lt=-1;break}++lt}for(const bt in _.proxyCachedFBO[G.key])_.renderCache[_.proxyCachedFBO[G.key][bt]].dirty=lt<0||lt!==Object.values(tt).length}}const W=[...this._drapedRenderBatches];W.sort(($,G)=>G.end-G.start-($.end-$.start));for(const $ of W)for(const G of P){if(_.proxyCachedFBO[G.key])continue;let tt=_.renderCachePool.pop();void 0===tt&&_.renderCache.length<50&&(tt=_.renderCache.length,_.renderCache.push(this._createFBO())),void 0!==tt&&(_.proxyCachedFBO[G.key]={},_.proxyCachedFBO[G.key][$.start]=tt,_.renderCache[tt].dirty=!0)}this._tilesDirty={}}_setupStencil(h,_,P,V){if(!V||!this._sourceTilesOverlap[V.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const W=this.painter.context,$=W.gl;if(_.length<=1)return void(this._overlapStencilType=!1);let G;if(P.isTileClipped())G=_.length,this._overlapStencilMode.test={func:$.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(_[0].overscaledZ>_[_.length-1].overscaledZ))return void(this._overlapStencilType=!1);G=1,this._overlapStencilMode.test={func:$.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+G>255&&(W.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=G,this._overlapStencilMode.ref=this._stencilRef,P.isTileClipped()&&this._renderTileClippingMasks(_,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):b.StencilMode.disabled}_renderTileClippingMasks(h,_){const P=this.painter,V=this.painter.context,W=V.gl;P._tileClippingMaskIDs={},V.setColorMode(b.ColorMode.disabled),V.setDepthMode(b.DepthMode.disabled);const $=P.useProgram("clippingMask");for(const G of h){const tt=P._tileClippingMaskIDs[G.key]=--_;$.draw(V,W.TRIANGLES,b.DepthMode.disabled,new b.StencilMode({func:W.ALWAYS,mask:0},tt,255,W.KEEP,W.KEEP,W.REPLACE),b.ColorMode.disabled,b.CullFaceMode.disabled,rs(G.projMatrix),"$clipping",P.tileExtentBuffer,P.quadTriangleIndexBuffer,P.tileExtentSegments)}}pointCoordinate(h){const _=this.painter.transform;if(h.x<0||h.x>_.width||h.y<0||h.y>_.height)return null;const P=[h.x,h.y,1,1];b.transformMat4$1(P,P,_.pixelMatrixInverse),b.scale$1(P,P,1/P[3]),P[0]/=_.worldSize,P[1]/=_.worldSize;const V=_._camera.position,W=b.mercatorZfromAltitude(1,_.center.lat),$=[V[0],V[1],V[2]/W,0],G=b.subtract([],P.slice(0,3),$);b.normalize(G,G);const tt=this.raycast($,G,this._exaggeration);return null!==tt&&tt?(b.scaleAndAdd($,$,G,tt),$[3]=$[2],$[2]*=W,$):null}drawDepth(){const h=this.painter,_=h.context,P=this.proxySourceCache,V=Math.ceil(h.width),W=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===V&&this._depthFBO.height===W||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const $=_.gl,G=_.createFramebuffer(V,W,!0);_.activeTexture.set($.TEXTURE0);const tt=new b.Texture(_,{width:V,height:W,data:null},$.RGBA);tt.bind($.NEAREST,$.CLAMP_TO_EDGE),G.colorAttachment.set(tt.texture);const ht=_.createRenderbuffer(_.gl.DEPTH_COMPONENT16,V,W);G.depthAttachment.set(ht),this._depthFBO=G,this._depthTexture=tt}_.bindFramebuffer.set(this._depthFBO.framebuffer),_.viewport.set([0,0,V,W]),function($,G,tt,ht){if("globe"===$.transform.projection.name)return;const lt=$.context,bt=lt.gl;lt.clear({depth:1});const Dt=$.useProgram("terrainDepth"),Bt=new b.DepthMode(bt.LESS,b.DepthMode.ReadWrite,$.depthRangeFor3D);for(const Nt of ht){const Ot=tt.getTile(Nt),zt=$l(Nt.projMatrix,0);G.setupElevationDraw(Ot,Dt),Dt.draw(lt,bt.TRIANGLES,Bt,b.StencilMode.disabled,b.ColorMode.unblended,b.CullFaceMode.backCCW,zt,"terrain_depth",G.gridBuffer,G.gridIndexBuffer,G.gridNoSkirtSegments)}}(h,this,P,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,_,P){if(h.getSource()instanceof Gt)return this._setupProxiedCoordsForImageSource(h,_,P);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const V=this.proxiedCoords[h.id]=[],W=this.proxyCoords;for(let G=0;G<W.length;G++){const tt=W[G],ht=this._findTileCoveringTileID(tt,h);if(ht){const lt=this._createProxiedId(tt,ht,P[tt.key]&&P[tt.key][h.id]);V.push(lt),this.proxyToSource[tt.key][h.id]=[lt]}}let $=!1;for(let G=0;G<_.length;G++){const tt=h.getTile(_[G]);if(!tt||!tt.hasData())continue;const ht=this._findTileCoveringTileID(tt.tileID,this.proxySourceCache);if(ht&&ht.tileID.canonical.z!==tt.tileID.canonical.z){const lt=this.proxyToSource[ht.tileID.key][h.id],bt=this._createProxiedId(ht.tileID,tt,P[ht.tileID.key]&&P[ht.tileID.key][h.id]);lt?lt.splice(lt.length-1,0,bt):this.proxyToSource[ht.tileID.key][h.id]=[bt],V.push(bt),$=!0}}this._sourceTilesOverlap[h.id]=$}_setupProxiedCoordsForImageSource(h,_,P){if(!h.getSource().loaded())return;const V=this.proxiedCoords[h.id]=[],W=this.proxyCoords,$=h.getSource(),G=new b.pointGeometry($.tileID.x,$.tileID.y)._div(1<<$.tileID.z),tt=$.coordinates.map(b.MercatorCoordinate.fromLngLat).reduce((lt,bt)=>(lt.min.x=Math.min(lt.min.x,bt.x-G.x),lt.min.y=Math.min(lt.min.y,bt.y-G.y),lt.max.x=Math.max(lt.max.x,bt.x-G.x),lt.max.y=Math.max(lt.max.y,bt.y-G.y),lt),{min:new b.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new b.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),ht=(lt,bt)=>{const Dt=lt.wrap+lt.canonical.x/(1<<lt.canonical.z),Bt=lt.canonical.y/(1<<lt.canonical.z),Nt=b.EXTENT/(1<<lt.canonical.z),Ot=bt.wrap+bt.canonical.x/(1<<bt.canonical.z),zt=bt.canonical.y/(1<<bt.canonical.z);return Dt+Nt<Ot+tt.min.x||Dt>Ot+tt.max.x||Bt+Nt<zt+tt.min.y||Bt>zt+tt.max.y};for(let lt=0;lt<W.length;lt++){const bt=W[lt];for(let Dt=0;Dt<_.length;Dt++){const Bt=h.getTile(_[Dt]);if(!Bt||!Bt.hasData()||ht(bt,Bt.tileID))continue;const Nt=this._createProxiedId(bt,Bt,P[bt.key]&&P[bt.key][h.id]),Ot=this.proxyToSource[bt.key][h.id];Ot?Ot.push(Nt):this.proxyToSource[bt.key][h.id]=[Nt],V.push(Nt)}}}_createProxiedId(h,_,P){let V=this.orthoMatrix;if(P){const W=P.find($=>$.key===_.tileID.key);if(W)return W}if(_.tileID.key!==h.key){const W=h.canonical.z-_.tileID.canonical.z;let $,G,tt;V=b.create();const ht=_.tileID.wrap-h.wrap<<h.overscaledZ;W>0?($=b.EXTENT>>W,G=$*((_.tileID.canonical.x<<W)-h.canonical.x+ht),tt=$*((_.tileID.canonical.y<<W)-h.canonical.y)):($=b.EXTENT<<-W,G=b.EXTENT*(_.tileID.canonical.x-(h.canonical.x+ht<<-W)),tt=b.EXTENT*(_.tileID.canonical.y-(h.canonical.y<<-W))),b.ortho(V,0,$,0,$,0,1),b.translate(V,V,[G,tt,0])}return new Cu(_.tileID,h.key,V)}_findTileCoveringTileID(h,_){let P=_.getTile(h);if(P&&P.hasData())return P;const V=this._findCoveringTileCache[_.id],W=V[h.key];if(P=W?_.getTileByID(W):null,P&&P.hasData()||null===W)return P;let $=P?P.tileID:h,G=$.overscaledZ;const tt=_.getSource().minzoom,ht=[];if(!W){const bt=_.getSource().maxzoom;if(h.canonical.z>=bt){const Dt=h.canonical.z-bt;_.getSource().reparseOverscaled?(G=Math.max(h.canonical.z+2,_.transform.tileZoom),$=new b.OverscaledTileID(G,h.wrap,bt,h.canonical.x>>Dt,h.canonical.y>>Dt)):0!==Dt&&(G=bt,$=new b.OverscaledTileID(G,h.wrap,bt,h.canonical.x>>Dt,h.canonical.y>>Dt))}$.key!==h.key&&(ht.push($.key),P=_.getTile($))}const lt=bt=>{ht.forEach(Dt=>{V[Dt]=bt}),ht.length=0};for(G-=1;G>=tt&&(!P||!P.hasData());G--){P&&lt(P.tileID.key);const bt=$.calculateScaledKey(G);if(P=_.getTileByID(bt),P&&P.hasData())break;const Dt=V[bt];if(null===Dt)break;void 0===Dt?ht.push(bt):P=_.getTileByID(Dt)}return lt(P?P.tileID.key:null),P&&P.hasData()?P:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,_){let P=this._tilesDirty[h];P||(P=this._tilesDirty[h]={}),P[_.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(_){let P=0;const V=new b.StructArrayLayout2ui4,W=131;for(let $=1;$<129;$++){for(let G=1;G<129;G++)P=$*W+G,V.emplaceBack(P,P+1),V.emplaceBack(P,P+W),V.emplaceBack(P+1,P+W),128===$&&V.emplaceBack(P+W,P+W+1);V.emplaceBack(P+1,P+1+W)}return V}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=b.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class na{static cacheKey(h,_,P,V){let W=`${_}${V?V.cacheKey:""}`;for(const $ of P)h.usedDefines.includes($)&&(W+=`/${$}`);return W}constructor(h,_,P,V,W,$){const G=h.gl;this.program=G.createProgram();const tt=function(At){const Qt=[];for(let Jt=0;Jt<At.length;Jt++){if(null===At[Jt])continue;const ne=At[Jt].split(" ");Qt.push(ne.pop())}return Qt}(P.staticAttributes),ht=V?V.getBinderAttributes():[],lt=tt.concat(ht);let bt=V?V.defines():[];bt=bt.concat($.map(At=>`#define ${At}`));const Dt=h.isWebGL2?"#version 300 es\n":"",Bt=Dt+bt.concat(h.extStandardDerivatives&&0===Dt.length?"#extension GL_OES_standard_derivatives : enable\n".concat(wu):wu,wu,Qs,jf.fragmentSource,Or.fragmentSource,P.fragmentSource).join("\n"),Nt=Dt+bt.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",Qs,jf.vertexSource,Or.vertexSource,bu.vertexSource,P.vertexSource).join("\n"),Ot=G.createShader(G.FRAGMENT_SHADER);if(G.isContextLost())return void(this.failedToCreate=!0);G.shaderSource(Ot,Bt),G.compileShader(Ot),G.attachShader(this.program,Ot);const zt=G.createShader(G.VERTEX_SHADER);if(G.isContextLost())this.failedToCreate=!0;else{G.shaderSource(zt,Nt),G.compileShader(zt),G.attachShader(this.program,zt),this.attributes={},this.numAttributes=lt.length;for(let At=0;At<this.numAttributes;At++)lt[At]&&(G.bindAttribLocation(this.program,At,lt[At]),this.attributes[lt[At]]=At);G.linkProgram(this.program),G.deleteShader(zt),G.deleteShader(Ot),this.fixedUniforms=W(h),this.binderUniforms=V?V.getUniforms(h):[],$.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new b.Uniform1i(At=h),u_dem_prev:new b.Uniform1i(At),u_dem_unpack:new b.Uniform4f(At),u_dem_tl:new b.Uniform2f(At),u_dem_scale:new b.Uniform1f(At),u_dem_tl_prev:new b.Uniform2f(At),u_dem_scale_prev:new b.Uniform1f(At),u_dem_size:new b.Uniform1f(At),u_dem_lerp:new b.Uniform1f(At),u_exaggeration:new b.Uniform1f(At),u_depth:new b.Uniform1i(At),u_depth_size_inv:new b.Uniform2f(At),u_meter_to_dem:new b.Uniform1f(At),u_label_plane_matrix_inv:new b.UniformMatrix4f(At)}),$.includes("GLOBE")&&(this.globeUniforms=(At=>({u_tile_tl_up:new b.Uniform3f(At),u_tile_tr_up:new b.Uniform3f(At),u_tile_br_up:new b.Uniform3f(At),u_tile_bl_up:new b.Uniform3f(At),u_tile_up_scale:new b.Uniform1f(At)}))(h)),$.includes("FOG")&&(this.fogUniforms=(At=>({u_fog_matrix:new b.UniformMatrix4f(At),u_fog_range:new b.Uniform2f(At),u_fog_color:new b.Uniform4f(At),u_fog_horizon_blend:new b.Uniform1f(At),u_fog_temporal_offset:new b.Uniform1f(At),u_frustum_tl:new b.Uniform3f(At),u_frustum_tr:new b.Uniform3f(At),u_frustum_br:new b.Uniform3f(At),u_frustum_bl:new b.Uniform3f(At),u_globe_pos:new b.Uniform3f(At),u_globe_radius:new b.Uniform1f(At),u_globe_transition:new b.Uniform1f(At),u_is_globe:new b.Uniform1i(At),u_viewport:new b.Uniform2f(At)}))(h))}var At}setTerrainUniformValues(h,_){if(!this.terrainUniforms)return;const P=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const V in _)P[V]&&P[V].set(this.program,V,_[V])}}setGlobeUniformValues(h,_){if(!this.globeUniforms)return;const P=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const V in _)P[V]&&P[V].set(this.program,V,_[V])}}setFogUniformValues(h,_){if(!this.fogUniforms)return;const P=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const V in _)P[V].set(this.program,V,_[V])}}draw(h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot){const zt=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(P),h.setStencilMode(V),h.setColorMode(W),h.setCullFace($);for(const Qt of Object.keys(this.fixedUniforms))this.fixedUniforms[Qt].set(this.program,Qt,G[Qt]);Nt&&Nt.setUniforms(this.program,h,this.binderUniforms,Dt,{zoom:Bt});const At={[zt.LINES]:2,[zt.TRIANGLES]:3,[zt.LINE_STRIP]:1}[_];for(const Qt of bt.get()){const Jt=Qt.vaos||(Qt.vaos={});(Jt[tt]||(Jt[tt]=new Hl)).bind(h,this,ht,Nt?Nt.getPaintVertexBuffers():[],lt,Qt.vertexOffset,Ot||[]),zt.drawElements(_,Qt.primitiveLength*At,zt.UNSIGNED_SHORT,Qt.primitiveOffset*At*2)}}}function sa(S,h){const _=Math.pow(2,h.tileID.overscaledZ),P=h.tileSize*Math.pow(2,S.transform.tileZoom)/_,V=P*(h.tileID.canonical.x+h.tileID.wrap*_),W=P*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/Mn(h,1,S.transform.tileZoom),u_pixel_coord_upper:[V>>16,W>>16],u_pixel_coord_lower:[65535&V,65535&W]}}const il=b.create(),_s=(S,h,_,P,V,W,$,G,tt,ht,lt)=>{const bt=h.style.light,Dt=bt.properties.get("position"),Bt=[Dt.x,Dt.y,Dt.z],Nt=b.create$1();"viewport"===bt.properties.get("anchor")&&(b.fromRotation(Nt,-h.transform.angle),b.transformMat3(Bt,Bt,Nt));const Ot=bt.properties.get("color"),zt=h.transform,At={u_matrix:S,u_lightpos:Bt,u_lightintensity:bt.properties.get("intensity"),u_lightcolor:[Ot.r,Ot.g,Ot.b],u_vertical_gradient:+_,u_opacity:P,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:il,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:V,u_edge_radius:W};return"globe"===zt.projection.name&&(At.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],At.u_zoom_transition=tt,At.u_inv_rot_matrix=lt,At.u_merc_center=ht,At.u_up_dir=zt.projection.upVector(new b.CanonicalTileID(0,0,0),ht[0]*b.EXTENT,ht[1]*b.EXTENT),At.u_height_lift=G),At},Ch=(S,h,_,P,V,W,$,G,tt,ht,lt,bt)=>{const Dt=_s(S,h,_,P,V,W,$,tt,ht,lt,bt),Bt={u_height_factor:-Math.pow(2,$.overscaledZ)/G.tileSize/8};return b.extend(Dt,sa(h,G),Bt)},Th=S=>({u_matrix:S}),Sh=(S,h,_)=>b.extend(Th(S),sa(h,_)),Tu=(S,h)=>({u_matrix:S,u_world:h}),Ba=(S,h,_,P)=>b.extend(Sh(S,h,_),{u_world:P}),bc=b.create(),wc=(S,h,_,P,V,W)=>{const $=S.transform,G="globe"===$.projection.name;let tt;if("map"===W.paint.get("circle-pitch-alignment"))if(G){const lt=b.globePixelsToTileUnits($.zoom,h.canonical)*$._pixelsPerMercatorPixel;tt=Float32Array.from([lt,0,0,lt])}else tt=$.calculatePixelsToTileUnitsMatrix(_);else tt=new Float32Array([$.pixelsToGLUnits[0],0,0,$.pixelsToGLUnits[1]]);const ht={u_camera_to_center_distance:$.cameraToCenterDistance,u_matrix:S.translatePosMatrix(h.projMatrix,_,W.paint.get("circle-translate"),W.paint.get("circle-translate-anchor")),u_device_pixel_ratio:b.exported.devicePixelRatio,u_extrude_scale:tt,u_inv_rot_matrix:bc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){ht.u_inv_rot_matrix=P,ht.u_merc_center=V,ht.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],ht.u_zoom_transition=b.globeToMercatorTransition($.zoom);const lt=V[0]*b.EXTENT,bt=V[1]*b.EXTENT;ht.u_up_dir=$.projection.upVector(new b.CanonicalTileID(0,0,0),lt,bt)}return ht},po=S=>{const h=[];return"map"===S.paint.get("circle-pitch-alignment")&&h.push("PITCH_WITH_MAP"),"map"===S.paint.get("circle-pitch-scale")&&h.push("SCALE_WITH_MAP"),h},Kp=(S,h,_,P)=>{const V=b.EXTENT/_.tileSize;return{u_matrix:S,u_camera_to_center_distance:h.getCameraToCenterDistance(P),u_extrude_scale:[h.pixelsToGLUnits[0]/V,h.pixelsToGLUnits[1]/V]}},Mc=(S,h,_=1)=>({u_matrix:S,u_color:h,u_overlay:0,u_overlay_scale:_}),Su=b.create(),ws=(S,h,_,P,V,W,$)=>{const G=S.transform,tt="globe"===G.projection.name,ht=tt?b.globePixelsToTileUnits(G.zoom,h.canonical)*G._pixelsPerMercatorPixel:Mn(_,1,W),lt={u_matrix:h.projMatrix,u_extrude_scale:ht,u_intensity:$,u_inv_rot_matrix:Su,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(tt){lt.u_inv_rot_matrix=P,lt.u_merc_center=V,lt.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],lt.u_zoom_transition=b.globeToMercatorTransition(G.zoom);const bt=V[0]*b.EXTENT,Dt=V[1]*b.EXTENT;lt.u_up_dir=G.projection.upVector(new b.CanonicalTileID(0,0,0),bt,Dt)}return lt},ku=(S,h,_,P,V,W,$)=>{const G=S.transform,tt=G.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:dr(S,h,_,P),u_pixels_to_tile_units:tt,u_device_pixel_ratio:W,u_units_to_pixels:[1/G.pixelsToGLUnits[0],1/G.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:V,u_texsize:Ms(_)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ji(h,S.transform),u_alpha_discard_threshold:0,u_trim_offset:$}},Au=(S,h,_,P,V)=>{const W=S.transform;return{u_matrix:dr(S,h,_,P),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:W.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:V,u_image:0,u_tile_units_to_pixels:Ji(h,W),u_units_to_pixels:[1/W.pixelsToGLUnits[0],1/W.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ji(S,h){return 1/Mn(S,1,h.tileZoom)}function dr(S,h,_,P){return S.translatePosMatrix(P||h.tileID.projMatrix,h,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}function Ms(S){const h=S.paint.get("line-dasharray").value;return h.value||"constant"!==h.kind}const ur=(S,h,_,P,V,W)=>{return{u_matrix:S,u_tl_parent:h,u_scale_parent:_,u_fade_t:P.mix,u_opacity:P.opacity*V.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:V.paint.get("raster-brightness-min"),u_brightness_high:V.paint.get("raster-brightness-max"),u_saturation_factor:(G=V.paint.get("raster-saturation"),G>0?1-1/(1.001-G):-G),u_contrast_factor:($=V.paint.get("raster-contrast"),$>0?1/(1-$):1+$),u_spin_weights:pr(V.paint.get("raster-hue-rotate")),u_perspective_transform:W};var $,G};function pr(S){S*=Math.PI/180;const h=Math.sin(S),_=Math.cos(S);return[(2*_+1)/3,(-Math.sqrt(3)*h-_+1)/3,(Math.sqrt(3)*h-_+1)/3]}const Gl=b.create(),Ko=(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot)=>{const zt=V.transform,At={u_is_size_zoom_constant:+("constant"===S||"source"===S),u_is_size_feature_constant:+("constant"===S||"camera"===S),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:zt.cameraToCenterDistance,u_rotate_symbol:+_,u_aspect_ratio:zt.width/zt.height,u_fade_change:V.options.fadeDuration?V.symbolFadeChange:1,u_matrix:W,u_label_plane_matrix:$,u_coord_matrix:G,u_is_text:+tt,u_pitch_with_map:+P,u_texsize:ht,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Gl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Gl,u_up_vector:[0,-1,0]};return"globe"===Ot.name&&(At.u_tile_id=[lt.canonical.x,lt.canonical.y,1<<lt.canonical.z],At.u_zoom_transition=bt,At.u_inv_rot_matrix=Bt,At.u_merc_center=Dt,At.u_camera_forward=zt._camera.forward(),At.u_ecef_origin=b.globeECEFOrigin(zt.globeMatrix,lt.toUnwrapped()),At.u_tile_matrix=Float32Array.from(zt.globeMatrix),At.u_up_vector=Nt),At},Pu=(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt)=>b.extend(Ko(S,h,_,P,V,W,$,G,tt,ht,bt,Dt,Bt,Nt,Ot,zt),{u_gamma_scale:P?V.transform.cameraToCenterDistance*Math.cos(V.terrain?0:V.transform._pitch):1,u_device_pixel_ratio:b.exported.devicePixelRatio,u_is_halo:+lt}),fd=(S,h,_,P,V,W,$,G,tt,ht,lt,bt,Dt,Bt,Nt,Ot)=>b.extend(Pu(S,h,_,P,V,W,$,G,!0,tt,!0,lt,bt,Dt,Bt,Nt,Ot),{u_texsize_icon:ht,u_texture_icon:1}),gd=(S,h,_)=>({u_matrix:S,u_opacity:h,u_color:_}),ya=(S,h,_,P,V)=>b.extend(function(W,$,G){const tt=$.imageManager.getPattern(W.toString()),{width:ht,height:lt}=$.imageManager.getPixelSize(),bt=Math.pow(2,G.tileID.overscaledZ),Dt=G.tileSize*Math.pow(2,$.transform.tileZoom)/bt,Bt=Dt*(G.tileID.canonical.x+G.tileID.wrap*bt),Nt=Dt*G.tileID.canonical.y;return{u_image:0,u_pattern_tl:tt.tl,u_pattern_br:tt.br,u_texsize:[ht,lt],u_pattern_size:tt.displaySize,u_tile_units_to_pixels:1/Mn(G,1,$.transform.tileZoom),u_pixel_coord_upper:[Bt>>16,Nt>>16],u_pixel_coord_lower:[65535&Bt,65535&Nt]}}(P,_,V),{u_matrix:S,u_opacity:h}),on={fillExtrusion:S=>({u_matrix:new b.UniformMatrix4f(S),u_lightpos:new b.Uniform3f(S),u_lightintensity:new b.Uniform1f(S),u_lightcolor:new b.Uniform3f(S),u_vertical_gradient:new b.Uniform1f(S),u_opacity:new b.Uniform1f(S),u_edge_radius:new b.Uniform1f(S),u_ao:new b.Uniform2f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_up_dir:new b.Uniform3f(S),u_height_lift:new b.Uniform1f(S)}),fillExtrusionPattern:S=>({u_matrix:new b.UniformMatrix4f(S),u_lightpos:new b.Uniform3f(S),u_lightintensity:new b.Uniform1f(S),u_lightcolor:new b.Uniform3f(S),u_vertical_gradient:new b.Uniform1f(S),u_height_factor:new b.Uniform1f(S),u_edge_radius:new b.Uniform1f(S),u_ao:new b.Uniform2f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_up_dir:new b.Uniform3f(S),u_height_lift:new b.Uniform1f(S),u_image:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_pixel_coord_upper:new b.Uniform2f(S),u_pixel_coord_lower:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S),u_opacity:new b.Uniform1f(S)}),fill:S=>({u_matrix:new b.UniformMatrix4f(S)}),fillPattern:S=>({u_matrix:new b.UniformMatrix4f(S),u_image:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_pixel_coord_upper:new b.Uniform2f(S),u_pixel_coord_lower:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S)}),fillOutline:S=>({u_matrix:new b.UniformMatrix4f(S),u_world:new b.Uniform2f(S)}),fillOutlinePattern:S=>({u_matrix:new b.UniformMatrix4f(S),u_world:new b.Uniform2f(S),u_image:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_pixel_coord_upper:new b.Uniform2f(S),u_pixel_coord_lower:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S)}),circle:S=>({u_camera_to_center_distance:new b.Uniform1f(S),u_extrude_scale:new b.UniformMatrix2f(S),u_device_pixel_ratio:new b.Uniform1f(S),u_matrix:new b.UniformMatrix4f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_up_dir:new b.Uniform3f(S)}),collisionBox:S=>({u_matrix:new b.UniformMatrix4f(S),u_camera_to_center_distance:new b.Uniform1f(S),u_extrude_scale:new b.Uniform2f(S)}),collisionCircle:S=>({u_matrix:new b.UniformMatrix4f(S),u_inv_matrix:new b.UniformMatrix4f(S),u_camera_to_center_distance:new b.Uniform1f(S),u_viewport_size:new b.Uniform2f(S)}),debug:S=>({u_color:new b.UniformColor(S),u_matrix:new b.UniformMatrix4f(S),u_overlay:new b.Uniform1i(S),u_overlay_scale:new b.Uniform1f(S)}),clippingMask:S=>({u_matrix:new b.UniformMatrix4f(S)}),heatmap:S=>({u_extrude_scale:new b.Uniform1f(S),u_intensity:new b.Uniform1f(S),u_matrix:new b.UniformMatrix4f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_up_dir:new b.Uniform3f(S)}),heatmapTexture:S=>({u_image:new b.Uniform1i(S),u_color_ramp:new b.Uniform1i(S),u_opacity:new b.Uniform1f(S)}),hillshade:S=>({u_matrix:new b.UniformMatrix4f(S),u_image:new b.Uniform1i(S),u_latrange:new b.Uniform2f(S),u_light:new b.Uniform2f(S),u_shadow:new b.UniformColor(S),u_highlight:new b.UniformColor(S),u_accent:new b.UniformColor(S)}),hillshadePrepare:S=>({u_matrix:new b.UniformMatrix4f(S),u_image:new b.Uniform1i(S),u_dimension:new b.Uniform2f(S),u_zoom:new b.Uniform1f(S),u_unpack:new b.Uniform4f(S)}),line:S=>({u_matrix:new b.UniformMatrix4f(S),u_pixels_to_tile_units:new b.UniformMatrix2f(S),u_device_pixel_ratio:new b.Uniform1f(S),u_units_to_pixels:new b.Uniform2f(S),u_dash_image:new b.Uniform1i(S),u_gradient_image:new b.Uniform1i(S),u_image_height:new b.Uniform1f(S),u_texsize:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S),u_alpha_discard_threshold:new b.Uniform1f(S),u_trim_offset:new b.Uniform2f(S)}),linePattern:S=>({u_matrix:new b.UniformMatrix4f(S),u_texsize:new b.Uniform2f(S),u_pixels_to_tile_units:new b.UniformMatrix2f(S),u_device_pixel_ratio:new b.Uniform1f(S),u_image:new b.Uniform1i(S),u_units_to_pixels:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S),u_alpha_discard_threshold:new b.Uniform1f(S)}),raster:S=>({u_matrix:new b.UniformMatrix4f(S),u_tl_parent:new b.Uniform2f(S),u_scale_parent:new b.Uniform1f(S),u_fade_t:new b.Uniform1f(S),u_opacity:new b.Uniform1f(S),u_image0:new b.Uniform1i(S),u_image1:new b.Uniform1i(S),u_brightness_low:new b.Uniform1f(S),u_brightness_high:new b.Uniform1f(S),u_saturation_factor:new b.Uniform1f(S),u_contrast_factor:new b.Uniform1f(S),u_spin_weights:new b.Uniform3f(S),u_perspective_transform:new b.Uniform2f(S)}),symbolIcon:S=>({u_is_size_zoom_constant:new b.Uniform1i(S),u_is_size_feature_constant:new b.Uniform1i(S),u_size_t:new b.Uniform1f(S),u_size:new b.Uniform1f(S),u_camera_to_center_distance:new b.Uniform1f(S),u_rotate_symbol:new b.Uniform1i(S),u_aspect_ratio:new b.Uniform1f(S),u_fade_change:new b.Uniform1f(S),u_matrix:new b.UniformMatrix4f(S),u_label_plane_matrix:new b.UniformMatrix4f(S),u_coord_matrix:new b.UniformMatrix4f(S),u_is_text:new b.Uniform1i(S),u_pitch_with_map:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_camera_forward:new b.Uniform3f(S),u_tile_matrix:new b.UniformMatrix4f(S),u_up_vector:new b.Uniform3f(S),u_ecef_origin:new b.Uniform3f(S),u_texture:new b.Uniform1i(S)}),symbolSDF:S=>({u_is_size_zoom_constant:new b.Uniform1i(S),u_is_size_feature_constant:new b.Uniform1i(S),u_size_t:new b.Uniform1f(S),u_size:new b.Uniform1f(S),u_camera_to_center_distance:new b.Uniform1f(S),u_rotate_symbol:new b.Uniform1i(S),u_aspect_ratio:new b.Uniform1f(S),u_fade_change:new b.Uniform1f(S),u_matrix:new b.UniformMatrix4f(S),u_label_plane_matrix:new b.UniformMatrix4f(S),u_coord_matrix:new b.UniformMatrix4f(S),u_is_text:new b.Uniform1i(S),u_pitch_with_map:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_texture:new b.Uniform1i(S),u_gamma_scale:new b.Uniform1f(S),u_device_pixel_ratio:new b.Uniform1f(S),u_tile_id:new b.Uniform3f(S),u_zoom_transition:new b.Uniform1f(S),u_inv_rot_matrix:new b.UniformMatrix4f(S),u_merc_center:new b.Uniform2f(S),u_camera_forward:new b.Uniform3f(S),u_tile_matrix:new b.UniformMatrix4f(S),u_up_vector:new b.Uniform3f(S),u_ecef_origin:new b.Uniform3f(S),u_is_halo:new b.Uniform1i(S)}),symbolTextAndIcon:S=>({u_is_size_zoom_constant:new b.Uniform1i(S),u_is_size_feature_constant:new b.Uniform1i(S),u_size_t:new b.Uniform1f(S),u_size:new b.Uniform1f(S),u_camera_to_center_distance:new b.Uniform1f(S),u_rotate_symbol:new b.Uniform1i(S),u_aspect_ratio:new b.Uniform1f(S),u_fade_change:new b.Uniform1f(S),u_matrix:new b.UniformMatrix4f(S),u_label_plane_matrix:new b.UniformMatrix4f(S),u_coord_matrix:new b.UniformMatrix4f(S),u_is_text:new b.Uniform1i(S),u_pitch_with_map:new b.Uniform1i(S),u_texsize:new b.Uniform2f(S),u_texsize_icon:new b.Uniform2f(S),u_texture:new b.Uniform1i(S),u_texture_icon:new b.Uniform1i(S),u_gamma_scale:new b.Uniform1f(S),u_device_pixel_ratio:new b.Uniform1f(S),u_is_halo:new b.Uniform1i(S)}),background:S=>({u_matrix:new b.UniformMatrix4f(S),u_opacity:new b.Uniform1f(S),u_color:new b.UniformColor(S)}),backgroundPattern:S=>({u_matrix:new b.UniformMatrix4f(S),u_opacity:new b.Uniform1f(S),u_image:new b.Uniform1i(S),u_pattern_tl:new b.Uniform2f(S),u_pattern_br:new b.Uniform2f(S),u_texsize:new b.Uniform2f(S),u_pattern_size:new b.Uniform2f(S),u_pixel_coord_upper:new b.Uniform2f(S),u_pixel_coord_lower:new b.Uniform2f(S),u_tile_units_to_pixels:new b.Uniform1f(S)}),terrainRaster:vc,terrainDepth:vc,skybox:S=>({u_matrix:new b.UniformMatrix4f(S),u_sun_direction:new b.Uniform3f(S),u_cubemap:new b.Uniform1i(S),u_opacity:new b.Uniform1f(S),u_temporal_offset:new b.Uniform1f(S)}),skyboxGradient:S=>({u_matrix:new b.UniformMatrix4f(S),u_color_ramp:new b.Uniform1i(S),u_center_direction:new b.Uniform3f(S),u_radius:new b.Uniform1f(S),u_opacity:new b.Uniform1f(S),u_temporal_offset:new b.Uniform1f(S)}),skyboxCapture:S=>({u_matrix_3f:new b.UniformMatrix3f(S),u_sun_direction:new b.Uniform3f(S),u_sun_intensity:new b.Uniform1f(S),u_color_tint_r:new b.Uniform4f(S),u_color_tint_m:new b.Uniform4f(S),u_luminance:new b.Uniform1f(S)}),globeRaster:S=>({u_proj_matrix:new b.UniformMatrix4f(S),u_globe_matrix:new b.UniformMatrix4f(S),u_normalize_matrix:new b.UniformMatrix4f(S),u_merc_matrix:new b.UniformMatrix4f(S),u_zoom_transition:new b.Uniform1f(S),u_merc_center:new b.Uniform2f(S),u_image0:new b.Uniform1i(S),u_grid_matrix:new b.UniformMatrix3f(S),u_skirt_height:new b.Uniform1f(S),u_frustum_tl:new b.Uniform3f(S),u_frustum_tr:new b.Uniform3f(S),u_frustum_br:new b.Uniform3f(S),u_frustum_bl:new b.Uniform3f(S),u_globe_pos:new b.Uniform3f(S),u_globe_radius:new b.Uniform1f(S),u_viewport:new b.Uniform2f(S)}),globeAtmosphere:S=>({u_frustum_tl:new b.Uniform3f(S),u_frustum_tr:new b.Uniform3f(S),u_frustum_br:new b.Uniform3f(S),u_frustum_bl:new b.Uniform3f(S),u_horizon:new b.Uniform1f(S),u_transition:new b.Uniform1f(S),u_fadeout_range:new b.Uniform1f(S),u_color:new b.Uniform4f(S),u_high_color:new b.Uniform4f(S),u_space_color:new b.Uniform4f(S),u_star_intensity:new b.Uniform1f(S),u_star_density:new b.Uniform1f(S),u_star_size:new b.Uniform1f(S),u_temporal_offset:new b.Uniform1f(S),u_horizon_angle:new b.Uniform1f(S),u_rotation_matrix:new b.UniformMatrix4f(S)})};let zn;function wo(S,h,_,P,V,W,$){const G=S.context,tt=G.gl,ht=S.transform,lt=S.useProgram("collisionBox"),bt=[];let Dt=0,Bt=0;for(let ne=0;ne<P.length;ne++){const me=P[ne],ue=h.getTile(me),ge=ue.getBucket(_);if(!ge)continue;const be=Ue(me,ge,ht);let Pe=be;0===V[0]&&0===V[1]||(Pe=S.translatePosMatrix(be,ue,V,W));const Ie=$?ge.textCollisionBox:ge.iconCollisionBox,yi=ge.collisionCircleArray;if(yi.length>0){const Se=b.create(),Je=Pe;b.mul(Se,ge.placementInvProjMatrix,ht.glCoordMatrix),b.mul(Se,Se,ge.placementViewportMatrix),bt.push({circleArray:yi,circleOffset:Bt,transform:Je,invTransform:Se,projection:ge.getProjection()}),Dt+=yi.length/4,Bt=Dt}Ie&&(S.terrain&&S.terrain.setupElevationDraw(ue,lt),lt.draw(G,tt.LINES,b.DepthMode.disabled,b.StencilMode.disabled,S.colorModeForRenderPass(),b.CullFaceMode.disabled,Kp(Pe,ht,ue,ge.getProjection()),_.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,null,ht.zoom,null,[Ie.collisionVertexBuffer,Ie.collisionVertexBufferExt]))}if(!$||!bt.length)return;const Nt=S.useProgram("collisionCircle"),Ot=new b.StructArrayLayout2f1f2i16;Ot.resize(4*Dt),Ot._trim();let zt=0;for(const ne of bt)for(let me=0;me<ne.circleArray.length/4;me++){const ue=4*me,ge=ne.circleArray[ue+0],be=ne.circleArray[ue+1],Pe=ne.circleArray[ue+2],Ie=ne.circleArray[ue+3];Ot.emplace(zt++,ge,be,Pe,Ie,0),Ot.emplace(zt++,ge,be,Pe,Ie,1),Ot.emplace(zt++,ge,be,Pe,Ie,2),Ot.emplace(zt++,ge,be,Pe,Ie,3)}(!zn||zn.length<2*Dt)&&(zn=function(ne){const me=2*ne,ue=new b.StructArrayLayout3ui6;ue.resize(me),ue._trim();for(let ge=0;ge<me;ge++){const be=6*ge;ue.uint16[be+0]=4*ge+0,ue.uint16[be+1]=4*ge+1,ue.uint16[be+2]=4*ge+2,ue.uint16[be+3]=4*ge+2,ue.uint16[be+4]=4*ge+3,ue.uint16[be+5]=4*ge+0}return ue}(Dt));const At=G.createIndexBuffer(zn,!0),Qt=G.createVertexBuffer(Ot,b.collisionCircleLayout.members,!0);for(const ne of bt){const me={u_matrix:ne.transform,u_inv_matrix:ne.invTransform,u_camera_to_center_distance:(Jt=ht).getCameraToCenterDistance(ne.projection),u_viewport_size:[Jt.width,Jt.height]};Nt.draw(G,tt.TRIANGLES,b.DepthMode.disabled,b.StencilMode.disabled,S.colorModeForRenderPass(),b.CullFaceMode.disabled,me,_.id,Qt,At,b.SegmentVector.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,ht.zoom)}var Jt;Qt.destroy(),At.destroy()}const Gr=b.create();function bl({width:S,height:h,anchor:_,textOffset:P,textScale:V},W){const{horizontalAlign:$,verticalAlign:G}=b.getAnchorAlignment(_),tt=-($-.5)*S,ht=-(G-.5)*h,lt=b.evaluateVariableOffset(_,P);return new b.pointGeometry((tt/V+lt[0])*W,(ht/V+lt[1])*W)}function Ao(S,h,_,P,V,W,$,G,tt,ht,lt){const bt=S.text.placedSymbolArray,Dt=S.text.dynamicLayoutVertexArray,Bt=S.icon.dynamicLayoutVertexArray,Nt={},Ot=S.getProjection(),zt=ni(G,Ot,W),At=W.elevation,Qt=Ot.upVectorScale(G.canonical,W.center.lat,W.worldSize).metersToTile;Dt.clear();for(let Jt=0;Jt<bt.length;Jt++){const ne=bt.get(Jt),{tileAnchorX:me,tileAnchorY:ue,numGlyphs:ge}=ne,Pe=ne.hidden||!ne.crossTileID||S.allowVerticalPlacement&&!ne.placedOrientation?null:P[ne.crossTileID];if(Pe){let Ie=0,yi=0,Se=0;if(At){const qi=At?At.getAtTileOffset(G,me,ue):0,[Xn,Gi,Fi]=Ot.upVector(G.canonical,me,ue);Ie=qi*Xn*Qt,yi=qi*Gi*Qt,Se=qi*Fi*Qt}let[Je,Ve,ti,Fe]=nt(ne.projectedAnchorX+Ie,ne.projectedAnchorY+yi,ne.projectedAnchorZ+Se,_?zt:$);const we=dt(W.getCameraToCenterDistance(Ot),Fe);let Be=V.evaluateSizeForFeature(S.textSizeData,ht,ne)*we/b.ONE_EM;_&&(Be*=S.tilePixelRatio/tt);const ei=bl(Pe,Be);_?(({x:Je,y:Ve,z:ti}=Ot.projectTilePoint(me+ei.x,ue+ei.y,G.canonical)),[Je,Ve,ti]=nt(Je+Ie,Ve+yi,ti+Se,$)):(h&&ei._rotate(-W.angle),Je+=ei.x,Ve+=ei.y,ti=0);const ci=S.allowVerticalPlacement&&ne.placedOrientation===b.WritingMode.vertical?Math.PI/2:0;for(let qi=0;qi<ge;qi++)b.addDynamicAttributes(Dt,Je,Ve,ti,ci);lt&&ne.associatedIconIndex>=0&&(Nt[ne.associatedIconIndex]={x:Je,y:Ve,z:ti,angle:ci})}else Ht(ge,Dt)}if(lt){Bt.clear();const Jt=S.icon.placedSymbolArray;for(let ne=0;ne<Jt.length;ne++){const me=Jt.get(ne),{numGlyphs:ue}=me,ge=Nt[ne];if(me.hidden||!ge)Ht(ue,Bt);else{const{x:be,y:Pe,z:Ie,angle:yi}=ge;for(let Se=0;Se<ue;Se++)b.addDynamicAttributes(Bt,be,Pe,Ie,yi)}}S.icon.dynamicLayoutVertexBuffer.updateData(Bt)}S.text.dynamicLayoutVertexBuffer.updateData(Dt)}function kh(S,h,_){return _.iconsInText&&h?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function Co(S,h,_,P,V,W,$,G,tt,ht,lt,bt){const Dt=S.context,Bt=Dt.gl,Nt=S.transform,Ot="map"===G,zt="map"===tt,At=Ot&&"point"!==_.layout.get("symbol-placement"),Qt=Ot&&!zt&&!At,Jt=void 0!==_.layout.get("symbol-sort-key").constantOr(1);let ne=!1;const me=S.depthModeForSublayer(0,b.DepthMode.ReadOnly),ue=[b.mercatorXfromLng(Nt.center.lng),b.mercatorYfromLat(Nt.center.lat)],ge=_.layout.get("text-variable-anchor"),be="globe"===Nt.projection.name,Pe=[],Ie=[0,-1,0];let yi=Ie;!be&&!Nt.mercatorFromTransition||Ot||(yi=function(Se){const Je=Se._camera.getWorldToCamera(Se.worldSize,1),Ve=b.multiply([],Je,Se.globeMatrix);b.invert(Ve,Ve);const ti=[0,0,0],Fe=[0,1,0,0];return b.transformMat4$1(Fe,Fe,Ve),ti[0]=Fe[0],ti[1]=Fe[1],ti[2]=Fe[2],b.normalize(ti,ti),ti}(Nt));for(const Se of P){const Je=h.getTile(Se),Ve=Je.getBucket(_);if(!Ve||"mercator"===Ve.projection.name&&be)continue;const ti=V?Ve.text:Ve.icon;if(!ti||Ve.fullyClipped||!ti.segments.get().length)continue;const Fe=ti.programConfigurations.get(_.id),we=V||Ve.sdfIcons,Be=V?Ve.textSizeData:Ve.iconSizeData,ei=zt||0!==Nt.pitch,ci=b.evaluateSizeForZoom(Be,Nt.zoom);let qi,Xn,Gi,Fi,nn=[0,0],Kn=null;if(V)Xn=Je.glyphAtlasTexture,Gi=Bt.LINEAR,qi=Je.glyphAtlasTexture.size,Ve.iconsInText&&(nn=Je.imageAtlasTexture.size,Kn=Je.imageAtlasTexture,Fi=ei||S.options.rotating||S.options.zooming||"composite"===Be.kind||"camera"===Be.kind?Bt.LINEAR:Bt.NEAREST);else{const Kr=1!==_.layout.get("icon-size").constantOr(0)||Ve.iconsNeedLinear;Xn=Je.imageAtlasTexture,Gi=we||S.options.rotating||S.options.zooming||Kr||ei?Bt.LINEAR:Bt.NEAREST,qi=Je.imageAtlasTexture.size}const sn="globe"===Ve.projection.name,fs=sn?yi:Ie,vs=sn?b.globeToMercatorTransition(Nt.zoom):0,Ds=ni(Se,Ve.getProjection(),Nt),Ns=Nt.calculatePixelsToTileUnitsMatrix(Je),bo=it(Ds,Je.tileID.canonical,zt,Ot,Nt,Ve.getProjection(),Ns),xr=S.terrain&&zt&&At?b.invert(b.create(),bo):Gr,zr=q(Ds,Je.tileID.canonical,zt,Ot,Nt,Ve.getProjection(),Ns),Tl=ge&&Ve.hasTextData(),qs="none"!==_.layout.get("icon-text-fit")&&Tl&&Ve.hasIconData();if(At){const Kr=Nt.elevation,Jr=Kr?Kr.getAtTileOffsetFunc(Se,Nt.center.lat,Nt.worldSize,Ve.getProjection()):null,Na=J(Ds,Je.tileID.canonical,zt,Ot,Nt,Ve.getProjection(),Ns);kt(Ve,Ds,S,V,Na,zr,zt,ht,Jr,Se)}const Bs=At||V&&ge||qs,ds=S.translatePosMatrix(Ds,Je,W,$),Is=Bs?Gr:bo,yr=S.translatePosMatrix(zr,Je,W,$,!0),Os=Ve.getProjection().createInversionMatrix(Nt,Se.canonical),Ho=[];S.terrainRenderModeElevated()&&zt&&Ho.push("PITCH_WITH_MAP_TERRAIN"),sn&&Ho.push("PROJECTION_GLOBE_VIEW"),Bs&&Ho.push("PROJECTED_POS_ON_VIEWPORT");const ir=we&&0!==_.paint.get(V?"text-halo-width":"icon-halo-width").constantOr(1);let za;za=we?Ve.iconsInText?fd(Be.kind,ci,Qt,zt,S,ds,Is,yr,qi,nn,Se,vs,ue,Os,fs,Ve.getProjection()):Pu(Be.kind,ci,Qt,zt,S,ds,Is,yr,V,qi,!0,Se,vs,ue,Os,fs,Ve.getProjection()):Ko(Be.kind,ci,Qt,zt,S,ds,Is,yr,V,qi,Se,vs,ue,Os,fs,Ve.getProjection());const Sl={program:S.useProgram(kh(we,V,Ve),Fe,Ho),buffers:ti,uniformValues:za,atlasTexture:Xn,atlasTextureIcon:Kn,atlasInterpolation:Gi,atlasInterpolationIcon:Fi,isSDF:we,hasHalo:ir,tile:Je,labelPlaneMatrixInv:xr};if(Jt&&Ve.canOverlap){ne=!0;const Kr=ti.segments.get();for(const Jr of Kr)Pe.push({segments:new b.SegmentVector([Jr]),sortKey:Jr.sortKey,state:Sl})}else Pe.push({segments:ti.segments,sortKey:0,state:Sl})}ne&&Pe.sort((Se,Je)=>Se.sortKey-Je.sortKey);for(const Se of Pe){const Je=Se.state;if(S.terrain&&S.terrain.setupElevationDraw(Je.tile,Je.program,{useDepthForOcclusion:!be,labelPlaneMatrixInv:Je.labelPlaneMatrixInv}),Dt.activeTexture.set(Bt.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,Bt.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(Dt.activeTexture.set(Bt.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,Bt.CLAMP_TO_EDGE)),Je.isSDF){const Ve=Je.uniformValues;Je.hasHalo&&(Ve.u_is_halo=1,Cc(Je.buffers,Se.segments,_,S,Je.program,me,lt,bt,Ve)),Ve.u_is_halo=0}Cc(Je.buffers,Se.segments,_,S,Je.program,me,lt,bt,Je.uniformValues)}}function Cc(S,h,_,P,V,W,$,G,tt){const ht=P.context,lt=[S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer,S.globeExtVertexBuffer];V.draw(ht,ht.gl.TRIANGLES,W,$,G,b.CullFaceMode.disabled,tt,_.id,S.layoutVertexBuffer,S.indexBuffer,h,_.paint,P.transform.zoom,S.programConfigurations.get(_.id),lt)}function Tc(S,h,_,P,V,W,$){const G=S.context.gl,tt=_.paint.get("fill-pattern"),ht=tt&&tt.constantOr(1);let lt,bt,Dt,Bt,Nt;$?(bt=ht&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",lt=G.LINES):(bt=ht?"fillPattern":"fill",lt=G.TRIANGLES);for(const Ot of P){const zt=h.getTile(Ot);if(ht&&!zt.patternsLoaded())continue;const At=zt.getBucket(_);if(!At)continue;S.prepareDrawTile();const Qt=At.programConfigurations.get(_.id),Jt=S.useProgram(bt,Qt);ht&&(S.context.activeTexture.set(G.TEXTURE0),zt.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Qt.updatePaintBuffers());const ne=tt.constantOr(null);if(ne&&zt.imageAtlas){const ue=zt.imageAtlas.patternPositions[ne.toString()];ue&&Qt.setConstantPatternPositions(ue)}const me=S.translatePosMatrix(Ot.projMatrix,zt,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if($){Bt=At.indexBuffer2,Nt=At.segments2;const ue=S.terrain&&S.terrain.renderingToTexture?S.terrain.drapeBufferSize:[G.drawingBufferWidth,G.drawingBufferHeight];Dt="fillOutlinePattern"===bt&&ht?Ba(me,S,zt,ue):Tu(me,ue)}else Bt=At.indexBuffer,Nt=At.segments,Dt=ht?Sh(me,S,zt):Th(me);S.prepareDrawProgram(S.context,Jt,Ot.toUnwrapped()),Jt.draw(S.context,lt,V,S.stencilModeForClipping(Ot),W,b.CullFaceMode.disabled,Dt,_.id,At.layoutVertexBuffer,Bt,Nt,_.paint,S.transform.zoom,Qt)}}function qn(S,h,_,P,V,W,$){const G=S.context,tt=G.gl,ht=S.transform,lt=_.paint.get("fill-extrusion-pattern"),bt=lt.constantOr(1),Dt=_.paint.get("fill-extrusion-opacity"),Bt=[_.paint.get("fill-extrusion-ambient-occlusion-intensity"),_.paint.get("fill-extrusion-ambient-occlusion-radius")],Nt=_.layout.get("fill-extrusion-edge-radius"),Ot="globe"===ht.projection.name?b.fillExtrusionHeightLift():0,zt="globe"===ht.projection.name,At=zt?b.globeToMercatorTransition(ht.zoom):0,Qt=[b.mercatorXfromLng(ht.center.lng),b.mercatorYfromLat(ht.center.lat)],Jt=[];zt&&Jt.push("PROJECTION_GLOBE_VIEW"),Bt[0]>0&&Jt.push("FAUX_AO");for(const ne of P){const me=h.getTile(ne),ue=me.getBucket(_);if(!ue||ue.projection.name!==ht.projection.name)continue;const ge=ue.programConfigurations.get(_.id),be=S.useProgram(bt?"fillExtrusionPattern":"fillExtrusion",ge,Jt);if(S.terrain){const ti=S.terrain;if(S.style.terrainSetForDrapingOnly())ti.setupElevationDraw(me,be,{useMeterToDem:!0});else{if(!ue.enableTerrain)continue;if(ti.setupElevationDraw(me,be,{useMeterToDem:!0}),Eu(G,h,ne,ue,_,ti),!ue.centroidVertexBuffer){const Fe=be.attributes.a_centroid_pos;void 0!==Fe&&tt.vertexAttrib2f(Fe,0,0)}}}bt&&(S.context.activeTexture.set(tt.TEXTURE0),me.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),ge.updatePaintBuffers());const Pe=lt.constantOr(null);if(Pe&&me.imageAtlas){const ti=me.imageAtlas.patternPositions[Pe.toString()];ti&&ge.setConstantPatternPositions(ti)}const Ie=S.translatePosMatrix(ne.projMatrix,me,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),yi=ht.projection.createInversionMatrix(ht,ne.canonical),Se=_.paint.get("fill-extrusion-vertical-gradient"),Je=bt?Ch(Ie,S,Se,Dt,Bt,Nt,ne,me,Ot,At,Qt,yi):_s(Ie,S,Se,Dt,Bt,Nt,ne,Ot,At,Qt,yi);S.prepareDrawProgram(G,be,ne.toUnwrapped());const Ve=[];S.terrain&&Ve.push(ue.centroidVertexBuffer),zt&&Ve.push(ue.layoutVertexExtBuffer),be.draw(G,G.gl.TRIANGLES,V,W,$,b.CullFaceMode.backCCW,Je,_.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,_.paint,S.transform.zoom,ge,Ve)}}function Eu(S,h,_,P,V,W){const $=[At=>{let Qt=At.canonical.x-1,Jt=At.wrap;return Qt<0&&(Qt=(1<<At.canonical.z)-1,Jt--),new b.OverscaledTileID(At.overscaledZ,Jt,At.canonical.z,Qt,At.canonical.y)},At=>{let Qt=At.canonical.x+1,Jt=At.wrap;return Qt===1<<At.canonical.z&&(Qt=0,Jt++),new b.OverscaledTileID(At.overscaledZ,Jt,At.canonical.z,Qt,At.canonical.y)},At=>new b.OverscaledTileID(At.overscaledZ,At.wrap,At.canonical.z,At.canonical.x,(0===At.canonical.y?1<<At.canonical.z:At.canonical.y)-1),At=>new b.OverscaledTileID(At.overscaledZ,At.wrap,At.canonical.z,At.canonical.x,At.canonical.y===(1<<At.canonical.z)-1?0:At.canonical.y+1)],G=At=>{const Qt=h.getSource().minzoom,Jt=me=>{const ue=h.getTileByID(me);if(ue&&ue.hasData())return ue.getBucket(V)},ne=[0,-1,1];for(const me of ne){if(At.overscaledZ+me<Qt)continue;const ue=Jt(At.calculateScaledKey(At.overscaledZ+me));if(ue)return ue}},tt=[0,0,0],ht=(At,Qt)=>(tt[0]=Math.min(At.min.y,Qt.min.y),tt[1]=Math.max(At.max.y,Qt.max.y),tt[2]=b.EXTENT-Qt.min.x>At.max.x?Qt.min.x-b.EXTENT:At.max.x,tt),lt=(At,Qt)=>(tt[0]=Math.min(At.min.x,Qt.min.x),tt[1]=Math.max(At.max.x,Qt.max.x),tt[2]=b.EXTENT-Qt.min.y>At.max.y?Qt.min.y-b.EXTENT:At.max.y,tt),bt=[(At,Qt)=>ht(At,Qt),(At,Qt)=>ht(Qt,At),(At,Qt)=>lt(At,Qt),(At,Qt)=>lt(Qt,At)],Dt=new b.pointGeometry(0,0);let Bt,Nt,Ot;const zt=(At,Qt,Jt,ne,me)=>{const ue=[[ne?Jt:At,ne?At:Jt,0],[ne?Jt:Qt,ne?Qt:Jt,0]],ge=me<0?b.EXTENT+me:me,be=[ne?ge:(At+Qt)/2,ne?(At+Qt)/2:ge,0];return 0===Jt&&me<0||0!==Jt&&me>0?W.getForTilePoints(Ot,[be],!0,Nt):ue.push(be),W.getForTilePoints(_,ue,!0,Bt),Math.max(ue[0][2],ue[1][2],be[2])/W.exaggeration()};for(let At=0;At<4;At++){const Qt=(At<2?1:5)-At,Jt=P.borders[At];if(0===Jt.length)continue;const ne=Ot=$[At](_),me=G(ne);if(!(me&&me instanceof b.FillExtrusionBucket&&me.enableTerrain)||P.borderDoneWithNeighborZ[At]===me.canonical.z&&me.borderDoneWithNeighborZ[Qt]===P.canonical.z||(Nt=W.findDEMTileFor(ne),!Nt||!Nt.dem))continue;if(!Bt){const Pe=W.findDEMTileFor(_);if(!Pe||!Pe.dem)return;Bt=Pe}const ue=me.borders[Qt];let ge=0;const be=me.borderDoneWithNeighborZ[Qt]!==P.canonical.z;if(P.canonical.z===me.canonical.z){for(let Pe=0;Pe<Jt.length;Pe++){const Ie=P.featuresOnBorder[Jt[Pe]],yi=Ie.borders[At];let Se;for(;ge<ue.length&&(Se=me.featuresOnBorder[ue[ge]],!(Se.borders[Qt][1]>yi[0]+3));)be&&me.encodeCentroid(void 0,Se,!1),ge++;if(Se&&ge<ue.length){const Je=ge;let Ve=0;for(;!(Se.borders[Qt][0]>yi[1]-3)&&(Ve++,++ge!==ue.length);)Se=me.featuresOnBorder[ue[ge]];if(Se=me.featuresOnBorder[ue[Je]],Ie.intersectsCount()>1||Se.intersectsCount()>1||1!==Ve){1!==Ve&&(ge=Je),P.encodeCentroid(void 0,Ie,!1),be&&me.encodeCentroid(void 0,Se,!1);continue}const ti=bt[At](Ie,Se),Fe=At%2?b.EXTENT-1:0;Dt.x=zt(ti[0],Math.min(b.EXTENT-1,ti[1]),Fe,At<2,ti[2]),Dt.y=0,P.encodeCentroid(Dt,Ie,!1),be&&me.encodeCentroid(Dt,Se,!1)}else P.encodeCentroid(void 0,Ie,!1)}P.borderDoneWithNeighborZ[At]=me.canonical.z,P.needsCentroidUpdate=!0,be&&(me.borderDoneWithNeighborZ[Qt]=P.canonical.z,me.needsCentroidUpdate=!0)}else{for(const Pe of Jt)P.encodeCentroid(void 0,P.featuresOnBorder[Pe],!1);if(be){for(const Pe of ue)me.encodeCentroid(void 0,me.featuresOnBorder[Pe],!1);me.borderDoneWithNeighborZ[Qt]=P.canonical.z,me.needsCentroidUpdate=!0}P.borderDoneWithNeighborZ[At]=me.canonical.z,P.needsCentroidUpdate=!0}}(P.needsCentroidUpdate||!P.centroidVertexBuffer&&0!==P.centroidVertexArray.length)&&P.uploadCentroid(S)}const Zl=new b.Color(1,0,0,1),xd=new b.Color(0,1,0,1),Kl=new b.Color(0,0,1,1),Jo=new b.Color(1,0,1,1),Ah=new b.Color(0,1,1,1);function wl(S,h,_){const P=S.context,V=S.transform,W=P.gl,$="globe"===V.projection.name,G=$?["PROJECTION_GLOBE_VIEW"]:null;let tt=_.projMatrix;if($&&b.globeToMercatorTransition(V.zoom)>0){const Ie=b.transitionTileAABBinECEF(_.canonical,V),yi=b.globeDenormalizeECEF(Ie);tt=b.multiply(new Float32Array(16),V.globeMatrix,yi),b.multiply(tt,V.projMatrix,tt)}const ht=S.useProgram("debug",null,G),lt=h.getTileByID(_.key);S.terrain&&S.terrain.setupElevationDraw(lt,ht);const bt=b.DepthMode.disabled,Dt=b.StencilMode.disabled,Bt=S.colorModeForRenderPass();P.activeTexture.set(W.TEXTURE0),S.emptyTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),$?lt._makeGlobeTileDebugBuffers(S.context,V):lt._makeDebugTileBoundsBuffers(S.context,V.projection);const Ot=lt._tileDebugBuffer||S.debugBuffer,zt=lt._tileDebugIndexBuffer||S.debugIndexBuffer,At=lt._tileDebugSegments||S.debugSegments;ht.draw(P,W.LINE_STRIP,bt,Dt,Bt,b.CullFaceMode.disabled,Mc(tt,b.Color.red),"$debug",Ot,zt,At,null,null,null,[lt._globeTileDebugBorderBuffer]);const Qt=lt.latestRawTileData,Jt=Math.floor((Qt&&Qt.byteLength||0)/1024),ne=h.getTile(_).tileSize,me=512/Math.min(ne,512)*(_.overscaledZ/V.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),ue+=` ${Jt}kb`,function(Ie,yi){Ie.initDebugOverlayCanvas();const Se=Ie.debugOverlayCanvas,Je=Ie.context.gl,Ve=Ie.debugOverlayCanvas.getContext("2d");Ve.clearRect(0,0,Se.width,Se.height),Ve.shadowColor="white",Ve.shadowBlur=2,Ve.lineWidth=1.5,Ve.strokeStyle="white",Ve.textBaseline="top",Ve.font="bold 36px Open Sans, sans-serif",Ve.fillText(yi,5,5),Ve.strokeText(yi,5,5),Ie.debugOverlayTexture.update(Se),Ie.debugOverlayTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE)}(S,ue);const ge=lt._tileDebugTextBuffer||S.debugBuffer,be=lt._tileDebugTextIndexBuffer||S.quadTriangleIndexBuffer,Pe=lt._tileDebugTextSegments||S.debugSegments;ht.draw(P,W.TRIANGLES,bt,Dt,b.ColorMode.alphaBlended,b.CullFaceMode.disabled,Mc(tt,b.Color.transparent,me),"$debug",ge,be,Pe,null,null,null,[lt._globeTileDebugTextBuffer])}function Qo(S,h,_,P){Ph(S,0,h+_/2,S.transform.width,_,P)}function Oa(S,h,_,P){Ph(S,h-_/2,0,_,S.transform.height,P)}function Ph(S,h,_,P,V,W){const $=S.context,G=$.gl;G.enable(G.SCISSOR_TEST),G.scissor(h*b.exported.devicePixelRatio,_*b.exported.devicePixelRatio,P*b.exported.devicePixelRatio,V*b.exported.devicePixelRatio),$.clear({color:W}),G.disable(G.SCISSOR_TEST)}const zs=b.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Sc}=zs;function _a(S,h,_,P){S.emplaceBack(h,_,P)}class kc{constructor(h){this.vertexArray=new b.StructArrayLayout3f12,this.indices=new b.StructArrayLayout3ui6,_a(this.vertexArray,-1,-1,1),_a(this.vertexArray,1,-1,1),_a(this.vertexArray,-1,1,1),_a(this.vertexArray,1,1,1),_a(this.vertexArray,-1,-1,-1),_a(this.vertexArray,1,-1,-1),_a(this.vertexArray,-1,1,-1),_a(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,Sc),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=b.SegmentVector.simpleSegment(0,0,36,12)}}function ts(S,h,_,P,V,W){const $=S.gl,G=h.paint.get("sky-atmosphere-color"),tt=h.paint.get("sky-atmosphere-halo-color"),ht=h.paint.get("sky-atmosphere-sun-intensity"),lt={u_matrix_3f:b.fromMat4(b.create$1(),P),u_sun_direction:V,u_sun_intensity:ht,u_color_tint_r:[(Nt=G).r,Nt.g,Nt.b,Nt.a],u_color_tint_m:[(Ot=tt).r,Ot.g,Ot.b,Ot.a],u_luminance:5e-5};var Nt,Ot;$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_CUBE_MAP_POSITIVE_X+W,h.skyboxTexture,0),_.draw(S,$.TRIANGLES,b.DepthMode.disabled,b.StencilMode.disabled,b.ColorMode.unblended,b.CullFaceMode.frontCW,lt,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const Jl=b.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Eh{constructor(h){const _=new b.StructArrayLayout5f20;_.emplaceBack(-1,1,1,0,0),_.emplaceBack(1,1,1,1,0),_.emplaceBack(1,-1,1,1,1),_.emplaceBack(-1,-1,1,0,1);const P=new b.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(_,Jl.members),this.indexBuffer=h.createIndexBuffer(P),this.segments=b.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const qo={symbol:function(S,h,_,P,V){if("translucent"!==S.renderPass)return;const W=b.StencilMode.disabled,$=S.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(G,tt,ht,lt,bt,Dt,Bt){const Nt=tt.transform,Ot="map"===bt,zt="map"===Dt;for(const At of G){const Qt=lt.getTile(At),Jt=Qt.getBucket(ht);if(!Jt||!Jt.text||!Jt.text.segments.get().length)continue;const ne=b.evaluateSizeForZoom(Jt.textSizeData,Nt.zoom),me=ni(At,Jt.getProjection(),Nt),ue=Nt.calculatePixelsToTileUnitsMatrix(Qt),ge=it(me,Qt.tileID.canonical,zt,Ot,Nt,Jt.getProjection(),ue),be="none"!==ht.layout.get("icon-text-fit")&&Jt.hasIconData();if(ne){const Pe=Math.pow(2,Nt.zoom-Qt.tileID.overscaledZ);Ao(Jt,Ot,zt,Bt,b.symbolSize,Nt,ge,At,Pe,ne,be)}}}(P,S,_,h,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),V),0!==_.paint.get("icon-opacity").constantOr(1)&&Co(S,h,_,P,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),W,$),0!==_.paint.get("text-opacity").constantOr(1)&&Co(S,h,_,P,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),W,$),h.map.showCollisionBoxes&&(wo(S,h,_,P,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),wo(S,h,_,P,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(S,h,_,P){if("translucent"!==S.renderPass)return;const V=_.paint.get("circle-opacity"),W=_.paint.get("circle-stroke-width"),$=_.paint.get("circle-stroke-opacity"),G=void 0!==_.layout.get("circle-sort-key").constantOr(1);if(0===V.constantOr(1)&&(0===W.constantOr(1)||0===$.constantOr(1)))return;const tt=S.context,ht=tt.gl,lt=S.transform,bt=S.depthModeForSublayer(0,b.DepthMode.ReadOnly),Dt=b.StencilMode.disabled,Bt=S.colorModeForRenderPass(),Nt="globe"===lt.projection.name,Ot=[b.mercatorXfromLng(lt.center.lng),b.mercatorYfromLat(lt.center.lat)],zt=[];for(let Qt=0;Qt<P.length;Qt++){const Jt=P[Qt],ne=h.getTile(Jt),me=ne.getBucket(_);if(!me||me.projection.name!==lt.projection.name)continue;const ue=me.programConfigurations.get(_.id),ge=po(_);Nt&&ge.push("PROJECTION_GLOBE_VIEW");const be=S.useProgram("circle",ue,ge),Pe=me.layoutVertexBuffer,Ie=me.globeExtVertexBuffer,yi=me.indexBuffer,Se=lt.projection.createInversionMatrix(lt,Jt.canonical),Je={programConfiguration:ue,program:be,layoutVertexBuffer:Pe,globeExtVertexBuffer:Ie,indexBuffer:yi,uniformValues:wc(S,Jt,ne,Se,Ot,_),tile:ne};if(G){const Ve=me.segments.get();for(const ti of Ve)zt.push({segments:new b.SegmentVector([ti]),sortKey:ti.sortKey,state:Je})}else zt.push({segments:me.segments,sortKey:0,state:Je})}G&&zt.sort((Qt,Jt)=>Qt.sortKey-Jt.sortKey);const At={useDepthForOcclusion:!Nt};for(const Qt of zt){const{programConfiguration:Jt,program:ne,layoutVertexBuffer:me,globeExtVertexBuffer:ue,indexBuffer:ge,uniformValues:be,tile:Pe}=Qt.state,Ie=Qt.segments;S.terrain&&S.terrain.setupElevationDraw(Pe,ne,At),S.prepareDrawProgram(tt,ne,Pe.tileID.toUnwrapped()),ne.draw(tt,ht.TRIANGLES,bt,Dt,Bt,b.CullFaceMode.disabled,be,_.id,me,ge,Ie,_.paint,lt.zoom,Jt,[ue])}},heatmap:function(S,h,_,P){if(0!==_.paint.get("heatmap-opacity"))if("offscreen"===S.renderPass){const V=S.context,W=V.gl,$=b.StencilMode.disabled,G=new b.ColorMode([W.ONE,W.ONE],b.Color.transparent,[!0,!0,!0,!0]);(function(Bt,Nt,Ot,zt){const At=Bt.gl,Qt=Nt.width*zt,Jt=Nt.height*zt;Bt.activeTexture.set(At.TEXTURE1),Bt.viewport.set([0,0,Qt,Jt]);let ne=Ot.heatmapFbo;if(!ne||ne&&(ne.width!==Qt||ne.height!==Jt)){ne&&ne.destroy();const me=At.createTexture();At.bindTexture(At.TEXTURE_2D,me),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_S,At.CLAMP_TO_EDGE),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_WRAP_T,At.CLAMP_TO_EDGE),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MIN_FILTER,At.LINEAR),At.texParameteri(At.TEXTURE_2D,At.TEXTURE_MAG_FILTER,At.LINEAR),ne=Ot.heatmapFbo=Bt.createFramebuffer(Qt,Jt,!1),function(ue,ge,be,Pe,Ie,yi){const Se=ue.gl;Se.texImage2D(Se.TEXTURE_2D,0,ue.isWebGL2&&ue.extRenderToTextureHalfFloat?Se.RGBA16F:Se.RGBA,Ie,yi,0,Se.RGBA,ue.extRenderToTextureHalfFloat?ue.isWebGL2?Se.HALF_FLOAT:ue.extTextureHalfFloat.HALF_FLOAT_OES:Se.UNSIGNED_BYTE,null),Pe.colorAttachment.set(be)}(Bt,0,me,ne,Qt,Jt)}else At.bindTexture(At.TEXTURE_2D,ne.colorAttachment.get()),Bt.bindFramebuffer.set(ne.framebuffer)})(V,S,_,"globe"===S.transform.projection.name?.5:.25),V.clear({color:b.Color.transparent});const tt=S.transform,ht="globe"===tt.projection.name,lt=ht?["PROJECTION_GLOBE_VIEW"]:null,bt=ht?b.CullFaceMode.frontCCW:b.CullFaceMode.disabled,Dt=[b.mercatorXfromLng(tt.center.lng),b.mercatorYfromLat(tt.center.lat)];for(let Bt=0;Bt<P.length;Bt++){const Nt=P[Bt];if(h.hasRenderableParent(Nt))continue;const Ot=h.getTile(Nt),zt=Ot.getBucket(_);if(!zt||zt.projection.name!==tt.projection.name)continue;const At=zt.programConfigurations.get(_.id),Qt=S.useProgram("heatmap",At,lt),{zoom:Jt}=S.transform;S.terrain&&S.terrain.setupElevationDraw(Ot,Qt),S.prepareDrawProgram(V,Qt,Nt.toUnwrapped());const ne=tt.projection.createInversionMatrix(tt,Nt.canonical);Qt.draw(V,W.TRIANGLES,b.DepthMode.disabled,$,G,bt,ws(S,Nt,Ot,ne,Dt,Jt,_.paint.get("heatmap-intensity")),_.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,_.paint,S.transform.zoom,At,ht?[zt.globeExtVertexBuffer]:null)}V.viewport.set([0,0,S.width,S.height])}else"translucent"===S.renderPass&&(S.context.setColorMode(S.colorModeForRenderPass()),function(V,W){const $=V.context,G=$.gl,tt=W.heatmapFbo;if(!tt)return;$.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,tt.colorAttachment.get()),$.activeTexture.set(G.TEXTURE1);let ht=W.colorRampTexture;ht||(ht=W.colorRampTexture=new b.Texture($,W.colorRamp,G.RGBA)),ht.bind(G.LINEAR,G.CLAMP_TO_EDGE),V.useProgram("heatmapTexture").draw($,G.TRIANGLES,b.DepthMode.disabled,b.StencilMode.disabled,V.colorModeForRenderPass(),b.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")},W.id,V.viewportBuffer,V.quadTriangleIndexBuffer,V.viewportSegments,W.paint,V.transform.zoom)}(S,_))},line:function(S,h,_,P){if("translucent"!==S.renderPass)return;const V=_.paint.get("line-opacity"),W=_.paint.get("line-width");if(0===V.constantOr(1)||0===W.constantOr(1))return;const $=S.depthModeForSublayer(0,b.DepthMode.ReadOnly),G=S.colorModeForRenderPass(),tt=S.terrain&&S.terrain.renderingToTexture?1:b.exported.devicePixelRatio,ht=_.paint.get("line-dasharray"),lt=ht.constantOr(1),bt=_.layout.get("line-cap"),Dt=_.paint.get("line-pattern"),Bt=Dt.constantOr(1),Nt=_.paint.get("line-gradient"),Ot=Bt?"linePattern":"line",zt=S.context,At=zt.gl,Qt=(ne=>{const me=[];Ms(ne)&&me.push("RENDER_LINE_DASH"),ne.paint.get("line-gradient")&&me.push("RENDER_LINE_GRADIENT");const ue=ne.paint.get("line-trim-offset");0===ue[0]&&0===ue[1]||me.push("RENDER_LINE_TRIM_OFFSET");const ge=ne.paint.get("line-pattern").constantOr(1),be=1!==ne.paint.get("line-opacity").constantOr(1);return!ge&&be&&me.push("RENDER_LINE_ALPHA_DISCARD"),me})(_);let Jt=Qt.includes("RENDER_LINE_ALPHA_DISCARD");S.terrain&&S.terrain.clipOrMaskOverlapStencilType()&&(Jt=!1);for(const ne of P){const me=h.getTile(ne);if(Bt&&!me.patternsLoaded())continue;const ue=me.getBucket(_);if(!ue)continue;S.prepareDrawTile();const ge=ue.programConfigurations.get(_.id),be=S.useProgram(Ot,ge,Qt),Pe=Dt.constantOr(null);if(Pe&&me.imageAtlas){const we=me.imageAtlas.patternPositions[Pe.toString()];we&&ge.setConstantPatternPositions(we)}const Ie=ht.constantOr(null),yi=bt.constantOr(null);if(!Bt&&Ie&&yi&&me.lineAtlas){const we=me.lineAtlas.getDash(Ie,yi);we&&ge.setConstantPatternPositions(we)}let[Se,Je]=_.paint.get("line-trim-offset");("round"===yi||"square"===yi)&&Se!==Je&&(0===Se&&(Se-=1),1===Je&&(Je+=1));const Ve=S.terrain?ne.projMatrix:null,ti=Bt?Au(S,me,_,Ve,tt):ku(S,me,_,Ve,ue.lineClipsArray.length,tt,[Se,Je]);if(Nt){const we=ue.gradients[_.id];let Be=we.texture;if(_.gradientVersion!==we.version){let ei=256;if(_.stepInterpolant){const ci=h.getSource().maxzoom,qi=ne.canonical.z===ci?Math.ceil(1<<S.transform.maxZoom-ne.canonical.z):1;ei=b.clamp(b.nextPowerOfTwo(ue.maxLineLength/b.EXTENT*1024*qi),256,zt.maxTextureSize)}we.gradient=b.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:ei,image:we.gradient||void 0,clips:ue.lineClipsArray}),we.texture?we.texture.update(we.gradient):we.texture=new b.Texture(zt,we.gradient,At.RGBA),we.version=_.gradientVersion,Be=we.texture}zt.activeTexture.set(At.TEXTURE1),Be.bind(_.stepInterpolant?At.NEAREST:At.LINEAR,At.CLAMP_TO_EDGE)}lt&&(zt.activeTexture.set(At.TEXTURE0),me.lineAtlasTexture.bind(At.LINEAR,At.REPEAT),ge.updatePaintBuffers()),Bt&&(zt.activeTexture.set(At.TEXTURE0),me.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),ge.updatePaintBuffers()),S.prepareDrawProgram(zt,be,ne.toUnwrapped());const Fe=we=>{be.draw(zt,At.TRIANGLES,$,we,G,b.CullFaceMode.disabled,ti,_.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,_.paint,S.transform.zoom,ge,[ue.layoutVertexBuffer2])};if(Jt){const we=S.stencilModeForClipping(ne).ref;0===we&&S.terrain&&zt.clear({stencil:0});const Be={func:At.EQUAL,mask:255};ti.u_alpha_discard_threshold=.8,Fe(new b.StencilMode(Be,we,255,At.KEEP,At.KEEP,At.INVERT)),ti.u_alpha_discard_threshold=0,Fe(new b.StencilMode(Be,we,255,At.KEEP,At.KEEP,At.KEEP))}else Fe(S.stencilModeForClipping(ne))}Jt&&(S.resetStencilClippingMasks(),S.terrain&&zt.clear({stencil:0}))},fill:function(S,h,_,P){const V=_.paint.get("fill-color"),W=_.paint.get("fill-opacity");if(0===W.constantOr(1))return;const $=S.colorModeForRenderPass(),G=_.paint.get("fill-pattern"),tt=S.opaquePassEnabledForLayer()&&!G.constantOr(1)&&1===V.constantOr(b.Color.transparent).a&&1===W.constantOr(0)?"opaque":"translucent";if(S.renderPass===tt){const ht=S.depthModeForSublayer(1,"opaque"===S.renderPass?b.DepthMode.ReadWrite:b.DepthMode.ReadOnly);Tc(S,h,_,P,ht,$,!1)}if("translucent"===S.renderPass&&_.paint.get("fill-antialias")){const ht=S.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,b.DepthMode.ReadOnly);Tc(S,h,_,P,ht,$,!0)}},"fill-extrusion":function(S,h,_,P){const V=_.paint.get("fill-extrusion-opacity");if(0!==V&&"translucent"===S.renderPass){const W=new b.DepthMode(S.context.gl.LEQUAL,b.DepthMode.ReadWrite,S.depthRangeFor3D);if(1!==V||_.paint.get("fill-extrusion-pattern").constantOr(1))qn(S,h,_,P,W,b.StencilMode.disabled,b.ColorMode.disabled),qn(S,h,_,P,W,S.stencilModeFor3D(),S.colorModeForRenderPass()),S.resetStencilClippingMasks();else{const $=S.colorModeForRenderPass();qn(S,h,_,P,W,b.StencilMode.disabled,$)}}},hillshade:function(S,h,_,P){if("offscreen"!==S.renderPass&&"translucent"!==S.renderPass)return;const V=S.context,W=S.depthModeForSublayer(0,b.DepthMode.ReadOnly),$=S.colorModeForRenderPass(),G=S.terrain&&S.terrain.renderingToTexture,[tt,ht]="translucent"!==S.renderPass||G?[{},P]:S.stencilConfigForOverlap(P);for(const lt of ht){const bt=h.getTile(lt);if(bt.needsHillshadePrepare&&"offscreen"===S.renderPass)md(S,bt,_,W,b.StencilMode.disabled,$);else if("translucent"===S.renderPass){const Dt=G&&S.terrain?S.terrain.stencilModeForRTTOverlap(lt):tt[lt.overscaledZ];yc(S,lt,bt,_,W,Dt,$)}}V.viewport.set([0,0,S.width,S.height]),S.resetStencilClippingMasks()},raster:function(S,h,_,P,V,W){if("translucent"!==S.renderPass||0===_.paint.get("raster-opacity")||!P.length)return;const $=S.context,G=$.gl,tt=h.getSource(),ht=S.useProgram("raster"),lt=S.colorModeForRenderPass(),bt=S.terrain&&S.terrain.renderingToTexture,[Dt,Bt]=tt instanceof Gt||bt?[{},P]:S.stencilConfigForOverlap(P),Nt=Bt[Bt.length-1].overscaledZ,Ot=!S.options.moving;for(const zt of Bt){const At=bt?b.DepthMode.disabled:S.depthModeForSublayer(zt.overscaledZ-Nt,1===_.paint.get("raster-opacity")?b.DepthMode.ReadWrite:b.DepthMode.ReadOnly,G.LESS),Qt=zt.toUnwrapped(),Jt=h.getTile(zt);if(bt&&(!Jt||!Jt.hasData()))continue;const ne=bt?zt.projMatrix:S.transform.calculateProjMatrix(Qt,Ot),me=S.terrain&&bt?S.terrain.stencilModeForRTTOverlap(zt):Dt[zt.overscaledZ],ue=W?0:_.paint.get("raster-fade-duration");Jt.registerFadeDuration(ue);const ge=h.findLoadedParent(zt,0),be=el(Jt,ge,h,S.transform,ue);let Pe,Ie;S.terrain&&S.terrain.prepareDrawTile();const yi="nearest"===_.paint.get("raster-resampling")?G.NEAREST:G.LINEAR;$.activeTexture.set(G.TEXTURE0),Jt.texture.bind(yi,G.CLAMP_TO_EDGE),$.activeTexture.set(G.TEXTURE1),ge?(ge.texture.bind(yi,G.CLAMP_TO_EDGE),Pe=Math.pow(2,ge.tileID.overscaledZ-Jt.tileID.overscaledZ),Ie=[Jt.tileID.canonical.x*Pe%1,Jt.tileID.canonical.y*Pe%1]):Jt.texture.bind(yi,G.CLAMP_TO_EDGE),Jt.texture.useMipmap&&$.extTextureFilterAnisotropic&&S.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const Se=ur(ne,Ie||[0,0],Pe||1,be,_,tt instanceof Gt?tt.perspectiveTransform:[0,0]);if(S.prepareDrawProgram($,ht,Qt),tt instanceof Gt)tt.boundsBuffer&&tt.boundsSegments&&ht.draw($,G.TRIANGLES,At,b.StencilMode.disabled,lt,b.CullFaceMode.disabled,Se,_.id,tt.boundsBuffer,S.quadTriangleIndexBuffer,tt.boundsSegments);else{const{tileBoundsBuffer:Je,tileBoundsIndexBuffer:Ve,tileBoundsSegments:ti}=S.getTileBoundsBuffers(Jt);ht.draw($,G.TRIANGLES,At,me,lt,b.CullFaceMode.disabled,Se,_.id,Je,Ve,ti)}}S.resetStencilClippingMasks()},background:function(S,h,_,P){const V=_.paint.get("background-color"),W=_.paint.get("background-opacity");if(0===W)return;const $=S.context,G=$.gl,tt=S.transform,ht=tt.tileSize,lt=_.paint.get("background-pattern");if(S.isPatternMissing(lt))return;const bt=!lt&&1===V.a&&1===W&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==bt)return;const Dt=b.StencilMode.disabled,Bt=S.depthModeForSublayer(0,"opaque"===bt?b.DepthMode.ReadWrite:b.DepthMode.ReadOnly),Nt=S.colorModeForRenderPass(),Ot=S.useProgram(lt?"backgroundPattern":"background");let zt,At=P;At||(zt=S.getBackgroundTiles(),At=Object.values(zt).map(Qt=>Qt.tileID)),lt&&($.activeTexture.set(G.TEXTURE0),S.imageManager.bind(S.context));for(const Qt of At){const Jt=Qt.toUnwrapped(),ne=P?Qt.projMatrix:S.transform.calculateProjMatrix(Jt);S.prepareDrawTile();const me=h?h.getTile(Qt):zt?zt[Qt.key]:new b.Tile(Qt,ht,tt.zoom,S),ue=lt?ya(ne,W,S,lt,{tileID:Qt,tileSize:ht}):gd(ne,W,V);S.prepareDrawProgram($,Ot,Jt);const{tileBoundsBuffer:ge,tileBoundsIndexBuffer:be,tileBoundsSegments:Pe}=S.getTileBoundsBuffers(me);Ot.draw($,G.TRIANGLES,Bt,Dt,Nt,b.CullFaceMode.disabled,ue,_.id,ge,be,Pe)}},sky:function(S,h,_){const P=S.transform,V="mercator"===P.projection.name||"globe"===P.projection.name?1:b.smoothstep(7,8,P.zoom),W=_.paint.get("sky-opacity")*V;if(0===W)return;const $=S.context,G=_.paint.get("sky-type"),tt=new b.DepthMode($.gl.LEQUAL,b.DepthMode.ReadOnly,[0,1]),ht=S.frameCounter/1e3%1;"atmosphere"===G?"offscreen"===S.renderPass?_.needsSkyboxCapture(S)&&(function(lt,bt,Dt,Bt){const Nt=lt.context,Ot=Nt.gl;let zt=bt.skyboxFbo;if(!zt){zt=bt.skyboxFbo=Nt.createFramebuffer(32,32,!1),bt.skyboxGeometry=new kc(Nt),bt.skyboxTexture=Nt.gl.createTexture(),Ot.bindTexture(Ot.TEXTURE_CUBE_MAP,bt.skyboxTexture),Ot.texParameteri(Ot.TEXTURE_CUBE_MAP,Ot.TEXTURE_WRAP_S,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_CUBE_MAP,Ot.TEXTURE_WRAP_T,Ot.CLAMP_TO_EDGE),Ot.texParameteri(Ot.TEXTURE_CUBE_MAP,Ot.TEXTURE_MIN_FILTER,Ot.LINEAR),Ot.texParameteri(Ot.TEXTURE_CUBE_MAP,Ot.TEXTURE_MAG_FILTER,Ot.LINEAR);for(let ne=0;ne<6;++ne)Ot.texImage2D(Ot.TEXTURE_CUBE_MAP_POSITIVE_X+ne,0,Ot.RGBA,32,32,0,Ot.RGBA,Ot.UNSIGNED_BYTE,null)}Nt.bindFramebuffer.set(zt.framebuffer),Nt.viewport.set([0,0,32,32]);const At=bt.getCenter(lt,!0),Qt=lt.useProgram("skyboxCapture"),Jt=new Float64Array(16);b.identity(Jt),b.rotateY(Jt,Jt,.5*-Math.PI),ts(Nt,bt,Qt,Jt,At,0),b.identity(Jt),b.rotateY(Jt,Jt,.5*Math.PI),ts(Nt,bt,Qt,Jt,At,1),b.identity(Jt),b.rotateX(Jt,Jt,.5*-Math.PI),ts(Nt,bt,Qt,Jt,At,2),b.identity(Jt),b.rotateX(Jt,Jt,.5*Math.PI),ts(Nt,bt,Qt,Jt,At,3),b.identity(Jt),ts(Nt,bt,Qt,Jt,At,4),b.identity(Jt),b.rotateY(Jt,Jt,Math.PI),ts(Nt,bt,Qt,Jt,At,5),Nt.viewport.set([0,0,lt.width,lt.height])}(S,_),_.markSkyboxValid(S)):"sky"===S.renderPass&&function(lt,bt,Dt,Bt,Nt){const Ot=lt.context,zt=Ot.gl,At=lt.transform,Qt=lt.useProgram("skybox");Ot.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_CUBE_MAP,bt.skyboxTexture);const Jt={u_matrix:At.skyboxMatrix,u_sun_direction:bt.getCenter(lt,!1),u_cubemap:0,u_opacity:Bt,u_temporal_offset:Nt};lt.prepareDrawProgram(Ot,Qt),Qt.draw(Ot,zt.TRIANGLES,Dt,b.StencilMode.disabled,lt.colorModeForRenderPass(),b.CullFaceMode.backCW,Jt,"skybox",bt.skyboxGeometry.vertexBuffer,bt.skyboxGeometry.indexBuffer,bt.skyboxGeometry.segment)}(S,_,tt,W,ht):"gradient"===G&&"sky"===S.renderPass&&function(lt,bt,Dt,Bt,Nt){const Ot=lt.context,zt=Ot.gl,At=lt.transform,Qt=lt.useProgram("skyboxGradient");bt.skyboxGeometry||(bt.skyboxGeometry=new kc(Ot)),Ot.activeTexture.set(zt.TEXTURE0);let Jt=bt.colorRampTexture;Jt||(Jt=bt.colorRampTexture=new b.Texture(Ot,bt.colorRamp,zt.RGBA)),Jt.bind(zt.LINEAR,zt.CLAMP_TO_EDGE);const ne=(me=At.skyboxMatrix,ue=bt.getCenter(lt,!1),ge=bt.paint.get("sky-gradient-radius"),be=Bt,Pe=Nt,{u_matrix:me,u_color_ramp:0,u_center_direction:ue,u_radius:b.degToRad(ge),u_opacity:be,u_temporal_offset:Pe});var me,ue,ge,be,Pe;lt.prepareDrawProgram(Ot,Qt),Qt.draw(Ot,zt.TRIANGLES,Dt,b.StencilMode.disabled,lt.colorModeForRenderPass(),b.CullFaceMode.backCW,ne,"skyboxGradient",bt.skyboxGeometry.vertexBuffer,bt.skyboxGeometry.indexBuffer,bt.skyboxGeometry.segment)}(S,_,tt,W,ht)},debug:function(S,h,_){for(let P=0;P<_.length;P++)wl(S,h,_[P])},custom:function(S,h,_,P){const V=S.context,W=_.implementation;if(!S.transform.projection.unsupportedLayers||!S.transform.projection.unsupportedLayers.includes("custom")||S.terrain&&(S.terrain.renderingToTexture||"offscreen"===S.renderPass)&&_.isLayerDraped()){if("offscreen"===S.renderPass){const $=W.prerender;if($){if(S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),"globe"===S.transform.projection.name){const G=S.transform.pointMerc;$.call(W,V.gl,S.transform.customLayerMatrix(),S.transform.getProjection(),S.transform.globeToMercatorMatrix(),b.globeToMercatorTransition(S.transform.zoom),[G.x,G.y],S.transform.pixelsPerMeterRatio)}else $.call(W,V.gl,S.transform.customLayerMatrix());V.setDirty(),S.setBaseState()}}else if("translucent"===S.renderPass){if(S.terrain&&S.terrain.renderingToTexture){const G=W.renderToTile;if(G){const tt=P[0].canonical,ht=new b.MercatorCoordinate(tt.x+P[0].wrap*(1<<tt.z),tt.y,tt.z);V.setDepthMode(b.DepthMode.disabled),V.setStencilMode(b.StencilMode.disabled),V.setColorMode(S.colorModeForRenderPass()),S.setCustomLayerDefaults(),G.call(W,V.gl,ht),V.setDirty(),S.setBaseState()}return}S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),V.setStencilMode(b.StencilMode.disabled);const $="3d"===W.renderingMode?new b.DepthMode(S.context.gl.LEQUAL,b.DepthMode.ReadWrite,S.depthRangeFor3D):S.depthModeForSublayer(0,b.DepthMode.ReadOnly);if(V.setDepthMode($),"globe"===S.transform.projection.name){const G=S.transform.pointMerc;W.render(V.gl,S.transform.customLayerMatrix(),S.transform.getProjection(),S.transform.globeToMercatorMatrix(),b.globeToMercatorTransition(S.transform.zoom),[G.x,G.y],S.transform.pixelsPerMeterRatio)}else W.render(V.gl,S.transform.customLayerMatrix());V.setDirty(),S.setBaseState(),V.bindFramebuffer.set(null)}}else b.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class yd{constructor(h,_,P=!1){this.context=new yt(h,P),this.transform=_,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=b.SourceCache.maxUnderzooming+b.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ki,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,_){const P=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(P||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new xa(this,h));const V=this._terrain;this.transform.elevation=P?V:null,V.update(h,this.transform,_)}_updateFog(h){const _=h.fog;if(!_||"globe"===this.transform.projection.name||_.getOpacity(this.transform.pitch)<1||_.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[P,V]=_.getFovAdjustedRange(this.transform._fov);if(P>V)return void(this.transform.fogCullDistSq=null);const W=P+.78*(V-P);this.transform.fogCullDistSq=W*W}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,_){if(this.width=h*b.exported.devicePixelRatio,this.height=_*b.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const P of this.style.order)this.style._layers[P].resize()}setup(){const h=this.context,_=new b.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(b.EXTENT,0),_.emplaceBack(0,b.EXTENT),_.emplaceBack(b.EXTENT,b.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(_,b.posAttributes.members),this.tileExtentSegments=b.SegmentVector.simpleSegment(0,0,4,2);const P=new b.StructArrayLayout2i4;P.emplaceBack(0,0),P.emplaceBack(b.EXTENT,0),P.emplaceBack(0,b.EXTENT),P.emplaceBack(b.EXTENT,b.EXTENT),this.debugBuffer=h.createVertexBuffer(P,b.posAttributes.members),this.debugSegments=b.SegmentVector.simpleSegment(0,0,4,5);const V=new b.StructArrayLayout2i4;V.emplaceBack(-1,-1),V.emplaceBack(1,-1),V.emplaceBack(-1,1),V.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(V,b.posAttributes.members),this.viewportSegments=b.SegmentVector.simpleSegment(0,0,4,2);const W=new b.StructArrayLayout4i8;W.emplaceBack(0,0,0,0),W.emplaceBack(b.EXTENT,0,b.EXTENT,0),W.emplaceBack(0,b.EXTENT,0,b.EXTENT),W.emplaceBack(b.EXTENT,b.EXTENT,b.EXTENT,b.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(W,b.boundsAttributes.members),this.mercatorBoundsSegments=b.SegmentVector.simpleSegment(0,0,4,2);const $=new b.StructArrayLayout3ui6;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer($);const G=new b.StructArrayLayout1ui2;for(const ht of[0,1,3,2,0])G.emplaceBack(ht);this.debugIndexBuffer=h.createIndexBuffer(G),this.emptyTexture=new b.Texture(h,new b.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=b.create();const tt=this.context.gl;this.stencilClearMode=new b.StencilMode({func:tt.ALWAYS,mask:0},0,255,tt.ZERO,tt.ZERO,tt.ZERO),this.loadTimeStamps.push(b.window.performance.now()),this.atmosphereBuffer=new Eh(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,_=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,_.TRIANGLES,b.DepthMode.disabled,this.stencilClearMode,b.ColorMode.disabled,b.CullFaceMode.disabled,rs(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,_,P){if(!_||this.currentStencilSource===_.id||!h.isTileClipped()||!P||0===P.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let G=!1;for(const tt of P)if(void 0===this._tileClippingMaskIDs[tt.key]){G=!0;break}if(!G)return}this.currentStencilSource=_.id;const V=this.context,W=V.gl;this.nextStencilID+P.length>256&&this.clearStencil(),V.setColorMode(b.ColorMode.disabled),V.setDepthMode(b.DepthMode.disabled);const $=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const G of P){const tt=_.getTile(G),ht=this._tileClippingMaskIDs[G.key]=this.nextStencilID++,{tileBoundsBuffer:lt,tileBoundsIndexBuffer:bt,tileBoundsSegments:Dt}=this.getTileBoundsBuffers(tt);$.draw(V,W.TRIANGLES,b.DepthMode.disabled,new b.StencilMode({func:W.ALWAYS,mask:0},ht,255,W.KEEP,W.KEEP,W.REPLACE),b.ColorMode.disabled,b.CullFaceMode.disabled,rs(G.projMatrix),"$clipping",lt,bt,Dt)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,_=this.context.gl;return new b.StencilMode({func:_.NOTEQUAL,mask:255},h,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const _=this.context.gl;return new b.StencilMode({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(h){const _=this.context.gl,P=h.sort(($,G)=>G.overscaledZ-$.overscaledZ),V=P[P.length-1].overscaledZ,W=P[0].overscaledZ-V+1;if(W>1){this.currentStencilSource=void 0,this.nextStencilID+W>256&&this.clearStencil();const $={};for(let G=0;G<W;G++)$[G+V]=new b.StencilMode({func:_.GEQUAL,mask:255},G+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=W,[$,P]}return[{[V]:b.StencilMode.disabled},P]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new b.ColorMode([h.CONSTANT_COLOR,h.ONE],new b.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?b.ColorMode.unblended:b.ColorMode.alphaBlended}depthModeForSublayer(h,_,P){if(!this.opaquePassEnabledForLayer())return b.DepthMode.disabled;const V=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new b.DepthMode(P||this.context.gl.LEQUAL,_,[V,V])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,_){this.style=h,this.options=_,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(b.exported.now()),this.imageManager.beginFrame();const P=this.style.order,V=this.style._sourceCaches;for(const ht in V){const lt=V[ht];lt.used&&lt.prepare(this.context)}const W={},$={},G={};for(const ht in V){const lt=V[ht];W[ht]=lt.getVisibleCoordinates(),$[ht]=W[ht].slice().reverse(),G[ht]=lt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ht=0;ht<P.length;ht++)if(this.style._layers[P[ht]].is3D()){this.opaquePassCutoff=ht;break}if(this.terrain&&(this.terrain.updateTileBinding(G),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new b.GlobeSharedBuffers(this.context)),!b.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const ht of P){const lt=this.style._layers[ht],bt=h._getLayerSourceCache(lt);if(!lt.hasOffscreenPass()||lt.isHidden(this.transform.zoom))continue;const Dt=bt?$[bt.id]:void 0;("custom"===lt.type||lt.isSky()||Dt&&Dt.length)&&this.renderLayer(this,bt,lt,Dt)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const tt=this.terrain;if(tt&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&tt.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:_.showOverdrawInspector?b.Color.black:b.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const ht=this.style._layers[P[this.currentLayer]],lt=h._getLayerSourceCache(ht);if(ht.isSky())continue;const bt=lt?$[lt.id]:void 0;this._renderTileClippingMasks(ht,lt,bt),this.renderLayer(this,lt,ht,bt)}if(this.style.fog&&this.transform.projection.supportsFog&&function(ht,lt){const bt=ht.context,Dt=bt.gl,Bt=ht.transform,Nt=new b.DepthMode(Dt.LEQUAL,b.DepthMode.ReadOnly,[0,1]),Ot=ht.useProgram("globeAtmosphere",null,"globe"===Bt.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),zt=b.globeToMercatorTransition(Bt.zoom),At=lt.properties.get("color").toArray01(),Qt=lt.properties.get("high-color").toArray01(),Jt=lt.properties.get("space-color").toArray01PremultipliedAlpha(),ne=b.identity$1([]);b.rotateY$1(ne,ne,-b.degToRad(Bt._center.lng)),b.rotateX$1(ne,ne,b.degToRad(Bt._center.lat)),b.rotateZ$1(ne,ne,Bt.angle),b.rotateX$1(ne,ne,-Bt._pitch);const me=b.fromQuat(new Float32Array(16),ne),ue=b.mapValue(lt.properties.get("star-intensity"),0,1,0,.25),be=b.mapValue(lt.properties.get("horizon-blend"),0,1,5e-4,.25),Pe=b.globeUseCustomAntiAliasing(ht,bt,Bt)&&5e-4===be?Bt.worldSize/(2*Math.PI*1.025)-1:Bt.globeRadius,Ie=ht.frameCounter/1e3%1,yi=b.length(Bt.globeCenterInViewSpace),Se=Math.sqrt(Math.pow(yi,2)-Math.pow(Pe,2)),Je=Math.acos(Se/yi),Ve={u_frustum_tl:Bt.frustumCorners.TL,u_frustum_tr:Bt.frustumCorners.TR,u_frustum_br:Bt.frustumCorners.BR,u_frustum_bl:Bt.frustumCorners.BL,u_horizon:Bt.frustumCorners.horizon,u_transition:zt,u_fadeout_range:be,u_color:At,u_high_color:Qt,u_space_color:Jt,u_star_intensity:ue,u_star_size:5*b.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ie,u_horizon_angle:Je,u_rotation_matrix:me};ht.prepareDrawProgram(bt,Ot);const ti=ht.atmosphereBuffer;ti&&Ot.draw(bt,Dt.TRIANGLES,Nt,b.StencilMode.disabled,b.ColorMode.alphaBlended,b.CullFaceMode.backCW,Ve,"skybox",ti.vertexBuffer,ti.indexBuffer,ti.segments)}(this,this.style.fog),this.renderPass="sky",(b.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const ht=this.style._layers[P[this.currentLayer]],lt=h._getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,lt,ht,lt?$[lt.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<P.length;){const ht=this.style._layers[P[this.currentLayer]],lt=h._getLayerSourceCache(ht);if(ht.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const bt=lt?("symbol"===ht.type?G:$)[lt.id]:void 0;this._renderTileClippingMasks(ht,lt,lt?W[lt.id]:void 0),this.renderLayer(this,lt,ht,bt),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;b.values(this.style._layers).forEach(lt=>{const bt=h._getLayerSourceCache(lt);bt&&!lt.isHidden(this.transform.zoom)&&(!ht||ht.getSource().maxzoom<bt.getSource().maxzoom)&&(ht=bt)}),ht&&this.options.showTileBoundaries&&qo.debug(this,ht,ht.getVisibleCoordinates())}this.options.showPadding&&function(ht){const lt=ht.transform.padding;Qo(ht,ht.transform.height-(lt.top||0),3,Zl),Qo(ht,lt.bottom||0,3,xd),Oa(ht,lt.left||0,3,Kl),Oa(ht,ht.transform.width-(lt.right||0),3,Jo);const bt=ht.transform.centerPoint;var Dt,Bt,Nt,Ot;Ph(Dt=ht,(Bt=bt.x)-1,(Nt=ht.transform.height-bt.y)-10,2,20,Ot=Ah),Ph(Dt,Bt-10,Nt-1,20,2,Ot)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(b.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,_,P,V){P.isHidden(this.transform.zoom)||("background"===P.type||"sky"===P.type||"custom"===P.type||V&&V.length)&&(this.id=P.id,this.gpuTimingStart(P),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(P.type)||h.terrain&&"custom"===P.type)&&qo[P.type](h,_,P,V,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let P=this.gpuTimers[h.id];P||(P=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),P.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,P.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,_=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(_),h.beginQueryEXT(h.TIME_ELAPSED_EXT,_)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const _={};for(const P in h){const V=h[P],W=this.context.extTimerQuery,$=W.getQueryObjectEXT(V.query,W.QUERY_RESULT_EXT)/1e6;W.deleteQueryEXT(V.query),_[P]=$}return _}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const _=this.context.extTimerQuery;let P=0;for(const V of h)P+=_.getQueryObjectEXT(V,_.QUERY_RESULT_EXT)/1e6,_.deleteQueryEXT(V);return P}translatePosMatrix(h,_,P,V,W){if(!P[0]&&!P[1])return h;const $=W?"map"===V?this.transform.angle:0:"viewport"===V?-this.transform.angle:0;if($){const ht=Math.sin($),lt=Math.cos($);P=[P[0]*lt-P[1]*ht,P[0]*ht+P[1]*lt]}const G=[W?P[0]:Mn(_,P[0],this.transform.zoom),W?P[1]:Mn(_,P[1],this.transform.zoom),0],tt=new Float32Array(16);return b.translate(tt,h,G),tt}saveTileTexture(h){const _=this._tileTextures[h.size[0]];_?_.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const _=this._tileTextures[h];return _&&_.length>0?_.pop():null}isPatternMissing(h){return null===h||void 0!==h&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,_=this.terrain&&0===this.terrain.exaggeration(),P=this.style&&this.style.fog,V=[];return this.terrainRenderModeElevated()&&V.push("TERRAIN"),"globe"===this.transform.projection.name&&V.push("GLOBE"),_&&V.push("ZERO_EXAGGERATION"),P&&!h&&0!==P.getOpacity(this.transform.pitch)&&V.push("FOG"),h&&V.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&V.push("OVERDRAW_INSPECTOR"),V}useProgram(h,_,P){this.cache=this.cache||{};const V=P||[],W=this.currentGlobalDefines().concat(V),$=na.cacheKey($p[h],h,W,_);return this.cache[$]||(this.cache[$]=new na(this.context,h,$p[h],_,on[h],W)),this.cache[$]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=b.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new b.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,_,P){if(this.terrain&&this.terrain.renderingToTexture)return;const V=this.style.fog;if(V){const W=V.getOpacity(this.transform.pitch),$=((G,tt,ht,lt,bt,Dt,Bt,Nt,Ot,zt,At)=>{const Qt=G.transform,Jt=tt.properties.get("color").toArray01();Jt[3]=lt;const ne=G.frameCounter/1e3%1;return{u_fog_matrix:ht?Qt.calculateFogTileMatrix(ht):G.identityMat,u_fog_range:tt.getFovAdjustedRange(Qt._fov),u_fog_color:Jt,u_fog_horizon_blend:tt.properties.get("horizon-blend"),u_fog_temporal_offset:ne,u_frustum_tl:bt,u_frustum_tr:Dt,u_frustum_br:Bt,u_frustum_bl:Nt,u_globe_pos:Ot,u_globe_radius:zt,u_viewport:At,u_globe_transition:b.globeToMercatorTransition(Qt.zoom),u_is_globe:+("globe"===Qt.projection.name)}})(this,V,P,W,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*b.exported.devicePixelRatio,this.transform.height*b.exported.devicePixelRatio]);_.setFogUniformValues(h,$)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,_=h.createTexture();return h.bindTexture(h.TEXTURE_2D,_),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),_}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&0!==h.getOpacity(this.transform.pitch)}getBackgroundTiles(){const h=this._backgroundTiles,_=this._backgroundTiles={},P=this.transform.coveringTiles({tileSize:512});for(const V of P)_[V.key]=h[V.key]||new b.Tile(V,512,this.transform.tileZoom,this);return _}clearBackgroundTiles(){this._backgroundTiles={}}}class kr{constructor(h=0,_=0,P=0,V=0){if(isNaN(h)||h<0||isNaN(_)||_<0||isNaN(P)||P<0||isNaN(V)||V<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=_,this.left=P,this.right=V}interpolate(h,_,P){return null!=_.top&&null!=h.top&&(this.top=b.number(h.top,_.top,P)),null!=_.bottom&&null!=h.bottom&&(this.bottom=b.number(h.bottom,_.bottom,P)),null!=_.left&&null!=h.left&&(this.left=b.number(h.left,_.left,P)),null!=_.right&&null!=h.right&&(this.right=b.number(h.right,_.right,P)),this}getCenter(h,_){const P=b.clamp((this.left+h-this.right)/2,0,h),V=b.clamp((this.top+_-this.bottom)/2,0,_);return new b.pointGeometry(P,V)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new kr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function oa(S,h){const _=b.getColumn(S,3);b.fromQuat(S,h),b.setColumn(S,3,_)}function Dh(S,h){const _=b.identity$1([]);return b.rotateZ$1(_,_,-h),b.rotateX$1(_,_,-S),_}function Ih(S,h){const _=[S[0],S[1],0],P=[h[0],h[1],0];if(b.length(_)>=1e-15){const $=b.normalize([],_);b.scale$2(P,$,b.dot(P,$)),h[0]=P[0],h[1]=P[1]}const V=b.cross([],h,S);if(b.len(V)<1e-15)return null;const W=Math.atan2(-V[1],V[0]);return Dh(Math.atan2(Math.sqrt(S[0]*S[0]+S[1]*S[1]),-S[2]),W)}class Ql{constructor(h,_){this.position=h,this.orientation=_}get position(){return this._position}set position(h){if(h){const _=h instanceof b.MercatorCoordinate?h:new b.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(_.x=b.wrap(_.x,0,1)),this._position=_}else this._position=null}lookAtPoint(h,_){if(this.orientation=null,!this.position)return;const P=this.position,V=this._elevation?this._elevation.getAtPointOrZero(b.MercatorCoordinate.fromLngLat(h)):0,W=b.MercatorCoordinate.fromLngLat(h,V),$=[W.x-P.x,W.y-P.y,W.z-P.z];_||(_=[0,0,1]),_[2]=Math.abs(_[2]),this.orientation=Ih($,_)}setPitchBearing(h,_){this.orientation=Dh(b.degToRad(h),b.degToRad(-_))}}class mr{constructor(h,_){this._transform=b.identity([]),this.orientation=_,this.position=h}get mercatorPosition(){const h=this.position;return new b.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=b.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var _;h&&b.setColumn(this._transform,3,[(_=h)[0],_[1],_[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||b.identity$1([]),h&&oa(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),_=this.right();return{bearing:Math.atan2(-_[1],_[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,_){this._orientation=Dh(h,_),oa(this._transform,this._orientation)}forward(){const h=b.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=b.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=b.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,_){const P=new Float64Array(16);return b.invert(P,this.getWorldToCamera(h,_)),P}getWorldToCameraPosition(h,_,P){const V=this.position;b.scale$2(V,V,-h);const W=new Float64Array(16);return b.fromScaling(W,[P,P,P]),b.translate(W,W,V),W[10]*=_,W}getWorldToCamera(h,_){const P=new Float64Array(16),V=new Float64Array(4),W=this.position;return b.conjugate(V,this._orientation),b.scale$2(W,W,-h),b.fromQuat(P,V),b.translate(P,P,W),P[1]*=-1,P[5]*=-1,P[9]*=-1,P[13]*=-1,P[8]*=_,P[9]*=_,P[10]*=_,P[11]*=_,P}getCameraToClipPerspective(h,_,P,V){const W=new Float64Array(16);return b.perspective(W,h,_,P,V),W}getDistanceToElevation(h,_=!1){const P=0===h?0:b.mercatorZfromAltitude(h,_?b.latFromMercatorY(this.position[1]):this.position[1]),V=this.forward();return(P-this.position[2])/V[2]}clone(){return new mr([...this.position],[...this.orientation])}}function Fh(S,h){const _=ql(S.projection,S.zoom,S.width,S.height),P=function(W,$,G,tt,ht){const lt=new b.LngLat(G.lng-180*th,G.lat),bt=new b.LngLat(G.lng+180*th,G.lat),Dt=W.project(lt.lng,lt.lat),Bt=W.project(bt.lng,bt.lat),Nt=-Math.atan2(Bt.y-Dt.y,Bt.x-Dt.x),Ot=b.MercatorCoordinate.fromLngLat(G);Ot.y=b.clamp(Ot.y,-.999975,.999975);const zt=Ot.toLngLat(),At=W.project(zt.lng,zt.lat),Qt=b.MercatorCoordinate.fromLngLat(zt);Qt.x+=th;const Jt=Qt.toLngLat(),ne=W.project(Jt.lng,Jt.lat),me=vd(ne.x-At.x,ne.y-At.y,Nt),ue=b.MercatorCoordinate.fromLngLat(zt);ue.y+=th;const ge=ue.toLngLat(),be=W.project(ge.lng,ge.lat),Pe=vd(be.x-At.x,be.y-At.y,Nt),Ie=Math.abs(me.x)/Math.abs(Pe.y),yi=b.identity([]);b.rotateZ(yi,yi,-Nt*(1-(ht?0:tt)));const Se=b.identity([]);return b.scale(Se,Se,[1,1-(1-Ie)*tt,1]),Se[4]=-Pe.x/Pe.y*tt,b.rotateZ(Se,Se,Nt),b.multiply(Se,yi,Se),Se}(S.projection,0,S.center,_,h),V=Du(S);return b.scale(P,P,[V,V,1]),P}function Du(S){const h=S.projection,_=ql(S.projection,S.zoom,S.width,S.height),P=_d(h,S.center),V=_d(h,b.LngLat.convert(h.center));return Math.pow(2,P*_+(1-_)*V)}function ql(S,h,_,P,V=1/0){const W=S.range;if(!W)return 0;const $=Math.min(V,Math.max(_,P)),G=Math.log($/1024)/Math.LN2;return b.smoothstep(W[0]+G,W[1]+G,h)}const th=1/4e4;function _d(S,h){const _=b.clamp(h.lat,-b.MAX_MERCATOR_LATITUDE,b.MAX_MERCATOR_LATITUDE),P=new b.LngLat(h.lng-180*th,_),V=new b.LngLat(h.lng+180*th,_),W=S.project(P.lng,_),$=S.project(V.lng,_),G=b.MercatorCoordinate.fromLngLat(P),tt=b.MercatorCoordinate.fromLngLat(V),ht=$.x-W.x,lt=$.y-W.y,bt=tt.x-G.x,Dt=tt.y-G.y,Bt=Math.sqrt((bt*bt+Dt*Dt)/(ht*ht+lt*lt));return Math.log(Bt)/Math.LN2}function vd(S,h,_){const P=Math.cos(_),V=Math.sin(_);return{x:S*P-h*V,y:S*V+h*P}}class Oi{constructor(h,_,P,V,W,$,G){this.tileSize=512,this._renderWorldCopies=void 0===W||W,this._minZoom=h||0,this._maxZoom=_||22,this._minPitch=P??0,this._maxPitch=V??60,this.setProjection($),this.setMaxBounds(G),this.width=0,this.height=0,this._center=new b.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new kr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new mr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new Oi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,_=!1){const P=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||P)&&this._updateCameraOnTerrain(),(h||P)&&this._constrainCamera(_),this._calcMatrices()}getProjection(){return b.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const _=this.projection?this.getProjection():void 0;this.projection=b.getProjection(this.projectionOptions);const P=!De(_,this.getProjection());return P&&this._calcMatrices(),this.mercatorFromTransition=!1,P}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=b.getProjection({name:"mercator"});const _=h!==this.projection.name;return _&&this._calcMatrices(),_}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(h){void 0===h?h=!0:null===h&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return b.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new b.pointGeometry(this.width,this.height)}get bearing(){return b.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const _=-h*Math.PI/180;var P,V,W,$,G,tt,ht,lt,bt,Dt;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(P=new b.ARRAY_TYPE(4),b.ARRAY_TYPE!=Float32Array&&(P[1]=0,P[2]=0),P[0]=1,P[3]=1,P),V=this.rotationMatrix,$=this.angle,G=(W=this.rotationMatrix)[0],tt=W[1],ht=W[2],lt=W[3],bt=Math.sin($),Dt=Math.cos($),V[0]=G*Dt+ht*bt,V[1]=tt*Dt+lt*bt,V[2]=G*-bt+ht*Dt,V[3]=tt*-bt+lt*Dt)}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const _=b.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=b.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const _=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._setZoom(_),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,_=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],P=this.horizonLineFromTop();let V=0,W=0;for(let $=0;$<_.length;$++){const G=new b.pointGeometry(_[$][0]*this.width,P+_[$][1]*(this.height-P)),tt=h.pointCoordinate(G);if(!tt)continue;const ht=1/Math.hypot(tt[0]-this._camera.position[0],tt[1]-this._camera.position[1]);V+=tt[3]*ht,W+=ht}return 0===W?NaN:V/W}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const h=this._seaLevelZoom,_=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),P=this.pixelsPerMeter/this.worldSize*_,V=this._mercatorZfromZoom(h),W=this._mercatorZfromZoom(this._maxZoom),$=Math.max(V-P,W);this._setZoom(this._zoomFromMercatorZ($))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const _=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let P;P=h.z<this._camera.position[2]?[_.x,_.y,_.z]:[h.x,h.y,h.z];const V=b.length(b.sub([],this._camera.position,P));return b.clamp(this._zoomFromMercatorZ(V),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let _=!1;if(h.orientation&&!b.exactEquals(h.orientation,this._camera.orientation)&&(_=this._setCameraOrientation(h.orientation)),h.position){const P=[h.position.x,h.position.y,h.position.z];b.exactEquals$1(P,this._camera.position)||(this._setCameraPosition(P),_=!0)}_&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,_=new Ql;return _.position=new b.MercatorCoordinate(h[0],h[1],h[2]),_.orientation=this._camera.orientation,_._elevation=this.elevation,_._renderWorldCopies=this.renderWorldCopies,_}_setCameraOrientation(h){if(!b.length$1(h))return!1;b.normalize$1(h,h);const _=b.transformQuat([],[0,0,-1],h),P=b.transformQuat([],[0,-1,0],h);if(P[2]<0)return!1;const V=Ih(_,P);return!!V&&(this._camera.orientation=V,!0)}_setCameraPosition(h){const _=this.zoomScale(this.minZoom)*this.tileSize,P=this.zoomScale(this.maxZoom)*this.tileSize,V=this.cameraToCenterDistance;h[2]=b.clamp(h[2],V/P,V/_),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,_,P){this._unmodified=!1,this._edgeInsets.interpolate(h,_,P),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const _=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(h){const _=[new b.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const P=this.pointCoordinate(new b.pointGeometry(0,0)),V=this.pointCoordinate(new b.pointGeometry(this.width,0)),W=this.pointCoordinate(new b.pointGeometry(this.width,this.height)),$=this.pointCoordinate(new b.pointGeometry(0,this.height)),G=Math.floor(Math.min(P.x,V.x,W.x,$.x)),tt=Math.floor(Math.max(P.x,V.x,W.x,$.x)),ht=1;for(let lt=G-ht;lt<=tt+ht;lt++)0!==lt&&_.push(new b.UnwrappedTileID(lt,h))}return _}coveringTiles(h){let _=this.coveringZoomLevel(h);const P=_,V=this.elevation&&!h.isTerrainDEM,W="mercator"===this.projection.name;if(void 0!==h.minzoom&&_<h.minzoom)return[];void 0!==h.maxzoom&&_>h.maxzoom&&(_=h.maxzoom);const $=this.locationCoordinate(this.center),G=this.center.lat,tt=1<<_,ht=[tt*$.x,tt*$.y,0],lt="globe"===this.projection.name,bt=!lt,Dt=b.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_,bt),Bt=lt?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Nt=tt*b.mercatorZfromAltitude(1,this.center.lat),Ot=this._camera.position[2]/b.mercatorZfromAltitude(1,this.center.lat),zt=[tt*Bt.x,tt*Bt.y,Ot*(bt?1:Nt)],At=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Qt=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?_:0,Jt=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ne=h.isTerrainDEM?-Jt:this._elevation?this._elevation.getMinElevationBelowMSL():0,me=this.projection.isReprojectedInTileSpace?Du(this):1,ue=Fe=>{const Be=new b.MercatorCoordinate(Fe.x+25e-6,Fe.y,Fe.z),ei=new b.MercatorCoordinate(Fe.x,Fe.y+25e-6,Fe.z),ci=Fe.toLngLat(),qi=Be.toLngLat(),Xn=ei.toLngLat(),Gi=this.locationCoordinate(ci),Fi=this.locationCoordinate(qi),nn=this.locationCoordinate(Xn),Kn=Math.hypot(Fi.x-Gi.x,Fi.y-Gi.y),sn=Math.hypot(nn.x-Gi.x,nn.y-Gi.y);return Math.sqrt(Kn*sn)*me/25e-6},ge=Fe=>{const we=Jt,Be=ne;return{aabb:b.tileAABB(this,tt,0,0,0,Fe,Be,we,this.projection),zoom:0,x:0,y:0,minZ:Be,maxZ:we,wrap:Fe,fullyVisible:!1}},be=[];let Pe=[];const Ie=_,yi=h.reparseOverscaled?P:_,Se=Fe=>Fe*Fe,Je=Se((Ot-this._centerAltitude)*Nt),Ve=Fe=>{if(!this._elevation||!Fe.tileID||!W)return;const we=this._elevation.getMinMaxForTile(Fe.tileID),Be=Fe.aabb;we?(Be.min[2]=we.min,Be.max[2]=we.max,Be.center[2]=(Be.min[2]+Be.max[2])/2):(Fe.shouldSplit=ti(Fe),Fe.shouldSplit||(Be.min[2]=Be.max[2]=Be.center[2]=this._centerAltitude))},ti=Fe=>{if(Fe.zoom<Qt)return!0;if(Fe.zoom===Ie)return!1;if(null!=Fe.shouldSplit)return Fe.shouldSplit;const we=Fe.aabb.distanceX(zt),Be=Fe.aabb.distanceY(zt);let ei=Je,ci=1;if(lt){ei=Se(Fe.aabb.distanceZ(zt));const Gi=Math.pow(2,Fe.zoom),Fi=b.latFromMercatorY((Fe.y+1)/Gi),nn=b.latFromMercatorY(Fe.y/Gi),Kn=Math.min(Math.max(G,Fi),nn),sn=b.circumferenceAtLatitude(Kn)/b.circumferenceAtLatitude(G);if(ci=Kn===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,sn/this._mercatorScaleRatio),this.zoom<=b.GLOBE_ZOOM_THRESHOLD_MIN&&Fe.zoom===Ie-1&&sn>=.9)return!0}else if(V&&(ei=Se(Fe.aabb.distanceZ(zt)*Nt)),this.projection.isReprojectedInTileSpace&&P<=5){const Gi=Math.pow(2,Fe.zoom),Fi=ue(new b.MercatorCoordinate((Fe.x+.5)/Gi,(Fe.y+.5)/Gi));ci=Fi>.85?1:Fi}const qi=we*we+Be*Be+ei;return qi<Se((1<<Ie-Fe.zoom)*At*ci*((Gi,Fi)=>{if(Fi*Se(.707)<Gi)return 1;const nn=Math.sqrt(Fi/Gi);return nn/(1.4144271570014144+(Math.pow(1.1,nn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ei,Je),qi))};if(this.renderWorldCopies)for(let Fe=1;Fe<=3;Fe++)be.push(ge(-Fe)),be.push(ge(Fe));for(be.push(ge(0));be.length>0;){const Fe=be.pop(),we=Fe.x,Be=Fe.y;let ei=Fe.fullyVisible;if(!ei){const ci=Fe.aabb.intersects(Dt);if(0===ci)continue;ei=2===ci}if(Fe.zoom!==Ie&&ti(Fe))for(let ci=0;ci<4;ci++){const qi=(we<<1)+ci%2,Xn=(Be<<1)+(ci>>1),Gi={aabb:W?Fe.aabb.quadrant(ci):b.tileAABB(this,tt,Fe.zoom+1,qi,Xn,Fe.wrap,Fe.minZ,Fe.maxZ,this.projection),zoom:Fe.zoom+1,x:qi,y:Xn,wrap:Fe.wrap,fullyVisible:ei,tileID:void 0,shouldSplit:void 0,minZ:Fe.minZ,maxZ:Fe.maxZ};V&&!lt&&(Gi.tileID=new b.OverscaledTileID(Fe.zoom+1===Ie?yi:Fe.zoom+1,Fe.wrap,Fe.zoom+1,qi,Xn),Ve(Gi)),be.push(Gi)}else{const ci=Fe.zoom===Ie?yi:Fe.zoom;if(h.minzoom&&h.minzoom>ci)continue;const qi=ht[0]-(.5+we+(Fe.wrap<<Fe.zoom))*(1<<_-Fe.zoom),Xn=ht[1]-.5-Be,Gi=Fe.tileID?Fe.tileID:new b.OverscaledTileID(ci,Fe.wrap,Fe.zoom,we,Be);Pe.push({tileID:Gi,distanceSq:qi*qi+Xn*Xn})}}if(this.fogCullDistSq){const Fe=this.fogCullDistSq,we=this.horizonLineFromTop();Pe=Pe.filter(Be=>{const ei=[0,0,0,1],ci=[b.EXTENT,b.EXTENT,0,1],qi=this.calculateFogTileMatrix(Be.tileID.toUnwrapped());b.transformMat4$1(ei,ei,qi),b.transformMat4$1(ci,ci,qi);const Xn=b.getAABBPointSquareDist(ei,ci);if(0===Xn)return!0;let Gi=!1;const Fi=this._elevation;if(Fi&&Xn>Fe&&0!==we){const nn=this.calculateProjMatrix(Be.tileID.toUnwrapped());let Kn;h.isTerrainDEM||(Kn=Fi.getMinMaxForTile(Be.tileID)),Kn||(Kn={min:ne,max:Jt});const sn=b.furthestTileCorner(this.rotation),fs=[sn[0]*b.EXTENT,sn[1]*b.EXTENT,Kn.max];b.transformMat4(fs,fs,nn),Gi=(1-fs[1])*this.height*.5<we}return Xn<Fe||Gi})}return Pe.sort((Fe,we)=>Fe.distanceSq-we.distanceSq).map(Fe=>Fe.tileID)}resize(h,_){this.width=h,this.height=_,this.pixelsToGLUnits=[2/h,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const _=b.clamp(h.lat,-b.MAX_MERCATOR_LATITUDE,b.MAX_MERCATOR_LATITUDE),P=this.projection.project(h.lng,_);return new b.pointGeometry(P.x*this.worldSize,P.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/b.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,_){let P,V;const W=this.centerPoint;if("globe"===this.projection.name){const G=this.worldSize;P=(_.x-W.x)/G,V=(_.y-W.y)/G}else{const G=this.pointCoordinate(_),tt=this.pointCoordinate(W);P=G.x-tt.x,V=G.y-tt.y}const $=this.locationCoordinate(h);this.setLocation(new b.MercatorCoordinate($.x-P,$.y-V))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,_){const P=_?b.mercatorZfromAltitude(_,h.lat):void 0,V=this.projection.project(h.lng,h.lat);return new b.MercatorCoordinate(V.x,V.y,P)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,_){const P=_??this._centerAltitude,V=[h.x,h.y,0,1],W=[h.x,h.y,1,1];b.transformMat4$1(V,V,this.pixelMatrixInverse),b.transformMat4$1(W,W,this.pixelMatrixInverse);const $=W[3];b.scale$1(V,V,1/V[3]),b.scale$1(W,W,1/$);const G=V[2],tt=W[2];return{p0:V,p1:W,t:G===tt?0:(P-G)/(tt-G)}}screenPointToMercatorRay(h){const _=[h.x,h.y,0,1],P=[h.x,h.y,1,1];return b.transformMat4$1(_,_,this.pixelMatrixInverse),b.transformMat4$1(P,P,this.pixelMatrixInverse),b.scale$1(_,_,1/_[3]),b.scale$1(P,P,1/P[3]),_[2]=b.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,P[2]=b.mercatorZfromAltitude(P[2],this._center.lat)*this.worldSize,b.scale$1(_,_,1/this.worldSize),b.scale$1(P,P,1/this.worldSize),new b.Ray([_[0],_[1],_[2]],b.normalize([],b.sub([],P,_)))}rayIntersectionCoordinate(h){const{p0:_,p1:P,t:V}=h,W=b.mercatorZfromAltitude(_[2],this._center.lat),$=b.mercatorZfromAltitude(P[2],this._center.lat);return new b.MercatorCoordinate(b.number(_[0],P[0],V)/this.worldSize,b.number(_[1],P[1],V)/this.worldSize,b.number(W,$,V))}pointCoordinate(h,_=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,_)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let _=this.projection.pointCoordinate3D(this,h.x,h.y);if(_)return new b.MercatorCoordinate(_[0],_[1],_[2]);let P=0,V=this.horizonLineFromTop();if(h.y>V)return this.pointCoordinate(h);const W=.02*V,$=h.clone();for(let G=0;G<10&&V-P>W;G++){$.y=b.number(P,V,.66);const tt=this.projection.pointCoordinate3D(this,$.x,$.y);tt?(V=$.y,_=tt):P=$.y}return _?new b.MercatorCoordinate(_[0],_[1],_[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}_coordinatePoint(h,_){const P=_&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,V=[h.x*this.worldSize,h.y*this.worldSize,P+h.toAltitude(),1];return b.transformMat4$1(V,V,this.pixelMatrix),V[3]>0?new b.pointGeometry(V[0]/V[3],V[1]/V[3]):new b.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:_}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,V=this.width-this._edgeInsets.right,W=this.pointLocation3D(new b.pointGeometry(_,h)),$=this.pointLocation3D(new b.pointGeometry(V,h)),G=this.pointLocation3D(new b.pointGeometry(V,P)),tt=this.pointLocation3D(new b.pointGeometry(_,P));let ht=Math.min(W.lng,$.lng,G.lng,tt.lng),lt=Math.max(W.lng,$.lng,G.lng,tt.lng),bt=Math.min(W.lat,$.lat,G.lat,tt.lat),Dt=Math.max(W.lat,$.lat,G.lat,tt.lat);const Bt=Math.pow(2,-this.zoom)/16*270,Nt="globe"===this.projection.name?1:4,Ot=(zt,At,Qt,Jt,ne)=>{const me=(zt+Qt)/2,ue=(At+Jt)/2,ge=new b.pointGeometry(me,ue),{lng:be,lat:Pe}=this.pointLocation3D(ge),Ie=Math.max(0,ht-be,bt-Pe,be-lt,Pe-Dt);ht=Math.min(ht,be),lt=Math.max(lt,be),bt=Math.min(bt,Pe),Dt=Math.max(Dt,Pe),(ne<Nt||Ie>Bt)&&(Ot(zt,At,me,ue,ne+1),Ot(me,ue,Qt,Jt,ne+1))};if(Ot(_,h,V,h,1),Ot(V,h,V,P,1),Ot(V,P,_,P,1),Ot(_,P,_,h,1),"globe"===this.projection.name){const[zt,At]=b.polesInViewport(this);zt?(Dt=90,lt=180,ht=-180):At&&(bt=-90,lt=180,ht=-180)}return new b.LngLatBounds(new b.LngLat(ht,bt),new b.LngLat(lt,Dt))}_getBoundsRectangular(h,_){const{top:P,left:V}=this._edgeInsets,W=this.height-this._edgeInsets.bottom,$=this.width-this._edgeInsets.right,G=new b.pointGeometry(V,P),tt=new b.pointGeometry($,P),ht=new b.pointGeometry($,W),lt=new b.pointGeometry(V,W);let bt=this.pointCoordinate(G,h),Dt=this.pointCoordinate(tt,h);const Bt=this.pointCoordinate(ht,_),Nt=this.pointCoordinate(lt,_),Ot=(zt,At)=>(At.y-zt.y)/(At.x-zt.x);return bt.y>1&&Dt.y>=0?bt=new b.MercatorCoordinate((1-Nt.y)/Ot(Nt,bt)+Nt.x,1):bt.y<0&&Dt.y<=1&&(bt=new b.MercatorCoordinate(-Nt.y/Ot(Nt,bt)+Nt.x,0)),Dt.y>1&&bt.y>=0?Dt=new b.MercatorCoordinate((1-Bt.y)/Ot(Bt,Dt)+Bt.x,1):Dt.y<0&&bt.y<=1&&(Dt=new b.MercatorCoordinate(-Bt.y/Ot(Bt,Dt)+Bt.x,0)),(new b.LngLatBounds).extend(this.coordinateLocation(bt)).extend(this.coordinateLocation(Dt)).extend(this.coordinateLocation(Nt)).extend(this.coordinateLocation(Bt))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const _=h.visibleDemTiles.reduce((P,V)=>{if(V.dem){const W=V.dem.tree;P.min=Math.min(P.min,W.minimums[0]),P.max=Math.max(P.max,W.maximums[0])}return P},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(_.min*h.exaggeration(),_.max*h.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const _=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,P=this.height/2-_*(1-this._horizonShift);return h?Math.max(0,P):P}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-b.MAX_MERCATOR_LATITUDE,this.maxLat=b.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=b.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=b.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=b.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=b.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,_){return this.projection.createTileMatrix(this,_,h)}calculateDistanceTileData(h){const _=h.key,P=this._distanceTileDataCache;if(P[_])return P[_];const V=h.canonical,W=1/this.height,$=this.cameraWorldSize,G=$/this.zoomScale(V.z),tt=(V.x+Math.pow(2,V.z)*h.wrap)*G,ht=V.y*G,lt=this.point;lt.x*=$/this.worldSize,lt.y*=$/this.worldSize;const bt=this.angle,Dt=Math.sin(-bt),Bt=-Math.cos(-bt);return P[_]={bearing:[Dt,Bt],center:[(lt.x-tt)*W,(lt.y-ht)*W],scale:G/b.EXTENT*W},P[_]}calculateFogTileMatrix(h){const _=h.key,P=this._fogTileMatrixCache;if(P[_])return P[_];const V=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return b.multiply(V,this.worldToFogMatrix,V),P[_]=new Float32Array(V),P[_]}calculateProjMatrix(h,_=!1){const P=h.key,V=_?this._alignedProjMatrixCache:this._projMatrixCache;if(V[P])return V[P];const W=this.calculatePosMatrix(h,this.worldSize);return b.multiply(W,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:_?this.alignedProjMatrix:this.projMatrix,W),V[P]=new Float32Array(W),V[P]}calculatePixelsToTileUnitsMatrix(h){const _=h.tileID.key,P=this._pixelsToTileUnitsCache;if(P[_])return P[_];const V=function(W,$){const{scale:G}=W.tileTransform,tt=G*b.EXTENT/(W.tileSize*Math.pow(2,$.zoom-W.tileID.overscaledZ+W.tileID.canonical.z));return ht=new Float32Array(4),Dt=(lt=$.inverseAdjustmentMatrix)[1],Bt=lt[2],Nt=lt[3],zt=(bt=[tt,tt])[1],ht[0]=lt[0]*(Ot=bt[0]),ht[1]=Dt*Ot,ht[2]=Bt*zt,ht[3]=Nt*zt,ht;var ht,lt,bt,Dt,Bt,Nt,Ot,zt}(h,this);return P[_]=V,P[_]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const h=1/this.worldSize,_=b.fromScaling([],[h,h,h]);return b.multiply(_,_,this.globeMatrix),_}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const h=this._elevation;this._updateCameraState();const _=b.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,P=this._computeCameraPosition(_),V=this._camera.forward(),W=b.mercatorZfromAltitude(1,this._center.lat);P[2]/=W,V[2]/=W,b.normalize(V,V);const $=h.raycast(P,V,h.exaggeration());if($){const G=b.scaleAndAdd([],P,V,$),tt=new b.MercatorCoordinate(G[0],G[1],b.mercatorZfromAltitude(G[2],b.latFromMercatorY(G[1]))),ht=(tt.z+b.length([tt.x-P[0],tt.y-P[1],tt.z-P[2]*W]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ht),this._centerAltitude=tt.toAltitude(),this._center=this.coordinateLocation(tt),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const _=this._elevation,P=b.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,V=this._computeCameraPosition(P),W=_.getAtPointOrZero(new b.MercatorCoordinate(...V)),$=this.pixelsPerMeter/this.worldSize*W,G=this._minimumHeightOverTerrain(),tt=V[2]-$;if(tt<=G)if(tt<0||h){const ht=this.locationCoordinate(this._center,this._centerAltitude),lt=[V[0],V[1],ht.z-V[2]],bt=b.length(lt);lt[2]-=(G-tt)/this._pixelsPerMercatorPixel;const Dt=b.length(lt);if(0===Dt)return;b.scale$2(lt,lt,bt/Dt*this._pixelsPerMercatorPixel),this._camera.position=[V[0],V[1],ht.z*this._pixelsPerMercatorPixel-lt[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const Dt=this.center;return Dt.lat=b.clamp(Dt.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(Dt.lng=b.clamp(Dt.lng,this.minLng,this.maxLng)),this.center=Dt,void(this._constraining=!1)}const _=this._unmodified,{x:P,y:V}=this.point;let W=0,$=P,G=V;const tt=this.width/2,ht=this.height/2,lt=this.worldMinY*this.scale,bt=this.worldMaxY*this.scale;if(V-ht<lt&&(G=lt+ht),V+ht>bt&&(G=bt-ht),bt-lt<this.height&&(W=Math.max(W,this.height/(bt-lt)),G=(bt+lt)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Dt=this.worldMinX*this.scale,Bt=this.worldMaxX*this.scale,Nt=this.worldSize/2-(Dt+Bt)/2;$=(P+Nt+this.worldSize)%this.worldSize-Nt,$-tt<Dt&&($=Dt+tt),$+tt>Bt&&($=Bt-tt),Bt-Dt<this.width&&(W=Math.max(W,this.width/(Bt-Dt)),$=(Bt+Dt)/2)}$===P&&G===V||(this.center=this.unproject(new b.pointGeometry($,G))),W&&(this.zoom+=this.scaleZoom(W)),this._constrainCamera(),this._unmodified=_,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,_=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=b.mercatorZfromAltitude(1,this.center.lat)/b.mercatorZfromAltitude(1,b.GLOBE_SCALE_MATCH_LATITUDE));const P=ql(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,P),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const V="meters"===this.projection.zAxisUnit?_:1,W=this._camera.getWorldToCamera(this.worldSize,V),$=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);$[8]=2*-h.x/this.width,$[9]=2*h.y/this.height;let G=b.mul([],$,W);if(this.projection.isReprojectedInTileSpace){const ue=this.locationCoordinate(this.center),ge=b.identity([]);b.translate(ge,ge,[ue.x*this.worldSize,ue.y*this.worldSize,0]),b.multiply(ge,ge,Fh(this)),b.translate(ge,ge,[-ue.x*this.worldSize,-ue.y*this.worldSize,0]),b.multiply(G,G,ge),this.inverseAdjustmentMatrix=function(be){const Pe=Fh(be,!0);return Xi([],[Pe[0],Pe[1],Pe[4],Pe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=b.scale([],G,[this.worldSize,this.worldSize,this.worldSize/V,1]),this.projMatrix=G,this.invProjMatrix=b.invert(new Float64Array(16),this.projMatrix);const tt=b.invert([],$);this.frustumCorners=b.FrustumCorners.fromInvProjectionMatrix(tt,this.horizonLineFromTop(),this.height);const ht=new Float32Array(16);b.identity(ht),b.scale(ht,ht,[1,-1,1]),b.rotateX(ht,ht,this._pitch),b.rotateZ(ht,ht,this.angle);const lt=b.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),bt=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;lt[8]=2*-h.x/this.width,lt[9]=2*(h.y+bt)/this.height,this.skyboxMatrix=b.multiply(ht,lt,ht);const Dt=this.point,Bt=Dt.x,Nt=Dt.y,Ot=this.width%2/2,zt=this.height%2/2,At=Math.cos(this.angle),Qt=Math.sin(this.angle),Jt=Bt-Math.round(Bt)+At*Ot+Qt*zt,ne=Nt-Math.round(Nt)+At*zt+Qt*Ot,me=new Float64Array(G);if(b.translate(me,me,[Jt>.5?Jt-1:Jt,ne>.5?ne-1:ne,0]),this.alignedProjMatrix=me,G=b.create(),b.scale(G,G,[this.width/2,-this.height/2,1]),b.translate(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=b.create(),b.scale(G,G,[1,-1,1]),b.translate(G,G,[-1,-1,0]),b.scale(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=b.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},G=b.invert(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=b.calculateGlobeMatrix(this);const ue=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=b.transformMat4(ue,ue,W),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,_=this.cameraPixelsPerMeter,P=this._camera.position,V=1/this.height/this._pixelsPerMercatorPixel,W=[h,h,_];b.scale$2(W,W,V),b.scale$2(P,P,-1),b.multiply$2(P,P,W);const $=b.create();b.translate($,$,P),b.scale($,$,W),this.mercatorFogMatrix=$,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,_,V)}_computeCameraPosition(h){const _=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,P=this._camera.forward(),V=this.point,W=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*_-h/this.worldSize*this._centerAltitude;return[V.x/this.worldSize-P[0]*W,V.y/this.worldSize-P[1]*W,h/this.worldSize*this._centerAltitude-P[2]*W]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const _=this._maxCameraBoundsDistance()*Math.cos(this._pitch),P=this._camera.position[2],V=h[2];let W=1;this.projection.wrap&&(this.center=this.center.wrap()),V>0&&(W=Math.min((_-P)/V,1)),this._camera.position=b.scaleAndAdd([],this._camera.position,h,W),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,_=this._camera.forward(),{pitch:P,bearing:V}=this._camera.getPitchBearing(),W=b.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,$=this._mercatorZfromZoom(this._maxZoom)*Math.cos(b.degToRad(this._maxPitch)),G=Math.max((h[2]-W)/Math.cos(P),$),tt=this._zoomFromMercatorZ(G);b.scaleAndAdd(h,h,_,G),this._pitch=b.clamp(P,b.degToRad(this.minPitch),b.degToRad(this.maxPitch)),this.angle=b.wrap(V,-Math.PI,Math.PI),this._setZoom(b.clamp(tt,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new b.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let _=0,P=b.GLOBE_ZOOM_THRESHOLD_MAX,V=0,W=1/0;for(;P-_>1e-6&&P>_;){const $=_+.5*(P-_),G=this.tileSize*Math.pow(2,$),tt=this.getCameraToCenterDistance(this.projection,$,G),ht=this.scaleZoom(tt/(h*this.tileSize)),lt=Math.abs($-ht);lt<W&&(W=lt,V=$),$<ht?_=$:P=$}return V}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(b.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,_){const P=Math.min(h.x,_.x),V=Math.max(h.x,_.x),W=Math.min(h.y,_.y),$=Math.max(h.y,_.y);if(W<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const G=[new b.pointGeometry(P,W),new b.pointGeometry(V,$),new b.pointGeometry(P,$),new b.pointGeometry(V,W)],tt=this.renderWorldCopies?-3:0,ht=this.renderWorldCopies?4:1;for(const lt of G){const bt=this.pointRayIntersection(lt);if(bt.t<0)return!0;const Dt=this.rayIntersectionCoordinate(bt);if(Dt.x<tt||Dt.y<0||Dt.x>ht||Dt.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+b.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new b.pointGeometry(0,0),new b.pointGeometry(this.width,this.height))}zoomDeltaToMovement(h,_){const P=b.length(b.sub([],this._camera.position,h)),V=this._zoomFromMercatorZ(P)+_;return P-this._mercatorZfromZoom(V)}getCameraPoint(){if("globe"===this.projection.name){const h=function([_,P,V],W){const $=[_,P,V,1];b.transformMat4$1($,$,W);const G=$[3]=Math.max($[3],1e-6);return $[0]/=G,$[1]/=G,$[2]/=G,$}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new b.pointGeometry(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new b.pointGeometry(0,h))}}getCameraToCenterDistance(h,_=this.zoom,P=this.worldSize){const V=ql(h,_,this.width,this.height,1024),W=h.pixelSpaceConversion(this.center.lat,P,V);return.5/Math.tan(.5*this._fov)*this.height*W}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&b.multiply(h,h,this.globeMatrix),h}}function va(S,h){let _=!1,P=null;const V=()=>{P=null,_&&(S(),P=setTimeout(V,h),_=!1)};return()=>(_=!0,P||V(),P)}class Uf{constructor(h){this._hashName=h&&encodeURIComponent(h),b.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=va(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,b.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),b.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const _=Jp(h);if(this._hashName){const P=this._hashName;let V=!1;const W=b.window.location.hash.slice(1).split("&").map($=>{const G=$.split("=")[0];return G===P?(V=!0,`${G}=${_}`):$}).filter($=>$);return V||W.push(`${P}=${_}`),`#${W.join("&")}`}return`#${_}`}_getCurrentHash(){const h=b.window.location.hash.replace("#","");if(this._hashName){let _;return h.split("&").map(P=>P.split("=")).forEach(P=>{P[0]===this._hashName&&(_=P)}),(_&&_[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const _=this._getCurrentHash();if(_.length>=3&&!_.some(P=>isNaN(P))){const P=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(_[3]||0):h.getBearing();return h.jumpTo({center:[+_[2],+_[1]],zoom:+_[0],bearing:P,pitch:+(_[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=b.window.location.href.replace(/(#.+)?$/,this.getHashString());b.window.history.replaceState(b.window.history.state,null,h)}}function Jp(S,h){const _=S.getCenter(),P=Math.round(100*S.getZoom())/100,V=Math.ceil((P*Math.LN2+Math.log(512/360/.5))/Math.LN10),W=Math.pow(10,V),$=Math.round(_.lng*W)/W,G=Math.round(_.lat*W)/W,tt=S.getBearing(),ht=S.getPitch();let lt=h?`/${$}/${G}/${P}`:`${P}/${G}/${$}`;return(tt||ht)&&(lt+="/"+Math.round(10*tt)/10),ht&&(lt+=`/${Math.round(ht)}`),lt}const bd={linearity:.3,easing:b.bezier(0,0,.3,1)},Ac=b.extend({deceleration:2500,maxSpeed:1400},bd),Yf=b.extend({deceleration:20,maxSpeed:1400},bd),Iu=b.extend({deceleration:1e3,maxSpeed:360},bd),Qp=b.extend({deceleration:1e3,maxSpeed:90},bd);class Fu{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:b.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,_=b.exported.now();for(;h.length>0&&_-h[0].time>160;)h.shift()}_onMoveEnd(h){if(b.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const _={zoom:0,bearing:0,pitch:0,pan:new b.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:W}of this._inertiaBuffer)_.zoom+=W.zoomDelta||0,_.bearing+=W.bearingDelta||0,_.pitch+=W.pitchDelta||0,W.panDelta&&_.pan._add(W.panDelta),W.around&&(_.around=W.around),W.pinchAround&&(_.pinchAround=W.pinchAround);const P=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,V={};if(_.pan.mag()){const W=Bh(_.pan.mag(),P,b.extend({},Ac,h||{}));V.offset=_.pan.mult(W.amount/_.pan.mag()),V.center=this._map.transform.center,Lh(V,W)}if(_.zoom){const W=Bh(_.zoom,P,Yf);V.zoom=this._map.transform.zoom+W.amount,Lh(V,W)}if(_.bearing){const W=Bh(_.bearing,P,Iu);V.bearing=this._map.transform.bearing+b.clamp(W.amount,-179,179),Lh(V,W)}if(_.pitch){const W=Bh(_.pitch,P,Qp);V.pitch=this._map.transform.pitch+W.amount,Lh(V,W)}if(V.zoom||V.bearing){const W=void 0===_.pinchAround?_.around:_.pinchAround;V.around=W?this._map.unproject(W):this._map.getCenter()}return this.clear(),V.noMoveStart=!0,V}}function Lh(S,h){(!S.duration||S.duration<h.duration)&&(S.duration=h.duration,S.easing=h.easing)}function Bh(S,h,_){const{maxSpeed:P,linearity:V,deceleration:W}=_,$=b.clamp(S*V/(h/1e3),-P,P),G=Math.abs($)/(W*V);return{easing:_.easing,duration:1e3*G,amount:$*(G/2)}}class tr extends b.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,P,V={}){const W=xi(_.getCanvasContainer(),P),$=_.unproject(W);super(h,b.extend({point:W,lngLat:$,originalEvent:P},V)),this._defaultPrevented=!1,this.target=_}}class Lu extends b.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,P){const V="touchend"===h?P.changedTouches:P.touches,W=en(_.getCanvasContainer(),V),$=W.map(tt=>_.unproject(tt)),G=W.reduce((tt,ht,lt,bt)=>tt.add(ht.div(bt.length)),new b.pointGeometry(0,0));super(h,{points:W,point:G,lngLats:$,lngLat:_.unproject(G),originalEvent:P}),this._defaultPrevented=!1}}class uy extends b.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,_,P){super(h,{originalEvent:P}),this._defaultPrevented=!1}}class Ml{constructor(h,_){this._map=h,this._clickTolerance=_.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new uy(h.type,this._map,h))}mousedown(h,_){return this._mousedownPos=_,this._firePreventable(new tr(h.type,this._map,h))}mouseup(h){this._map.fire(new tr(h.type,this._map,h))}preclick(h){const _=b.extend({},h);_.type="preclick",this._map.fire(new tr(_.type,this._map,_))}click(h,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||(this.preclick(h),this._map.fire(new tr(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new tr(h.type,this._map,h))}mouseover(h){this._map.fire(new tr(h.type,this._map,h))}mouseout(h){this._map.fire(new tr(h.type,this._map,h))}touchstart(h){return this._firePreventable(new Lu(h.type,this._map,h))}touchmove(h){this._map.fire(new Lu(h.type,this._map,h))}touchend(h){this._map.fire(new Lu(h.type,this._map,h))}touchcancel(h){this._map.fire(new Lu(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wd{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new tr(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new tr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new tr(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class er{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,_){this.isEnabled()&&h.shiftKey&&0===h.button&&(Yo(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(h,_){if(!this._active)return;const P=_,V=this._startPos,W=this._lastPos;if(!V||!W||W.equals(P)||!this._box&&P.dist(V)<this._clickTolerance)return;this._lastPos=P,this._box||(this._box=bi("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const $=Math.min(V.x,P.x),G=Math.max(V.x,P.x),tt=Math.min(V.y,P.y),ht=Math.max(V.y,P.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${$}px,${tt}px)`,this._box.style.width=G-$+"px",this._box.style.height=ht-tt+"px")})}mouseupWindow(h,_){if(!this._active)return;const P=this._startPos,V=_;if(P&&0===h.button){if(this.reset(),Li(),P.x!==V.x||P.y!==V.y)return this._map.fire(new b.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:W=>W.fitScreenCoordinates(P,V,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&27===h.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),tn(),delete this._startPos,delete this._lastPos}_fireEvent(h,_){return this._map.fire(new b.Event(h,{originalEvent:_}))}}function Pc(S,h){const _={};for(let P=0;P<S.length;P++)_[S[P].identifier]=h[P];return _}class qp{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,_,P){(this.centroid||P.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=h.timeStamp),P.length===this.numTouches&&(this.centroid=function(V){const W=new b.pointGeometry(0,0);for(const $ of V)W._add($);return W.div(V.length)}(_),this.touches=Pc(P,_)))}touchmove(h,_,P){if(this.aborted||!this.centroid)return;const V=Pc(P,_);for(const W in this.touches){const G=V[W];(!G||G.dist(this.touches[W])>30)&&(this.aborted=!0)}}touchend(h,_,P){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),0===P.length){const V=!this.aborted&&this.centroid;if(this.reset(),V)return V}}}class Oh{constructor(h){this.singleTap=new qp(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,_,P){this.singleTap.touchstart(h,_,P)}touchmove(h,_,P){this.singleTap.touchmove(h,_,P)}touchend(h,_,P){const V=this.singleTap.touchend(h,_,P);if(V){const W=h.timeStamp-this.lastTime<500,$=!this.lastTap||this.lastTap.dist(V)<30;if(W&&$||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=V,this.count===this.numTaps)return this.reset(),V}}}class Md{constructor(){this._zoomIn=new Oh({numTouches:1,numTaps:2}),this._zoomOut=new Oh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,_,P){this._zoomIn.touchstart(h,_,P),this._zoomOut.touchstart(h,_,P)}touchmove(h,_,P){this._zoomIn.touchmove(h,_,P),this._zoomOut.touchmove(h,_,P)}touchend(h,_,P){const V=this._zoomIn.touchend(h,_,P),W=this._zoomOut.touchend(h,_,P);return V?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:$.getZoom()+1,around:$.unproject(V)},{originalEvent:h})}):W?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:$.getZoom()-1,around:$.unproject(W)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Bu={0:1,2:2};class Cd{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,_){return!1}_move(h,_){return{}}mousedown(h,_){if(this._lastPoint)return;const P=ro(h);this._correctButton(h,P)&&(this._lastPoint=_,this._eventButton=P)}mousemoveWindow(h,_){const P=this._lastPoint;if(P)if(h.preventDefault(),null!=this._eventButton&&function(V,W){const $=Bu[W];return void 0===V.buttons||(V.buttons&$)!==$}(h,this._eventButton))this.reset();else if(this._moved||!(_.dist(P)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(P,_)}mouseupWindow(h){this._lastPoint&&ro(h)===this._eventButton&&(this._moved&&Li(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Td extends Cd{mousedown(h,_){super.mousedown(h,_),this._lastPoint&&(this._active=!0)}_correctButton(h,_){return 0===_&&!h.ctrlKey}_move(h,_){return{around:_,panDelta:_.sub(h)}}}class Ou extends Cd{_correctButton(h,_){return 0===_&&h.ctrlKey||2===_}_move(h,_){const P=.8*(_.x-h.x);if(P)return this._active=!0,{bearingDelta:P}}contextmenu(h){h.preventDefault()}}class Rr extends Cd{_correctButton(h,_){return 0===_&&h.ctrlKey||2===_}_move(h,_){const P=-.5*(_.y-h.y);if(P)return this._active=!0,{pitchDelta:P}}contextmenu(h){h.preventDefault()}}class eh{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=_.clickTolerance||1,this.reset(),b.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new b.pointGeometry(0,0)}touchstart(h,_,P){return this._calculateTransform(h,_,P)}touchmove(h,_,P){if(this._active&&!(P.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===P.length&&!b.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,_,P)}}touchend(h,_,P){this._calculateTransform(h,_,P),this._active&&P.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,_,P){P.length>0&&(this._active=!0);const V=Pc(P,_),W=new b.pointGeometry(0,0),$=new b.pointGeometry(0,0);let G=0;for(const ht in V){const lt=V[ht],bt=this._touches[ht];bt&&(W._add(lt),$._add(lt.sub(bt)),G++,V[ht]=lt)}if(this._touches=V,G<this._minTouches||!$.mag())return;const tt=$.div(G);return this._sum._add(tt),this._sum.mag()<this._clickTolerance?void 0:{around:W.div(G),panDelta:tt}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=bi("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ec{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,_,P){return{}}touchstart(h,_,P){this._firstTwoTouches||P.length<2||(this._firstTwoTouches=[P[0].identifier,P[1].identifier],this._start([_[0],_[1]]))}touchmove(h,_,P){const V=this._firstTwoTouches;if(!V)return;h.preventDefault();const[W,$]=V,G=Po(P,_,W),tt=Po(P,_,$);if(!G||!tt)return;const ht=this._aroundCenter?null:G.add(tt).div(2);return this._move([G,tt],ht,h)}touchend(h,_,P){if(!this._firstTwoTouches)return;const[V,W]=this._firstTwoTouches,$=Po(P,_,V),G=Po(P,_,W);$&&G||(this._active&&Li(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&"center"===h.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Po(S,h,_){for(let P=0;P<S.length;P++)if(S[P].identifier===_)return h[P]}function tm(S,h){return Math.log(S/h)/Math.LN2}class Dc extends Ec{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,_){const P=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(tm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:tm(this._distance,P),pinchAround:_}}}function Ar(S,h){return 180*S.angleWith(h)/Math.PI}class em extends Ec{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,_){const P=this._vector;if(this._vector=h[0].sub(h[1]),P&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ar(this._vector,P),pinchAround:_}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const _=25/(Math.PI*this._minDiameter)*360,P=this._startVector;if(!P)return!1;const V=Ar(h,P);return Math.abs(V)<_}}function Ic(S){return Math.abs(S.y)>Math.abs(S.x)}class Eo extends Ec{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,Ic(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,_,P){const V=this._lastPoints;if(!V)return;const W=h[0].sub(V[0]),$=h[1].sub(V[1]);return this._map._cooperativeGestures&&!b.isFullscreen()&&P.touches.length<3||(this._valid=this.gestureBeginsVertically(W,$,P.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(W.y+$.y)/2*-.5})}gestureBeginsVertically(h,_,P){if(void 0!==this._valid)return this._valid;const V=h.mag()>=2,W=_.mag()>=2;if(!V&&!W)return;if(!V||!W)return null==this._firstMove&&(this._firstMove=P),P-this._firstMove<100&&void 0;const $=h.y>0==_.y>0;return Ic(h)&&Ic(_)&&$}}const Vr={panStep:100,bearingStep:15,pitchStep:10};class im{constructor(){const h=Vr;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let _=0,P=0,V=0,W=0,$=0;switch(h.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:h.shiftKey?P=-1:(h.preventDefault(),W=-1);break;case 39:h.shiftKey?P=1:(h.preventDefault(),W=1);break;case 38:h.shiftKey?V=1:(h.preventDefault(),$=-1);break;case 40:h.shiftKey?V=-1:(h.preventDefault(),$=1);break;default:return}return this._rotationDisabled&&(P=0,V=0),{cameraAnimation:G=>{const tt=G.getZoom();G.easeTo({duration:300,easeId:"keyboardHandler",easing:Sd,zoom:_?Math.round(tt)+_*(h.shiftKey?2:1):tt,bearing:G.getBearing()+P*this._bearingStep,pitch:G.getPitch()+V*this._pitchStep,offset:[-W*this._panStep,-$*this._panStep],center:G.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Sd(S){return S*(2-S)}const nm=4.000244140625;class fr{constructor(h,_){this._map=h,this._el=h.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,b.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&"center"===h.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||b.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let _=h.deltaMode===b.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const P=b.exported.now(),V=P-(this._lastWheelEventTime||0);this._lastWheelEventTime=P,0!==_&&_%nm==0?this._type="wheel":0!==_&&Math.abs(_)<4?this._type="trackpad":V>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(V*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),h.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=h,this._delta-=_,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=xi(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:_,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;"wheel"===this._type&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const _=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(0!==this._delta){const tt="wheel"===this._type&&Math.abs(this._delta)>nm?this._wheelZoomRate:this._defaultZoomRate;let ht=2/(1+Math.exp(-Math.abs(this._delta*tt)));this._delta<0&&0!==ht&&(ht=1/ht);const lt=_(),bt=Math.pow(2,lt),Dt="number"==typeof this._targetZoom?h.zoomScale(this._targetZoom):bt;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(Dt*ht))),"wheel"===this._type&&(this._startZoom=lt,this._easing=this._smoothOutEasing(200)),this._delta=0}const P="number"==typeof this._targetZoom?this._targetZoom:_(),V=this._startZoom,W=this._easing;let $,G=!1;if("wheel"===this._type&&V&&W){const tt=Math.min((b.exported.now()-this._lastWheelEventTime)/200,1),ht=W(tt);$=b.number(V,P,ht),tt<1?this._frameId||(this._frameId=!0):G=!0}else $=P,G=!0;return this._active=!0,G&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!G,zoomDelta:$-_(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let _=b.ease;if(this._prevEase){const P=this._prevEase,V=(b.exported.now()-P.start)/P.duration,W=P.easing(V+.01)-P.easing(V),$=.27/Math.sqrt(W*W+1e-4)*.01,G=Math.sqrt(.0729-$*$);_=b.bezier($,G,.25,1)}return this._prevEase={start:b.exported.now(),duration:h,easing:_},_}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=bi("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(b.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ru{constructor(h,_){this._clickZoom=h,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Cl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,_){return h.preventDefault(),{cameraAnimation:P=>{P.easeTo({duration:300,zoom:P.getZoom()+(h.shiftKey?-1:1),around:P.unproject(_)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sn{constructor(){this._tap=new Oh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,_,P){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?P.length>0&&(this._swipePoint=_[0],this._swipeTouch=P[0].identifier):this._tap.touchstart(h,_,P))}touchmove(h,_,P){if(this._tapTime){if(this._swipePoint){if(P[0].identifier!==this._swipeTouch)return;const V=_[0],W=V.y-this._swipePoint.y;return this._swipePoint=V,h.preventDefault(),this._active=!0,{zoomDelta:W/128}}}else this._tap.touchmove(h,_,P)}touchend(h,_,P){this._tapTime?this._swipePoint&&0===P.length&&this.reset():this._tap.touchend(h,_,P)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fc{constructor(h,_,P){this._el=h,this._mousePan=_,this._touchPan=P}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Hi{constructor(h,_,P){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=_,this._mousePitch=P}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class sm{constructor(h,_,P,V){this._el=h,this._touchZoom=_,this._touchRotate=P,this._tapDragZoom=V,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Lc=S=>S.zoom||S.drag||S.pitch||S.rotate;class Bc extends b.Event{}class Rh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,_){const P=b.sub([],_,h);this.radius=b.length(P[2]<0?b.div([],P,this.constants):[P[0],P[1],0])}projectRay(h){b.div(h,h,this.constants),b.normalize(h,h),b.mul$1(h,h,this.constants);const _=b.scale$2([],h,this.radius);if(_[2]>0){const P=b.scale$2([],[0,0,1],b.dot(_,[0,0,1])),V=b.scale$2([],b.normalize([],[_[0],_[1],0]),this.radius),W=b.add([],_,b.scale$2([],b.sub([],b.add([],V,P),_),2));_[0]=W[0],_[1]=W[1]}return _}}function Oc(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta}class om{constructor(h,_){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fu(h),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Rh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(_),b.bindAll(["handleEvent","handleWindowEvent"],this);const P=this._el;this._listeners=[[P,"touchstart",{passive:!0}],[P,"touchmove",{passive:!1}],[P,"touchend",void 0],[P,"touchcancel",void 0],[P,"mousedown",void 0],[P,"mousemove",void 0],[P,"mouseup",void 0],[b.window.document,"mousemove",{capture:!0}],[b.window.document,"mouseup",void 0],[P,"mouseover",void 0],[P,"mouseout",void 0],[P,"dblclick",void 0],[P,"click",void 0],[P,"keydown",{capture:!1}],[P,"keyup",void 0],[P,"wheel",{passive:!1}],[P,"contextmenu",void 0],[b.window,"blur",void 0]];for(const[V,W,$]of this._listeners)V.addEventListener(W,V===b.window.document?this.handleWindowEvent:this.handleEvent,$)}destroy(){for(const[h,_,P]of this._listeners)h.removeEventListener(_,h===b.window.document?this.handleWindowEvent:this.handleEvent,P)}_addDefaultHandlers(h){const _=this._map,P=_.getCanvasContainer();this._add("mapEvent",new Ml(_,h));const V=_.boxZoom=new er(_,h);this._add("boxZoom",V);const W=new Md,$=new Cl;_.doubleClickZoom=new Ru($,W),this._add("tapZoom",W),this._add("clickZoom",$);const G=new Sn;this._add("tapDragZoom",G);const tt=_.touchPitch=new Eo(_);this._add("touchPitch",tt);const ht=new Ou(h),lt=new Rr(h);_.dragRotate=new Hi(h,ht,lt),this._add("mouseRotate",ht,["mousePitch"]),this._add("mousePitch",lt,["mouseRotate"]);const bt=new Td(h),Dt=new eh(_,h);_.dragPan=new Fc(P,bt,Dt),this._add("mousePan",bt),this._add("touchPan",Dt,["touchZoom","touchRotate"]);const Bt=new em,Nt=new Dc;_.touchZoomRotate=new sm(P,Nt,Bt,G),this._add("touchRotate",Bt,["touchPan","touchZoom"]),this._add("touchZoom",Nt,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wd(_));const Ot=_.scrollZoom=new fr(_,this);this._add("scrollZoom",Ot,["mousePan"]);const zt=_.keyboard=new im;this._add("keyboard",zt);for(const At of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[At]&&_[At].enable(h[At])}_add(h,_,P){this._handlers.push({handlerName:h,handler:_,allowed:P}),this._handlersById[h]=_}stop(h){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Lc(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,_,P){for(const V in h)if(V!==P&&(!_||_.indexOf(V)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const _=[];for(const P of h)this._el.contains(P.target)&&_.push(P);return _}handleEvent(h,_){this._updatingCamera=!0;const P="renderFrame"===h.type,V=P?void 0:h,W={needsRenderFrame:!1},$={},G={},tt=h.touches?this._getMapTouches(h.touches):void 0,ht=tt?en(this._el,tt):P?void 0:xi(this._el,h);for(const{handlerName:Dt,handler:Bt,allowed:Nt}of this._handlers){if(!Bt.isEnabled())continue;let Ot;this._blockedByActive(G,Nt,Dt)?Bt.reset():Bt[_||h.type]&&(Ot=Bt[_||h.type](h,ht,tt),this.mergeHandlerResult(W,$,Ot,Dt,V),Ot&&Ot.needsRenderFrame&&this._triggerRenderFrame()),(Ot||Bt.isActive())&&(G[Dt]=Bt)}const lt={};for(const Dt in this._previousActiveHandlers)G[Dt]||(lt[Dt]=V);this._previousActiveHandlers=G,(Object.keys(lt).length||Oc(W))&&(this._changes.push([W,$,lt]),this._triggerRenderFrame()),(Object.keys(G).length||Oc(W))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:bt}=W;bt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],bt(this._map))}mergeHandlerResult(h,_,P,V,W){if(!P)return;b.extend(h,P);const $={handlerName:V,originalEvent:P.originalEvent||W};void 0!==P.zoomDelta&&(_.zoom=$),void 0!==P.panDelta&&(_.drag=$),void 0!==P.pitchDelta&&(_.pitch=$),void 0!==P.bearingDelta&&(_.rotate=$)}_applyChanges(){const h={},_={},P={};for(const[V,W,$]of this._changes)V.panDelta&&(h.panDelta=(h.panDelta||new b.pointGeometry(0,0))._add(V.panDelta)),V.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+V.zoomDelta),V.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+V.bearingDelta),V.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+V.pitchDelta),void 0!==V.around&&(h.around=V.around),void 0!==V.aroundCoord&&(h.aroundCoord=V.aroundCoord),void 0!==V.pinchAround&&(h.pinchAround=V.pinchAround),V.noInertia&&(h.noInertia=V.noInertia),b.extend(_,W),b.extend(P,$);this._updateMapTransform(h,_,P),this._changes=[]}_updateMapTransform(h,_,P){const V=this._map,W=V.transform,$=Qt=>[Qt.x,Qt.y,Qt.z];if((Qt=>{const Jt=this._eventsInProgress.drag;return Jt&&!this._handlersById[Jt.handlerName].isActive()})()&&!Oc(h)){const Qt=W.zoom;W.cameraElevationReference="sea",W.recenterOnTerrain(),W.cameraElevationReference="ground",Qt!==W.zoom&&this._map._update(!0)}if(W._isCameraConstrained&&V._stop(!0),!Oc(h))return void this._fireEvents(_,P,!0);let{panDelta:G,zoomDelta:tt,bearingDelta:ht,pitchDelta:lt,around:bt,aroundCoord:Dt,pinchAround:Bt}=h;W._isCameraConstrained&&(tt>0&&(tt=0),W._isCameraConstrained=!1),void 0!==Bt&&(bt=Bt),(tt||(Qt=>_.drag&&!this._eventsInProgress.drag)())&&bt&&(this._dragOrigin=$(W.pointCoordinate3D(bt)),this._trackingEllipsoid.setup(W._camera.position,this._dragOrigin)),W.cameraElevationReference="sea",V._stop(!0),bt=bt||V.transform.centerPoint,ht&&(W.bearing+=ht),lt&&(W.pitch+=lt),W._updateCameraState();const Nt=[0,0,0];if(G)if("mercator"===W.projection.name){const Qt=this._trackingEllipsoid.projectRay(W.screenPointToMercatorRay(bt).dir),Jt=this._trackingEllipsoid.projectRay(W.screenPointToMercatorRay(bt.sub(G)).dir);Nt[0]=Jt[0]-Qt[0],Nt[1]=Jt[1]-Qt[1]}else{const Qt=W.pointCoordinate(bt);if("globe"===W.projection.name){G=G.rotate(-W.angle);const Jt=W._pixelsPerMercatorPixel/W.worldSize;Nt[0]=-G.x*b.mercatorScale(b.latFromMercatorY(Qt.y))*Jt,Nt[1]=-G.y*b.mercatorScale(W.center.lat)*Jt}else{const Jt=W.pointCoordinate(bt.sub(G));Qt&&Jt&&(Nt[0]=Jt.x-Qt.x,Nt[1]=Jt.y-Qt.y)}}const Ot=W.zoom,zt=[0,0,0];if(tt){const Qt=$(Dt||W.pointCoordinate3D(bt)),Jt={dir:b.normalize([],b.sub([],Qt,W._camera.position))};if(Jt.dir[2]<0){const ne=W.zoomDeltaToMovement(Qt,tt);b.scale$2(zt,Jt.dir,ne)}}const At=b.add(Nt,Nt,zt);W._translateCameraConstrained(At),tt&&Math.abs(W.zoom-Ot)>1e-4&&W.recenterOnTerrain(),W.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(_,P,!0)}_fireEvents(h,_,P){const V=Lc(this._eventsInProgress),W=Lc(h),$={};for(const lt in h){const{originalEvent:bt}=h[lt];this._eventsInProgress[lt]||($[`${lt}start`]=bt),this._eventsInProgress[lt]=h[lt]}!V&&W&&this._fireEvent("movestart",W.originalEvent);for(const lt in $)this._fireEvent(lt,$[lt]);W&&this._fireEvent("move",W.originalEvent);for(const lt in h){const{originalEvent:bt}=h[lt];this._fireEvent(lt,bt)}const G={};let tt;for(const lt in this._eventsInProgress){const{handlerName:bt,originalEvent:Dt}=this._eventsInProgress[lt];this._handlersById[bt].isActive()||(delete this._eventsInProgress[lt],tt=_[bt]||Dt,G[`${lt}end`]=tt)}for(const lt in G)this._fireEvent(lt,G[lt]);const ht=Lc(this._eventsInProgress);if(P&&(V||W)&&!ht){this._updatingCamera=!0;const lt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),bt=Dt=>0!==Dt&&-this._bearingSnap<Dt&&Dt<this._bearingSnap;lt?(bt(lt.bearing||this._map.getBearing())&&(lt.bearing=0),this._map.easeTo(lt,{originalEvent:tt})):(this._map.fire(new b.Event("moveend",{originalEvent:tt})),bt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,_){this._map.fire(new b.Event(h,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new Bc("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const gi="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ms extends b.Evented{constructor(h,_){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=_.bearingSnap,b.bindAll(["_renderFrameCallback"],this)}getCenter(){return new b.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,_){return this.jumpTo({center:h},_)}panBy(h,_,P){return h=b.pointGeometry.convert(h).mult(-1),this.panTo(this.transform.center,b.extend({offset:h},_),P)}panTo(h,_,P){return this.easeTo(b.extend({center:h},_),P)}getZoom(){return this.transform.zoom}setZoom(h,_){return this.jumpTo({zoom:h},_),this}zoomTo(h,_,P){return this.easeTo(b.extend({zoom:h},_),P)}zoomIn(h,_){return this.zoomTo(this.getZoom()+1,h,_),this}zoomOut(h,_){return this.zoomTo(this.getZoom()-1,h,_),this}getBearing(){return this.transform.bearing}setBearing(h,_){return this.jumpTo({bearing:h},_),this}getPadding(){return this.transform.padding}setPadding(h,_){return this.jumpTo({padding:h},_),this}rotateTo(h,_,P){return this.easeTo(b.extend({bearing:h},_),P)}resetNorth(h,_){return this.rotateTo(0,b.extend({duration:1e3},h),_),this}resetNorthPitch(h,_){return this.easeTo(b.extend({bearing:0,pitch:0,duration:1e3},h),_),this}snapToNorth(h,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,_):this}getPitch(){return this.transform.pitch}setPitch(h,_){return this.jumpTo({pitch:h},_),this}cameraForBounds(h,_){h=b.LngLatBounds.convert(h);const P=_&&_.bearing||0,V=_&&_.pitch||0,W=h.getNorthWest(),$=h.getSouthEast();return this._cameraForBounds(this.transform,W,$,P,V,_)}_extendCameraOptions(h){const _={top:0,bottom:0,right:0,left:0};if("number"==typeof(h=b.extend({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding){const P=h.padding;h.padding={top:P,bottom:P,right:P,left:P}}return h.padding=b.extend(_,h.padding),h}_minimumAABBFrustumDistance(h,_){const P=_.max[0]-_.min[0],V=_.max[1]-_.min[1];return P/V>h.aspect?P/(2*Math.tan(.5*h.fovX)*h.aspect):V/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,_,P,V,W,$){const G=h.clone(),tt=this._extendCameraOptions($);G.bearing=V,G.pitch=W;const ht=b.LngLat.convert(_),lt=b.LngLat.convert(P),bt=.5*(ht.lat+lt.lat),Dt=.5*(ht.lng+lt.lng),Bt=b.latLngToECEF(bt,Dt),Nt=b.normalize([],Bt),Ot=b.normalize([],b.cross([],Nt,[0,1,0])),zt=b.cross([],Ot,Nt),At=[Ot[0],Ot[1],Ot[2],0,zt[0],zt[1],zt[2],0,Nt[0],Nt[1],Nt[2],0,0,0,0,1],Qt=[Bt,b.latLngToECEF(ht.lat,ht.lng),b.latLngToECEF(lt.lat,ht.lng),b.latLngToECEF(lt.lat,lt.lng),b.latLngToECEF(ht.lat,lt.lng),b.latLngToECEF(bt,ht.lng),b.latLngToECEF(bt,lt.lng),b.latLngToECEF(ht.lat,Dt),b.latLngToECEF(lt.lat,Dt)];let Jt=b.Aabb.fromPoints(Qt.map(ei=>[b.dot(Ot,ei),b.dot(zt,ei),b.dot(Nt,ei)]));const ne=b.transformMat4([],Jt.center,At);0===b.squaredLength(ne)&&b.set(ne,0,0,1),b.normalize(ne,ne),b.scale$2(ne,ne,b.GLOBE_RADIUS),G.center=b.ecefToLatLng(ne);const me=G.getWorldToCameraMatrix(),ue=b.invert(new Float64Array(16),me);Jt=b.Aabb.applyTransform(Jt,b.multiply([],me,At)),b.transformMat4(ne,ne,me);const ge=.5*(Jt.max[2]-Jt.min[2]),be=this._minimumAABBFrustumDistance(G,Jt),Pe=b.scale$2([],[0,0,1],ge),Ie=b.add(Pe,ne,Pe),yi=be+(0===G.pitch?0:b.distance(ne,Ie)),Se=G.globeCenterInViewSpace,Je=b.sub([],ne,[Se[0],Se[1],Se[2]]);b.normalize(Je,Je),b.scale$2(Je,Je,yi);const Ve=b.add([],ne,Je);b.transformMat4(Ve,Ve,ue);const ti=b.earthRadius/b.GLOBE_RADIUS,Fe=b.length(Ve),we=b.mercatorZfromAltitude(Math.max(Fe*ti-b.earthRadius,Number.EPSILON),0),Be=Math.min(G.zoomFromMercatorZAdjusted(we),tt.maxZoom);return Be>.5*(b.GLOBE_ZOOM_THRESHOLD_MIN+b.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"mercator"}),G.zoom=Be,this._cameraForBounds(G,_,P,V,W,$)):{center:G.center,zoom:Be,bearing:V,pitch:W}}queryTerrainElevation(h,_){const P=this.transform.elevation;return P?(_=b.extend({},{exaggerated:!0},_),P.getAtPoint(b.MercatorCoordinate.fromLngLat(h),null,_.exaggerated)):null}_cameraForBounds(h,_,P,V,W,$){if("globe"===h.projection.name)return this._cameraForBoundsOnGlobe(h,_,P,V,W,$);const G=h.clone(),tt=this._extendCameraOptions($),ht=G.padding;G.bearing=V,G.pitch=W;const lt=b.LngLat.convert(_),bt=b.LngLat.convert(P),Dt=new b.LngLat(lt.lng,bt.lat),Bt=new b.LngLat(bt.lng,lt.lat),Nt=G.project(lt),Ot=G.project(bt),zt=this.queryTerrainElevation(lt),At=this.queryTerrainElevation(bt),Qt=this.queryTerrainElevation(Dt),Jt=this.queryTerrainElevation(Bt),ne=[[Nt.x,Nt.y,Math.min(zt||0,At||0,Qt||0,Jt||0)],[Ot.x,Ot.y,Math.max(zt||0,At||0,Qt||0,Jt||0)]];let me=b.Aabb.fromPoints(ne);const ue=G.getWorldToCameraMatrix(),ge=b.invert(new Float64Array(16),ue);me=b.Aabb.applyTransform(me,ue);const be=b.sub([],me.max,me.min),Pe=ht.left||0,Ie=ht.right||0,yi=ht.bottom||0,Se=ht.top||0,{left:Je,right:Ve,top:ti,bottom:Fe}=tt.padding,we=.5*(Pe+Ie),Be=.5*(Se+yi),ei=Math.min(G.scaleZoom(G.scale*Math.min((G.width-(Pe+Ie+Je+Ve))/be[0],(G.height-(yi+Se+Fe+ti))/be[1])),tt.maxZoom),ci=G.scale/G.zoomScale(ei);me=new b.Aabb([me.min[0]-(Je+we)*ci,me.min[1]-(Fe+Be)*ci,me.min[2]],[me.max[0]+(Ve+we)*ci,me.max[1]+(ti+Be)*ci,me.max[2]]);const qi=.5*be[2],Xn=this._minimumAABBFrustumDistance(G,me),Gi=[0,0,1,0];b.transformMat4$1(Gi,Gi,ue),b.normalize$2(Gi,Gi);const Fi=b.scale$2([],Gi,Xn+qi),nn=b.add([],me.center,Fi),Kn=("number"==typeof tt.offset.x&&"number"==typeof tt.offset.y?new b.pointGeometry(tt.offset.x,tt.offset.y):b.pointGeometry.convert(tt.offset)).rotate(-b.degToRad(V));me.center[0]-=Kn.x*ci,me.center[1]+=Kn.y*ci,b.transformMat4(me.center,me.center,ge),b.transformMat4(nn,nn,ge);const sn=[me.center[0],me.center[1],nn[2]*G.pixelsPerMeter];b.scale$2(sn,sn,1/G.worldSize);const fs=b.lngFromMercatorX(sn[0]),vs=b.latFromMercatorY(sn[1]),Ds=Math.min(G._zoomFromMercatorZ(sn[2]),tt.maxZoom),Ns=new b.LngLat(fs,vs);return G.mercatorFromTransition&&Ds<.5*(b.GLOBE_ZOOM_THRESHOLD_MIN+b.GLOBE_ZOOM_THRESHOLD_MAX)?(G.setProjection({name:"globe"}),G.zoom=Ds,this._cameraForBounds(G,_,P,V,W,$)):{center:Ns,zoom:Ds,bearing:V,pitch:W}}fitBounds(h,_,P){const V=this.cameraForBounds(h,_);return this._fitInternal(V,_,P)}fitScreenCoordinates(h,_,P,V,W){const $=b.pointGeometry.convert(h),G=b.pointGeometry.convert(_),tt=new b.pointGeometry(Math.min($.x,G.x),Math.min($.y,G.y)),ht=new b.pointGeometry(Math.max($.x,G.x),Math.max($.y,G.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge($,G))return this;const lt=this.transform.pointLocation3D(tt),bt=this.transform.pointLocation3D(ht),Dt=this.transform.pointLocation3D(new b.pointGeometry(tt.x,ht.y)),Bt=this.transform.pointLocation3D(new b.pointGeometry(ht.x,tt.y)),Nt=[Math.min(lt.lng,bt.lng,Dt.lng,Bt.lng),Math.min(lt.lat,bt.lat,Dt.lat,Bt.lat)],Ot=[Math.max(lt.lng,bt.lng,Dt.lng,Bt.lng),Math.max(lt.lat,bt.lat,Dt.lat,Bt.lat)],zt=V&&V.pitch?V.pitch:this.getPitch(),At=this._cameraForBounds(this.transform,Nt,Ot,P,zt,V);return this._fitInternal(At,V,W)}_fitInternal(h,_,P){return h?(delete(_=b.extend(h,_)).padding,_.linear?this.easeTo(_,P):this.flyTo(_,P)):this}jumpTo(h,_){this.stop();const P=h.preloadOnly?this.transform.clone():this.transform;let V=!1,W=!1,$=!1;return"zoom"in h&&P.zoom!==+h.zoom&&(V=!0,P.zoom=+h.zoom),void 0!==h.center&&(P.center=b.LngLat.convert(h.center)),"bearing"in h&&P.bearing!==+h.bearing&&(W=!0,P.bearing=+h.bearing),"pitch"in h&&P.pitch!==+h.pitch&&($=!0,P.pitch=+h.pitch),null==h.padding||P.isPaddingEqual(h.padding)||(P.padding=h.padding),h.preloadOnly?(this._preloadTiles(P),this):(this.fire(new b.Event("movestart",_)).fire(new b.Event("move",_)),V&&this.fire(new b.Event("zoomstart",_)).fire(new b.Event("zoom",_)).fire(new b.Event("zoomend",_)),W&&this.fire(new b.Event("rotatestart",_)).fire(new b.Event("rotate",_)).fire(new b.Event("rotateend",_)),$&&this.fire(new b.Event("pitchstart",_)).fire(new b.Event("pitch",_)).fire(new b.Event("pitchend",_)),this.fire(new b.Event("moveend",_)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||b.warnOnce(gi),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,_){const P=this.transform;if(!P.projection.supportsFreeCamera)return b.warnOnce(gi),this;this.stop();const V=P.zoom,W=P.pitch,$=P.bearing;P.setFreeCameraOptions(h);const G=V!==P.zoom,tt=W!==P.pitch,ht=$!==P.bearing;return this.fire(new b.Event("movestart",_)).fire(new b.Event("move",_)),G&&this.fire(new b.Event("zoomstart",_)).fire(new b.Event("zoom",_)).fire(new b.Event("zoomend",_)),ht&&this.fire(new b.Event("rotatestart",_)).fire(new b.Event("rotate",_)).fire(new b.Event("rotateend",_)),tt&&this.fire(new b.Event("pitchstart",_)).fire(new b.Event("pitch",_)).fire(new b.Event("pitchend",_)),this.fire(new b.Event("moveend",_)),this}easeTo(h,_){this._stop(!1,h.easeId),(!1===(h=b.extend({offset:[0,0],duration:500,easing:b.ease},h)).animate||!h.essential&&b.exported.prefersReducedMotion)&&(h.duration=0);const P=this.transform,V=this.getZoom(),W=this.getBearing(),$=this.getPitch(),G=this.getPadding(),tt="zoom"in h?+h.zoom:V,ht="bearing"in h?this._normalizeBearing(h.bearing,W):W,lt="pitch"in h?+h.pitch:$,bt="padding"in h?h.padding:P.padding,Dt=b.pointGeometry.convert(h.offset);let Bt,Nt,Ot;if("globe"===P.projection.name){const Pe=b.MercatorCoordinate.fromLngLat(P.center),Ie=Dt.rotate(-P.angle);Pe.x+=Ie.x/P.worldSize,Pe.y+=Ie.y/P.worldSize;const yi=Pe.toLngLat(),Se=b.LngLat.convert(h.center||yi);this._normalizeCenter(Se),Bt=P.centerPoint.add(Ie),Nt=new b.pointGeometry(Pe.x,Pe.y).mult(P.worldSize),Ot=new b.pointGeometry(b.mercatorXfromLng(Se.lng),b.mercatorYfromLat(Se.lat)).mult(P.worldSize).sub(Nt)}else{Bt=P.centerPoint.add(Dt);const Pe=P.pointLocation(Bt),Ie=b.LngLat.convert(h.center||Pe);this._normalizeCenter(Ie),Nt=P.project(Pe),Ot=P.project(Ie).sub(Nt)}const zt=P.zoomScale(tt-V);let At,Qt;h.around&&(At=b.LngLat.convert(h.around),Qt=P.locationPoint(At));const Jt=this._zooming||tt!==V,ne=this._rotating||W!==ht,me=this._pitching||lt!==$,ue=!P.isPaddingEqual(bt),ge=Pe=>Ie=>{if(Jt&&(Pe.zoom=b.number(V,tt,Ie)),ne&&(Pe.bearing=b.number(W,ht,Ie)),me&&(Pe.pitch=b.number($,lt,Ie)),ue&&(Pe.interpolatePadding(G,bt,Ie),Bt=Pe.centerPoint.add(Dt)),At)Pe.setLocationAtPoint(At,Qt);else{const yi=Pe.zoomScale(Pe.zoom-V),Se=tt>V?Math.min(2,zt):Math.max(.5,zt),Je=Math.pow(Se,1-Ie),Ve=Pe.unproject(Nt.add(Ot.mult(Ie*Je)).mult(yi));Pe.setLocationAtPoint(Pe.renderWorldCopies?Ve.wrap():Ve,Bt)}return h.preloadOnly||this._fireMoveEvents(_),Pe};if(h.preloadOnly){const Pe=this._emulate(ge,h.duration,P);return this._preloadTiles(Pe),this}const be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Jt,this._rotating=ne,this._pitching=me,this._padding=ue,this._easeId=h.easeId,this._prepareEase(_,h.noMoveStart,be),this._ease(ge(P),Pe=>{P.recenterOnTerrain(),this._afterEase(_,Pe)},h),this}_prepareEase(h,_,P={}){this._moving=!0,this.transform.cameraElevationReference="sea",_||P.moving||this.fire(new b.Event("movestart",h)),this._zooming&&!P.zooming&&this.fire(new b.Event("zoomstart",h)),this._rotating&&!P.rotating&&this.fire(new b.Event("rotatestart",h)),this._pitching&&!P.pitching&&this.fire(new b.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new b.Event("move",h)),this._zooming&&this.fire(new b.Event("zoom",h)),this._rotating&&this.fire(new b.Event("rotate",h)),this._pitching&&this.fire(new b.Event("pitch",h))}_afterEase(h,_){if(this._easeId&&_&&this._easeId===_)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const P=this._zooming,V=this._rotating,W=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,P&&this.fire(new b.Event("zoomend",h)),V&&this.fire(new b.Event("rotateend",h)),W&&this.fire(new b.Event("pitchend",h)),this.fire(new b.Event("moveend",h))}flyTo(h,_){if(!h.essential&&b.exported.prefersReducedMotion){const ei=b.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ei,_)}this.stop(),h=b.extend({offset:[0,0],speed:1.2,curve:1.42,easing:b.ease},h);const P=this.transform,V=this.getZoom(),W=this.getBearing(),$=this.getPitch(),G=this.getPadding(),tt="zoom"in h?b.clamp(+h.zoom,P.minZoom,P.maxZoom):V,ht="bearing"in h?this._normalizeBearing(h.bearing,W):W,lt="pitch"in h?+h.pitch:$,bt="padding"in h?h.padding:P.padding,Dt=P.zoomScale(tt-V),Bt=b.pointGeometry.convert(h.offset);let Nt=P.centerPoint.add(Bt);const Ot=P.pointLocation(Nt),zt=b.LngLat.convert(h.center||Ot);this._normalizeCenter(zt);const At=P.project(Ot),Qt=P.project(zt).sub(At);let Jt=h.curve;const ne=Math.max(P.width,P.height),me=ne/Dt,ue=Qt.mag();if("minZoom"in h){const ei=b.clamp(Math.min(h.minZoom,V,tt),P.minZoom,P.maxZoom),ci=ne/P.zoomScale(ei-V);Jt=Math.sqrt(ci/ue*2)}const ge=Jt*Jt;function be(ei){const ci=(me*me-ne*ne+(ei?-1:1)*ge*ge*ue*ue)/(2*(ei?me:ne)*ge*ue);return Math.log(Math.sqrt(ci*ci+1)-ci)}function Pe(ei){return(Math.exp(ei)-Math.exp(-ei))/2}function Ie(ei){return(Math.exp(ei)+Math.exp(-ei))/2}const yi=be(0);let Se=function(ei){return Ie(yi)/Ie(yi+Jt*ei)},Je=function(ei){return ne*((Ie(yi)*(Pe(ci=yi+Jt*ei)/Ie(ci))-Pe(yi))/ge)/ue;var ci},Ve=(be(1)-yi)/Jt;if(Math.abs(ue)<1e-6||!isFinite(Ve)){if(Math.abs(ne-me)<1e-6)return this.easeTo(h,_);const ei=me<ne?-1:1;Ve=Math.abs(Math.log(me/ne))/Jt,Je=function(){return 0},Se=function(ci){return Math.exp(ei*Jt*ci)}}h.duration="duration"in h?+h.duration:1e3*Ve/("screenSpeed"in h?+h.screenSpeed/Jt:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const ti=W!==ht,Fe=lt!==$,we=!P.isPaddingEqual(bt),Be=ei=>ci=>{const qi=ci*Ve,Xn=1/Se(qi);ei.zoom=1===ci?tt:V+ei.scaleZoom(Xn),ti&&(ei.bearing=b.number(W,ht,ci)),Fe&&(ei.pitch=b.number($,lt,ci)),we&&(ei.interpolatePadding(G,bt,ci),Nt=ei.centerPoint.add(Bt));const Gi=1===ci?zt:ei.unproject(At.add(Qt.mult(Je(qi))).mult(Xn));return ei.setLocationAtPoint(ei.renderWorldCopies?Gi.wrap():Gi,Nt),ei._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(_),ei};if(h.preloadOnly){const ei=this._emulate(Be,h.duration,P);return this._preloadTiles(ei),this}return this._zooming=!0,this._rotating=ti,this._pitching=Fe,this._padding=we,this._prepareEase(_,!1),this._ease(Be(P),()=>this._afterEase(_),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const P=this._onEaseEnd;this._onEaseEnd=void 0,P.call(this,_)}if(!h){const P=this.handlers;P&&P.stop(!1)}return this}_ease(h,_,P){!1===P.animate||0===P.duration?(h(1),_()):(this._easeStart=b.exported.now(),this._easeOptions=P,this._onEaseFrame=h,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((b.exported.now()-this._easeStart)/this._easeOptions.duration,1),_=this._onEaseFrame;_&&_(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,_){h=b.wrap(h,-180,180);const P=Math.abs(h-_);return Math.abs(h-360-_)<P&&(h-=360),Math.abs(h+360-_)<P&&(h+=360),h}_normalizeCenter(h){const _=this.transform;if(!_.renderWorldCopies||_.maxBounds)return;const P=h.lng-_.center.lng;h.lng+=P>180?-360:P<-180?360:0}_emulate(h,_,P){const V=Math.ceil(15*_/1e3),W=[],$=h(P.clone());for(let G=0;G<=V;G++){const tt=$(G/V);W.push(tt.clone())}return W}}class ih{constructor(h={}){this.options=h,b.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const _=this.options&&this.options.compact;return this._map=h,this._container=bi("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=bi("button","mapboxgl-ctrl-attrib-button",this._container),bi("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=bi("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),_&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===_&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,_){const P=this._map._getUIString(`AttributionControl.${_}`);h.setAttribute("aria-label",P),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",P)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const _=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||b.config.ACCESS_TOKEN}];if(h){const P=_.reduce((V,W,$)=>(W.value&&(V+=`${W.key}=${W.value}${$<_.length-1?"&":""}`),V),"?");h.href=`${b.config.FEEDBACK_URL}/${P}#${Jp(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||"metadata"!==h.sourceDataType&&"visibility"!==h.sourceDataType&&"style"!==h.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const V=this._map.style.stylesheet;this.styleOwner=V.owner,this.styleId=V.id}const _=this._map.style._sourceCaches;for(const V in _){const W=_[V];if(W.used){const $=W.getSource();$.attribution&&h.indexOf($.attribution)<0&&h.push($.attribution)}}h.sort((V,W)=>V.length-W.length),h=h.filter((V,W)=>{for(let $=W+1;$<h.length;$++)if(h[$].indexOf(V)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const P=h.join(" | ");P!==this._attribHTML&&(this._attribHTML=P,h.length?(this._innerContainer.innerHTML=P,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class nh{constructor(){b.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=bi("div","mapboxgl-ctrl");const _=bi("a","mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://www.mapbox.com/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&"metadata"!==h.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(0===Object.entries(h).length)return!0;for(const _ in h){const P=h[_].getSource();if(P.hasOwnProperty("mapbox_logo")&&!P.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const _=h[0];this._map.getCanvasContainer().offsetWidth<250?_.classList.add("mapboxgl-compact"):_.classList.remove("mapboxgl-compact")}}}class Do{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const _=++this._id;return this._queue.push({callback:h,id:_,cancelled:!1}),_}remove(h){const _=this._currentlyRunning,P=_?this._queue.concat(_):this._queue;for(const V of P)if(V.id===h)return void(V.cancelled=!0)}run(h=0){const _=this._currentlyRunning=this._queue;this._queue=[];for(const P of _)if(!P.cancelled&&(P.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Rc(S,h,_){if(S=new b.LngLat(S.lng,S.lat),h){const P=new b.LngLat(S.lng-360,S.lat),V=new b.LngLat(S.lng+360,S.lat),W=360*Math.ceil(Math.abs(S.lng-_.center.lng)/360),$=_.locationPoint(S).distSqr(h),G=h.x<0||h.y<0||h.x>_.width||h.y>_.height;_.locationPoint(P).distSqr(h)<$&&(G||Math.abs(P.lng-_.center.lng)<W)?S=P:_.locationPoint(V).distSqr(h)<$&&(G||Math.abs(V.lng-_.center.lng)<W)&&(S=V)}for(;Math.abs(S.lng-_.center.lng)>180;){const P=_.locationPoint(S);if(P.x>=0&&P.y>=0&&P.x<=_.width&&P.y<=_.height)break;S.lng>_.center.lng?S.lng-=360:S.lng+=360}return S}const Ra={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Zr extends b.Evented{constructor(h,_){if(super(),(h instanceof b.window.HTMLElement||_)&&(h=b.extend({element:h},_)),b.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=b.pointGeometry.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=bi("div");const V=41,W=27,$=an("svg",{display:"block",height:V*this._scale+"px",width:W*this._scale+"px",viewBox:`0 0 ${W} ${V}`},this._element),G=an("radialGradient",{id:"shadowGradient"},an("defs",{},$));an("stop",{offset:"10%","stop-opacity":.4},G),an("stop",{offset:"100%","stop-opacity":.05},G),an("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},$),an("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},$),an("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},$),an("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},$),this._offset=b.pointGeometry.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",V=>{V.preventDefault()}),this._element.addEventListener("mousedown",V=>{V.preventDefault()});const P=this._element.classList;for(const V in Ra)P.remove(`mapboxgl-marker-anchor-${V}`);P.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=b.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const V=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[V,-1*(24.6+V)],"bottom-right":[-V,-1*(24.6+V)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const _=h.code,P=h.charCode||h.keyCode;"Space"!==_&&"Enter"!==_&&32!==P&&13!==P||this.togglePopup()}_onMapClick(h){const _=h.originalEvent.target,P=this._element;this._popup&&(_===P||P.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,_=this._pos;if(!h||!_)return!1;const P=h.unproject(_),V=h.getFreeCameraOptions();if(!V.position)return!1;const W=V.position.toLngLat();return W.distanceTo(P)<.9*W.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const _=this._pos;if(!_||_.x<0||_.x>h.transform.width||_.y<0||_.y>h.transform.height)return void this._clearFadeTimer();const P=h.unproject(_);let V;h._showingGlobe()&&b.isLngLatBehindGlobe(h.transform,this._lngLat)?V=0:(V=1-h._queryFogOpacity(P),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(V*=this._occludedOpacity)),this._element.style.opacity=`${V}`,this._element.style.pointerEvents=V>0?"auto":"none",this._popup&&this._popup._setOpacity(V),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const _=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${h.x}px,${h.y}px)\n            ${Ra[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${_.x}px,${_.y}px)\n        `}_calculateXYTransform(){const h=this._pos,_=this._map,P=this.getPitchAlignment();if(!_||!h||"map"!==P)return"";if(!_._showingGlobe()){const tt=_.getPitch();return tt?`rotateX(${tt}deg)`:""}const V=b.radToDeg(b.globeTiltAtLngLat(_.transform,this._lngLat)),W=h.sub(b.globeCenterToScreenPoint(_.transform)),$=Math.abs(W.x)+Math.abs(W.y);if(0===$)return"";const G=V/$;return`rotateX(${-W.y*G}deg) rotateY(${W.x*G}deg)`}_calculateZTransform(){const h=this._pos,_=this._map;if(!_||!h)return"";let P=0;const V=this.getRotationAlignment();if("map"===V)if(_._showingGlobe()){const W=_.project(new b.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),$=_.project(new b.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(W);P=b.radToDeg(Math.atan2($.y,$.x))-90}else P=-_.getBearing();else if("horizon"===V){const W=b.smoothstep(4,6,_.getZoom()),$=b.globeCenterToScreenPoint(_.transform);$.y+=W*_.transform.height;const G=h.sub($),tt=b.radToDeg(Math.atan2(G.y,G.x));P=(tt>90?tt-270:tt+90)*(1-W)}return P+=this._rotation,P?`rotateZ(${P}deg)`:""}_update(h){b.window.cancelAnimationFrame(this._updateFrameId);const _=this._map;_&&(_.transform.renderWorldCopies&&(this._lngLat=Rc(this._lngLat,this._pos,_.transform)),this._pos=_.project(this._lngLat),!0===h?this._updateFrameId=b.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),_._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(_._showingGlobe()||_.getTerrain()||_.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=b.pointGeometry.convert(h),this._update(),this}_onMove(h){const _=this._map;if(!_)return;const P=this._pointerdownPos,V=this._positionDelta;if(P&&V){if(!this._isDragging){const W=this._clickTolerance||_._clickTolerance;if(h.point.dist(P)<W)return;this._isDragging=!0}this._pos=h.point.sub(V),this._lngLat=_.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new b.Event("dragstart"))),this.fire(new b.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new b.Event("dragend")),this._state="inactive"}_addDragHandler(h){const _=this._map,P=this._pos;_&&P&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(P),this._pointerdownPos=h.point,this._state="pending",_.on("mousemove",this._onMove),_.on("touchmove",this._onMove),_.once("mouseup",this._onUp),_.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const _=this._map;return _&&(h?(_.on("mousedown",this._addDragHandler),_.on("touchstart",this._addDragHandler)):(_.off("mousedown",this._addDragHandler),_.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const kd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ad=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Vu(S=new b.pointGeometry(0,0),h="bottom"){if("number"==typeof S){const _=Math.round(Math.sqrt(.5*Math.pow(S,2)));switch(h){case"top":return new b.pointGeometry(0,S);case"top-left":return new b.pointGeometry(_,_);case"top-right":return new b.pointGeometry(-_,_);case"bottom":return new b.pointGeometry(0,-S);case"bottom-left":return new b.pointGeometry(_,-_);case"bottom-right":return new b.pointGeometry(-_,-_);case"left":return new b.pointGeometry(S,0);case"right":return new b.pointGeometry(-S,0)}return new b.pointGeometry(0,0)}return S instanceof b.pointGeometry||Array.isArray(S)?b.pointGeometry.convert(S):b.pointGeometry.convert(S[h]||[0,0])}class Hf{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const _=b.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-_)+this._end*_}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,_,P){this._start=this.getValue(_),this._end=h,this._startTime=_,this._endTime=_+P}}const zu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},gr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ba={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nu{constructor(h,_,P=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new Ou({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,P&&(this.mousePitch=new Rr({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),b.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),_.addEventListener("mousedown",this.mousedown),_.addEventListener("touchstart",this.touchstart,{passive:!1}),_.addEventListener("touchmove",this.touchmove),_.addEventListener("touchend",this.touchend),_.addEventListener("touchcancel",this.reset)}down(h,_){this.mouseRotate.mousedown(h,_),this.mousePitch&&this.mousePitch.mousedown(h,_),Yo()}move(h,_){const P=this.map,V=this.mouseRotate.mousemoveWindow(h,_),W=V&&V.bearingDelta;if(W&&P.setBearing(P.getBearing()+W),this.mousePitch){const $=this.mousePitch.mousemoveWindow(h,_),G=$&&$.pitchDelta;G&&P.setPitch(P.getPitch()+G)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){tn(),b.window.removeEventListener("mousemove",this.mousemove),b.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(b.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),xi(this.element,h)),b.window.addEventListener("mousemove",this.mousemove),b.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,xi(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){1!==h.targetTouches.length?this.reset():(this._startPos=this._lastPos=en(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){1!==h.targetTouches.length?this.reset():(this._lastPos=en(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){0===h.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const sh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Va={maxWidth:100,unit:"metric"};function rm(S,h,_){const P=Vc(h),V=P/h,W={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[_];this._map._requestDomTask(()=>{this._container.style.width=S*V+"px",this._container.innerHTML=`${P}&nbsp;${W}`})}function Vc(S){const h=Math.pow(10,`${Math.floor(S)}`.length-1);let _=S/h;return _=_>=10?10:_>=5?5:_>=3?3:_>=2?2:_>=1?1:function(P){const V=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*V)/V}(_),h*_}const zc={version:b.version,supported:ho,setRTLTextPlugin:b.setRTLTextPlugin,getRTLTextPluginStatus:b.getRTLTextPluginStatus,Map:class extends ms{constructor(S){if(b.LivePerformanceUtils.mark(b.PerformanceMarkers.create),null!=(S=b.extend({},gr,S)).minZoom&&null!=S.maxZoom&&S.minZoom>S.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=S.minPitch&&null!=S.maxPitch&&S.minPitch>S.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=S.minPitch&&S.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=S.maxPitch&&S.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(S.antialias&&b.isSafariWithAntialiasingBug(b.window)&&(S.antialias=!1,b.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Oi(S.minZoom,S.maxZoom,S.minPitch,S.maxPitch,S.renderWorldCopies),S),this._interactive=S.interactive,this._minTileCacheSize=S.minTileCacheSize,this._maxTileCacheSize=S.maxTileCacheSize,this._failIfMajorPerformanceCaveat=S.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=S.preserveDrawingBuffer,this._antialias=S.antialias,this._useWebGL2=S.useWebGL2,this._trackResize=S.trackResize,this._bearingSnap=S.bearingSnap,this._refreshExpiredTiles=S.refreshExpiredTiles,this._fadeDuration=S.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=S.crossSourceCollisions,this._collectResourceTiming=S.collectResourceTiming,this._optimizeForTerrain=S.optimizeForTerrain,this._language=this._parseLanguage(S.language),this._worldview=S.worldview,this._renderTaskQueue=new Do,this._domRenderTaskQueue=new Do,this._controls=[],this._markers=[],this._popups=[],this._mapId=b.uniqueId(),this._locale=b.extend({},zu,S.locale),this._clickTolerance=S.clickTolerance,this._cooperativeGestures=S.cooperativeGestures,this._performanceMetricsCollection=S.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Hf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new b.RequestManager(S.transformRequest,S.accessToken,S.testMode),this._silenceAuthErrors=!!S.testMode,"string"==typeof S.container){if(this._container=b.window.document.getElementById(S.container),!this._container)throw new Error(`Container '${S.container}' not found.`)}else{if(!(S.container instanceof b.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=S.container}if(this._container.childNodes.length>0&&b.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),S.maxBounds&&this.setMaxBounds(S.maxBounds),b.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==b.window&&(b.window.addEventListener("online",this._onWindowOnline,!1),b.window.addEventListener("resize",this._onWindowResize,!1),b.window.addEventListener("orientationchange",this._onWindowResize,!1),b.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),b.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new om(this,S),this._localFontFamily=S.localFontFamily,this._localIdeographFontFamily=S.localIdeographFontFamily,S.style&&this.setStyle(S.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),S.projection&&this.setProjection(S.projection),this._hash=S.hash&&new Uf("string"==typeof S.hash&&S.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}),S.bounds&&(this.resize(),this.fitBounds(S.bounds,b.extend({},S.fitBoundsOptions,{duration:0})))),this.resize(),S.attributionControl&&this.addControl(new ih({customAttribution:S.customAttribution})),this._logoControl=new nh,this.addControl(this._logoControl,S.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update("style"===h.dataType),this.fire(new b.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new b.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(S,h){if(void 0===h&&(h=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new b.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=S.onAdd(this);this._controls.push(S);const P=this._controlPositions[h];return-1!==h.indexOf("bottom")?P.insertBefore(_,P.firstChild):P.appendChild(_),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new b.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(S);return h>-1&&this._controls.splice(h,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(S){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new b.Event("movestart",S)).fire(new b.Event("move",S)),this.fire(new b.Event("resize",S)),h&&this.fire(new b.Event("moveend",S)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(S){return this.transform.setMaxBounds(b.LngLatBounds.convert(S)),this._update()}setMinZoom(S){if((S=S??-2)>=-2&&S<=this.transform.maxZoom)return this.transform.minZoom=S,this._update(),this.getZoom()<S?this.setZoom(S):this.fire(new b.Event("zoomstart")).fire(new b.Event("zoom")).fire(new b.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S??22)>=this.transform.minZoom)return this.transform.maxZoom=S,this._update(),this.getZoom()>S?this.setZoom(S):this.fire(new b.Event("zoomstart")).fire(new b.Event("zoom")).fire(new b.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.minPitch=S,this._update(),this.getPitch()<S?this.setPitch(S):this.fire(new b.Event("pitchstart")).fire(new b.Event("pitch")).fire(new b.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(S>=this.transform.minPitch)return this.transform.maxPitch=S,this._update(),this.getPitch()>S?this.setPitch(S):this.fire(new b.Event("pitchstart")).fire(new b.Event("pitch")).fire(new b.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.renderWorldCopies=S,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(S){return"auto"===S?b.window.navigator.language:Array.isArray(S)?0===S.length?void 0:S.map(h=>"auto"===h?b.window.navigator.language:h):S}setLanguage(S){const h=this._parseLanguage(S);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const _ of this._controls)_._setLanguage&&_._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(S){return this.style&&S!==this._worldview?(this._worldview=S,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(S){return this._lazyInitEmptyStyle(),S?"string"==typeof S&&(S={name:S}):S=null,this._useExplicitProjection=!!S,this._prioritizeAndUpdateProjection(S,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const S=this.transform,h=S.projection.name;let _;"globe"===h&&S.zoom>=b.GLOBE_ZOOM_THRESHOLD_MAX?(S.setMercatorFromTransition(),_=!0):"mercator"===h&&S.zoom<b.GLOBE_ZOOM_THRESHOLD_MAX&&(S.setProjection({name:"globe"}),_=!0),_&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(S,h){return this._updateProjection(S||h||{name:"mercator"})}_updateProjection(S){let h;if(h="globe"===S.name&&this.transform.zoom>=b.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(S),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const _ in this.style._sourceCaches)this.style._sourceCaches[_].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(S){return this.transform.locationPoint3D(b.LngLat.convert(S))}unproject(S){return this.transform.pointLocation3D(b.pointGeometry.convert(S))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(S,h,_){if("mouseenter"===S||"mouseover"===S){let P=!1;const V=$=>{const G=h.filter(ht=>this.getLayer(ht)),tt=G.length?this.queryRenderedFeatures($.point,{layers:G}):[];tt.length?P||(P=!0,_.call(this,new tr(S,this,$.originalEvent,{features:tt}))):P=!1},W=()=>{P=!1};return{layers:new Set(h),listener:_,delegates:{mousemove:V,mouseout:W}}}if("mouseleave"===S||"mouseout"===S){let P=!1;const V=$=>{const G=h.filter(tt=>this.getLayer(tt));(G.length?this.queryRenderedFeatures($.point,{layers:G}):[]).length?P=!0:P&&(P=!1,_.call(this,new tr(S,this,$.originalEvent)))},W=$=>{P&&(P=!1,_.call(this,new tr(S,this,$.originalEvent)))};return{layers:new Set(h),listener:_,delegates:{mousemove:V,mouseout:W}}}{const P=V=>{const W=h.filter(G=>this.getLayer(G)),$=W.length?this.queryRenderedFeatures(V.point,{layers:W}):[];$.length&&(V.features=$,_.call(this,V),delete V.features)};return{layers:new Set(h),listener:_,delegates:{[S]:P}}}}on(S,h,_){if(void 0===_)return super.on(S,h);Array.isArray(h)||(h=[h]);const P=this._createDelegatedListener(S,h,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(P);for(const V in P.delegates)this.on(V,P.delegates[V]);return this}once(S,h,_){if(void 0===_)return super.once(S,h);Array.isArray(h)||(h=[h]);const P=this._createDelegatedListener(S,h,_);for(const V in P.delegates)this.once(V,P.delegates[V]);return this}off(S,h,_){if(void 0===_)return super.off(S,h);h=new Set(Array.isArray(h)?h:[h]);const P=(W,$)=>{if(W.size!==$.size)return!1;for(const G of W)if(!$.has(G))return!1;return!0},V=this._delegatedListeners?this._delegatedListeners[S]:void 0;return V&&(W=>{for(let $=0;$<W.length;$++){const G=W[$];if(G.listener===_&&P(G.layers,h)){for(const tt in G.delegates)this.off(tt,G.delegates[tt]);return W.splice($,1),this}}})(V),this}queryRenderedFeatures(S,h){return this.style?(void 0!==h||void 0===S||S instanceof b.pointGeometry||Array.isArray(S)||(h=S,S=void 0),this.style.queryRenderedFeatures(S=S||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(S,h){return this.style.querySourceFeatures(S,h)}setStyle(S,h){return!1!==(h=b.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&S?(this._diffStyle(S,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(S,h))}_getUIString(S){const h=this._locale[S];if(null==h)throw new Error(`Missing UI string '${S}'`);return h}_updateStyle(S,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),S&&(this.style=new Tn(this,h||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof S?this.style.loadURL(S):this.style.loadJSON(S)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Tn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,h){if("string"==typeof S){const _=this._requestManager.normalizeStyleURL(S),P=this._requestManager.transformRequest(_,b.ResourceType.Style);b.getJSON(P,(V,W)=>{V?this.fire(new b.ErrorEvent(V)):W&&this._updateDiff(W,h)})}else"object"==typeof S&&this._updateDiff(S,h)}_updateDiff(S,h){try{this.style.setState(S)&&this._update(!0)}catch(_){b.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(S,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(b.warnOnce("There is no style added to the map."),!1)}addSource(S,h){return this._lazyInitEmptyStyle(),this.style.addSource(S,h),this._update(!0)}isSourceLoaded(S){return!!this.style&&this.style._isSourceCacheLoaded(S)}areTilesLoaded(){const S=this.style&&this.style._sourceCaches;for(const h in S){const _=S[h]._tiles;for(const P in _){const V=_[P];if("loaded"!==V.state&&"errored"!==V.state)return!1}}return!0}addSourceType(S,h,_){this._lazyInitEmptyStyle(),this.style.addSourceType(S,h,_)}removeSource(S){return this.style.removeSource(S),this._updateTerrain(),this._update(!0)}getSource(S){return this.style.getSource(S)}addImage(S,h,{pixelRatio:_=1,sdf:P=!1,stretchX:V,stretchY:W,content:$}={}){if(this._lazyInitEmptyStyle(),h instanceof b.window.HTMLImageElement||b.window.ImageBitmap&&h instanceof b.window.ImageBitmap){const{width:G,height:tt,data:ht}=b.exported.getImageData(h);this.style.addImage(S,{data:new b.RGBAImage({width:G,height:tt},ht),pixelRatio:_,stretchX:V,stretchY:W,content:$,sdf:P,version:0})}else if(void 0===h.width||void 0===h.height)this.fire(new b.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:G,height:tt}=h,ht=h;this.style.addImage(S,{data:new b.RGBAImage({width:G,height:tt},new Uint8Array(ht.data)),pixelRatio:_,stretchX:V,stretchY:W,content:$,sdf:P,version:0,userImage:ht}),ht.onAdd&&ht.onAdd(this,S)}}updateImage(S,h){const _=this.style.getImage(S);if(!_)return void this.fire(new b.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const P=h instanceof b.window.HTMLImageElement||b.window.ImageBitmap&&h instanceof b.window.ImageBitmap?b.exported.getImageData(h):h,{width:V,height:W}=P;void 0!==V&&void 0!==W?V===_.data.width&&W===_.data.height?(_.data.replace(P.data,!(h instanceof b.window.HTMLImageElement||b.window.ImageBitmap&&h instanceof b.window.ImageBitmap)),this.style.updateImage(S,_)):this.fire(new b.ErrorEvent(new Error(`The width and height of the updated image (${V}, ${W})\n                must be that same as the previous version of the image\n                (${_.data.width}, ${_.data.height})`))):this.fire(new b.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new b.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S,h){b.getImage(this._requestManager.transformRequest(S,b.ResourceType.Image),(_,P)=>{h(_,P instanceof b.window.HTMLImageElement?b.exported.getImageData(P):P)})}listImages(){return this.style.listImages()}addLayer(S,h){return this._lazyInitEmptyStyle(),this.style.addLayer(S,h),this._update(!0)}moveLayer(S,h){return this.style.moveLayer(S,h),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}setLayerZoomRange(S,h,_){return this.style.setLayerZoomRange(S,h,_),this._update(!0)}setFilter(S,h,_={}){return this.style.setFilter(S,h,_),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,h,_,P={}){return this.style.setPaintProperty(S,h,_,P),this._update(!0)}getPaintProperty(S,h){return this.style.getPaintProperty(S,h)}setLayoutProperty(S,h,_,P={}){return this.style.setLayoutProperty(S,h,_,P),this._update(!0)}getLayoutProperty(S,h){return this.style.getLayoutProperty(S,h)}setLight(S,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(S,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(S){return this._lazyInitEmptyStyle(),!S&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(S),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(S){return this._lazyInitEmptyStyle(),this.style.setFog(S),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(S){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(b.LngLat.convert(S),this.transform):0}setFeatureState(S,h){return this.style.setFeatureState(S,h),this._update()}removeFeatureState(S,h){return this.style.removeFeatureState(S,h),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}_updateContainerDimensions(){if(!this._container)return;const S=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let _,P,V,W=this._container;for(;W&&(!P||!V);){const $=b.window.getComputedStyle(W).transform;$&&"none"!==$&&(_=$.match(/matrix.*\((.+)\)/)[1].split(", "),_[0]&&"0"!==_[0]&&"1"!==_[0]&&(P=_[0]),_[3]&&"0"!==_[3]&&"1"!==_[3]&&(V=_[3])),W=W.parentElement}this._containerWidth=P?Math.abs(S/P):S,this._containerHeight=V?Math.abs(h/V):h}_detectMissingCSS(){"rgb(250, 128, 114)"!==b.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&b.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const S=this._container;S.classList.add("mapboxgl-map"),(this._missingCSSCanary=bi("div","mapboxgl-canary",S)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=bi("div","mapboxgl-canvas-container",S);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=bi("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const _=this._controlContainer=bi("div","mapboxgl-control-container",S),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(V=>{P[V]=bi("div",`mapboxgl-ctrl-${V}`,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(S,h){const _=b.exported.devicePixelRatio||1;this._canvas.width=_*Math.ceil(S),this._canvas.height=_*Math.ceil(h),this._canvas.style.width=`${S}px`,this._canvas.style.height=`${h}px`}_addMarker(S){this._markers.push(S)}_removeMarker(S){const h=this._markers.indexOf(S);-1!==h&&this._markers.splice(h,1)}_addPopup(S){this._popups.push(S)}_removePopup(S){const h=this._popups.indexOf(S);-1!==h&&this._popups.splice(h,1)}_setupPainter(){const S=b.extend({},ho.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",S),_=h||this._canvas.getContext("webgl",S)||this._canvas.getContext("experimental-webgl",S);_?(this._useWebGL2&&!h&&b.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),b.storeAuthState(_,!0),this.painter=new yd(_,this.transform,!!h),this.on("data",P=>{"source"===P.dataType&&this.painter.setTileLoadedFlag(!0)}),b.exported$1.testSupport(_)):this.fire(new b.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(S){S.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new b.Event("webglcontextlost",{originalEvent:S}))}_contextRestored(S){this._setupPainter(),this.resize(),this._update(),this.fire(new b.Event("webglcontextrestored",{originalEvent:S}))}_onMapScroll(S){if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_requestDomTask(S){!this.loaded()||this.loaded()&&!this.isMoving()?S():this._domRenderTaskQueue.add(S)}_render(S){let h;const _=this.painter.context.extTimerQuery,P=b.exported.now();if(this.listens("gpu-timing-frame")&&(h=_.createQueryEXT(),_.beginQueryEXT(_.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],b.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],b.window.performance.now())),this._renderTaskQueue.run(S),this._domRenderTaskQueue.run(S),this._removed)return;this._updateProjectionTransition();const V=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const G=this.transform.zoom,tt=this.transform.pitch,ht=b.exported.now(),lt=new b.EvaluationParameters(G,{now:ht,fadeDuration:V,pitch:tt,transition:this.style.getTransition()});this.style.update(lt)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let W=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),W=this._updateAverageElevation(P),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):W=this._updateAverageElevation(P),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,V,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:V,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new b.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new b.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const G=b.exported.now()-P;_.endQueryEXT(_.TIME_ELAPSED_EXT,h),setTimeout(()=>{const tt=_.getQueryObjectEXT(h,_.QUERY_RESULT_EXT)/1e6;_.deleteQueryEXT(h),this.fire(new b.Event("gpu-timing-frame",{cpuTime:G,gpuTime:tt})),b.window.performance.mark("frame-gpu",{startTime:P,detail:{gpuTime:tt}})},50)}if(this.listens("gpu-timing-layer")){const G=this.painter.collectGpuTimers();setTimeout(()=>{const tt=this.painter.queryGpuTimers(G);this.fire(new b.Event("gpu-timing-layer",{layerTimes:tt}))},50)}if(this.listens("gpu-timing-deferred-render")){const G=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const tt=this.painter.queryGpuTimeDeferredRender(G);this.fire(new b.Event("gpu-timing-deferred-render",{gpuTime:tt}))},50)}const $=this._sourcesDirty||this._styleDirty||this._placementDirty||W;if($||this._repaint)this.triggerRepaint();else{const G=!this.isMoving()&&this.loaded();if(G&&(W=this._updateAverageElevation(P,!0)),W)this.triggerRepaint();else if(this._triggerFrame(!1),G&&(this.fire(new b.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const tt=this._calculateSpeedIndex();this.fire(new b.Event("speedindexcompleted",{speedIndex:tt})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,b.LivePerformanceUtils.mark(b.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&b.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(S){for(const h of this._markers)S&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!S||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(S,h=!1){const _=P=>(this.transform.averageElevation=P,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&_(0);if((h||S-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(S)){const P=this.transform.averageElevation;let V=this.transform.sampleAverageElevation(),W=!1;this.transform.elevation&&(W=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(V)?V=0:this._averageElevationLastSampledAt=S;const $=Math.abs(P-V);if($>1){if(this._isInitialLoad||W)return this._averageElevation.jumpTo(V),_(V);this._averageElevation.easeTo(V,S,300)}else if($>1e-4)return this._averageElevation.jumpTo(V),_(V)}return!!this._averageElevation.isEasing(S)&&_(this._averageElevation.getValue(S))}_authenticate(){b.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,S=>{if(S&&(S.message===b.AUTH_ERR_MSG||401===S.status)){const h=this.painter.context.gl;b.storeAuthState(h,!1),this._logoControl instanceof nh&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new b.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),b.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const S=this._isDragging();this.painter.updateTerrain(this.style,S)}_calculateSpeedIndex(){const S=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const _=this.painter.context.gl,P=_.createFramebuffer();function V(W){_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,W,0);const $=new Uint8Array(_.drawingBufferWidth*_.drawingBufferHeight*4);return _.readPixels(0,0,_.drawingBufferWidth,_.drawingBufferHeight,_.RGBA,_.UNSIGNED_BYTE,$),$}return _.bindFramebuffer(_.FRAMEBUFFER,P),this._canvasPixelComparison(V(S),h.canvasCopies.map(V),h.timeStamps)}_canvasPixelComparison(S,h,_){let P=_[1]-_[0];const V=S.length/4;for(let W=0;W<h.length;W++){const $=h[W];let G=0;for(let tt=0;tt<$.length;tt+=4)$[tt]===S[tt]&&$[tt+1]===S[tt+1]&&$[tt+2]===S[tt+2]&&$[tt+3]===S[tt+3]&&(G+=1);P+=(_[W+2]-_[W+1])*(1-G/V)}return P}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==b.window&&(b.window.removeEventListener("resize",this._onWindowResize,!1),b.window.removeEventListener("orientationchange",this._onWindowResize,!1),b.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),b.window.removeEventListener("online",this._onWindowOnline,!1),b.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const S=this.painter.context.gl.getExtension("WEBGL_lose_context");S&&S.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),b.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new b.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(S){this._renderNextFrame=this._renderNextFrame||S,this.style&&!this._frame&&(this._frame=b.exported.frame(h=>{const _=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,_&&this._render(h)}))}_preloadTiles(S){const h=this.style?Object.values(this.style._sourceCaches):[];return b.asyncAll(h,(_,P)=>_._preloadTiles(S,P),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(S){this._trackResize&&this.resize({originalEvent:S})._update()}_onVisibilityChange(){"hidden"===b.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(S){this._showTerrainWireframe!==S&&(this._showTerrainWireframe=S,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(S){this._speedIndexTiming!==S&&(this._speedIndexTiming=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(S){this._showTileAABBs!==S&&(this._showTileAABBs=S,S&&this._update())}_setCacheLimits(S,h){b.setCacheLimits(S,h)}get version(){return b.version}},NavigationControl:class{constructor(S){this.options=b.extend({},ba,S),this._container=bi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(b.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),bi("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),bi("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(b.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const _=this._map;_&&(this.options.visualizePitch?_.resetNorthPitch({},{originalEvent:h}):_.resetNorth({},{originalEvent:h}))}),this._compassIcon=bi("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const S=this._map;if(!S)return;const h=S.getZoom(),_=h===S.getMaxZoom(),P=h===S.getMinZoom();this._zoomInButton.disabled=_,this._zoomOutButton.disabled=P,this._zoomInButton.setAttribute("aria-disabled",_.toString()),this._zoomOutButton.setAttribute("aria-disabled",P.toString())}_rotateCompassArrow(){const S=this._map;if(!S)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(S.transform.pitch*(Math.PI/180)),.5)}) rotateX(${S.transform.pitch}deg) rotateZ(${S.transform.angle*(180/Math.PI)}deg)`:`rotate(${S.transform.angle*(180/Math.PI)}deg)`;S._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),S.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&S.on("pitch",this._rotateCompassArrow),S.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nu(S,this._compass,this.options.visualizePitch)),this._container}onRemove(){const S=this._map;S&&(this._container.remove(),this.options.showZoom&&S.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&S.off("pitch",this._rotateCompassArrow),S.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(S,h){const _=bi("button",S,this._container);return _.type="button",_.addEventListener("click",h),_}_setButtonTitle(S,h){if(!this._map)return;const _=this._map._getUIString(`NavigationControl.${h}`);S.setAttribute("aria-label",_),S.firstElementChild&&S.firstElementChild.setAttribute("title",_)}},GeolocateControl:class extends b.Evented{constructor(S){super(),this.options=b.extend({geolocation:b.window.navigator.geolocation},sh,S),b.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=va(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(S){return this._map=S,this._container=bi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(S){const h=(_=!!this.options.geolocation)=>{this._supportsGeolocation=_,S(_)};void 0!==this._supportsGeolocation?S(this._supportsGeolocation):void 0!==b.window.navigator.permissions?b.window.navigator.permissions.query({name:"geolocation"}).then(_=>h("denied"!==_.state)).catch(()=>h()):h()}_isOutOfMapMaxBounds(S){const h=this._map.getMaxBounds(),_=S.coords;return!!h&&(_.longitude<h.getWest()||_.longitude>h.getEast()||_.latitude<h.getSouth()||_.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(S){if(this._map){if(this._isOutOfMapMaxBounds(S))return this._setErrorState(),this.fire(new b.Event("outofmaxbounds",S)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=S,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(S),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(S),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new b.Event("geolocate",S)),this._finish()}}_updateCamera(S){const h=new b.LngLat(S.coords.longitude,S.coords.latitude),_=S.coords.accuracy,P=this._map.getBearing(),V=b.extend({bearing:P},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(_),V,{geolocateSource:!0})}_updateMarker(S){if(S){const h=new b.LngLat(S.coords.longitude,S.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=S.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const S=this._map.transform,h=b.mercatorZfromAltitude(1,S._center.lat)*S.worldSize,_=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(S){if(this._map){if(this.options.trackUserLocation)if(1===S.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===S.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new b.Event("error",S)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(S){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=bi("button","mapboxgl-ctrl-geolocate",this._container),bi("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===S){b.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=bi("div","mapboxgl-user-location"),this._dotElement.appendChild(bi("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(bi("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Zr({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=bi("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||"ACTIVE_LOCK"!==this._watchState||h.originalEvent&&"resize"===h.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new b.Event("trackuserlocationend")))})}}_onDeviceOrientation(S){this._userLocationDotMarker&&(S.webkitCompassHeading?this._heading=S.webkitCompassHeading:!0===S.absolute&&(this._heading=-1*S.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return b.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new b.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new b.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new b.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let S;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(S={maximumAge:6e5,timeout:0},this._noTimeout=!0):(S=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,S),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const S=()=>{b.window.addEventListener("ondeviceorientationabsolute"in b.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==b.window.DeviceMotionEvent&&"function"==typeof b.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(h=>{"granted"===h&&S()}).catch(console.error):S()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),b.window.removeEventListener("deviceorientation",this._onDeviceOrientation),b.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ih,ScaleControl:class{constructor(S){this.options=b.extend({},Va,S),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=rm.bind(this)),b.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const S=this.options.maxWidth||100,h=this._map,_=h._containerHeight/2,P=h._containerWidth/2-S/2,V=h.unproject([P,_]),W=h.unproject([P+S,_]),$=V.distanceTo(W);if("imperial"===this.options.unit){const G=3.2808*$;G>5280?this._setScale(S,G/5280,"mile"):this._setScale(S,G,"foot")}else"nautical"===this.options.unit?this._setScale(S,$/1852,"nautical-mile"):$>=1e3?this._setScale(S,$/1e3,"kilometer"):this._setScale(S,$,"meter")}_setScale(S,h,_){const P=Vc(h),V=P/h;this._map._requestDomTask(()=>{this._container.style.width=S*V+"px",this._container.innerHTML="nautical-mile"!==_?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:_}).format(P):`${P}&nbsp;nm`})}onAdd(S){return this._map=S,this._language=S.getLanguage(),this._container=bi("div","mapboxgl-ctrl mapboxgl-ctrl-scale",S.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(S){this._language=S,this._update()}setUnit(S){this.options.unit=S,this._update()}},FullscreenControl:class{constructor(S){this._fullscreen=!1,S&&S.container&&(S.container instanceof b.window.HTMLElement?this._container=S.container:b.warnOnce("Full screen control 'container' must be a DOM element.")),b.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in b.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in b.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=bi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",b.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,b.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!b.window.document.fullscreenEnabled&&!b.window.document.webkitFullscreenEnabled)}_setupUI(){const S=this._fullscreenButton=bi("button","mapboxgl-ctrl-fullscreen",this._controlContainer);bi("span","mapboxgl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),b.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",S)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(b.window.document.fullscreenElement||b.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?b.window.document.exitFullscreen?b.window.document.exitFullscreen():b.window.document.webkitCancelFullScreen&&b.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends b.Evented{constructor(S){super(),this.options=b.extend(Object.create(kd),S),b.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(S&&S.className?S.className.trim().split(/\s+/):[])}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&S.on("preclick",this._onClose),this.options.closeOnMove&&S.on("move",this._onClose),S.on("remove",this.remove),this._update(),S._addPopup(this),this._focusFirstElement(),this._trackPointer?(S.on("mousemove",this._onMouseEvent),S.on("mouseup",this._onMouseEvent),S._canvasContainer.classList.add("mapboxgl-track-pointer")):S.on("move",this._update),this.fire(new b.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const S=this._map;return S&&(S.off("move",this._update),S.off("move",this._onClose),S.off("preclick",this._onClose),S.off("click",this._onClose),S.off("remove",this.remove),S.off("mousemove",this._onMouseEvent),S.off("mouseup",this._onMouseEvent),S.off("drag",this._onMouseEvent),S._canvasContainer&&S._canvasContainer.classList.remove("mapboxgl-track-pointer"),S._removePopup(this),this._map=void 0),this.fire(new b.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(S){this._lngLat=b.LngLat.convert(S),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const S=this._map;return S&&(S.off("move",this._update),S.on("mousemove",this._onMouseEvent),S.on("drag",this._onMouseEvent),S._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(b.window.document.createTextNode(S))}setHTML(S){const h=b.window.document.createDocumentFragment(),_=b.window.document.createElement("body");let P;for(_.innerHTML=S;P=_.firstChild,P;)h.appendChild(P);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=bi("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(S),this.options.closeButton){const _=this._closeButton=bi("button","mapboxgl-popup-close-button",h);_.type="button",_.setAttribute("aria-label","Close popup"),_.setAttribute("aria-hidden","true"),_.innerHTML="&#215;",_.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(S){return this._classList.add(S),this._updateClassList(),this}removeClassName(S){return this._classList.delete(S),this._updateClassList(),this}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){let h;return this._classList.delete(S)?h=!1:(this._classList.add(S),h=!0),this._updateClassList(),h}_onMouseEvent(S){this._update(S.point)}_getAnchor(S){if(this.options.anchor)return this.options.anchor;const h=this._map,_=this._container,P=this._pos;if(!h||!_||!P)return"bottom";const V=_.offsetWidth,W=_.offsetHeight,$=P.x<V/2,G=P.x>h.transform.width-V/2;if(P.y+S<W)return $?"top-left":G?"top-right":"top";if(P.y>h.transform.height-W){if($)return"bottom-left";if(G)return"bottom-right"}return $?"left":G?"right":"bottom"}_updateClassList(){const S=this._container;if(!S)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),S.className=h.join(" ")}_update(S){const h=this._map,_=this._content;if(!h||!this._lngLat&&!this._trackPointer||!_)return;let P=this._container;if(P||(P=this._container=bi("div","mapboxgl-popup",h.getContainer()),this._tip=bi("div","mapboxgl-popup-tip",P),P.appendChild(_)),this.options.maxWidth&&P.style.maxWidth!==this.options.maxWidth&&(P.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rc(this._lngLat,this._pos,h.transform)),!this._trackPointer||S){const V=this._pos=this._trackPointer&&S?S:h.project(this._lngLat),W=Vu(this.options.offset),$=this._anchor=this._getAnchor(W.y),G=Vu(this.options.offset,$),tt=V.add(G).round();h._requestDomTask(()=>{this._container&&$&&(this._container.style.transform=`${Ra[$]} translate(${tt.x}px,${tt.y}px)`)})}if(!this._marker&&h._showingGlobe()){const V=b.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(V)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(Ad);S&&S.focus()}_onClose(){this.remove()}_setOpacity(S){this._container&&(this._container.style.opacity=`${S}`),this._content&&(this._content.style.pointerEvents=S?"auto":"none")}},Marker:Zr,Style:Tn,LngLat:b.LngLat,LngLatBounds:b.LngLatBounds,Point:b.pointGeometry,MercatorCoordinate:b.MercatorCoordinate,FreeCameraOptions:Ql,Evented:b.Evented,config:b.config,prewarm:function(){y().acquire(w)},clearPrewarmedResources:function(){const S=o;S&&(S.isPreloaded()&&1===S.numActive()?(S.release(w),o=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return b.config.ACCESS_TOKEN},set accessToken(S){b.config.ACCESS_TOKEN=S},get baseApiUrl(){return b.config.API_URL},set baseApiUrl(S){b.config.API_URL=S},get workerCount(){return D.workerCount},set workerCount(S){D.workerCount=S},get maxParallelImageRequests(){return b.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(S){b.config.MAX_PARALLEL_IMAGE_REQUESTS=S},clearStorage(S){b.clearTileCache(S)},workerUrl:"",workerClass:null,setNow:b.exported.setNow,restoreNow:b.exported.restoreNow};return zc}),ss}()}},Qa=>{Qa(Qa.s=138)}]);